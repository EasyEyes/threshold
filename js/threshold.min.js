/*! For license information please see threshold.min.js.LICENSE.txt */
(()=>{"use strict";var __webpack_modules__={407:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{QuestBetaAnalysis:()=>QuestBetaAnalysis,QuestBetaAnalysis1:()=>QuestBetaAnalysis1,QuestCreate:()=>QuestCreate,QuestMean:()=>QuestMean,QuestMode:()=>QuestMode,QuestP:()=>QuestP,QuestPdf:()=>QuestPdf,QuestQuantile:()=>QuestQuantile,QuestRecompute:()=>QuestRecompute,QuestSd:()=>QuestSd,QuestSimulate:()=>QuestSimulate,QuestTrials:()=>QuestTrials,QuestUpdate:()=>QuestUpdate});let numeric={},recompute_chart,recompute_chart2,simulate_chart;function binaryFindIndex(e,t){if(1===e.length&&e[0]===t)return 0;for(var r=0,n=e.length-1;r<n;){var i=Math.floor((r+n)/2),s=e[i],o=e[i+1];if(t<s)n=i;else{if(!(t>o))return i+(t-s)/(o-s);r=i+1}}return-1}function interpolate(e,t,r){switch(r){case"nearest":return e[Math.round(t)];case"next":return e[Math.ceil(t)];case"previous":return e[Math.floor(t)];default:var n=Math.floor(t),i=Math.ceil(t),s=t-n;return(1-s)*e[n]+s*e[i]}}function interp1(e,t,r,n){if(void 0===n&&(n="linear"),e.length!==t.length)throw new Error("Arrays of sample points xs and corresponding values vs have to have\n      equal length.");var i=e.map((function(e,r){return[e,t[r]]}));i.sort((function(e,t){var r=e[0]-t[0];if(0===r)throw new Error("Two sample points have equal value "+e[0]+". This is not allowed.");return r}));for(var s=[],o=[],a=0;a<i.length;a++){var l=i[a];s.push(l[0]),o.push(l[1])}return r.map((function(e){var t=binaryFindIndex(s,e);if(-1===t)throw new Error("Query value "+e+" lies outside of range. Extrapolation is not\n        supported.");return interpolate(o,t,n)})).slice()}function QuestCreate(e,t,r,n,i,s,o,a,l){let h={};if(void 0===e)return void alert("Please specify tGuess as a parameter of QuestCreate.");if(h.tGuess=e,void 0===t)return void alert("Please specify tGuessSd as a parameter of QuestCreate.");if(h.tGuessSd=t,void 0===r)return void alert("Please specify pThreshold as a parameter of QuestCreate.");if(h.pThreshold=r,void 0===n)return void alert("Please specify beta as a parameter of QuestCreate.");if(h.beta=n,void 0===i)return void alert("Please specify delta as a parameter of QuestCreate.");if(h.delta=i,void 0===s)return void alert("Please specify gamma as a parameter of QuestCreate.");h.gamma=s,h.grain=void 0===o?.01:o;let u=500;if(void 0!==a){if(a<=0)return void alert("The range parameter must be greater than zero.");u=a/o,u=2*Math.ceil(u/2)}return void 0===l&&(l=0),numeric.isFinite(e)||alert("The tGuess parameter must be finite."),h.updatePdf=1,h.warnPdf=1,h.normalizePdf=1,h.dim=u,QuestRecompute(h,l)}function diff(e){const t=[];return e.forEach(((r,n,i)=>{n<e.length-1&&t.push(i[n+1]-r)})),t}function find_non_zero_index(e){const t=[];return e.forEach(((e,r)=>{0!==e&&t.push(r)})),t}function find_more_than_zero_index(e){const t=[];return e.forEach(((e,r)=>{e>0&&t.push(r)})),t}function find_less_than_or_equal_to_zero_index(e){const t=[];return e.forEach(((e,r)=>{e<=0&&t.push(r)})),t}function get_array_using_index(e,t){const r=[];return t.forEach((t=>{r.push(e[t])})),r}function fliplr(e){const t=[];return e.forEach(((e,r,n)=>{t.push(n[n.length-1-r])})),t}function max_of_array(e){return e.reduce((function(e,t){return Math.max(e,t)}))}function min_of_array(e){return e.reduce((function(e,t){return Math.min(e,t)}))}function QuestRecompute(e,t,r,n){if(Array.isArray(e)&&e.length>1){for(let t=0;t<e.length;t++)e[t].normalizePdf=0,e[t]=QuestRecompute(e[t]);return e}if(!e.updatePdf)return e;e.gamma>e.pThreshold&&(alert(`reducing gamma from ${e.gamma} to 0.5`),e.gamma=.5),void 0===t&&(t=0),e.i=numeric.linspace(-e.dim/2,e.dim/2),e.x=numeric.mul(e.i,e.grain),e.pdf=function(){const t=numeric.div(e.x,e.tGuessSd),r=numeric.pow(t,2),n=numeric.mul(-.5,r);return numeric.exp(n)}(),e.pdf=numeric.div(e.pdf,numeric.sum(e.pdf));const i=numeric.linspace(-e.dim,e.dim);function s(t){const r=numeric.mul(e.delta,e.gamma),n=numeric.sub(1,e.delta),i=numeric.sub(1,e.gamma),s=numeric.mul(e.beta,t),o=numeric.pow(10,s),a=numeric.exp(numeric.mul(-1,o)),l=numeric.sub(1,numeric.mul(i,a));return numeric.add(r,numeric.mul(n,l))}if(e.x2=numeric.mul(i,e.grain),e.p2=s(e.x2),t>0){if(null===document.getElementById("recompute_canvas")){const e=document.createElement("canvas");e.id="recompute_canvas",e.width=void 0===r?800:r,e.height=void 0===n?600:n,document.body.appendChild(e)}const t=document.getElementById("recompute_canvas").getContext("2d"),i=[];for(let t=0;t<e.x2.length;t++)i.push({x:e.x2[t],y:e.p2[t]});void 0!==recompute_chart&&recompute_chart.destroy(),recompute_chart=new Chart(t,{type:"scatter",data:{datasets:[{label:"Psychometric function",data:i,backgroundColor:"RGBA(225,95,150, 1)"}]},options:{title:{display:!0,text:"Psychometric function by QuestRecompute."},scales:{xAxes:[{scaleLabel:{display:!0,labelString:"Stimulus intensity (Log scale)"}}],yAxes:[{scaleLabel:{display:!0,labelString:"Probability"}}]},responsive:!1}})}(min_of_array(e.p2)>e.pThreshold||max_of_array(e.p2)<e.pThreshold)&&alert(`psychometric function range [${min_of_array(e.p2)} ${max_of_array(e.p2)}] omits ${e.pThreshold} threshold`),numeric.isFinite(e.p2).includes(!1)&&alert("psychometric function p2 is not finite");const o=find_non_zero_index(diff(e.p2));o.length<2&&alert(`psychometric function has only ${o.length} strictly monotonic point(s)`);const a=get_array_using_index(e.p2,o),l=get_array_using_index(e.x2,o);if(e.xThreshold=interp1(a,l,[e.pThreshold])[0],!1===numeric.isFinite(e.xThreshold)&&alert(`psychometric function has no ${e.pThreshold} threshold`),2===t){if(null===document.getElementById("recompute_canvas2")){const e=document.createElement("canvas");e.id="recompute_canvas2",e.width=void 0===r?800:r,e.height=void 0===n?600:n,document.body.appendChild(e)}const t=document.getElementById("recompute_canvas2").getContext("2d"),i=[];for(let t=0;t<e.x2.length;t++)i.push({x:l[t],y:a[t]});void 0!==recompute_chart2&&recompute_chart2.destroy(),recompute_chart2=new Chart(t,{type:"scatter",data:{datasets:[{label:"Psychometric function",data:i,backgroundColor:"RGBA(225,95,150, 1)"}]},options:{title:{display:!0,text:"Psychometric function by QuestRecompute."},scales:{xAxes:[{scaleLabel:{display:!0,labelString:"Stimulus intensity (Log scale)"}}],yAxes:[{scaleLabel:{display:!0,labelString:"Probability"}}]},responsive:!1}})}e.p2=s(numeric.add(e.x2,e.xThreshold)),numeric.isFinite(e.p2).includes(!1)&&alert("psychometric function p2 is not finite"),e.s2=[fliplr(numeric.sub(1,e.p2)),fliplr(e.p2)],void 0!==e.intensity&&void 0!==e.response||(e.trialCount=0,e.intensity=numeric.rep([1e4],0),e.response=numeric.rep([1e4],0));const h=numeric.isFinite(e.s2);(h[0].includes(!1)||h[1].includes(!1))&&alert("psychometric function s2 is not finite");const u=e.p2[0],c=e.p2[e.p2.length-1],d=2.2204*Math.pow(10,-16),f=c*Math.log(c+d)-u*Math.log(u+d)+(1-c+d)*Math.log(1-c+d)-(1-u+d)*Math.log(1-u+d),p=1/(1+Math.exp(f/(u-c)));e.quantileOrder=(p-u)/(c-u),numeric.isFinite(e.pdf).includes(!1)&&alert("prior pdf is not finite");const m=Math.pow(10,10);for(let t=0;t<e.trialCount;t++){const r=Math.max(-1*m,Math.min(m,e.intensity[t])),n=Math.round((r-e.tGuess)/e.grain);let i=numeric.sub(numeric.add(e.pdf.length,e.i),n);const s=i[0];s<0&&(i=numeric.sub(i,s));const o=i[i.length-1],a=numeric.dim(e.s2)[1]-1;o>a&&(i=numeric.sub(numeric.add(i,a),o)),e.pdf=numeric.mul(e.pdf,get_array_using_index(e.s2[e.response[t]],i)),e.normalizePdf&&(t+1)%100==0&&(e.pdf=numeric.div(e.pdf,numeric.sum(e.pdf)))}return 1===e.normalizePdf&&(e.pdf=numeric.div(e.pdf,numeric.sum(e.pdf))),numeric.isFinite(e.pdf).includes(!1)&&alert("pdf is not finite"),e}function cumsum(e){const t=[];for(let r=0;r<e.length;r++)0===r?t.push(e[0]):t.push(t[r-1]+e[r]);return t}function QuestQuantile(e,t){if(void 0===e&&alert("Usage: intensity=QuestQuantile(q,[quantileOrder])"),Array.isArray(e)&&e.length>1){void 0!==t&&alert("Cannot accept quantileOrder for q vector. Set each q.quantileOrder instead.");const r=numeric.rep([e.length],0);for(let t=0;t<e.length;t++)r[t]=QuestQuantile(e[t]);return r}void 0===t&&(t=e.quantileOrder),(t>1||t<0)&&alert(`quantileOrder ${t} is outside range 0 to 1.`);const r=cumsum(e.pdf);if(isFinite(r[r.length-1])||alert("pdf is not finite"),0===r[r.length-1]&&alert("pdf is all zero"),t<r[0])return e.tGuess+e.x[0];if(t>r[r.length-1])return e.tGuess+e.x[e.x.length-1];const n=find_more_than_zero_index(diff([-1].concat(r)));n.length<2&&alert(`pdf has only ${n.length} nonzero point(s)`);const i=get_array_using_index(r,n),s=get_array_using_index(e.x,n);return e.tGuess+interp1(i,s,[t*r[r.length-1]])[0]}function get_larger_numbers(e,t){const r=[];return e.forEach((e=>{e>=t?r.push(e):r.push(t)})),r}function get_smaller_numbers(e,t){const r=[];return e.forEach((e=>{e<=t?r.push(e):r.push(t)})),r}function QuestSimulate(e,t,r,n,i,s){void 0!==e&&void 0!==t&&void 0!==r||alert("Usage: response=QuestSimulate(q,tTest,tActual[,plotIt])"),Array.isArray(e)&&e.length>1&&alert("can not deal with q being a vector");const o=min_of_array(e.x2),a=max_of_array(e.x2),l=Math.min(Math.max(t-r,o),a),h=interp1(e.x2,e.p2,[l])[0]>Math.random()?1:0;if(void 0!==n&&n>0){const t=l,u=["RGBA(255, 0, 0, 1)","RGBA(0, 128, 0, 1)"],c=get_smaller_numbers(get_larger_numbers(numeric.sub(e.intensity.slice(0,e.trialCount),r),o),a);let d,f,p;if(2===n?(d=find_more_than_zero_index(e.response.slice(0,e.trialCount)),f=find_less_than_or_equal_to_zero_index(e.response.slice(0,e.trialCount)),p="RGBA(0, 128, 0, 1)"):(d=numeric.linspace(0,e.trialCount-1),f=[],p="RGBA(0, 0, 0, 1)"),null===document.getElementById("simulate_canvas")){const e=document.createElement("canvas");e.id="simulate_canvas",e.width=void 0===i?800:i,e.height=void 0===s?600:s,document.body.appendChild(e)}const m=document.getElementById("simulate_canvas").getContext("2d"),_=[];for(let t=0;t<e.x2.length;t++)_.push({x:e.x2[t]+r,y:e.p2[t]});const g=[];g.push({label:"Psychometric function",data:_,backgroundColor:"RGBA(225,95,150, 1)"});const v=[],y=get_array_using_index(c,d);for(let t=0;t<d.length;t++)v.push({x:y[t]+r,y:interp1(e.x2,e.p2,[y[t]])[0]});const b=[];if(2===n){const t=get_array_using_index(c,f);for(let n=0;n<f.length;n++)b.push({x:t[n]+r,y:interp1(e.x2,e.p2,[t[n]])[0]});g.push({label:"Positive",data:v,backgroundColor:p,pointBorderColor:p,pointStyle:"star",pointBorderWidth:2,pointRadius:10,pointRotation:45}),g.push({label:"Negative",data:b,backgroundColor:"RGBA(255, 0, 0, 1)",pointBorderColor:"RGBA(255, 0, 0, 1)",pointStyle:"star",pointBorderWidth:2,pointRadius:10,pointRotation:45})}else g.push({label:"Responses",data:v,backgroundColor:p,pointBorderColor:p,pointStyle:"star",pointBorderWidth:2,pointRadius:10,pointRotation:45});g.push({label:"tActual",data:[{x:r,y:interp1(numeric.add(e.x2,r),e.p2,[r])[0]}],backgroundColor:"RGBA(255, 0, 255, 1)",pointBorderColor:"RGBA(255, 0, 255, 1)",pointStyle:"circle",pointBorderWidth:2,pointRadius:10,pointRotation:45},{label:"The latest repsonse (Circle)",data:[{x:t+r,y:interp1(e.x2,e.p2,[t])[0]}],backgroundColor:u[h],pointBorderColor:u[h],pointStyle:"circle",pointRadius:10}),void 0!==simulate_chart&&simulate_chart.destroy(),simulate_chart=new Chart(m,{type:"scatter",data:{datasets:g},options:{title:{display:!0,text:"Psychometric function by QuestSimulate."},scales:{xAxes:[{scaleLabel:{display:!0,labelString:"Stimulus intensity (Log scale)"}}],yAxes:[{scaleLabel:{display:!0,labelString:"Probability"}}]},responsive:!1}})}return h}function QuestUpdate(e,t,r){if(void 0!==e&&void 0!==t&&void 0!==r||alert("Usage: q=QuestUpdate(q,intensity,response)"),Array.isArray(e)&&e.length>1&&alert("Can not deal with q being a vector."),(r<0||r>e.s2.length-1)&&alert(`response ${r} out of range 0 to ${e.s2.length-1}`),e.updatePdf){const n=Math.pow(10,10),i=Math.max(-1*n,Math.min(n,t)),s=e.pdf.length-Math.round((i-e.tGuess)/e.grain);let o=numeric.add(s,e.i);if(o[0]<0||o[o.length-1]>numeric.dim(e.s2)[1]-1){if(e.warnPdf){const r=(1-e.pdf.length-e.i[0])*e.grain+e.tGuess,n=(numeric.dim(e.s2)[1]-e.pdf.length-e.i[e.i.length-1])*e.grain+e.tGuess;alert(`QuestUpdate: intensity ${t} out of range ${r} to ${n}. Pdf will be inexact. Suggest that you increase "range" in call to QuestCreate.`)}if(o[0]<0)o=numeric.sub(o,o[0]);else{const t=numeric.add(o,numeric.dim(e.s2)[1]-1);o=numeric.sub(t,o[o.length-1])}}e.pdf=numeric.mul(e.pdf,get_array_using_index(e.s2[r],o)),e.normalizePdf&&(e.pdf=numeric.div(e.pdf,numeric.sum(e.pdf)))}if(e.trialCount++,e.trialCount>e.intensity.length){const t=numeric.rep([1e4],0);e.intensity=e.intensity.concat(t),e.response=e.response.concat(t)}return e.intensity[e.trialCount-1]=t,e.response[e.trialCount-1]=r,e}function QuestMean(e){if(void 0===e&&alert("Usage: t=QuestMean(q)"),Array.isArray(e)&&e.length>1){let t=numeric.rep([e.length],0);for(let r=0;r<e.length;r++)t[r]=QuestMean(e[r]);return t}const t=numeric.mul(e.pdf,e.x);return e.tGuess+numeric.sum(t)/numeric.sum(e.pdf)}function QuestSd(e){if(void 0===e&&alert("Usage: sd=QuestSd(q)"),Array.isArray(e)&&e.length>1){let t=numeric.rep([e.length],0);for(let r=0;r<e.length;r++)t[r]=QuestSd(e[r]);return t}const t=numeric.sum(e.pdf),r=numeric.pow(e.x,2),n=numeric.mul(e.pdf,r),i=numeric.div(numeric.sum(n),t),s=numeric.mul(e.pdf,e.x),o=numeric.sum(s),a=numeric.div(o,t),l=numeric.pow(a,[2]);return numeric.sqrt(numeric.sub(i,l))[0]}function max_with_index(e){let t=-1/0,r=-1/0;return e.forEach(((e,n,i)=>{e>t&&(t=e,r=n)})),{value:t,index:r}}function QuestMode(e){if(void 0===e&&alert("Usage: object = QuestMode(q)"),Array.isArray(e)&&e.length>1){let t=numeric.rep([e.length],0);for(let r=0;r<e.length;r++)t[r]=QuestMode(e[r]);return t}const t=max_with_index(e.pdf);return{mode:e.x[t.index]+e.tGuess,pdf:t.value}}function QuestBetaAnalysis(e){void 0===e&&alert("Usage: QuestBetaAnalysis(q)"),console.log("Now re-analyzing with both threshold and beta as free parameters. ...");const t=[];if(Array.isArray(e))for(let r=0;r<e.length;r++)t.push(QuestBetaAnalysis1(e[r]));else t.push(QuestBetaAnalysis1(e));return t}function find_zero(e){for(let t=0;t<e.length;t++)if(0===e[t])return t}function QuestBetaAnalysis1(e){const t=[];for(let r=0;r<16;r++){const n=Object.assign({},e);n.beta=Math.pow(2,(r+1)/4),n.dim=250,n.grain=.02,t.push(n)}const r=QuestRecompute(t),n=[];for(let e=0;e<r.length;e++)n.push(numeric.sum(r[e].pdf));const i=find_zero(n);void 0!==i&&(console.log("Omitting beta values "),console.log(r[i].beta),console.log("because they have zero probability."));const s=get_array_using_index(r,find_non_zero_index(n)),o=QuestMean(s),a=QuestPdf(s,o);QuestSd(s);const l=[];for(let e=0;e<s.length;e++)l.push(s[e].beta);const h=max_with_index(a),u=o[h.index],c=QuestSd(s[h.index]),d=numeric.sum(a),f=numeric.mul(a,l),p=numeric.sum(f),m=numeric.div(p,d),_=numeric.mul(a,numeric.pow(l,2)),g=numeric.div(numeric.sum(_),d),v=numeric.pow(m,[2]),y=numeric.sqrt(numeric.sub(g,v))[0],b=numeric.div(numeric.sum(numeric.div(a,l)),d),x=numeric.div(a,numeric.pow(l,2)),S=numeric.div(numeric.sum(x),d),T=numeric.pow(b,[2]),E=numeric.sqrt(numeric.sub(S,T));return console.log(`Threshold ${round2(u,2)} +- ${round2(c,2)}`),console.log("beta = "+1/b),console.log(`Beta mode ${s[h.index].beta} mean ${round2(m,2)} +- ${round2(y,2)}`),console.log(`imean 1/${round2(1/b,2)} +- ${round2(E,2)}`),console.log(`Gamma ${e.gamma} `),1/b}function QuestPdf(e,t){if(void 0!==e&&void 0!==t||alert("Usage: p=QuestPdf(q,t)"),e.length!==t.length&&alert("both arguments must have the same dimensions"),Array.isArray(e)&&e.length>1){let r=numeric.rep([e.length],0);for(let n=0;n<e.length;n++)r[n]=QuestPdf(e[n],t[n]);return r}const r=Math.round((t-e.tGuess)/e.grain)+1+e.dim/2,n=Math.min(e.pdf.length,Math.max(1,r));return e.pdf[n]}function round2(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)}function QuestP(e,t){let r;return r=t<e.x2[0]?e.p2[0]:t>e.x2[e.x2.length-1]?e.p2[e.x2.length-1]:interp1(e.x2,e.p2,[t])[0],isFinite(r)||(console.log(e),alert(`psychometric function ${r} at ${t}`)),r}function indexSort(e){return numeric.linspace(0,e.length-1).sort((function(t,r){return e[t]-e[r]}))}function QuestTrials(e,t){if(void 0===e&&alert("Usage: trial=QuestTrials(q,[binsize])"),void 0!==t&&isFinite(t)||(t=0),t<0&&alert("binsize cannot be negative"),Array.isArray(e)&&e.length>1){const t=[];for(let r=0;r<e.length;r++)t.push(QuestTrials(e[r]));return t}const r=e.intensity.slice(0,e.trialCount);r.sort((function(e,t){return e-t})),indexSort(e.intensity.slice(0,e.trialCount));const n=e.response.slice(0,e.trialCount);let i=r;if(t>0){const e=numeric.div(r,t),n=numeric.round(e);i=numeric.mul(n,t)}const s={intensity:[],response0:[],response1:[]};let o=i[0],a=0,l=0;for(let e=0;e<i.length;e++)o!==i[e]&&(s.intensity.push(o),s.response0.push(a),s.response1.push(l),o=i[e],a=0,l=0),0===n[e]?a++:l++;return s.intensity.push(o),s.response0.push(a),s.response1.push(l),s}numeric.version="1.2.6",numeric.bench=function(e,t){var r,n,i;for(void 0===t&&(t=15),n=.5,r=new Date;;){for(i=n*=2;i>3;i-=4)e(),e(),e(),e();for(;i>0;)e(),i--;if(new Date-r>t)break}for(i=n;i>3;i-=4)e(),e(),e(),e();for(;i>0;)e(),i--;return 1e3*(3*n-1)/(new Date-r)},numeric._myIndexOf=function(e){var t,r=this.length;for(t=0;t<r;++t)if(this[t]===e)return t;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(e){function t(e){if(0===e)return"0";if(isNaN(e))return"NaN";if(e<0)return"-"+t(-e);if(isFinite(e)){var r=Math.floor(Math.log(e)/Math.log(10)),n=e/Math.pow(10,r),i=n.toPrecision(numeric.precision);return 10===parseFloat(i)&&(r++,i=(n=1).toPrecision(numeric.precision)),parseFloat(i).toString()+"e"+r.toString()}return"Infinity"}var r=[];return function e(n){var i;if(void 0===n)return r.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof n)return r.push('"'+n+'"'),!1;if("boolean"==typeof n)return r.push(n.toString()),!1;if("number"==typeof n){var s=t(n),o=n.toPrecision(numeric.precision),a=parseFloat(n.toString()).toString(),l=[s,o,a,parseFloat(o).toString(),parseFloat(a).toString()];for(i=1;i<l.length;i++)l[i].length<s.length&&(s=l[i]);return r.push(Array(numeric.precision+8-s.length).join(" ")+s),!1}if(null===n)return r.push("null"),!1;if("function"==typeof n){r.push(n.toString());var h=!1;for(i in n)n.hasOwnProperty(i)&&(h?r.push(",\n"):r.push("\n{"),h=!0,r.push(i),r.push(": \n"),e(n[i]));return h&&r.push("}\n"),!0}if(n instanceof Array){if(n.length>numeric.largeArray)return r.push("...Large Array..."),!0;for(h=!1,r.push("["),i=0;i<n.length;i++)i>0&&(r.push(","),h&&r.push("\n ")),h=e(n[i]);return r.push("]"),!0}for(i in r.push("{"),h=!1,n)n.hasOwnProperty(i)&&(h&&r.push(",\n"),h=!0,r.push(i),r.push(": \n"),e(n[i]));return r.push("}"),!0}(e),r.join("")},numeric.parseDate=function(e){return function e(t){if("string"==typeof t)return Date.parse(t.replace(/-/g,"/"));if(!(t instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var r,n=[];for(r=0;r<t.length;r++)n[r]=e(t[r]);return n}(e)},numeric.parseFloat=function(e){return function e(t){if("string"==typeof t)return parseFloat(t);if(!(t instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var r,n=[];for(r=0;r<t.length;r++)n[r]=e(t[r]);return n}(e)},numeric.parseCSV=function(e){var t,r,n,i=e.split("\n"),s=[],o=/(([^'",]*)|('[^']*')|("[^"]*")),/g,a=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,l=0;for(r=0;r<i.length;r++){var h,u=(i[r]+",").match(o);if(u.length>0){for(s[l]=[],t=0;t<u.length;t++)h=(n=u[t]).substr(0,n.length-1),a.test(h)?s[l][t]=parseFloat(h):s[l][t]=h;l++}}return s},numeric.toCSV=function(e){var t,r,n,i,s;for(n=numeric.dim(e)[0],s=[],t=0;t<n;t++){for(i=[],r=0;r<n;r++)i[r]=e[t][r].toString();s[t]=i.join(", ")}return s.join("\n")+"\n"},numeric.getURL=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(),t},numeric.imageURL=function(e){function t(e,t,r){void 0===t&&(t=0),void 0===r&&(r=e.length);var n,i=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],s=-1;for(e.length,n=t;n<r;n++)s=s>>>8^i[255&(s^e[n])];return-1^s}var r,n,i,s,o,a,l,h,u,c,d=e[0].length,f=e[0][0].length,p=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,f>>24&255,f>>16&255,f>>8&255,255&f,d>>24&255,d>>16&255,d>>8&255,255&d,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(c=t(p,12,29),p[29]=c>>24&255,p[30]=c>>16&255,p[31]=c>>8&255,p[32]=255&c,r=1,n=0,l=0;l<d;l++){for(l<d-1?p.push(0):p.push(1),o=3*f+1+(0===l)&255,a=3*f+1+(0===l)>>8&255,p.push(o),p.push(a),p.push(255&~o),p.push(255&~a),0===l&&p.push(0),h=0;h<f;h++)for(i=0;i<3;i++)n=(n+(r=(r+(o=(o=e[i][l][h])>255?255:o<0?0:Math.round(o)))%65521))%65521,p.push(o);p.push(0)}return u=(n<<16)+r,p.push(u>>24&255),p.push(u>>16&255),p.push(u>>8&255),p.push(255&u),s=p.length-41,p[33]=s>>24&255,p[34]=s>>16&255,p[35]=s>>8&255,p[36]=255&s,c=t(p,37),p.push(c>>24&255),p.push(c>>16&255),p.push(c>>8&255),p.push(255&c),p.push(0),p.push(0),p.push(0),p.push(0),p.push(73),p.push(69),p.push(78),p.push(68),p.push(174),p.push(66),p.push(96),p.push(130),"data:image/png;base64,"+function(e){var t,r,n,i,s,o,a,l=e.length,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u="";for(t=0;t<l;t+=3)s=((3&(r=e[t]))<<4)+((n=e[t+1])>>4),o=((15&n)<<2)+((i=e[t+2])>>6),a=63&i,t+1>=l?o=a=64:t+2>=l&&(a=64),u+=h.charAt(r>>2)+h.charAt(s)+h.charAt(o)+h.charAt(a);return u}(p)},numeric._dim=function(e){for(var t=[];"object"==typeof e;)t.push(e.length),e=e[0];return t},numeric.dim=function(e){var t;return"object"==typeof e?"object"==typeof(t=e[0])?"object"==typeof t[0]?numeric._dim(e):[e.length,t.length]:[e.length]:[]},numeric.mapreduce=function(e,t){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+t+';\nif(typeof x === "number") { var xi = x; '+e+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+e+";\n    xi = x[i-1];\n    "+e+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+e+"\n}\nreturn accum;")},numeric.mapreduce2=function(e,t){return Function("x","var n = x.length;\nvar i,xi;\n"+t+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+e+";\n}\nreturn accum;")},numeric.same=function e(t,r){var n,i;if(!(t instanceof Array&&r instanceof Array))return!1;if((i=t.length)!==r.length)return!1;for(n=0;n<i;n++)if(t[n]!==r[n]){if("object"!=typeof t[n])return!1;if(!e(t[n],r[n]))return!1}return!0},numeric.rep=function(e,t,r){void 0===r&&(r=0);var n,i=e[r],s=Array(i);if(r===e.length-1){for(n=i-2;n>=0;n-=2)s[n+1]=t,s[n]=t;return-1===n&&(s[0]=t),s}for(n=i-1;n>=0;n--)s[n]=numeric.rep(e,t,r+1);return s},numeric.dotMMsmall=function(e,t){var r,n,i,s,o,a,l,h,u,c,d;for(s=e.length,o=t.length,a=t[0].length,l=Array(s),r=s-1;r>=0;r--){for(h=Array(a),u=e[r],i=a-1;i>=0;i--){for(c=u[o-1]*t[o-1][i],n=o-2;n>=1;n-=2)d=n-1,c+=u[n]*t[n][i]+u[d]*t[d][i];0===n&&(c+=u[0]*t[0][i]),h[i]=c}l[r]=h}return l},numeric._getCol=function(e,t,r){var n;for(n=e.length-1;n>0;--n)r[n]=e[n][t],r[--n]=e[n][t];0===n&&(r[0]=e[0][t])},numeric.dotMMbig=function(e,t){var r,n,i,s=numeric._getCol,o=t.length,a=Array(o),l=e.length,h=t[0].length,u=new Array(l),c=numeric.dotVV;for(--o,n=--l;-1!==n;--n)u[n]=Array(h);for(n=--h;-1!==n;--n)for(s(t,n,a),i=l;-1!==i;--i)r=e[i],u[i][n]=c(r,a);return u},numeric.dotMV=function(e,t){var r,n=e.length;t.length;var i=Array(n),s=numeric.dotVV;for(r=n-1;r>=0;r--)i[r]=s(e[r],t);return i},numeric.dotVM=function(e,t){var r,n,i,s,o,a,l;for(i=e.length,s=t[0].length,o=Array(s),n=s-1;n>=0;n--){for(a=e[i-1]*t[i-1][n],r=i-2;r>=1;r-=2)l=r-1,a+=e[r]*t[r][n]+e[l]*t[l][n];0===r&&(a+=e[0]*t[0][n]),o[n]=a}return o},numeric.dotVV=function(e,t){var r,n,i=e.length,s=e[i-1]*t[i-1];for(r=i-2;r>=1;r-=2)n=r-1,s+=e[r]*t[r]+e[n]*t[n];return 0===r&&(s+=e[0]*t[0]),s},numeric.dot=function(e,t){var r=numeric.dim;switch(1e3*r(e).length+r(t).length){case 2002:return t.length<10?numeric.dotMMsmall(e,t):numeric.dotMMbig(e,t);case 2001:return numeric.dotMV(e,t);case 1002:return numeric.dotVM(e,t);case 1001:return numeric.dotVV(e,t);case 1e3:return numeric.mulVS(e,t);case 1:return numeric.mulSV(e,t);case 0:return e*t;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(e){var t,r,n,i,s=e.length,o=Array(s);for(t=s-1;t>=0;t--){for(i=Array(s),r=t+2,n=s-1;n>=r;n-=2)i[n]=0,i[n-1]=0;for(n>t&&(i[n]=0),i[t]=e[t],n=t-1;n>=1;n-=2)i[n]=0,i[n-1]=0;0===n&&(i[0]=0),o[t]=i}return o},numeric.getDiag=function(e){var t,r=Math.min(e.length,e[0].length),n=Array(r);for(t=r-1;t>=1;--t)n[t]=e[t][t],n[--t]=e[t][t];return 0===t&&(n[0]=e[0][0]),n},numeric.identity=function(e){return numeric.diag(numeric.rep([e],1))},numeric.pointwise=function(e,t,r){void 0===r&&(r="");var n,i,s=[],o=/\[i\]$/,a="",l=!1;for(n=0;n<e.length;n++)o.test(e[n])?a=i=e[n].substring(0,e[n].length-3):i=e[n],"ret"===i&&(l=!0),s.push(i);return s[e.length]="_s",s[e.length+1]="_k",s[e.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+a+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(l?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+e.join(",")+",_s,_k+1);\n    return ret;\n}\n"+r+"\nfor(i=_n-1;i!==-1;--i) {\n    "+t+"\n}\nreturn ret;",Function.apply(null,s)},numeric.pointwise2=function(e,t,r){void 0===r&&(r="");var n,i,s=[],o=/\[i\]$/,a="",l=!1;for(n=0;n<e.length;n++)o.test(e[n])?a=i=e[n].substring(0,e[n].length-3):i=e[n],"ret"===i&&(l=!0),s.push(i);return s[e.length]="var _n = "+a+".length;\nvar i"+(l?"":", ret = Array(_n)")+";\n"+r+"\nfor(i=_n-1;i!==-1;--i) {\n"+t+"\n}\nreturn ret;",Function.apply(null,s)},numeric._biforeach=function e(t,r,n,i,s){var o;if(i!==n.length-1)for(o=n[i]-1;o>=0;o--)e("object"==typeof t?t[o]:t,"object"==typeof r?r[o]:r,n,i+1,s);else s(t,r)},numeric._biforeach2=function e(t,r,n,i,s){if(i===n.length-1)return s(t,r);var o,a=n[i],l=Array(a);for(o=a-1;o>=0;--o)l[o]=e("object"==typeof t?t[o]:t,"object"==typeof r?r[o]:r,n,i+1,s);return l},numeric._foreach=function e(t,r,n,i){var s;if(n!==r.length-1)for(s=r[n]-1;s>=0;s--)e(t[s],r,n+1,i);else i(t)},numeric._foreach2=function e(t,r,n,i){if(n===r.length-1)return i(t);var s,o=r[n],a=Array(o);for(s=o-1;s>=0;s--)a[s]=e(t[s],r,n+1,i);return a},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var e,t;for(e=0;e<numeric.mathfuns2.length;++e)t=numeric.mathfuns2[e],numeric.ops2[t]=t;for(e in numeric.ops2)if(numeric.ops2.hasOwnProperty(e)){t=numeric.ops2[e];var r,n,i="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,e)?(i="var "+t+" = Math."+t+";\n",r=function(e,r,n){return e+" = "+t+"("+r+","+n+")"},n=function(e,r){return e+" = "+t+"("+e+","+r+")"}):(r=function(e,r,n){return e+" = "+r+" "+t+" "+n},n=numeric.opseq.hasOwnProperty(e+"eq")?function(e,r){return e+" "+t+"= "+r}:function(e,r){return e+" = "+e+" "+t+" "+r}),numeric[e+"VV"]=numeric.pointwise2(["x[i]","y[i]"],r("ret[i]","x[i]","y[i]"),i),numeric[e+"SV"]=numeric.pointwise2(["x","y[i]"],r("ret[i]","x","y[i]"),i),numeric[e+"VS"]=numeric.pointwise2(["x[i]","y"],r("ret[i]","x[i]","y"),i),numeric[e]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = this."+e+"VV, VS = this."+e+"VS, SV = this."+e+'SV;\nvar dim = this.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = this._biforeach2(x,y,dim(x),0,VV);\n      else x = this._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = this._biforeach2(x,y,dim(y),0,SV);\n  else '+n("x","y")+"\n}\nreturn x;\n"),numeric[t]=numeric[e],numeric[e+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],n("ret[i]","x[i]"),i),numeric[e+"eqS"]=numeric.pointwise2(["ret[i]","x"],n("ret[i]","x"),i),numeric[e+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = this."+e+"eqV, S = this."+e+'eqS\nvar s = this.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") this._biforeach(x,y,s,0,V);\n  else this._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(e=0;e<numeric.mathfuns2.length;++e)t=numeric.mathfuns2[e],delete numeric.ops2[t];for(e=0;e<numeric.mathfuns.length;++e)t=numeric.mathfuns[e],numeric.ops1[t]=t;for(e in numeric.ops1)numeric.ops1.hasOwnProperty(e)&&(i="",t=numeric.ops1[e],-1!==numeric.myIndexOf.call(numeric.mathfuns,e)&&Math.hasOwnProperty(t)&&(i="var "+t+" = Math."+t+";\n"),numeric[e+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+t+"(ret[i]);",i),numeric[e+"eq"]=Function("x",'if(typeof x !== "object") return '+t+"x\nvar i;\nvar V = this."+e+"eqV;\nvar s = this.dim(x);\nthis._foreach(x,s,0,V);\nreturn x;\n"),numeric[e+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+t+"(x[i]);",i),numeric[e]=Function("x",'if(typeof x !== "object") return '+t+"(x)\nvar i;\nvar V = this."+e+"V;\nvar s = this.dim(x);\nreturn this._foreach2(x,s,0,V);\n"));for(e=0;e<numeric.mathfuns.length;++e)t=numeric.mathfuns[e],delete numeric.ops1[t];for(e in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(e)&&(t=numeric.mapreducers[e],numeric[e+"V"]=numeric.mapreduce2(t[0],t[1]),numeric[e]=Function("x","s","k",t[1]+'if(typeof x !== "object") {    xi = x;\n'+t[0]+';\n    return accum;\n}if(typeof s === "undefined") s = this.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return this.'+e+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+t[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(e,t){return"object"==typeof e?"object"==typeof t?numeric.truncVV(e,t):numeric.truncVS(e,t):"object"==typeof t?numeric.truncSV(e,t):Math.round(e/t)*t},numeric.inv=function(e){var t,r,n,i,s,o,a,l=numeric.dim(e),h=Math.abs,u=l[0],c=l[1],d=numeric.clone(e),f=numeric.identity(u);for(o=0;o<c;++o){var p=-1,m=-1;for(s=o;s!==u;++s)(a=h(d[s][o]))>m&&(p=s,m=a);for(r=d[p],d[p]=d[o],d[o]=r,i=f[p],f[p]=f[o],f[o]=i,e=r[o],a=o;a!==c;++a)r[a]/=e;for(a=c-1;-1!==a;--a)i[a]/=e;for(s=u-1;-1!==s;--s)if(s!==o){for(t=d[s],n=f[s],e=t[o],a=o+1;a!==c;++a)t[a]-=r[a]*e;for(a=c-1;a>0;--a)n[a]-=i[a]*e,n[--a]-=i[a]*e;0===a&&(n[0]-=i[0]*e)}}return f},numeric.det=function(e){var t=numeric.dim(e);if(2!==t.length||t[0]!==t[1])throw new Error("numeric: det() only works on square matrices");var r,n,i,s,o,a,l,h,u=t[0],c=1,d=numeric.clone(e);for(n=0;n<u-1;n++){for(i=n,r=n+1;r<u;r++)Math.abs(d[r][n])>Math.abs(d[i][n])&&(i=r);for(i!==n&&(l=d[i],d[i]=d[n],d[n]=l,c*=-1),s=d[n],r=n+1;r<u;r++){for(a=(o=d[r])[n]/s[n],i=n+1;i<u-1;i+=2)h=i+1,o[i]-=s[i]*a,o[h]-=s[h]*a;i!==u&&(o[i]-=s[i]*a)}if(0===s[n])return 0;c*=s[n]}return c*d[n][n]},numeric.transpose=function(e){var t,r,n,i,s,o=e.length,a=e[0].length,l=Array(a);for(r=0;r<a;r++)l[r]=Array(o);for(t=o-1;t>=1;t-=2){for(i=e[t],n=e[t-1],r=a-1;r>=1;--r)(s=l[r])[t]=i[r],s[t-1]=n[r],(s=l[--r])[t]=i[r],s[t-1]=n[r];0===r&&((s=l[0])[t]=i[0],s[t-1]=n[0])}if(0===t){for(n=e[0],r=a-1;r>=1;--r)l[r][0]=n[r],l[--r][0]=n[r];0===r&&(l[0][0]=n[0])}return l},numeric.negtranspose=function(e){var t,r,n,i,s,o=e.length,a=e[0].length,l=Array(a);for(r=0;r<a;r++)l[r]=Array(o);for(t=o-1;t>=1;t-=2){for(i=e[t],n=e[t-1],r=a-1;r>=1;--r)(s=l[r])[t]=-i[r],s[t-1]=-n[r],(s=l[--r])[t]=-i[r],s[t-1]=-n[r];0===r&&((s=l[0])[t]=-i[0],s[t-1]=-n[0])}if(0===t){for(n=e[0],r=a-1;r>=1;--r)l[r][0]=-n[r],l[--r][0]=-n[r];0===r&&(l[0][0]=-n[0])}return l},numeric._random=function e(t,r){var n,i,s=t[r],o=Array(s);if(r===t.length-1){for(i=Math.random,n=s-1;n>=1;n-=2)o[n]=i(),o[n-1]=i();return 0===n&&(o[0]=i()),o}for(n=s-1;n>=0;n--)o[n]=e(t,r+1);return o},numeric.random=function(e){return numeric._random(e,0)},numeric.norm2=function(e){return Math.sqrt(numeric.norm2Squared(e))},numeric.linspace=function(e,t,r){if(void 0===r&&(r=Math.max(Math.round(t-e)+1,1)),r<2)return 1===r?[e]:[];var n,i=Array(r);for(n=--r;n>=0;n--)i[n]=(n*t+(r-n)*e)/r;return i},numeric.getBlock=function(e,t,r){var n=numeric.dim(e);return function e(i,s){var o,a=t[s],l=r[s]-a,h=Array(l);if(s===n.length-1){for(o=l;o>=0;o--)h[o]=i[o+a];return h}for(o=l;o>=0;o--)h[o]=e(i[o+a],s+1);return h}(e,0)},numeric.setBlock=function(e,t,r,n){var i=numeric.dim(e);return function e(n,s,o){var a,l=t[o],h=r[o]-l;if(o===i.length-1)for(a=h;a>=0;a--)n[a+l]=s[a];for(a=h;a>=0;a--)e(n[a+l],s[a],o+1)}(e,n,0),e},numeric.getRange=function(e,t,r){var n,i,s,o,a=t.length,l=r.length,h=Array(a);for(n=a-1;-1!==n;--n)for(h[n]=Array(l),s=h[n],o=e[t[n]],i=l-1;-1!==i;--i)s[i]=o[r[i]];return h},numeric.blockMatrix=function(e){var t=numeric.dim(e);if(t.length<4)return numeric.blockMatrix([e]);var r,n,i,s,o,a=t[0],l=t[1];for(r=0,n=0,i=0;i<a;++i)r+=e[i][0].length;for(s=0;s<l;++s)n+=e[0][s][0].length;var h=Array(r);for(i=0;i<r;++i)h[i]=Array(n);var u,c,d,f,p,m=0;for(i=0;i<a;++i){for(u=n,s=l-1;-1!==s;--s)for(u-=(o=e[i][s])[0].length,d=o.length-1;-1!==d;--d)for(p=o[d],c=h[m+d],f=p.length-1;-1!==f;--f)c[u+f]=p[f];m+=e[i][0].length}return h},numeric.tensor=function(e,t){if("number"==typeof e||"number"==typeof t)return numeric.mul(e,t);var r=numeric.dim(e),n=numeric.dim(t);if(1!==r.length||1!==n.length)throw new Error("numeric: tensor product is only defined for vectors");var i,s,o,a,l=r[0],h=n[0],u=Array(l);for(s=l-1;s>=0;s--){for(i=Array(h),a=e[s],o=h-1;o>=3;--o)i[o]=a*t[o],i[--o]=a*t[o],i[--o]=a*t[o],i[--o]=a*t[o];for(;o>=0;)i[o]=a*t[o],--o;u[s]=i}return u},numeric.T=function(e,t){this.x=e,this.y=t},numeric.t=function(e,t){return new numeric.T(e,t)},numeric.Tbinop=function(e,t,r,n,i){var s;if(numeric.indexOf,"string"!=typeof i)for(s in i="",numeric)numeric.hasOwnProperty(s)&&(e.indexOf(s)>=0||t.indexOf(s)>=0||r.indexOf(s)>=0||n.indexOf(s)>=0)&&s.length>1&&(i+="var "+s+" = numeric."+s+";\n");return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+i+"\nif(x.y) {  if(y.y) {    return new numeric.T("+n+");\n  }\n  return new numeric.T("+r+");\n}\nif(y.y) {\n  return new numeric.T("+t+");\n}\nreturn new numeric.T("+e+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var e=numeric.mul,t=numeric.div;if(this.y){var r=numeric.add(e(this.x,this.x),e(this.y,this.y));return new numeric.T(t(this.x,r),t(numeric.neg(this.y),r))}return new T(t(1,this.x))},numeric.T.prototype.div=function(e){if(e instanceof numeric.T||(e=new numeric.T(e)),e.y)return this.mul(e.reciprocal());var t=numeric.div;return this.y?new numeric.T(t(this.x,e.x),t(this.y,e.x)):new numeric.T(t(this.x,e.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var e=numeric.transpose,t=this.x,r=this.y;return r?new numeric.T(e(t),e(r)):new numeric.T(e(t))},numeric.T.prototype.transjugate=function(){var e=numeric.transpose,t=this.x,r=this.y;return r?new numeric.T(e(t),numeric.negtranspose(r)):new numeric.T(e(t))},numeric.Tunop=function(e,t,r){return"string"!=typeof r&&(r=""),Function("var x = this;\n"+r+"\nif(x.y) {  "+t+";\n}\n"+e+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var e=this;if(void 0===e.y)return new numeric.T(numeric.inv(e.x));var t,r,n,i,s,o,a,l,h,u,c,d,f,p,m,_,g,v,y=e.x.length,b=numeric.identity(y),x=numeric.rep([y,y],0),S=numeric.clone(e.x),T=numeric.clone(e.y);for(h=0;h<y;h++){for(d=(p=S[h][h])*p+(m=T[h][h])*m,c=h,u=h+1;u<y;u++)(f=(p=S[u][h])*p+(m=T[u][h])*m)>d&&(c=u,d=f);for(c!==h&&(v=S[h],S[h]=S[c],S[c]=v,v=T[h],T[h]=T[c],T[c]=v,v=b[h],b[h]=b[c],b[c]=v,v=x[h],x[h]=x[c],x[c]=v),t=S[h],r=T[h],s=b[h],o=x[h],p=t[h],m=r[h],u=h+1;u<y;u++)_=t[u],g=r[u],t[u]=(_*p+g*m)/d,r[u]=(g*p-_*m)/d;for(u=0;u<y;u++)_=s[u],g=o[u],s[u]=(_*p+g*m)/d,o[u]=(g*p-_*m)/d;for(u=h+1;u<y;u++){for(n=S[u],i=T[u],a=b[u],l=x[u],p=n[h],m=i[h],c=h+1;c<y;c++)_=t[c],g=r[c],n[c]-=_*p-g*m,i[c]-=g*p+_*m;for(c=0;c<y;c++)_=s[c],g=o[c],a[c]-=_*p-g*m,l[c]-=g*p+_*m}}for(h=y-1;h>0;h--)for(s=b[h],o=x[h],u=h-1;u>=0;u--)for(a=b[u],l=x[u],p=S[u][h],m=T[u][h],c=y-1;c>=0;c--)_=s[c],g=o[c],a[c]-=p*_-m*g,l[c]-=p*g+m*_;return new numeric.T(b,x)},numeric.T.prototype.get=function(e){var t,r=this.x,n=this.y,i=0,s=e.length;if(n){for(;i<s;)r=r[t=e[i]],n=n[t],i++;return new numeric.T(r,n)}for(;i<s;)r=r[t=e[i]],i++;return new numeric.T(r)},numeric.T.prototype.set=function(e,t){var r,n=this.x,i=this.y,s=0,o=e.length,a=t.x,l=t.y;if(0===o)return l?this.y=l:i&&(this.y=void 0),this.x=n,this;if(l){for(i||(i=numeric.rep(numeric.dim(n),0),this.y=i);s<o-1;)n=n[r=e[s]],i=i[r],s++;return n[r=e[s]]=a,i[r]=l,this}if(i){for(;s<o-1;)n=n[r=e[s]],i=i[r],s++;return n[r=e[s]]=a,i[r]=a instanceof Array?numeric.rep(numeric.dim(a),0):0,this}for(;s<o-1;)n=n[r=e[s]],s++;return n[r=e[s]]=a,this},numeric.T.prototype.getRows=function(e,t){var r,n,i=t-e+1,s=Array(i),o=this.x,a=this.y;for(r=e;r<=t;r++)s[r-e]=o[r];if(a){for(n=Array(i),r=e;r<=t;r++)n[r-e]=a[r];return new numeric.T(s,n)}return new numeric.T(s)},numeric.T.prototype.setRows=function(e,t,r){var n,i=this.x,s=this.y,o=r.x,a=r.y;for(n=e;n<=t;n++)i[n]=o[n-e];if(a)for(s||(s=numeric.rep(numeric.dim(i),0),this.y=s),n=e;n<=t;n++)s[n]=a[n-e];else if(s)for(n=e;n<=t;n++)s[n]=numeric.rep([o[n-e].length],0);return this},numeric.T.prototype.getRow=function(e){var t=this.x,r=this.y;return r?new numeric.T(t[e],r[e]):new numeric.T(t[e])},numeric.T.prototype.setRow=function(e,t){var r=this.x,n=this.y,i=t.x,s=t.y;return r[e]=i,s?(n||(n=numeric.rep(numeric.dim(r),0),this.y=n),n[e]=s):n&&(n=numeric.rep([i.length],0)),this},numeric.T.prototype.getBlock=function(e,t){var r=this.x,n=this.y,i=numeric.getBlock;return n?new numeric.T(i(r,e,t),i(n,e,t)):new numeric.T(i(r,e,t))},numeric.T.prototype.setBlock=function(e,t,r){r instanceof numeric.T||(r=new numeric.T(r));var n=this.x,i=this.y,s=numeric.setBlock,o=r.x,a=r.y;if(a)return i||(this.y=numeric.rep(numeric.dim(this),0),i=this.y),s(n,e,t,o),s(i,e,t,a),this;s(n,e,t,o),i&&s(i,e,t,numeric.rep(numeric.dim(o),0))},numeric.T.rep=function(e,t){var r=numeric.T;t instanceof r||(t=new r(t));var n=t.x,i=t.y,s=numeric.rep;return i?new r(s(e,n),s(e,i)):new r(s(e,n))},numeric.T.diag=function(e){e instanceof numeric.T||(e=new numeric.T(e));var t=e.x,r=e.y,n=numeric.diag;return r?new numeric.T(n(t),n(r)):new numeric.T(n(t))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(e){return new numeric.T(numeric.identity(e))},numeric.T.prototype.getDiag=function(){var e=numeric,t=this.x,r=this.y;return r?new e.T(e.getDiag(t),e.getDiag(r)):new e.T(e.getDiag(t))},numeric.house=function(e){var t=numeric.clone(e),r=(e[0]>=0?1:-1)*numeric.norm2(e);t[0]+=r;var n=numeric.norm2(t);if(0===n)throw new Error("eig: internal error");return numeric.div(t,n)},numeric.toUpperHessenberg=function(e){var t=numeric.dim(e);if(2!==t.length||t[0]!==t[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var r,n,i,s,o,a,l,h,u,c,d=t[0],f=numeric.clone(e),p=numeric.identity(d);for(n=0;n<d-2;n++){for(s=Array(d-n-1),r=n+1;r<d;r++)s[r-n-1]=f[r][n];if(numeric.norm2(s)>0){for(o=numeric.house(s),a=numeric.getBlock(f,[n+1,n],[d-1,d-1]),l=numeric.tensor(o,numeric.dot(o,a)),r=n+1;r<d;r++)for(h=f[r],u=l[r-n-1],i=n;i<d;i++)h[i]-=2*u[i-n];for(a=numeric.getBlock(f,[0,n+1],[d-1,d-1]),l=numeric.tensor(numeric.dot(a,o),o),r=0;r<d;r++)for(h=f[r],u=l[r],i=n+1;i<d;i++)h[i]-=2*u[i-n-1];for(a=Array(d-n-1),r=n+1;r<d;r++)a[r-n-1]=p[r];for(l=numeric.tensor(o,numeric.dot(o,a)),r=n+1;r<d;r++)for(c=p[r],u=l[r-n-1],i=0;i<d;i++)c[i]-=2*u[i]}}return{H:f,Q:p}},numeric.epsilon=2220446049250313e-31,numeric.QRFrancis=function(e,t){void 0===t&&(t=1e4),e=numeric.clone(e),numeric.clone(e);var r,n,i,s,o,a,l,h,u,c,d,f,p,m,_,g,v,y,b=numeric.dim(e)[0],x=numeric.identity(b);if(b<3)return{Q:x,B:[[0,b-1]]};var S=numeric.epsilon;for(y=0;y<t;y++){for(g=0;g<b-1;g++)if(Math.abs(e[g+1][g])<S*(Math.abs(e[g][g])+Math.abs(e[g+1][g+1]))){var T=numeric.QRFrancis(numeric.getBlock(e,[0,0],[g,g]),t),E=numeric.QRFrancis(numeric.getBlock(e,[g+1,g+1],[b-1,b-1]),t);for(f=Array(g+1),_=0;_<=g;_++)f[_]=x[_];for(p=numeric.dot(T.Q,f),_=0;_<=g;_++)x[_]=p[_];for(f=Array(b-g-1),_=g+1;_<b;_++)f[_-g-1]=x[_];for(p=numeric.dot(E.Q,f),_=g+1;_<b;_++)x[_]=p[_-g-1];return{Q:x,B:T.B.concat(numeric.add(E.B,g+1))}}var A,w,C;for(i=e[b-2][b-2],s=e[b-2][b-1],o=e[b-1][b-2],h=i+(a=e[b-1][b-1]),l=i*a-s*o,u=numeric.getBlock(e,[0,0],[2,2]),h*h>=4*l?(A=.5*(h+Math.sqrt(h*h-4*l)),w=.5*(h-Math.sqrt(h*h-4*l)),u=numeric.add(numeric.sub(numeric.dot(u,u),numeric.mul(u,A+w)),numeric.diag(numeric.rep([3],A*w)))):u=numeric.add(numeric.sub(numeric.dot(u,u),numeric.mul(u,h)),numeric.diag(numeric.rep([3],l))),r=[u[0][0],u[1][0],u[2][0]],n=numeric.house(r),f=[e[0],e[1],e[2]],p=numeric.tensor(n,numeric.dot(n,f)),_=0;_<3;_++)for(d=e[_],m=p[_],v=0;v<b;v++)d[v]-=2*m[v];for(f=numeric.getBlock(e,[0,0],[b-1,2]),p=numeric.tensor(numeric.dot(f,n),n),_=0;_<b;_++)for(d=e[_],m=p[_],v=0;v<3;v++)d[v]-=2*m[v];for(f=[x[0],x[1],x[2]],p=numeric.tensor(n,numeric.dot(n,f)),_=0;_<3;_++)for(c=x[_],m=p[_],v=0;v<b;v++)c[v]-=2*m[v];for(g=0;g<b-2;g++){for(v=g;v<=g+1;v++)if(Math.abs(e[v+1][v])<S*(Math.abs(e[v][v])+Math.abs(e[v+1][v+1]))){for(T=numeric.QRFrancis(numeric.getBlock(e,[0,0],[v,v]),t),E=numeric.QRFrancis(numeric.getBlock(e,[v+1,v+1],[b-1,b-1]),t),f=Array(v+1),_=0;_<=v;_++)f[_]=x[_];for(p=numeric.dot(T.Q,f),_=0;_<=v;_++)x[_]=p[_];for(f=Array(b-v-1),_=v+1;_<b;_++)f[_-v-1]=x[_];for(p=numeric.dot(E.Q,f),_=v+1;_<b;_++)x[_]=p[_-v-1];return{Q:x,B:T.B.concat(numeric.add(E.B,v+1))}}for(C=Math.min(b-1,g+3),r=Array(C-g),_=g+1;_<=C;_++)r[_-g-1]=e[_][g];for(n=numeric.house(r),f=numeric.getBlock(e,[g+1,g],[C,b-1]),p=numeric.tensor(n,numeric.dot(n,f)),_=g+1;_<=C;_++)for(d=e[_],m=p[_-g-1],v=g;v<b;v++)d[v]-=2*m[v-g];for(f=numeric.getBlock(e,[0,g+1],[b-1,C]),p=numeric.tensor(numeric.dot(f,n),n),_=0;_<b;_++)for(d=e[_],m=p[_],v=g+1;v<=C;v++)d[v]-=2*m[v-g-1];for(f=Array(C-g),_=g+1;_<=C;_++)f[_-g-1]=x[_];for(p=numeric.tensor(n,numeric.dot(n,f)),_=g+1;_<=C;_++)for(c=x[_],m=p[_-g-1],v=0;v<b;v++)c[v]-=2*m[v]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(e,t){var r,n,i,s,o,a,l,h,u,c,d,f,p,m,_,g,v=numeric.toUpperHessenberg(e),y=numeric.QRFrancis(v.H,t),b=numeric.T,x=e.length,S=y.B,T=numeric.dot(y.Q,numeric.dot(v.H,numeric.transpose(y.Q))),E=new b(numeric.dot(y.Q,v.Q)),A=S.length,w=Math.sqrt;for(n=0;n<A;n++)if((r=S[n][0])===S[n][1]);else{if(s=r+1,o=T[r][r],a=T[r][s],l=T[s][r],h=T[s][s],0===a&&0===l)continue;(c=(u=-o-h)*u-4*(o*h-a*l))>=0?((_=(o-(d=u<0?-.5*(u-w(c)):-.5*(u+w(c))))*(o-d)+a*a)>(g=l*l+(h-d)*(h-d))?(p=(o-d)/(_=w(_)),m=a/_):(p=l/(g=w(g)),m=(h-d)/g),i=new b([[m,-p],[p,m]]),E.setRows(r,s,i.dot(E.getRows(r,s)))):(d=-.5*u,f=.5*w(-c),(_=(o-d)*(o-d)+a*a)>(g=l*l+(h-d)*(h-d))?(p=(o-d)/(_=w(_+f*f)),m=a/_,d=0,f/=_):(p=l/(g=w(g+f*f)),m=(h-d)/g,d=f/g,f=0),i=new b([[m,-p],[p,m]],[[d,f],[f,-d]]),E.setRows(r,s,i.dot(E.getRows(r,s))))}var C=E.dot(e).dot(E.transjugate()),O=(x=e.length,numeric.T.identity(x));for(s=0;s<x;s++)if(s>0)for(n=s-1;n>=0;n--){var R=C.get([n,n]),D=C.get([s,s]);numeric.neq(R.x,D.x)||numeric.neq(R.y,D.y)?(d=C.getRow(n).getBlock([n],[s-1]),f=O.getRow(s).getBlock([n],[s-1]),O.set([s,n],C.get([n,s]).neg().sub(d.dot(f)).div(R.sub(D)))):O.setRow(s,O.getRow(n))}for(s=0;s<x;s++)d=O.getRow(s),O.setRow(s,d.div(d.norm2()));return O=O.transpose(),O=E.transjugate().dot(O),{lambda:C.getDiag(),E:O}},numeric.ccsSparse=function(e){var t,r,n,i=e.length,s=[];for(r=i-1;-1!==r;--r)for(n in t=e[r]){for(n=parseInt(n);n>=s.length;)s[s.length]=0;0!==t[n]&&s[n]++}var o=s.length,a=Array(o+1);for(a[0]=0,r=0;r<o;++r)a[r+1]=a[r]+s[r];var l=Array(a[o]),h=Array(a[o]);for(r=i-1;-1!==r;--r)for(n in t=e[r])0!==t[n]&&(s[n]--,l[a[n]+s[n]]=r,h[a[n]+s[n]]=t[n]);return[a,l,h]},numeric.ccsFull=function(e){var t,r,n,i,s=e[0],o=e[1],a=e[2],l=numeric.ccsDim(e),h=l[0],u=l[1],c=numeric.rep([h,u],0);for(t=0;t<u;t++)for(n=s[t],i=s[t+1],r=n;r<i;++r)c[o[r]][t]=a[r];return c},numeric.ccsTSolve=function(e,t,r,n,i){var s,o,a,l,h,u,c,d=e[0],f=e[1],p=e[2],m=d.length-1,_=Math.max,g=0;function v(e){var t;if(0===r[e]){for(r[e]=1,t=d[e];t<d[e+1];++t)v(f[t]);i[g]=e,++g}}for(void 0===n&&(r=numeric.rep([m],0)),void 0===n&&(n=numeric.linspace(0,r.length-1)),void 0===i&&(i=[]),s=n.length-1;-1!==s;--s)v(n[s]);for(i.length=g,s=i.length-1;-1!==s;--s)r[i[s]]=0;for(s=n.length-1;-1!==s;--s)o=n[s],r[o]=t[o];for(s=i.length-1;-1!==s;--s){for(o=i[s],a=d[o],l=_(d[o+1],a),h=a;h!==l;++h)if(f[h]===o){r[o]/=p[h];break}for(c=r[o],h=a;h!==l;++h)(u=f[h])!==o&&(r[u]-=c*p[h])}return r},numeric.ccsDFS=function(e){this.k=Array(e),this.k1=Array(e),this.j=Array(e)},numeric.ccsDFS.prototype.dfs=function(e,t,r,n,i,s){var o,a,l,h=0,u=i.length,c=this.k,d=this.k1,f=this.j;if(0===n[e])for(n[e]=1,f[0]=e,c[0]=a=t[e],d[0]=l=t[e+1];;)if(a>=l){if(i[u]=f[h],0===h)return;++u,a=c[--h],l=d[h]}else 0===n[o=s[r[a]]]?(n[o]=1,c[h]=a,f[++h]=o,a=t[o],d[h]=l=t[o+1]):++a},numeric.ccsLPSolve=function(e,t,r,n,i,s,o){var a=e[0],l=e[1],h=e[2];a.length;var u,c,d,f,p,m,_,g,v,y=t[0],b=t[1],x=t[2];for(c=y[i],d=y[i+1],n.length=0,u=c;u<d;++u)o.dfs(s[b[u]],a,l,r,n,s);for(u=n.length-1;-1!==u;--u)r[n[u]]=0;for(u=c;u!==d;++u)r[f=s[b[u]]]=x[u];for(u=n.length-1;-1!==u;--u){for(p=a[f=n[u]],m=a[f+1],_=p;_<m;++_)if(s[l[_]]===f){r[f]/=h[_];break}for(v=r[f],_=p;_<m;++_)(g=s[l[_]])!==f&&(r[g]-=v*h[_])}return r},numeric.ccsLUP1=function(e,t){var r,n,i,s,o,a,l,h=e[0].length-1,u=[numeric.rep([h+1],0),[],[]],c=[numeric.rep([h+1],0),[],[]],d=u[0],f=u[1],p=u[2],m=c[0],_=c[1],g=c[2],v=numeric.rep([h],0),y=numeric.rep([h],0),b=numeric.ccsLPSolve,x=Math.abs,S=numeric.linspace(0,h-1),T=numeric.linspace(0,h-1),E=new numeric.ccsDFS(h);for(void 0===t&&(t=1),r=0;r<h;++r){for(b(u,e,v,y,r,T,E),s=-1,o=-1,n=y.length-1;-1!==n;--n)(i=y[n])<=r||(a=x(v[i]))>s&&(o=i,s=a);for(x(v[r])<t*s&&(n=S[r],s=S[o],S[r]=s,T[s]=r,S[o]=n,T[n]=o,s=v[r],v[r]=v[o],v[o]=s),s=d[r],o=m[r],l=v[r],f[s]=S[r],p[s]=1,++s,n=y.length-1;-1!==n;--n)a=v[i=y[n]],y[n]=0,v[i]=0,i<=r?(_[o]=i,g[o]=a,++o):(f[s]=S[i],p[s]=a/l,++s);d[r+1]=s,m[r+1]=o}for(n=f.length-1;-1!==n;--n)f[n]=T[f[n]];return{L:u,U:c,P:S,Pinv:T}},numeric.ccsDFS0=function(e){this.k=Array(e),this.k1=Array(e),this.j=Array(e)},numeric.ccsDFS0.prototype.dfs=function(e,t,r,n,i,s,o){var a,l,h,u=0,c=i.length,d=this.k,f=this.k1,p=this.j;if(0===n[e])for(n[e]=1,p[0]=e,d[0]=l=t[s[e]],f[0]=h=t[s[e]+1];;){if(isNaN(l))throw new Error("Ow!");if(l>=h){if(i[c]=s[p[u]],0===u)return;++c,l=d[--u],h=f[u]}else 0===n[a=r[l]]?(n[a]=1,d[u]=l,p[++u]=a,l=t[a=s[a]],f[u]=h=t[a+1]):++l}},numeric.ccsLPSolve0=function(e,t,r,n,i,s,o,a){var l=e[0],h=e[1],u=e[2];l.length;var c,d,f,p,m,_,g,v,y,b=t[0],x=t[1],S=t[2];for(d=b[i],f=b[i+1],n.length=0,c=d;c<f;++c)a.dfs(x[c],l,h,r,n,s,o);for(c=n.length-1;-1!==c;--c)r[o[p=n[c]]]=0;for(c=d;c!==f;++c)r[p=x[c]]=S[c];for(c=n.length-1;-1!==c;--c){for(v=o[p=n[c]],m=l[p],_=l[p+1],g=m;g<_;++g)if(h[g]===v){r[v]/=u[g];break}for(y=r[v],g=m;g<_;++g)r[h[g]]-=y*u[g];r[v]=y}},numeric.ccsLUP0=function(e,t){var r,n,i,s,o,a,l,h=e[0].length-1,u=[numeric.rep([h+1],0),[],[]],c=[numeric.rep([h+1],0),[],[]],d=u[0],f=u[1],p=u[2],m=c[0],_=c[1],g=c[2],v=numeric.rep([h],0),y=numeric.rep([h],0),b=numeric.ccsLPSolve0,x=Math.abs,S=numeric.linspace(0,h-1),T=numeric.linspace(0,h-1),E=new numeric.ccsDFS0(h);for(void 0===t&&(t=1),r=0;r<h;++r){for(b(u,e,v,y,r,T,S,E),s=-1,o=-1,n=y.length-1;-1!==n;--n)(i=y[n])<=r||(a=x(v[S[i]]))>s&&(o=i,s=a);for(x(v[S[r]])<t*s&&(n=S[r],s=S[o],S[r]=s,T[s]=r,S[o]=n,T[n]=o),s=d[r],o=m[r],l=v[S[r]],f[s]=S[r],p[s]=1,++s,n=y.length-1;-1!==n;--n)a=v[S[i=y[n]]],y[n]=0,v[S[i]]=0,i<=r?(_[o]=i,g[o]=a,++o):(f[s]=S[i],p[s]=a/l,++s);d[r+1]=s,m[r+1]=o}for(n=f.length-1;-1!==n;--n)f[n]=T[f[n]];return{L:u,U:c,P:S,Pinv:T}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(e){return[numeric.sup(e[1])+1,e[0].length-1]},numeric.ccsGetBlock=function(e,t,r){var n=numeric.ccsDim(e),i=n[0],s=n[1];void 0===t?t=numeric.linspace(0,i-1):"number"==typeof t&&(t=[t]),void 0===r?r=numeric.linspace(0,s-1):"number"==typeof r&&(r=[r]);var o,a,l,h,u=t.length,c=r.length,d=numeric.rep([s],0),f=[],p=[],m=[d,f,p],_=e[0],g=e[1],v=e[2],y=numeric.rep([i],0),b=0,x=numeric.rep([i],0);for(a=0;a<c;++a){var S=_[h=r[a]],T=_[h+1];for(o=S;o<T;++o)x[l=g[o]]=1,y[l]=v[o];for(o=0;o<u;++o)x[t[o]]&&(f[b]=o,p[b]=y[t[o]],++b);for(o=S;o<T;++o)x[l=g[o]]=0;d[a+1]=b}return m},numeric.ccsDot=function(e,t){var r=e[0],n=e[1],i=e[2],s=t[0],o=t[1],a=t[2],l=numeric.ccsDim(e),h=numeric.ccsDim(t),u=l[0];l[1];var c,d,f,p,m,_,g,v,y,b,x,S=h[1],T=numeric.rep([u],0),E=numeric.rep([u],0),A=Array(u),w=numeric.rep([S],0),C=[],O=[],R=[w,C,O];for(f=0;f!==S;++f){for(p=s[f],m=s[f+1],y=0,d=p;d<m;++d)for(b=o[d],x=a[d],_=r[b],g=r[b+1],c=_;c<g;++c)0===E[v=n[c]]&&(A[y]=v,E[v]=1,y+=1),T[v]=T[v]+i[c]*x;for(m=(p=w[f])+y,w[f+1]=m,d=y-1;-1!==d;--d)x=p+d,c=A[d],C[x]=c,O[x]=T[c],E[c]=0,T[c]=0;w[f+1]=w[f]+y}return R},numeric.ccsLUPSolve=function(e,t){var r=e.L,n=e.U;e.P;var i=t[0],s=!1;"object"!=typeof i&&(i=(t=[[0,t.length],numeric.linspace(0,t.length-1),t])[0],s=!0);var o,a,l,h,u,c,d=t[1],f=t[2],p=r[0].length-1,m=i.length-1,_=numeric.rep([p],0),g=Array(p),v=numeric.rep([p],0),y=Array(p),b=numeric.rep([m+1],0),x=[],S=[],T=numeric.ccsTSolve,E=0;for(o=0;o<m;++o){for(u=0,l=i[o],h=i[o+1],a=l;a<h;++a)c=e.Pinv[d[a]],y[u]=c,v[c]=f[a],++u;for(y.length=u,T(r,v,_,y,g),a=y.length-1;-1!==a;--a)v[y[a]]=0;if(T(n,_,v,g,y),s)return v;for(a=g.length-1;-1!==a;--a)_[g[a]]=0;for(a=y.length-1;-1!==a;--a)c=y[a],x[E]=c,S[E]=v[c],v[c]=0,++E;b[o+1]=E}return[b,x,S]},numeric.ccsbinop=function(e,t){return void 0===t&&(t=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+t+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+e+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(e){var t,r=e[0],n=e[1],i=e[2],s=numeric.sup(n)+1,o=r.length,a=numeric.rep([s],0),l=Array(o),h=Array(o),u=numeric.rep([s],0);for(t=0;t<o;++t)u[n[t]]++;for(t=0;t<s;++t)a[t+1]=a[t]+u[t];var c,d,f=a.slice(0);for(t=0;t<o;++t)l[c=f[d=n[t]]]=r[t],h[c]=i[t],f[d]=f[d]+1;return[a,l,h]},numeric.ccsGather=function(e){var t,r,n,i,s,o=e[0],a=e[1],l=e[2],h=o.length-1,u=a.length,c=Array(u),d=Array(u),f=Array(u);for(s=0,t=0;t<h;++t)for(n=o[t],i=o[t+1],r=n;r!==i;++r)d[s]=t,c[s]=a[r],f[s]=l[r],++s;return[c,d,f]},numeric.sdim=function e(t,r,n){if(void 0===r&&(r=[]),"object"!=typeof t)return r;var i;for(i in void 0===n&&(n=0),n in r||(r[n]=0),t.length>r[n]&&(r[n]=t.length),t)t.hasOwnProperty(i)&&e(t[i],r,n+1);return r},numeric.sclone=function e(t,r,n){void 0===r&&(r=0),void 0===n&&(n=numeric.sdim(t).length);var i,s=Array(t.length);if(r===n-1){for(i in t)t.hasOwnProperty(i)&&(s[i]=t[i]);return s}for(i in t)t.hasOwnProperty(i)&&(s[i]=e(t[i],r+1,n));return s},numeric.sdiag=function(e){var t,r,n=e.length,i=Array(n);for(t=n-1;t>=1;t-=2)r=t-1,i[t]=[],i[t][t]=e[t],i[r]=[],i[r][r]=e[r];return 0===t&&(i[0]=[],i[0][0]=e[t]),i},numeric.sidentity=function(e){return numeric.sdiag(numeric.rep([e],1))},numeric.stranspose=function(e){var t,r,n,i=[];for(t in e.length,e)if(e.hasOwnProperty(t))for(r in n=e[t])n.hasOwnProperty(r)&&("object"!=typeof i[r]&&(i[r]=[]),i[r][t]=n[r]);return i},numeric.sLUP=function(e,t){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(e,t){var r=e.length;t.length;var n,i,s,o,a,l,h,u=numeric.stranspose(t),c=u.length,d=Array(r);for(s=r-1;s>=0;s--){for(h=[],n=e[s],a=c-1;a>=0;a--){for(o in l=0,i=u[a],n)n.hasOwnProperty(o)&&o in i&&(l+=n[o]*i[o]);l&&(h[a]=l)}d[s]=h}return d},numeric.sdotMV=function(e,t){var r,n,i,s,o=e.length,a=Array(o);for(n=o-1;n>=0;n--){for(i in s=0,r=e[n])r.hasOwnProperty(i)&&t[i]&&(s+=r[i]*t[i]);s&&(a[n]=s)}return a},numeric.sdotVM=function(e,t){var r,n,i,s,o=[];for(r in e)if(e.hasOwnProperty(r))for(n in i=t[r],s=e[r],i)i.hasOwnProperty(n)&&(o[n]||(o[n]=0),o[n]+=s*i[n]);return o},numeric.sdotVV=function(e,t){var r,n=0;for(r in e)e[r]&&t[r]&&(n+=e[r]*t[r]);return n},numeric.sdot=function(e,t){var r=numeric.sdim(e).length,n=numeric.sdim(t).length;switch(1e3*r+n){case 0:return e*t;case 1001:return numeric.sdotVV(e,t);case 2001:return numeric.sdotMV(e,t);case 1002:return numeric.sdotVM(e,t);case 2002:return numeric.sdotMM(e,t);default:throw new Error("numeric.sdot not implemented for tensors of order "+r+" and "+n)}},numeric.sscatter=function(e){var t,r,n,i,s=e[0].length,o=e.length,a=[];for(r=s-1;r>=0;--r)if(e[o-1][r]){for(i=a,n=0;n<o-2;n++)i[t=e[n][r]]||(i[t]=[]),i=i[t];i[e[n][r]]=e[n+1][r]}return a},numeric.sgather=function e(t,r,n){var i,s,o;for(s in void 0===r&&(r=[]),void 0===n&&(n=[]),i=n.length,t)if(t.hasOwnProperty(s))if(n[i]=parseInt(s),"number"==typeof(o=t[s])){if(o){if(0===r.length)for(s=i+1;s>=0;--s)r[s]=[];for(s=i;s>=0;--s)r[s].push(n[s]);r[i+1].push(o)}}else e(o,r,n);return n.length>i&&n.pop(),r},numeric.cLU=function(e){var t,r,n,i,s,o,a=e[0],l=e[1],h=e[2],u=a.length,c=0;for(t=0;t<u;t++)a[t]>c&&(c=a[t]);c++;var d,f=Array(c),p=Array(c),m=numeric.rep([c],1/0),_=numeric.rep([c],-1/0);for(n=0;n<u;n++)t=a[n],(r=l[n])<m[t]&&(m[t]=r),r>_[t]&&(_[t]=r);for(t=0;t<c-1;t++)_[t]>_[t+1]&&(_[t+1]=_[t]);for(t=c-1;t>=1;t--)m[t]<m[t-1]&&(m[t-1]=m[t]);for(t=0;t<c;t++)p[t]=numeric.rep([_[t]-m[t]+1],0),f[t]=numeric.rep([t-m[t]],0),m[t],_[t];for(n=0;n<u;n++)p[t=a[n]][l[n]-m[t]]=h[n];for(t=0;t<c-1;t++)for(i=t-m[t],y=p[t],r=t+1;m[r]<=t&&r<c;r++)if(s=t-m[r],o=_[t]-t,d=(b=p[r])[s]/y[i]){for(n=1;n<=o;n++)b[n+s]-=d*y[n+i];f[r][t-m[r]]=d}var g,v,y=[],b=[],x=[],S=[],T=[],E=[];for(u=0,g=0,t=0;t<c;t++){for(i=m[t],s=_[t],v=p[t],r=t;r<=s;r++)v[r-i]&&(y[u]=t,b[u]=r,x[u]=v[r-i],u++);for(v=f[t],r=i;r<t;r++)v[r-i]&&(S[g]=t,T[g]=r,E[g]=v[r-i],g++);S[g]=t,T[g]=t,E[g]=1,g++}return{U:[y,b,x],L:[S,T,E]}},numeric.cLUsolve=function(e,t){var r=e.L,n=e.U,i=numeric.clone(t),s=r[0],o=r[1],a=r[2],l=n[0],h=n[1],u=n[2],c=l.length;s.length;var d,f,p=i.length;for(f=0,d=0;d<p;d++){for(;o[f]<d;)i[d]-=a[f]*i[o[f]],f++;f++}for(f=c-1,d=p-1;d>=0;d--){for(;h[f]>d;)i[d]-=u[f]*i[h[f]],f--;i[d]/=u[f],f--}return i},numeric.cgrid=function(e,t){"number"==typeof e&&(e=[e,e]);var r,n,i,s=numeric.rep(e,-1);for("function"!=typeof t&&(t="L"===t?function(t,r){return t>=e[0]/2||r<e[1]/2}:function(e,t){return!0}),i=0,r=1;r<e[0]-1;r++)for(n=1;n<e[1]-1;n++)t(r,n)&&(s[r][n]=i,i++);return s},numeric.cdelsq=function(e){var t,r,n,i,s,o=[[-1,0],[0,-1],[0,1],[1,0]],a=numeric.dim(e),l=a[0],h=a[1],u=[],c=[],d=[];for(t=1;t<l-1;t++)for(r=1;r<h-1;r++)if(!(e[t][r]<0)){for(n=0;n<4;n++)i=t+o[n][0],s=r+o[n][1],e[i][s]<0||(u.push(e[t][r]),c.push(e[i][s]),d.push(-1));u.push(e[t][r]),c.push(e[t][r]),d.push(4)}return[u,c,d]},numeric.cdotMV=function(e,t){var r,n,i,s=e[0],o=e[1],a=e[2],l=s.length;for(i=0,n=0;n<l;n++)s[n]>i&&(i=s[n]);for(i++,r=numeric.rep([i],0),n=0;n<l;n++)r[s[n]]+=a[n]*t[o[n]];return r},numeric.Spline=function(e,t,r,n,i){this.x=e,this.yl=t,this.yr=r,this.kl=n,this.kr=i},numeric.Spline.prototype._at=function(e,t){var r,n,i,s=this.x,o=this.yl,a=this.yr,l=this.kl,h=this.kr,u=numeric.add,c=numeric.sub,d=numeric.mul;r=c(d(l[t],s[t+1]-s[t]),c(a[t+1],o[t])),n=u(d(h[t+1],s[t]-s[t+1]),c(a[t+1],o[t]));var f=(i=(e-s[t])/(s[t+1]-s[t]))*(1-i);return u(u(u(d(1-i,o[t]),d(i,a[t+1])),d(r,f*(1-i))),d(n,f*i))},numeric.Spline.prototype.at=function(e){if("number"==typeof e){var t,r,n,i=this.x,s=i.length,o=Math.floor;for(t=0,r=s-1;r-t>1;)i[n=o((t+r)/2)]<=e?t=n:r=n;return this._at(e,t)}s=e.length;var a,l=Array(s);for(a=s-1;-1!==a;--a)l[a]=this.at(e[a]);return l},numeric.Spline.prototype.diff=function(){var e,t,r,n=this.x,i=this.yl,s=this.yr,o=this.kl,a=this.kr,l=i.length,h=o,u=a,c=Array(l),d=Array(l),f=numeric.add,p=numeric.mul,m=numeric.div,_=numeric.sub;for(e=l-1;-1!==e;--e)t=n[e+1]-n[e],r=_(s[e+1],i[e]),c[e]=m(f(p(r,6),p(o[e],-4*t),p(a[e+1],-2*t)),t*t),d[e+1]=m(f(p(r,-6),p(o[e],2*t),p(a[e+1],4*t)),t*t);return new numeric.Spline(n,h,u,c,d)},numeric.Spline.prototype.roots=function(){function e(e){return e*e}var t=[],r=this.x,n=this.yl,i=this.yr,s=this.kl,o=this.kr;"number"==typeof n[0]&&(n=[n],i=[i],s=[s],o=[o]);var a,l,h,u,c,d,f,p,m,_,g,v,y,b,x,S,T,E,A,w,C,O,R,D=n.length,I=r.length-1,M=(t=Array(D),Math.sqrt);for(a=0;a!==D;++a){for(u=n[a],c=i[a],d=s[a],f=o[a],p=[],l=0;l!==I;l++){for(l>0&&c[l]*u[l]<0&&p.push(r[l]),S=r[l+1]-r[l],g=u[l],v=c[l+1],m=d[l]/S,y=(_=f[l+1]/S)+3*g+2*m-3*v,b=3*(_+m+2*(g-v)),(x=e(m-_+3*(g-v))+12*_*g)<=0?T=(E=y/b)>r[l]&&E<r[l+1]?[r[l],E,r[l+1]]:[r[l],r[l+1]]:(E=(y-M(x))/b,A=(y+M(x))/b,T=[r[l]],E>r[l]&&E<r[l+1]&&T.push(E),A>r[l]&&A<r[l+1]&&T.push(A),T.push(r[l+1])),C=T[0],E=this._at(C,l),h=0;h<T.length-1;h++)if(O=T[h+1],A=this._at(O,l),0!==E)if(0===A||E*A>0)C=O,E=A;else{for(var N=0;!((R=(E*O-A*C)/(E-A))<=C||R>=O);)if((w=this._at(R,l))*A>0)O=R,A=w,-1===N&&(E*=.5),N=-1;else{if(!(w*E>0))break;C=R,E=w,1===N&&(A*=.5),N=1}p.push(R),C=T[h+1],E=this._at(C,l)}else p.push(C),C=O,E=A;0===A&&p.push(O)}t[a]=p}return"number"==typeof this.yl[0]?t[0]:t},numeric.spline=function(e,t,r,n){var i,s=e.length,o=[],a=[],l=[],h=numeric.sub,u=numeric.mul,c=numeric.add;for(i=s-2;i>=0;i--)a[i]=e[i+1]-e[i],l[i]=h(t[i+1],t[i]);"string"!=typeof r&&"string"!=typeof n||(r=n="periodic");var d=[[],[],[]];switch(typeof r){case"undefined":o[0]=u(3/(a[0]*a[0]),l[0]),d[0].push(0,0),d[1].push(0,1),d[2].push(2/a[0],1/a[0]);break;case"string":o[0]=c(u(3/(a[s-2]*a[s-2]),l[s-2]),u(3/(a[0]*a[0]),l[0])),d[0].push(0,0,0),d[1].push(s-2,0,1),d[2].push(1/a[s-2],2/a[s-2]+2/a[0],1/a[0]);break;default:o[0]=r,d[0].push(0),d[1].push(0),d[2].push(1)}for(i=1;i<s-1;i++)o[i]=c(u(3/(a[i-1]*a[i-1]),l[i-1]),u(3/(a[i]*a[i]),l[i])),d[0].push(i,i,i),d[1].push(i-1,i,i+1),d[2].push(1/a[i-1],2/a[i-1]+2/a[i],1/a[i]);switch(typeof n){case"undefined":o[s-1]=u(3/(a[s-2]*a[s-2]),l[s-2]),d[0].push(s-1,s-1),d[1].push(s-2,s-1),d[2].push(1/a[s-2],2/a[s-2]);break;case"string":d[1][d[1].length-1]=0;break;default:o[s-1]=n,d[0].push(s-1),d[1].push(s-1),d[2].push(1)}o="number"!=typeof o[0]?numeric.transpose(o):[o];var f=Array(o.length);if("string"==typeof r)for(i=f.length-1;-1!==i;--i)f[i]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(d)),o[i]),f[i][s-1]=f[i][0];else for(i=f.length-1;-1!==i;--i)f[i]=numeric.cLUsolve(numeric.cLU(d),o[i]);return f="number"==typeof t[0]?f[0]:numeric.transpose(f),new numeric.Spline(e,t,t,f,f)},numeric.fftpow2=function e(t,r){var n=t.length;if(1!==n){var i,s,o=Math.cos,a=Math.sin,l=Array(n/2),h=Array(n/2),u=Array(n/2),c=Array(n/2);for(s=n/2,i=n-1;-1!==i;--i)u[--s]=t[i],c[s]=r[i],--i,l[s]=t[i],h[s]=r[i];e(l,h),e(u,c),s=n/2;var d,f,p,m=-6.283185307179586/n;for(i=n-1;-1!==i;--i)-1==--s&&(s=n/2-1),f=o(d=m*i),p=a(d),t[i]=l[s]+f*u[s]-p*c[s],r[i]=h[s]+f*c[s]+p*u[s]}},numeric._ifftpow2=function e(t,r){var n=t.length;if(1!==n){var i,s,o=Math.cos,a=Math.sin,l=Array(n/2),h=Array(n/2),u=Array(n/2),c=Array(n/2);for(s=n/2,i=n-1;-1!==i;--i)u[--s]=t[i],c[s]=r[i],--i,l[s]=t[i],h[s]=r[i];e(l,h),e(u,c),s=n/2;var d,f,p,m=6.283185307179586/n;for(i=n-1;-1!==i;--i)-1==--s&&(s=n/2-1),f=o(d=m*i),p=a(d),t[i]=l[s]+f*u[s]-p*c[s],r[i]=h[s]+f*c[s]+p*u[s]}},numeric.ifftpow2=function(e,t){numeric._ifftpow2(e,t),numeric.diveq(e,e.length),numeric.diveq(t,t.length)},numeric.convpow2=function(e,t,r,n){var i,s,o,a,l;for(numeric.fftpow2(e,t),numeric.fftpow2(r,n),i=e.length-1;-1!==i;--i)s=e[i],a=t[i],o=r[i],l=n[i],e[i]=s*o-a*l,t[i]=s*l+a*o;numeric.ifftpow2(e,t)},numeric.T.prototype.fft=function(){var e,t,r=this.x,n=this.y,i=r.length,s=Math.log,o=s(2),a=Math.ceil(s(2*i-1)/o),l=Math.pow(2,a),h=numeric.rep([l],0),u=numeric.rep([l],0),c=Math.cos,d=Math.sin,f=-3.141592653589793/i,p=numeric.rep([l],0),m=numeric.rep([l],0);for(e=0;e<i;e++)p[e]=r[e];if(void 0!==n)for(e=0;e<i;e++)m[e]=n[e];for(h[0]=1,e=1;e<=l/2;e++)t=f*e*e,h[e]=c(t),u[e]=d(t),h[l-e]=c(t),u[l-e]=d(t);var _=new numeric.T(p,m),g=new numeric.T(h,u);return _=_.mul(g),numeric.convpow2(_.x,_.y,numeric.clone(g.x),numeric.neg(g.y)),(_=_.mul(g)).x.length=i,_.y.length=i,_},numeric.T.prototype.ifft=function(){var e,t,r=this.x,n=this.y,i=r.length,s=Math.log,o=s(2),a=Math.ceil(s(2*i-1)/o),l=Math.pow(2,a),h=numeric.rep([l],0),u=numeric.rep([l],0),c=Math.cos,d=Math.sin,f=3.141592653589793/i,p=numeric.rep([l],0),m=numeric.rep([l],0);for(e=0;e<i;e++)p[e]=r[e];if(void 0!==n)for(e=0;e<i;e++)m[e]=n[e];for(h[0]=1,e=1;e<=l/2;e++)t=f*e*e,h[e]=c(t),u[e]=d(t),h[l-e]=c(t),u[l-e]=d(t);var _=new numeric.T(p,m),g=new numeric.T(h,u);return _=_.mul(g),numeric.convpow2(_.x,_.y,numeric.clone(g.x),numeric.neg(g.y)),(_=_.mul(g)).x.length=i,_.y.length=i,_.div(i)},numeric.gradient=function(e,t){var r=t.length,n=e(t);if(isNaN(n))throw new Error("gradient: f(x) is a NaN!");var i,s,o,a=Math.max,l=numeric.clone(t),h=Array(r);numeric.div,numeric.sub,a=Math.max;var u,c,d,f,p,m,_=Math.abs,g=Math.min,v=0;for(i=0;i<r;i++)for(var y=a(1e-6*n,1e-8);;){if(++v>20)throw new Error("Numerical gradient fails");if(l[i]=t[i]+y,s=e(l),l[i]=t[i]-y,o=e(l),l[i]=t[i],isNaN(s)||isNaN(o))y/=16;else{if(h[i]=(s-o)/(2*y),u=t[i]-y,c=t[i],d=t[i]+y,f=(s-n)/y,p=(n-o)/y,m=a(_(h[i]),_(n),_(s),_(o),_(u),_(c),_(d),1e-8),!(g(a(_(f-h[i]),_(p-h[i]),_(f-p))/m,y/m)>.001))break;y/=16}}return h},numeric.uncmin=function(e,t,r,n,i,s,o){var a=numeric.gradient;void 0===o&&(o={}),void 0===r&&(r=1e-8),void 0===n&&(n=function(t){return a(e,t)}),void 0===i&&(i=1e3);var l,h,u=(t=numeric.clone(t)).length,c=e(t);if(isNaN(c))throw new Error("uncmin: f(x0) is a NaN!");var d=Math.max,f=numeric.norm2;r=d(r,numeric.epsilon);var p,m,_,g=o.Hinv||numeric.identity(u),v=numeric.dot;numeric.inv;var y,b,x,S,T,E,A,w=numeric.sub,C=numeric.add,O=numeric.tensor,R=numeric.div,D=numeric.mul,I=numeric.all,M=numeric.isFinite,N=numeric.neg,P=0,k="";for(m=n(t);P<i;){if("function"==typeof s&&s(P,t,c,m,g)){k="Callback returned true";break}if(!I(M(m))){k="Gradient has Infinity or NaN";break}if(!I(M(p=N(v(g,m))))){k="Search direction has Infinity or NaN";break}if((A=f(p))<r){k="Newton step smaller than tol";break}for(E=1,h=v(m,p),b=t;P<i&&!(E*A<r)&&(b=C(t,y=D(p,E)),(l=e(b))-c>=.1*E*h||isNaN(l));)E*=.5,++P;if(E*A<r){k="Line search step size smaller than tol";break}if(P===i){k="maxit reached during line search";break}T=v(x=w(_=n(b),m),y),S=v(g,x),g=w(C(g,D((T+v(x,S))/(T*T),O(y,y))),R(C(O(S,y),O(y,S)),T)),t=b,c=l,m=_,++P}return{solution:t,f:c,gradient:m,invHessian:g,iterations:P,message:k}},numeric.Dopri=function(e,t,r,n,i,s,o){this.x=e,this.y=t,this.f=r,this.ymid=n,this.iterations=i,this.events=o,this.message=s},numeric.Dopri.prototype._at=function(e,t){function r(e){return e*e}var n,i,s,o,a,l,h=this,u=h.x,c=h.y,d=h.f,f=h.ymid;u.length;var p,m,_,g=numeric.add,v=numeric.mul,y=numeric.sub;return n=u[t],i=u[t+1],o=c[t],a=c[t+1],s=n+.5*(i-n),l=f[t],p=y(d[t],v(o,1/(n-s)+2/(n-i))),m=y(d[t+1],v(a,1/(i-s)+2/(i-n))),g(g(g(g(v(o,(_=[r(e-i)*(e-s)/r(n-i)/(n-s),r(e-n)*r(e-i)/r(n-s)/r(i-s),r(e-n)*(e-s)/r(i-n)/(i-s),(e-n)*r(e-i)*(e-s)/r(n-i)/(n-s),(e-i)*r(e-n)*(e-s)/r(n-i)/(i-s)])[0]),v(l,_[1])),v(a,_[2])),v(p,_[3])),v(m,_[4]))},numeric.Dopri.prototype.at=function(e){var t,r,n,i=Math.floor;if("number"!=typeof e){var s=e.length,o=Array(s);for(t=s-1;-1!==t;--t)o[t]=this.at(e[t]);return o}var a=this.x;for(t=0,r=a.length-1;r-t>1;)a[n=i(.5*(t+r))]<=e?t=n:r=n;return this._at(e,t)},numeric.dopri=function(e,t,r,n,i,s,o){void 0===i&&(i=1e-6),void 0===s&&(s=1e3);var a,l,h,u,c,d,f,p,m,_,g,v,y,b=[e],x=[r],S=[n(e,r)],T=[],E=[3/40,9/40],A=[44/45,-56/15,32/9],w=[19372/6561,-25360/2187,64448/6561,-212/729],C=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],O=[35/384,0,500/1113,125/192,-2187/6784,11/84],R=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,5618549.5/235043384],D=[.2,.3,.8,8/9,1,1],I=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,1/40],M=0,N=(t-e)/10,P=0,k=numeric.add,F=numeric.mul,L=Math.min,B=Math.abs,U=numeric.norminf,G=Math.pow,j=numeric.any,V=numeric.lt,z=numeric.and;numeric.sub;var H=new numeric.Dopri(b,x,S,T,-1,"");for("function"==typeof o&&(g=o(e,r));e<t&&P<s;)if(++P,e+N>t&&(N=t-e),a=n(e+D[0]*N,k(r,F(.2*N,S[M]))),l=n(e+D[1]*N,k(k(r,F(E[0]*N,S[M])),F(E[1]*N,a))),h=n(e+D[2]*N,k(k(k(r,F(A[0]*N,S[M])),F(A[1]*N,a)),F(A[2]*N,l))),u=n(e+D[3]*N,k(k(k(k(r,F(w[0]*N,S[M])),F(w[1]*N,a)),F(w[2]*N,l)),F(w[3]*N,h))),c=n(e+D[4]*N,k(k(k(k(k(r,F(C[0]*N,S[M])),F(C[1]*N,a)),F(C[2]*N,l)),F(C[3]*N,h)),F(C[4]*N,u))),d=n(e+N,m=k(k(k(k(k(r,F(S[M],N*O[0])),F(l,N*O[2])),F(h,N*O[3])),F(u,N*O[4])),F(c,N*O[5]))),(_="number"==typeof(f=k(k(k(k(k(F(S[M],N*I[0]),F(l,N*I[2])),F(h,N*I[3])),F(u,N*I[4])),F(c,N*I[5])),F(d,N*I[6])))?B(f):U(f))>i){if(e+(N=.2*N*G(i/_,.25))===e){H.msg="Step size became too small";break}}else{if(T[M]=k(k(k(k(k(k(r,F(S[M],N*R[0])),F(l,N*R[2])),F(h,N*R[3])),F(u,N*R[4])),F(c,N*R[5])),F(d,N*R[6])),b[++M]=e+N,x[M]=m,S[M]=d,"function"==typeof o){var X,W,q=e,Y=e+.5*N;if(v=o(Y,T[M-1]),j(y=z(V(g,0),V(0,v)))||(q=Y,g=v,v=o(Y=e+N,m),y=z(V(g,0),V(0,v))),j(y)){for(var J,K,$=0,Q=1,Z=1;;){if("number"==typeof g)W=(Z*v*q-Q*g*Y)/(Z*v-Q*g);else for(W=Y,p=g.length-1;-1!==p;--p)g[p]<0&&v[p]>0&&(W=L(W,(Z*v[p]*q-Q*g[p]*Y)/(Z*v[p]-Q*g[p])));if(W<=q||W>=Y)break;K=o(W,X=H._at(W,M-1)),j(J=z(V(g,0),V(0,K)))?(Y=W,v=K,y=J,Z=1,-1===$?Q*=.5:Q=1,$=-1):(q=W,g=K,Q=1,1===$?Z*=.5:Z=1,$=1)}return m=H._at(.5*(e+W),M-1),H.f[M]=n(W,X),H.x[M]=W,H.y[M]=X,H.ymid[M-1]=m,H.events=y,H.iterations=P,H}}e+=N,r=m,g=v,N=L(.8*N*G(i/_,.25),4*N)}return H.iterations=P,H},numeric.LU=function(e,t){t=t||!1;var r,n,i,s,o,a,l,h,u,c=Math.abs,d=e.length,f=d-1,p=new Array(d);for(t||(e=numeric.clone(e)),i=0;i<d;++i){for(l=i,u=c((a=e[i])[i]),n=i+1;n<d;++n)u<(s=c(e[n][i]))&&(u=s,l=n);for(p[i]=l,l!=i&&(e[i]=e[l],e[l]=a,a=e[i]),o=a[i],r=i+1;r<d;++r)e[r][i]/=o;for(r=i+1;r<d;++r){for(h=e[r],n=i+1;n<f;++n)h[n]-=h[i]*a[n],h[++n]-=h[i]*a[n];n===f&&(h[n]-=h[i]*a[n])}}return{LU:e,P:p}},numeric.LUsolve=function(e,t){var r,n,i,s,o,a=e.LU,l=a.length,h=numeric.clone(t),u=e.P;for(r=l-1;-1!==r;--r)h[r]=t[r];for(r=0;r<l;++r)for(i=u[r],u[r]!==r&&(o=h[r],h[r]=h[i],h[i]=o),s=a[r],n=0;n<r;++n)h[r]-=h[n]*s[n];for(r=l-1;r>=0;--r){for(s=a[r],n=r+1;n<l;++n)h[r]-=h[n]*s[n];h[r]/=s[r]}return h},numeric.solve=function(e,t,r){return numeric.LUsolve(numeric.LU(e,r),t)},numeric.echelonize=function(e){var t,r,n,i,s,o,a,l,h=numeric.dim(e),u=h[0],c=h[1],d=numeric.identity(u),f=Array(u),p=Math.abs,m=numeric.diveq;for(e=numeric.clone(e),t=0;t<u;++t){for(n=0,s=e[t],o=d[t],r=1;r<c;++r)p(s[n])<p(s[r])&&(n=r);for(f[t]=n,m(o,s[n]),m(s,s[n]),r=0;r<u;++r)if(r!==t){for(l=(a=e[r])[n],i=c-1;-1!==i;--i)a[i]-=s[i]*l;for(a=d[r],i=u-1;-1!==i;--i)a[i]-=o[i]*l}}return{I:d,A:e,P:f}},numeric.__solveLP=function(e,t,r,n,i,s,o){var a=numeric.sum;numeric.log;var l,h=numeric.mul,u=numeric.sub,c=numeric.dot,d=numeric.div,f=numeric.add,p=e.length,m=r.length,_=!1,g=1;numeric.transpose(t),numeric.svd;var v=numeric.transpose;numeric.leq;var y=Math.sqrt,b=Math.abs;numeric.muleq,numeric.norminf,numeric.any;var x,S=Math.min,T=numeric.all,E=numeric.gt,A=Array(p),w=Array(m);numeric.rep([m],1);var C,O,R=numeric.solve,D=u(r,c(t,s)),I=c(e,e);for(C=0;C<i;++C){var M,N;for(M=m-1;-1!==M;--M)w[M]=d(t[M],D[M]);var P=v(w);for(M=p-1;-1!==M;--M)A[M]=a(P[M]);g=.25*b(I/c(e,A));var k=100*y(I/c(A,A));for((!isFinite(g)||g>k)&&(g=k),O=f(e,h(g,A)),x=c(P,w),M=p-1;-1!==M;--M)x[M][M]+=1;N=R(x,d(O,g),!0);var F=d(D,c(t,N)),L=1;for(M=m-1;-1!==M;--M)F[M]<0&&(L=S(L,-.999*F[M]));if(l=u(s,h(N,L)),!T(E(D=u(r,c(t,l)),0)))return{solution:s,message:"",iterations:C};if(s=l,g<n)return{solution:l,message:"",iterations:C};if(o){var B=c(e,O),U=c(t,O);for(_=!0,M=m-1;-1!==M;--M)if(B*U[M]<0){_=!1;break}}else _=!(s[p-1]>=0);if(_)return{solution:l,message:"Unbounded",iterations:C}}return{solution:s,message:"maximum iteration count exceeded",iterations:C}},numeric._solveLP=function(e,t,r,n,i){var s=e.length,o=r.length;numeric.sum,numeric.log,numeric.mul;var a=numeric.sub,l=numeric.dot;numeric.div,numeric.add;var h=numeric.rep([s],0).concat([1]),u=numeric.rep([o,1],-1),c=numeric.blockMatrix([[t,u]]),d=r,f=numeric.rep([s],0).concat(Math.max(0,numeric.sup(numeric.neg(r)))+1),p=numeric.__solveLP(h,c,d,n,i,f,!1),m=numeric.clone(p.solution);if(m.length=s,numeric.inf(a(r,l(t,m)))<0)return{solution:NaN,message:"Infeasible",iterations:p.iterations};var _=numeric.__solveLP(e,t,r,n,i-p.iterations,m,!0);return _.iterations+=p.iterations,_},numeric.solveLP=function(e,t,r,n,i,s,o){if(void 0===o&&(o=1e3),void 0===s&&(s=numeric.epsilon),void 0===n)return numeric._solveLP(e,t,r,s,o);var a,l=n.length,h=n[0].length,u=t.length,c=numeric.echelonize(n),d=numeric.rep([h],0),f=c.P,p=[];for(a=f.length-1;-1!==a;--a)d[f[a]]=1;for(a=h-1;-1!==a;--a)0===d[a]&&p.push(a);var m=numeric.getRange,_=numeric.linspace(0,l-1),g=numeric.linspace(0,u-1),v=m(n,_,p),y=m(t,g,f),b=m(t,g,p),x=numeric.dot,S=numeric.sub,T=x(y,c.I),E=S(b,x(T,v)),A=S(r,x(T,i)),w=Array(f.length),C=Array(p.length);for(a=f.length-1;-1!==a;--a)w[a]=e[f[a]];for(a=p.length-1;-1!==a;--a)C[a]=e[p[a]];var O=S(C,x(w,x(c.I,v))),R=numeric._solveLP(O,E,A,s,o),D=R.solution;if(D!=D)return R;var I=x(c.I,S(i,x(v,D))),M=Array(e.length);for(a=f.length-1;-1!==a;--a)M[f[a]]=I[a];for(a=p.length-1;-1!==a;--a)M[p[a]]=D[a];return{solution:M,message:R.message,iterations:R.iterations}},numeric.MPStoLP=function(e){e instanceof String&&e.split("\n");var t,r,n,i,s=0,o=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],a=e.length,l=0,h={},u=[],c=0,d={},f=0,p=[],m=[],_=[];function g(r){throw new Error("MPStoLP: "+r+"\nLine "+t+": "+e[t]+"\nCurrent state: "+o[s]+"\n")}for(t=0;t<a;++t){var v=(n=e[t]).match(/\S*/g),y=[];for(r=0;r<v.length;++r)""!==v[r]&&y.push(v[r]);if(0!==y.length){for(r=0;r<o.length&&n.substr(0,o[r].length)!==o[r];++r);if(r<o.length){if(s=r,1===r&&(i=y[1]),6===r)return{name:i,c:p,A:numeric.transpose(m),b:_,rows:h,vars:d}}else switch(s){case 0:case 1:g("Unexpected line");case 2:switch(y[0]){case"N":0===l?l=y[1]:g("Two or more N rows");break;case"L":h[y[1]]=c,u[c]=1,_[c]=0,++c;break;case"G":h[y[1]]=c,u[c]=-1,_[c]=0,++c;break;case"E":h[y[1]]=c,u[c]=0,_[c]=0,++c;break;default:g("Parse error "+numeric.prettyPrint(y))}break;case 3:d.hasOwnProperty(y[0])||(d[y[0]]=f,p[f]=0,m[f]=numeric.rep([c],0),++f);var b=d[y[0]];for(r=1;r<y.length;r+=2)if(y[r]!==l){var x=h[y[r]];m[b][x]=(u[x]<0?-1:1)*parseFloat(y[r+1])}else p[b]=parseFloat(y[r+1]);break;case 4:for(r=1;r<y.length;r+=2)_[h[y[r]]]=(u[h[y[r]]]<0?-1:1)*parseFloat(y[r+1]);break;case 5:break;case 6:g("Internal error")}}}g("Reached end of file without ENDATA")},console.log("jsQUEST Version 1.0.1")},453:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{vE:()=>core_exports,aT:()=>data_exports,eq:()=>sound_exports,D5:()=>util_exports,Hg:()=>visual_exports});var __create=Object.create,__defProp=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropNames=Object.getOwnPropertyNames,__getOwnPropSymbols=Object.getOwnPropertySymbols,__getProtoOf=Object.getPrototypeOf,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,t,r)=>t in e?__defProp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,__spreadValues=(e,t)=>{for(var r in t||(t={}))__hasOwnProp.call(t,r)&&__defNormalProp(e,r,t[r]);if(__getOwnPropSymbols)for(var r of __getOwnPropSymbols(t))__propIsEnum.call(t,r)&&__defNormalProp(e,r,t[r]);return e},__spreadProps=(e,t)=>__defProps(e,__getOwnPropDescs(t)),__markAsModule=e=>__defProp(e,"__esModule",{value:!0}),__require=e=>{if("undefined"!=typeof require)return require(e);throw new Error('Dynamic require of "'+e+'" is not supported')},__objRest=(e,t)=>{var r={};for(var n in e)__hasOwnProp.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&__getOwnPropSymbols)for(var n of __getOwnPropSymbols(e))t.indexOf(n)<0&&__propIsEnum.call(e,n)&&(r[n]=e[n]);return r},__commonJS=(e,t)=>function(){return t||(0,e[Object.keys(e)[0]])((t={exports:{}}).exports,t),t.exports},__export=(e,t)=>{for(var r in t)__defProp(e,r,{get:t[r],enumerable:!0})},__reExport=(e,t,r)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of __getOwnPropNames(t))!__hasOwnProp.call(e,n)&&"default"!==n&&__defProp(e,n,{get:()=>t[n],enumerable:!(r=__getOwnPropDesc(t,n))||r.enumerable});return e},__toModule=e=>__reExport(__markAsModule(__defProp(null!=e?__create(__getProtoOf(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e),__publicField=(e,t,r)=>(__defNormalProp(e,"symbol"!=typeof t?t+"":t,r),r),require_object_assign=__commonJS({"node_modules/object-assign/index.js"(e,t){var r=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;function s(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}t.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(e){n[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var o,a,l=s(e),h=1;h<arguments.length;h++){for(var u in o=Object(arguments[h]))n.call(o,u)&&(l[u]=o[u]);if(r){a=r(o);for(var c=0;c<a.length;c++)i.call(o,a[c])&&(l[a[c]]=o[a[c]])}}return l}}}),require_eventemitter3=__commonJS({"node_modules/eventemitter3/index.js"(e,t){var r=Object.prototype.hasOwnProperty,n="~";function i(){}function s(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,r,i,o){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new s(r,i||e,o),l=n?n+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],a]:e._events[l].push(a):(e._events[l]=a,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function l(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(n=!1)),l.prototype.eventNames=function(){var e,t,i=[];if(0===this._eventsCount)return i;for(t in e=this._events)r.call(e,t)&&i.push(n?t.slice(1):t);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},l.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,s=r.length,o=new Array(s);i<s;i++)o[i]=r[i].fn;return o},l.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},l.prototype.emit=function(e,t,r,i,s,o){var a=n?n+e:e;if(!this._events[a])return!1;var l,h,u=this._events[a],c=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),c){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,r),!0;case 4:return u.fn.call(u.context,t,r,i),!0;case 5:return u.fn.call(u.context,t,r,i,s),!0;case 6:return u.fn.call(u.context,t,r,i,s,o),!0}for(h=1,l=new Array(c-1);h<c;h++)l[h-1]=arguments[h];u.fn.apply(u.context,l)}else{var d,f=u.length;for(h=0;h<f;h++)switch(u[h].once&&this.removeListener(e,u[h].fn,void 0,!0),c){case 1:u[h].fn.call(u[h].context);break;case 2:u[h].fn.call(u[h].context,t);break;case 3:u[h].fn.call(u[h].context,t,r);break;case 4:u[h].fn.call(u[h].context,t,r,i);break;default:if(!l)for(d=1,l=new Array(c-1);d<c;d++)l[d-1]=arguments[d];u[h].fn.apply(u[h].context,l)}}return!0},l.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},l.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},l.prototype.removeListener=function(e,t,r,i){var s=n?n+e:e;if(!this._events[s])return this;if(!t)return a(this,s),this;var o=this._events[s];if(o.fn)o.fn===t&&(!i||o.once)&&(!r||o.context===r)&&a(this,s);else{for(var l=0,h=[],u=o.length;l<u;l++)(o[l].fn!==t||i&&!o[l].once||r&&o[l].context!==r)&&h.push(o[l]);h.length?this._events[s]=1===h.length?h[0]:h:a(this,s)}return this},l.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&a(this,t)):(this._events=new i,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=n,l.EventEmitter=l,void 0!==t&&(t.exports=l)}}),require_earcut=__commonJS({"node_modules/earcut/src/earcut.js"(e,t){function r(e,t,r){r=r||2;var o,a,l,h,d,f,m,_=t&&t.length,g=_?t[0]*r:e.length,v=n(e,0,g,r,!0),y=[];if(!v||v.next===v.prev)return y;if(_&&(v=function(e,t,r,s){var o,a,l,h=[];for(o=0,a=t.length;o<a;o++)(l=n(e,t[o]*s,o<a-1?t[o+1]*s:e.length,s,!1))===l.next&&(l.steiner=!0),h.push(p(l));for(h.sort(u),o=0;o<h.length;o++)c(h[o],r),r=i(r,r.next);return r}(e,t,v,r)),e.length>80*r){o=l=e[0],a=h=e[1];for(var b=r;b<g;b+=r)(d=e[b])<o&&(o=d),(f=e[b+1])<a&&(a=f),d>l&&(l=d),f>h&&(h=f);m=0!==(m=Math.max(l-o,h-a))?1/m:0}return s(v,y,r,o,a,m),y}function n(e,t,r,n,i){var s,o;if(i===C(e,t,r,n)>0)for(s=t;s<r;s+=n)o=E(s,e[s],e[s+1],o);else for(s=r-n;s>=t;s-=n)o=E(s,e[s],e[s+1],o);return o&&v(o,o.next)&&(A(o),o=o.next),o}function i(e,t){if(!e)return e;t||(t=e);var r,n=e;do{if(r=!1,n.steiner||!v(n,n.next)&&0!==g(n.prev,n,n.next))n=n.next;else{if(A(n),(n=t=n.prev)===n.next)break;r=!0}}while(r||n!==t);return t}function s(e,t,r,n,u,c,d){if(e){!d&&c&&function(e,t,r,n){var i=e;do{null===i.z&&(i.z=f(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,r,n,i,s,o,a,l,h=1;do{for(r=e,e=null,s=null,o=0;r;){for(o++,n=r,a=0,t=0;t<h&&(a++,n=n.nextZ);t++);for(l=h;a>0||l>0&&n;)0!==a&&(0===l||!n||r.z<=n.z)?(i=r,r=r.nextZ,a--):(i=n,n=n.nextZ,l--),s?s.nextZ=i:e=i,i.prevZ=s,s=i;r=n}s.nextZ=null,h*=2}while(o>1)}(i)}(e,n,u,c);for(var p,m,_=e;e.prev!==e.next;)if(p=e.prev,m=e.next,c?a(e,n,u,c):o(e))t.push(p.i/r),t.push(e.i/r),t.push(m.i/r),A(e),e=m.next,_=m.next;else if((e=m)===_){d?1===d?s(e=l(i(e),t,r),t,r,n,u,c,2):2===d&&h(e,t,r,n,u,c):s(i(e),t,r,n,u,c,1);break}}}function o(e){var t=e.prev,r=e,n=e.next;if(g(t,r,n)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(m(t.x,t.y,r.x,r.y,n.x,n.y,i.x,i.y)&&g(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function a(e,t,r,n){var i=e.prev,s=e,o=e.next;if(g(i,s,o)>=0)return!1;for(var a=i.x<s.x?i.x<o.x?i.x:o.x:s.x<o.x?s.x:o.x,l=i.y<s.y?i.y<o.y?i.y:o.y:s.y<o.y?s.y:o.y,h=i.x>s.x?i.x>o.x?i.x:o.x:s.x>o.x?s.x:o.x,u=i.y>s.y?i.y>o.y?i.y:o.y:s.y>o.y?s.y:o.y,c=f(a,l,t,r,n),d=f(h,u,t,r,n),p=e.prevZ,_=e.nextZ;p&&p.z>=c&&_&&_.z<=d;){if(p!==e.prev&&p!==e.next&&m(i.x,i.y,s.x,s.y,o.x,o.y,p.x,p.y)&&g(p.prev,p,p.next)>=0||(p=p.prevZ,_!==e.prev&&_!==e.next&&m(i.x,i.y,s.x,s.y,o.x,o.y,_.x,_.y)&&g(_.prev,_,_.next)>=0))return!1;_=_.nextZ}for(;p&&p.z>=c;){if(p!==e.prev&&p!==e.next&&m(i.x,i.y,s.x,s.y,o.x,o.y,p.x,p.y)&&g(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;_&&_.z<=d;){if(_!==e.prev&&_!==e.next&&m(i.x,i.y,s.x,s.y,o.x,o.y,_.x,_.y)&&g(_.prev,_,_.next)>=0)return!1;_=_.nextZ}return!0}function l(e,t,r){var n=e;do{var s=n.prev,o=n.next.next;!v(s,o)&&y(s,n,n.next,o)&&S(s,o)&&S(o,s)&&(t.push(s.i/r),t.push(n.i/r),t.push(o.i/r),A(n),A(n.next),n=e=o),n=n.next}while(n!==e);return i(n)}function h(e,t,r,n,o,a){var l=e;do{for(var h=l.next.next;h!==l.prev;){if(l.i!==h.i&&_(l,h)){var u=T(l,h);return l=i(l,l.next),u=i(u,u.next),s(l,t,r,n,o,a),void s(u,t,r,n,o,a)}h=h.next}l=l.next}while(l!==e)}function u(e,t){return e.x-t.x}function c(e,t){if(t=function(e,t){var r,n=t,i=e.x,s=e.y,o=-1/0;do{if(s<=n.y&&s>=n.next.y&&n.next.y!==n.y){var a=n.x+(s-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=i&&a>o){if(o=a,a===i){if(s===n.y)return n;if(s===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!r)return null;if(i===o)return r;var l,h=r,u=r.x,c=r.y,f=1/0;n=r;do{i>=n.x&&n.x>=u&&i!==n.x&&m(s<c?i:o,s,u,c,s<c?o:i,s,n.x,n.y)&&(l=Math.abs(s-n.y)/(i-n.x),S(n,e)&&(l<f||l===f&&(n.x>r.x||n.x===r.x&&d(r,n)))&&(r=n,f=l)),n=n.next}while(n!==h);return r}(e,t),t){var r=T(t,e);i(t,t.next),i(r,r.next)}}function d(e,t){return g(e.prev,e,t.prev)<0&&g(t.next,e,e.next)<0}function f(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function p(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function m(e,t,r,n,i,s,o,a){return(i-o)*(t-a)-(e-o)*(s-a)>=0&&(e-o)*(n-a)-(r-o)*(t-a)>=0&&(r-o)*(s-a)-(i-o)*(n-a)>=0}function _(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&y(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&(S(e,t)&&S(t,e)&&function(e,t){var r=e,n=!1,i=(e.x+t.x)/2,s=(e.y+t.y)/2;do{r.y>s!=r.next.y>s&&r.next.y!==r.y&&i<(r.next.x-r.x)*(s-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)&&(g(e.prev,e,t.prev)||g(e,t.prev,t))||v(e,t)&&g(e.prev,e,e.next)>0&&g(t.prev,t,t.next)>0)}function g(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function v(e,t){return e.x===t.x&&e.y===t.y}function y(e,t,r,n){var i=x(g(e,t,r)),s=x(g(e,t,n)),o=x(g(r,n,e)),a=x(g(r,n,t));return!!(i!==s&&o!==a||0===i&&b(e,r,t)||0===s&&b(e,n,t)||0===o&&b(r,e,n)||0===a&&b(r,t,n))}function b(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function x(e){return e>0?1:e<0?-1:0}function S(e,t){return g(e.prev,e,e.next)<0?g(e,t,e.next)>=0&&g(e,e.prev,t)>=0:g(e,t,e.prev)<0||g(e,e.next,t)<0}function T(e,t){var r=new w(e.i,e.x,e.y),n=new w(t.i,t.x,t.y),i=e.next,s=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,s.next=n,n.prev=s,n}function E(e,t,r,n){var i=new w(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function A(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function w(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function C(e,t,r,n){for(var i=0,s=t,o=r-n;s<r;s+=n)i+=(e[o]-e[s])*(e[s+1]+e[o+1]),o=s;return i}t.exports=r,t.exports.default=r,r.deviation=function(e,t,r,n){var i=t&&t.length,s=i?t[0]*r:e.length,o=Math.abs(C(e,0,s,r));if(i)for(var a=0,l=t.length;a<l;a++){var h=t[a]*r,u=a<l-1?t[a+1]*r:e.length;o-=Math.abs(C(e,h,u,r))}var c=0;for(a=0;a<n.length;a+=3){var d=n[a]*r,f=n[a+1]*r,p=n[a+2]*r;c+=Math.abs((e[d]-e[p])*(e[f+1]-e[d+1])-(e[d]-e[f])*(e[p+1]-e[d+1]))}return 0===o&&0===c?0:Math.abs((c-o)/o)},r.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0,i=0;i<e.length;i++){for(var s=0;s<e[i].length;s++)for(var o=0;o<t;o++)r.vertices.push(e[i][s][o]);i>0&&(n+=e[i-1].length,r.holes.push(n))}return r}}}),require_punycode=__commonJS({"node_modules/url/node_modules/punycode/punycode.js"(e,t){!function(r){var n="object"==typeof e&&e&&!e.nodeType&&e,i="object"==typeof t&&t&&!t.nodeType&&t,s="object"==typeof global&&global;(s.global===s||s.window===s||s.self===s)&&(r=s);var o,a,l=2147483647,h=36,u=/^xn--/,c=/[^\x20-\x7E]/,d=/[\x2E\u3002\uFF0E\uFF61]/g,f={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},p=Math.floor,m=String.fromCharCode;function _(e){throw RangeError(f[e])}function g(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function v(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),n+g((e=e.replace(d,".")).split("."),t).join(".")}function y(e){for(var t,r,n=[],i=0,s=e.length;i<s;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<s?56320==(64512&(r=e.charCodeAt(i++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),i--):n.push(t);return n}function b(e){return g(e,(function(e){var t="";return e>65535&&(t+=m((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+m(e)})).join("")}function x(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function S(e,t,r){var n=0;for(e=r?p(e/700):e>>1,e+=p(e/t);e>455;n+=h)e=p(e/35);return p(n+36*e/(e+38))}function T(e){var t,r,n,i,s,o,a,u,c,d,f,m=[],g=e.length,v=0,y=128,x=72;for((r=e.lastIndexOf("-"))<0&&(r=0),n=0;n<r;++n)e.charCodeAt(n)>=128&&_("not-basic"),m.push(e.charCodeAt(n));for(i=r>0?r+1:0;i<g;){for(s=v,o=1,a=h;i>=g&&_("invalid-input"),((u=(f=e.charCodeAt(i++))-48<10?f-22:f-65<26?f-65:f-97<26?f-97:h)>=h||u>p((l-v)/o))&&_("overflow"),v+=u*o,!(u<(c=a<=x?1:a>=x+26?26:a-x));a+=h)o>p(l/(d=h-c))&&_("overflow"),o*=d;x=S(v-s,t=m.length+1,0==s),p(v/t)>l-y&&_("overflow"),y+=p(v/t),v%=t,m.splice(v++,0,y)}return b(m)}function E(e){var t,r,n,i,s,o,a,u,c,d,f,g,v,b,T,E=[];for(g=(e=y(e)).length,t=128,r=0,s=72,o=0;o<g;++o)(f=e[o])<128&&E.push(m(f));for(n=i=E.length,i&&E.push("-");n<g;){for(a=l,o=0;o<g;++o)(f=e[o])>=t&&f<a&&(a=f);for(a-t>p((l-r)/(v=n+1))&&_("overflow"),r+=(a-t)*v,t=a,o=0;o<g;++o)if((f=e[o])<t&&++r>l&&_("overflow"),f==t){for(u=r,c=h;!(u<(d=c<=s?1:c>=s+26?26:c-s));c+=h)T=u-d,b=h-d,E.push(m(x(d+T%b,0))),u=p(T/b);E.push(m(x(u,0))),s=S(r,v,n==i),r=0,++n}++r,++t}return E.join("")}if(o={version:"1.3.2",ucs2:{decode:y,encode:b},decode:T,encode:E,toASCII:function(e){return v(e,(function(e){return c.test(e)?"xn--"+E(e):e}))},toUnicode:function(e){return v(e,(function(e){return u.test(e)?T(e.slice(4).toLowerCase()):e}))}},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",(function(){return o}));else if(n&&i)if(t.exports==n)i.exports=o;else for(a in o)o.hasOwnProperty(a)&&(n[a]=o[a]);else r.punycode=o}(e)}}),require_util=__commonJS({"node_modules/url/util.js"(e,t){t.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}}}),require_decode=__commonJS({"node_modules/querystring/decode.js"(e,t){function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.exports=function(e,t,n,i){t=t||"&",n=n||"=";var s={};if("string"!=typeof e||0===e.length)return s;var o=/\+/g;e=e.split(t);var a=1e3;i&&"number"==typeof i.maxKeys&&(a=i.maxKeys);var l=e.length;a>0&&l>a&&(l=a);for(var h=0;h<l;++h){var u,c,d,f,p=e[h].replace(o,"%20"),m=p.indexOf(n);m>=0?(u=p.substr(0,m),c=p.substr(m+1)):(u=p,c=""),d=decodeURIComponent(u),f=decodeURIComponent(c),r(s,d)?Array.isArray(s[d])?s[d].push(f):s[d]=[s[d],f]:s[d]=f}return s}}}),require_encode=__commonJS({"node_modules/querystring/encode.js"(e,t){var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};t.exports=function(e,t,n,i){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map((function(i){var s=encodeURIComponent(r(i))+n;return Array.isArray(e[i])?e[i].map((function(e){return s+encodeURIComponent(r(e))})).join(t):s+encodeURIComponent(r(e[i]))})).join(t):i?encodeURIComponent(r(i))+n+encodeURIComponent(r(e)):""}}}),require_querystring=__commonJS({"node_modules/querystring/index.js"(e){e.decode=e.parse=require_decode(),e.encode=e.stringify=require_encode()}}),require_url=__commonJS({"node_modules/url/url.js"(e){var t=require_punycode(),r=require_util();function n(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}e.parse=g,e.resolve=function(e,t){return g(e,!1,!0).resolve(t)},e.resolveObject=function(e,t){return e?g(e,!1,!0).resolveObject(t):t},e.format=function(e){return r.isString(e)&&(e=g(e)),e instanceof n?e.format():n.prototype.format.call(e)},e.Url=n;var i=/^([a-z0-9.+-]+:)/i,s=/:[0-9]*$/,o=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,a=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),l=["'"].concat(a),h=["%","/","?",";","#"].concat(l),u=["/","?","#"],c=/^[+a-z0-9A-Z_-]{0,63}$/,d=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,f={javascript:!0,"javascript:":!0},p={javascript:!0,"javascript:":!0},m={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},_=require_querystring();function g(e,t,i){if(e&&r.isObject(e)&&e instanceof n)return e;var s=new n;return s.parse(e,t,i),s}n.prototype.parse=function(e,n,s){if(!r.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var a=e.indexOf("?"),g=-1!==a&&a<e.indexOf("#")?"?":"#",v=e.split(g);v[0]=v[0].replace(/\\/g,"/");var y=e=v.join(g);if(y=y.trim(),!s&&1===e.split("#").length){var b=o.exec(y);if(b)return this.path=y,this.href=y,this.pathname=b[1],b[2]?(this.search=b[2],this.query=n?_.parse(this.search.substr(1)):this.search.substr(1)):n&&(this.search="",this.query={}),this}var x=i.exec(y);if(x){var S=(x=x[0]).toLowerCase();this.protocol=S,y=y.substr(x.length)}if(s||x||y.match(/^\/\/[^@\/]+@[^@\/]+/)){var T="//"===y.substr(0,2);T&&(!x||!p[x])&&(y=y.substr(2),this.slashes=!0)}if(!p[x]&&(T||x&&!m[x])){for(var E=-1,A=0;A<u.length;A++)-1!==(O=y.indexOf(u[A]))&&(-1===E||O<E)&&(E=O);var w,C;for(-1!==(C=-1===E?y.lastIndexOf("@"):y.lastIndexOf("@",E))&&(w=y.slice(0,C),y=y.slice(C+1),this.auth=decodeURIComponent(w)),E=-1,A=0;A<h.length;A++){var O;-1!==(O=y.indexOf(h[A]))&&(-1===E||O<E)&&(E=O)}-1===E&&(E=y.length),this.host=y.slice(0,E),y=y.slice(E),this.parseHost(),this.hostname=this.hostname||"";var R="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!R)for(var D=this.hostname.split(/\./),I=(A=0,D.length);A<I;A++){var M=D[A];if(M&&!M.match(c)){for(var N="",P=0,k=M.length;P<k;P++)M.charCodeAt(P)>127?N+="x":N+=M[P];if(!N.match(c)){var F=D.slice(0,A),L=D.slice(A+1),B=M.match(d);B&&(F.push(B[1]),L.unshift(B[2])),L.length&&(y="/"+L.join(".")+y),this.hostname=F.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),R||(this.hostname=t.toASCII(this.hostname));var U=this.port?":"+this.port:"",G=this.hostname||"";this.host=G+U,this.href+=this.host,R&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==y[0]&&(y="/"+y))}if(!f[S])for(A=0,I=l.length;A<I;A++){var j=l[A];if(-1!==y.indexOf(j)){var V=encodeURIComponent(j);V===j&&(V=escape(j)),y=y.split(j).join(V)}}var z=y.indexOf("#");-1!==z&&(this.hash=y.substr(z),y=y.slice(0,z));var H=y.indexOf("?");if(-1!==H?(this.search=y.substr(H),this.query=y.substr(H+1),n&&(this.query=_.parse(this.query)),y=y.slice(0,H)):n&&(this.search="",this.query={}),y&&(this.pathname=y),m[S]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){U=this.pathname||"";var X=this.search||"";this.path=U+X}return this.href=this.format(),this},n.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",i=this.hash||"",s=!1,o="";this.host?s=e+this.host:this.hostname&&(s=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(s+=":"+this.port)),this.query&&r.isObject(this.query)&&Object.keys(this.query).length&&(o=_.stringify(this.query));var a=this.search||o&&"?"+o||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||m[t])&&!1!==s?(s="//"+(s||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):s||(s=""),i&&"#"!==i.charAt(0)&&(i="#"+i),a&&"?"!==a.charAt(0)&&(a="?"+a),t+s+(n=n.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(a=a.replace("#","%23"))+i},n.prototype.resolve=function(e){return this.resolveObject(g(e,!1,!0)).format()},n.prototype.resolveObject=function(e){if(r.isString(e)){var t=new n;t.parse(e,!1,!0),e=t}for(var i=new n,s=Object.keys(this),o=0;o<s.length;o++){var a=s[o];i[a]=this[a]}if(i.hash=e.hash,""===e.href)return i.href=i.format(),i;if(e.slashes&&!e.protocol){for(var l=Object.keys(e),h=0;h<l.length;h++){var u=l[h];"protocol"!==u&&(i[u]=e[u])}return m[i.protocol]&&i.hostname&&!i.pathname&&(i.path=i.pathname="/"),i.href=i.format(),i}if(e.protocol&&e.protocol!==i.protocol){if(!m[e.protocol]){for(var c=Object.keys(e),d=0;d<c.length;d++){var f=c[d];i[f]=e[f]}return i.href=i.format(),i}if(i.protocol=e.protocol,e.host||p[e.protocol])i.pathname=e.pathname;else{for(var _=(e.pathname||"").split("/");_.length&&!(e.host=_.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==_[0]&&_.unshift(""),_.length<2&&_.unshift(""),i.pathname=_.join("/")}if(i.search=e.search,i.query=e.query,i.host=e.host||"",i.auth=e.auth,i.hostname=e.hostname||e.host,i.port=e.port,i.pathname||i.search){var g=i.pathname||"",v=i.search||"";i.path=g+v}return i.slashes=i.slashes||e.slashes,i.href=i.format(),i}var y=i.pathname&&"/"===i.pathname.charAt(0),b=e.host||e.pathname&&"/"===e.pathname.charAt(0),x=b||y||i.host&&e.pathname,S=x,T=i.pathname&&i.pathname.split("/")||[],E=(_=e.pathname&&e.pathname.split("/")||[],i.protocol&&!m[i.protocol]);if(E&&(i.hostname="",i.port=null,i.host&&(""===T[0]?T[0]=i.host:T.unshift(i.host)),i.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===_[0]?_[0]=e.host:_.unshift(e.host)),e.host=null),x=x&&(""===_[0]||""===T[0])),b)i.host=e.host||""===e.host?e.host:i.host,i.hostname=e.hostname||""===e.hostname?e.hostname:i.hostname,i.search=e.search,i.query=e.query,T=_;else if(_.length)T||(T=[]),T.pop(),T=T.concat(_),i.search=e.search,i.query=e.query;else if(!r.isNullOrUndefined(e.search))return E&&(i.hostname=i.host=T.shift(),(R=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=R.shift(),i.host=i.hostname=R.shift())),i.search=e.search,i.query=e.query,(!r.isNull(i.pathname)||!r.isNull(i.search))&&(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.href=i.format(),i;if(!T.length)return i.pathname=null,i.search?i.path="/"+i.search:i.path=null,i.href=i.format(),i;for(var A=T.slice(-1)[0],w=(i.host||e.host||T.length>1)&&("."===A||".."===A)||""===A,C=0,O=T.length;O>=0;O--)"."===(A=T[O])?T.splice(O,1):".."===A?(T.splice(O,1),C++):C&&(T.splice(O,1),C--);if(!x&&!S)for(;C--;C)T.unshift("..");x&&""!==T[0]&&(!T[0]||"/"!==T[0].charAt(0))&&T.unshift(""),w&&"/"!==T.join("/").substr(-1)&&T.push("");var R,D=""===T[0]||T[0]&&"/"===T[0].charAt(0);return E&&(i.hostname=i.host=D?"":T.length?T.shift():"",(R=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=R.shift(),i.host=i.hostname=R.shift())),(x=x||i.host&&T.length)&&!D&&T.unshift(""),T.length?i.pathname=T.join("/"):(i.pathname=null,i.path=null),(!r.isNull(i.pathname)||!r.isNull(i.search))&&(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.auth=e.auth||i.auth,i.slashes=i.slashes||e.slashes,i.href=i.format(),i},n.prototype.parseHost=function(){var e=this.host,t=s.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}}}),require_parse_uri=__commonJS({"node_modules/parse-uri/index.js"(e,t){t.exports=function(e,t){if(e){t=t||{};for(var r={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},n=r.parser[t.strictMode?"strict":"loose"].exec(e),i={},s=14;s--;)i[r.key[s]]=n[s]||"";return i[r.q.name]={},i[r.key[12]].replace(r.q.parser,(function(e,t,n){t&&(i[r.q.name][t]=n)})),i}}}}),require_mini_signals=__commonJS({"node_modules/mini-signals/lib/mini-signals.js"(e,t){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(t,r,i){void 0===r&&(r=!1),n(this,e),this._fn=t,this._once=r,this._thisArg=i,this._next=this._prev=this._owner=null}return r(e,[{key:"detach",value:function(){return null!==this._owner&&(this._owner.detach(this),!0)}}]),e}();function s(e,t){return e._head?(e._tail._next=t,t._prev=e._tail,e._tail=t):(e._head=t,e._tail=t),t._owner=e,t}var o=function(){function e(){n(this,e),this._head=this._tail=void 0}return r(e,[{key:"handlers",value:function(){var e=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],t=this._head;if(e)return!!t;for(var r=[];t;)r.push(t),t=t._next;return r}},{key:"has",value:function(e){if(!(e instanceof i))throw new Error("MiniSignal#has(): First arg must be a MiniSignalBinding object.");return e._owner===this}},{key:"dispatch",value:function(){var e=this._head;if(!e)return!1;for(;e;)e._once&&this.detach(e),e._fn.apply(e._thisArg,arguments),e=e._next;return!0}},{key:"add",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof e)throw new Error("MiniSignal#add(): First arg must be a Function.");return s(this,new i(e,!1,t))}},{key:"once",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof e)throw new Error("MiniSignal#once(): First arg must be a Function.");return s(this,new i(e,!0,t))}},{key:"detach",value:function(e){if(!(e instanceof i))throw new Error("MiniSignal#detach(): First arg must be a MiniSignalBinding object.");return e._owner!==this||(e._prev&&(e._prev._next=e._next),e._next&&(e._next._prev=e._prev),e===this._head?(this._head=e._next,null===e._next&&(this._tail=null)):e===this._tail&&(this._tail=e._prev,this._tail._next=null),e._owner=null),this}},{key:"detachAll",value:function(){var e=this._head;if(!e)return this;for(this._head=this._tail=null;e;)e._owner=null,e=e._next;return this}}]),e}();o.MiniSignalBinding=i,e.default=o,t.exports=e.default}}),require_log4javascript=__commonJS({"node_modules/log4javascript/log4javascript.js"(exports,module){var factory,root;factory=function(){function isUndefined(e){return void 0===e}function EventSupport(){}Array.prototype.push||(Array.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)this[this.length]=arguments[e];return this.length}),Array.prototype.shift||(Array.prototype.shift=function(){if(this.length>0){for(var e=this[0],t=0,r=this.length-1;t<r;t++)this[t]=this[t+1];return this.length=this.length-1,e}}),Array.prototype.splice||(Array.prototype.splice=function(e,t){var r=this.slice(e+t),n=this.slice(e,e+t);this.length=e;for(var i=[],s=0,o=arguments.length;s<o;s++)i[s]=arguments[s];var a=i.length>2?r=i.slice(2).concat(r):r;for(s=0,o=a.length;s<o;s++)this.push(a[s]);return n}),EventSupport.prototype={eventTypes:[],eventListeners:{},setEventTypes:function(e){if(e instanceof Array){this.eventTypes=e,this.eventListeners={};for(var t=0,r=this.eventTypes.length;t<r;t++)this.eventListeners[this.eventTypes[t]]=[]}else handleError("log4javascript.EventSupport ["+this+"]: setEventTypes: eventTypes parameter must be an Array")},addEventListener:function(e,t){"function"==typeof t?(array_contains(this.eventTypes,e)||handleError("log4javascript.EventSupport ["+this+"]: addEventListener: no event called '"+e+"'"),this.eventListeners[e].push(t)):handleError("log4javascript.EventSupport ["+this+"]: addEventListener: listener must be a function")},removeEventListener:function(e,t){"function"==typeof t?(array_contains(this.eventTypes,e)||handleError("log4javascript.EventSupport ["+this+"]: removeEventListener: no event called '"+e+"'"),array_remove(this.eventListeners[e],t)):handleError("log4javascript.EventSupport ["+this+"]: removeEventListener: listener must be a function")},dispatchEvent:function(e,t){if(array_contains(this.eventTypes,e))for(var r=this.eventListeners[e],n=0,i=r.length;n<i;n++)r[n](this,e,t);else handleError("log4javascript.EventSupport ["+this+"]: dispatchEvent: no event called '"+e+"'")}};var applicationStartDate=new Date,uniqueId="log4javascript_"+applicationStartDate.getTime()+"_"+Math.floor(1e8*Math.random()),emptyFunction=function(){},newLine="\r\n",pageLoaded=!1;function Log4JavaScript(){}Log4JavaScript.prototype=new EventSupport;var log4javascript=new Log4JavaScript;function toStr(e){return e&&e.toString?e.toString():String(e)}function getExceptionMessage(e){return e.message?e.message:e.description?e.description:toStr(e)}function getUrlFileName(e){var t=Math.max(e.lastIndexOf("/"),e.lastIndexOf("\\"));return e.substr(t+1)}function getExceptionStringRep(e){if(e){var t="Exception: "+getExceptionMessage(e);try{e.lineNumber&&(t+=" on line number "+e.lineNumber),e.fileName&&(t+=" in file "+getUrlFileName(e.fileName))}catch(e){logLog.warn("Unable to obtain file and line information for error")}return showStackTraces&&e.stack&&(t+=newLine+"Stack trace:"+newLine+e.stack),t}return null}function bool(e){return Boolean(e)}function trim(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")}function splitIntoLines(e){return e.replace(/\r\n/g,"\n").replace(/\r/g,"\n").split("\n")}log4javascript.version="1.4.13",log4javascript.edition="log4javascript";var urlEncode=void 0!==window.encodeURIComponent?function(e){return encodeURIComponent(e)}:function(e){return escape(e).replace(/\+/g,"%2B").replace(/"/g,"%22").replace(/'/g,"%27").replace(/\//g,"%2F").replace(/=/g,"%3D")};function array_remove(e,t){for(var r=-1,n=0,i=e.length;n<i;n++)if(e[n]===t){r=n;break}return r>=0&&(e.splice(r,1),!0)}function array_contains(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]==t)return!0;return!1}function extractBooleanFromParam(e,t){return isUndefined(e)?t:bool(e)}function extractStringFromParam(e,t){return isUndefined(e)?t:String(e)}function extractIntFromParam(e,t){if(isUndefined(e))return t;try{var r=parseInt(e,10);return isNaN(r)?t:r}catch(r){return logLog.warn("Invalid int param "+e,r),t}}function extractFunctionFromParam(e,t){return"function"==typeof e?e:t}function isError(e){return e instanceof Error}Function.prototype.apply||(Function.prototype.apply=function(obj,args){var methodName="__apply__";void 0!==obj[methodName]&&(methodName+=String(Math.random()).substr(2)),obj[methodName]=this;for(var argsStrings=[],i=0,len=args.length;i<len;i++)argsStrings[i]="args["+i+"]";var script="obj."+methodName+"("+argsStrings.join(",")+")",returnValue=eval(script);return delete obj[methodName],returnValue}),Function.prototype.call||(Function.prototype.call=function(e){for(var t=[],r=1,n=arguments.length;r<n;r++)t[r-1]=arguments[r];return this.apply(e,t)});var logLog={quietMode:!1,debugMessages:[],setQuietMode:function(e){this.quietMode=bool(e)},numberOfErrors:0,alertAllErrors:!1,setAlertAllErrors:function(e){this.alertAllErrors=e},debug:function(e){this.debugMessages.push(e)},displayDebug:function(){alert(this.debugMessages.join(newLine))},warn:function(e,t){},error:function(e,t){if((1==++this.numberOfErrors||this.alertAllErrors)&&!this.quietMode){var r="log4javascript error: "+e;t&&(r+=newLine+newLine+"Original error: "+getExceptionStringRep(t)),alert(r)}}};function handleError(e,t){logLog.error(e,t),log4javascript.dispatchEvent("error",{message:e,exception:t})}log4javascript.logLog=logLog,log4javascript.setEventTypes(["load","error"]),log4javascript.handleError=handleError;var enabled=!("undefined"!=typeof log4javascript_disabled&&log4javascript_disabled);log4javascript.setEnabled=function(e){enabled=bool(e)},log4javascript.isEnabled=function(){return enabled};var useTimeStampsInMilliseconds=!0;log4javascript.setTimeStampsInMilliseconds=function(e){useTimeStampsInMilliseconds=bool(e)},log4javascript.isTimeStampsInMilliseconds=function(){return useTimeStampsInMilliseconds},log4javascript.evalInScope=function(expr){return eval(expr)};var showStackTraces=!1;log4javascript.setShowStackTraces=function(e){showStackTraces=bool(e)};var Level=function(e,t){this.level=e,this.name=t};function Timer(e,t){this.name=e,this.level=isUndefined(t)?Level.INFO:t,this.start=new Date}Level.prototype={toString:function(){return this.name},equals:function(e){return this.level==e.level},isGreaterOrEqual:function(e){return this.level>=e.level}},Level.ALL=new Level(Number.MIN_VALUE,"ALL"),Level.TRACE=new Level(1e4,"TRACE"),Level.DEBUG=new Level(2e4,"DEBUG"),Level.INFO=new Level(3e4,"INFO"),Level.WARN=new Level(4e4,"WARN"),Level.ERROR=new Level(5e4,"ERROR"),Level.FATAL=new Level(6e4,"FATAL"),Level.OFF=new Level(Number.MAX_VALUE,"OFF"),log4javascript.Level=Level,Timer.prototype.getElapsedTime=function(){return(new Date).getTime()-this.start.getTime()};var anonymousLoggerName="[anonymous]",defaultLoggerName="[default]",nullLoggerName="[null]",rootLoggerName="root";function Logger(e){this.name=e,this.parent=null,this.children=[];var t=[],r=null,n=this.name===rootLoggerName,i=this.name===nullLoggerName,s=null,o=!1;this.addChild=function(e){this.children.push(e),e.parent=this,e.invalidateAppenderCache()};var a=!0;this.getAdditivity=function(){return a},this.setAdditivity=function(e){var t=a!=e;a=e,t&&this.invalidateAppenderCache()},this.addAppender=function(e){i?handleError("Logger.addAppender: you may not add an appender to the null logger"):e instanceof log4javascript.Appender?array_contains(t,e)||(t.push(e),e.setAddedToLogger(this),this.invalidateAppenderCache()):handleError("Logger.addAppender: appender supplied ('"+toStr(e)+"') is not a subclass of Appender")},this.removeAppender=function(e){array_remove(t,e),e.setRemovedFromLogger(this),this.invalidateAppenderCache()},this.removeAllAppenders=function(){var e=t.length;if(e>0){for(var r=0;r<e;r++)t[r].setRemovedFromLogger(this);t.length=0,this.invalidateAppenderCache()}},this.getEffectiveAppenders=function(){if(null===s||o){var e=n||!this.getAdditivity()?[]:this.parent.getEffectiveAppenders();s=e.concat(t),o=!1}return s},this.invalidateAppenderCache=function(){o=!0;for(var e=0,t=this.children.length;e<t;e++)this.children[e].invalidateAppenderCache()},this.log=function(e,t){if(enabled&&e.isGreaterOrEqual(this.getEffectiveLevel())){var r,n=t.length-1,i=t[n];t.length>1&&isError(i)&&(r=i,n--);for(var s=[],o=0;o<=n;o++)s[o]=t[o];var a=new LoggingEvent(this,new Date,e,s,r);this.callAppenders(a)}},this.callAppenders=function(e){for(var t=this.getEffectiveAppenders(),r=0,n=t.length;r<n;r++)t[r].doAppend(e)},this.setLevel=function(e){n&&null===e?handleError("Logger.setLevel: you cannot set the level of the root logger to null"):e instanceof Level?r=e:handleError("Logger.setLevel: level supplied to logger "+this.name+" is not an instance of log4javascript.Level")},this.getLevel=function(){return r},this.getEffectiveLevel=function(){for(var e=this;null!==e;e=e.parent){var t=e.getLevel();if(null!==t)return t}},this.group=function(e,t){if(enabled)for(var r=this.getEffectiveAppenders(),n=0,i=r.length;n<i;n++)r[n].group(e,t)},this.groupEnd=function(){if(enabled)for(var e=this.getEffectiveAppenders(),t=0,r=e.length;t<r;t++)e[t].groupEnd()};var l={};this.time=function(e,t){enabled&&(isUndefined(e)?handleError("Logger.time: a name for the timer must be supplied"):!t||t instanceof Level?l[e]=new Timer(e,t):handleError("Logger.time: level supplied to timer "+e+" is not an instance of log4javascript.Level"))},this.timeEnd=function(e){if(enabled)if(isUndefined(e))handleError("Logger.timeEnd: a name for the timer must be supplied");else if(l[e]){var t=l[e],r=t.getElapsedTime();this.log(t.level,["Timer "+toStr(e)+" completed in "+r+"ms"]),delete l[e]}else logLog.warn("Logger.timeEnd: no timer found with name "+e)},this.assert=function(e){if(enabled&&!e){for(var t=[],r=1,n=arguments.length;r<n;r++)t.push(arguments[r]);(t=t.length>0?t:["Assertion Failure"]).push(newLine),t.push(e),this.log(Level.ERROR,t)}},this.toString=function(){return"Logger["+this.name+"]"}}Logger.prototype={trace:function(){this.log(Level.TRACE,arguments)},debug:function(){this.log(Level.DEBUG,arguments)},info:function(){this.log(Level.INFO,arguments)},warn:function(){this.log(Level.WARN,arguments)},error:function(){this.log(Level.ERROR,arguments)},fatal:function(){this.log(Level.FATAL,arguments)},isEnabledFor:function(e){return e.isGreaterOrEqual(this.getEffectiveLevel())},isTraceEnabled:function(){return this.isEnabledFor(Level.TRACE)},isDebugEnabled:function(){return this.isEnabledFor(Level.DEBUG)},isInfoEnabled:function(){return this.isEnabledFor(Level.INFO)},isWarnEnabled:function(){return this.isEnabledFor(Level.WARN)},isErrorEnabled:function(){return this.isEnabledFor(Level.ERROR)},isFatalEnabled:function(){return this.isEnabledFor(Level.FATAL)}},Logger.prototype.trace.isEntryPoint=!0,Logger.prototype.debug.isEntryPoint=!0,Logger.prototype.info.isEntryPoint=!0,Logger.prototype.warn.isEntryPoint=!0,Logger.prototype.error.isEntryPoint=!0,Logger.prototype.fatal.isEntryPoint=!0;var loggers={},loggerNames=[],ROOT_LOGGER_DEFAULT_LEVEL=Level.DEBUG,rootLogger=new Logger(rootLoggerName);rootLogger.setLevel(ROOT_LOGGER_DEFAULT_LEVEL),log4javascript.getRootLogger=function(){return rootLogger},log4javascript.getLogger=function(e){if("string"!=typeof e&&(e=anonymousLoggerName,logLog.warn("log4javascript.getLogger: non-string logger name "+toStr(e)+" supplied, returning anonymous logger")),e==rootLoggerName&&handleError("log4javascript.getLogger: root logger may not be obtained by name"),!loggers[e]){var t=new Logger(e);loggers[e]=t,loggerNames.push(e);var r,n=e.lastIndexOf(".");if(n>-1){var i=e.substring(0,n);r=log4javascript.getLogger(i)}else r=rootLogger;r.addChild(t)}return loggers[e]};var defaultLogger=null;log4javascript.getDefaultLogger=function(){return defaultLogger||(defaultLogger=createDefaultLogger()),defaultLogger};var nullLogger=null;log4javascript.getNullLogger=function(){return nullLogger||(nullLogger=new Logger(nullLoggerName)).setLevel(Level.OFF),nullLogger},log4javascript.resetConfiguration=function(){rootLogger.setLevel(ROOT_LOGGER_DEFAULT_LEVEL),loggers={}};var LoggingEvent=function(e,t,r,n,i){this.logger=e,this.timeStamp=t,this.timeStampInMilliseconds=t.getTime(),this.timeStampInSeconds=Math.floor(this.timeStampInMilliseconds/1e3),this.milliseconds=this.timeStamp.getMilliseconds(),this.level=r,this.messages=n,this.exception=i};LoggingEvent.prototype={getThrowableStrRep:function(){return this.exception?getExceptionStringRep(this.exception):""},getCombinedMessages:function(){return 1==this.messages.length?this.messages[0]:this.messages.join(newLine)},toString:function(){return"LoggingEvent["+this.level+"]"}},log4javascript.LoggingEvent=LoggingEvent;var Layout=function(){};Layout.prototype={defaults:{loggerKey:"logger",timeStampKey:"timestamp",millisecondsKey:"milliseconds",levelKey:"level",messageKey:"message",exceptionKey:"exception",urlKey:"url"},loggerKey:"logger",timeStampKey:"timestamp",millisecondsKey:"milliseconds",levelKey:"level",messageKey:"message",exceptionKey:"exception",urlKey:"url",batchHeader:"",batchFooter:"",batchSeparator:"",returnsPostData:!1,overrideTimeStampsSetting:!1,useTimeStampsInMilliseconds:null,format:function(){handleError("Layout.format: layout supplied has no format() method")},ignoresThrowable:function(){handleError("Layout.ignoresThrowable: layout supplied has no ignoresThrowable() method")},getContentType:function(){return"text/plain"},allowBatching:function(){return!0},setTimeStampsInMilliseconds:function(e){this.overrideTimeStampsSetting=!0,this.useTimeStampsInMilliseconds=bool(e)},isTimeStampsInMilliseconds:function(){return this.overrideTimeStampsSetting?this.useTimeStampsInMilliseconds:useTimeStampsInMilliseconds},getTimeStampValue:function(e){return this.isTimeStampsInMilliseconds()?e.timeStampInMilliseconds:e.timeStampInSeconds},getDataValues:function(e,t){var r=[[this.loggerKey,e.logger.name],[this.timeStampKey,this.getTimeStampValue(e)],[this.levelKey,e.level.name],[this.urlKey,window.location.href],[this.messageKey,t?e.getCombinedMessages():e.messages]];if(this.isTimeStampsInMilliseconds()||r.push([this.millisecondsKey,e.milliseconds]),e.exception&&r.push([this.exceptionKey,getExceptionStringRep(e.exception)]),this.hasCustomFields())for(var n=0,i=this.customFields.length;n<i;n++){var s=this.customFields[n].value;"function"==typeof s&&(s=s(this,e)),r.push([this.customFields[n].name,s])}return r},setKeys:function(e,t,r,n,i,s,o){this.loggerKey=extractStringFromParam(e,this.defaults.loggerKey),this.timeStampKey=extractStringFromParam(t,this.defaults.timeStampKey),this.levelKey=extractStringFromParam(r,this.defaults.levelKey),this.messageKey=extractStringFromParam(n,this.defaults.messageKey),this.exceptionKey=extractStringFromParam(i,this.defaults.exceptionKey),this.urlKey=extractStringFromParam(s,this.defaults.urlKey),this.millisecondsKey=extractStringFromParam(o,this.defaults.millisecondsKey)},setCustomField:function(e,t){for(var r=!1,n=0,i=this.customFields.length;n<i;n++)this.customFields[n].name===e&&(this.customFields[n].value=t,r=!0);r||this.customFields.push({name:e,value:t})},hasCustomFields:function(){return this.customFields.length>0},formatWithException:function(e){var t=this.format(e);return e.exception&&this.ignoresThrowable()&&(t+=e.getThrowableStrRep()),t},toString:function(){handleError("Layout.toString: all layouts must override this method")}},log4javascript.Layout=Layout;var Appender=function(){},SimpleDateFormat;function SimpleLayout(){this.customFields=[]}function NullLayout(){this.customFields=[]}function XmlLayout(e){this.combineMessages=extractBooleanFromParam(e,!0),this.customFields=[]}function escapeNewLines(e){return e.replace(/\r\n|\r|\n/g,"\\r\\n")}function JsonLayout(e,t){this.readable=extractBooleanFromParam(e,!1),this.combineMessages=extractBooleanFromParam(t,!0),this.batchHeader=this.readable?"["+newLine:"[",this.batchFooter=this.readable?"]"+newLine:"]",this.batchSeparator=this.readable?","+newLine:",",this.setKeys(),this.colon=this.readable?": ":":",this.tab=this.readable?"\t":"",this.lineBreak=this.readable?newLine:"",this.customFields=[]}function HttpPostDataLayout(){this.setKeys(),this.customFields=[],this.returnsPostData=!0}function formatObjectExpansion(e,t,r){var n=[];return function e(t,r,i){var s,o,a,l,h,u,c;function d(e){for(var t=splitIntoLines(e),r=1,n=t.length;r<n;r++)t[r]=i+t[r];return t.join(newLine)}if(i||(i=""),null===t)return"null";if(void 0===t)return"undefined";if("string"==typeof t)return d(t);if("object"==typeof t&&array_contains(n,t)){try{u=toStr(t)}catch(e){u="Error formatting property. Details: "+getExceptionStringRep(e)}return u+" [already expanded]"}if(t instanceof Array&&r>0){for(n.push(t),u="["+newLine,a=r-1,l=i+"  ",h=[],s=0,o=t.length;s<o;s++)try{c=e(t[s],a,l),h.push(l+c)}catch(e){h.push(l+"Error formatting array member. Details: "+getExceptionStringRep(e))}return u+(h.join(","+newLine)+newLine+i+"]")}if("[object Date]"==Object.prototype.toString.call(t))return t.toString();if("object"==typeof t&&r>0){for(s in n.push(t),u="{"+newLine,a=r-1,l=i+"  ",h=[],t)try{c=e(t[s],a,l),h.push(l+s+": "+c)}catch(e){h.push(l+s+": Error formatting property. Details: "+getExceptionStringRep(e))}return u+(h.join(","+newLine)+newLine+i+"}")}return d(toStr(t))}(e,t,r)}function PatternLayout(e){this.pattern=e||PatternLayout.DEFAULT_CONVERSION_PATTERN,this.customFields=[]}function AlertAppender(){}function BrowserConsoleAppender(){}Appender.prototype=new EventSupport,Appender.prototype.layout=new PatternLayout,Appender.prototype.threshold=Level.ALL,Appender.prototype.loggers=[],Appender.prototype.doAppend=function(e){enabled&&e.level.level>=this.threshold.level&&this.append(e)},Appender.prototype.append=function(e){},Appender.prototype.setLayout=function(e){e instanceof Layout?this.layout=e:handleError("Appender.setLayout: layout supplied to "+this.toString()+" is not a subclass of Layout")},Appender.prototype.getLayout=function(){return this.layout},Appender.prototype.setThreshold=function(e){e instanceof Level?this.threshold=e:handleError("Appender.setThreshold: threshold supplied to "+this.toString()+" is not a subclass of Level")},Appender.prototype.getThreshold=function(){return this.threshold},Appender.prototype.setAddedToLogger=function(e){this.loggers.push(e)},Appender.prototype.setRemovedFromLogger=function(e){array_remove(this.loggers,e)},Appender.prototype.group=emptyFunction,Appender.prototype.groupEnd=emptyFunction,Appender.prototype.toString=function(){handleError("Appender.toString: all appenders must override this method")},log4javascript.Appender=Appender,SimpleLayout.prototype=new Layout,SimpleLayout.prototype.format=function(e){return e.level.name+" - "+e.getCombinedMessages()},SimpleLayout.prototype.ignoresThrowable=function(){return!0},SimpleLayout.prototype.toString=function(){return"SimpleLayout"},log4javascript.SimpleLayout=SimpleLayout,NullLayout.prototype=new Layout,NullLayout.prototype.format=function(e){return e.messages},NullLayout.prototype.ignoresThrowable=function(){return!0},NullLayout.prototype.formatWithException=function(e){var t=e.messages,r=e.exception;return r?t.concat([r]):t},NullLayout.prototype.toString=function(){return"NullLayout"},log4javascript.NullLayout=NullLayout,XmlLayout.prototype=new Layout,XmlLayout.prototype.isCombinedMessages=function(){return this.combineMessages},XmlLayout.prototype.getContentType=function(){return"text/xml"},XmlLayout.prototype.escapeCdata=function(e){return e.replace(/\]\]>/,"]]>]]&gt;<![CDATA[")},XmlLayout.prototype.format=function(e){var t,r,n=this;function i(e){return e="string"==typeof e?e:toStr(e),"<log4javascript:message><![CDATA["+n.escapeCdata(e)+"]]></log4javascript:message>"}var s='<log4javascript:event logger="'+e.logger.name+'" timestamp="'+this.getTimeStampValue(e)+'"';if(this.isTimeStampsInMilliseconds()||(s+=' milliseconds="'+e.milliseconds+'"'),s+=' level="'+e.level.name+'">'+newLine,this.combineMessages)s+=i(e.getCombinedMessages());else{for(s+="<log4javascript:messages>"+newLine,t=0,r=e.messages.length;t<r;t++)s+=i(e.messages[t])+newLine;s+="</log4javascript:messages>"+newLine}if(this.hasCustomFields())for(t=0,r=this.customFields.length;t<r;t++)s+='<log4javascript:customfield name="'+this.customFields[t].name+'"><![CDATA['+this.customFields[t].value.toString()+"]]></log4javascript:customfield>"+newLine;return e.exception&&(s+="<log4javascript:exception><![CDATA["+getExceptionStringRep(e.exception)+"]]></log4javascript:exception>"+newLine),s+"</log4javascript:event>"+newLine+newLine},XmlLayout.prototype.ignoresThrowable=function(){return!1},XmlLayout.prototype.toString=function(){return"XmlLayout"},log4javascript.XmlLayout=XmlLayout,JsonLayout.prototype=new Layout,JsonLayout.prototype.isReadable=function(){return this.readable},JsonLayout.prototype.isCombinedMessages=function(){return this.combineMessages},JsonLayout.prototype.format=function(e){var t,r,n=this,i=this.getDataValues(e,this.combineMessages),s="{"+this.lineBreak;function o(e,t,r){var i,s=typeof e;if(e instanceof Date)i=String(e.getTime());else if(r&&e instanceof Array){i="["+n.lineBreak;for(var a=0,l=e.length;a<l;a++){var h=t+n.tab;i+=h+o(e[a],h,!1),a<e.length-1&&(i+=","),i+=n.lineBreak}i+=t+"]"}else i="number"!==s&&"boolean"!==s?'"'+escapeNewLines(toStr(e).replace(/\"/g,'\\"'))+'"':e;return i}for(t=0,r=i.length-1;t<=r;t++)s+=this.tab+'"'+i[t][0]+'"'+this.colon+o(i[t][1],this.tab,!0),t<r&&(s+=","),s+=this.lineBreak;return s+"}"+this.lineBreak},JsonLayout.prototype.ignoresThrowable=function(){return!1},JsonLayout.prototype.toString=function(){return"JsonLayout"},JsonLayout.prototype.getContentType=function(){return"application/json"},log4javascript.JsonLayout=JsonLayout,HttpPostDataLayout.prototype=new Layout,HttpPostDataLayout.prototype.allowBatching=function(){return!1},HttpPostDataLayout.prototype.format=function(e){for(var t=this.getDataValues(e),r=[],n=0,i=t.length;n<i;n++){var s=t[n][1]instanceof Date?String(t[n][1].getTime()):t[n][1];r.push(urlEncode(t[n][0])+"="+urlEncode(s))}return r.join("&")},HttpPostDataLayout.prototype.ignoresThrowable=function(e){return!1},HttpPostDataLayout.prototype.toString=function(){return"HttpPostDataLayout"},log4javascript.HttpPostDataLayout=HttpPostDataLayout,function(){var e=/('[^']*')|(G+|y+|M+|w+|W+|D+|d+|F+|E+|a+|H+|k+|K+|h+|m+|s+|S+|Z+)|([a-zA-Z]+)|([^a-zA-Z']+)/,t=["January","February","March","April","May","June","July","August","September","October","November","December"],r=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],n={G:0,y:3,M:4,w:2,W:2,D:2,d:2,F:2,E:1,a:0,H:2,k:2,K:2,h:2,m:2,s:2,S:2,Z:5},i=864e5,s=6048e5,o=function(e,t,r){var n=new Date(e,t,r,0,0,0);return n.setMilliseconds(0),n};Date.prototype.getDifference=function(e){return this.getTime()-e.getTime()},Date.prototype.isBefore=function(e){return this.getTime()<e.getTime()},Date.prototype.getUTCTime=function(){return Date.UTC(this.getFullYear(),this.getMonth(),this.getDate(),this.getHours(),this.getMinutes(),this.getSeconds(),this.getMilliseconds())},Date.prototype.getTimeSince=function(e){return this.getUTCTime()-e.getUTCTime()},Date.prototype.getPreviousSunday=function(){var e=new Date(this.getFullYear(),this.getMonth(),this.getDate(),12,0,0),t=new Date(e.getTime()-this.getDay()*i);return o(t.getFullYear(),t.getMonth(),t.getDate())},Date.prototype.getWeekInYear=function(e){isUndefined(this.minimalDaysInFirstWeek)&&(e=1);var t=this.getPreviousSunday(),r=o(this.getFullYear(),0,1),n=t.isBefore(r)?0:1+Math.floor(t.getTimeSince(r)/s);return 7-r.getDay()<e&&n--,n},Date.prototype.getWeekInMonth=function(e){isUndefined(this.minimalDaysInFirstWeek)&&(e=1);var t=this.getPreviousSunday(),r=o(this.getFullYear(),this.getMonth(),1),n=t.isBefore(r)?0:1+Math.floor(t.getTimeSince(r)/s);return 7-r.getDay()>=e&&n++,n},Date.prototype.getDayInYear=function(){var e=o(this.getFullYear(),0,1);return 1+Math.floor(this.getTimeSince(e)/i)},(SimpleDateFormat=function(e){this.formatString=e}).prototype.setMinimalDaysInFirstWeek=function(e){this.minimalDaysInFirstWeek=e},SimpleDateFormat.prototype.getMinimalDaysInFirstWeek=function(){return isUndefined(this.minimalDaysInFirstWeek)?1:this.minimalDaysInFirstWeek};var a=function(e,t){for(;e.length<t;)e="0"+e;return e},l=function(e,t,r){return t>=4?e:e.substr(0,Math.max(r,t))},h=function(e,t){return a(""+e,t)};SimpleDateFormat.prototype.format=function(i){for(var s,o="",u=this.formatString;s=e.exec(u);){var c=s[1],d=s[2],f=s[3],p=s[4];if(c)o+="''"==c?"'":c.substring(1,c.length-1);else if(!f)if(p)o+=p;else if(d){var m=d.charAt(0),_=d.length,g="";switch(m){case"G":g="AD";break;case"y":g=i.getFullYear();break;case"M":g=i.getMonth();break;case"w":g=i.getWeekInYear(this.getMinimalDaysInFirstWeek());break;case"W":g=i.getWeekInMonth(this.getMinimalDaysInFirstWeek());break;case"D":g=i.getDayInYear();break;case"d":g=i.getDate();break;case"F":g=1+Math.floor((i.getDate()-1)/7);break;case"E":g=r[i.getDay()];break;case"a":g=i.getHours()>=12?"PM":"AM";break;case"H":g=i.getHours();break;case"k":g=i.getHours()||24;break;case"K":g=i.getHours()%12;break;case"h":g=i.getHours()%12||12;break;case"m":g=i.getMinutes();break;case"s":g=i.getSeconds();break;case"S":g=i.getMilliseconds();break;case"Z":g=i.getTimezoneOffset()}switch(n[m]){case 0:o+=l(g,_,2);break;case 1:o+=l(g,_,3);break;case 2:o+=h(g,_);break;case 3:o+=_<=3?(""+g).substr(2,2):h(g,_);break;case 4:o+=_>=3?l(t[g],_,_):h(g+1,_);break;case 5:var v=g>0?"-":"+",y=Math.abs(g),b=""+Math.floor(y/60),x=""+y%60;o+=v+(b=a(b,2))+(x=a(x,2))}}u=u.substr(s.index+s[0].length)}return o}}(),log4javascript.SimpleDateFormat=SimpleDateFormat,PatternLayout.TTCC_CONVERSION_PATTERN="%r %p %c - %m%n",PatternLayout.DEFAULT_CONVERSION_PATTERN="%m%n",PatternLayout.ISO8601_DATEFORMAT="yyyy-MM-dd HH:mm:ss,SSS",PatternLayout.DATETIME_DATEFORMAT="dd MMM yyyy HH:mm:ss,SSS",PatternLayout.ABSOLUTETIME_DATEFORMAT="HH:mm:ss,SSS",PatternLayout.prototype=new Layout,PatternLayout.prototype.format=function(e){for(var t,r=/%(-?[0-9]+)?(\.?[0-9]+)?([acdfmMnpr%])(\{([^\}]+)\})?|([^%]+)/,n="",i=this.pattern;t=r.exec(i);){var s=t[0],o=t[1],a=t[2],l=t[3],h=t[5],u=t[6];if(u)n+=""+u;else{var c,d="";switch(l){case"a":case"m":var f=0;h&&(f=parseInt(h,10),isNaN(f)&&(handleError("PatternLayout.format: invalid specifier '"+h+"' for conversion character '"+l+"' - should be a number"),f=0));for(var p="a"===l?e.messages[0]:e.messages,m=0,_=p.length;m<_;m++)m>0&&" "!==d.charAt(d.length-1)&&(d+=" "),d+=0===f?p[m]:formatObjectExpansion(p[m],f);break;case"c":var g=e.logger.name;if(h){var v=parseInt(h,10),y=e.logger.name.split(".");d=v>=y.length?g:y.slice(y.length-v).join(".")}else d=g;break;case"d":var b=PatternLayout.ISO8601_DATEFORMAT;h&&("ISO8601"==(b=h)?b=PatternLayout.ISO8601_DATEFORMAT:"ABSOLUTE"==b?b=PatternLayout.ABSOLUTETIME_DATEFORMAT:"DATE"==b&&(b=PatternLayout.DATETIME_DATEFORMAT)),d=new SimpleDateFormat(b).format(e.timeStamp);break;case"f":if(this.hasCustomFields()){var x=0;h&&(x=parseInt(h,10),isNaN(x)?handleError("PatternLayout.format: invalid specifier '"+h+"' for conversion character 'f' - should be a number"):0===x?handleError("PatternLayout.format: invalid specifier '"+h+"' for conversion character 'f' - must be greater than zero"):x>this.customFields.length?handleError("PatternLayout.format: invalid specifier '"+h+"' for conversion character 'f' - there aren't that many custom fields"):x-=1);var S=this.customFields[x].value;"function"==typeof S&&(S=S(this,e)),d=S}break;case"n":d=newLine;break;case"p":d=e.level.name;break;case"r":d=""+e.timeStamp.getDifference(applicationStartDate);break;case"%":d="%";break;default:d=s}if(a){c=parseInt(a.substr(1),10);var T=d.length;c<T&&(d=d.substring(T-c,T))}if(o)if("-"==o.charAt(0))for(c=parseInt(o.substr(1),10);d.length<c;)d+=" ";else for(c=parseInt(o,10);d.length<c;)d=" "+d;n+=d}i=i.substr(t.index+t[0].length)}return n},PatternLayout.prototype.ignoresThrowable=function(){return!0},PatternLayout.prototype.toString=function(){return"PatternLayout"},log4javascript.PatternLayout=PatternLayout,AlertAppender.prototype=new Appender,AlertAppender.prototype.layout=new SimpleLayout,AlertAppender.prototype.append=function(e){alert(this.getLayout().formatWithException(e))},AlertAppender.prototype.toString=function(){return"AlertAppender"},log4javascript.AlertAppender=AlertAppender,BrowserConsoleAppender.prototype=new log4javascript.Appender,BrowserConsoleAppender.prototype.layout=new NullLayout,BrowserConsoleAppender.prototype.threshold=Level.DEBUG,BrowserConsoleAppender.prototype.append=function(e){var t,r=this,n=function(t){var n=r.getLayout().formatWithException(e);return"string"==typeof n?t?n:[n]:t?n.join(" "):n},i=window.console;i&&i.log?"function"==typeof i[t=i.debug&&Level.DEBUG.isGreaterOrEqual(e.level)?"debug":i.info&&Level.INFO.equals(e.level)?"info":i.warn&&Level.WARN.equals(e.level)?"warn":i.error&&e.level.isGreaterOrEqual(Level.ERROR)?"error":"log"].apply?i[t].apply(i,n(!1)):i[t](n(!0)):"undefined"!=typeof opera&&opera.postError&&opera.postError(n(!0))},BrowserConsoleAppender.prototype.group=function(e){window.console&&window.console.group&&window.console.group(e)},BrowserConsoleAppender.prototype.groupEnd=function(){window.console&&window.console.groupEnd&&window.console.groupEnd()},BrowserConsoleAppender.prototype.toString=function(){return"BrowserConsoleAppender"},log4javascript.BrowserConsoleAppender=BrowserConsoleAppender;var xhrFactory=function(){return new XMLHttpRequest},xmlHttpFactories=[xhrFactory,function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],withCredentialsSupported=!1,getXmlHttp=function(e){for(var t,r=null,n=0,i=xmlHttpFactories.length;n<i;n++){t=xmlHttpFactories[n];try{return r=t(),withCredentialsSupported=t==xhrFactory&&"withCredentials"in r,getXmlHttp=t,r}catch(e){}}e?e():handleError("getXmlHttp: unable to obtain XMLHttpRequest object")},ConsoleAppender;function isHttpRequestSuccessful(e){return isUndefined(e.status)||0===e.status||e.status>=200&&e.status<300||1223==e.status}function AjaxAppender(e,t){var r=this,n=!0;e||(handleError("AjaxAppender: URL must be specified in constructor"),n=!1);var i=this.defaults.timed,s=this.defaults.waitForResponse,o=this.defaults.batchSize,a=this.defaults.timerInterval,l=this.defaults.requestSuccessCallback,h=this.defaults.failCallback,u=this.defaults.postVarName,c=this.defaults.sendAllOnUnload,d=this.defaults.contentType,f=null,p=[],m=[],_=[],g=!1,v=!1;function y(e){return!v||(handleError("AjaxAppender: configuration option '"+e+"' may not be set after the appender has been initialized"),!1)}function b(){var e;if(n&&enabled)if(g=!0,s)m.length>0?A(S(e=m.shift()),b):(g=!1,i&&T());else{for(;e=m.shift();)A(S(e));g=!1,i&&T()}}function x(){var e=!1;if(n&&enabled){for(var t,a=r.getLayout().allowBatching()?o:1,l=[];t=p.shift();)l.push(t),p.length>=a&&(m.push(l),l=[]);l.length>0&&m.push(l),e=m.length>0,s=!1,i=!1,b()}return e}function S(e){for(var t,n=[],i="";t=e.shift();)n.push(r.getLayout().formatWithException(t));return i=1==e.length?n.join(""):r.getLayout().batchHeader+n.join(r.getLayout().batchSeparator)+r.getLayout().batchFooter,d==r.defaults.contentType&&((i=r.getLayout().returnsPostData?i:urlEncode(u)+"="+urlEncode(i)).length>0&&(i+="&"),i+="layout="+urlEncode(r.getLayout().toString())),i}function T(){window.setTimeout(b,a)}function E(){var e="AjaxAppender: could not create XMLHttpRequest object. AjaxAppender disabled";handleError(e),n=!1,h&&h(e)}function A(r,i){try{var s=getXmlHttp(E);if(n){s.onreadystatechange=function(){if(4==s.readyState){if(isHttpRequestSuccessful(s))l&&l(s),i&&i(s);else{var t="AjaxAppender.append: XMLHttpRequest request to URL "+e+" returned status code "+s.status;handleError(t),h&&h(t)}s.onreadystatechange=emptyFunction,s=null}},s.open("POST",e,!0),t&&withCredentialsSupported&&(s.withCredentials=!0);try{for(var o,a=0;o=_[a++];)s.setRequestHeader(o.name,o.value);s.setRequestHeader("Content-Type",d)}catch(e){var u="AjaxAppender.append: your browser's XMLHttpRequest implementation does not support setRequestHeader, therefore cannot post data. AjaxAppender disabled";return handleError(u),n=!1,void(h&&h(u))}s.send(r)}}catch(t){var c="AjaxAppender.append: error sending log message to "+e;handleError(c,t),n=!1,h&&h(c+". Details: "+getExceptionStringRep(t))}}this.getSessionId=function(){return f},this.setSessionId=function(e){f=extractStringFromParam(e,null),this.layout.setCustomField("sessionid",f)},this.setLayout=function(e){y("layout")&&(this.layout=e,null!==f&&this.setSessionId(f))},this.isTimed=function(){return i},this.setTimed=function(e){y("timed")&&(i=bool(e))},this.getTimerInterval=function(){return a},this.setTimerInterval=function(e){y("timerInterval")&&(a=extractIntFromParam(e,a))},this.isWaitForResponse=function(){return s},this.setWaitForResponse=function(e){y("waitForResponse")&&(s=bool(e))},this.getBatchSize=function(){return o},this.setBatchSize=function(e){y("batchSize")&&(o=extractIntFromParam(e,o))},this.isSendAllOnUnload=function(){return c},this.setSendAllOnUnload=function(e){y("sendAllOnUnload")&&(c=extractBooleanFromParam(e,c))},this.setRequestSuccessCallback=function(e){l=extractFunctionFromParam(e,l)},this.setFailCallback=function(e){h=extractFunctionFromParam(e,h)},this.getPostVarName=function(){return u},this.setPostVarName=function(e){y("postVarName")&&(u=extractStringFromParam(e,u))},this.getHeaders=function(){return _},this.addHeader=function(e,t){"content-type"==e.toLowerCase()?d=t:_.push({name:e,value:t})},this.sendAll=b,this.sendAllRemaining=x,this.append=function(e){if(n){v||function(){if(v=!0,c){var e=window.onbeforeunload;window.onbeforeunload=function(){e&&e(),x()}}i&&T()}(),p.push(e);var t=this.getLayout().allowBatching()?o:1;if(p.length>=t){for(var r,a=[];r=p.shift();)a.push(r);m.push(a),!i&&(!s||s&&!g)&&b()}}}}function setCookie(e,t,r,n){var i;if(n=n?"; path="+n:"",r){var s=new Date;s.setTime(s.getTime()+24*r*60*60*1e3),i="; expires="+s.toGMTString()}else i="";document.cookie=escape(e)+"="+escape(t)+i+n}function getCookie(e){for(var t=escape(e)+"=",r=document.cookie.split(";"),n=0,i=r.length;n<i;n++){for(var s=r[n];" "===s.charAt(0);)s=s.substring(1,s.length);if(0===s.indexOf(t))return unescape(s.substring(t.length,s.length))}return null}function getBaseUrl(){for(var e=document.getElementsByTagName("script"),t=0,r=e.length;t<r;++t)if(-1!=e[t].src.indexOf("log4javascript")){var n=e[t].src.lastIndexOf("/");return-1==n?"":e[t].src.substr(0,n+1)}return null}function isLoaded(e){try{return bool(e.loaded)}catch(e){return!1}}function padWithSpaces(e,t){if(e.length<t){for(var r=[],n=Math.max(0,t-e.length),i=0;i<n;i++)r[i]=" ";e+=r.join("")}return e}function createDefaultLogger(){var e=log4javascript.getLogger(defaultLoggerName),t=new log4javascript.PopUpAppender;return e.addAppender(t),e}if(AjaxAppender.prototype=new Appender,AjaxAppender.prototype.defaults={waitForResponse:!1,timed:!1,timerInterval:1e3,batchSize:1,sendAllOnUnload:!1,requestSuccessCallback:null,failCallback:null,postVarName:"data",contentType:"application/x-www-form-urlencoded"},AjaxAppender.prototype.layout=new HttpPostDataLayout,AjaxAppender.prototype.toString=function(){return"AjaxAppender"},log4javascript.AjaxAppender=AjaxAppender,function(){var e=[],t=1;function r(e,t,r,n,i){this.create(!1,null,e,t,r,n,i,this.defaults.focusPopUp)}function n(e,t,r,n,i,s){this.create(!0,e,t,r,n,i,s,!1)}(ConsoleAppender=function(){}).prototype=new Appender,ConsoleAppender.prototype.create=function(r,n,i,s,o,a,l,h){var u=this,c=!1,d=!1,f=!1,p=!1,m=[],_=!0,g=t++;s=extractBooleanFromParam(s,this.defaults.initiallyMinimized),i=extractBooleanFromParam(i,this.defaults.lazyInit),o=extractBooleanFromParam(o,this.defaults.useDocumentWrite);var v=this.defaults.newestMessageAtTop,y=this.defaults.scrollToLatestMessage;a=a||this.defaults.width,l=l||this.defaults.height;var b=this.defaults.maxMessages,x=this.defaults.showCommandLine,S=this.defaults.commandLineObjectExpansionDepth,T=this.defaults.showHideButton,E=this.defaults.showCloseButton;this.setLayout(this.defaults.layout);var A,w,C,O,R,D=r?"InPageAppender":"PopUpAppender",I=function(e){return!d||(handleError(D+": configuration option '"+e+"' may not be set after the appender has been initialized"),!1)},M=function(){return f&&_&&!p};this.isNewestMessageAtTop=function(){return v},this.setNewestMessageAtTop=function(e){v=bool(e),M()&&O().setNewestAtTop(v)},this.isScrollToLatestMessage=function(){return y},this.setScrollToLatestMessage=function(e){y=bool(e),M()&&O().setScrollToLatest(y)},this.getWidth=function(){return a},this.setWidth=function(e){I("width")&&(a=extractStringFromParam(e,a))},this.getHeight=function(){return l},this.setHeight=function(e){I("height")&&(l=extractStringFromParam(e,l))},this.getMaxMessages=function(){return b},this.setMaxMessages=function(e){b=extractIntFromParam(e,b),M()&&O().setMaxMessages(b)},this.isShowCommandLine=function(){return x},this.setShowCommandLine=function(e){x=bool(e),M()&&O().setShowCommandLine(x)},this.isShowHideButton=function(){return T},this.setShowHideButton=function(e){T=bool(e),M()&&O().setShowHideButton(T)},this.isShowCloseButton=function(){return E},this.setShowCloseButton=function(e){E=bool(e),M()&&O().setShowCloseButton(E)},this.getCommandLineObjectExpansionDepth=function(){return S},this.setCommandLineObjectExpansionDepth=function(e){S=extractIntFromParam(e,S)};var N=s;function P(e,t){this.loggingEvent=e,this.levelName=e.level.name,this.formattedMessage=t}function k(e,t){this.name=e,this.initiallyExpanded=t}function F(){}this.isInitiallyMinimized=function(){return s},this.setInitiallyMinimized=function(e){I("initiallyMinimized")&&(s=bool(e),N=s)},this.isUseDocumentWrite=function(){return o},this.setUseDocumentWrite=function(e){I("useDocumentWrite")&&(o=bool(e))},P.prototype.append=function(){O().log(this.levelName,this.formattedMessage)},k.prototype.append=function(){O().group(this.name,this.initiallyExpanded)},F.prototype.append=function(){O().groupEnd()};var L=function(){C(),c?p&&te&&w():A(),C()&&B()};this.append=function(e){if(_){var t=u.getLayout().formatWithException(e);m.push(new P(e,t)),L()}},this.group=function(e,t){_&&(m.push(new k(e,t)),L())},this.groupEnd=function(){_&&(m.push(new F),L())};var B=function(){for(;m.length>0;)m.shift().append();h&&O().focus()};this.setAddedToLogger=function(e){this.loggers.push(e),enabled&&!i&&A()},this.clear=function(){M()&&O().clearLog(),m.length=0},this.focus=function(){M()&&O().focus()},this.focusCommandLine=function(){M()&&O().focusCommandLine()},this.focusSearch=function(){M()&&O().focusSearch()};var U=window;this.getCommandWindow=function(){return U},this.setCommandWindow=function(e){U=e},this.executeLastCommand=function(){M()&&O().evalLastCommand()};var G=new PatternLayout("%m");this.getCommandLayout=function(){return G},this.setCommandLayout=function(e){G=e},this.evalCommandAndAppend=function(e){var t={appendResult:!0,isError:!1},r="";try{var n,i;!U.eval&&U.execScript&&U.execScript("null");var s={};for(i=0,len=j.length;i<len;i++)s[j[i][0]]=j[i][1];var o=[],a=function(e){o.push([e,U[e]])};a("appender"),U.appender=u,a("commandReturnValue"),U.commandReturnValue=t,a("commandLineFunctionsHash"),U.commandLineFunctionsHash=s;var l=function(e){a(e),U[e]=function(){return this.commandLineFunctionsHash[e](u,arguments,t)}};for(i=0,len=j.length;i<len;i++)l(j[i][0]);for(U===window&&U.execScript?(a("evalExpr"),a("result"),window.evalExpr=e,U.execScript("window.result=eval(window.evalExpr);"),n=window.result):n=U.eval(e),r=isUndefined(n)?n:formatObjectExpansion(n,S),i=0,len=o.length;i<len;i++)U[o[i][0]]=o[i][1]}catch(e){r="Error evaluating command: "+getExceptionStringRep(e),t.isError=!0}if(t.appendResult){var h=">>> "+e;isUndefined(r)||(h+=newLine+r);var c=t.isError?Level.ERROR:Level.INFO,d=new LoggingEvent(null,new Date,c,[h],null),f=this.getLayout();this.setLayout(G),this.append(d),this.setLayout(f)}};var j=e.concat([]);this.addCommandLineFunction=function(e,t){j.push([e,t])};var V="log4javascriptCommandHistory";this.storeCommandHistory=function(e){setCookie(V,e.join(","))};var z=function(e){var t=['<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">','<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">',"<head>","<title>log4javascript</title>",'<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />',"\x3c!-- Make IE8 behave like IE7, having gone to all the trouble of making IE work --\x3e",'<meta http-equiv="X-UA-Compatible" content="IE=7" />','<script type="text/javascript">var isIe = false, isIePre7 = false;<\/script>','\x3c!--[if IE]><script type="text/javascript">isIe = true<\/script><![endif]--\x3e','\x3c!--[if lt IE 7]><script type="text/javascript">isIePre7 = true<\/script><![endif]--\x3e','<script type="text/javascript">',"//<![CDATA[","var loggingEnabled=true;var logQueuedEventsTimer=null;var logEntries=[];var logEntriesAndSeparators=[];var logItems=[];var renderDelay=100;var unrenderedLogItemsExist=false;var rootGroup,currentGroup=null;var loaded=false;var currentLogItem=null;var logMainContainer;function copyProperties(obj,props){for(var i in props){obj[i]=props[i];}}","function LogItem(){}","LogItem.prototype={mainContainer:null,wrappedContainer:null,unwrappedContainer:null,group:null,appendToLog:function(){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].appendToLog();}","this.group.update();},doRemove:function(doUpdate,removeFromGroup){if(this.rendered){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].remove();}","this.unwrappedElementContainer=null;this.wrappedElementContainer=null;this.mainElementContainer=null;}","if(this.group&&removeFromGroup){this.group.removeChild(this,doUpdate);}","if(this===currentLogItem){currentLogItem=null;}},remove:function(doUpdate,removeFromGroup){this.doRemove(doUpdate,removeFromGroup);},render:function(){},accept:function(visitor){visitor.visit(this);},getUnwrappedDomContainer:function(){return this.group.unwrappedElementContainer.contentDiv;},getWrappedDomContainer:function(){return this.group.wrappedElementContainer.contentDiv;},getMainDomContainer:function(){return this.group.mainElementContainer.contentDiv;}};LogItem.serializedItemKeys={LOG_ENTRY:0,GROUP_START:1,GROUP_END:2};function LogItemContainerElement(){}",'LogItemContainerElement.prototype={appendToLog:function(){var insertBeforeFirst=(newestAtTop&&this.containerDomNode.hasChildNodes());if(insertBeforeFirst){this.containerDomNode.insertBefore(this.mainDiv,this.containerDomNode.firstChild);}else{this.containerDomNode.appendChild(this.mainDiv);}}};function SeparatorElementContainer(containerDomNode){this.containerDomNode=containerDomNode;this.mainDiv=document.createElement("div");this.mainDiv.className="separator";this.mainDiv.innerHTML="&nbsp;";}',"SeparatorElementContainer.prototype=new LogItemContainerElement();SeparatorElementContainer.prototype.remove=function(){this.mainDiv.parentNode.removeChild(this.mainDiv);this.mainDiv=null;};function Separator(){this.rendered=false;}","Separator.prototype=new LogItem();copyProperties(Separator.prototype,{render:function(){var containerDomNode=this.group.contentDiv;if(isIe){this.unwrappedElementContainer=new SeparatorElementContainer(this.getUnwrappedDomContainer());this.wrappedElementContainer=new SeparatorElementContainer(this.getWrappedDomContainer());this.elementContainers=[this.unwrappedElementContainer,this.wrappedElementContainer];}else{this.mainElementContainer=new SeparatorElementContainer(this.getMainDomContainer());this.elementContainers=[this.mainElementContainer];}",'this.content=this.formattedMessage;this.rendered=true;}});function GroupElementContainer(group,containerDomNode,isRoot,isWrapped){this.group=group;this.containerDomNode=containerDomNode;this.isRoot=isRoot;this.isWrapped=isWrapped;this.expandable=false;if(this.isRoot){if(isIe){this.contentDiv=logMainContainer.appendChild(document.createElement("div"));this.contentDiv.id=this.isWrapped?"log_wrapped":"log_unwrapped";}else{this.contentDiv=logMainContainer;}}else{var groupElementContainer=this;this.mainDiv=document.createElement("div");this.mainDiv.className="group";this.headingDiv=this.mainDiv.appendChild(document.createElement("div"));this.headingDiv.className="groupheading";this.expander=this.headingDiv.appendChild(document.createElement("span"));this.expander.className="expander unselectable greyedout";this.expander.unselectable=true;var expanderText=this.group.expanded?"-":"+";this.expanderTextNode=this.expander.appendChild(document.createTextNode(expanderText));this.headingDiv.appendChild(document.createTextNode(" "+this.group.name));this.contentDiv=this.mainDiv.appendChild(document.createElement("div"));var contentCssClass=this.group.expanded?"expanded":"collapsed";this.contentDiv.className="groupcontent "+contentCssClass;this.expander.onclick=function(){if(groupElementContainer.group.expandable){groupElementContainer.group.toggleExpanded();}};}}','GroupElementContainer.prototype=new LogItemContainerElement();copyProperties(GroupElementContainer.prototype,{toggleExpanded:function(){if(!this.isRoot){var oldCssClass,newCssClass,expanderText;if(this.group.expanded){newCssClass="expanded";oldCssClass="collapsed";expanderText="-";}else{newCssClass="collapsed";oldCssClass="expanded";expanderText="+";}',"replaceClass(this.contentDiv,newCssClass,oldCssClass);this.expanderTextNode.nodeValue=expanderText;}},remove:function(){if(!this.isRoot){this.headingDiv=null;this.expander.onclick=null;this.expander=null;this.expanderTextNode=null;this.contentDiv=null;this.containerDomNode=null;this.mainDiv.parentNode.removeChild(this.mainDiv);this.mainDiv=null;}},reverseChildren:function(){var node=null;var childDomNodes=[];while((node=this.contentDiv.firstChild)){this.contentDiv.removeChild(node);childDomNodes.push(node);}",'while((node=childDomNodes.pop())){this.contentDiv.appendChild(node);}},update:function(){if(!this.isRoot){if(this.group.expandable){removeClass(this.expander,"greyedout");}else{addClass(this.expander,"greyedout");}}},clear:function(){if(this.isRoot){this.contentDiv.innerHTML="";}}});function Group(name,isRoot,initiallyExpanded){this.name=name;this.group=null;this.isRoot=isRoot;this.initiallyExpanded=initiallyExpanded;this.elementContainers=[];this.children=[];this.expanded=initiallyExpanded;this.rendered=false;this.expandable=false;}',"Group.prototype=new LogItem();copyProperties(Group.prototype,{addChild:function(logItem){this.children.push(logItem);logItem.group=this;},render:function(){if(isIe){var unwrappedDomContainer,wrappedDomContainer;if(this.isRoot){unwrappedDomContainer=logMainContainer;wrappedDomContainer=logMainContainer;}else{unwrappedDomContainer=this.getUnwrappedDomContainer();wrappedDomContainer=this.getWrappedDomContainer();}","this.unwrappedElementContainer=new GroupElementContainer(this,unwrappedDomContainer,this.isRoot,false);this.wrappedElementContainer=new GroupElementContainer(this,wrappedDomContainer,this.isRoot,true);this.elementContainers=[this.unwrappedElementContainer,this.wrappedElementContainer];}else{var mainDomContainer=this.isRoot?logMainContainer:this.getMainDomContainer();this.mainElementContainer=new GroupElementContainer(this,mainDomContainer,this.isRoot,false);this.elementContainers=[this.mainElementContainer];}","this.rendered=true;},toggleExpanded:function(){this.expanded=!this.expanded;for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].toggleExpanded();}},expand:function(){if(!this.expanded){this.toggleExpanded();}},accept:function(visitor){visitor.visitGroup(this);},reverseChildren:function(){if(this.rendered){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].reverseChildren();}}},update:function(){var previouslyExpandable=this.expandable;this.expandable=(this.children.length!==0);if(this.expandable!==previouslyExpandable){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].update();}}},flatten:function(){var visitor=new GroupFlattener();this.accept(visitor);return visitor.logEntriesAndSeparators;},removeChild:function(child,doUpdate){array_remove(this.children,child);child.group=null;if(doUpdate){this.update();}},remove:function(doUpdate,removeFromGroup){for(var i=0,len=this.children.length;i<len;i++){this.children[i].remove(false,false);}","this.children=[];this.update();if(this===currentGroup){currentGroup=this.group;}","this.doRemove(doUpdate,removeFromGroup);},serialize:function(items){items.push([LogItem.serializedItemKeys.GROUP_START,this.name]);for(var i=0,len=this.children.length;i<len;i++){this.children[i].serialize(items);}","if(this!==currentGroup){items.push([LogItem.serializedItemKeys.GROUP_END]);}},clear:function(){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].clear();}}});function LogEntryElementContainer(){}",'LogEntryElementContainer.prototype=new LogItemContainerElement();copyProperties(LogEntryElementContainer.prototype,{remove:function(){this.doRemove();},doRemove:function(){this.mainDiv.parentNode.removeChild(this.mainDiv);this.mainDiv=null;this.contentElement=null;this.containerDomNode=null;},setContent:function(content,wrappedContent){if(content===this.formattedMessage){this.contentElement.innerHTML="";this.contentElement.appendChild(document.createTextNode(this.formattedMessage));}else{this.contentElement.innerHTML=content;}},setSearchMatch:function(isMatch){var oldCssClass=isMatch?"searchnonmatch":"searchmatch";var newCssClass=isMatch?"searchmatch":"searchnonmatch";replaceClass(this.mainDiv,newCssClass,oldCssClass);},clearSearch:function(){removeClass(this.mainDiv,"searchmatch");removeClass(this.mainDiv,"searchnonmatch");}});function LogEntryWrappedElementContainer(logEntry,containerDomNode){this.logEntry=logEntry;this.containerDomNode=containerDomNode;this.mainDiv=document.createElement("div");this.mainDiv.appendChild(document.createTextNode(this.logEntry.formattedMessage));this.mainDiv.className="logentry wrapped "+this.logEntry.level;this.contentElement=this.mainDiv;}','LogEntryWrappedElementContainer.prototype=new LogEntryElementContainer();LogEntryWrappedElementContainer.prototype.setContent=function(content,wrappedContent){if(content===this.formattedMessage){this.contentElement.innerHTML="";this.contentElement.appendChild(document.createTextNode(this.formattedMessage));}else{this.contentElement.innerHTML=wrappedContent;}};function LogEntryUnwrappedElementContainer(logEntry,containerDomNode){this.logEntry=logEntry;this.containerDomNode=containerDomNode;this.mainDiv=document.createElement("div");this.mainDiv.className="logentry unwrapped "+this.logEntry.level;this.pre=this.mainDiv.appendChild(document.createElement("pre"));this.pre.appendChild(document.createTextNode(this.logEntry.formattedMessage));this.pre.className="unwrapped";this.contentElement=this.pre;}','LogEntryUnwrappedElementContainer.prototype=new LogEntryElementContainer();LogEntryUnwrappedElementContainer.prototype.remove=function(){this.doRemove();this.pre=null;};function LogEntryMainElementContainer(logEntry,containerDomNode){this.logEntry=logEntry;this.containerDomNode=containerDomNode;this.mainDiv=document.createElement("div");this.mainDiv.className="logentry nonielogentry "+this.logEntry.level;this.contentElement=this.mainDiv.appendChild(document.createElement("span"));this.contentElement.appendChild(document.createTextNode(this.logEntry.formattedMessage));}',"LogEntryMainElementContainer.prototype=new LogEntryElementContainer();function LogEntry(level,formattedMessage){this.level=level;this.formattedMessage=formattedMessage;this.rendered=false;}",'LogEntry.prototype=new LogItem();copyProperties(LogEntry.prototype,{render:function(){var logEntry=this;var containerDomNode=this.group.contentDiv;if(isIe){this.formattedMessage=this.formattedMessage.replace(/\\r\\n/g,"\\r");this.unwrappedElementContainer=new LogEntryUnwrappedElementContainer(this,this.getUnwrappedDomContainer());this.wrappedElementContainer=new LogEntryWrappedElementContainer(this,this.getWrappedDomContainer());this.elementContainers=[this.unwrappedElementContainer,this.wrappedElementContainer];}else{this.mainElementContainer=new LogEntryMainElementContainer(this,this.getMainDomContainer());this.elementContainers=[this.mainElementContainer];}','this.content=this.formattedMessage;this.rendered=true;},setContent:function(content,wrappedContent){if(content!=this.content){if(isIe&&(content!==this.formattedMessage)){content=content.replace(/\\r\\n/g,"\\r");}',"for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].setContent(content,wrappedContent);}",'this.content=content;}},getSearchMatches:function(){var matches=[];var i,len;if(isIe){var unwrappedEls=getElementsByClass(this.unwrappedElementContainer.mainDiv,"searchterm","span");var wrappedEls=getElementsByClass(this.wrappedElementContainer.mainDiv,"searchterm","span");for(i=0,len=unwrappedEls.length;i<len;i++){matches[i]=new Match(this.level,null,unwrappedEls[i],wrappedEls[i]);}}else{var els=getElementsByClass(this.mainElementContainer.mainDiv,"searchterm","span");for(i=0,len=els.length;i<len;i++){matches[i]=new Match(this.level,els[i]);}}',"return matches;},setSearchMatch:function(isMatch){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].setSearchMatch(isMatch);}},clearSearch:function(){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].clearSearch();}},accept:function(visitor){visitor.visitLogEntry(this);},serialize:function(items){items.push([LogItem.serializedItemKeys.LOG_ENTRY,this.level,this.formattedMessage]);}});function LogItemVisitor(){}","LogItemVisitor.prototype={visit:function(logItem){},visitParent:function(logItem){if(logItem.group){logItem.group.accept(this);}},visitChildren:function(logItem){for(var i=0,len=logItem.children.length;i<len;i++){logItem.children[i].accept(this);}},visitLogEntry:function(logEntry){this.visit(logEntry);},visitSeparator:function(separator){this.visit(separator);},visitGroup:function(group){this.visit(group);}};function GroupFlattener(){this.logEntriesAndSeparators=[];}",'GroupFlattener.prototype=new LogItemVisitor();GroupFlattener.prototype.visitGroup=function(group){this.visitChildren(group);};GroupFlattener.prototype.visitLogEntry=function(logEntry){this.logEntriesAndSeparators.push(logEntry);};GroupFlattener.prototype.visitSeparator=function(separator){this.logEntriesAndSeparators.push(separator);};window.onload=function(){if(location.search){var queryBits=unescape(location.search).substr(1).split("&"),nameValueBits;for(var i=0,len=queryBits.length;i<len;i++){nameValueBits=queryBits[i].split("=");if(nameValueBits[0]=="log4javascript_domain"){document.domain=nameValueBits[1];break;}}}','logMainContainer=$("log");if(isIePre7){addClass(logMainContainer,"oldIe");}','rootGroup=new Group("root",true);rootGroup.render();currentGroup=rootGroup;setCommandInputWidth();setLogContainerHeight();toggleLoggingEnabled();toggleSearchEnabled();toggleSearchFilter();toggleSearchHighlight();applyFilters();checkAllLevels();toggleWrap();toggleNewestAtTop();toggleScrollToLatest();renderQueuedLogItems();loaded=true;$("command").value="";$("command").autocomplete="off";$("command").onkeydown=function(evt){evt=getEvent(evt);if(evt.keyCode==10||evt.keyCode==13){evalCommandLine();stopPropagation(evt);}else if(evt.keyCode==27){this.value="";this.focus();}else if(evt.keyCode==38&&commandHistory.length>0){currentCommandIndex=Math.max(0,currentCommandIndex-1);this.value=commandHistory[currentCommandIndex];moveCaretToEnd(this);}else if(evt.keyCode==40&&commandHistory.length>0){currentCommandIndex=Math.min(commandHistory.length-1,currentCommandIndex+1);this.value=commandHistory[currentCommandIndex];moveCaretToEnd(this);}};$("command").onkeypress=function(evt){evt=getEvent(evt);if(evt.keyCode==38&&commandHistory.length>0&&evt.preventDefault){evt.preventDefault();}};$("command").onkeyup=function(evt){evt=getEvent(evt);if(evt.keyCode==27&&evt.preventDefault){evt.preventDefault();this.focus();}};document.onkeydown=function keyEventHandler(evt){evt=getEvent(evt);switch(evt.keyCode){case 69:if(evt.shiftKey&&(evt.ctrlKey||evt.metaKey)){evalLastCommand();cancelKeyEvent(evt);return false;}',"break;case 75:if(evt.shiftKey&&(evt.ctrlKey||evt.metaKey)){focusSearch();cancelKeyEvent(evt);return false;}","break;case 40:case 76:if(evt.shiftKey&&(evt.ctrlKey||evt.metaKey)){focusCommandLine();cancelKeyEvent(evt);return false;}","break;}};setTimeout(setLogContainerHeight,20);setShowCommandLine(showCommandLine);doSearch();};window.onunload=function(){if(mainWindowExists()){appender.unload();}",'appender=null;};function toggleLoggingEnabled(){setLoggingEnabled($("enableLogging").checked);}',"function setLoggingEnabled(enable){loggingEnabled=enable;}","var appender=null;function setAppender(appenderParam){appender=appenderParam;}",'function setShowCloseButton(showCloseButton){$("closeButton").style.display=showCloseButton?"inline":"none";}','function setShowHideButton(showHideButton){$("hideButton").style.display=showHideButton?"inline":"none";}',"var newestAtTop=false;function LogItemContentReverser(){}","LogItemContentReverser.prototype=new LogItemVisitor();LogItemContentReverser.prototype.visitGroup=function(group){group.reverseChildren();this.visitChildren(group);};function setNewestAtTop(isNewestAtTop){var oldNewestAtTop=newestAtTop;var i,iLen,j,jLen;newestAtTop=Boolean(isNewestAtTop);if(oldNewestAtTop!=newestAtTop){var visitor=new LogItemContentReverser();rootGroup.accept(visitor);if(currentSearch){var currentMatch=currentSearch.matches[currentMatchIndex];var matchIndex=0;var matches=[];var actOnLogEntry=function(logEntry){var logEntryMatches=logEntry.getSearchMatches();for(j=0,jLen=logEntryMatches.length;j<jLen;j++){matches[matchIndex]=logEntryMatches[j];if(currentMatch&&logEntryMatches[j].equals(currentMatch)){currentMatchIndex=matchIndex;}","matchIndex++;}};if(newestAtTop){for(i=logEntries.length-1;i>=0;i--){actOnLogEntry(logEntries[i]);}}else{for(i=0,iLen=logEntries.length;i<iLen;i++){actOnLogEntry(logEntries[i]);}}","currentSearch.matches=matches;if(currentMatch){currentMatch.setCurrent();}}else if(scrollToLatest){doScrollToLatest();}}",'$("newestAtTop").checked=isNewestAtTop;}','function toggleNewestAtTop(){var isNewestAtTop=$("newestAtTop").checked;setNewestAtTop(isNewestAtTop);}',"var scrollToLatest=true;function setScrollToLatest(isScrollToLatest){scrollToLatest=isScrollToLatest;if(scrollToLatest){doScrollToLatest();}",'$("scrollToLatest").checked=isScrollToLatest;}','function toggleScrollToLatest(){var isScrollToLatest=$("scrollToLatest").checked;setScrollToLatest(isScrollToLatest);}','function doScrollToLatest(){var l=logMainContainer;if(typeof l.scrollTop!="undefined"){if(newestAtTop){l.scrollTop=0;}else{var latestLogEntry=l.lastChild;if(latestLogEntry){l.scrollTop=l.scrollHeight;}}}}',"var closeIfOpenerCloses=true;function setCloseIfOpenerCloses(isCloseIfOpenerCloses){closeIfOpenerCloses=isCloseIfOpenerCloses;}","var maxMessages=null;function setMaxMessages(max){maxMessages=max;pruneLogEntries();}",'var showCommandLine=false;function setShowCommandLine(isShowCommandLine){showCommandLine=isShowCommandLine;if(loaded){$("commandLine").style.display=showCommandLine?"block":"none";setCommandInputWidth();setLogContainerHeight();}}','function focusCommandLine(){if(loaded){$("command").focus();}}','function focusSearch(){if(loaded){$("searchBox").focus();}}',"function getLogItems(){var items=[];for(var i=0,len=logItems.length;i<len;i++){logItems[i].serialize(items);}","return items;}","function setLogItems(items){var loggingReallyEnabled=loggingEnabled;loggingEnabled=true;for(var i=0,len=items.length;i<len;i++){switch(items[i][0]){case LogItem.serializedItemKeys.LOG_ENTRY:log(items[i][1],items[i][2]);break;case LogItem.serializedItemKeys.GROUP_START:group(items[i][1]);break;case LogItem.serializedItemKeys.GROUP_END:groupEnd();break;}}","loggingEnabled=loggingReallyEnabled;}","function log(logLevel,formattedMessage){if(loggingEnabled){var logEntry=new LogEntry(logLevel,formattedMessage);logEntries.push(logEntry);logEntriesAndSeparators.push(logEntry);logItems.push(logEntry);currentGroup.addChild(logEntry);if(loaded){if(logQueuedEventsTimer!==null){clearTimeout(logQueuedEventsTimer);}","logQueuedEventsTimer=setTimeout(renderQueuedLogItems,renderDelay);unrenderedLogItemsExist=true;}}}","function renderQueuedLogItems(){logQueuedEventsTimer=null;var pruned=pruneLogEntries();var initiallyHasMatches=currentSearch?currentSearch.hasMatches():false;for(var i=0,len=logItems.length;i<len;i++){if(!logItems[i].rendered){logItems[i].render();logItems[i].appendToLog();if(currentSearch&&(logItems[i]instanceof LogEntry)){currentSearch.applyTo(logItems[i]);}}}","if(currentSearch){if(pruned){if(currentSearch.hasVisibleMatches()){if(currentMatchIndex===null){setCurrentMatchIndex(0);}","displayMatches();}else{displayNoMatches();}}else if(!initiallyHasMatches&&currentSearch.hasVisibleMatches()){setCurrentMatchIndex(0);displayMatches();}}","if(scrollToLatest){doScrollToLatest();}","unrenderedLogItemsExist=false;}","function pruneLogEntries(){if((maxMessages!==null)&&(logEntriesAndSeparators.length>maxMessages)){var numberToDelete=logEntriesAndSeparators.length-maxMessages;var prunedLogEntries=logEntriesAndSeparators.slice(0,numberToDelete);if(currentSearch){currentSearch.removeMatches(prunedLogEntries);}","var group;for(var i=0;i<numberToDelete;i++){group=logEntriesAndSeparators[i].group;array_remove(logItems,logEntriesAndSeparators[i]);array_remove(logEntries,logEntriesAndSeparators[i]);logEntriesAndSeparators[i].remove(true,true);if(group.children.length===0&&group!==currentGroup&&group!==rootGroup){array_remove(logItems,group);group.remove(true,true);}}","logEntriesAndSeparators=array_removeFromStart(logEntriesAndSeparators,numberToDelete);return true;}","return false;}",'function group(name,startExpanded){if(loggingEnabled){initiallyExpanded=(typeof startExpanded==="undefined")?true:Boolean(startExpanded);var newGroup=new Group(name,false,initiallyExpanded);currentGroup.addChild(newGroup);currentGroup=newGroup;logItems.push(newGroup);if(loaded){if(logQueuedEventsTimer!==null){clearTimeout(logQueuedEventsTimer);}',"logQueuedEventsTimer=setTimeout(renderQueuedLogItems,renderDelay);unrenderedLogItemsExist=true;}}}","function groupEnd(){currentGroup=(currentGroup===rootGroup)?rootGroup:currentGroup.group;}","function mainPageReloaded(){currentGroup=rootGroup;var separator=new Separator();logEntriesAndSeparators.push(separator);logItems.push(separator);currentGroup.addChild(separator);}","function closeWindow(){if(appender&&mainWindowExists()){appender.close(true);}else{window.close();}}","function hide(){if(appender&&mainWindowExists()){appender.hide();}}",'var mainWindow=window;var windowId="log4javascriptConsoleWindow_"+new Date().getTime()+"_"+(""+Math.random()).substr(2);function setMainWindow(win){mainWindow=win;mainWindow[windowId]=window;if(opener&&closeIfOpenerCloses){pollOpener();}}',"function pollOpener(){if(closeIfOpenerCloses){if(mainWindowExists()){setTimeout(pollOpener,500);}else{closeWindow();}}}","function mainWindowExists(){try{return(mainWindow&&!mainWindow.closed&&mainWindow[windowId]==window);}catch(ex){}","return false;}",'var logLevels=["TRACE","DEBUG","INFO","WARN","ERROR","FATAL"];function getCheckBox(logLevel){return $("switch_"+logLevel);}','function getIeWrappedLogContainer(){return $("log_wrapped");}','function getIeUnwrappedLogContainer(){return $("log_unwrapped");}',"function applyFilters(){for(var i=0;i<logLevels.length;i++){if(getCheckBox(logLevels[i]).checked){addClass(logMainContainer,logLevels[i]);}else{removeClass(logMainContainer,logLevels[i]);}}","updateSearchFromFilters();}",'function toggleAllLevels(){var turnOn=$("switch_ALL").checked;for(var i=0;i<logLevels.length;i++){getCheckBox(logLevels[i]).checked=turnOn;if(turnOn){addClass(logMainContainer,logLevels[i]);}else{removeClass(logMainContainer,logLevels[i]);}}}','function checkAllLevels(){for(var i=0;i<logLevels.length;i++){if(!getCheckBox(logLevels[i]).checked){getCheckBox("ALL").checked=false;return;}}','getCheckBox("ALL").checked=true;}',"function clearLog(){rootGroup.clear();currentGroup=rootGroup;logEntries=[];logItems=[];logEntriesAndSeparators=[];doSearch();}",'function toggleWrap(){var enable=$("wrap").checked;if(enable){addClass(logMainContainer,"wrap");}else{removeClass(logMainContainer,"wrap");}',"refreshCurrentMatch();}","var searchTimer=null;function scheduleSearch(){try{clearTimeout(searchTimer);}catch(ex){}","searchTimer=setTimeout(doSearch,500);}","function Search(searchTerm,isRegex,searchRegex,isCaseSensitive){this.searchTerm=searchTerm;this.isRegex=isRegex;this.searchRegex=searchRegex;this.isCaseSensitive=isCaseSensitive;this.matches=[];}","Search.prototype={hasMatches:function(){return this.matches.length>0;},hasVisibleMatches:function(){if(this.hasMatches()){for(var i=0;i<this.matches.length;i++){if(this.matches[i].isVisible()){return true;}}}","return false;},match:function(logEntry){var entryText=String(logEntry.formattedMessage);var matchesSearch=false;if(this.isRegex){matchesSearch=this.searchRegex.test(entryText);}else if(this.isCaseSensitive){matchesSearch=(entryText.indexOf(this.searchTerm)>-1);}else{matchesSearch=(entryText.toLowerCase().indexOf(this.searchTerm.toLowerCase())>-1);}","return matchesSearch;},getNextVisibleMatchIndex:function(){for(var i=currentMatchIndex+1;i<this.matches.length;i++){if(this.matches[i].isVisible()){return i;}}","for(i=0;i<=currentMatchIndex;i++){if(this.matches[i].isVisible()){return i;}}","return-1;},getPreviousVisibleMatchIndex:function(){for(var i=currentMatchIndex-1;i>=0;i--){if(this.matches[i].isVisible()){return i;}}","for(var i=this.matches.length-1;i>=currentMatchIndex;i--){if(this.matches[i].isVisible()){return i;}}",'return-1;},applyTo:function(logEntry){var doesMatch=this.match(logEntry);if(doesMatch){logEntry.group.expand();logEntry.setSearchMatch(true);var logEntryContent;var wrappedLogEntryContent;var searchTermReplacementStartTag="<span class=\\"searchterm\\">";var searchTermReplacementEndTag="<"+"/span>";var preTagName=isIe?"pre":"span";var preStartTag="<"+preTagName+" class=\\"pre\\">";var preEndTag="<"+"/"+preTagName+">";var startIndex=0;var searchIndex,matchedText,textBeforeMatch;if(this.isRegex){var flags=this.isCaseSensitive?"g":"gi";var capturingRegex=new RegExp("("+this.searchRegex.source+")",flags);var rnd=(""+Math.random()).substr(2);var startToken="%%s"+rnd+"%%";var endToken="%%e"+rnd+"%%";logEntryContent=logEntry.formattedMessage.replace(capturingRegex,startToken+"$1"+endToken);logEntryContent=escapeHtml(logEntryContent);var result;var searchString=logEntryContent;logEntryContent="";wrappedLogEntryContent="";while((searchIndex=searchString.indexOf(startToken,startIndex))>-1){var endTokenIndex=searchString.indexOf(endToken,searchIndex);matchedText=searchString.substring(searchIndex+startToken.length,endTokenIndex);textBeforeMatch=searchString.substring(startIndex,searchIndex);logEntryContent+=preStartTag+textBeforeMatch+preEndTag;logEntryContent+=searchTermReplacementStartTag+preStartTag+matchedText+',"preEndTag+searchTermReplacementEndTag;if(isIe){wrappedLogEntryContent+=textBeforeMatch+searchTermReplacementStartTag+","matchedText+searchTermReplacementEndTag;}","startIndex=endTokenIndex+endToken.length;}",'logEntryContent+=preStartTag+searchString.substr(startIndex)+preEndTag;if(isIe){wrappedLogEntryContent+=searchString.substr(startIndex);}}else{logEntryContent="";wrappedLogEntryContent="";var searchTermReplacementLength=searchTermReplacementStartTag.length+',"this.searchTerm.length+searchTermReplacementEndTag.length;var searchTermLength=this.searchTerm.length;var searchTermLowerCase=this.searchTerm.toLowerCase();var logTextLowerCase=logEntry.formattedMessage.toLowerCase();while((searchIndex=logTextLowerCase.indexOf(searchTermLowerCase,startIndex))>-1){matchedText=escapeHtml(logEntry.formattedMessage.substr(searchIndex,this.searchTerm.length));textBeforeMatch=escapeHtml(logEntry.formattedMessage.substring(startIndex,searchIndex));var searchTermReplacement=searchTermReplacementStartTag+","preStartTag+matchedText+preEndTag+searchTermReplacementEndTag;logEntryContent+=preStartTag+textBeforeMatch+preEndTag+searchTermReplacement;if(isIe){wrappedLogEntryContent+=textBeforeMatch+searchTermReplacementStartTag+","matchedText+searchTermReplacementEndTag;}","startIndex=searchIndex+searchTermLength;}","var textAfterLastMatch=escapeHtml(logEntry.formattedMessage.substr(startIndex));logEntryContent+=preStartTag+textAfterLastMatch+preEndTag;if(isIe){wrappedLogEntryContent+=textAfterLastMatch;}}","logEntry.setContent(logEntryContent,wrappedLogEntryContent);var logEntryMatches=logEntry.getSearchMatches();this.matches=this.matches.concat(logEntryMatches);}else{logEntry.setSearchMatch(false);logEntry.setContent(logEntry.formattedMessage,logEntry.formattedMessage);}","return doesMatch;},removeMatches:function(logEntries){var matchesToRemoveCount=0;var currentMatchRemoved=false;var matchesToRemove=[];var i,iLen,j,jLen;for(i=0,iLen=this.matches.length;i<iLen;i++){for(j=0,jLen=logEntries.length;j<jLen;j++){if(this.matches[i].belongsTo(logEntries[j])){matchesToRemove.push(this.matches[i]);if(i===currentMatchIndex){currentMatchRemoved=true;}}}}","var newMatch=currentMatchRemoved?null:this.matches[currentMatchIndex];if(currentMatchRemoved){for(i=currentMatchIndex,iLen=this.matches.length;i<iLen;i++){if(this.matches[i].isVisible()&&!array_contains(matchesToRemove,this.matches[i])){newMatch=this.matches[i];break;}}}","for(i=0,iLen=matchesToRemove.length;i<iLen;i++){array_remove(this.matches,matchesToRemove[i]);matchesToRemove[i].remove();}","if(this.hasVisibleMatches()){if(newMatch===null){setCurrentMatchIndex(0);}else{var newMatchIndex=0;for(i=0,iLen=this.matches.length;i<iLen;i++){if(newMatch===this.matches[i]){newMatchIndex=i;break;}}","setCurrentMatchIndex(newMatchIndex);}}else{currentMatchIndex=null;displayNoMatches();}}};function getPageOffsetTop(el,container){var currentEl=el;var y=0;while(currentEl&&currentEl!=container){y+=currentEl.offsetTop;currentEl=currentEl.offsetParent;}","return y;}",'function scrollIntoView(el){var logContainer=logMainContainer;if(!$("wrap").checked){var logContainerLeft=logContainer.scrollLeft;var logContainerRight=logContainerLeft+logContainer.offsetWidth;var elLeft=el.offsetLeft;var elRight=elLeft+el.offsetWidth;if(elLeft<logContainerLeft||elRight>logContainerRight){logContainer.scrollLeft=elLeft-(logContainer.offsetWidth-el.offsetWidth)/2;}}',"var logContainerTop=logContainer.scrollTop;var logContainerBottom=logContainerTop+logContainer.offsetHeight;var elTop=getPageOffsetTop(el)-getToolBarsHeight();var elBottom=elTop+el.offsetHeight;if(elTop<logContainerTop||elBottom>logContainerBottom){logContainer.scrollTop=elTop-(logContainer.offsetHeight-el.offsetHeight)/2;}}","function Match(logEntryLevel,spanInMainDiv,spanInUnwrappedPre,spanInWrappedDiv){this.logEntryLevel=logEntryLevel;this.spanInMainDiv=spanInMainDiv;if(isIe){this.spanInUnwrappedPre=spanInUnwrappedPre;this.spanInWrappedDiv=spanInWrappedDiv;}","this.mainSpan=isIe?spanInUnwrappedPre:spanInMainDiv;}",'Match.prototype={equals:function(match){return this.mainSpan===match.mainSpan;},setCurrent:function(){if(isIe){addClass(this.spanInUnwrappedPre,"currentmatch");addClass(this.spanInWrappedDiv,"currentmatch");var elementToScroll=$("wrap").checked?this.spanInWrappedDiv:this.spanInUnwrappedPre;scrollIntoView(elementToScroll);}else{addClass(this.spanInMainDiv,"currentmatch");scrollIntoView(this.spanInMainDiv);}},belongsTo:function(logEntry){if(isIe){return isDescendant(this.spanInUnwrappedPre,logEntry.unwrappedPre);}else{return isDescendant(this.spanInMainDiv,logEntry.mainDiv);}},setNotCurrent:function(){if(isIe){removeClass(this.spanInUnwrappedPre,"currentmatch");removeClass(this.spanInWrappedDiv,"currentmatch");}else{removeClass(this.spanInMainDiv,"currentmatch");}},isOrphan:function(){return isOrphan(this.mainSpan);},isVisible:function(){return getCheckBox(this.logEntryLevel).checked;},remove:function(){if(isIe){this.spanInUnwrappedPre=null;this.spanInWrappedDiv=null;}else{this.spanInMainDiv=null;}}};var currentSearch=null;var currentMatchIndex=null;function doSearch(){var searchBox=$("searchBox");var searchTerm=searchBox.value;var isRegex=$("searchRegex").checked;var isCaseSensitive=$("searchCaseSensitive").checked;var i;if(searchTerm===""){$("searchReset").disabled=true;$("searchNav").style.display="none";removeClass(document.body,"searching");removeClass(searchBox,"hasmatches");removeClass(searchBox,"nomatches");for(i=0;i<logEntries.length;i++){logEntries[i].clearSearch();logEntries[i].setContent(logEntries[i].formattedMessage,logEntries[i].formattedMessage);}','currentSearch=null;setLogContainerHeight();}else{$("searchReset").disabled=false;$("searchNav").style.display="block";var searchRegex;var regexValid;if(isRegex){try{searchRegex=isCaseSensitive?new RegExp(searchTerm,"g"):new RegExp(searchTerm,"gi");regexValid=true;replaceClass(searchBox,"validregex","invalidregex");searchBox.title="Valid regex";}catch(ex){regexValid=false;replaceClass(searchBox,"invalidregex","validregex");searchBox.title="Invalid regex: "+(ex.message?ex.message:(ex.description?ex.description:"unknown error"));return;}}else{searchBox.title="";removeClass(searchBox,"validregex");removeClass(searchBox,"invalidregex");}','addClass(document.body,"searching");currentSearch=new Search(searchTerm,isRegex,searchRegex,isCaseSensitive);for(i=0;i<logEntries.length;i++){currentSearch.applyTo(logEntries[i]);}',"setLogContainerHeight();if(currentSearch.hasVisibleMatches()){setCurrentMatchIndex(0);displayMatches();}else{displayNoMatches();}}}","function updateSearchFromFilters(){if(currentSearch){if(currentSearch.hasMatches()){if(currentMatchIndex===null){currentMatchIndex=0;}","var currentMatch=currentSearch.matches[currentMatchIndex];if(currentMatch.isVisible()){displayMatches();setCurrentMatchIndex(currentMatchIndex);}else{currentMatch.setNotCurrent();var nextVisibleMatchIndex=currentSearch.getNextVisibleMatchIndex();if(nextVisibleMatchIndex>-1){setCurrentMatchIndex(nextVisibleMatchIndex);displayMatches();}else{displayNoMatches();}}}else{displayNoMatches();}}}","function refreshCurrentMatch(){if(currentSearch&&currentSearch.hasVisibleMatches()){setCurrentMatchIndex(currentMatchIndex);}}",'function displayMatches(){replaceClass($("searchBox"),"hasmatches","nomatches");$("searchBox").title=""+currentSearch.matches.length+" matches found";$("searchNav").style.display="block";setLogContainerHeight();}','function displayNoMatches(){replaceClass($("searchBox"),"nomatches","hasmatches");$("searchBox").title="No matches found";$("searchNav").style.display="none";setLogContainerHeight();}','function toggleSearchEnabled(enable){enable=(typeof enable=="undefined")?!$("searchDisable").checked:enable;$("searchBox").disabled=!enable;$("searchReset").disabled=!enable;$("searchRegex").disabled=!enable;$("searchNext").disabled=!enable;$("searchPrevious").disabled=!enable;$("searchCaseSensitive").disabled=!enable;$("searchNav").style.display=(enable&&($("searchBox").value!=="")&&currentSearch&&currentSearch.hasVisibleMatches())?"block":"none";if(enable){removeClass($("search"),"greyedout");addClass(document.body,"searching");if($("searchHighlight").checked){addClass(logMainContainer,"searchhighlight");}else{removeClass(logMainContainer,"searchhighlight");}','if($("searchFilter").checked){addClass(logMainContainer,"searchfilter");}else{removeClass(logMainContainer,"searchfilter");}','$("searchDisable").checked=!enable;}else{addClass($("search"),"greyedout");removeClass(document.body,"searching");removeClass(logMainContainer,"searchhighlight");removeClass(logMainContainer,"searchfilter");}',"setLogContainerHeight();}",'function toggleSearchFilter(){var enable=$("searchFilter").checked;if(enable){addClass(logMainContainer,"searchfilter");}else{removeClass(logMainContainer,"searchfilter");}',"refreshCurrentMatch();}",'function toggleSearchHighlight(){var enable=$("searchHighlight").checked;if(enable){addClass(logMainContainer,"searchhighlight");}else{removeClass(logMainContainer,"searchhighlight");}}','function clearSearch(){$("searchBox").value="";doSearch();}','function searchNext(){if(currentSearch!==null&&currentMatchIndex!==null){currentSearch.matches[currentMatchIndex].setNotCurrent();var nextMatchIndex=currentSearch.getNextVisibleMatchIndex();if(nextMatchIndex>currentMatchIndex||confirm("Reached the end of the page. Start from the top?")){setCurrentMatchIndex(nextMatchIndex);}}}','function searchPrevious(){if(currentSearch!==null&&currentMatchIndex!==null){currentSearch.matches[currentMatchIndex].setNotCurrent();var previousMatchIndex=currentSearch.getPreviousVisibleMatchIndex();if(previousMatchIndex<currentMatchIndex||confirm("Reached the start of the page. Continue from the bottom?")){setCurrentMatchIndex(previousMatchIndex);}}}',"function setCurrentMatchIndex(index){currentMatchIndex=index;currentSearch.matches[currentMatchIndex].setCurrent();}",'function addClass(el,cssClass){if(!hasClass(el,cssClass)){if(el.className){el.className+=" "+cssClass;}else{el.className=cssClass;}}}','function hasClass(el,cssClass){if(el.className){var classNames=el.className.split(" ");return array_contains(classNames,cssClass);}',"return false;}",'function removeClass(el,cssClass){if(hasClass(el,cssClass)){var existingClasses=el.className.split(" ");var newClasses=[];for(var i=0,len=existingClasses.length;i<len;i++){if(existingClasses[i]!=cssClass){newClasses[newClasses.length]=existingClasses[i];}}','el.className=newClasses.join(" ");}}',"function replaceClass(el,newCssClass,oldCssClass){removeClass(el,oldCssClass);addClass(el,newCssClass);}","function getElementsByClass(el,cssClass,tagName){var elements=el.getElementsByTagName(tagName);var matches=[];for(var i=0,len=elements.length;i<len;i++){if(hasClass(elements[i],cssClass)){matches.push(elements[i]);}}","return matches;}","function $(id){return document.getElementById(id);}","function isDescendant(node,ancestorNode){while(node!=null){if(node===ancestorNode){return true;}","node=node.parentNode;}","return false;}","function isOrphan(node){var currentNode=node;while(currentNode){if(currentNode==document.body){return false;}","currentNode=currentNode.parentNode;}","return true;}",'function escapeHtml(str){return str.replace(/&/g,"&amp;").replace(/[<]/g,"&lt;").replace(/>/g,"&gt;");}',"function getWindowWidth(){if(window.innerWidth){return window.innerWidth;}else if(document.documentElement&&document.documentElement.clientWidth){return document.documentElement.clientWidth;}else if(document.body){return document.body.clientWidth;}","return 0;}","function getWindowHeight(){if(window.innerHeight){return window.innerHeight;}else if(document.documentElement&&document.documentElement.clientHeight){return document.documentElement.clientHeight;}else if(document.body){return document.body.clientHeight;}","return 0;}",'function getToolBarsHeight(){return $("switches").offsetHeight;}','function getChromeHeight(){var height=getToolBarsHeight();if(showCommandLine){height+=$("commandLine").offsetHeight;}',"return height;}",'function setLogContainerHeight(){if(logMainContainer){var windowHeight=getWindowHeight();$("body").style.height=getWindowHeight()+"px";logMainContainer.style.height=""+','Math.max(0,windowHeight-getChromeHeight())+"px";}}','function setCommandInputWidth(){if(showCommandLine){$("command").style.width=""+Math.max(0,$("commandLineContainer").offsetWidth-','($("evaluateButton").offsetWidth+13))+"px";}}',"window.onresize=function(){setCommandInputWidth();setLogContainerHeight();};if(!Array.prototype.push){Array.prototype.push=function(){for(var i=0,len=arguments.length;i<len;i++){this[this.length]=arguments[i];}","return this.length;};}","if(!Array.prototype.pop){Array.prototype.pop=function(){if(this.length>0){var val=this[this.length-1];this.length=this.length-1;return val;}};}","if(!Array.prototype.shift){Array.prototype.shift=function(){if(this.length>0){var firstItem=this[0];for(var i=0,len=this.length-1;i<len;i++){this[i]=this[i+1];}","this.length=this.length-1;return firstItem;}};}","if(!Array.prototype.splice){Array.prototype.splice=function(startIndex,deleteCount){var itemsAfterDeleted=this.slice(startIndex+deleteCount);var itemsDeleted=this.slice(startIndex,startIndex+deleteCount);this.length=startIndex;var argumentsArray=[];for(var i=0,len=arguments.length;i<len;i++){argumentsArray[i]=arguments[i];}","var itemsToAppend=(argumentsArray.length>2)?itemsAfterDeleted=argumentsArray.slice(2).concat(itemsAfterDeleted):itemsAfterDeleted;for(i=0,len=itemsToAppend.length;i<len;i++){this.push(itemsToAppend[i]);}","return itemsDeleted;};}","function array_remove(arr,val){var index=-1;for(var i=0,len=arr.length;i<len;i++){if(arr[i]===val){index=i;break;}}","if(index>=0){arr.splice(index,1);return index;}else{return false;}}","function array_removeFromStart(array,numberToRemove){if(Array.prototype.splice){array.splice(0,numberToRemove);}else{for(var i=numberToRemove,len=array.length;i<len;i++){array[i-numberToRemove]=array[i];}","array.length=array.length-numberToRemove;}","return array;}","function array_contains(arr,val){for(var i=0,len=arr.length;i<len;i++){if(arr[i]==val){return true;}}","return false;}","function getErrorMessage(ex){if(ex.message){return ex.message;}else if(ex.description){return ex.description;}",'return""+ex;}',"function moveCaretToEnd(input){if(input.setSelectionRange){input.focus();var length=input.value.length;input.setSelectionRange(length,length);}else if(input.createTextRange){var range=input.createTextRange();range.collapse(false);range.select();}","input.focus();}",'function stopPropagation(evt){if(evt.stopPropagation){evt.stopPropagation();}else if(typeof evt.cancelBubble!="undefined"){evt.cancelBubble=true;}}',"function getEvent(evt){return evt?evt:event;}","function getTarget(evt){return evt.target?evt.target:evt.srcElement;}",'function getRelatedTarget(evt){if(evt.relatedTarget){return evt.relatedTarget;}else if(evt.srcElement){switch(evt.type){case"mouseover":return evt.fromElement;case"mouseout":return evt.toElement;default:return evt.srcElement;}}}',"function cancelKeyEvent(evt){evt.returnValue=false;stopPropagation(evt);}",'function evalCommandLine(){var expr=$("command").value;evalCommand(expr);$("command").value="";}',"function evalLastCommand(){if(lastCommand!=null){evalCommand(lastCommand);}}",'var lastCommand=null;var commandHistory=[];var currentCommandIndex=0;function evalCommand(expr){if(appender){appender.evalCommandAndAppend(expr);}else{var prefix=">>> "+expr+"\\r\\n";try{log("INFO",prefix+eval(expr));}catch(ex){log("ERROR",prefix+"Error: "+getErrorMessage(ex));}}',"if(expr!=commandHistory[commandHistory.length-1]){commandHistory.push(expr);if(appender){appender.storeCommandHistory(commandHistory);}}","currentCommandIndex=(expr==commandHistory[currentCommandIndex])?currentCommandIndex+1:commandHistory.length;lastCommand=expr;}","//]]>","<\/script>",'<style type="text/css">',"body{background-color:white;color:black;padding:0;margin:0;font-family:tahoma,verdana,arial,helvetica,sans-serif;overflow:hidden}div#switchesContainer input{margin-bottom:0}div.toolbar{border-top:solid #ffffff 1px;border-bottom:solid #aca899 1px;background-color:#f1efe7;padding:3px 5px;font-size:68.75%}div.toolbar,div#search input{font-family:tahoma,verdana,arial,helvetica,sans-serif}div.toolbar input.button{padding:0 5px;font-size:100%}div.toolbar input.hidden{display:none}div#switches input#clearButton{margin-left:20px}div#levels label{font-weight:bold}div#levels label,div#options label{margin-right:5px}div#levels label#wrapLabel{font-weight:normal}div#search label{margin-right:10px}div#search label.searchboxlabel{margin-right:0}div#search input{font-size:100%}div#search input.validregex{color:green}div#search input.invalidregex{color:red}div#search input.nomatches{color:white;background-color:#ff6666}div#search input.nomatches{color:white;background-color:#ff6666}div#searchNav{display:none}div#commandLine{display:none}div#commandLine input#command{font-size:100%;font-family:Courier New,Courier}div#commandLine input#evaluateButton{}*.greyedout{color:gray !important;border-color:gray !important}*.greyedout *.alwaysenabled{color:black}*.unselectable{-khtml-user-select:none;-moz-user-select:none;user-select:none}div#log{font-family:Courier New,Courier;font-size:75%;width:100%;overflow:auto;clear:both;position:relative}div.group{border-color:#cccccc;border-style:solid;border-width:1px 0 1px 1px;overflow:visible}div.oldIe div.group,div.oldIe div.group *,div.oldIe *.logentry{height:1%}div.group div.groupheading span.expander{border:solid black 1px;font-family:Courier New,Courier;font-size:0.833em;background-color:#eeeeee;position:relative;top:-1px;color:black;padding:0 2px;cursor:pointer;cursor:hand;height:1%}div.group div.groupcontent{margin-left:10px;padding-bottom:2px;overflow:visible}div.group div.expanded{display:block}div.group div.collapsed{display:none}*.logentry{overflow:visible;display:none;white-space:pre}span.pre{white-space:pre}pre.unwrapped{display:inline !important}pre.unwrapped pre.pre,div.wrapped pre.pre{display:inline}div.wrapped pre.pre{white-space:normal}div.wrapped{display:none}body.searching *.logentry span.currentmatch{color:white !important;background-color:green !important}body.searching div.searchhighlight *.logentry span.searchterm{color:black;background-color:yellow}div.wrap *.logentry{white-space:normal !important;border-width:0 0 1px 0;border-color:#dddddd;border-style:dotted}div.wrap #log_wrapped,#log_unwrapped{display:block}div.wrap #log_unwrapped,#log_wrapped{display:none}div.wrap *.logentry span.pre{overflow:visible;white-space:normal}div.wrap *.logentry pre.unwrapped{display:none}div.wrap *.logentry span.wrapped{display:inline}div.searchfilter *.searchnonmatch{display:none !important}div#log *.TRACE,label#label_TRACE{color:#666666}div#log *.DEBUG,label#label_DEBUG{color:green}div#log *.INFO,label#label_INFO{color:#000099}div#log *.WARN,label#label_WARN{color:#999900}div#log *.ERROR,label#label_ERROR{color:red}div#log *.FATAL,label#label_FATAL{color:#660066}div.TRACE#log *.TRACE,div.DEBUG#log *.DEBUG,div.INFO#log *.INFO,div.WARN#log *.WARN,div.ERROR#log *.ERROR,div.FATAL#log *.FATAL{display:block}div#log div.separator{background-color:#cccccc;margin:5px 0;line-height:1px}","</style>","</head>",'<body id="body">','<div id="switchesContainer">','<div id="switches">','<div id="levels" class="toolbar">',"Filters:",'<input type="checkbox" id="switch_TRACE" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide trace messages" /><label for="switch_TRACE" id="label_TRACE">trace</label>','<input type="checkbox" id="switch_DEBUG" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide debug messages" /><label for="switch_DEBUG" id="label_DEBUG">debug</label>','<input type="checkbox" id="switch_INFO" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide info messages" /><label for="switch_INFO" id="label_INFO">info</label>','<input type="checkbox" id="switch_WARN" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide warn messages" /><label for="switch_WARN" id="label_WARN">warn</label>','<input type="checkbox" id="switch_ERROR" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide error messages" /><label for="switch_ERROR" id="label_ERROR">error</label>','<input type="checkbox" id="switch_FATAL" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide fatal messages" /><label for="switch_FATAL" id="label_FATAL">fatal</label>','<input type="checkbox" id="switch_ALL" onclick="toggleAllLevels(); applyFilters()" checked="checked" title="Show/hide all messages" /><label for="switch_ALL" id="label_ALL">all</label>',"</div>",'<div id="search" class="toolbar">','<label for="searchBox" class="searchboxlabel">Search:</label> <input type="text" id="searchBox" onclick="toggleSearchEnabled(true)" onkeyup="scheduleSearch()" size="20" />','<input type="button" id="searchReset" disabled="disabled" value="Reset" onclick="clearSearch()" class="button" title="Reset the search" />','<input type="checkbox" id="searchRegex" onclick="doSearch()" title="If checked, search is treated as a regular expression" /><label for="searchRegex">Regex</label>','<input type="checkbox" id="searchCaseSensitive" onclick="doSearch()" title="If checked, search is case sensitive" /><label for="searchCaseSensitive">Match case</label>','<input type="checkbox" id="searchDisable" onclick="toggleSearchEnabled()" title="Enable/disable search" /><label for="searchDisable" class="alwaysenabled">Disable</label>','<div id="searchNav">','<input type="button" id="searchNext" disabled="disabled" value="Next" onclick="searchNext()" class="button" title="Go to the next matching log entry" />','<input type="button" id="searchPrevious" disabled="disabled" value="Previous" onclick="searchPrevious()" class="button" title="Go to the previous matching log entry" />','<input type="checkbox" id="searchFilter" onclick="toggleSearchFilter()" title="If checked, non-matching log entries are filtered out" /><label for="searchFilter">Filter</label>','<input type="checkbox" id="searchHighlight" onclick="toggleSearchHighlight()" title="Highlight matched search terms" /><label for="searchHighlight" class="alwaysenabled">Highlight all</label>',"</div>","</div>",'<div id="options" class="toolbar">',"Options:",'<input type="checkbox" id="enableLogging" onclick="toggleLoggingEnabled()" checked="checked" title="Enable/disable logging" /><label for="enableLogging" id="enableLoggingLabel">Log</label>','<input type="checkbox" id="wrap" onclick="toggleWrap()" title="Enable / disable word wrap" /><label for="wrap" id="wrapLabel">Wrap</label>','<input type="checkbox" id="newestAtTop" onclick="toggleNewestAtTop()" title="If checked, causes newest messages to appear at the top" /><label for="newestAtTop" id="newestAtTopLabel">Newest at the top</label>','<input type="checkbox" id="scrollToLatest" onclick="toggleScrollToLatest()" checked="checked" title="If checked, window automatically scrolls to a new message when it is added" /><label for="scrollToLatest" id="scrollToLatestLabel">Scroll to latest</label>','<input type="button" id="clearButton" value="Clear" onclick="clearLog()" class="button" title="Clear all log messages"  />','<input type="button" id="hideButton" value="Hide" onclick="hide()" class="hidden button" title="Hide the console" />','<input type="button" id="closeButton" value="Close" onclick="closeWindow()" class="hidden button" title="Close the window" />',"</div>","</div>","</div>",'<div id="log" class="TRACE DEBUG INFO WARN ERROR FATAL"></div>','<div id="commandLine" class="toolbar">','<div id="commandLineContainer">','<input type="text" id="command" title="Enter a JavaScript command here and hit return or press \'Evaluate\'" />','<input type="button" id="evaluateButton" value="Evaluate" class="button" title="Evaluate the command" onclick="evalCommandLine()" />',"</div>","</div>","</body>","</html>",""];e.open();for(var r=0,n=t.length;r<n;r++)e.writeln(t[r]);e.close()};this.setEventTypes(["load","unload"]);var H=function(){var e=O();e.setAppender(u),e.setNewestAtTop(v),e.setScrollToLatest(y),e.setMaxMessages(b),e.setShowCommandLine(x),e.setShowHideButton(T),e.setShowCloseButton(E),e.setMainWindow(window);var t=getCookie(V);t&&(e.commandHistory=t.split(","),e.currentCommandIndex=e.commandHistory.length),u.dispatchEvent("load",{win:e})};this.unload=function(){logLog.debug("unload "+this+", caller: "+this.unload.caller),p||(logLog.debug("really doing unload "+this),p=!0,f=!1,d=!1,u.dispatchEvent("unload",{}))};var X=function(e,t,r,n){var i=setInterval((function(){try{p&&clearInterval(i),e(O())&&(clearInterval(i),r())}catch(e){clearInterval(i),_=!1,handleError(n,e)}}),t)},W=function(){var e=document.domain!=location.hostname;return o?"":getBaseUrl()+"console.html"+(e?"?log4javascript_domain="+escape(document.domain):"")};if(r){var q=null,Y=[];this.addCssProperty=function(e,t){I("cssProperties")&&Y.push([e,t])};var J,K=!1,$=uniqueId+"_InPageAppender_"+g;this.hide=function(){c&&d&&(M()&&O().$("command").blur(),J.style.display="none",N=!0)},this.show=function(){c&&(d?(J.style.display="block",this.setShowCommandLine(x),N=!1):K||w(!0))},this.isVisible=function(){return!N&&!p},this.close=function(e){!p&&(!e||confirm("This will permanently remove the console from the page. No more messages will be logged. Do you wish to continue?"))&&(J.parentNode.removeChild(J),this.unload())},R=function(){var e="InPageAppender.open: unable to create console iframe";function t(){try{s||u.show(),H(),f=!0,B()}catch(t){_=!1,handleError(e,t)}}function r(){try{var r=function(e){return isLoaded(e)};o&&z(O().document),r(O())?t():X(r,100,t,e)}catch(t){_=!1,handleError(e,t)}}N=!1,(J=q.appendChild(document.createElement("div"))).style.width=a,J.style.height=l,J.style.border="solid gray 1px";for(var n=0,i=Y.length;n<i;n++)J.style[Y[n][0]]=Y[n][1];var h=o?"":" src='"+W()+"'";J.innerHTML="<iframe id='"+$+"' name='"+$+"' width='100%' height='100%' frameborder='0'"+h+" scrolling='no'></iframe>",p=!1;var c=function(e){try{return bool(e)&&bool(e.document)}catch(e){return!1}};c(O())?r():X(c,100,r,e),d=!0},w=function(e){if(e||!s){var t=function(){if(n)try{var e=document.getElementById(n);1==e.nodeType&&(q=e),R()}catch(e){handleError("InPageAppender.init: invalid container element '"+n+"' supplied",e)}else(q=document.createElement("div")).style.position="fixed",q.style.left="0",q.style.right="0",q.style.bottom="0",document.body.appendChild(q),u.addCssProperty("borderWidth","1px 0 0 0"),u.addCssProperty("zIndex",1e6),R()};pageLoaded&&n&&n.appendChild?(q=n,R()):pageLoaded?t():log4javascript.addEventListener("load",t),K=!0}},A=function(){w(),c=!0},O=function(){var e=window.frames[$];if(e)return e},C=function(){return!(!_||p)&&(d&&!f&&O()&&isLoaded(O())&&(f=!0),f)}}else{var Q,Z=u.defaults.useOldPopUp,ee=u.defaults.complainAboutPopUpBlocking,te=this.defaults.reopenWhenClosed;this.isUseOldPopUp=function(){return Z},this.setUseOldPopUp=function(e){I("useOldPopUp")&&(Z=bool(e))},this.isComplainAboutPopUpBlocking=function(){return ee},this.setComplainAboutPopUpBlocking=function(e){I("complainAboutPopUpBlocking")&&(ee=bool(e))},this.isFocusPopUp=function(){return h},this.setFocusPopUp=function(e){h=bool(e)},this.isReopenWhenClosed=function(){return te},this.setReopenWhenClosed=function(e){te=bool(e)},this.close=function(){logLog.debug("close "+this);try{Q.close(),this.unload()}catch(e){}},this.hide=function(){logLog.debug("hide "+this),M()&&this.close()},this.show=function(){logLog.debug("show "+this),d||R()},this.isVisible=function(){return C()},R=function(){var e="width="+a+",height="+l+",status,resizable",t="";try{var r=window.frameElement;r&&(t="_"+r.tagName+"_"+(r.name||r.id||""))}catch(e){t="_inaccessibleParentFrame"}var n="PopUp_"+location.host.replace(/[^a-z0-9]/gi,"_")+"_"+g+t;(!Z||!o)&&(n=n+"_"+uniqueId);var i=function(e){if(p)return!0;try{return bool(e)&&e.closed}catch(e){}return!1},s=function(){p||u.unload()};function h(){O().setCloseIfOpenerCloses(!Z||!o),H(),f=!0,B(),X(i,500,s,"PopUpAppender.checkPopUpClosed: error checking pop-up window")}try{Q=window.open(W(),n,e),p=!1,d=!0,Q&&Q.document?o&&Z&&isLoaded(Q)?(Q.mainPageReloaded(),h()):(o&&z(Q.document),isLoaded(Q)?h():X((function(e){return bool(e)&&isLoaded(e)}),100,h,"PopUpAppender.init: unable to create console window")):(_=!1,logLog.warn("PopUpAppender.init: pop-ups blocked, please unblock to use PopUpAppender"),ee&&handleError("log4javascript: pop-up windows appear to be blocked. Please unblock them to use pop-up logging."))}catch(e){handleError("PopUpAppender.init: error creating pop-up",e)}},w=function(){s||R()},A=function(){w(),c=!0},O=function(){return Q},C=function(){if(_&&!isUndefined(Q)&&!p){if(Q.closed||f&&isUndefined(Q.closed))return u.unload(),logLog.debug("PopUpAppender: pop-up closed"),!1;!f&&isLoaded(Q)&&(f=!0)}return _&&f&&!p}}this.getConsoleWindow=O},ConsoleAppender.addGlobalCommandLineFunction=function(t,r){e.push([t,r])},r.prototype=new ConsoleAppender,r.prototype.defaults={layout:new PatternLayout("%d{HH:mm:ss} %-5p - %m{1}%n"),initiallyMinimized:!1,focusPopUp:!1,lazyInit:!0,useOldPopUp:!0,complainAboutPopUpBlocking:!0,newestMessageAtTop:!1,scrollToLatestMessage:!0,width:"600",height:"400",reopenWhenClosed:!1,maxMessages:null,showCommandLine:!0,commandLineObjectExpansionDepth:1,showHideButton:!1,showCloseButton:!0,useDocumentWrite:!0},r.prototype.toString=function(){return"PopUpAppender"},log4javascript.PopUpAppender=r,n.prototype=new ConsoleAppender,n.prototype.defaults={layout:new PatternLayout("%d{HH:mm:ss} %-5p - %m{1}%n"),initiallyMinimized:!1,lazyInit:!0,newestMessageAtTop:!1,scrollToLatestMessage:!0,width:"100%",height:"220px",maxMessages:null,showCommandLine:!0,commandLineObjectExpansionDepth:1,showHideButton:!1,showCloseButton:!1,showLogEntryDeleteButtons:!0,useDocumentWrite:!0},n.prototype.toString=function(){return"InPageAppender"},log4javascript.InPageAppender=n,log4javascript.InlineAppender=n}(),function(){function e(e){var t=0;for(var r in e)t=Math.max(toStr(r).length,t);var n=[];for(r in e){var i,s="  "+padWithSpaces(toStr(r),t+2);try{i=splitIntoLines(toStr(e[r])).join(padWithSpaces(newLine,t+6))}catch(e){i="[Error obtaining property. Details: "+getExceptionMessage(e)+"]"}n.push(s+i)}return n.join(newLine)}var t=["script","pre"],r=["br","img","hr","param","link","area","input","col","base","meta"];function n(e,i,s,o,a){var l,h,u,c,d;function f(e){for(var t=e.style.cssText.split(";"),r="",n=0,i=t.length;n<i;n++){var s=t[n].split(":"),o=[];/^\s*$/.test(s[0])||o.push(trim(s[0]).toLowerCase()+":"+trim(s[1])),r=o.join(";")}return r}if("string"!=typeof s&&(s=""),o=!!o,a=!!a,!(i=void 0===i||!!i)||11==e.nodeType){for(l="",h=0,u=e.childNodes.length;h<u;h++)l+=n(e.childNodes[h],!0,s+"  ");return l}switch(e.nodeType){case 1:var p=e.tagName.toLowerCase();l=o?newLine+s:"",l+="<";var m=(d=e).prefix?d.prefix:d.outerHTML&&new RegExp("<([^:]+):"+d.tagName+"[^>]*>","i").test(d.outerHTML)?RegExp.$1.toLowerCase():"",_=!!m;for(_&&(l+=m+":"),l+=p,h=0,u=e.attributes.length;h<u;h++){var g=e.attributes[h];!g.specified||null===g.nodeValue||"style"===g.nodeName.toLowerCase()||"string"!=typeof g.nodeValue||0===g.nodeName.indexOf("_moz")||(l+=" "+g.nodeName.toLowerCase()+'="',l+=g.nodeValue.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;"),l+='"')}if(e.style.cssText&&""!==f(e)&&(l+=' style="'+f(e)+'"'),array_contains(r,p)||_&&!e.hasChildNodes())l+="/>";else{l+=">";var v=!(1===e.childNodes.length&&3===e.childNodes[0].nodeType),y=array_contains(t,p);for(h=0,u=e.childNodes.length;h<u;h++)l+=n(e.childNodes[h],!0,s+"  ",v,y);var b="</"+p+">";l+=v?newLine+s+b:b}return l;case 3:if(3==(c=e).nodeType&&/^[ \t\r\n]*$/.test(c.nodeValue))l="";else{if(a)l=e.nodeValue;else{var x=splitIntoLines(trim(e.nodeValue)),S=[];for(h=0,u=x.length;h<u;h++)S[h]=trim(x[h]);l=S.join(newLine+s)}o&&(l=newLine+s+l)}return l;case 4:return"<![CDATA["+e.nodeValue+"]]>"+newLine;case 9:for(l="",h=0,u=e.childNodes.length;h<u;h++)l+=n(e.childNodes[h],!0,s);return l;default:return""}}ConsoleAppender.addGlobalCommandLineFunction("$",(function(e,t,r){return document.getElementById(t[0])})),ConsoleAppender.addGlobalCommandLineFunction("dir",(function(t,r,n){for(var i=[],s=0,o=r.length;s<o;s++)i[s]=e(r[s]);return i.join(newLine+newLine)})),ConsoleAppender.addGlobalCommandLineFunction("dirxml",(function(e,t,r){for(var i=[],s=0,o=t.length;s<o;s++)i[s]=n(t[s]);return i.join(newLine+newLine)})),ConsoleAppender.addGlobalCommandLineFunction("cd",(function(e,t,r){var n,i;return 0===t.length||""===t[0]?(n=window,i="Command line set to run in main window"):t[0].window==t[0]?(n=t[0],i="Command line set to run in frame '"+t[0].name+"'"):(n=window.frames[t[0]])?i="Command line set to run in frame '"+t[0]+"'":(r.isError=!0,i="Frame '"+t[0]+"' does not exist",n=e.getCommandWindow()),e.setCommandWindow(n),i})),ConsoleAppender.addGlobalCommandLineFunction("clear",(function(e,t,r){r.appendResult=!1,e.clear()})),ConsoleAppender.addGlobalCommandLineFunction("keys",(function(e,t,r){var n=[];for(var i in t[0])n.push(i);return n})),ConsoleAppender.addGlobalCommandLineFunction("values",(function(e,t,r){var n=[];for(var i in t[0])try{n.push(t[0][i])}catch(e){logLog.warn("values(): Unable to obtain value for key "+i+". Details: "+getExceptionMessage(e))}return n})),ConsoleAppender.addGlobalCommandLineFunction("expansionDepth",(function(e,t,r){var n=parseInt(t[0],10);return isNaN(n)||n<0?(r.isError=!0,t[0]+" is not a valid expansion depth"):(e.setCommandLineObjectExpansionDepth(n),"Object expansion depth set to "+n)}))}(),log4javascript.setDocumentReady=function(){pageLoaded=!0,log4javascript.dispatchEvent("load",{})},window.addEventListener)window.addEventListener("load",log4javascript.setDocumentReady,!1);else if(window.attachEvent)window.attachEvent("onload",log4javascript.setDocumentReady);else{var oldOnload=window.onload;"function"!=typeof window.onload?window.onload=log4javascript.setDocumentReady:window.onload=function(e){oldOnload&&oldOnload(e),log4javascript.setDocumentReady()}}return log4javascript},root=exports,"function"==typeof define&&define.amd?define(factory):void 0!==module&&"object"==typeof exports?module.exports=factory():root.log4javascript=factory()}}),require_cpexcel=__commonJS({"node_modules/xlsx/dist/cpexcel.js"(e,t){var r={version:"1.14.0"};r[437]=function(){for(var e="\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",t=[],r={},n=0;n!=e.length;++n)65533!==e.charCodeAt(n)&&(r[e.charAt(n)]=n),t[n]=e.charAt(n);return{enc:r,dec:t}}(),r[620]=function(){for(var e="\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",t=[],r={},n=0;n!=e.length;++n)65533!==e.charCodeAt(n)&&(r[e.charAt(n)]=n),t[n]=e.charAt(n);return{enc:r,dec:t}}(),r[737]=function(){for(var e="\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",t=[],r={},n=0;n!=e.length;++n)65533!==e.charCodeAt(n)&&(r[e.charAt(n)]=n),t[n]=e.charAt(n);return{enc:r,dec:t}}(),r[850]=function(){for(var e="\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",t=[],r={},n=0;n!=e.length;++n)65533!==e.charCodeAt(n)&&(r[e.charAt(n)]=n),t[n]=e.charAt(n);return{enc:r,dec:t}}(),r[852]=function(){for(var e="\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",t=[],r={},n=0;n!=e.length;++n)65533!==e.charCodeAt(n)&&(r[e.charAt(n)]=n),t[n]=e.charAt(n);return{enc:r,dec:t}}(),r[857]=function(){for(var e="\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",t=[],r={},n=0;n!=e.length;++n)65533!==e.charCodeAt(n)&&(r[e.charAt(n)]=n),t[n]=e.charAt(n);return{enc:r,dec:t}}(),r[861]=function(){for(var e="\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",t=[],r={},n=0;n!=e.length;++n)65533!==e.charCodeAt(n)&&(r[e.charAt(n)]=n),t[n]=e.charAt(n);return{enc:r,dec:t}}(),r[865]=function(){for(var e="\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",t=[],r={},n=0;n!=e.length;++n)65533!==e.charCodeAt(n)&&(r[e.charAt(n)]=n),t[n]=e.charAt(n);return{enc:r,dec:t}}(),r[866]=function(){for(var e="\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",t=[],r={},n=0;n!=e.length;++n)65533!==e.charCodeAt(n)&&(r[e.charAt(n)]=n),t[n]=e.charAt(n);return{enc:r,dec:t}}(),r[874]=function(){for(var e="\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",t=[],r={},n=0;n!=e.length;++n)65533!==e.charCodeAt(n)&&(r[e.charAt(n)]=n),t[n]=e.charAt(n);return{enc:r,dec:t}}(),r[895]=function(){for(var e="\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",t=[],r={},n=0;n!=e.length;++n)65533!==e.charCodeAt(n)&&(r[e.charAt(n)]=n),t[n]=e.charAt(n);return{enc:r,dec:t}}(),r[932]=function(){var e,t=[],r={},n=[];for(n[0]="\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~".split(""),e=0;e!=n[0].length;++e)65533!==n[0][e].charCodeAt(0)&&(r[n[0][e]]=0+e,t[0+e]=n[0][e]);for(n[129]="".split(""),e=0;e!=n[129].length;++e)65533!==n[129][e].charCodeAt(0)&&(r[n[129][e]]=33024+e,t[33024+e]=n[129][e]);for(n[130]="".split(""),e=0;e!=n[130].length;++e)65533!==n[130][e].charCodeAt(0)&&(r[n[130][e]]=33280+e,t[33280+e]=n[130][e]);for(n[131]="".split(""),e=0;e!=n[131].length;++e)65533!==n[131][e].charCodeAt(0)&&(r[n[131][e]]=33536+e,t[33536+e]=n[131][e]);for(n[132]="".split(""),e=0;e!=n[132].length;++e)65533!==n[132][e].charCodeAt(0)&&(r[n[132][e]]=33792+e,t[33792+e]=n[132][e]);for(n[135]="".split(""),e=0;e!=n[135].length;++e)65533!==n[135][e].charCodeAt(0)&&(r[n[135][e]]=34560+e,t[34560+e]=n[135][e]);for(n[136]="".split(""),e=0;e!=n[136].length;++e)65533!==n[136][e].charCodeAt(0)&&(r[n[136][e]]=34816+e,t[34816+e]=n[136][e]);for(n[137]="".split(""),e=0;e!=n[137].length;++e)65533!==n[137][e].charCodeAt(0)&&(r[n[137][e]]=35072+e,t[35072+e]=n[137][e]);for(n[138]="".split(""),e=0;e!=n[138].length;++e)65533!==n[138][e].charCodeAt(0)&&(r[n[138][e]]=35328+e,t[35328+e]=n[138][e]);for(n[139]="".split(""),e=0;e!=n[139].length;++e)65533!==n[139][e].charCodeAt(0)&&(r[n[139][e]]=35584+e,t[35584+e]=n[139][e]);for(n[140]="".split(""),e=0;e!=n[140].length;++e)65533!==n[140][e].charCodeAt(0)&&(r[n[140][e]]=35840+e,t[35840+e]=n[140][e]);for(n[141]="".split(""),e=0;e!=n[141].length;++e)65533!==n[141][e].charCodeAt(0)&&(r[n[141][e]]=36096+e,t[36096+e]=n[141][e]);for(n[142]="".split(""),e=0;e!=n[142].length;++e)65533!==n[142][e].charCodeAt(0)&&(r[n[142][e]]=36352+e,t[36352+e]=n[142][e]);for(n[143]="".split(""),e=0;e!=n[143].length;++e)65533!==n[143][e].charCodeAt(0)&&(r[n[143][e]]=36608+e,t[36608+e]=n[143][e]);for(n[144]="".split(""),e=0;e!=n[144].length;++e)65533!==n[144][e].charCodeAt(0)&&(r[n[144][e]]=36864+e,t[36864+e]=n[144][e]);for(n[145]="".split(""),e=0;e!=n[145].length;++e)65533!==n[145][e].charCodeAt(0)&&(r[n[145][e]]=37120+e,t[37120+e]=n[145][e]);for(n[146]="".split(""),e=0;e!=n[146].length;++e)65533!==n[146][e].charCodeAt(0)&&(r[n[146][e]]=37376+e,t[37376+e]=n[146][e]);for(n[147]="".split(""),e=0;e!=n[147].length;++e)65533!==n[147][e].charCodeAt(0)&&(r[n[147][e]]=37632+e,t[37632+e]=n[147][e]);for(n[148]="".split(""),e=0;e!=n[148].length;++e)65533!==n[148][e].charCodeAt(0)&&(r[n[148][e]]=37888+e,t[37888+e]=n[148][e]);for(n[149]="".split(""),e=0;e!=n[149].length;++e)65533!==n[149][e].charCodeAt(0)&&(r[n[149][e]]=38144+e,t[38144+e]=n[149][e]);for(n[150]="".split(""),e=0;e!=n[150].length;++e)65533!==n[150][e].charCodeAt(0)&&(r[n[150][e]]=38400+e,t[38400+e]=n[150][e]);for(n[151]="".split(""),e=0;e!=n[151].length;++e)65533!==n[151][e].charCodeAt(0)&&(r[n[151][e]]=38656+e,t[38656+e]=n[151][e]);for(n[152]="".split(""),e=0;e!=n[152].length;++e)65533!==n[152][e].charCodeAt(0)&&(r[n[152][e]]=38912+e,t[38912+e]=n[152][e]);for(n[153]="".split(""),e=0;e!=n[153].length;++e)65533!==n[153][e].charCodeAt(0)&&(r[n[153][e]]=39168+e,t[39168+e]=n[153][e]);for(n[154]="".split(""),e=0;e!=n[154].length;++e)65533!==n[154][e].charCodeAt(0)&&(r[n[154][e]]=39424+e,t[39424+e]=n[154][e]);for(n[155]="".split(""),e=0;e!=n[155].length;++e)65533!==n[155][e].charCodeAt(0)&&(r[n[155][e]]=39680+e,t[39680+e]=n[155][e]);for(n[156]="".split(""),e=0;e!=n[156].length;++e)65533!==n[156][e].charCodeAt(0)&&(r[n[156][e]]=39936+e,t[39936+e]=n[156][e]);for(n[157]="".split(""),e=0;e!=n[157].length;++e)65533!==n[157][e].charCodeAt(0)&&(r[n[157][e]]=40192+e,t[40192+e]=n[157][e]);for(n[158]="".split(""),e=0;e!=n[158].length;++e)65533!==n[158][e].charCodeAt(0)&&(r[n[158][e]]=40448+e,t[40448+e]=n[158][e]);for(n[159]="".split(""),e=0;e!=n[159].length;++e)65533!==n[159][e].charCodeAt(0)&&(r[n[159][e]]=40704+e,t[40704+e]=n[159][e]);for(n[224]="".split(""),e=0;e!=n[224].length;++e)65533!==n[224][e].charCodeAt(0)&&(r[n[224][e]]=57344+e,t[57344+e]=n[224][e]);for(n[225]="".split(""),e=0;e!=n[225].length;++e)65533!==n[225][e].charCodeAt(0)&&(r[n[225][e]]=57600+e,t[57600+e]=n[225][e]);for(n[226]="".split(""),e=0;e!=n[226].length;++e)65533!==n[226][e].charCodeAt(0)&&(r[n[226][e]]=57856+e,t[57856+e]=n[226][e]);for(n[227]="".split(""),e=0;e!=n[227].length;++e)65533!==n[227][e].charCodeAt(0)&&(r[n[227][e]]=58112+e,t[58112+e]=n[227][e]);for(n[228]="".split(""),e=0;e!=n[228].length;++e)65533!==n[228][e].charCodeAt(0)&&(r[n[228][e]]=58368+e,t[58368+e]=n[228][e]);for(n[229]="".split(""),e=0;e!=n[229].length;++e)65533!==n[229][e].charCodeAt(0)&&(r[n[229][e]]=58624+e,t[58624+e]=n[229][e]);for(n[230]="".split(""),e=0;e!=n[230].length;++e)65533!==n[230][e].charCodeAt(0)&&(r[n[230][e]]=58880+e,t[58880+e]=n[230][e]);for(n[231]="".split(""),e=0;e!=n[231].length;++e)65533!==n[231][e].charCodeAt(0)&&(r[n[231][e]]=59136+e,t[59136+e]=n[231][e]);for(n[232]="".split(""),e=0;e!=n[232].length;++e)65533!==n[232][e].charCodeAt(0)&&(r[n[232][e]]=59392+e,t[59392+e]=n[232][e]);for(n[233]="".split(""),e=0;e!=n[233].length;++e)65533!==n[233][e].charCodeAt(0)&&(r[n[233][e]]=59648+e,t[59648+e]=n[233][e]);for(n[234]="".split(""),e=0;e!=n[234].length;++e)65533!==n[234][e].charCodeAt(0)&&(r[n[234][e]]=59904+e,t[59904+e]=n[234][e]);for(n[237]="".split(""),e=0;e!=n[237].length;++e)65533!==n[237][e].charCodeAt(0)&&(r[n[237][e]]=60672+e,t[60672+e]=n[237][e]);for(n[238]="".split(""),e=0;e!=n[238].length;++e)65533!==n[238][e].charCodeAt(0)&&(r[n[238][e]]=60928+e,t[60928+e]=n[238][e]);for(n[250]="".split(""),e=0;e!=n[250].length;++e)65533!==n[250][e].charCodeAt(0)&&(r[n[250][e]]=64e3+e,t[64e3+e]=n[250][e]);for(n[251]="".split(""),e=0;e!=n[251].length;++e)65533!==n[251][e].charCodeAt(0)&&(r[n[251][e]]=64256+e,t[64256+e]=n[251][e]);for(n[252]="".split(""),e=0;e!=n[252].length;++e)65533!==n[252][e].charCodeAt(0)&&(r[n[252][e]]=64512+e,t[64512+e]=n[252][e]);return{enc:r,dec:t}}(),r[936]=function(){var e,t=[],r={},n=[];for(n[0]="\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~".split(""),e=0;e!=n[0].length;++e)65533!==n[0][e].charCodeAt(0)&&(r[n[0][e]]=0+e,t[0+e]=n[0][e]);for(n[129]="".split(""),e=0;e!=n[129].length;++e)65533!==n[129][e].charCodeAt(0)&&(r[n[129][e]]=33024+e,t[33024+e]=n[129][e]);for(n[130]="".split(""),e=0;e!=n[130].length;++e)65533!==n[130][e].charCodeAt(0)&&(r[n[130][e]]=33280+e,t[33280+e]=n[130][e]);for(n[131]="".split(""),e=0;e!=n[131].length;++e)65533!==n[131][e].charCodeAt(0)&&(r[n[131][e]]=33536+e,t[33536+e]=n[131][e]);for(n[132]="".split(""),e=0;e!=n[132].length;++e)65533!==n[132][e].charCodeAt(0)&&(r[n[132][e]]=33792+e,t[33792+e]=n[132][e]);for(n[133]="".split(""),e=0;e!=n[133].length;++e)65533!==n[133][e].charCodeAt(0)&&(r[n[133][e]]=34048+e,t[34048+e]=n[133][e]);for(n[134]="".split(""),e=0;e!=n[134].length;++e)65533!==n[134][e].charCodeAt(0)&&(r[n[134][e]]=34304+e,t[34304+e]=n[134][e]);for(n[135]="".split(""),e=0;e!=n[135].length;++e)65533!==n[135][e].charCodeAt(0)&&(r[n[135][e]]=34560+e,t[34560+e]=n[135][e]);for(n[136]="".split(""),e=0;e!=n[136].length;++e)65533!==n[136][e].charCodeAt(0)&&(r[n[136][e]]=34816+e,t[34816+e]=n[136][e]);for(n[137]="".split(""),e=0;e!=n[137].length;++e)65533!==n[137][e].charCodeAt(0)&&(r[n[137][e]]=35072+e,t[35072+e]=n[137][e]);for(n[138]="".split(""),e=0;e!=n[138].length;++e)65533!==n[138][e].charCodeAt(0)&&(r[n[138][e]]=35328+e,t[35328+e]=n[138][e]);for(n[139]="".split(""),e=0;e!=n[139].length;++e)65533!==n[139][e].charCodeAt(0)&&(r[n[139][e]]=35584+e,t[35584+e]=n[139][e]);for(n[140]="".split(""),e=0;e!=n[140].length;++e)65533!==n[140][e].charCodeAt(0)&&(r[n[140][e]]=35840+e,t[35840+e]=n[140][e]);for(n[141]="".split(""),e=0;e!=n[141].length;++e)65533!==n[141][e].charCodeAt(0)&&(r[n[141][e]]=36096+e,t[36096+e]=n[141][e]);for(n[142]="".split(""),e=0;e!=n[142].length;++e)65533!==n[142][e].charCodeAt(0)&&(r[n[142][e]]=36352+e,t[36352+e]=n[142][e]);for(n[143]="".split(""),e=0;e!=n[143].length;++e)65533!==n[143][e].charCodeAt(0)&&(r[n[143][e]]=36608+e,t[36608+e]=n[143][e]);for(n[144]="".split(""),e=0;e!=n[144].length;++e)65533!==n[144][e].charCodeAt(0)&&(r[n[144][e]]=36864+e,t[36864+e]=n[144][e]);for(n[145]="".split(""),e=0;e!=n[145].length;++e)65533!==n[145][e].charCodeAt(0)&&(r[n[145][e]]=37120+e,t[37120+e]=n[145][e]);for(n[146]="".split(""),e=0;e!=n[146].length;++e)65533!==n[146][e].charCodeAt(0)&&(r[n[146][e]]=37376+e,t[37376+e]=n[146][e]);for(n[147]="".split(""),e=0;e!=n[147].length;++e)65533!==n[147][e].charCodeAt(0)&&(r[n[147][e]]=37632+e,t[37632+e]=n[147][e]);for(n[148]="".split(""),e=0;e!=n[148].length;++e)65533!==n[148][e].charCodeAt(0)&&(r[n[148][e]]=37888+e,t[37888+e]=n[148][e]);for(n[149]="".split(""),e=0;e!=n[149].length;++e)65533!==n[149][e].charCodeAt(0)&&(r[n[149][e]]=38144+e,t[38144+e]=n[149][e]);for(n[150]="".split(""),e=0;e!=n[150].length;++e)65533!==n[150][e].charCodeAt(0)&&(r[n[150][e]]=38400+e,t[38400+e]=n[150][e]);for(n[151]="".split(""),e=0;e!=n[151].length;++e)65533!==n[151][e].charCodeAt(0)&&(r[n[151][e]]=38656+e,t[38656+e]=n[151][e]);for(n[152]="".split(""),e=0;e!=n[152].length;++e)65533!==n[152][e].charCodeAt(0)&&(r[n[152][e]]=38912+e,t[38912+e]=n[152][e]);for(n[153]="".split(""),e=0;e!=n[153].length;++e)65533!==n[153][e].charCodeAt(0)&&(r[n[153][e]]=39168+e,t[39168+e]=n[153][e]);for(n[154]="".split(""),e=0;e!=n[154].length;++e)65533!==n[154][e].charCodeAt(0)&&(r[n[154][e]]=39424+e,t[39424+e]=n[154][e]);for(n[155]="".split(""),e=0;e!=n[155].length;++e)65533!==n[155][e].charCodeAt(0)&&(r[n[155][e]]=39680+e,t[39680+e]=n[155][e]);for(n[156]="".split(""),e=0;e!=n[156].length;++e)65533!==n[156][e].charCodeAt(0)&&(r[n[156][e]]=39936+e,t[39936+e]=n[156][e]);for(n[157]="".split(""),e=0;e!=n[157].length;++e)65533!==n[157][e].charCodeAt(0)&&(r[n[157][e]]=40192+e,t[40192+e]=n[157][e]);for(n[158]="".split(""),e=0;e!=n[158].length;++e)65533!==n[158][e].charCodeAt(0)&&(r[n[158][e]]=40448+e,t[40448+e]=n[158][e]);for(n[159]="".split(""),e=0;e!=n[159].length;++e)65533!==n[159][e].charCodeAt(0)&&(r[n[159][e]]=40704+e,t[40704+e]=n[159][e]);for(n[160]="".split(""),e=0;e!=n[160].length;++e)65533!==n[160][e].charCodeAt(0)&&(r[n[160][e]]=40960+e,t[40960+e]=n[160][e]);for(n[161]="".split(""),e=0;e!=n[161].length;++e)65533!==n[161][e].charCodeAt(0)&&(r[n[161][e]]=41216+e,t[41216+e]=n[161][e]);for(n[162]="".split(""),e=0;e!=n[162].length;++e)65533!==n[162][e].charCodeAt(0)&&(r[n[162][e]]=41472+e,t[41472+e]=n[162][e]);for(n[163]="".split(""),e=0;e!=n[163].length;++e)65533!==n[163][e].charCodeAt(0)&&(r[n[163][e]]=41728+e,t[41728+e]=n[163][e]);for(n[164]="".split(""),e=0;e!=n[164].length;++e)65533!==n[164][e].charCodeAt(0)&&(r[n[164][e]]=41984+e,t[41984+e]=n[164][e]);for(n[165]="".split(""),e=0;e!=n[165].length;++e)65533!==n[165][e].charCodeAt(0)&&(r[n[165][e]]=42240+e,t[42240+e]=n[165][e]);for(n[166]="".split(""),e=0;e!=n[166].length;++e)65533!==n[166][e].charCodeAt(0)&&(r[n[166][e]]=42496+e,t[42496+e]=n[166][e]);for(n[167]="".split(""),e=0;e!=n[167].length;++e)65533!==n[167][e].charCodeAt(0)&&(r[n[167][e]]=42752+e,t[42752+e]=n[167][e]);for(n[168]="".split(""),e=0;e!=n[168].length;++e)65533!==n[168][e].charCodeAt(0)&&(r[n[168][e]]=43008+e,t[43008+e]=n[168][e]);for(n[169]="".split(""),e=0;e!=n[169].length;++e)65533!==n[169][e].charCodeAt(0)&&(r[n[169][e]]=43264+e,t[43264+e]=n[169][e]);for(n[170]="".split(""),e=0;e!=n[170].length;++e)65533!==n[170][e].charCodeAt(0)&&(r[n[170][e]]=43520+e,t[43520+e]=n[170][e]);for(n[171]="".split(""),e=0;e!=n[171].length;++e)65533!==n[171][e].charCodeAt(0)&&(r[n[171][e]]=43776+e,t[43776+e]=n[171][e]);for(n[172]="".split(""),e=0;e!=n[172].length;++e)65533!==n[172][e].charCodeAt(0)&&(r[n[172][e]]=44032+e,t[44032+e]=n[172][e]);for(n[173]="".split(""),e=0;e!=n[173].length;++e)65533!==n[173][e].charCodeAt(0)&&(r[n[173][e]]=44288+e,t[44288+e]=n[173][e]);for(n[174]="".split(""),e=0;e!=n[174].length;++e)65533!==n[174][e].charCodeAt(0)&&(r[n[174][e]]=44544+e,t[44544+e]=n[174][e]);for(n[175]="".split(""),e=0;e!=n[175].length;++e)65533!==n[175][e].charCodeAt(0)&&(r[n[175][e]]=44800+e,t[44800+e]=n[175][e]);for(n[176]="".split(""),e=0;e!=n[176].length;++e)65533!==n[176][e].charCodeAt(0)&&(r[n[176][e]]=45056+e,t[45056+e]=n[176][e]);for(n[177]="".split(""),e=0;e!=n[177].length;++e)65533!==n[177][e].charCodeAt(0)&&(r[n[177][e]]=45312+e,t[45312+e]=n[177][e]);for(n[178]="".split(""),e=0;e!=n[178].length;++e)65533!==n[178][e].charCodeAt(0)&&(r[n[178][e]]=45568+e,t[45568+e]=n[178][e]);for(n[179]="".split(""),e=0;e!=n[179].length;++e)65533!==n[179][e].charCodeAt(0)&&(r[n[179][e]]=45824+e,t[45824+e]=n[179][e]);for(n[180]="".split(""),e=0;e!=n[180].length;++e)65533!==n[180][e].charCodeAt(0)&&(r[n[180][e]]=46080+e,t[46080+e]=n[180][e]);for(n[181]="".split(""),e=0;e!=n[181].length;++e)65533!==n[181][e].charCodeAt(0)&&(r[n[181][e]]=46336+e,t[46336+e]=n[181][e]);for(n[182]="".split(""),e=0;e!=n[182].length;++e)65533!==n[182][e].charCodeAt(0)&&(r[n[182][e]]=46592+e,t[46592+e]=n[182][e]);for(n[183]="".split(""),e=0;e!=n[183].length;++e)65533!==n[183][e].charCodeAt(0)&&(r[n[183][e]]=46848+e,t[46848+e]=n[183][e]);for(n[184]="".split(""),e=0;e!=n[184].length;++e)65533!==n[184][e].charCodeAt(0)&&(r[n[184][e]]=47104+e,t[47104+e]=n[184][e]);for(n[185]="".split(""),e=0;e!=n[185].length;++e)65533!==n[185][e].charCodeAt(0)&&(r[n[185][e]]=47360+e,t[47360+e]=n[185][e]);for(n[186]="".split(""),e=0;e!=n[186].length;++e)65533!==n[186][e].charCodeAt(0)&&(r[n[186][e]]=47616+e,t[47616+e]=n[186][e]);for(n[187]="".split(""),e=0;e!=n[187].length;++e)65533!==n[187][e].charCodeAt(0)&&(r[n[187][e]]=47872+e,t[47872+e]=n[187][e]);for(n[188]="".split(""),e=0;e!=n[188].length;++e)65533!==n[188][e].charCodeAt(0)&&(r[n[188][e]]=48128+e,t[48128+e]=n[188][e]);for(n[189]="".split(""),e=0;e!=n[189].length;++e)65533!==n[189][e].charCodeAt(0)&&(r[n[189][e]]=48384+e,t[48384+e]=n[189][e]);for(n[190]="".split(""),e=0;e!=n[190].length;++e)65533!==n[190][e].charCodeAt(0)&&(r[n[190][e]]=48640+e,t[48640+e]=n[190][e]);for(n[191]="".split(""),e=0;e!=n[191].length;++e)65533!==n[191][e].charCodeAt(0)&&(r[n[191][e]]=48896+e,t[48896+e]=n[191][e]);for(n[192]="".split(""),e=0;e!=n[192].length;++e)65533!==n[192][e].charCodeAt(0)&&(r[n[192][e]]=49152+e,t[49152+e]=n[192][e]);for(n[193]="".split(""),e=0;e!=n[193].length;++e)65533!==n[193][e].charCodeAt(0)&&(r[n[193][e]]=49408+e,t[49408+e]=n[193][e]);for(n[194]="".split(""),e=0;e!=n[194].length;++e)65533!==n[194][e].charCodeAt(0)&&(r[n[194][e]]=49664+e,t[49664+e]=n[194][e]);for(n[195]="".split(""),e=0;e!=n[195].length;++e)65533!==n[195][e].charCodeAt(0)&&(r[n[195][e]]=49920+e,t[49920+e]=n[195][e]);for(n[196]="".split(""),e=0;e!=n[196].length;++e)65533!==n[196][e].charCodeAt(0)&&(r[n[196][e]]=50176+e,t[50176+e]=n[196][e]);for(n[197]="".split(""),e=0;e!=n[197].length;++e)65533!==n[197][e].charCodeAt(0)&&(r[n[197][e]]=50432+e,t[50432+e]=n[197][e]);for(n[198]="".split(""),e=0;e!=n[198].length;++e)65533!==n[198][e].charCodeAt(0)&&(r[n[198][e]]=50688+e,t[50688+e]=n[198][e]);for(n[199]="".split(""),e=0;e!=n[199].length;++e)65533!==n[199][e].charCodeAt(0)&&(r[n[199][e]]=50944+e,t[50944+e]=n[199][e]);for(n[200]="".split(""),e=0;e!=n[200].length;++e)65533!==n[200][e].charCodeAt(0)&&(r[n[200][e]]=51200+e,t[51200+e]=n[200][e]);for(n[201]="".split(""),e=0;e!=n[201].length;++e)65533!==n[201][e].charCodeAt(0)&&(r[n[201][e]]=51456+e,t[51456+e]=n[201][e]);for(n[202]="".split(""),e=0;e!=n[202].length;++e)65533!==n[202][e].charCodeAt(0)&&(r[n[202][e]]=51712+e,t[51712+e]=n[202][e]);for(n[203]="".split(""),e=0;e!=n[203].length;++e)65533!==n[203][e].charCodeAt(0)&&(r[n[203][e]]=51968+e,t[51968+e]=n[203][e]);for(n[204]="".split(""),e=0;e!=n[204].length;++e)65533!==n[204][e].charCodeAt(0)&&(r[n[204][e]]=52224+e,t[52224+e]=n[204][e]);for(n[205]="".split(""),e=0;e!=n[205].length;++e)65533!==n[205][e].charCodeAt(0)&&(r[n[205][e]]=52480+e,t[52480+e]=n[205][e]);for(n[206]="".split(""),e=0;e!=n[206].length;++e)65533!==n[206][e].charCodeAt(0)&&(r[n[206][e]]=52736+e,t[52736+e]=n[206][e]);for(n[207]="".split(""),e=0;e!=n[207].length;++e)65533!==n[207][e].charCodeAt(0)&&(r[n[207][e]]=52992+e,t[52992+e]=n[207][e]);for(n[208]="".split(""),e=0;e!=n[208].length;++e)65533!==n[208][e].charCodeAt(0)&&(r[n[208][e]]=53248+e,t[53248+e]=n[208][e]);for(n[209]="".split(""),e=0;e!=n[209].length;++e)65533!==n[209][e].charCodeAt(0)&&(r[n[209][e]]=53504+e,t[53504+e]=n[209][e]);for(n[210]="".split(""),e=0;e!=n[210].length;++e)65533!==n[210][e].charCodeAt(0)&&(r[n[210][e]]=53760+e,t[53760+e]=n[210][e]);for(n[211]="".split(""),e=0;e!=n[211].length;++e)65533!==n[211][e].charCodeAt(0)&&(r[n[211][e]]=54016+e,t[54016+e]=n[211][e]);for(n[212]="".split(""),e=0;e!=n[212].length;++e)65533!==n[212][e].charCodeAt(0)&&(r[n[212][e]]=54272+e,t[54272+e]=n[212][e]);for(n[213]="".split(""),e=0;e!=n[213].length;++e)65533!==n[213][e].charCodeAt(0)&&(r[n[213][e]]=54528+e,t[54528+e]=n[213][e]);for(n[214]="".split(""),e=0;e!=n[214].length;++e)65533!==n[214][e].charCodeAt(0)&&(r[n[214][e]]=54784+e,t[54784+e]=n[214][e]);for(n[215]="".split(""),e=0;e!=n[215].length;++e)65533!==n[215][e].charCodeAt(0)&&(r[n[215][e]]=55040+e,t[55040+e]=n[215][e]);for(n[216]="".split(""),e=0;e!=n[216].length;++e)65533!==n[216][e].charCodeAt(0)&&(r[n[216][e]]=55296+e,t[55296+e]=n[216][e]);for(n[217]="".split(""),e=0;e!=n[217].length;++e)65533!==n[217][e].charCodeAt(0)&&(r[n[217][e]]=55552+e,t[55552+e]=n[217][e]);for(n[218]="".split(""),e=0;e!=n[218].length;++e)65533!==n[218][e].charCodeAt(0)&&(r[n[218][e]]=55808+e,t[55808+e]=n[218][e]);for(n[219]="".split(""),e=0;e!=n[219].length;++e)65533!==n[219][e].charCodeAt(0)&&(r[n[219][e]]=56064+e,t[56064+e]=n[219][e]);for(n[220]="".split(""),e=0;e!=n[220].length;++e)65533!==n[220][e].charCodeAt(0)&&(r[n[220][e]]=56320+e,t[56320+e]=n[220][e]);for(n[221]="".split(""),e=0;e!=n[221].length;++e)65533!==n[221][e].charCodeAt(0)&&(r[n[221][e]]=56576+e,t[56576+e]=n[221][e]);for(n[222]="".split(""),e=0;e!=n[222].length;++e)65533!==n[222][e].charCodeAt(0)&&(r[n[222][e]]=56832+e,t[56832+e]=n[222][e]);for(n[223]="".split(""),e=0;e!=n[223].length;++e)65533!==n[223][e].charCodeAt(0)&&(r[n[223][e]]=57088+e,t[57088+e]=n[223][e]);for(n[224]="".split(""),e=0;e!=n[224].length;++e)65533!==n[224][e].charCodeAt(0)&&(r[n[224][e]]=57344+e,t[57344+e]=n[224][e]);for(n[225]="".split(""),e=0;e!=n[225].length;++e)65533!==n[225][e].charCodeAt(0)&&(r[n[225][e]]=57600+e,t[57600+e]=n[225][e]);for(n[226]="".split(""),e=0;e!=n[226].length;++e)65533!==n[226][e].charCodeAt(0)&&(r[n[226][e]]=57856+e,t[57856+e]=n[226][e]);for(n[227]="".split(""),e=0;e!=n[227].length;++e)65533!==n[227][e].charCodeAt(0)&&(r[n[227][e]]=58112+e,t[58112+e]=n[227][e]);for(n[228]="".split(""),e=0;e!=n[228].length;++e)65533!==n[228][e].charCodeAt(0)&&(r[n[228][e]]=58368+e,t[58368+e]=n[228][e]);for(n[229]="".split(""),e=0;e!=n[229].length;++e)65533!==n[229][e].charCodeAt(0)&&(r[n[229][e]]=58624+e,t[58624+e]=n[229][e]);for(n[230]="".split(""),e=0;e!=n[230].length;++e)65533!==n[230][e].charCodeAt(0)&&(r[n[230][e]]=58880+e,t[58880+e]=n[230][e]);for(n[231]="".split(""),e=0;e!=n[231].length;++e)65533!==n[231][e].charCodeAt(0)&&(r[n[231][e]]=59136+e,t[59136+e]=n[231][e]);for(n[232]="".split(""),e=0;e!=n[232].length;++e)65533!==n[232][e].charCodeAt(0)&&(r[n[232][e]]=59392+e,t[59392+e]=n[232][e]);for(n[233]="".split(""),e=0;e!=n[233].length;++e)65533!==n[233][e].charCodeAt(0)&&(r[n[233][e]]=59648+e,t[59648+e]=n[233][e]);for(n[234]="".split(""),e=0;e!=n[234].length;++e)65533!==n[234][e].charCodeAt(0)&&(r[n[234][e]]=59904+e,t[59904+e]=n[234][e]);for(n[235]="".split(""),e=0;e!=n[235].length;++e)65533!==n[235][e].charCodeAt(0)&&(r[n[235][e]]=60160+e,t[60160+e]=n[235][e]);for(n[236]="".split(""),e=0;e!=n[236].length;++e)65533!==n[236][e].charCodeAt(0)&&(r[n[236][e]]=60416+e,t[60416+e]=n[236][e]);for(n[237]="".split(""),e=0;e!=n[237].length;++e)65533!==n[237][e].charCodeAt(0)&&(r[n[237][e]]=60672+e,t[60672+e]=n[237][e]);for(n[238]="".split(""),e=0;e!=n[238].length;++e)65533!==n[238][e].charCodeAt(0)&&(r[n[238][e]]=60928+e,t[60928+e]=n[238][e]);for(n[239]="".split(""),e=0;e!=n[239].length;++e)65533!==n[239][e].charCodeAt(0)&&(r[n[239][e]]=61184+e,t[61184+e]=n[239][e]);for(n[240]="".split(""),e=0;e!=n[240].length;++e)65533!==n[240][e].charCodeAt(0)&&(r[n[240][e]]=61440+e,t[61440+e]=n[240][e]);for(n[241]="".split(""),e=0;e!=n[241].length;++e)65533!==n[241][e].charCodeAt(0)&&(r[n[241][e]]=61696+e,t[61696+e]=n[241][e]);for(n[242]="".split(""),e=0;e!=n[242].length;++e)65533!==n[242][e].charCodeAt(0)&&(r[n[242][e]]=61952+e,t[61952+e]=n[242][e]);for(n[243]="".split(""),e=0;e!=n[243].length;++e)65533!==n[243][e].charCodeAt(0)&&(r[n[243][e]]=62208+e,t[62208+e]=n[243][e]);for(n[244]="".split(""),e=0;e!=n[244].length;++e)65533!==n[244][e].charCodeAt(0)&&(r[n[244][e]]=62464+e,t[62464+e]=n[244][e]);for(n[245]="".split(""),e=0;e!=n[245].length;++e)65533!==n[245][e].charCodeAt(0)&&(r[n[245][e]]=62720+e,t[62720+e]=n[245][e]);for(n[246]="".split(""),e=0;e!=n[246].length;++e)65533!==n[246][e].charCodeAt(0)&&(r[n[246][e]]=62976+e,t[62976+e]=n[246][e]);for(n[247]="".split(""),e=0;e!=n[247].length;++e)65533!==n[247][e].charCodeAt(0)&&(r[n[247][e]]=63232+e,t[63232+e]=n[247][e]);for(n[248]="".split(""),e=0;e!=n[248].length;++e)65533!==n[248][e].charCodeAt(0)&&(r[n[248][e]]=63488+e,t[63488+e]=n[248][e]);for(n[249]="".split(""),e=0;e!=n[249].length;++e)65533!==n[249][e].charCodeAt(0)&&(r[n[249][e]]=63744+e,t[63744+e]=n[249][e]);for(n[250]="".split(""),e=0;e!=n[250].length;++e)65533!==n[250][e].charCodeAt(0)&&(r[n[250][e]]=64e3+e,t[64e3+e]=n[250][e]);for(n[251]="".split(""),e=0;e!=n[251].length;++e)65533!==n[251][e].charCodeAt(0)&&(r[n[251][e]]=64256+e,t[64256+e]=n[251][e]);for(n[252]="".split(""),e=0;e!=n[252].length;++e)65533!==n[252][e].charCodeAt(0)&&(r[n[252][e]]=64512+e,t[64512+e]=n[252][e]);for(n[253]="".split(""),e=0;e!=n[253].length;++e)65533!==n[253][e].charCodeAt(0)&&(r[n[253][e]]=64768+e,t[64768+e]=n[253][e]);for(n[254]="".split(""),e=0;e!=n[254].length;++e)65533!==n[254][e].charCodeAt(0)&&(r[n[254][e]]=65024+e,t[65024+e]=n[254][e]);return{enc:r,dec:t}}(),r[949]=function(){var e,t=[],r={},n=[];for(n[0]="\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~".split(""),e=0;e!=n[0].length;++e)65533!==n[0][e].charCodeAt(0)&&(r[n[0][e]]=0+e,t[0+e]=n[0][e]);for(n[129]="".split(""),e=0;e!=n[129].length;++e)65533!==n[129][e].charCodeAt(0)&&(r[n[129][e]]=33024+e,t[33024+e]=n[129][e]);for(n[130]="".split(""),e=0;e!=n[130].length;++e)65533!==n[130][e].charCodeAt(0)&&(r[n[130][e]]=33280+e,t[33280+e]=n[130][e]);for(n[131]="".split(""),e=0;e!=n[131].length;++e)65533!==n[131][e].charCodeAt(0)&&(r[n[131][e]]=33536+e,t[33536+e]=n[131][e]);for(n[132]="".split(""),e=0;e!=n[132].length;++e)65533!==n[132][e].charCodeAt(0)&&(r[n[132][e]]=33792+e,t[33792+e]=n[132][e]);for(n[133]="".split(""),e=0;e!=n[133].length;++e)65533!==n[133][e].charCodeAt(0)&&(r[n[133][e]]=34048+e,t[34048+e]=n[133][e]);for(n[134]="".split(""),e=0;e!=n[134].length;++e)65533!==n[134][e].charCodeAt(0)&&(r[n[134][e]]=34304+e,t[34304+e]=n[134][e]);for(n[135]="".split(""),e=0;e!=n[135].length;++e)65533!==n[135][e].charCodeAt(0)&&(r[n[135][e]]=34560+e,t[34560+e]=n[135][e]);for(n[136]="".split(""),e=0;e!=n[136].length;++e)65533!==n[136][e].charCodeAt(0)&&(r[n[136][e]]=34816+e,t[34816+e]=n[136][e]);for(n[137]="".split(""),e=0;e!=n[137].length;++e)65533!==n[137][e].charCodeAt(0)&&(r[n[137][e]]=35072+e,t[35072+e]=n[137][e]);for(n[138]="".split(""),e=0;e!=n[138].length;++e)65533!==n[138][e].charCodeAt(0)&&(r[n[138][e]]=35328+e,t[35328+e]=n[138][e]);for(n[139]="".split(""),e=0;e!=n[139].length;++e)65533!==n[139][e].charCodeAt(0)&&(r[n[139][e]]=35584+e,t[35584+e]=n[139][e]);for(n[140]="".split(""),e=0;e!=n[140].length;++e)65533!==n[140][e].charCodeAt(0)&&(r[n[140][e]]=35840+e,t[35840+e]=n[140][e]);for(n[141]="".split(""),e=0;e!=n[141].length;++e)65533!==n[141][e].charCodeAt(0)&&(r[n[141][e]]=36096+e,t[36096+e]=n[141][e]);for(n[142]="".split(""),e=0;e!=n[142].length;++e)65533!==n[142][e].charCodeAt(0)&&(r[n[142][e]]=36352+e,t[36352+e]=n[142][e]);for(n[143]="".split(""),e=0;e!=n[143].length;++e)65533!==n[143][e].charCodeAt(0)&&(r[n[143][e]]=36608+e,t[36608+e]=n[143][e]);for(n[144]="".split(""),e=0;e!=n[144].length;++e)65533!==n[144][e].charCodeAt(0)&&(r[n[144][e]]=36864+e,t[36864+e]=n[144][e]);for(n[145]="".split(""),e=0;e!=n[145].length;++e)65533!==n[145][e].charCodeAt(0)&&(r[n[145][e]]=37120+e,t[37120+e]=n[145][e]);for(n[146]="".split(""),e=0;e!=n[146].length;++e)65533!==n[146][e].charCodeAt(0)&&(r[n[146][e]]=37376+e,t[37376+e]=n[146][e]);for(n[147]="".split(""),e=0;e!=n[147].length;++e)65533!==n[147][e].charCodeAt(0)&&(r[n[147][e]]=37632+e,t[37632+e]=n[147][e]);for(n[148]="".split(""),e=0;e!=n[148].length;++e)65533!==n[148][e].charCodeAt(0)&&(r[n[148][e]]=37888+e,t[37888+e]=n[148][e]);for(n[149]="".split(""),e=0;e!=n[149].length;++e)65533!==n[149][e].charCodeAt(0)&&(r[n[149][e]]=38144+e,t[38144+e]=n[149][e]);for(n[150]="".split(""),e=0;e!=n[150].length;++e)65533!==n[150][e].charCodeAt(0)&&(r[n[150][e]]=38400+e,t[38400+e]=n[150][e]);for(n[151]="".split(""),e=0;e!=n[151].length;++e)65533!==n[151][e].charCodeAt(0)&&(r[n[151][e]]=38656+e,t[38656+e]=n[151][e]);for(n[152]="".split(""),e=0;e!=n[152].length;++e)65533!==n[152][e].charCodeAt(0)&&(r[n[152][e]]=38912+e,t[38912+e]=n[152][e]);for(n[153]="".split(""),e=0;e!=n[153].length;++e)65533!==n[153][e].charCodeAt(0)&&(r[n[153][e]]=39168+e,t[39168+e]=n[153][e]);for(n[154]="".split(""),e=0;e!=n[154].length;++e)65533!==n[154][e].charCodeAt(0)&&(r[n[154][e]]=39424+e,t[39424+e]=n[154][e]);for(n[155]="".split(""),e=0;e!=n[155].length;++e)65533!==n[155][e].charCodeAt(0)&&(r[n[155][e]]=39680+e,t[39680+e]=n[155][e]);for(n[156]="".split(""),e=0;e!=n[156].length;++e)65533!==n[156][e].charCodeAt(0)&&(r[n[156][e]]=39936+e,t[39936+e]=n[156][e]);for(n[157]="".split(""),e=0;e!=n[157].length;++e)65533!==n[157][e].charCodeAt(0)&&(r[n[157][e]]=40192+e,t[40192+e]=n[157][e]);for(n[158]="".split(""),e=0;e!=n[158].length;++e)65533!==n[158][e].charCodeAt(0)&&(r[n[158][e]]=40448+e,t[40448+e]=n[158][e]);for(n[159]="".split(""),e=0;e!=n[159].length;++e)65533!==n[159][e].charCodeAt(0)&&(r[n[159][e]]=40704+e,t[40704+e]=n[159][e]);for(n[160]="".split(""),e=0;e!=n[160].length;++e)65533!==n[160][e].charCodeAt(0)&&(r[n[160][e]]=40960+e,t[40960+e]=n[160][e]);for(n[161]="".split(""),e=0;e!=n[161].length;++e)65533!==n[161][e].charCodeAt(0)&&(r[n[161][e]]=41216+e,t[41216+e]=n[161][e]);for(n[162]="".split(""),e=0;e!=n[162].length;++e)65533!==n[162][e].charCodeAt(0)&&(r[n[162][e]]=41472+e,t[41472+e]=n[162][e]);for(n[163]="".split(""),e=0;e!=n[163].length;++e)65533!==n[163][e].charCodeAt(0)&&(r[n[163][e]]=41728+e,t[41728+e]=n[163][e]);for(n[164]="".split(""),e=0;e!=n[164].length;++e)65533!==n[164][e].charCodeAt(0)&&(r[n[164][e]]=41984+e,t[41984+e]=n[164][e]);for(n[165]="".split(""),e=0;e!=n[165].length;++e)65533!==n[165][e].charCodeAt(0)&&(r[n[165][e]]=42240+e,t[42240+e]=n[165][e]);for(n[166]="".split(""),e=0;e!=n[166].length;++e)65533!==n[166][e].charCodeAt(0)&&(r[n[166][e]]=42496+e,t[42496+e]=n[166][e]);for(n[167]="".split(""),e=0;e!=n[167].length;++e)65533!==n[167][e].charCodeAt(0)&&(r[n[167][e]]=42752+e,t[42752+e]=n[167][e]);for(n[168]="".split(""),e=0;e!=n[168].length;++e)65533!==n[168][e].charCodeAt(0)&&(r[n[168][e]]=43008+e,t[43008+e]=n[168][e]);for(n[169]="".split(""),e=0;e!=n[169].length;++e)65533!==n[169][e].charCodeAt(0)&&(r[n[169][e]]=43264+e,t[43264+e]=n[169][e]);for(n[170]="".split(""),e=0;e!=n[170].length;++e)65533!==n[170][e].charCodeAt(0)&&(r[n[170][e]]=43520+e,t[43520+e]=n[170][e]);for(n[171]="".split(""),e=0;e!=n[171].length;++e)65533!==n[171][e].charCodeAt(0)&&(r[n[171][e]]=43776+e,t[43776+e]=n[171][e]);for(n[172]="".split(""),e=0;e!=n[172].length;++e)65533!==n[172][e].charCodeAt(0)&&(r[n[172][e]]=44032+e,t[44032+e]=n[172][e]);for(n[173]="".split(""),e=0;e!=n[173].length;++e)65533!==n[173][e].charCodeAt(0)&&(r[n[173][e]]=44288+e,t[44288+e]=n[173][e]);for(n[174]="".split(""),e=0;e!=n[174].length;++e)65533!==n[174][e].charCodeAt(0)&&(r[n[174][e]]=44544+e,t[44544+e]=n[174][e]);for(n[175]="".split(""),e=0;e!=n[175].length;++e)65533!==n[175][e].charCodeAt(0)&&(r[n[175][e]]=44800+e,t[44800+e]=n[175][e]);for(n[176]="".split(""),e=0;e!=n[176].length;++e)65533!==n[176][e].charCodeAt(0)&&(r[n[176][e]]=45056+e,t[45056+e]=n[176][e]);for(n[177]="".split(""),e=0;e!=n[177].length;++e)65533!==n[177][e].charCodeAt(0)&&(r[n[177][e]]=45312+e,t[45312+e]=n[177][e]);for(n[178]="".split(""),e=0;e!=n[178].length;++e)65533!==n[178][e].charCodeAt(0)&&(r[n[178][e]]=45568+e,t[45568+e]=n[178][e]);for(n[179]="".split(""),e=0;e!=n[179].length;++e)65533!==n[179][e].charCodeAt(0)&&(r[n[179][e]]=45824+e,t[45824+e]=n[179][e]);for(n[180]="".split(""),e=0;e!=n[180].length;++e)65533!==n[180][e].charCodeAt(0)&&(r[n[180][e]]=46080+e,t[46080+e]=n[180][e]);for(n[181]="".split(""),e=0;e!=n[181].length;++e)65533!==n[181][e].charCodeAt(0)&&(r[n[181][e]]=46336+e,t[46336+e]=n[181][e]);for(n[182]="".split(""),e=0;e!=n[182].length;++e)65533!==n[182][e].charCodeAt(0)&&(r[n[182][e]]=46592+e,t[46592+e]=n[182][e]);for(n[183]="".split(""),e=0;e!=n[183].length;++e)65533!==n[183][e].charCodeAt(0)&&(r[n[183][e]]=46848+e,t[46848+e]=n[183][e]);for(n[184]="".split(""),e=0;e!=n[184].length;++e)65533!==n[184][e].charCodeAt(0)&&(r[n[184][e]]=47104+e,t[47104+e]=n[184][e]);for(n[185]="".split(""),e=0;e!=n[185].length;++e)65533!==n[185][e].charCodeAt(0)&&(r[n[185][e]]=47360+e,t[47360+e]=n[185][e]);for(n[186]="".split(""),e=0;e!=n[186].length;++e)65533!==n[186][e].charCodeAt(0)&&(r[n[186][e]]=47616+e,t[47616+e]=n[186][e]);for(n[187]="".split(""),e=0;e!=n[187].length;++e)65533!==n[187][e].charCodeAt(0)&&(r[n[187][e]]=47872+e,t[47872+e]=n[187][e]);for(n[188]="".split(""),e=0;e!=n[188].length;++e)65533!==n[188][e].charCodeAt(0)&&(r[n[188][e]]=48128+e,t[48128+e]=n[188][e]);for(n[189]="".split(""),e=0;e!=n[189].length;++e)65533!==n[189][e].charCodeAt(0)&&(r[n[189][e]]=48384+e,t[48384+e]=n[189][e]);for(n[190]="".split(""),e=0;e!=n[190].length;++e)65533!==n[190][e].charCodeAt(0)&&(r[n[190][e]]=48640+e,t[48640+e]=n[190][e]);for(n[191]="".split(""),e=0;e!=n[191].length;++e)65533!==n[191][e].charCodeAt(0)&&(r[n[191][e]]=48896+e,t[48896+e]=n[191][e]);for(n[192]="".split(""),e=0;e!=n[192].length;++e)65533!==n[192][e].charCodeAt(0)&&(r[n[192][e]]=49152+e,t[49152+e]=n[192][e]);for(n[193]="".split(""),e=0;e!=n[193].length;++e)65533!==n[193][e].charCodeAt(0)&&(r[n[193][e]]=49408+e,t[49408+e]=n[193][e]);for(n[194]="".split(""),e=0;e!=n[194].length;++e)65533!==n[194][e].charCodeAt(0)&&(r[n[194][e]]=49664+e,t[49664+e]=n[194][e]);for(n[195]="".split(""),e=0;e!=n[195].length;++e)65533!==n[195][e].charCodeAt(0)&&(r[n[195][e]]=49920+e,t[49920+e]=n[195][e]);for(n[196]="".split(""),e=0;e!=n[196].length;++e)65533!==n[196][e].charCodeAt(0)&&(r[n[196][e]]=50176+e,t[50176+e]=n[196][e]);for(n[197]="".split(""),e=0;e!=n[197].length;++e)65533!==n[197][e].charCodeAt(0)&&(r[n[197][e]]=50432+e,t[50432+e]=n[197][e]);for(n[198]="".split(""),e=0;e!=n[198].length;++e)65533!==n[198][e].charCodeAt(0)&&(r[n[198][e]]=50688+e,t[50688+e]=n[198][e]);for(n[199]="".split(""),e=0;e!=n[199].length;++e)65533!==n[199][e].charCodeAt(0)&&(r[n[199][e]]=50944+e,t[50944+e]=n[199][e]);for(n[200]="".split(""),e=0;e!=n[200].length;++e)65533!==n[200][e].charCodeAt(0)&&(r[n[200][e]]=51200+e,t[51200+e]=n[200][e]);for(n[202]="".split(""),e=0;e!=n[202].length;++e)65533!==n[202][e].charCodeAt(0)&&(r[n[202][e]]=51712+e,t[51712+e]=n[202][e]);for(n[203]="".split(""),e=0;e!=n[203].length;++e)65533!==n[203][e].charCodeAt(0)&&(r[n[203][e]]=51968+e,t[51968+e]=n[203][e]);for(n[204]="".split(""),e=0;e!=n[204].length;++e)65533!==n[204][e].charCodeAt(0)&&(r[n[204][e]]=52224+e,t[52224+e]=n[204][e]);for(n[205]="".split(""),e=0;e!=n[205].length;++e)65533!==n[205][e].charCodeAt(0)&&(r[n[205][e]]=52480+e,t[52480+e]=n[205][e]);for(n[206]="".split(""),e=0;e!=n[206].length;++e)65533!==n[206][e].charCodeAt(0)&&(r[n[206][e]]=52736+e,t[52736+e]=n[206][e]);for(n[207]="".split(""),e=0;e!=n[207].length;++e)65533!==n[207][e].charCodeAt(0)&&(r[n[207][e]]=52992+e,t[52992+e]=n[207][e]);for(n[208]="".split(""),e=0;e!=n[208].length;++e)65533!==n[208][e].charCodeAt(0)&&(r[n[208][e]]=53248+e,t[53248+e]=n[208][e]);for(n[209]="".split(""),e=0;e!=n[209].length;++e)65533!==n[209][e].charCodeAt(0)&&(r[n[209][e]]=53504+e,t[53504+e]=n[209][e]);for(n[210]="".split(""),e=0;e!=n[210].length;++e)65533!==n[210][e].charCodeAt(0)&&(r[n[210][e]]=53760+e,t[53760+e]=n[210][e]);for(n[211]="".split(""),e=0;e!=n[211].length;++e)65533!==n[211][e].charCodeAt(0)&&(r[n[211][e]]=54016+e,t[54016+e]=n[211][e]);for(n[212]="".split(""),e=0;e!=n[212].length;++e)65533!==n[212][e].charCodeAt(0)&&(r[n[212][e]]=54272+e,t[54272+e]=n[212][e]);for(n[213]="".split(""),e=0;e!=n[213].length;++e)65533!==n[213][e].charCodeAt(0)&&(r[n[213][e]]=54528+e,t[54528+e]=n[213][e]);for(n[214]="".split(""),e=0;e!=n[214].length;++e)65533!==n[214][e].charCodeAt(0)&&(r[n[214][e]]=54784+e,t[54784+e]=n[214][e]);for(n[215]="".split(""),e=0;e!=n[215].length;++e)65533!==n[215][e].charCodeAt(0)&&(r[n[215][e]]=55040+e,t[55040+e]=n[215][e]);for(n[216]="".split(""),e=0;e!=n[216].length;++e)65533!==n[216][e].charCodeAt(0)&&(r[n[216][e]]=55296+e,t[55296+e]=n[216][e]);for(n[217]="".split(""),e=0;e!=n[217].length;++e)65533!==n[217][e].charCodeAt(0)&&(r[n[217][e]]=55552+e,t[55552+e]=n[217][e]);for(n[218]="".split(""),e=0;e!=n[218].length;++e)65533!==n[218][e].charCodeAt(0)&&(r[n[218][e]]=55808+e,t[55808+e]=n[218][e]);for(n[219]="".split(""),e=0;e!=n[219].length;++e)65533!==n[219][e].charCodeAt(0)&&(r[n[219][e]]=56064+e,t[56064+e]=n[219][e]);for(n[220]="".split(""),e=0;e!=n[220].length;++e)65533!==n[220][e].charCodeAt(0)&&(r[n[220][e]]=56320+e,t[56320+e]=n[220][e]);for(n[221]="".split(""),e=0;e!=n[221].length;++e)65533!==n[221][e].charCodeAt(0)&&(r[n[221][e]]=56576+e,t[56576+e]=n[221][e]);for(n[222]="".split(""),e=0;e!=n[222].length;++e)65533!==n[222][e].charCodeAt(0)&&(r[n[222][e]]=56832+e,t[56832+e]=n[222][e]);for(n[223]="".split(""),e=0;e!=n[223].length;++e)65533!==n[223][e].charCodeAt(0)&&(r[n[223][e]]=57088+e,t[57088+e]=n[223][e]);for(n[224]="".split(""),e=0;e!=n[224].length;++e)65533!==n[224][e].charCodeAt(0)&&(r[n[224][e]]=57344+e,t[57344+e]=n[224][e]);for(n[225]="".split(""),e=0;e!=n[225].length;++e)65533!==n[225][e].charCodeAt(0)&&(r[n[225][e]]=57600+e,t[57600+e]=n[225][e]);for(n[226]="".split(""),e=0;e!=n[226].length;++e)65533!==n[226][e].charCodeAt(0)&&(r[n[226][e]]=57856+e,t[57856+e]=n[226][e]);for(n[227]="".split(""),e=0;e!=n[227].length;++e)65533!==n[227][e].charCodeAt(0)&&(r[n[227][e]]=58112+e,t[58112+e]=n[227][e]);for(n[228]="".split(""),e=0;e!=n[228].length;++e)65533!==n[228][e].charCodeAt(0)&&(r[n[228][e]]=58368+e,t[58368+e]=n[228][e]);for(n[229]="".split(""),e=0;e!=n[229].length;++e)65533!==n[229][e].charCodeAt(0)&&(r[n[229][e]]=58624+e,t[58624+e]=n[229][e]);for(n[230]="".split(""),e=0;e!=n[230].length;++e)65533!==n[230][e].charCodeAt(0)&&(r[n[230][e]]=58880+e,t[58880+e]=n[230][e]);for(n[231]="".split(""),e=0;e!=n[231].length;++e)65533!==n[231][e].charCodeAt(0)&&(r[n[231][e]]=59136+e,t[59136+e]=n[231][e]);for(n[232]="".split(""),e=0;e!=n[232].length;++e)65533!==n[232][e].charCodeAt(0)&&(r[n[232][e]]=59392+e,t[59392+e]=n[232][e]);for(n[233]="".split(""),e=0;e!=n[233].length;++e)65533!==n[233][e].charCodeAt(0)&&(r[n[233][e]]=59648+e,t[59648+e]=n[233][e]);for(n[234]="".split(""),e=0;e!=n[234].length;++e)65533!==n[234][e].charCodeAt(0)&&(r[n[234][e]]=59904+e,t[59904+e]=n[234][e]);for(n[235]="".split(""),e=0;e!=n[235].length;++e)65533!==n[235][e].charCodeAt(0)&&(r[n[235][e]]=60160+e,t[60160+e]=n[235][e]);for(n[236]="".split(""),e=0;e!=n[236].length;++e)65533!==n[236][e].charCodeAt(0)&&(r[n[236][e]]=60416+e,t[60416+e]=n[236][e]);for(n[237]="".split(""),e=0;e!=n[237].length;++e)65533!==n[237][e].charCodeAt(0)&&(r[n[237][e]]=60672+e,t[60672+e]=n[237][e]);for(n[238]="".split(""),e=0;e!=n[238].length;++e)65533!==n[238][e].charCodeAt(0)&&(r[n[238][e]]=60928+e,t[60928+e]=n[238][e]);for(n[239]="".split(""),e=0;e!=n[239].length;++e)65533!==n[239][e].charCodeAt(0)&&(r[n[239][e]]=61184+e,t[61184+e]=n[239][e]);for(n[240]="".split(""),e=0;e!=n[240].length;++e)65533!==n[240][e].charCodeAt(0)&&(r[n[240][e]]=61440+e,t[61440+e]=n[240][e]);for(n[241]="".split(""),e=0;e!=n[241].length;++e)65533!==n[241][e].charCodeAt(0)&&(r[n[241][e]]=61696+e,t[61696+e]=n[241][e]);for(n[242]="".split(""),e=0;e!=n[242].length;++e)65533!==n[242][e].charCodeAt(0)&&(r[n[242][e]]=61952+e,t[61952+e]=n[242][e]);for(n[243]="".split(""),e=0;e!=n[243].length;++e)65533!==n[243][e].charCodeAt(0)&&(r[n[243][e]]=62208+e,t[62208+e]=n[243][e]);for(n[244]="".split(""),e=0;e!=n[244].length;++e)65533!==n[244][e].charCodeAt(0)&&(r[n[244][e]]=62464+e,t[62464+e]=n[244][e]);for(n[245]="".split(""),e=0;e!=n[245].length;++e)65533!==n[245][e].charCodeAt(0)&&(r[n[245][e]]=62720+e,t[62720+e]=n[245][e]);for(n[246]="".split(""),e=0;e!=n[246].length;++e)65533!==n[246][e].charCodeAt(0)&&(r[n[246][e]]=62976+e,t[62976+e]=n[246][e]);for(n[247]="".split(""),e=0;e!=n[247].length;++e)65533!==n[247][e].charCodeAt(0)&&(r[n[247][e]]=63232+e,t[63232+e]=n[247][e]);for(n[248]="".split(""),e=0;e!=n[248].length;++e)65533!==n[248][e].charCodeAt(0)&&(r[n[248][e]]=63488+e,t[63488+e]=n[248][e]);for(n[249]="".split(""),e=0;e!=n[249].length;++e)65533!==n[249][e].charCodeAt(0)&&(r[n[249][e]]=63744+e,t[63744+e]=n[249][e]);for(n[250]="".split(""),e=0;e!=n[250].length;++e)65533!==n[250][e].charCodeAt(0)&&(r[n[250][e]]=64e3+e,t[64e3+e]=n[250][e]);for(n[251]="".split(""),e=0;e!=n[251].length;++e)65533!==n[251][e].charCodeAt(0)&&(r[n[251][e]]=64256+e,t[64256+e]=n[251][e]);for(n[252]="".split(""),e=0;e!=n[252].length;++e)65533!==n[252][e].charCodeAt(0)&&(r[n[252][e]]=64512+e,t[64512+e]=n[252][e]);for(n[253]="".split(""),e=0;e!=n[253].length;++e)65533!==n[253][e].charCodeAt(0)&&(r[n[253][e]]=64768+e,t[64768+e]=n[253][e]);return{enc:r,dec:t}}(),r[950]=function(){var e,t=[],r={},n=[];for(n[0]="\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~".split(""),e=0;e!=n[0].length;++e)65533!==n[0][e].charCodeAt(0)&&(r[n[0][e]]=0+e,t[0+e]=n[0][e]);for(n[161]="".split(""),e=0;e!=n[161].length;++e)65533!==n[161][e].charCodeAt(0)&&(r[n[161][e]]=41216+e,t[41216+e]=n[161][e]);for(n[162]="".split(""),e=0;e!=n[162].length;++e)65533!==n[162][e].charCodeAt(0)&&(r[n[162][e]]=41472+e,t[41472+e]=n[162][e]);for(n[163]="".split(""),e=0;e!=n[163].length;++e)65533!==n[163][e].charCodeAt(0)&&(r[n[163][e]]=41728+e,t[41728+e]=n[163][e]);for(n[164]="".split(""),e=0;e!=n[164].length;++e)65533!==n[164][e].charCodeAt(0)&&(r[n[164][e]]=41984+e,t[41984+e]=n[164][e]);for(n[165]="".split(""),e=0;e!=n[165].length;++e)65533!==n[165][e].charCodeAt(0)&&(r[n[165][e]]=42240+e,t[42240+e]=n[165][e]);for(n[166]="".split(""),e=0;e!=n[166].length;++e)65533!==n[166][e].charCodeAt(0)&&(r[n[166][e]]=42496+e,t[42496+e]=n[166][e]);for(n[167]="".split(""),e=0;e!=n[167].length;++e)65533!==n[167][e].charCodeAt(0)&&(r[n[167][e]]=42752+e,t[42752+e]=n[167][e]);for(n[168]="".split(""),e=0;e!=n[168].length;++e)65533!==n[168][e].charCodeAt(0)&&(r[n[168][e]]=43008+e,t[43008+e]=n[168][e]);for(n[169]="".split(""),e=0;e!=n[169].length;++e)65533!==n[169][e].charCodeAt(0)&&(r[n[169][e]]=43264+e,t[43264+e]=n[169][e]);for(n[170]="".split(""),e=0;e!=n[170].length;++e)65533!==n[170][e].charCodeAt(0)&&(r[n[170][e]]=43520+e,t[43520+e]=n[170][e]);for(n[171]="".split(""),e=0;e!=n[171].length;++e)65533!==n[171][e].charCodeAt(0)&&(r[n[171][e]]=43776+e,t[43776+e]=n[171][e]);for(n[172]="".split(""),e=0;e!=n[172].length;++e)65533!==n[172][e].charCodeAt(0)&&(r[n[172][e]]=44032+e,t[44032+e]=n[172][e]);for(n[173]="".split(""),e=0;e!=n[173].length;++e)65533!==n[173][e].charCodeAt(0)&&(r[n[173][e]]=44288+e,t[44288+e]=n[173][e]);for(n[174]="".split(""),e=0;e!=n[174].length;++e)65533!==n[174][e].charCodeAt(0)&&(r[n[174][e]]=44544+e,t[44544+e]=n[174][e]);for(n[175]="".split(""),e=0;e!=n[175].length;++e)65533!==n[175][e].charCodeAt(0)&&(r[n[175][e]]=44800+e,t[44800+e]=n[175][e]);for(n[176]="".split(""),e=0;e!=n[176].length;++e)65533!==n[176][e].charCodeAt(0)&&(r[n[176][e]]=45056+e,t[45056+e]=n[176][e]);for(n[177]="".split(""),e=0;e!=n[177].length;++e)65533!==n[177][e].charCodeAt(0)&&(r[n[177][e]]=45312+e,t[45312+e]=n[177][e]);for(n[178]="".split(""),e=0;e!=n[178].length;++e)65533!==n[178][e].charCodeAt(0)&&(r[n[178][e]]=45568+e,t[45568+e]=n[178][e]);for(n[179]="".split(""),e=0;e!=n[179].length;++e)65533!==n[179][e].charCodeAt(0)&&(r[n[179][e]]=45824+e,t[45824+e]=n[179][e]);for(n[180]="".split(""),e=0;e!=n[180].length;++e)65533!==n[180][e].charCodeAt(0)&&(r[n[180][e]]=46080+e,t[46080+e]=n[180][e]);for(n[181]="".split(""),e=0;e!=n[181].length;++e)65533!==n[181][e].charCodeAt(0)&&(r[n[181][e]]=46336+e,t[46336+e]=n[181][e]);for(n[182]="".split(""),e=0;e!=n[182].length;++e)65533!==n[182][e].charCodeAt(0)&&(r[n[182][e]]=46592+e,t[46592+e]=n[182][e]);for(n[183]="".split(""),e=0;e!=n[183].length;++e)65533!==n[183][e].charCodeAt(0)&&(r[n[183][e]]=46848+e,t[46848+e]=n[183][e]);for(n[184]="".split(""),e=0;e!=n[184].length;++e)65533!==n[184][e].charCodeAt(0)&&(r[n[184][e]]=47104+e,t[47104+e]=n[184][e]);for(n[185]="".split(""),e=0;e!=n[185].length;++e)65533!==n[185][e].charCodeAt(0)&&(r[n[185][e]]=47360+e,t[47360+e]=n[185][e]);for(n[186]="".split(""),e=0;e!=n[186].length;++e)65533!==n[186][e].charCodeAt(0)&&(r[n[186][e]]=47616+e,t[47616+e]=n[186][e]);for(n[187]="".split(""),e=0;e!=n[187].length;++e)65533!==n[187][e].charCodeAt(0)&&(r[n[187][e]]=47872+e,t[47872+e]=n[187][e]);for(n[188]="".split(""),e=0;e!=n[188].length;++e)65533!==n[188][e].charCodeAt(0)&&(r[n[188][e]]=48128+e,t[48128+e]=n[188][e]);for(n[189]="".split(""),e=0;e!=n[189].length;++e)65533!==n[189][e].charCodeAt(0)&&(r[n[189][e]]=48384+e,t[48384+e]=n[189][e]);for(n[190]="".split(""),e=0;e!=n[190].length;++e)65533!==n[190][e].charCodeAt(0)&&(r[n[190][e]]=48640+e,t[48640+e]=n[190][e]);for(n[191]="".split(""),e=0;e!=n[191].length;++e)65533!==n[191][e].charCodeAt(0)&&(r[n[191][e]]=48896+e,t[48896+e]=n[191][e]);for(n[192]="".split(""),e=0;e!=n[192].length;++e)65533!==n[192][e].charCodeAt(0)&&(r[n[192][e]]=49152+e,t[49152+e]=n[192][e]);for(n[193]="".split(""),e=0;e!=n[193].length;++e)65533!==n[193][e].charCodeAt(0)&&(r[n[193][e]]=49408+e,t[49408+e]=n[193][e]);for(n[194]="".split(""),e=0;e!=n[194].length;++e)65533!==n[194][e].charCodeAt(0)&&(r[n[194][e]]=49664+e,t[49664+e]=n[194][e]);for(n[195]="".split(""),e=0;e!=n[195].length;++e)65533!==n[195][e].charCodeAt(0)&&(r[n[195][e]]=49920+e,t[49920+e]=n[195][e]);for(n[196]="".split(""),e=0;e!=n[196].length;++e)65533!==n[196][e].charCodeAt(0)&&(r[n[196][e]]=50176+e,t[50176+e]=n[196][e]);for(n[197]="".split(""),e=0;e!=n[197].length;++e)65533!==n[197][e].charCodeAt(0)&&(r[n[197][e]]=50432+e,t[50432+e]=n[197][e]);for(n[198]="".split(""),e=0;e!=n[198].length;++e)65533!==n[198][e].charCodeAt(0)&&(r[n[198][e]]=50688+e,t[50688+e]=n[198][e]);for(n[201]="".split(""),e=0;e!=n[201].length;++e)65533!==n[201][e].charCodeAt(0)&&(r[n[201][e]]=51456+e,t[51456+e]=n[201][e]);for(n[202]="".split(""),e=0;e!=n[202].length;++e)65533!==n[202][e].charCodeAt(0)&&(r[n[202][e]]=51712+e,t[51712+e]=n[202][e]);for(n[203]="".split(""),e=0;e!=n[203].length;++e)65533!==n[203][e].charCodeAt(0)&&(r[n[203][e]]=51968+e,t[51968+e]=n[203][e]);for(n[204]="".split(""),e=0;e!=n[204].length;++e)65533!==n[204][e].charCodeAt(0)&&(r[n[204][e]]=52224+e,t[52224+e]=n[204][e]);for(n[205]="".split(""),e=0;e!=n[205].length;++e)65533!==n[205][e].charCodeAt(0)&&(r[n[205][e]]=52480+e,t[52480+e]=n[205][e]);for(n[206]="".split(""),e=0;e!=n[206].length;++e)65533!==n[206][e].charCodeAt(0)&&(r[n[206][e]]=52736+e,t[52736+e]=n[206][e]);for(n[207]="".split(""),e=0;e!=n[207].length;++e)65533!==n[207][e].charCodeAt(0)&&(r[n[207][e]]=52992+e,t[52992+e]=n[207][e]);for(n[208]="".split(""),e=0;e!=n[208].length;++e)65533!==n[208][e].charCodeAt(0)&&(r[n[208][e]]=53248+e,t[53248+e]=n[208][e]);for(n[209]="".split(""),e=0;e!=n[209].length;++e)65533!==n[209][e].charCodeAt(0)&&(r[n[209][e]]=53504+e,t[53504+e]=n[209][e]);for(n[210]="".split(""),e=0;e!=n[210].length;++e)65533!==n[210][e].charCodeAt(0)&&(r[n[210][e]]=53760+e,t[53760+e]=n[210][e]);for(n[211]="".split(""),e=0;e!=n[211].length;++e)65533!==n[211][e].charCodeAt(0)&&(r[n[211][e]]=54016+e,t[54016+e]=n[211][e]);for(n[212]="".split(""),e=0;e!=n[212].length;++e)65533!==n[212][e].charCodeAt(0)&&(r[n[212][e]]=54272+e,t[54272+e]=n[212][e]);for(n[213]="".split(""),e=0;e!=n[213].length;++e)65533!==n[213][e].charCodeAt(0)&&(r[n[213][e]]=54528+e,t[54528+e]=n[213][e]);for(n[214]="".split(""),e=0;e!=n[214].length;++e)65533!==n[214][e].charCodeAt(0)&&(r[n[214][e]]=54784+e,t[54784+e]=n[214][e]);for(n[215]="".split(""),e=0;e!=n[215].length;++e)65533!==n[215][e].charCodeAt(0)&&(r[n[215][e]]=55040+e,t[55040+e]=n[215][e]);for(n[216]="".split(""),e=0;e!=n[216].length;++e)65533!==n[216][e].charCodeAt(0)&&(r[n[216][e]]=55296+e,t[55296+e]=n[216][e]);for(n[217]="".split(""),e=0;e!=n[217].length;++e)65533!==n[217][e].charCodeAt(0)&&(r[n[217][e]]=55552+e,t[55552+e]=n[217][e]);for(n[218]="".split(""),e=0;e!=n[218].length;++e)65533!==n[218][e].charCodeAt(0)&&(r[n[218][e]]=55808+e,t[55808+e]=n[218][e]);for(n[219]="".split(""),e=0;e!=n[219].length;++e)65533!==n[219][e].charCodeAt(0)&&(r[n[219][e]]=56064+e,t[56064+e]=n[219][e]);for(n[220]="".split(""),e=0;e!=n[220].length;++e)65533!==n[220][e].charCodeAt(0)&&(r[n[220][e]]=56320+e,t[56320+e]=n[220][e]);for(n[221]="".split(""),e=0;e!=n[221].length;++e)65533!==n[221][e].charCodeAt(0)&&(r[n[221][e]]=56576+e,t[56576+e]=n[221][e]);for(n[222]="".split(""),e=0;e!=n[222].length;++e)65533!==n[222][e].charCodeAt(0)&&(r[n[222][e]]=56832+e,t[56832+e]=n[222][e]);for(n[223]="".split(""),e=0;e!=n[223].length;++e)65533!==n[223][e].charCodeAt(0)&&(r[n[223][e]]=57088+e,t[57088+e]=n[223][e]);for(n[224]="".split(""),e=0;e!=n[224].length;++e)65533!==n[224][e].charCodeAt(0)&&(r[n[224][e]]=57344+e,t[57344+e]=n[224][e]);for(n[225]="".split(""),e=0;e!=n[225].length;++e)65533!==n[225][e].charCodeAt(0)&&(r[n[225][e]]=57600+e,t[57600+e]=n[225][e]);for(n[226]="".split(""),e=0;e!=n[226].length;++e)65533!==n[226][e].charCodeAt(0)&&(r[n[226][e]]=57856+e,t[57856+e]=n[226][e]);for(n[227]="".split(""),e=0;e!=n[227].length;++e)65533!==n[227][e].charCodeAt(0)&&(r[n[227][e]]=58112+e,t[58112+e]=n[227][e]);for(n[228]="".split(""),e=0;e!=n[228].length;++e)65533!==n[228][e].charCodeAt(0)&&(r[n[228][e]]=58368+e,t[58368+e]=n[228][e]);for(n[229]="".split(""),e=0;e!=n[229].length;++e)65533!==n[229][e].charCodeAt(0)&&(r[n[229][e]]=58624+e,t[58624+e]=n[229][e]);for(n[230]="".split(""),e=0;e!=n[230].length;++e)65533!==n[230][e].charCodeAt(0)&&(r[n[230][e]]=58880+e,t[58880+e]=n[230][e]);for(n[231]="".split(""),e=0;e!=n[231].length;++e)65533!==n[231][e].charCodeAt(0)&&(r[n[231][e]]=59136+e,t[59136+e]=n[231][e]);for(n[232]="".split(""),e=0;e!=n[232].length;++e)65533!==n[232][e].charCodeAt(0)&&(r[n[232][e]]=59392+e,t[59392+e]=n[232][e]);for(n[233]="".split(""),e=0;e!=n[233].length;++e)65533!==n[233][e].charCodeAt(0)&&(r[n[233][e]]=59648+e,t[59648+e]=n[233][e]);for(n[234]="".split(""),e=0;e!=n[234].length;++e)65533!==n[234][e].charCodeAt(0)&&(r[n[234][e]]=59904+e,t[59904+e]=n[234][e]);for(n[235]="".split(""),e=0;e!=n[235].length;++e)65533!==n[235][e].charCodeAt(0)&&(r[n[235][e]]=60160+e,t[60160+e]=n[235][e]);for(n[236]="".split(""),e=0;e!=n[236].length;++e)65533!==n[236][e].charCodeAt(0)&&(r[n[236][e]]=60416+e,t[60416+e]=n[236][e]);for(n[237]="".split(""),e=0;e!=n[237].length;++e)65533!==n[237][e].charCodeAt(0)&&(r[n[237][e]]=60672+e,t[60672+e]=n[237][e]);for(n[238]="".split(""),e=0;e!=n[238].length;++e)65533!==n[238][e].charCodeAt(0)&&(r[n[238][e]]=60928+e,t[60928+e]=n[238][e]);for(n[239]="".split(""),e=0;e!=n[239].length;++e)65533!==n[239][e].charCodeAt(0)&&(r[n[239][e]]=61184+e,t[61184+e]=n[239][e]);for(n[240]="".split(""),e=0;e!=n[240].length;++e)65533!==n[240][e].charCodeAt(0)&&(r[n[240][e]]=61440+e,t[61440+e]=n[240][e]);for(n[241]="".split(""),e=0;e!=n[241].length;++e)65533!==n[241][e].charCodeAt(0)&&(r[n[241][e]]=61696+e,t[61696+e]=n[241][e]);for(n[242]="".split(""),e=0;e!=n[242].length;++e)65533!==n[242][e].charCodeAt(0)&&(r[n[242][e]]=61952+e,t[61952+e]=n[242][e]);for(n[243]="".split(""),e=0;e!=n[243].length;++e)65533!==n[243][e].charCodeAt(0)&&(r[n[243][e]]=62208+e,t[62208+e]=n[243][e]);for(n[244]="".split(""),e=0;e!=n[244].length;++e)65533!==n[244][e].charCodeAt(0)&&(r[n[244][e]]=62464+e,t[62464+e]=n[244][e]);for(n[245]="".split(""),e=0;e!=n[245].length;++e)65533!==n[245][e].charCodeAt(0)&&(r[n[245][e]]=62720+e,t[62720+e]=n[245][e]);for(n[246]="".split(""),e=0;e!=n[246].length;++e)65533!==n[246][e].charCodeAt(0)&&(r[n[246][e]]=62976+e,t[62976+e]=n[246][e]);for(n[247]="".split(""),e=0;e!=n[247].length;++e)65533!==n[247][e].charCodeAt(0)&&(r[n[247][e]]=63232+e,t[63232+e]=n[247][e]);for(n[248]="".split(""),e=0;e!=n[248].length;++e)65533!==n[248][e].charCodeAt(0)&&(r[n[248][e]]=63488+e,t[63488+e]=n[248][e]);for(n[249]="".split(""),e=0;e!=n[249].length;++e)65533!==n[249][e].charCodeAt(0)&&(r[n[249][e]]=63744+e,t[63744+e]=n[249][e]);return{enc:r,dec:t}}(),r[1250]=function(){for(var e="\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",t=[],r={},n=0;n!=e.length;++n)65533!==e.charCodeAt(n)&&(r[e.charAt(n)]=n),t[n]=e.charAt(n);return{enc:r,dec:t}}(),r[1251]=function(){for(var e="\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",t=[],r={},n=0;n!=e.length;++n)65533!==e.charCodeAt(n)&&(r[e.charAt(n)]=n),t[n]=e.charAt(n);return{enc:r,dec:t}}(),r[1252]=function(){for(var e="\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",t=[],r={},n=0;n!=e.length;++n)65533!==e.charCodeAt(n)&&(r[e.charAt(n)]=n),t[n]=e.charAt(n);return{enc:r,dec:t}}(),r[1253]=function(){for(var e="\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",t=[],r={},n=0;n!=e.length;++n)65533!==e.charCodeAt(n)&&(r[e.charAt(n)]=n),t[n]=e.charAt(n);return{enc:r,dec:t}}(),r[1254]=function(){for(var e="\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",t=[],r={},n=0;n!=e.length;++n)65533!==e.charCodeAt(n)&&(r[e.charAt(n)]=n),t[n]=e.charAt(n);return{enc:r,dec:t}}(),r[1255]=function(){for(var e="\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",t=[],r={},n=0;n!=e.length;++n)65533!==e.charCodeAt(n)&&(r[e.charAt(n)]=n),t[n]=e.charAt(n);return{enc:r,dec:t}}(),r[1256]=function(){for(var e="\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",t=[],r={},n=0;n!=e.length;++n)65533!==e.charCodeAt(n)&&(r[e.charAt(n)]=n),t[n]=e.charAt(n);return{enc:r,dec:t}}(),r[1257]=function(){for(var e="\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",t=[],r={},n=0;n!=e.length;++n)65533!==e.charCodeAt(n)&&(r[e.charAt(n)]=n),t[n]=e.charAt(n);return{enc:r,dec:t}}(),r[1258]=function(){for(var e="\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",t=[],r={},n=0;n!=e.length;++n)65533!==e.charCodeAt(n)&&(r[e.charAt(n)]=n),t[n]=e.charAt(n);return{enc:r,dec:t}}(),r[1e4]=function(){for(var e="\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",t=[],r={},n=0;n!=e.length;++n)65533!==e.charCodeAt(n)&&(r[e.charAt(n)]=n),t[n]=e.charAt(n);return{enc:r,dec:t}}(),r[10006]=function(){for(var e="\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",t=[],r={},n=0;n!=e.length;++n)65533!==e.charCodeAt(n)&&(r[e.charAt(n)]=n),t[n]=e.charAt(n);return{enc:r,dec:t}}(),r[10007]=function(){for(var e="\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",t=[],r={},n=0;n!=e.length;++n)65533!==e.charCodeAt(n)&&(r[e.charAt(n)]=n),t[n]=e.charAt(n);return{enc:r,dec:t}}(),r[10008]=function(){var e,t=[],r={},n=[];for(n[0]="\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~".split(""),e=0;e!=n[0].length;++e)65533!==n[0][e].charCodeAt(0)&&(r[n[0][e]]=0+e,t[0+e]=n[0][e]);for(n[161]="".split(""),e=0;e!=n[161].length;++e)65533!==n[161][e].charCodeAt(0)&&(r[n[161][e]]=41216+e,t[41216+e]=n[161][e]);for(n[162]="".split(""),e=0;e!=n[162].length;++e)65533!==n[162][e].charCodeAt(0)&&(r[n[162][e]]=41472+e,t[41472+e]=n[162][e]);for(n[163]="".split(""),e=0;e!=n[163].length;++e)65533!==n[163][e].charCodeAt(0)&&(r[n[163][e]]=41728+e,t[41728+e]=n[163][e]);for(n[164]="".split(""),e=0;e!=n[164].length;++e)65533!==n[164][e].charCodeAt(0)&&(r[n[164][e]]=41984+e,t[41984+e]=n[164][e]);for(n[165]="".split(""),e=0;e!=n[165].length;++e)65533!==n[165][e].charCodeAt(0)&&(r[n[165][e]]=42240+e,t[42240+e]=n[165][e]);for(n[166]="".split(""),e=0;e!=n[166].length;++e)65533!==n[166][e].charCodeAt(0)&&(r[n[166][e]]=42496+e,t[42496+e]=n[166][e]);for(n[167]="".split(""),e=0;e!=n[167].length;++e)65533!==n[167][e].charCodeAt(0)&&(r[n[167][e]]=42752+e,t[42752+e]=n[167][e]);for(n[168]="".split(""),e=0;e!=n[168].length;++e)65533!==n[168][e].charCodeAt(0)&&(r[n[168][e]]=43008+e,t[43008+e]=n[168][e]);for(n[169]="".split(""),e=0;e!=n[169].length;++e)65533!==n[169][e].charCodeAt(0)&&(r[n[169][e]]=43264+e,t[43264+e]=n[169][e]);for(n[176]="".split(""),e=0;e!=n[176].length;++e)65533!==n[176][e].charCodeAt(0)&&(r[n[176][e]]=45056+e,t[45056+e]=n[176][e]);for(n[177]="".split(""),e=0;e!=n[177].length;++e)65533!==n[177][e].charCodeAt(0)&&(r[n[177][e]]=45312+e,t[45312+e]=n[177][e]);for(n[178]="".split(""),e=0;e!=n[178].length;++e)65533!==n[178][e].charCodeAt(0)&&(r[n[178][e]]=45568+e,t[45568+e]=n[178][e]);for(n[179]="".split(""),e=0;e!=n[179].length;++e)65533!==n[179][e].charCodeAt(0)&&(r[n[179][e]]=45824+e,t[45824+e]=n[179][e]);for(n[180]="".split(""),e=0;e!=n[180].length;++e)65533!==n[180][e].charCodeAt(0)&&(r[n[180][e]]=46080+e,t[46080+e]=n[180][e]);for(n[181]="".split(""),e=0;e!=n[181].length;++e)65533!==n[181][e].charCodeAt(0)&&(r[n[181][e]]=46336+e,t[46336+e]=n[181][e]);for(n[182]="".split(""),e=0;e!=n[182].length;++e)65533!==n[182][e].charCodeAt(0)&&(r[n[182][e]]=46592+e,t[46592+e]=n[182][e]);for(n[183]="".split(""),e=0;e!=n[183].length;++e)65533!==n[183][e].charCodeAt(0)&&(r[n[183][e]]=46848+e,t[46848+e]=n[183][e]);for(n[184]="".split(""),e=0;e!=n[184].length;++e)65533!==n[184][e].charCodeAt(0)&&(r[n[184][e]]=47104+e,t[47104+e]=n[184][e]);for(n[185]="".split(""),e=0;e!=n[185].length;++e)65533!==n[185][e].charCodeAt(0)&&(r[n[185][e]]=47360+e,t[47360+e]=n[185][e]);for(n[186]="".split(""),e=0;e!=n[186].length;++e)65533!==n[186][e].charCodeAt(0)&&(r[n[186][e]]=47616+e,t[47616+e]=n[186][e]);for(n[187]="".split(""),e=0;e!=n[187].length;++e)65533!==n[187][e].charCodeAt(0)&&(r[n[187][e]]=47872+e,t[47872+e]=n[187][e]);for(n[188]="".split(""),e=0;e!=n[188].length;++e)65533!==n[188][e].charCodeAt(0)&&(r[n[188][e]]=48128+e,t[48128+e]=n[188][e]);for(n[189]="".split(""),e=0;e!=n[189].length;++e)65533!==n[189][e].charCodeAt(0)&&(r[n[189][e]]=48384+e,t[48384+e]=n[189][e]);for(n[190]="".split(""),e=0;e!=n[190].length;++e)65533!==n[190][e].charCodeAt(0)&&(r[n[190][e]]=48640+e,t[48640+e]=n[190][e]);for(n[191]="".split(""),e=0;e!=n[191].length;++e)65533!==n[191][e].charCodeAt(0)&&(r[n[191][e]]=48896+e,t[48896+e]=n[191][e]);for(n[192]="".split(""),e=0;e!=n[192].length;++e)65533!==n[192][e].charCodeAt(0)&&(r[n[192][e]]=49152+e,t[49152+e]=n[192][e]);for(n[193]="".split(""),e=0;e!=n[193].length;++e)65533!==n[193][e].charCodeAt(0)&&(r[n[193][e]]=49408+e,t[49408+e]=n[193][e]);for(n[194]="".split(""),e=0;e!=n[194].length;++e)65533!==n[194][e].charCodeAt(0)&&(r[n[194][e]]=49664+e,t[49664+e]=n[194][e]);for(n[195]="".split(""),e=0;e!=n[195].length;++e)65533!==n[195][e].charCodeAt(0)&&(r[n[195][e]]=49920+e,t[49920+e]=n[195][e]);for(n[196]="".split(""),e=0;e!=n[196].length;++e)65533!==n[196][e].charCodeAt(0)&&(r[n[196][e]]=50176+e,t[50176+e]=n[196][e]);for(n[197]="".split(""),e=0;e!=n[197].length;++e)65533!==n[197][e].charCodeAt(0)&&(r[n[197][e]]=50432+e,t[50432+e]=n[197][e]);for(n[198]="".split(""),e=0;e!=n[198].length;++e)65533!==n[198][e].charCodeAt(0)&&(r[n[198][e]]=50688+e,t[50688+e]=n[198][e]);for(n[199]="".split(""),e=0;e!=n[199].length;++e)65533!==n[199][e].charCodeAt(0)&&(r[n[199][e]]=50944+e,t[50944+e]=n[199][e]);for(n[200]="".split(""),e=0;e!=n[200].length;++e)65533!==n[200][e].charCodeAt(0)&&(r[n[200][e]]=51200+e,t[51200+e]=n[200][e]);for(n[201]="".split(""),e=0;e!=n[201].length;++e)65533!==n[201][e].charCodeAt(0)&&(r[n[201][e]]=51456+e,t[51456+e]=n[201][e]);for(n[202]="".split(""),e=0;e!=n[202].length;++e)65533!==n[202][e].charCodeAt(0)&&(r[n[202][e]]=51712+e,t[51712+e]=n[202][e]);for(n[203]="".split(""),e=0;e!=n[203].length;++e)65533!==n[203][e].charCodeAt(0)&&(r[n[203][e]]=51968+e,t[51968+e]=n[203][e]);for(n[204]="".split(""),e=0;e!=n[204].length;++e)65533!==n[204][e].charCodeAt(0)&&(r[n[204][e]]=52224+e,t[52224+e]=n[204][e]);for(n[205]="".split(""),e=0;e!=n[205].length;++e)65533!==n[205][e].charCodeAt(0)&&(r[n[205][e]]=52480+e,t[52480+e]=n[205][e]);for(n[206]="".split(""),e=0;e!=n[206].length;++e)65533!==n[206][e].charCodeAt(0)&&(r[n[206][e]]=52736+e,t[52736+e]=n[206][e]);for(n[207]="".split(""),e=0;e!=n[207].length;++e)65533!==n[207][e].charCodeAt(0)&&(r[n[207][e]]=52992+e,t[52992+e]=n[207][e]);for(n[208]="".split(""),e=0;e!=n[208].length;++e)65533!==n[208][e].charCodeAt(0)&&(r[n[208][e]]=53248+e,t[53248+e]=n[208][e]);for(n[209]="".split(""),e=0;e!=n[209].length;++e)65533!==n[209][e].charCodeAt(0)&&(r[n[209][e]]=53504+e,t[53504+e]=n[209][e]);for(n[210]="".split(""),e=0;e!=n[210].length;++e)65533!==n[210][e].charCodeAt(0)&&(r[n[210][e]]=53760+e,t[53760+e]=n[210][e]);for(n[211]="".split(""),e=0;e!=n[211].length;++e)65533!==n[211][e].charCodeAt(0)&&(r[n[211][e]]=54016+e,t[54016+e]=n[211][e]);for(n[212]="".split(""),e=0;e!=n[212].length;++e)65533!==n[212][e].charCodeAt(0)&&(r[n[212][e]]=54272+e,t[54272+e]=n[212][e]);for(n[213]="".split(""),e=0;e!=n[213].length;++e)65533!==n[213][e].charCodeAt(0)&&(r[n[213][e]]=54528+e,t[54528+e]=n[213][e]);for(n[214]="".split(""),e=0;e!=n[214].length;++e)65533!==n[214][e].charCodeAt(0)&&(r[n[214][e]]=54784+e,t[54784+e]=n[214][e]);for(n[215]="".split(""),e=0;e!=n[215].length;++e)65533!==n[215][e].charCodeAt(0)&&(r[n[215][e]]=55040+e,t[55040+e]=n[215][e]);for(n[216]="".split(""),e=0;e!=n[216].length;++e)65533!==n[216][e].charCodeAt(0)&&(r[n[216][e]]=55296+e,t[55296+e]=n[216][e]);for(n[217]="".split(""),e=0;e!=n[217].length;++e)65533!==n[217][e].charCodeAt(0)&&(r[n[217][e]]=55552+e,t[55552+e]=n[217][e]);for(n[218]="".split(""),e=0;e!=n[218].length;++e)65533!==n[218][e].charCodeAt(0)&&(r[n[218][e]]=55808+e,t[55808+e]=n[218][e]);for(n[219]="".split(""),e=0;e!=n[219].length;++e)65533!==n[219][e].charCodeAt(0)&&(r[n[219][e]]=56064+e,t[56064+e]=n[219][e]);for(n[220]="".split(""),e=0;e!=n[220].length;++e)65533!==n[220][e].charCodeAt(0)&&(r[n[220][e]]=56320+e,t[56320+e]=n[220][e]);for(n[221]="".split(""),e=0;e!=n[221].length;++e)65533!==n[221][e].charCodeAt(0)&&(r[n[221][e]]=56576+e,t[56576+e]=n[221][e]);for(n[222]="".split(""),e=0;e!=n[222].length;++e)65533!==n[222][e].charCodeAt(0)&&(r[n[222][e]]=56832+e,t[56832+e]=n[222][e]);for(n[223]="".split(""),e=0;e!=n[223].length;++e)65533!==n[223][e].charCodeAt(0)&&(r[n[223][e]]=57088+e,t[57088+e]=n[223][e]);for(n[224]="".split(""),e=0;e!=n[224].length;++e)65533!==n[224][e].charCodeAt(0)&&(r[n[224][e]]=57344+e,t[57344+e]=n[224][e]);for(n[225]="".split(""),e=0;e!=n[225].length;++e)65533!==n[225][e].charCodeAt(0)&&(r[n[225][e]]=57600+e,t[57600+e]=n[225][e]);for(n[226]="".split(""),e=0;e!=n[226].length;++e)65533!==n[226][e].charCodeAt(0)&&(r[n[226][e]]=57856+e,t[57856+e]=n[226][e]);for(n[227]="".split(""),e=0;e!=n[227].length;++e)65533!==n[227][e].charCodeAt(0)&&(r[n[227][e]]=58112+e,t[58112+e]=n[227][e]);for(n[228]="".split(""),e=0;e!=n[228].length;++e)65533!==n[228][e].charCodeAt(0)&&(r[n[228][e]]=58368+e,t[58368+e]=n[228][e]);for(n[229]="".split(""),e=0;e!=n[229].length;++e)65533!==n[229][e].charCodeAt(0)&&(r[n[229][e]]=58624+e,t[58624+e]=n[229][e]);for(n[230]="".split(""),e=0;e!=n[230].length;++e)65533!==n[230][e].charCodeAt(0)&&(r[n[230][e]]=58880+e,t[58880+e]=n[230][e]);for(n[231]="".split(""),e=0;e!=n[231].length;++e)65533!==n[231][e].charCodeAt(0)&&(r[n[231][e]]=59136+e,t[59136+e]=n[231][e]);for(n[232]="".split(""),e=0;e!=n[232].length;++e)65533!==n[232][e].charCodeAt(0)&&(r[n[232][e]]=59392+e,t[59392+e]=n[232][e]);for(n[233]="".split(""),e=0;e!=n[233].length;++e)65533!==n[233][e].charCodeAt(0)&&(r[n[233][e]]=59648+e,t[59648+e]=n[233][e]);for(n[234]="".split(""),e=0;e!=n[234].length;++e)65533!==n[234][e].charCodeAt(0)&&(r[n[234][e]]=59904+e,t[59904+e]=n[234][e]);for(n[235]="".split(""),e=0;e!=n[235].length;++e)65533!==n[235][e].charCodeAt(0)&&(r[n[235][e]]=60160+e,t[60160+e]=n[235][e]);for(n[236]="".split(""),e=0;e!=n[236].length;++e)65533!==n[236][e].charCodeAt(0)&&(r[n[236][e]]=60416+e,t[60416+e]=n[236][e]);for(n[237]="".split(""),e=0;e!=n[237].length;++e)65533!==n[237][e].charCodeAt(0)&&(r[n[237][e]]=60672+e,t[60672+e]=n[237][e]);for(n[238]="".split(""),e=0;e!=n[238].length;++e)65533!==n[238][e].charCodeAt(0)&&(r[n[238][e]]=60928+e,t[60928+e]=n[238][e]);for(n[239]="".split(""),e=0;e!=n[239].length;++e)65533!==n[239][e].charCodeAt(0)&&(r[n[239][e]]=61184+e,t[61184+e]=n[239][e]);for(n[240]="".split(""),e=0;e!=n[240].length;++e)65533!==n[240][e].charCodeAt(0)&&(r[n[240][e]]=61440+e,t[61440+e]=n[240][e]);for(n[241]="".split(""),e=0;e!=n[241].length;++e)65533!==n[241][e].charCodeAt(0)&&(r[n[241][e]]=61696+e,t[61696+e]=n[241][e]);for(n[242]="".split(""),e=0;e!=n[242].length;++e)65533!==n[242][e].charCodeAt(0)&&(r[n[242][e]]=61952+e,t[61952+e]=n[242][e]);for(n[243]="".split(""),e=0;e!=n[243].length;++e)65533!==n[243][e].charCodeAt(0)&&(r[n[243][e]]=62208+e,t[62208+e]=n[243][e]);for(n[244]="".split(""),e=0;e!=n[244].length;++e)65533!==n[244][e].charCodeAt(0)&&(r[n[244][e]]=62464+e,t[62464+e]=n[244][e]);for(n[245]="".split(""),e=0;e!=n[245].length;++e)65533!==n[245][e].charCodeAt(0)&&(r[n[245][e]]=62720+e,t[62720+e]=n[245][e]);for(n[246]="".split(""),e=0;e!=n[246].length;++e)65533!==n[246][e].charCodeAt(0)&&(r[n[246][e]]=62976+e,t[62976+e]=n[246][e]);for(n[247]="".split(""),e=0;e!=n[247].length;++e)65533!==n[247][e].charCodeAt(0)&&(r[n[247][e]]=63232+e,t[63232+e]=n[247][e]);return{enc:r,dec:t}}(),r[10029]=function(){for(var e="\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",t=[],r={},n=0;n!=e.length;++n)65533!==e.charCodeAt(n)&&(r[e.charAt(n)]=n),t[n]=e.charAt(n);return{enc:r,dec:t}}(),r[10079]=function(){for(var e="\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",t=[],r={},n=0;n!=e.length;++n)65533!==e.charCodeAt(n)&&(r[e.charAt(n)]=n),t[n]=e.charAt(n);return{enc:r,dec:t}}(),r[10081]=function(){for(var e="\0\b\t\n\v\f\r !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",t=[],r={},n=0;n!=e.length;++n)65533!==e.charCodeAt(n)&&(r[e.charAt(n)]=n),t[n]=e.charAt(n);return{enc:r,dec:t}}(),void 0!==t&&t.exports&&"undefined"==typeof DO_NOT_EXPORT_CODEPAGE&&(t.exports=r),function(e,n){if(void 0===r){if(void 0===__require)throw new Error("cptable not found");var i=r;void 0!==t&&t.exports&&"undefined"==typeof DO_NOT_EXPORT_CODEPAGE?t.exports=n(i):e.cptable=n(i)}else r=n(r)}(e,(function(e){var t={1200:"utf16le",1201:"utf16be",12e3:"utf32le",12001:"utf32be",16969:"utf64le",20127:"ascii",65e3:"utf7",65001:"utf8"},r=[874,1250,1251,1252,1253,1254,1255,1256,1e4],n=[932,936,949,950],i=[65001],s={},o={},a={},l={},h=function(e){return String.fromCharCode(e)},u=function(e){return e.charCodeAt(0)},c="undefined"!=typeof Buffer,d=function(){};if(c){var f=!Buffer.from;if(!f)try{Buffer.from("foo","utf8")}catch(e){f=!0}d=f?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer),Buffer.allocUnsafe||(Buffer.allocUnsafe=function(e){return new Buffer(e)});var p=1024,m=Buffer.allocUnsafe(p),_=function(t){var r=function(e){for(var t=Buffer.allocUnsafe(65536),r=0;r<65536;++r)t[r]=0;for(var n=Object.keys(e),i=n.length,s=0,o=n[s];s<i;++s)!(o=n[s])||(t[o.charCodeAt(0)]=e[o]);return t}(e[t].enc);return function(e,t){var n,i=e.length,s=0,o=0,a=0,l=0;if("string"==typeof e)for(n=Buffer.allocUnsafe(i),s=0;s<i;++s)n[s]=r[e.charCodeAt(s)];else if(Buffer.isBuffer(e)){for(n=Buffer.allocUnsafe(2*i),o=0,s=0;s<i;++s)(a=e[s])<128?n[o++]=r[a]:a<224?(n[o++]=r[((31&a)<<6)+(63&e[s+1])],++s):a<240?(n[o++]=r[((15&a)<<12)+((63&e[s+1])<<6)+(63&e[s+2])],s+=2):(l=((7&a)<<18)+((63&e[s+1])<<12)+((63&e[s+2])<<6)+(63&e[s+3]),s+=3,l<65536?n[o++]=r[l]:(l-=65536,n[o++]=r[55296+(l>>10&1023)],n[o++]=r[56320+(1023&l)]));n=n.slice(0,o)}else for(n=Buffer.allocUnsafe(i),s=0;s<i;++s)n[s]=r[e[s].charCodeAt(0)];return t&&"buf"!==t?"arr"!==t?n.toString("binary"):[].slice.call(n):n}},g=function(t){var r=e[t].dec,n=Buffer.allocUnsafe(131072),i=0,s="";for(i=0;i<r.length;++i)if(s=r[i]){var o=s.charCodeAt(0);n[2*i]=255&o,n[2*i+1]=o>>8}return function(e){var t=e.length,r=0,i=0;if(2*t>p&&(p=2*t,m=Buffer.allocUnsafe(p)),Buffer.isBuffer(e))for(r=0;r<t;r++)i=2*e[r],m[2*r]=n[i],m[2*r+1]=n[i+1];else if("string"==typeof e)for(r=0;r<t;r++)i=2*e.charCodeAt(r),m[2*r]=n[i],m[2*r+1]=n[i+1];else for(r=0;r<t;r++)i=2*e[r],m[2*r]=n[i],m[2*r+1]=n[i+1];return m.slice(0,2*t).toString("ucs2")}},v=function(t){for(var r=e[t].enc,n=Buffer.allocUnsafe(131072),i=0;i<131072;++i)n[i]=0;for(var s=Object.keys(r),o=0,a=s[o];o<s.length;++o)if(a=s[o]){var l=a.charCodeAt(0);n[2*l]=255&r[a],n[2*l+1]=r[a]>>8}return function(e,t){var r=e.length,i=Buffer.allocUnsafe(2*r),s=0,o=0,a=0,l=0,h=0;if("string"==typeof e){for(s=l=0;s<r;++s)o=2*e.charCodeAt(s),i[l++]=n[o+1]||n[o],n[o+1]>0&&(i[l++]=n[o]);i=i.slice(0,l)}else if(Buffer.isBuffer(e)){for(s=l=0;s<r;++s)(h=e[s])<128?o=h:h<224?(o=((31&h)<<6)+(63&e[s+1]),++s):h<240?(o=((15&h)<<12)+((63&e[s+1])<<6)+(63&e[s+2]),s+=2):(o=((7&h)<<18)+((63&e[s+1])<<12)+((63&e[s+2])<<6)+(63&e[s+3]),s+=3),o<65536?(o*=2,i[l++]=n[o+1]||n[o],n[o+1]>0&&(i[l++]=n[o])):(o=2*(55296+((a=o-65536)>>10&1023)),i[l++]=n[o+1]||n[o],n[o+1]>0&&(i[l++]=n[o]),o=2*(56320+(1023&a)),i[l++]=n[o+1]||n[o],n[o+1]>0&&(i[l++]=n[o]));i=i.slice(0,l)}else for(s=l=0;s<r;s++)o=2*e[s].charCodeAt(0),i[l++]=n[o+1]||n[o],n[o+1]>0&&(i[l++]=n[o]);return t&&"buf"!==t?"arr"!==t?i.toString("binary"):[].slice.call(i):i}},y=function(t){var r,n=e[t].dec,i=Buffer.allocUnsafe(131072),s=0,o=0,a=0,l=0;for(l=0;l<65536;++l)i[2*l]=255,i[2*l+1]=253;for(s=0;s<n.length;++s)!(r=n[s])||(o=r.charCodeAt(0),i[a=2*s]=255&o,i[a+1]=o>>8);return function(e){var t=e.length,r=Buffer.allocUnsafe(2*t),n=0,s=0,o=0;if(Buffer.isBuffer(e))for(n=0;n<t;n++)s=2*e[n],255===i[s]&&253===i[s+1]&&(s=2*((e[n]<<8)+e[n+1]),++n),r[o++]=i[s],r[o++]=i[s+1];else if("string"==typeof e)for(n=0;n<t;n++)s=2*e.charCodeAt(n),255===i[s]&&253===i[s+1]&&(s=2*((e.charCodeAt(n)<<8)+e.charCodeAt(n+1)),++n),r[o++]=i[s],r[o++]=i[s+1];else for(n=0;n<t;n++)s=2*e[n],255===i[s]&&253===i[s+1]&&(s=2*((e[n]<<8)+e[n+1]),++n),r[o++]=i[s],r[o++]=i[s+1];return r.slice(0,o).toString("ucs2")}};s[65001]=function e(t){if("string"==typeof t)return e(t.split("").map(u));var r=t.length,n=0,i=0;4*r>p&&(p=4*r,m=Buffer.allocUnsafe(p));var s=0;r>=3&&239==t[0]&&187==t[1]&&191==t[2]&&(s=3);for(var o=1,a=0,l=0;s<r;s+=o)o=1,(l=t[s])<128?n=l:l<224?(n=64*(31&l)+(63&t[s+1]),o=2):l<240?(n=((15&l)<<12)+64*(63&t[s+1])+(63&t[s+2]),o=3):(n=262144*(7&l)+((63&t[s+1])<<12)+64*(63&t[s+2])+(63&t[s+3]),o=4),n<65536?(m[a++]=255&n,m[a++]=n>>8):(i=55296+((n-=65536)>>10&1023),n=56320+(1023&n),m[a++]=255&i,m[a++]=i>>>8,m[a++]=255&n,m[a++]=n>>>8&255);return m.slice(0,a).toString("ucs2")},o[65001]=function(e,t){if(c&&Buffer.isBuffer(e))return t&&"buf"!==t?"arr"!==t?e.toString("binary"):[].slice.call(e):e;var r=e.length,n=0,i=0,s=0,o="string"==typeof e;4*r>p&&(p=4*r,m=Buffer.allocUnsafe(p));for(var a=0;a<r;++a)(n=o?e.charCodeAt(a):e[a].charCodeAt(0))<=127?m[s++]=n:n<=2047?(m[s++]=192+(n>>6),m[s++]=128+(63&n)):n>=55296&&n<=57343?(n-=55296,++a,i=(o?e.charCodeAt(a):e[a].charCodeAt(0))-56320+(n<<10),m[s++]=240+(i>>>18&7),m[s++]=144+(i>>>12&63),m[s++]=128+(i>>>6&63),m[s++]=128+(63&i)):(m[s++]=224+(n>>12),m[s++]=128+(n>>6&63),m[s++]=128+(63&n));return t&&"buf"!==t?"arr"!==t?m.slice(0,s).toString("binary"):[].slice.call(m,0,s):m.slice(0,s)}}var b=function(){if(c){if(a[r[0]])return;var t=0,h=0;for(t=0;t<r.length;++t)h=r[t],e[h]&&(a[h]=g(h),l[h]=_(h));for(t=0;t<n.length;++t)h=n[t],e[h]&&(a[h]=y(h),l[h]=v(h));for(t=0;t<i.length;++t)h=i[t],s[h]&&(a[h]=s[h]),o[h]&&(l[h]=o[h])}},x=function(e,t){return""},S=function(e){delete a[e],delete l[e]},T={encache:b,decache:function(){if(c){if(!a[r[0]])return;r.forEach(S),n.forEach(S),i.forEach(S)}A=x,w=0},sbcs:r,dbcs:n};b();var E="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",A=x,w=0;return e.utils={decode:function r(n,i){var s;if(s=a[n])return s(i);if("string"==typeof i)return r(n,i.split("").map(u));var o,l=i.length,h=new Array(l),d="",f=0,p=0,m=1,_=0,g=0,v=e[n],y="";if(v&&(o=v.dec))for(p=0;p<l;p+=m){if(m=2,(d=o[(i[p]<<8)+i[p+1]])||(m=1,d=o[i[p]]),!d)throw new Error("Unrecognized code: "+i[p]+" "+i[p+m-1]+" "+p+" "+m+" "+o[i[p]]);h[_++]=d}else{if(!(y=t[n]))throw new Error("Unrecognized CP: "+n);switch(y){case"utf8":for(l>=3&&239==i[0]&&187==i[1]&&191==i[2]&&(p=3);p<l;p+=m)m=1,i[p]<128?f=i[p]:i[p]<224?(f=64*(31&i[p])+(63&i[p+1]),m=2):i[p]<240?(f=((15&i[p])<<12)+64*(63&i[p+1])+(63&i[p+2]),m=3):(f=262144*(7&i[p])+((63&i[p+1])<<12)+64*(63&i[p+2])+(63&i[p+3]),m=4),f<65536||(g=55296+((f-=65536)>>10&1023),f=56320+(1023&f),h[_++]=String.fromCharCode(g)),h[_++]=String.fromCharCode(f);break;case"ascii":if(c&&Buffer.isBuffer(i))return i.toString(y);for(p=0;p<l;p++)h[p]=String.fromCharCode(i[p]);_=l;break;case"utf16le":if(l>=2&&255==i[0]&&254==i[1]&&(p=2),c&&Buffer.isBuffer(i))return i.toString(y);for(m=2;p+1<l;p+=m)h[_++]=String.fromCharCode((i[p+1]<<8)+i[p]);break;case"utf16be":for(l>=2&&254==i[0]&&255==i[1]&&(p=2),m=2;p+1<l;p+=m)h[_++]=String.fromCharCode((i[p]<<8)+i[p+1]);break;case"utf32le":for(l>=4&&255==i[0]&&254==i[1]&&0===i[2]&&0===i[3]&&(p=4),m=4;p<l;p+=m)(f=(i[p+3]<<24)+(i[p+2]<<16)+(i[p+1]<<8)+i[p])>65535?(f-=65536,h[_++]=String.fromCharCode(55296+(f>>10&1023)),h[_++]=String.fromCharCode(56320+(1023&f))):h[_++]=String.fromCharCode(f);break;case"utf32be":for(l>=4&&255==i[3]&&254==i[2]&&0===i[1]&&0===i[0]&&(p=4),m=4;p<l;p+=m)(f=(i[p]<<24)+(i[p+1]<<16)+(i[p+2]<<8)+i[p+3])>65535?(f-=65536,h[_++]=String.fromCharCode(55296+(f>>10&1023)),h[_++]=String.fromCharCode(56320+(1023&f))):h[_++]=String.fromCharCode(f);break;case"utf7":for(l>=4&&43==i[0]&&47==i[1]&&118==i[2]&&(l>=5&&56==i[3]&&45==i[4]?p=5:(56==i[3]||57==i[3]||43==i[3]||47==i[3])&&(p=4));p<l;p+=m)if(43===i[p])if(m=1,45!==i[p+1]){for(;String.fromCharCode(i[p+m]).match(/[A-Za-z0-9+\/]/);)m++;var b=0;45===i[p+m]&&(++m,b=1);for(var x=[],S="",T=0,A=0,w=0,C=0,O=0,R=0,D=1;D<m-b&&(T=E.indexOf(String.fromCharCode(i[p+D++]))<<2|(C=E.indexOf(String.fromCharCode(i[p+D++])))>>4,x.push(T),-1!==(O=E.indexOf(String.fromCharCode(i[p+D++])))&&(A=(15&C)<<4|O>>2,x.push(A),-1!==(R=E.indexOf(String.fromCharCode(i[p+D++])))));)w=(3&O)<<6|R,R<64&&x.push(w);for(S=r(1201,x),D=0;D<S.length;++D)h[_++]=S.charAt(D)}else m=2,h[_++]="+";else m=1,h[_++]=String.fromCharCode(i[p]);break;default:throw new Error("Unsupported magic: "+n+" "+t[n])}}return h.slice(0,_).join("")},encode:function r(n,i,s){if(n===w&&A)return A(i,s);if(l[n])return(A=l[w=n])(i,s);c&&Buffer.isBuffer(i)&&(i=i.toString("utf8"));var o,a=i.length,u=c?Buffer.allocUnsafe(4*a):[],f=0,p=0,m=0,_=0,g=e[n],v="",y="string"==typeof i;if(g&&(o=g.enc))for(p=0;p<a;++p,++m)(f=o[y?i.charAt(p):i[p]])>255?(u[m]=f>>8,u[++m]=255&f):u[m]=255&f;else{if(!(v=t[n]))throw new Error("Unrecognized CP: "+n);switch(v){case"utf8":if(c&&y){m=(u=d(i,v)).length;break}for(p=0;p<a;++p,++m)(f=y?i.charCodeAt(p):i[p].charCodeAt(0))<=127?u[m]=f:f<=2047?(u[m]=192+(f>>6),u[++m]=128+(63&f)):f>=55296&&f<=57343?(f-=55296,_=(y?i.charCodeAt(++p):i[++p].charCodeAt(0))-56320+(f<<10),u[m]=240+(_>>>18&7),u[++m]=144+(_>>>12&63),u[++m]=128+(_>>>6&63),u[++m]=128+(63&_)):(u[m]=224+(f>>12),u[++m]=128+(f>>6&63),u[++m]=128+(63&f));break;case"ascii":if(c&&"string"==typeof i){m=(u=d(i,v)).length;break}for(p=0;p<a;++p,++m){if(!((f=y?i.charCodeAt(p):i[p].charCodeAt(0))<=127))throw new Error("bad ascii "+f);u[m]=f}break;case"utf16le":if(c&&"string"==typeof i){m=(u=d(i,v)).length;break}for(p=0;p<a;++p)f=y?i.charCodeAt(p):i[p].charCodeAt(0),u[m++]=255&f,u[m++]=f>>8;break;case"utf16be":for(p=0;p<a;++p)f=y?i.charCodeAt(p):i[p].charCodeAt(0),u[m++]=f>>8,u[m++]=255&f;break;case"utf32le":for(p=0;p<a;++p)(f=y?i.charCodeAt(p):i[p].charCodeAt(0))>=55296&&f<=57343&&(f=65536+(f-55296<<10)+(i[++p].charCodeAt(0)-56320)),u[m++]=255&f,f>>=8,u[m++]=255&f,f>>=8,u[m++]=255&f,f>>=8,u[m++]=255&f;break;case"utf32be":for(p=0;p<a;++p)(f=y?i.charCodeAt(p):i[p].charCodeAt(0))>=55296&&f<=57343&&(f=65536+(f-55296<<10)+(i[++p].charCodeAt(0)-56320)),u[m+3]=255&f,f>>=8,u[m+2]=255&f,f>>=8,u[m+1]=255&f,f>>=8,u[m]=255&f,m+=4;break;case"utf7":for(p=0;p<a;p++){var b=y?i.charAt(p):i[p].charAt(0);if("+"!==b)if("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'(),-./:?".indexOf(b)>-1)u[m++]=b.charCodeAt(0);else{var x=r(1201,b);u[m++]=43,u[m++]=E.charCodeAt(x[0]>>2),u[m++]=E.charCodeAt(((3&x[0])<<4)+((x[1]||0)>>4)),u[m++]=E.charCodeAt(((15&x[1])<<2)+((x[2]||0)>>6)),u[m++]=45}else u[m++]=43,u[m++]=45}break;default:throw new Error("Unsupported magic: "+n+" "+t[n])}}return u=u.slice(0,m),c?s&&"buf"!==s?"arr"!==s?u.toString("binary"):[].slice.call(u):u:"str"==s?u.map(h).join(""):u},hascp:function(r){return!(!e[r]&&!t[r])},magic:t,cache:T},e}))}}),require_fs=__commonJS({"(disabled):fs"(){}}),require_jszip=__commonJS({"node_modules/xlsx/jszip.js"(e,t){!function(r){if("object"==typeof e&&void 0!==t&&"undefined"==typeof DO_NOT_EXPORT_JSZIP)t.exports=r();else if("function"==typeof define&&define.amd&&"undefined"==typeof DO_NOT_EXPORT_JSZIP)JSZipSync=r(),define([],r);else{var n;"undefined"!=typeof globalThis?n=globalThis:"undefined"!=typeof window?n=window:"undefined"!=typeof global?n=global:"undefined"!=typeof $&&$.global?n=$.global:"undefined"!=typeof self&&(n=self),n.JSZipSync=r()}}((function(){return function e(t,r,n){function i(o,a){if(!r[o]){if(!t[o]){var l="function"==typeof __require&&__require;if(!a&&l)return l(o,!0);if(s)return s(o,!0);throw new Error("Cannot find module '"+o+"'")}var h=r[o]={exports:{}};t[o][0].call(h.exports,(function(e){return i(t[o][1][e]||e)}),h,h.exports,e,t,r,n)}return r[o].exports}for(var s="function"==typeof __require&&__require,o=0;o<n.length;o++)i(n[o]);return i}({1:[function(e,t,r){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(e,t){for(var r,i,s,o,a,l,h,u="",c=0;c<e.length;)o=(r=e.charCodeAt(c++))>>2,a=(3&r)<<4|(i=e.charCodeAt(c++))>>4,l=(15&i)<<2|(s=e.charCodeAt(c++))>>6,h=63&s,isNaN(i)?l=h=64:isNaN(s)&&(h=64),u=u+n.charAt(o)+n.charAt(a)+n.charAt(l)+n.charAt(h);return u},r.decode=function(e,t){var r,i,s,o,a,l,h="",u=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");u<e.length;)r=n.indexOf(e.charAt(u++))<<2|(o=n.indexOf(e.charAt(u++)))>>4,i=(15&o)<<4|(a=n.indexOf(e.charAt(u++)))>>2,s=(3&a)<<6|(l=n.indexOf(e.charAt(u++))),h+=String.fromCharCode(r),64!=a&&(h+=String.fromCharCode(i)),64!=l&&(h+=String.fromCharCode(s));return h}},{}],2:[function(e,t,r){function n(){this.compressedSize=0,this.uncompressedSize=0,this.crc32=0,this.compressionMethod=null,this.compressedContent=null}n.prototype={getContent:function(){return null},getCompressedContent:function(){return null}},t.exports=n},{}],3:[function(e,t,r){r.STORE={magic:"\0\0",compress:function(e){return e},uncompress:function(e){return e},compressInputType:null,uncompressInputType:null},r.DEFLATE=e("./flate")},{"./flate":8}],4:[function(e,t,r){var n=e("./utils"),i=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];t.exports=function(e,t){if(void 0===e||!e.length)return 0;var r="string"!==n.getTypeOf(e);void 0===t&&(t=0);var s=0;t^=-1;for(var o=0,a=e.length;o<a;o++)s=r?e[o]:e.charCodeAt(o),t=t>>>8^i[255&(t^s)];return-1^t}},{"./utils":21}],5:[function(e,t,r){var n=e("./utils");function i(e){this.data=null,this.length=0,this.index=0}i.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(e){},readInt:function(e){var t,r=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)r=(r<<8)+this.byteAt(t);return this.index+=e,r},readString:function(e){return n.transformTo("string",this.readData(e))},readData:function(e){},lastIndexOfSignature:function(e){},readDate:function(){var e=this.readInt(4);return new Date(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1)}},t.exports=i},{"./utils":21}],6:[function(e,t,r){r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!1,r.date=null,r.compression=null,r.comment=null},{}],7:[function(e,t,r){var n=e("./utils");r.string2binary=function(e){return n.string2binary(e)},r.string2Uint8Array=function(e){return n.transformTo("uint8array",e)},r.uint8Array2String=function(e){return n.transformTo("string",e)},r.string2Blob=function(e){var t=n.transformTo("arraybuffer",e);return n.arrayBuffer2Blob(t)},r.arrayBuffer2Blob=function(e){return n.arrayBuffer2Blob(e)},r.transformTo=function(e,t){return n.transformTo(e,t)},r.getTypeOf=function(e){return n.getTypeOf(e)},r.checkSupport=function(e){return n.checkSupport(e)},r.MAX_VALUE_16BITS=n.MAX_VALUE_16BITS,r.MAX_VALUE_32BITS=n.MAX_VALUE_32BITS,r.pretty=function(e){return n.pretty(e)},r.findCompression=function(e){return n.findCompression(e)},r.isRegExp=function(e){return n.isRegExp(e)}},{"./utils":21}],8:[function(e,t,r){var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,i=e("pako");r.uncompressInputType=n?"uint8array":"array",r.compressInputType=n?"uint8array":"array",r.magic="\b\0",r.compress=function(e){return i.deflateRaw(e)},r.uncompress=function(e){return i.inflateRaw(e)}},{pako:24}],9:[function(e,t,r){var n=e("./base64");function i(e,t){if(!(this instanceof i))return new i(e,t);this.files={},this.comment=null,this.root="",e&&this.load(e,t),this.clone=function(){var e=new i;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}i.prototype=e("./object"),i.prototype.load=e("./load"),i.support=e("./support"),i.defaults=e("./defaults"),i.utils=e("./deprecatedPublicUtils"),i.base64={encode:function(e){return n.encode(e)},decode:function(e){return n.decode(e)}},i.compressions=e("./compressions"),t.exports=i},{"./base64":1,"./compressions":3,"./defaults":6,"./deprecatedPublicUtils":7,"./load":10,"./object":13,"./support":17}],10:[function(e,t,r){var n=e("./base64"),i=e("./zipEntries");t.exports=function(e,t){var r,s,o,a;for((t=t||{}).base64&&(e=n.decode(e)),r=(s=new i(e,t)).files,o=0;o<r.length;o++)a=r[o],this.file(a.fileName,a.decompressed,{binary:!0,optimizedBinaryString:!0,date:a.date,dir:a.dir,comment:a.fileComment.length?a.fileComment:null,createFolders:t.createFolders});return s.zipComment.length&&(this.comment=s.zipComment),this}},{"./base64":1,"./zipEntries":22}],11:[function(e,t,r){(function(e){var r=function(){};if(void 0!==e){var n=!e.from;if(!n)try{e.from("foo","utf8")}catch(e){n=!0}r=n?function(t,r){return r?new e(t,r):new e(t)}:e.from.bind(e),e.alloc||(e.alloc=function(t){return new e(t)})}t.exports=function(t,n){return"number"==typeof t?e.alloc(t):r(t,n)},t.exports.test=function(t){return e.isBuffer(t)}}).call(this,"undefined"!=typeof Buffer?Buffer:void 0)},{}],12:[function(e,t,r){var n=e("./uint8ArrayReader");function i(e){this.data=e,this.length=this.data.length,this.index=0}i.prototype=new n,i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.index,this.index+e);return this.index+=e,t},t.exports=i},{"./uint8ArrayReader":18}],13:[function(e,t,r){var n=e("./support"),i=e("./utils"),s=e("./crc32"),o=e("./signature"),a=e("./defaults"),l=e("./base64"),h=e("./compressions"),u=e("./compressedObject"),c=e("./nodeBuffer"),d=e("./utf8"),f=e("./stringWriter"),p=e("./uint8ArrayWriter"),m=function(e){if(e._data instanceof u&&(e._data=e._data.getContent(),e.options.binary=!0,e.options.base64=!1,"uint8array"===i.getTypeOf(e._data))){var t=e._data;e._data=new Uint8Array(t.length),0!==t.length&&e._data.set(t,0)}return e._data},_=function(e){var t=m(e);return"string"===i.getTypeOf(t)?!e.options.binary&&n.nodebuffer?c(t,"utf-8"):e.asBinary():t},g=function(e){var t=m(this);return null==t?"":(this.options.base64&&(t=l.decode(t)),t=e&&this.options.binary?w.utf8decode(t):i.transformTo("string",t),!e&&!this.options.binary&&(t=i.transformTo("string",w.utf8encode(t))),t)},v=function(e,t,r){this.name=e,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this._data=t,this.options=r,this._initialMetadata={dir:r.dir,date:r.date}};v.prototype={asText:function(){return g.call(this,!0)},asBinary:function(){return g.call(this,!1)},asNodeBuffer:function(){var e=_(this);return i.transformTo("nodebuffer",e)},asUint8Array:function(){var e=_(this);return i.transformTo("uint8array",e)},asArrayBuffer:function(){return this.asUint8Array().buffer}};var y=function(e,t){var r,n="";for(r=0;r<t;r++)n+=String.fromCharCode(255&e),e>>>=8;return n},b=function(){var e,t,r={};for(e=0;e<arguments.length;e++)for(t in arguments[e])arguments[e].hasOwnProperty(t)&&void 0===r[t]&&(r[t]=arguments[e][t]);return r},x=function(e,t,r){var n,s=i.getTypeOf(t);if((r=function(e){return!0===(e=e||{}).base64&&(null===e.binary||void 0===e.binary)&&(e.binary=!0),(e=b(e,a)).date=e.date||new Date,null!==e.compression&&(e.compression=e.compression.toUpperCase()),e}(r)).createFolders&&(n=S(e))&&T.call(this,n,!0),r.dir||null==t)r.base64=!1,r.binary=!1,t=null;else if("string"===s)r.binary&&!r.base64&&!0!==r.optimizedBinaryString&&(t=i.string2binary(t));else{if(r.base64=!1,r.binary=!0,!(s||t instanceof u))throw new Error("The data of '"+e+"' is in an unsupported format !");"arraybuffer"===s&&(t=i.transformTo("uint8array",t))}var o=new v(e,t,r);return this.files[e]=o,o},S=function(e){"/"==e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return t>0?e.substring(0,t):""},T=function(e,t){return"/"!=e.slice(-1)&&(e+="/"),t=void 0!==t&&t,this.files[e]||x.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]},E=function(e,t){var r,n=new u;return e._data instanceof u?(n.uncompressedSize=e._data.uncompressedSize,n.crc32=e._data.crc32,0===n.uncompressedSize||e.dir?(t=h.STORE,n.compressedContent="",n.crc32=0):e._data.compressionMethod===t.magic?n.compressedContent=e._data.getCompressedContent():(r=e._data.getContent(),n.compressedContent=t.compress(i.transformTo(t.compressInputType,r)))):((!(r=_(e))||0===r.length||e.dir)&&(t=h.STORE,r=""),n.uncompressedSize=r.length,n.crc32=s(r),n.compressedContent=t.compress(i.transformTo(t.compressInputType,r))),n.compressedSize=n.compressedContent.length,n.compressionMethod=t.magic,n},A=function(e,t,r,n){r.compressedContent;var a,l,h,u,c=i.transformTo("string",d.utf8encode(t.name)),f=t.comment||"",p=i.transformTo("string",d.utf8encode(f)),m=c.length!==t.name.length,_=p.length!==f.length,g=t.options,v="",b="",x="";h=t._initialMetadata.dir!==t.dir?t.dir:g.dir,a=(u=t._initialMetadata.date!==t.date?t.date:g.date).getHours(),a<<=6,a|=u.getMinutes(),a<<=5,a|=u.getSeconds()/2,l=u.getFullYear()-1980,l<<=4,l|=u.getMonth()+1,l<<=5,l|=u.getDate(),m&&(b=y(1,1)+y(s(c),4)+c,v+="up"+y(b.length,2)+b),_&&(x=y(1,1)+y(this.crc32(p),4)+p,v+="uc"+y(x.length,2)+x);var S="";return S+="\n\0",S+=m||_?"\0\b":"\0\0",S+=r.compressionMethod,S+=y(a,2),S+=y(l,2),S+=y(r.crc32,4),S+=y(r.compressedSize,4),S+=y(r.uncompressedSize,4),S+=y(c.length,2),S+=y(v.length,2),{fileRecord:o.LOCAL_FILE_HEADER+S+c+v,dirRecord:o.CENTRAL_FILE_HEADER+"\0"+S+y(p.length,2)+"\0\0\0\0"+(!0===h?"\0\0\0":"\0\0\0\0")+y(n,4)+c+v+p,compressedObject:r}},w={load:function(e,t){throw new Error("Load method is not defined. Is the file jszip-load.js included ?")},filter:function(e){var t,r,n,i,s=[];for(t in this.files)!this.files.hasOwnProperty(t)||(n=this.files[t],i=new v(n.name,n._data,b(n.options)),r=t.slice(this.root.length,t.length),t.slice(0,this.root.length)===this.root&&e(r,i)&&s.push(i));return s},file:function(e,t,r){if(1===arguments.length){if(i.isRegExp(e)){var n=e;return this.filter((function(e,t){return!t.dir&&n.test(e)}))}return this.filter((function(t,r){return!r.dir&&t===e}))[0]||null}return e=this.root+e,x.call(this,e,t,r),this},folder:function(e){if(!e)return this;if(i.isRegExp(e))return this.filter((function(t,r){return r.dir&&e.test(t)}));var t=this.root+e,r=T.call(this,t),n=this.clone();return n.root=r.name,n},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!=e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var r=this.filter((function(t,r){return r.name.slice(0,e.length)===e})),n=0;n<r.length;n++)delete this.files[r[n].name];return this},generate:function(e){e=b(e||{},{base64:!0,compression:"STORE",type:"base64",comment:null}),i.checkSupport(e.type);var t,r,n,s=[],a=0,u=0,c=i.transformTo("string",this.utf8encode(e.comment||this.comment||""));for(var d in this.files)if(this.files.hasOwnProperty(d)){var m=this.files[d],_=m.options.compression||e.compression.toUpperCase(),g=h[_];if(!g)throw new Error(_+" is not a valid compression method !");var v=E.call(this,m,g),x=A.call(this,d,m,v,a);a+=x.fileRecord.length+v.compressedSize,u+=x.dirRecord.length,s.push(x)}n=o.CENTRAL_DIRECTORY_END+"\0\0\0\0"+y(s.length,2)+y(s.length,2)+y(u,4)+y(a,4)+y(c.length,2)+c;var S=e.type.toLowerCase();for(t="uint8array"===S||"arraybuffer"===S||"blob"===S||"nodebuffer"===S?new p(a+u+n.length):new f(a+u+n.length),r=0;r<s.length;r++)t.append(s[r].fileRecord),t.append(s[r].compressedObject.compressedContent);for(r=0;r<s.length;r++)t.append(s[r].dirRecord);t.append(n);var T=t.finalize();switch(e.type.toLowerCase()){case"uint8array":case"arraybuffer":case"nodebuffer":return i.transformTo(e.type.toLowerCase(),T);case"blob":return i.arrayBuffer2Blob(i.transformTo("arraybuffer",T));case"base64":return e.base64?l.encode(T):T;default:return T}},crc32:function(e,t){return s(e,t)},utf8encode:function(e){return i.transformTo("string",d.utf8encode(e))},utf8decode:function(e){return d.utf8decode(e)}};t.exports=w},{"./base64":1,"./compressedObject":2,"./compressions":3,"./crc32":4,"./defaults":6,"./nodeBuffer":11,"./signature":14,"./stringWriter":16,"./support":17,"./uint8ArrayWriter":19,"./utf8":20,"./utils":21}],14:[function(e,t,r){r.LOCAL_FILE_HEADER="PK",r.CENTRAL_FILE_HEADER="PK",r.CENTRAL_DIRECTORY_END="PK",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",r.ZIP64_CENTRAL_DIRECTORY_END="PK",r.DATA_DESCRIPTOR="PK\b"},{}],15:[function(e,t,r){var n=e("./dataReader"),i=e("./utils");function s(e,t){this.data=e,t||(this.data=i.string2binary(this.data)),this.length=this.data.length,this.index=0}s.prototype=new n,s.prototype.byteAt=function(e){return this.data.charCodeAt(e)},s.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)},s.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.index,this.index+e);return this.index+=e,t},t.exports=s},{"./dataReader":5,"./utils":21}],16:[function(e,t,r){var n=e("./utils"),i=function(){this.data=[]};i.prototype={append:function(e){e=n.transformTo("string",e),this.data.push(e)},finalize:function(){return this.data.join("")}},t.exports=i},{"./utils":21}],17:[function(e,t,r){(function(e){if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,r.nodebuffer=void 0!==e,r.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)r.blob=!1;else{var t=new ArrayBuffer(0);try{r.blob=0===new Blob([t],{type:"application/zip"}).size}catch(e){try{var n=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);n.append(t),r.blob=0===n.getBlob("application/zip").size}catch(e){r.blob=!1}}}}).call(this,"undefined"!=typeof Buffer?Buffer:void 0)},{}],18:[function(e,t,r){var n=e("./dataReader");function i(e){e&&(this.data=e,this.length=this.data.length,this.index=0)}i.prototype=new n,i.prototype.byteAt=function(e){return this.data[e]},i.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),r=e.charCodeAt(1),n=e.charCodeAt(2),i=e.charCodeAt(3),s=this.length-4;s>=0;--s)if(this.data[s]===t&&this.data[s+1]===r&&this.data[s+2]===n&&this.data[s+3]===i)return s;return-1},i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.index,this.index+e);return this.index+=e,t},t.exports=i},{"./dataReader":5}],19:[function(e,t,r){var n=e("./utils"),i=function(e){this.data=new Uint8Array(e),this.index=0};i.prototype={append:function(e){0!==e.length&&(e=n.transformTo("uint8array",e),this.data.set(e,this.index),this.index+=e.length)},finalize:function(){return this.data}},t.exports=i},{"./utils":21}],20:[function(e,t,r){for(var n=e("./utils"),i=e("./support"),s=e("./nodeBuffer"),o=new Array(256),a=0;a<256;a++)o[a]=a>=252?6:a>=248?5:a>=240?4:a>=224?3:a>=192?2:1;o[254]=o[254]=1;var l=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;r>=0&&128==(192&e[r]);)r--;return r<0||0===r?t:r+o[e[r]]>t?r:t},h=function(e){var t,r,i,s,a=e.length,l=new Array(2*a);for(r=0,t=0;t<a;)if((i=e[t++])<128)l[r++]=i;else if((s=o[i])>4)l[r++]=65533,t+=s-1;else{for(i&=2===s?31:3===s?15:7;s>1&&t<a;)i=i<<6|63&e[t++],s--;s>1?l[r++]=65533:i<65536?l[r++]=i:(i-=65536,l[r++]=55296|i>>10&1023,l[r++]=56320|1023&i)}return l.length!==r&&(l.subarray?l=l.subarray(0,r):l.length=r),n.applyFromCharCode(l)};r.utf8encode=function(e){return i.nodebuffer?s(e,"utf-8"):function(e){var t,r,n,s,o,a=e.length,l=0;for(s=0;s<a;s++)55296==(64512&(r=e.charCodeAt(s)))&&s+1<a&&56320==(64512&(n=e.charCodeAt(s+1)))&&(r=65536+(r-55296<<10)+(n-56320),s++),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=i.uint8array?new Uint8Array(l):new Array(l),o=0,s=0;o<l;s++)55296==(64512&(r=e.charCodeAt(s)))&&s+1<a&&56320==(64512&(n=e.charCodeAt(s+1)))&&(r=65536+(r-55296<<10)+(n-56320),s++),r<128?t[o++]=r:r<2048?(t[o++]=192|r>>>6,t[o++]=128|63&r):r<65536?(t[o++]=224|r>>>12,t[o++]=128|r>>>6&63,t[o++]=128|63&r):(t[o++]=240|r>>>18,t[o++]=128|r>>>12&63,t[o++]=128|r>>>6&63,t[o++]=128|63&r);return t}(e)},r.utf8decode=function(e){if(i.nodebuffer)return n.transformTo("nodebuffer",e).toString("utf-8");for(var t=[],r=0,s=(e=n.transformTo(i.uint8array?"uint8array":"array",e)).length;r<s;){var o=l(e,Math.min(r+65536,s));i.uint8array?t.push(h(e.subarray(r,o))):t.push(h(e.slice(r,o))),r=o}return t.join("")}},{"./nodeBuffer":11,"./support":17,"./utils":21}],21:[function(e,t,r){var n=e("./support"),i=e("./compressions"),s=e("./nodeBuffer");function o(e){return e}function a(e,t){for(var r=0;r<e.length;++r)t[r]=255&e.charCodeAt(r);return t}function l(e){var t=65536,n=[],i=e.length,o=r.getTypeOf(e),a=0,l=!0;try{switch(o){case"uint8array":String.fromCharCode.apply(null,new Uint8Array(0));break;case"nodebuffer":String.fromCharCode.apply(null,s(0))}}catch(e){l=!1}if(!l){for(var h="",u=0;u<e.length;u++)h+=String.fromCharCode(e[u]);return h}for(;a<i&&t>1;)try{"array"===o||"nodebuffer"===o?n.push(String.fromCharCode.apply(null,e.slice(a,Math.min(a+t,i)))):n.push(String.fromCharCode.apply(null,e.subarray(a,Math.min(a+t,i)))),a+=t}catch(e){t=Math.floor(t/2)}return n.join("")}function h(e,t){for(var r=0;r<e.length;r++)t[r]=e[r];return t}r.string2binary=function(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(255&e.charCodeAt(r));return t},r.arrayBuffer2Blob=function(e){r.checkSupport("blob");try{return new Blob([e],{type:"application/zip"})}catch(r){try{var t=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);return t.append(e),t.getBlob("application/zip")}catch(e){throw new Error("Bug : can't construct the Blob.")}}},r.applyFromCharCode=l;var u={};u.string={string:o,array:function(e){return a(e,new Array(e.length))},arraybuffer:function(e){return u.string.uint8array(e).buffer},uint8array:function(e){return a(e,new Uint8Array(e.length))},nodebuffer:function(e){return a(e,s(e.length))}},u.array={string:l,array:o,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return s(e)}},u.arraybuffer={string:function(e){return l(new Uint8Array(e))},array:function(e){return h(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:o,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return s(new Uint8Array(e))}},u.uint8array={string:l,array:function(e){return h(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:o,nodebuffer:function(e){return s(e)}},u.nodebuffer={string:l,array:function(e){return h(e,new Array(e.length))},arraybuffer:function(e){return u.nodebuffer.uint8array(e).buffer},uint8array:function(e){return h(e,new Uint8Array(e.length))},nodebuffer:o},r.transformTo=function(e,t){if(t||(t=""),!e)return t;r.checkSupport(e);var n=r.getTypeOf(t);return u[n][e](t)},r.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":n.nodebuffer&&s.test(e)?"nodebuffer":n.uint8array&&e instanceof Uint8Array?"uint8array":n.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},r.checkSupport=function(e){if(!n[e.toLowerCase()])throw new Error(e+" is not supported by this browser")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(e){var t,r,n="";for(r=0;r<(e||"").length;r++)n+="\\x"+((t=e.charCodeAt(r))<16?"0":"")+t.toString(16).toUpperCase();return n},r.findCompression=function(e){for(var t in i)if(i.hasOwnProperty(t)&&i[t].magic===e)return i[t];return null},r.isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)}},{"./compressions":3,"./nodeBuffer":11,"./support":17}],22:[function(e,t,r){var n=e("./stringReader"),i=e("./nodeBufferReader"),s=e("./uint8ArrayReader"),o=e("./utils"),a=e("./signature"),l=e("./zipEntry"),h=e("./support"),u=e("./object");function c(e,t){this.files=[],this.loadOptions=t,e&&this.load(e)}c.prototype={checkSignature:function(e){var t=this.reader.readString(4);if(t!==e)throw new Error("Corrupted zip or bug : unexpected signature ("+o.pretty(t)+", expected "+o.pretty(e)+")")},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2),this.zipComment=this.reader.readString(this.zipCommentLength),this.zipComment=u.utf8decode(this.zipComment)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.versionMadeBy=this.reader.readString(2),this.versionNeeded=this.reader.readInt(2),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,r,n=this.zip64EndOfCentralSize-44;0<n;)e=this.reader.readInt(2),t=this.reader.readInt(4),r=this.reader.readString(t),this.zip64ExtensibleData[e]={id:e,length:t,value:r}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4)===a.CENTRAL_FILE_HEADER;)(e=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(-1===e)throw new Error("Corrupted zip : can't find end of central directory");if(this.reader.setIndex(e),this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,-1===(e=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR)))throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator");this.reader.setIndex(e),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}},prepareReader:function(e){var t=o.getTypeOf(e);"string"!==t||h.uint8array?this.reader="nodebuffer"===t?new i(e):new s(o.transformTo("uint8array",e)):this.reader=new n(e,this.loadOptions.optimizedBinaryString)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=c},{"./nodeBufferReader":12,"./object":13,"./signature":14,"./stringReader":15,"./support":17,"./uint8ArrayReader":18,"./utils":21,"./zipEntry":23}],23:[function(e,t,r){var n=e("./stringReader"),i=e("./utils"),s=e("./compressedObject"),o=e("./object");function a(e,t){this.options=e,this.loadOptions=t}a.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},prepareCompressedContent:function(e,t,r){return function(){var n=e.index;e.setIndex(t);var i=e.readData(r);return e.setIndex(n),i}},prepareContent:function(e,t,r,n,s){return function(){var e=i.transformTo(n.uncompressInputType,this.getCompressedContent()),t=n.uncompress(e);if(t.length!==s)throw new Error("Bug : uncompressed data size mismatch");return t}},readLocalPart:function(e){var t,r;if(e.skip(22),this.fileNameLength=e.readInt(2),r=e.readInt(2),this.fileName=e.readString(this.fileNameLength),e.skip(r),-1==this.compressedSize||-1==this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)");if(null===(t=i.findCompression(this.compressionMethod)))throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+this.fileName+")");if(this.decompressed=new s,this.decompressed.compressedSize=this.compressedSize,this.decompressed.uncompressedSize=this.uncompressedSize,this.decompressed.crc32=this.crc32,this.decompressed.compressionMethod=this.compressionMethod,this.decompressed.getCompressedContent=this.prepareCompressedContent(e,e.index,this.compressedSize,t),this.decompressed.getContent=this.prepareContent(e,e.index,this.compressedSize,t,this.uncompressedSize),this.loadOptions.checkCRC32&&(this.decompressed=i.transformTo("string",this.decompressed.getContent()),o.crc32(this.decompressed)!==this.crc32))throw new Error("Corrupted zip : CRC32 mismatch")},readCentralPart:function(e){if(this.versionMadeBy=e.readString(2),this.versionNeeded=e.readInt(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4),this.fileNameLength=e.readInt(2),this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");this.fileName=e.readString(this.fileNameLength),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readString(this.fileCommentLength),this.dir=!!(16&this.externalFileAttributes)},parseZIP64ExtraField:function(e){if(this.extraFields[1]){var t=new n(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=t.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=t.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=t.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=t.readInt(4))}},readExtraFields:function(e){var t,r,n,i=e.index;for(this.extraFields=this.extraFields||{};e.index<i+this.extraFieldsLength;)t=e.readInt(2),r=e.readInt(2),n=e.readString(r),this.extraFields[t]={id:t,length:r,value:n}},handleUTF8:function(){if(this.useUTF8())this.fileName=o.utf8decode(this.fileName),this.fileComment=o.utf8decode(this.fileComment);else{var e=this.findExtraFieldUnicodePath();null!==e&&(this.fileName=e);var t=this.findExtraFieldUnicodeComment();null!==t&&(this.fileComment=t)}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=new n(e.value);return 1!==t.readInt(1)||o.crc32(this.fileName)!==t.readInt(4)?null:o.utf8decode(t.readString(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=new n(e.value);return 1!==t.readInt(1)||o.crc32(this.fileComment)!==t.readInt(4)?null:o.utf8decode(t.readString(e.length-5))}return null}},t.exports=a},{"./compressedObject":2,"./object":13,"./stringReader":15,"./utils":21}],24:[function(e,t,r){var n={};(0,e("./lib/utils/common").assign)(n,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=n},{"./lib/deflate":25,"./lib/inflate":26,"./lib/utils/common":27,"./lib/zlib/constants":30}],25:[function(e,t,r){var n=e("./zlib/deflate.js"),i=e("./utils/common"),s=e("./utils/strings"),o=e("./zlib/messages"),a=e("./zlib/zstream"),l=function(e){this.options=i.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;var r=n.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(0!==r)throw new Error(o[r]);t.header&&n.deflateSetHeader(this.strm,t.header)};function h(e,t){var r=new l(t);if(r.push(e,!0),r.err)throw r.msg;return r.result}l.prototype.push=function(e,t){var r,o,a=this.strm,l=this.options.chunkSize;if(this.ended)return!1;o=t===~~t?t:!0===t?4:0,a.input="string"==typeof e?s.string2buf(e):e,a.next_in=0,a.avail_in=a.input.length;do{if(0===a.avail_out&&(a.output=new i.Buf8(l),a.next_out=0,a.avail_out=l),1!==(r=n.deflate(a,o))&&0!==r)return this.onEnd(r),this.ended=!0,!1;(0===a.avail_out||0===a.avail_in&&4===o)&&("string"===this.options.to?this.onData(s.buf2binstring(i.shrinkBuf(a.output,a.next_out))):this.onData(i.shrinkBuf(a.output,a.next_out)))}while((a.avail_in>0||0===a.avail_out)&&1!==r);return 4!==o||(r=n.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,0===r)},l.prototype.onData=function(e){this.chunks.push(e)},l.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},r.Deflate=l,r.deflate=h,r.deflateRaw=function(e,t){return(t=t||{}).raw=!0,h(e,t)},r.gzip=function(e,t){return(t=t||{}).gzip=!0,h(e,t)}},{"./utils/common":27,"./utils/strings":28,"./zlib/deflate.js":32,"./zlib/messages":37,"./zlib/zstream":39}],26:[function(e,t,r){var n=e("./zlib/inflate.js"),i=e("./utils/common"),s=e("./utils/strings"),o=e("./zlib/constants"),a=e("./zlib/messages"),l=e("./zlib/zstream"),h=e("./zlib/gzheader"),u=function(e){this.options=i.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var r=n.inflateInit2(this.strm,t.windowBits);if(r!==o.Z_OK)throw new Error(a[r]);this.header=new h,n.inflateGetHeader(this.strm,this.header)};function c(e,t){var r=new u(t);if(r.push(e,!0),r.err)throw r.msg;return r.result}u.prototype.push=function(e,t){var r,a,l,h,u,c=this.strm,d=this.options.chunkSize;if(this.ended)return!1;a=t===~~t?t:!0===t?o.Z_FINISH:o.Z_NO_FLUSH,c.input="string"==typeof e?s.binstring2buf(e):e,c.next_in=0,c.avail_in=c.input.length;do{if(0===c.avail_out&&(c.output=new i.Buf8(d),c.next_out=0,c.avail_out=d),(r=n.inflate(c,o.Z_NO_FLUSH))!==o.Z_STREAM_END&&r!==o.Z_OK)return this.onEnd(r),this.ended=!0,!1;c.next_out&&(0===c.avail_out||r===o.Z_STREAM_END||0===c.avail_in&&a===o.Z_FINISH)&&("string"===this.options.to?(l=s.utf8border(c.output,c.next_out),h=c.next_out-l,u=s.buf2string(c.output,l),c.next_out=h,c.avail_out=d-h,h&&i.arraySet(c.output,c.output,l,h,0),this.onData(u)):this.onData(i.shrinkBuf(c.output,c.next_out)))}while(c.avail_in>0&&r!==o.Z_STREAM_END);return r===o.Z_STREAM_END&&(a=o.Z_FINISH),a!==o.Z_FINISH||(r=n.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===o.Z_OK)},u.prototype.onData=function(e){this.chunks.push(e)},u.prototype.onEnd=function(e){e===o.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},r.Inflate=u,r.inflate=c,r.inflateRaw=function(e,t){return(t=t||{}).raw=!0,c(e,t)},r.ungzip=c},{"./utils/common":27,"./utils/strings":28,"./zlib/constants":30,"./zlib/gzheader":33,"./zlib/inflate.js":35,"./zlib/messages":37,"./zlib/zstream":39}],27:[function(e,t,r){var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;r.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])}}return e},r.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var i={arraySet:function(e,t,r,n,i){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+n),i);else for(var s=0;s<n;s++)e[i+s]=t[r+s]},flattenChunks:function(e){var t,r,n,i,s,o;for(n=0,t=0,r=e.length;t<r;t++)n+=e[t].length;for(o=new Uint8Array(n),i=0,t=0,r=e.length;t<r;t++)s=e[t],o.set(s,i),i+=s.length;return o}},s={arraySet:function(e,t,r,n,i){for(var s=0;s<n;s++)e[i+s]=t[r+s]},flattenChunks:function(e){return[].concat.apply([],e)}};r.setTyped=function(e){e?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,i)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,s))},r.setTyped(n)},{}],28:[function(e,t,r){var n=e("./common"),i=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch(e){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){s=!1}for(var o=new n.Buf8(256),a=0;a<256;a++)o[a]=a>=252?6:a>=248?5:a>=240?4:a>=224?3:a>=192?2:1;function l(e,t){if(t<65537&&(e.subarray&&s||!e.subarray&&i))return String.fromCharCode.apply(null,n.shrinkBuf(e,t));for(var r="",o=0;o<t;o++)r+=String.fromCharCode(e[o]);return r}o[254]=o[254]=1,r.string2buf=function(e){var t,r,i,s,o,a=e.length,l=0;for(s=0;s<a;s++)55296==(64512&(r=e.charCodeAt(s)))&&s+1<a&&56320==(64512&(i=e.charCodeAt(s+1)))&&(r=65536+(r-55296<<10)+(i-56320),s++),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=new n.Buf8(l),o=0,s=0;o<l;s++)55296==(64512&(r=e.charCodeAt(s)))&&s+1<a&&56320==(64512&(i=e.charCodeAt(s+1)))&&(r=65536+(r-55296<<10)+(i-56320),s++),r<128?t[o++]=r:r<2048?(t[o++]=192|r>>>6,t[o++]=128|63&r):r<65536?(t[o++]=224|r>>>12,t[o++]=128|r>>>6&63,t[o++]=128|63&r):(t[o++]=240|r>>>18,t[o++]=128|r>>>12&63,t[o++]=128|r>>>6&63,t[o++]=128|63&r);return t},r.buf2binstring=function(e){return l(e,e.length)},r.binstring2buf=function(e){for(var t=new n.Buf8(e.length),r=0,i=t.length;r<i;r++)t[r]=e.charCodeAt(r);return t},r.buf2string=function(e,t){var r,n,i,s,a=t||e.length,h=new Array(2*a);for(n=0,r=0;r<a;)if((i=e[r++])<128)h[n++]=i;else if((s=o[i])>4)h[n++]=65533,r+=s-1;else{for(i&=2===s?31:3===s?15:7;s>1&&r<a;)i=i<<6|63&e[r++],s--;s>1?h[n++]=65533:i<65536?h[n++]=i:(i-=65536,h[n++]=55296|i>>10&1023,h[n++]=56320|1023&i)}return l(h,n)},r.utf8border=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;r>=0&&128==(192&e[r]);)r--;return r<0||0===r?t:r+o[e[r]]>t?r:t}},{"./common":27}],29:[function(e,t,r){t.exports=function(e,t,r,n){for(var i=65535&e|0,s=e>>>16&65535|0,o=0;0!==r;){r-=o=r>2e3?2e3:r;do{s=s+(i=i+t[n++]|0)|0}while(--o);i%=65521,s%=65521}return i|s<<16|0}},{}],30:[function(e,t,r){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],31:[function(e,t,r){var n=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();t.exports=function(e,t,r,i){var s=n,o=i+r;e^=-1;for(var a=i;a<o;a++)e=e>>>8^s[255&(e^t[a])];return-1^e}},{}],32:[function(e,t,r){var n=e("../utils/common"),i=e("./trees"),s=e("./adler32"),o=e("./crc32"),a=e("./messages"),l=-2,h=258,u=262,c=103,d=113,f=666;function p(e,t){return e.msg=a[t],t}function m(e){return(e<<1)-(e>4?9:0)}function _(e){for(var t=e.length;--t>=0;)e[t]=0}function g(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(n.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))}function v(e,t){i._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,g(e.strm)}function y(e,t){e.pending_buf[e.pending++]=t}function b(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function x(e,t){var r,n,i=e.max_chain_length,s=e.strstart,o=e.prev_length,a=e.nice_match,l=e.strstart>e.w_size-u?e.strstart-(e.w_size-u):0,c=e.window,d=e.w_mask,f=e.prev,p=e.strstart+h,m=c[s+o-1],_=c[s+o];e.prev_length>=e.good_match&&(i>>=2),a>e.lookahead&&(a=e.lookahead);do{if(c[(r=t)+o]===_&&c[r+o-1]===m&&c[r]===c[s]&&c[++r]===c[s+1]){s+=2,r++;do{}while(c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&s<p);if(n=h-(p-s),s=p-h,n>o){if(e.match_start=t,o=n,n>=a)break;m=c[s+o-1],_=c[s+o]}}}while((t=f[t&d])>l&&0!=--i);return o<=e.lookahead?o:e.lookahead}function S(e){var t,r,i,a,l,h,c,d,f,p,m=e.w_size;do{if(a=e.window_size-e.lookahead-e.strstart,e.strstart>=m+(m-u)){n.arraySet(e.window,e.window,m,m,0),e.match_start-=m,e.strstart-=m,e.block_start-=m,t=r=e.hash_size;do{i=e.head[--t],e.head[t]=i>=m?i-m:0}while(--r);t=r=m;do{i=e.prev[--t],e.prev[t]=i>=m?i-m:0}while(--r);a+=m}if(0===e.strm.avail_in)break;if(h=e.strm,c=e.window,d=e.strstart+e.lookahead,f=a,p=void 0,(p=h.avail_in)>f&&(p=f),r=0===p?0:(h.avail_in-=p,n.arraySet(c,h.input,h.next_in,p,d),1===h.state.wrap?h.adler=s(h.adler,c,p,d):2===h.state.wrap&&(h.adler=o(h.adler,c,p,d)),h.next_in+=p,h.total_in+=p,p),e.lookahead+=r,e.lookahead+e.insert>=3)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+3-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<u&&0!==e.strm.avail_in)}function T(e,t){for(var r,n;;){if(e.lookahead<u){if(S(e),e.lookahead<u&&0===t)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-u&&(e.match_length=x(e,r)),e.match_length>=3)if(n=i._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else n=i._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(v(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(v(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(v(e,!1),0===e.strm.avail_out)?1:2}function E(e,t){for(var r,n,s;;){if(e.lookahead<u){if(S(e),e.lookahead<u&&0===t)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-u&&(e.match_length=x(e,r),e.match_length<=5&&(1===e.strategy||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){s=e.strstart+e.lookahead-3,n=i._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=s&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,n&&(v(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((n=i._tr_tally(e,0,e.window[e.strstart-1]))&&v(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=i._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(v(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(v(e,!1),0===e.strm.avail_out)?1:2}var A,w=function(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i};function C(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new n.Buf16(1146),this.dyn_dtree=new n.Buf16(122),this.bl_tree=new n.Buf16(78),_(this.dyn_ltree),_(this.dyn_dtree),_(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new n.Buf16(16),this.heap=new n.Buf16(573),_(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new n.Buf16(573),_(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function O(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:d,e.adler=2===t.wrap?0:1,t.last_flush=0,i._tr_init(t),0):p(e,l)}function R(e){var t,r=O(e);return 0===r&&((t=e.state).window_size=2*t.w_size,_(t.head),t.max_lazy_match=A[t.level].max_lazy,t.good_match=A[t.level].good_length,t.nice_match=A[t.level].nice_length,t.max_chain_length=A[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),r}function D(e,t,r,i,s,o){if(!e)return l;var a=1;if(-1===t&&(t=6),i<0?(a=0,i=-i):i>15&&(a=2,i-=16),s<1||s>9||8!==r||i<8||i>15||t<0||t>9||o<0||o>4)return p(e,l);8===i&&(i=9);var h=new C;return e.state=h,h.strm=e,h.wrap=a,h.gzhead=null,h.w_bits=i,h.w_size=1<<h.w_bits,h.w_mask=h.w_size-1,h.hash_bits=s+7,h.hash_size=1<<h.hash_bits,h.hash_mask=h.hash_size-1,h.hash_shift=~~((h.hash_bits+3-1)/3),h.window=new n.Buf8(2*h.w_size),h.head=new n.Buf16(h.hash_size),h.prev=new n.Buf16(h.w_size),h.lit_bufsize=1<<s+6,h.pending_buf_size=4*h.lit_bufsize,h.pending_buf=new n.Buf8(h.pending_buf_size),h.d_buf=h.lit_bufsize>>1,h.l_buf=3*h.lit_bufsize,h.level=t,h.strategy=o,h.method=r,R(e)}A=[new w(0,0,0,0,(function(e,t){var r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(S(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var n=e.block_start+r;if((0===e.strstart||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,v(e,!1),0===e.strm.avail_out)||e.strstart-e.block_start>=e.w_size-u&&(v(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(v(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(v(e,!1),e.strm.avail_out),1)})),new w(4,4,8,4,T),new w(4,5,16,8,T),new w(4,6,32,32,T),new w(4,4,16,16,E),new w(8,16,32,32,E),new w(8,16,128,128,E),new w(8,32,128,256,E),new w(32,128,258,1024,E),new w(32,258,258,4096,E)],r.deflateInit=function(e,t){return D(e,t,8,15,8,0)},r.deflateInit2=D,r.deflateReset=R,r.deflateResetKeep=O,r.deflateSetHeader=function(e,t){return e&&e.state&&2===e.state.wrap?(e.state.gzhead=t,0):l},r.deflate=function(e,t){var r,n,s,a;if(!e||!e.state||t>5||t<0)return e?p(e,l):l;if(n=e.state,!e.output||!e.input&&0!==e.avail_in||n.status===f&&4!==t)return p(e,0===e.avail_out?-5:l);if(n.strm=e,r=n.last_flush,n.last_flush=t,42===n.status)if(2===n.wrap)e.adler=0,y(n,31),y(n,139),y(n,8),n.gzhead?(y(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),y(n,255&n.gzhead.time),y(n,n.gzhead.time>>8&255),y(n,n.gzhead.time>>16&255),y(n,n.gzhead.time>>24&255),y(n,9===n.level?2:n.strategy>=2||n.level<2?4:0),y(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(y(n,255&n.gzhead.extra.length),y(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=o(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(y(n,0),y(n,0),y(n,0),y(n,0),y(n,0),y(n,9===n.level?2:n.strategy>=2||n.level<2?4:0),y(n,3),n.status=d);else{var u=8+(n.w_bits-8<<4)<<8;u|=(n.strategy>=2||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(u|=32),u+=31-u%31,n.status=d,b(n,u),0!==n.strstart&&(b(n,e.adler>>>16),b(n,65535&e.adler)),e.adler=1}if(69===n.status)if(n.gzhead.extra){for(s=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>s&&(e.adler=o(e.adler,n.pending_buf,n.pending-s,s)),g(e),s=n.pending,n.pending!==n.pending_buf_size));)y(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>s&&(e.adler=o(e.adler,n.pending_buf,n.pending-s,s)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73;if(73===n.status)if(n.gzhead.name){s=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>s&&(e.adler=o(e.adler,n.pending_buf,n.pending-s,s)),g(e),s=n.pending,n.pending===n.pending_buf_size)){a=1;break}a=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,y(n,a)}while(0!==a);n.gzhead.hcrc&&n.pending>s&&(e.adler=o(e.adler,n.pending_buf,n.pending-s,s)),0===a&&(n.gzindex=0,n.status=91)}else n.status=91;if(91===n.status)if(n.gzhead.comment){s=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>s&&(e.adler=o(e.adler,n.pending_buf,n.pending-s,s)),g(e),s=n.pending,n.pending===n.pending_buf_size)){a=1;break}a=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,y(n,a)}while(0!==a);n.gzhead.hcrc&&n.pending>s&&(e.adler=o(e.adler,n.pending_buf,n.pending-s,s)),0===a&&(n.status=c)}else n.status=c;if(n.status===c&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&g(e),n.pending+2<=n.pending_buf_size&&(y(n,255&e.adler),y(n,e.adler>>8&255),e.adler=0,n.status=d)):n.status=d),0!==n.pending){if(g(e),0===e.avail_out)return n.last_flush=-1,0}else if(0===e.avail_in&&m(t)<=m(r)&&4!==t)return p(e,-5);if(n.status===f&&0!==e.avail_in)return p(e,-5);if(0!==e.avail_in||0!==n.lookahead||0!==t&&n.status!==f){var x=2===n.strategy?function(e,t){for(var r;;){if(0===e.lookahead&&(S(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,r=i._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(v(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(v(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(v(e,!1),0===e.strm.avail_out)?1:2}(n,t):3===n.strategy?function(e,t){for(var r,n,s,o,a=e.window;;){if(e.lookahead<=h){if(S(e),e.lookahead<=h&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(n=a[s=e.strstart-1])===a[++s]&&n===a[++s]&&n===a[++s]){o=e.strstart+h;do{}while(n===a[++s]&&n===a[++s]&&n===a[++s]&&n===a[++s]&&n===a[++s]&&n===a[++s]&&n===a[++s]&&n===a[++s]&&s<o);e.match_length=h-(o-s),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(r=i._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=i._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(v(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(v(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(v(e,!1),0===e.strm.avail_out)?1:2}(n,t):A[n.level].func(n,t);if((3===x||4===x)&&(n.status=f),1===x||3===x)return 0===e.avail_out&&(n.last_flush=-1),0;if(2===x&&(1===t?i._tr_align(n):5!==t&&(i._tr_stored_block(n,0,0,!1),3===t&&(_(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),g(e),0===e.avail_out))return n.last_flush=-1,0}return 4!==t?0:n.wrap<=0?1:(2===n.wrap?(y(n,255&e.adler),y(n,e.adler>>8&255),y(n,e.adler>>16&255),y(n,e.adler>>24&255),y(n,255&e.total_in),y(n,e.total_in>>8&255),y(n,e.total_in>>16&255),y(n,e.total_in>>24&255)):(b(n,e.adler>>>16),b(n,65535&e.adler)),g(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?0:1)},r.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&t!==c&&t!==d&&t!==f?p(e,l):(e.state=null,t===d?p(e,-3):0):l},r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./messages":37,"./trees":38}],33:[function(e,t,r){t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],34:[function(e,t,r){t.exports=function(e,t){var r,n,i,s,o,a,l,h,u,c,d,f,p,m,_,g,v,y,b,x,S,T,E,A,w;r=e.state,n=e.next_in,A=e.input,i=n+(e.avail_in-5),s=e.next_out,w=e.output,o=s-(t-e.avail_out),a=s+(e.avail_out-257),l=r.dmax,h=r.wsize,u=r.whave,c=r.wnext,d=r.window,f=r.hold,p=r.bits,m=r.lencode,_=r.distcode,g=(1<<r.lenbits)-1,v=(1<<r.distbits)-1;e:do{p<15&&(f+=A[n++]<<p,p+=8,f+=A[n++]<<p,p+=8),y=m[f&g];t:for(;;){if(f>>>=b=y>>>24,p-=b,0==(b=y>>>16&255))w[s++]=65535&y;else{if(!(16&b)){if(0==(64&b)){y=m[(65535&y)+(f&(1<<b)-1)];continue t}if(32&b){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}x=65535&y,(b&=15)&&(p<b&&(f+=A[n++]<<p,p+=8),x+=f&(1<<b)-1,f>>>=b,p-=b),p<15&&(f+=A[n++]<<p,p+=8,f+=A[n++]<<p,p+=8),y=_[f&v];r:for(;;){if(f>>>=b=y>>>24,p-=b,!(16&(b=y>>>16&255))){if(0==(64&b)){y=_[(65535&y)+(f&(1<<b)-1)];continue r}e.msg="invalid distance code",r.mode=30;break e}if(S=65535&y,p<(b&=15)&&(f+=A[n++]<<p,(p+=8)<b&&(f+=A[n++]<<p,p+=8)),(S+=f&(1<<b)-1)>l){e.msg="invalid distance too far back",r.mode=30;break e}if(f>>>=b,p-=b,S>(b=s-o)){if((b=S-b)>u&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(T=0,E=d,0===c){if(T+=h-b,b<x){x-=b;do{w[s++]=d[T++]}while(--b);T=s-S,E=w}}else if(c<b){if(T+=h+c-b,(b-=c)<x){x-=b;do{w[s++]=d[T++]}while(--b);if(T=0,c<x){x-=b=c;do{w[s++]=d[T++]}while(--b);T=s-S,E=w}}}else if(T+=c-b,b<x){x-=b;do{w[s++]=d[T++]}while(--b);T=s-S,E=w}for(;x>2;)w[s++]=E[T++],w[s++]=E[T++],w[s++]=E[T++],x-=3;x&&(w[s++]=E[T++],x>1&&(w[s++]=E[T++]))}else{T=s-S;do{w[s++]=w[T++],w[s++]=w[T++],w[s++]=w[T++],x-=3}while(x>2);x&&(w[s++]=w[T++],x>1&&(w[s++]=w[T++]))}break}}break}}while(n<i&&s<a);n-=x=p>>3,f&=(1<<(p-=x<<3))-1,e.next_in=n,e.next_out=s,e.avail_in=n<i?i-n+5:5-(n-i),e.avail_out=s<a?a-s+257:257-(s-a),r.hold=f,r.bits=p}},{}],35:[function(e,t,r){var n=e("../utils/common"),i=e("./adler32"),s=e("./crc32"),o=e("./inffast"),a=e("./inftrees"),l=-2,h=12,u=30;function c(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function d(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function f(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new n.Buf32(852),t.distcode=t.distdyn=new n.Buf32(592),t.sane=1,t.back=-1,0):l}function p(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,f(e)):l}function m(e,t){var r,n;return!e||!e.state||(n=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15))?l:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,p(e))}function _(e,t){var r,n;return e?(n=new d,e.state=n,n.window=null,0!==(r=m(e,t))&&(e.state=null),r):l}var g,v,y=!0;function b(e){if(y){var t;for(g=new n.Buf32(512),v=new n.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(a(1,e.lens,0,288,g,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;a(2,e.lens,0,32,v,0,e.work,{bits:5}),y=!1}e.lencode=g,e.lenbits=9,e.distcode=v,e.distbits=5}r.inflateReset=p,r.inflateReset2=m,r.inflateResetKeep=f,r.inflateInit=function(e){return _(e,15)},r.inflateInit2=_,r.inflate=function(e,t){var r,d,f,p,m,_,g,v,y,x,S,T,E,A,w,C,O,R,D,I,M,N,P,k,F=0,L=new n.Buf8(4),B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return l;(r=e.state).mode===h&&(r.mode=13),m=e.next_out,f=e.output,g=e.avail_out,p=e.next_in,d=e.input,_=e.avail_in,v=r.hold,y=r.bits,x=_,S=g,N=0;e:for(;;)switch(r.mode){case 1:if(0===r.wrap){r.mode=13;break}for(;y<16;){if(0===_)break e;_--,v+=d[p++]<<y,y+=8}if(2&r.wrap&&35615===v){r.check=0,L[0]=255&v,L[1]=v>>>8&255,r.check=s(r.check,L,2,0),v=0,y=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&v)<<8)+(v>>8))%31){e.msg="incorrect header check",r.mode=u;break}if(8!=(15&v)){e.msg="unknown compression method",r.mode=u;break}if(y-=4,M=8+(15&(v>>>=4)),0===r.wbits)r.wbits=M;else if(M>r.wbits){e.msg="invalid window size",r.mode=u;break}r.dmax=1<<M,e.adler=r.check=1,r.mode=512&v?10:h,v=0,y=0;break;case 2:for(;y<16;){if(0===_)break e;_--,v+=d[p++]<<y,y+=8}if(r.flags=v,8!=(255&r.flags)){e.msg="unknown compression method",r.mode=u;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=u;break}r.head&&(r.head.text=v>>8&1),512&r.flags&&(L[0]=255&v,L[1]=v>>>8&255,r.check=s(r.check,L,2,0)),v=0,y=0,r.mode=3;case 3:for(;y<32;){if(0===_)break e;_--,v+=d[p++]<<y,y+=8}r.head&&(r.head.time=v),512&r.flags&&(L[0]=255&v,L[1]=v>>>8&255,L[2]=v>>>16&255,L[3]=v>>>24&255,r.check=s(r.check,L,4,0)),v=0,y=0,r.mode=4;case 4:for(;y<16;){if(0===_)break e;_--,v+=d[p++]<<y,y+=8}r.head&&(r.head.xflags=255&v,r.head.os=v>>8),512&r.flags&&(L[0]=255&v,L[1]=v>>>8&255,r.check=s(r.check,L,2,0)),v=0,y=0,r.mode=5;case 5:if(1024&r.flags){for(;y<16;){if(0===_)break e;_--,v+=d[p++]<<y,y+=8}r.length=v,r.head&&(r.head.extra_len=v),512&r.flags&&(L[0]=255&v,L[1]=v>>>8&255,r.check=s(r.check,L,2,0)),v=0,y=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&((T=r.length)>_&&(T=_),T&&(r.head&&(M=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),n.arraySet(r.head.extra,d,p,T,M)),512&r.flags&&(r.check=s(r.check,d,T,p)),_-=T,p+=T,r.length-=T),r.length))break e;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===_)break e;T=0;do{M=d[p+T++],r.head&&M&&r.length<65536&&(r.head.name+=String.fromCharCode(M))}while(M&&T<_);if(512&r.flags&&(r.check=s(r.check,d,T,p)),_-=T,p+=T,M)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===_)break e;T=0;do{M=d[p+T++],r.head&&M&&r.length<65536&&(r.head.comment+=String.fromCharCode(M))}while(M&&T<_);if(512&r.flags&&(r.check=s(r.check,d,T,p)),_-=T,p+=T,M)break e}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;y<16;){if(0===_)break e;_--,v+=d[p++]<<y,y+=8}if(v!==(65535&r.check)){e.msg="header crc mismatch",r.mode=u;break}v=0,y=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=h;break;case 10:for(;y<32;){if(0===_)break e;_--,v+=d[p++]<<y,y+=8}e.adler=r.check=c(v),v=0,y=0,r.mode=11;case 11:if(0===r.havedict)return e.next_out=m,e.avail_out=g,e.next_in=p,e.avail_in=_,r.hold=v,r.bits=y,2;e.adler=r.check=1,r.mode=h;case h:if(5===t||6===t)break e;case 13:if(r.last){v>>>=7&y,y-=7&y,r.mode=27;break}for(;y<3;){if(0===_)break e;_--,v+=d[p++]<<y,y+=8}switch(r.last=1&v,y-=1,3&(v>>>=1)){case 0:r.mode=14;break;case 1:if(b(r),r.mode=20,6===t){v>>>=2,y-=2;break e}break;case 2:r.mode=17;break;case 3:e.msg="invalid block type",r.mode=u}v>>>=2,y-=2;break;case 14:for(v>>>=7&y,y-=7&y;y<32;){if(0===_)break e;_--,v+=d[p++]<<y,y+=8}if((65535&v)!=(v>>>16^65535)){e.msg="invalid stored block lengths",r.mode=u;break}if(r.length=65535&v,v=0,y=0,r.mode=15,6===t)break e;case 15:r.mode=16;case 16:if(T=r.length){if(T>_&&(T=_),T>g&&(T=g),0===T)break e;n.arraySet(f,d,p,T,m),_-=T,p+=T,g-=T,m+=T,r.length-=T;break}r.mode=h;break;case 17:for(;y<14;){if(0===_)break e;_--,v+=d[p++]<<y,y+=8}if(r.nlen=257+(31&v),v>>>=5,y-=5,r.ndist=1+(31&v),v>>>=5,y-=5,r.ncode=4+(15&v),v>>>=4,y-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=u;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;y<3;){if(0===_)break e;_--,v+=d[p++]<<y,y+=8}r.lens[B[r.have++]]=7&v,v>>>=3,y-=3}for(;r.have<19;)r.lens[B[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,P={bits:r.lenbits},N=a(0,r.lens,0,19,r.lencode,0,r.work,P),r.lenbits=P.bits,N){e.msg="invalid code lengths set",r.mode=u;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;C=(F=r.lencode[v&(1<<r.lenbits)-1])>>>16&255,O=65535&F,!((w=F>>>24)<=y);){if(0===_)break e;_--,v+=d[p++]<<y,y+=8}if(O<16)v>>>=w,y-=w,r.lens[r.have++]=O;else{if(16===O){for(k=w+2;y<k;){if(0===_)break e;_--,v+=d[p++]<<y,y+=8}if(v>>>=w,y-=w,0===r.have){e.msg="invalid bit length repeat",r.mode=u;break}M=r.lens[r.have-1],T=3+(3&v),v>>>=2,y-=2}else if(17===O){for(k=w+3;y<k;){if(0===_)break e;_--,v+=d[p++]<<y,y+=8}y-=w,M=0,T=3+(7&(v>>>=w)),v>>>=3,y-=3}else{for(k=w+7;y<k;){if(0===_)break e;_--,v+=d[p++]<<y,y+=8}y-=w,M=0,T=11+(127&(v>>>=w)),v>>>=7,y-=7}if(r.have+T>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=u;break}for(;T--;)r.lens[r.have++]=M}}if(r.mode===u)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=u;break}if(r.lenbits=9,P={bits:r.lenbits},N=a(1,r.lens,0,r.nlen,r.lencode,0,r.work,P),r.lenbits=P.bits,N){e.msg="invalid literal/lengths set",r.mode=u;break}if(r.distbits=6,r.distcode=r.distdyn,P={bits:r.distbits},N=a(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,P),r.distbits=P.bits,N){e.msg="invalid distances set",r.mode=u;break}if(r.mode=20,6===t)break e;case 20:r.mode=21;case 21:if(_>=6&&g>=258){e.next_out=m,e.avail_out=g,e.next_in=p,e.avail_in=_,r.hold=v,r.bits=y,o(e,S),m=e.next_out,f=e.output,g=e.avail_out,p=e.next_in,d=e.input,_=e.avail_in,v=r.hold,y=r.bits,r.mode===h&&(r.back=-1);break}for(r.back=0;C=(F=r.lencode[v&(1<<r.lenbits)-1])>>>16&255,O=65535&F,!((w=F>>>24)<=y);){if(0===_)break e;_--,v+=d[p++]<<y,y+=8}if(C&&0==(240&C)){for(R=w,D=C,I=O;C=(F=r.lencode[I+((v&(1<<R+D)-1)>>R)])>>>16&255,O=65535&F,!(R+(w=F>>>24)<=y);){if(0===_)break e;_--,v+=d[p++]<<y,y+=8}v>>>=R,y-=R,r.back+=R}if(v>>>=w,y-=w,r.back+=w,r.length=O,0===C){r.mode=26;break}if(32&C){r.back=-1,r.mode=h;break}if(64&C){e.msg="invalid literal/length code",r.mode=u;break}r.extra=15&C,r.mode=22;case 22:if(r.extra){for(k=r.extra;y<k;){if(0===_)break e;_--,v+=d[p++]<<y,y+=8}r.length+=v&(1<<r.extra)-1,v>>>=r.extra,y-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;C=(F=r.distcode[v&(1<<r.distbits)-1])>>>16&255,O=65535&F,!((w=F>>>24)<=y);){if(0===_)break e;_--,v+=d[p++]<<y,y+=8}if(0==(240&C)){for(R=w,D=C,I=O;C=(F=r.distcode[I+((v&(1<<R+D)-1)>>R)])>>>16&255,O=65535&F,!(R+(w=F>>>24)<=y);){if(0===_)break e;_--,v+=d[p++]<<y,y+=8}v>>>=R,y-=R,r.back+=R}if(v>>>=w,y-=w,r.back+=w,64&C){e.msg="invalid distance code",r.mode=u;break}r.offset=O,r.extra=15&C,r.mode=24;case 24:if(r.extra){for(k=r.extra;y<k;){if(0===_)break e;_--,v+=d[p++]<<y,y+=8}r.offset+=v&(1<<r.extra)-1,v>>>=r.extra,y-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=u;break}r.mode=25;case 25:if(0===g)break e;if(T=S-g,r.offset>T){if((T=r.offset-T)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=u;break}T>r.wnext?(T-=r.wnext,E=r.wsize-T):E=r.wnext-T,T>r.length&&(T=r.length),A=r.window}else A=f,E=m-r.offset,T=r.length;T>g&&(T=g),g-=T,r.length-=T;do{f[m++]=A[E++]}while(--T);0===r.length&&(r.mode=21);break;case 26:if(0===g)break e;f[m++]=r.length,g--,r.mode=21;break;case 27:if(r.wrap){for(;y<32;){if(0===_)break e;_--,v|=d[p++]<<y,y+=8}if(S-=g,e.total_out+=S,r.total+=S,S&&(e.adler=r.check=r.flags?s(r.check,f,S,m-S):i(r.check,f,S,m-S)),S=g,(r.flags?v:c(v))!==r.check){e.msg="incorrect data check",r.mode=u;break}v=0,y=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;y<32;){if(0===_)break e;_--,v+=d[p++]<<y,y+=8}if(v!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=u;break}v=0,y=0}r.mode=29;case 29:N=1;break e;case u:N=-3;break e;case 31:return-4;default:return l}return e.next_out=m,e.avail_out=g,e.next_in=p,e.avail_in=_,r.hold=v,r.bits=y,(r.wsize||S!==e.avail_out&&r.mode<u&&(r.mode<27||4!==t))&&function(e,t,r,i){var s,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new n.Buf8(o.wsize)),i>=o.wsize?(n.arraySet(o.window,t,r-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):((s=o.wsize-o.wnext)>i&&(s=i),n.arraySet(o.window,t,r-i,s,o.wnext),(i-=s)?(n.arraySet(o.window,t,r-i,i,0),o.wnext=i,o.whave=o.wsize):(o.wnext+=s,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=s))),0}(e,e.output,e.next_out,S-e.avail_out)?(r.mode=31,-4):(x-=e.avail_in,S-=e.avail_out,e.total_in+=x,e.total_out+=S,r.total+=S,r.wrap&&S&&(e.adler=r.check=r.flags?s(r.check,f,S,e.next_out-S):i(r.check,f,S,e.next_out-S)),e.data_type=r.bits+(r.last?64:0)+(r.mode===h?128:0)+(20===r.mode||15===r.mode?256:0),(0===x&&0===S||4===t)&&0===N&&(N=-5),N)},r.inflateEnd=function(e){if(!e||!e.state)return l;var t=e.state;return t.window&&(t.window=null),e.state=null,0},r.inflateGetHeader=function(e,t){var r;return e&&e.state&&0!=(2&(r=e.state).wrap)?(r.head=t,t.done=!1,0):l},r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./inffast":34,"./inftrees":36}],36:[function(e,t,r){var n=e("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],a=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,r,l,h,u,c,d){var f,p,m,_,g,v,y,b,x,S=d.bits,T=0,E=0,A=0,w=0,C=0,O=0,R=0,D=0,I=0,M=0,N=null,P=0,k=new n.Buf16(16),F=new n.Buf16(16),L=null,B=0;for(T=0;T<=15;T++)k[T]=0;for(E=0;E<l;E++)k[t[r+E]]++;for(C=S,w=15;w>=1&&0===k[w];w--);if(C>w&&(C=w),0===w)return h[u++]=20971520,h[u++]=20971520,d.bits=1,0;for(A=1;A<w&&0===k[A];A++);for(C<A&&(C=A),D=1,T=1;T<=15;T++)if(D<<=1,(D-=k[T])<0)return-1;if(D>0&&(0===e||1!==w))return-1;for(F[1]=0,T=1;T<15;T++)F[T+1]=F[T]+k[T];for(E=0;E<l;E++)0!==t[r+E]&&(c[F[t[r+E]]++]=E);if(0===e?(N=L=c,v=19):1===e?(N=i,P-=257,L=s,B-=257,v=256):(N=o,L=a,v=-1),M=0,E=0,T=A,g=u,O=C,R=0,m=-1,_=(I=1<<C)-1,1===e&&I>852||2===e&&I>592)return 1;for(;;){y=T-R,c[E]<v?(b=0,x=c[E]):c[E]>v?(b=L[B+c[E]],x=N[P+c[E]]):(b=96,x=0),f=1<<T-R,A=p=1<<O;do{h[g+(M>>R)+(p-=f)]=y<<24|b<<16|x|0}while(0!==p);for(f=1<<T-1;M&f;)f>>=1;if(0!==f?(M&=f-1,M+=f):M=0,E++,0==--k[T]){if(T===w)break;T=t[r+c[E]]}if(T>C&&(M&_)!==m){for(0===R&&(R=C),g+=A,D=1<<(O=T-R);O+R<w&&!((D-=k[O+R])<=0);)O++,D<<=1;if(I+=1<<O,1===e&&I>852||2===e&&I>592)return 1;h[m=M&_]=C<<24|O<<16|g-u|0}}return 0!==M&&(h[g+M]=T-R<<24|64<<16|0),d.bits=C,0}},{"../utils/common":27}],37:[function(e,t,r){t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],38:[function(e,t,r){var n=e("../utils/common");function i(e){for(var t=e.length;--t>=0;)e[t]=0}var s=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],o=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],l=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],h=new Array(576);i(h);var u=new Array(60);i(u);var c=new Array(512);i(c);var d=new Array(256);i(d);var f=new Array(29);i(f);var p=new Array(30);i(p);var m,_,g,v=function(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length},y=function(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t};function b(e){return e<256?c[e]:c[256+(e>>>7)]}function x(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function S(e,t,r){e.bi_valid>16-r?(e.bi_buf|=t<<e.bi_valid&65535,x(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=r-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function T(e,t,r){S(e,r[2*t],r[2*t+1])}function E(e,t){var r=0;do{r|=1&e,e>>>=1,r<<=1}while(--t>0);return r>>>1}function A(e,t,r){var n,i,s=new Array(16),o=0;for(n=1;n<=15;n++)s[n]=o=o+r[n-1]<<1;for(i=0;i<=t;i++){var a=e[2*i+1];0!==a&&(e[2*i]=E(s[a]++,a))}}function w(e){var t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function C(e){e.bi_valid>8?x(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function O(e,t,r,n){var i=2*t,s=2*r;return e[i]<e[s]||e[i]===e[s]&&n[t]<=n[r]}function R(e,t,r){for(var n=e.heap[r],i=r<<1;i<=e.heap_len&&(i<e.heap_len&&O(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!O(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n}function D(e,t,r){var n,i,a,l,h=0;if(0!==e.last_lit)do{n=e.pending_buf[e.d_buf+2*h]<<8|e.pending_buf[e.d_buf+2*h+1],i=e.pending_buf[e.l_buf+h],h++,0===n?T(e,i,t):(T(e,(a=d[i])+256+1,t),0!==(l=s[a])&&S(e,i-=f[a],l),T(e,a=b(--n),r),0!==(l=o[a])&&S(e,n-=p[a],l))}while(h<e.last_lit);T(e,256,t)}function I(e,t){var r,n,i,s=t.dyn_tree,o=t.stat_desc.static_tree,a=t.stat_desc.has_stree,l=t.stat_desc.elems,h=-1;for(e.heap_len=0,e.heap_max=573,r=0;r<l;r++)0!==s[2*r]?(e.heap[++e.heap_len]=h=r,e.depth[r]=0):s[2*r+1]=0;for(;e.heap_len<2;)s[2*(i=e.heap[++e.heap_len]=h<2?++h:0)]=1,e.depth[i]=0,e.opt_len--,a&&(e.static_len-=o[2*i+1]);for(t.max_code=h,r=e.heap_len>>1;r>=1;r--)R(e,s,r);i=l;do{r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],R(e,s,1),n=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=n,s[2*i]=s[2*r]+s[2*n],e.depth[i]=(e.depth[r]>=e.depth[n]?e.depth[r]:e.depth[n])+1,s[2*r+1]=s[2*n+1]=i,e.heap[1]=i++,R(e,s,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var r,n,i,s,o,a,l=t.dyn_tree,h=t.max_code,u=t.stat_desc.static_tree,c=t.stat_desc.has_stree,d=t.stat_desc.extra_bits,f=t.stat_desc.extra_base,p=t.stat_desc.max_length,m=0;for(s=0;s<=15;s++)e.bl_count[s]=0;for(l[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<573;r++)(s=l[2*l[2*(n=e.heap[r])+1]+1]+1)>p&&(s=p,m++),l[2*n+1]=s,!(n>h)&&(e.bl_count[s]++,o=0,n>=f&&(o=d[n-f]),a=l[2*n],e.opt_len+=a*(s+o),c&&(e.static_len+=a*(u[2*n+1]+o)));if(0!==m){do{for(s=p-1;0===e.bl_count[s];)s--;e.bl_count[s]--,e.bl_count[s+1]+=2,e.bl_count[p]--,m-=2}while(m>0);for(s=p;0!==s;s--)for(n=e.bl_count[s];0!==n;)!((i=e.heap[--r])>h)&&(l[2*i+1]!==s&&(e.opt_len+=(s-l[2*i+1])*l[2*i],l[2*i+1]=s),n--)}}(e,t),A(s,h,e.bl_count)}function M(e,t,r){var n,i,s=-1,o=t[1],a=0,l=7,h=4;for(0===o&&(l=138,h=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)i=o,o=t[2*(n+1)+1],!(++a<l&&i===o)&&(a<h?e.bl_tree[2*i]+=a:0!==i?(i!==s&&e.bl_tree[2*i]++,e.bl_tree[32]++):a<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=0,s=i,0===o?(l=138,h=3):i===o?(l=6,h=3):(l=7,h=4))}function N(e,t,r){var n,i,s=-1,o=t[1],a=0,l=7,h=4;for(0===o&&(l=138,h=3),n=0;n<=r;n++)if(i=o,o=t[2*(n+1)+1],!(++a<l&&i===o)){if(a<h)do{T(e,i,e.bl_tree)}while(0!=--a);else 0!==i?(i!==s&&(T(e,i,e.bl_tree),a--),T(e,16,e.bl_tree),S(e,a-3,2)):a<=10?(T(e,17,e.bl_tree),S(e,a-3,3)):(T(e,18,e.bl_tree),S(e,a-11,7));a=0,s=i,0===o?(l=138,h=3):i===o?(l=6,h=3):(l=7,h=4)}}var P=!1;function k(e,t,r,i){S(e,0+(i?1:0),3),function(e,t,r,i){C(e),x(e,r),x(e,~r),n.arraySet(e.pending_buf,e.window,t,r,e.pending),e.pending+=r}(e,t,r)}r._tr_init=function(e){P||(function(){var e,t,r,n,i,l=new Array(16);for(r=0,n=0;n<28;n++)for(f[n]=r,e=0;e<1<<s[n];e++)d[r++]=n;for(d[r-1]=n,i=0,n=0;n<16;n++)for(p[n]=i,e=0;e<1<<o[n];e++)c[i++]=n;for(i>>=7;n<30;n++)for(p[n]=i<<7,e=0;e<1<<o[n]-7;e++)c[256+i++]=n;for(t=0;t<=15;t++)l[t]=0;for(e=0;e<=143;)h[2*e+1]=8,e++,l[8]++;for(;e<=255;)h[2*e+1]=9,e++,l[9]++;for(;e<=279;)h[2*e+1]=7,e++,l[7]++;for(;e<=287;)h[2*e+1]=8,e++,l[8]++;for(A(h,287,l),e=0;e<30;e++)u[2*e+1]=5,u[2*e]=E(e,5);m=new v(h,s,257,286,15),_=new v(u,o,0,30,15),g=new v(new Array(0),a,0,19,7)}(),P=!0),e.l_desc=new y(e.dyn_ltree,m),e.d_desc=new y(e.dyn_dtree,_),e.bl_desc=new y(e.bl_tree,g),e.bi_buf=0,e.bi_valid=0,w(e)},r._tr_stored_block=k,r._tr_flush_block=function(e,t,r,n){var i,s,o=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),I(e,e.l_desc),I(e,e.d_desc),o=function(e){var t;for(M(e,e.dyn_ltree,e.l_desc.max_code),M(e,e.dyn_dtree,e.d_desc.max_code),I(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*l[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(s=e.static_len+3+7>>>3)<=i&&(i=s)):i=s=r+5,r+4<=i&&-1!==t?k(e,t,r,n):4===e.strategy||s===i?(S(e,2+(n?1:0),3),D(e,h,u)):(S(e,4+(n?1:0),3),function(e,t,r,n){var i;for(S(e,t-257,5),S(e,r-1,5),S(e,n-4,4),i=0;i<n;i++)S(e,e.bl_tree[2*l[i]+1],3);N(e,e.dyn_ltree,t-1),N(e,e.dyn_dtree,r-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),D(e,e.dyn_ltree,e.dyn_dtree)),w(e),n&&C(e)},r._tr_tally=function(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(d[r]+256+1)]++,e.dyn_dtree[2*b(t)]++),e.last_lit===e.lit_bufsize-1},r._tr_align=function(e){S(e,2,3),T(e,256,h),function(e){16===e.bi_valid?(x(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},{"../utils/common":27}],39:[function(e,t,r){t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}]},{},[9])(9)}))}}),require_crypto=__commonJS({"(disabled):crypto"(){}}),require_stream=__commonJS({"(disabled):stream"(){}}),require_xlsx=__commonJS({"node_modules/xlsx/xlsx.js"(e,t){var r={};function n(r){r.version="0.17.0";var n=1200,i=1252;void 0!==t&&void 0!==__require&&"undefined"==typeof cptable&&("undefined"!=typeof global?global.cptable=require_cpexcel():"undefined"!=typeof window&&(window.cptable=require_cpexcel()));for(var s=[874,932,936,949,950],o=0;o<=8;++o)s.push(1250+o);var a={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},l=function(e){-1!=s.indexOf(e)&&(i=a[0]=e)},h=function(e){n=e,l(e)};function u(){h(1200),l(1252)}function c(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}var d=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return 255==t&&254==r?function(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}(e.slice(2)):254==t&&255==r?function(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}(e.slice(2)):65279==t?e.slice(1):e},f=function(e){return String.fromCharCode(e)},p=function(e){return String.fromCharCode(e)};"undefined"!=typeof cptable&&(h=function(e){n=e,l(e)},d=function(e){return 255===e.charCodeAt(0)&&254===e.charCodeAt(1)?cptable.utils.decode(1200,c(e.slice(2))):e},f=function(e){return 1200===n?String.fromCharCode(e):cptable.utils.decode(n,[255&e,e>>8])[0]},p=function(e){return cptable.utils.decode(i,[e])[0]});var m,_=(m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",{encode:function(e){for(var t="",r=0,n=0,i=0,s=0,o=0,a=0,l=0,h=0;h<e.length;)s=(r=e.charCodeAt(h++))>>2,o=(3&r)<<4|(n=e.charCodeAt(h++))>>4,a=(15&n)<<2|(i=e.charCodeAt(h++))>>6,l=63&i,isNaN(n)?a=l=64:isNaN(i)&&(l=64),t+=m.charAt(s)+m.charAt(o)+m.charAt(a)+m.charAt(l);return t},decode:function(e){var t="",r=0,n=0,i=0,s=0,o=0,a=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)r=m.indexOf(e.charAt(l++))<<2|(s=m.indexOf(e.charAt(l++)))>>4,t+=String.fromCharCode(r),n=(15&s)<<4|(o=m.indexOf(e.charAt(l++)))>>2,64!==o&&(t+=String.fromCharCode(n)),i=(3&o)<<6|(a=m.indexOf(e.charAt(l++))),64!==a&&(t+=String.fromCharCode(i));return t}}),g="undefined"!=typeof Buffer&&"undefined"!=typeof process&&void 0!==process.versions&&!!process.versions.node,v=function(){};if("undefined"!=typeof Buffer){var y=!Buffer.from;if(!y)try{Buffer.from("foo","utf8")}catch(e){y=!0}v=y?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer),Buffer.alloc||(Buffer.alloc=function(e){return new Buffer(e)}),Buffer.allocUnsafe||(Buffer.allocUnsafe=function(e){return new Buffer(e)})}function b(e){return g?Buffer.alloc(e):new Array(e)}function x(e){return g?Buffer.allocUnsafe(e):new Array(e)}var S=function(e){return g?v(e,"binary"):e.split("").map((function(e){return 255&e.charCodeAt(0)}))};function T(e){if("undefined"==typeof ArrayBuffer)return S(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=255&e.charCodeAt(n);return t}function E(e){if(Array.isArray(e))return e.map((function(e){return String.fromCharCode(e)})).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function A(e){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(e instanceof ArrayBuffer)return A(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var w=function(e){return[].concat.apply([],e)},C=/\u0000/g,O=/[\u0001-\u0006]/g,R={},D=function(e){function t(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function r(e,t){for(var r="";r.length<t;)r+=e;return r}function n(e,t){var n=""+e;return n.length>=t?n:r("0",t-n.length)+n}function i(e,t){var n=""+e;return n.length>=t?n:r(" ",t-n.length)+n}function s(e,t){var n=""+e;return n.length>=t?n:n+r(" ",t-n.length)}e.version="0.11.2";var o=Math.pow(2,32);function a(e,t){return e>o||e<-o?function(e,t){var n=""+Math.round(e);return n.length>=t?n:r("0",t-n.length)+n}(e,t):function(e,t){var n=""+e;return n.length>=t?n:r("0",t-n.length)+n}(Math.round(e),t)}function l(e,t){return t=t||0,e.length>=7+t&&103==(32|e.charCodeAt(t))&&101==(32|e.charCodeAt(t+1))&&110==(32|e.charCodeAt(t+2))&&101==(32|e.charCodeAt(t+3))&&114==(32|e.charCodeAt(t+4))&&97==(32|e.charCodeAt(t+5))&&108==(32|e.charCodeAt(t+6))}var h=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],u=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function c(e){e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "'}var d={};c(d);var f=[],p=0;for(p=5;p<=8;++p)f[p]=32+p;for(p=23;p<=26;++p)f[p]=0;for(p=27;p<=31;++p)f[p]=14;for(p=50;p<=58;++p)f[p]=14;for(p=59;p<=62;++p)f[p]=p-58;for(p=67;p<=68;++p)f[p]=p-58;for(p=72;p<=75;++p)f[p]=p-58;for(p=67;p<=68;++p)f[p]=p-57;for(p=76;p<=78;++p)f[p]=p-56;for(p=79;p<=81;++p)f[p]=p-34;var m=[];function _(e,t,r){for(var n=e<0?-1:1,i=e*n,s=0,o=1,a=0,l=1,h=0,u=0,c=Math.floor(i);h<t&&(a=(c=Math.floor(i))*o+s,u=c*h+l,!(i-c<5e-8));)i=1/(i-c),s=o,o=a,l=h,h=u;if(u>t&&(h>t?(u=l,a=s):(u=h,a=o)),!r)return[0,n*a,u];var d=Math.floor(n*a/u);return[d,n*a-d*u,u]}function g(e,t,r){if(e>2958465||e<0)return null;var n=0|e,i=Math.floor(86400*(e-n)),s=0,o=[],a={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(a.u)<1e-6&&(a.u=0),t&&t.date1904&&(n+=1462),a.u>.9999&&(a.u=0,86400==++i&&(a.T=i=0,++n,++a.D)),60===n)o=r?[1317,10,29]:[1900,2,29],s=3;else if(0===n)o=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=function(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}(l,o))}return a.y=o[0],a.m=o[1],a.d=o[2],a.S=i%60,i=Math.floor(i/60),a.M=i%60,i=Math.floor(i/60),a.H=i,a.q=s,a}m[5]=m[63]='"$"#,##0_);\\("$"#,##0\\)',m[6]=m[64]='"$"#,##0_);[Red]\\("$"#,##0\\)',m[7]=m[65]='"$"#,##0.00_);\\("$"#,##0.00\\)',m[8]=m[66]='"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',m[41]='_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',m[42]='_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',m[43]='_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',m[44]='_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)',e.parse_date_code=g;var v=new Date(1899,11,31,0,0,0),y=v.getTime(),b=new Date(1900,2,1,0,0,0);function x(e,t){var r=e.getTime();return t?r-=1262304e5:e>=b&&(r+=864e5),(r-(y+6e4*(e.getTimezoneOffset()-v.getTimezoneOffset())))/864e5}e._general_int=function(e){return e.toString(10)};var S=function(){var e=/(?:\.0*|(\.\d*[1-9])0+)$/;function t(t){return-1==t.indexOf(".")?t:t.replace(e,"$1")}var r=/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,n=/(E[+-])(\d)$/;return function(e){var i,s=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return i=s>=-4&&s<=-1?e.toPrecision(10+s):Math.abs(s)<=9?function(e){var r=e<0?12:11,n=t(e.toFixed(12));return n.length<=r||(n=e.toPrecision(10)).length<=r?n:e.toExponential(5)}(e):10===s?e.toFixed(10).substr(0,12):function(e){var r=t(e.toFixed(11));return r.length>(e<0?12:11)||"0"===r||"-0"===r?e.toPrecision(6):r}(e),t(function(e){return-1==e.indexOf("E")?e:e.replace(r,"$1E").replace(n,"$10$2")}(i.toUpperCase()))}}();function T(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):S(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return P(14,x(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function E(e,t,r,i){var s,o="",a=0,l=0,c=r.y,d=0;switch(e){case 98:c=r.y+543;case 121:switch(t.length){case 1:case 2:s=c%100,d=2;break;default:s=c%1e4,d=4}break;case 109:switch(t.length){case 1:case 2:s=r.m,d=t.length;break;case 3:return u[r.m-1][1];case 5:return u[r.m-1][0];default:return u[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:s=r.d,d=t.length;break;case 3:return h[r.q][0];default:return h[r.q][1]}break;case 104:switch(t.length){case 1:case 2:s=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:s=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:s=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==r.u||"s"!=t&&"ss"!=t?(l=i>=2?3===i?1e3:100:1===i?10:1,(a=Math.round(l*(r.S+r.u)))>=60*l&&(a=0),"s"===t?0===a?"0":""+a/l:(o=n(a,2+i),"ss"===t?o.substr(0,2):"."+o.substr(2,t.length-1))):n(r.S,t.length);case 90:switch(t){case"[h]":case"[hh]":s=24*r.D+r.H;break;case"[m]":case"[mm]":s=60*(24*r.D+r.H)+r.M;break;case"[s]":case"[ss]":s=60*(60*(24*r.D+r.H)+r.M)+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=3===t.length?1:2;break;case 101:s=c,d=1}return d>0?n(s,d):""}function A(e){if(e.length<=3)return e;for(var t=e.length%3,r=e.substr(0,t);t!=e.length;t+=3)r+=(r.length>0?",":"")+e.substr(t,3);return r}e._general_num=S,e._general=T;var w=function(){var e=/%/g;function o(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+o(e,-t);var i=e.indexOf(".");-1===i&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),-1===(r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i)).indexOf("e")){var a=Math.floor(Math.log(t)*Math.LOG10E);for(-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);"0."===r.substr(0,2);)r=(r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,r,n){return t+r+n.substr(0,(i+s)%i)+"."+n.substr(s)+"E"}))}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var l=/# (\?+)( ?)\/( ?)(\d+)/,h=/^#*0*\.([0#]+)/,u=/\).*[0#]/,c=/\(###\) ###\\?-####/;function d(e){for(var t,r="",n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function f(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function p(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function m(g,v,y){if(40===g.charCodeAt(0)&&!v.match(u)){var b=v.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return y>=0?m("n",b,y):"("+m("n",b,-y)+")"}if(44===v.charCodeAt(v.length-1))return function(e,t,r){for(var n=t.length-1;44===t.charCodeAt(n-1);)--n;return w(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}(g,v,y);if(-1!==v.indexOf("%"))return function(t,n,i){var s=n.replace(e,""),o=n.length-s.length;return w(t,s,i*Math.pow(10,2*o))+r("%",o)}(g,v,y);if(-1!==v.indexOf("E"))return o(v,y);if(36===v.charCodeAt(0))return"$"+m(g,v.substr(" "==v.charAt(1)?2:1),y);var x,S,T,E,C=Math.abs(y),O=y<0?"-":"";if(v.match(/^00+$/))return O+a(C,v.length);if(v.match(/^[#?]+$/))return"0"===(x=a(y,0))&&(x=""),x.length>v.length?x:d(v.substr(0,v.length-x.length))+x;if(S=v.match(l))return function(e,t,s){var o=parseInt(e[4],10),a=Math.round(t*o),l=Math.floor(a/o),h=a-l*o,u=o;return s+(0===l?"":""+l)+" "+(0===h?r(" ",e[1].length+1+e[4].length):i(h,e[1].length)+e[2]+"/"+e[3]+n(u,e[4].length))}(S,C,O);if(v.match(/^#+0+$/))return O+a(C,v.length-v.indexOf("0"));if(S=v.match(h))return x=f(y,S[1].length).replace(/^([^\.]+)$/,"$1."+d(S[1])).replace(/\.$/,"."+d(S[1])).replace(/\.(\d*)$/,(function(e,t){return"."+t+r("0",d(S[1]).length-t.length)})),-1!==v.indexOf("0.")?x:x.replace(/^0\./,".");if(v=v.replace(/^#+([0.])/,"$1"),S=v.match(/^(0*)\.(#*)$/))return O+f(C,S[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,S[1].length?"0.":".");if(S=v.match(/^#{1,3},##0(\.?)$/))return O+A(a(C,0));if(S=v.match(/^#,##0\.([#0]*0)$/))return y<0?"-"+m(g,v,-y):A(""+(Math.floor(y)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(y,S[1].length)))+"."+n(p(y,S[1].length),S[1].length);if(S=v.match(/^#,#*,#0/))return m(g,v.replace(/^#,#*,/,""),y);if(S=v.match(/^([0#]+)(\\?-([0#]+))+$/))return x=t(m(g,v.replace(/[\\-]/g,""),y)),T=0,t(t(v.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return T<x.length?x.charAt(T++):"0"===e?"0":""})));if(v.match(c))return"("+(x=m(g,"##########",y)).substr(0,3)+") "+x.substr(3,3)+"-"+x.substr(6);var R="";if(S=v.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return T=Math.min(S[4].length,7),E=_(C,Math.pow(10,T)-1,!1),x=""+O," "==(R=w("n",S[1],E[1])).charAt(R.length-1)&&(R=R.substr(0,R.length-1)+"0"),x+=R+S[2]+"/"+S[3],(R=s(E[2],T)).length<S[4].length&&(R=d(S[4].substr(S[4].length-R.length))+R),x+=R;if(S=v.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return T=Math.min(Math.max(S[1].length,S[4].length),7),O+((E=_(C,Math.pow(10,T)-1,!0))[0]||(E[1]?"":"0"))+" "+(E[1]?i(E[1],T)+S[2]+"/"+S[3]+s(E[2],T):r(" ",2*T+1+S[2].length+S[3].length));if(S=v.match(/^[#0?]+$/))return x=a(y,0),v.length<=x.length?x:d(v.substr(0,v.length-x.length))+x;if(S=v.match(/^([#0?]+)\.([#0]+)$/)){x=""+y.toFixed(Math.min(S[2].length,10)).replace(/([^0])0+$/,"$1"),T=x.indexOf(".");var D=v.indexOf(".")-T,I=v.length-x.length-D;return d(v.substr(0,D)+x+v.substr(v.length-I))}if(S=v.match(/^00,000\.([#0]*0)$/))return T=p(y,S[1].length),y<0?"-"+m(g,v,-y):A(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(y)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?n(0,3-e.length):"")+e}))+"."+n(T,S[1].length);switch(v){case"###,##0.00":return m(g,"#,##0.00",y);case"###,###":case"##,###":case"#,###":var M=A(a(C,0));return"0"!==M?O+M:"";case"###,###.00":return m(g,"###,##0.00",y).replace(/^0\./,".");case"#,###.00":return m(g,"#,##0.00",y).replace(/^0\./,".")}throw new Error("unsupported format |"+v+"|")}function g(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+g(e,-t);var i=e.indexOf(".");-1===i&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),!(r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i)).match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,r,n){return t+r+n.substr(0,(i+s)%i)+"."+n.substr(s)+"E"}))}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function v(o,a,f){if(40===o.charCodeAt(0)&&!a.match(u)){var p=a.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return f>=0?v("n",p,f):"("+v("n",p,-f)+")"}if(44===a.charCodeAt(a.length-1))return function(e,t,r){for(var n=t.length-1;44===t.charCodeAt(n-1);)--n;return w(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}(o,a,f);if(-1!==a.indexOf("%"))return function(t,n,i){var s=n.replace(e,""),o=n.length-s.length;return w(t,s,i*Math.pow(10,2*o))+r("%",o)}(o,a,f);if(-1!==a.indexOf("E"))return g(a,f);if(36===a.charCodeAt(0))return"$"+v(o,a.substr(" "==a.charAt(1)?2:1),f);var m,y,b,x,S=Math.abs(f),T=f<0?"-":"";if(a.match(/^00+$/))return T+n(S,a.length);if(a.match(/^[#?]+$/))return m=""+f,0===f&&(m=""),m.length>a.length?m:d(a.substr(0,a.length-m.length))+m;if(y=a.match(l))return function(e,t,n){return n+(0===t?"":""+t)+r(" ",e[1].length+2+e[4].length)}(y,S,T);if(a.match(/^#+0+$/))return T+n(S,a.length-a.indexOf("0"));if(y=a.match(h))return m=(m=(""+f).replace(/^([^\.]+)$/,"$1."+d(y[1])).replace(/\.$/,"."+d(y[1]))).replace(/\.(\d*)$/,(function(e,t){return"."+t+r("0",d(y[1]).length-t.length)})),-1!==a.indexOf("0.")?m:m.replace(/^0\./,".");if(a=a.replace(/^#+([0.])/,"$1"),y=a.match(/^(0*)\.(#*)$/))return T+(""+S).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,y[1].length?"0.":".");if(y=a.match(/^#{1,3},##0(\.?)$/))return T+A(""+S);if(y=a.match(/^#,##0\.([#0]*0)$/))return f<0?"-"+v(o,a,-f):A(""+f)+"."+r("0",y[1].length);if(y=a.match(/^#,#*,#0/))return v(o,a.replace(/^#,#*,/,""),f);if(y=a.match(/^([0#]+)(\\?-([0#]+))+$/))return m=t(v(o,a.replace(/[\\-]/g,""),f)),b=0,t(t(a.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return b<m.length?m.charAt(b++):"0"===e?"0":""})));if(a.match(c))return"("+(m=v(o,"##########",f)).substr(0,3)+") "+m.substr(3,3)+"-"+m.substr(6);var E="";if(y=a.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return b=Math.min(y[4].length,7),x=_(S,Math.pow(10,b)-1,!1),m=""+T," "==(E=w("n",y[1],x[1])).charAt(E.length-1)&&(E=E.substr(0,E.length-1)+"0"),m+=E+y[2]+"/"+y[3],(E=s(x[2],b)).length<y[4].length&&(E=d(y[4].substr(y[4].length-E.length))+E),m+=E;if(y=a.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return b=Math.min(Math.max(y[1].length,y[4].length),7),T+((x=_(S,Math.pow(10,b)-1,!0))[0]||(x[1]?"":"0"))+" "+(x[1]?i(x[1],b)+y[2]+"/"+y[3]+s(x[2],b):r(" ",2*b+1+y[2].length+y[3].length));if(y=a.match(/^[#0?]+$/))return m=""+f,a.length<=m.length?m:d(a.substr(0,a.length-m.length))+m;if(y=a.match(/^([#0]+)\.([#0]+)$/)){m=""+f.toFixed(Math.min(y[2].length,10)).replace(/([^0])0+$/,"$1"),b=m.indexOf(".");var C=a.indexOf(".")-b,O=a.length-m.length-C;return d(a.substr(0,C)+m+a.substr(a.length-O))}if(y=a.match(/^00,000\.([#0]*0)$/))return f<0?"-"+v(o,a,-f):A(""+f).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?n(0,3-e.length):"")+e}))+"."+n(0,y[1].length);switch(a){case"###,###":case"##,###":case"#,###":var R=A(""+S);return"0"!==R?T+R:"";default:if(a.match(/\.[0#?]*$/))return v(o,a.slice(0,a.lastIndexOf(".")),f)+d(a.slice(a.lastIndexOf(".")))}throw new Error("unsupported format |"+a+"|")}return function(e,t,r){return(0|r)===r?v(e,t,r):m(e,t,r)}}();function C(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),!0===r)throw new Error("Format |"+e+"| unterminated string ");return t}e._split=C;var O=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function R(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":l(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if("A/P"===e.substr(t,3).toUpperCase()||"AM/PM"===e.substr(t,5).toUpperCase()||"/"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(n=r;"]"!==e.charAt(t++)&&t<e.length;)n+=e.charAt(t);if(n.match(O))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||"\\"==r&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(" "==e.charAt(t)||"*"==e.charAt(t))&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}function D(e,t,r,n){for(var i,s,o,a=[],h="",u=0,c="",d="t",f="H";u<e.length;)switch(c=e.charAt(u)){case"G":if(!l(e,u))throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"G",v:"General"},u+=7;break;case'"':for(h="";34!==(o=e.charCodeAt(++u))&&u<e.length;)h+=String.fromCharCode(o);a[a.length]={t:"t",v:h},++u;break;case"\\":var p=e.charAt(++u),m="("===p||")"===p?p:"t";a[a.length]={t:m,v:p},++u;break;case"_":a[a.length]={t:"t",v:" "},u+=2;break;case"@":a[a.length]={t:"T",v:t},++u;break;case"B":case"b":if("1"===e.charAt(u+1)||"2"===e.charAt(u+1)){if(null==i&&null==(i=g(t,r,"2"===e.charAt(u+1))))return"";a[a.length]={t:"X",v:e.substr(u,2)},d=c,u+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||null==i&&null==(i=g(t,r)))return"";for(h=c;++u<e.length&&e.charAt(u).toLowerCase()===c;)h+=c;"m"===c&&"h"===d.toLowerCase()&&(c="M"),"h"===c&&(c=f),a[a.length]={t:c,v:h},d=c;break;case"A":case"a":case"":var _={t:c,v:c};if(null==i&&(i=g(t,r)),"A/P"===e.substr(u,3).toUpperCase()?(null!=i&&(_.v=i.H>=12?"P":"A"),_.t="T",f="h",u+=3):"AM/PM"===e.substr(u,5).toUpperCase()?(null!=i&&(_.v=i.H>=12?"PM":"AM"),_.t="T",u+=5,f="h"):"/"===e.substr(u,5).toUpperCase()?(null!=i&&(_.v=i.H>=12?"":""),_.t="T",u+=5,f="h"):(_.t="t",++u),null==i&&"T"===_.t)return"";a[a.length]=_,d=c;break;case"[":for(h=c;"]"!==e.charAt(u++)&&u<e.length;)h+=e.charAt(u);if("]"!==h.slice(-1))throw'unterminated "[" block: |'+h+"|";if(h.match(O)){if(null==i&&null==(i=g(t,r)))return"";a[a.length]={t:"Z",v:h.toLowerCase()},d=h.charAt(1)}else h.indexOf("$")>-1&&(h=(h.match(/\$([^-\[\]]*)/)||[])[1]||"$",R(e)||(a[a.length]={t:"t",v:h}));break;case".":if(null!=i){for(h=c;++u<e.length&&"0"===(c=e.charAt(u));)h+=c;a[a.length]={t:"s",v:h};break}case"0":case"#":for(h=c;++u<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(u))>-1;)h+=c;a[a.length]={t:"n",v:h};break;case"?":for(h=c;e.charAt(++u)===c;)h+=c;a[a.length]={t:c,v:h},d=c;break;case"*":++u,(" "==e.charAt(u)||"*"==e.charAt(u))&&++u;break;case"(":case")":a[a.length]={t:1===n?"t":c,v:c},++u;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(h=c;u<e.length&&"0123456789".indexOf(e.charAt(++u))>-1;)h+=e.charAt(u);a[a.length]={t:"D",v:h};break;case" ":a[a.length]={t:c,v:c},++u;break;case"$":a[a.length]={t:"t",v:"$"},++u;break;default:if(-1===",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c))throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"t",v:c},++u}var v,y=0,b=0;for(u=a.length-1,d="t";u>=0;--u)switch(a[u].t){case"h":case"H":a[u].t=f,d="h",y<1&&(y=1);break;case"s":(v=a[u].v.match(/\.0+$/))&&(b=Math.max(b,v[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":d=a[u].t;break;case"m":"s"===d&&(a[u].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&a[u].v.match(/[Hh]/)&&(y=1),y<2&&a[u].v.match(/[Mm]/)&&(y=2),y<3&&a[u].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:i.u>=.5&&(i.u=0,++i.S),i.S>=60&&(i.S=0,++i.M),i.M>=60&&(i.M=0,++i.H);break;case 2:i.u>=.5&&(i.u=0,++i.S),i.S>=60&&(i.S=0,++i.M)}var x,S="";for(u=0;u<a.length;++u)switch(a[u].t){case"t":case"T":case" ":case"D":break;case"X":a[u].v="",a[u].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[u].v=E(a[u].t.charCodeAt(0),a[u].v,i,b),a[u].t="t";break;case"n":case"?":for(x=u+1;null!=a[x]&&("?"===(c=a[x].t)||"D"===c||(" "===c||"t"===c)&&null!=a[x+1]&&("?"===a[x+1].t||"t"===a[x+1].t&&"/"===a[x+1].v)||"("===a[u].t&&(" "===c||"n"===c||")"===c)||"t"===c&&("/"===a[x].v||" "===a[x].v&&null!=a[x+1]&&"?"==a[x+1].t));)a[u].v+=a[x].v,a[x]={v:"",t:";"},++x;S+=a[u].v,u=x-1;break;case"G":a[u].t="t",a[u].v=T(t,r)}var A,C,D="";if(S.length>0){40==S.charCodeAt(0)?(A=t<0&&45===S.charCodeAt(0)?-t:t,C=w("n",S,A)):(C=w("n",S,A=t<0&&n>1?-t:t),A<0&&a[0]&&"t"==a[0].t&&(C=C.substr(1),a[0].v="-"+a[0].v)),x=C.length-1;var I=a.length;for(u=0;u<a.length;++u)if(null!=a[u]&&"t"!=a[u].t&&a[u].v.indexOf(".")>-1){I=u;break}var M=a.length;if(I===a.length&&-1===C.indexOf("E")){for(u=a.length-1;u>=0;--u)null==a[u]||-1==="n?".indexOf(a[u].t)||(x>=a[u].v.length-1?(x-=a[u].v.length,a[u].v=C.substr(x+1,a[u].v.length)):x<0?a[u].v="":(a[u].v=C.substr(0,x+1),x=-1),a[u].t="t",M=u);x>=0&&M<a.length&&(a[M].v=C.substr(0,x+1)+a[M].v)}else if(I!==a.length&&-1===C.indexOf("E")){for(x=C.indexOf(".")-1,u=I;u>=0;--u)if(null!=a[u]&&-1!=="n?".indexOf(a[u].t)){for(s=a[u].v.indexOf(".")>-1&&u===I?a[u].v.indexOf(".")-1:a[u].v.length-1,D=a[u].v.substr(s+1);s>=0;--s)x>=0&&("0"===a[u].v.charAt(s)||"#"===a[u].v.charAt(s))&&(D=C.charAt(x--)+D);a[u].v=D,a[u].t="t",M=u}for(x>=0&&M<a.length&&(a[M].v=C.substr(0,x+1)+a[M].v),x=C.indexOf(".")+1,u=I;u<a.length;++u)if(null!=a[u]&&(-1!=="n?(".indexOf(a[u].t)||u===I)){for(s=a[u].v.indexOf(".")>-1&&u===I?a[u].v.indexOf(".")+1:0,D=a[u].v.substr(0,s);s<a[u].v.length;++s)x<C.length&&(D+=C.charAt(x++));a[u].v=D,a[u].t="t",M=u}}}for(u=0;u<a.length;++u)null!=a[u]&&"n?".indexOf(a[u].t)>-1&&(A=n>1&&t<0&&u>0&&"-"===a[u-1].v?-t:t,a[u].v=w(a[u].t,a[u].v,A),a[u].t="t");var N="";for(u=0;u!==a.length;++u)null!=a[u]&&(N+=a[u].v);return N}e.is_date=R,e._eval=D;var I=/\[[=<>]/,M=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function N(e,t){if(null==t)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0}return!1}function P(e,t,r){null==r&&(r={});var n="";switch(typeof e){case"string":n="m/d/yy"==e&&r.dateNF?r.dateNF:e;break;case"number":null==(n=14==e&&r.dateNF?r.dateNF:(null!=r.table?r.table:d)[e])&&(n=r.table&&r.table[f[e]]||d[f[e]]),null==n&&(n=m[e]||"General")}if(l(n,0))return T(t,r);t instanceof Date&&(t=x(t,r.date1904));var i=function(e,t){var r=C(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if("number"!=typeof t)return[4,4===r.length||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"]}var s=t>0?r[0]:t<0?r[1]:r[2];if(-1===r[0].indexOf("[")&&-1===r[1].indexOf("["))return[n,s];if(null!=r[0].match(I)||null!=r[1].match(I)){var o=r[0].match(M),a=r[1].match(M);return N(t,o)?[n,r[0]]:N(t,a)?[n,r[1]]:[n,r[null!=o&&null!=a?2:1]]}return[n,s]}(n,t);if(l(i[1]))return T(t,r);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return D(i[1],t,r,i[0])}function k(e,t){if("number"!=typeof t){t=+t||-1;for(var r=0;r<392;++r)if(null!=d[r]){if(d[r]==e){t=r;break}}else t<0&&(t=r);t<0&&(t=391)}return d[t]=e,t}e.load=k,e._table=d,e.get_table=function(){return d},e.load_table=function(e){for(var t=0;392!=t;++t)void 0!==e[t]&&k(e[t],t)},e.init_table=c,e.format=P};D(R);var I,M={"General Number":"General","General Date":R._table[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":R._table[15],"Short Date":R._table[14],"Long Time":R._table[19],"Medium Time":R._table[18],"Short Time":R._table[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:R._table[2],Standard:R._table[4],Percent:R._table[10],Scientific:R._table[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'},N={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},P=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;!function(e){e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),r=0;256!=r;++r)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=r)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[r]=e;return"undefined"!=typeof Int32Array?new Int32Array(t):t}();e.table=t,e.bstr=function(e,r){for(var n=-1^r,i=e.length-1,s=0;s<i;)n=(n=n>>>8^t[255&(n^e.charCodeAt(s++))])>>>8^t[255&(n^e.charCodeAt(s++))];return s===i&&(n=n>>>8^t[255&(n^e.charCodeAt(s))]),-1^n},e.buf=function(e,r){if(e.length>1e4)return function(e,r){for(var n=-1^r,i=e.length-7,s=0;s<i;)n=(n=(n=(n=(n=(n=(n=(n=n>>>8^t[255&(n^e[s++])])>>>8^t[255&(n^e[s++])])>>>8^t[255&(n^e[s++])])>>>8^t[255&(n^e[s++])])>>>8^t[255&(n^e[s++])])>>>8^t[255&(n^e[s++])])>>>8^t[255&(n^e[s++])])>>>8^t[255&(n^e[s++])];for(;s<i+7;)n=n>>>8^t[255&(n^e[s++])];return-1^n}(e,r);for(var n=-1^r,i=e.length-3,s=0;s<i;)n=(n=(n=(n=n>>>8^t[255&(n^e[s++])])>>>8^t[255&(n^e[s++])])>>>8^t[255&(n^e[s++])])>>>8^t[255&(n^e[s++])];for(;s<i+3;)n=n>>>8^t[255&(n^e[s++])];return-1^n},e.str=function(e,r){for(var n,i,s=-1^r,o=0,a=e.length;o<a;)(n=e.charCodeAt(o++))<128?s=s>>>8^t[255&(s^n)]:n<2048?s=(s=s>>>8^t[255&(s^(192|n>>6&31))])>>>8^t[255&(s^(128|63&n))]:n>=55296&&n<57344?(n=64+(1023&n),i=1023&e.charCodeAt(o++),s=(s=(s=(s=s>>>8^t[255&(s^(240|n>>8&7))])>>>8^t[255&(s^(128|n>>2&63))])>>>8^t[255&(s^(128|i>>6&15|(3&n)<<4))])>>>8^t[255&(s^(128|63&i))]):s=(s=(s=s>>>8^t[255&(s^(224|n>>12&15))])>>>8^t[255&(s^(128|n>>6&63))])>>>8^t[255&(s^(128|63&n))];return-1^s}}(I={});var k,F=function(){var e,t={};function r(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:r(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function n(e){if("/"==e.charAt(e.length-1))return n(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function i(e,t){"string"==typeof t&&(t=new Date(t));var r=t.getHours();r=(r=r<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,r);var n=t.getFullYear()-1980;n=(n=n<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,n)}function s(e){kt(e,0);for(var t={},r=0;e.l<=e.length-4;){var n=e.read_shift(2),i=e.read_shift(2),s=e.l+i,o={};21589===n&&(1&(r=e.read_shift(1))&&(o.mtime=e.read_shift(4)),i>5&&(2&r&&(o.atime=e.read_shift(4)),4&r&&(o.ctime=e.read_shift(4))),o.mtime&&(o.mt=new Date(1e3*o.mtime))),e.l=s,t[n]=o}return t}function o(){return e||(e=require_fs())}function a(e,t){if(80==e[0]&&75==e[1])return ue(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var r,n,i,s,o,a,d=512,f=[],p=e.slice(0,512);kt(p,0);var m=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(T,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(p);switch(r=m[0]){case 3:d=512;break;case 4:d=4096;break;case 0:if(0==m[1])return ue(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+r)}512!==d&&kt(p=e.slice(0,d),28);var _=e.slice(0,d);!function(e,t){var r;switch(e.l+=2,r=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+r);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+r);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+r)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(p,r);var g=p.read_shift(4,"i");if(3===r&&0!==g)throw new Error("# Directory Sectors: Expected 0 saw "+g);p.l+=4,s=p.read_shift(4,"i"),p.l+=4,p.chk("00100000","Mini Stream Cutoff Size: "),o=p.read_shift(4,"i"),n=p.read_shift(4,"i"),a=p.read_shift(4,"i"),i=p.read_shift(4,"i");for(var v=-1,b=0;b<109&&!((v=p.read_shift(4,"i"))<0);++b)f[b]=v;var x=function(e,t){for(var r=Math.ceil(e.length/t)-1,n=[],i=1;i<r;++i)n[i-1]=e.slice(i*t,(i+1)*t);return n[r-1]=e.slice(r*t),n}(e,d);h(a,i,x,d,f);var S=function(e,t,r,n){var i=e.length,s=[],o=[],a=[],l=[],h=n-1,u=0,c=0,d=0,f=0;for(u=0;u<i;++u)if(a=[],(d=u+t)>=i&&(d-=i),!o[d]){l=[];var p=[];for(c=d;c>=0;){p[c]=!0,o[c]=!0,a[a.length]=c,l.push(e[c]);var m=r[Math.floor(4*c/n)];if(n<4+(f=4*c&h))throw new Error("FAT boundary crossed: "+c+" 4 "+n);if(!e[m]||p[c=Rt(e[m],f)])break}s[d]={nodes:a,data:ot([l])}}return s}(x,s,f,d);S[s].name="!Directory",n>0&&o!==y&&(S[o].name="!MiniFAT"),S[f[0]].name="!FAT",S.fat_addrs=f,S.ssz=d;var E=[],A=[],w=[];(function(e,t,r,n,i,s,o,a){for(var h,d=0,f=n.length?2:0,p=t[e].data,m=0,_=0;m<p.length;m+=128){var g=p.slice(m,m+128);kt(g,64),_=g.read_shift(2),h=lt(g,0,_-f),n.push(h);var v={name:h,type:g.read_shift(1),color:g.read_shift(1),L:g.read_shift(4,"i"),R:g.read_shift(4,"i"),C:g.read_shift(4,"i"),clsid:g.read_shift(16),state:g.read_shift(4,"i"),start:0,size:0};0!==g.read_shift(2)+g.read_shift(2)+g.read_shift(2)+g.read_shift(2)&&(v.ct=c(g,g.l-8)),0!==g.read_shift(2)+g.read_shift(2)+g.read_shift(2)+g.read_shift(2)&&(v.mt=c(g,g.l-8)),v.start=g.read_shift(4,"i"),v.size=g.read_shift(4,"i"),v.size<0&&v.start<0&&(v.size=v.type=0,v.start=y,v.name=""),5===v.type?(d=v.start,i>0&&d!==y&&(t[d].name="!StreamData")):v.size>=4096?(v.storage="fat",void 0===t[v.start]&&(t[v.start]=u(r,v.start,t.fat_addrs,t.ssz)),t[v.start].name=v.name,v.content=t[v.start].data.slice(0,v.size)):(v.storage="minifat",v.size<0?v.size=0:d!==y&&v.start!==y&&t[d]&&(v.content=l(v,t[d].data,(t[a]||{}).data))),v.content&&kt(v.content,0),s[h]=v,o.push(v)}})(s,S,x,E,n,{},A,o),function(e,t,r){for(var n=0,i=0,s=0,o=0,a=0,l=r.length,h=[],u=[];n<l;++n)h[n]=u[n]=n,t[n]=r[n];for(;a<u.length;++a)i=e[n=u[a]].L,s=e[n].R,o=e[n].C,h[n]===n&&(-1!==i&&h[i]!==i&&(h[n]=h[i]),-1!==s&&h[s]!==s&&(h[n]=h[s])),-1!==o&&(h[o]=n),-1!==i&&n!=h[n]&&(h[i]=h[n],u.lastIndexOf(i)<a&&u.push(i)),-1!==s&&n!=h[n]&&(h[s]=h[n],u.lastIndexOf(s)<a&&u.push(s));for(n=1;n<l;++n)h[n]===n&&(-1!==s&&h[s]!==s?h[n]=h[s]:-1!==i&&h[i]!==i&&(h[n]=h[i]));for(n=1;n<l;++n)if(0!==e[n].type){if((a=n)!=h[a])do{a=h[a],t[n]=t[a]+"/"+t[n]}while(0!==a&&-1!==h[a]&&a!=h[a]);h[n]=-1}for(t[0]+="/",n=1;n<l;++n)2!==e[n].type&&(t[n]+="/")}(A,w,E),E.shift();var C={FileIndex:A,FullPaths:w};return t&&t.raw&&(C.raw={header:_,sectors:x}),C}function l(e,t,r){for(var n=e.start,i=e.size,s=[],o=n;r&&i>0&&o>=0;)s.push(t.slice(o*v,o*v+v)),i-=v,o=Rt(r,4*o);return 0===s.length?Lt(0):w(s).slice(0,e.size)}function h(e,t,r,n,i){var s=y;if(e===y){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var o=r[e],a=(n>>>2)-1;if(!o)return;for(var l=0;l<a&&(s=Rt(o,4*l))!==y;++l)i.push(s);h(Rt(o,n-4),t-1,r,n,i)}}function u(e,t,r,n,i){var s=[],o=[];i||(i=[]);var a=n-1,l=0,h=0;for(l=t;l>=0;){i[l]=!0,s[s.length]=l,o.push(e[l]);var u=r[Math.floor(4*l/n)];if(n<4+(h=4*l&a))throw new Error("FAT boundary crossed: "+l+" 4 "+n);if(!e[u])break;l=Rt(e[u],h)}return{nodes:s,data:ot([o])}}function c(e,t){return new Date(1e3*(Ot(e,t+4)/1e7*Math.pow(2,32)+Ot(e,t)/1e7-11644473600))}function d(e,t){var r=t||{},n=r.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=n+"/",e.FileIndex[0]={name:n,type:5}),r.CLSID&&(e.FileIndex[0].clsid=r.CLSID),function(e){var t="Sh33tJ5";if(!F.find(e,"/"+t)){var r=Lt(4);r[0]=55,r[1]=r[3]=50,r[2]=54,e.FileIndex.push({name:t,type:2,content:r,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),f(e)}}(e)}function f(e,t){d(e);for(var i=!1,s=!1,o=e.FullPaths.length-1;o>=0;--o){var a=e.FileIndex[o];switch(a.type){case 0:s?i=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:s=!0,isNaN(a.R*a.L*a.C)&&(i=!0),a.R>-1&&a.L>-1&&a.R==a.L&&(i=!0);break;default:i=!0}}if(i||t){var l=new Date(1987,1,19),h=0,u=[];for(o=0;o<e.FullPaths.length;++o)0!==e.FileIndex[o].type&&u.push([e.FullPaths[o],e.FileIndex[o]]);for(o=0;o<u.length;++o){var c=r(u[o][0]);for(s=!1,h=0;h<u.length;++h)u[h][0]===c&&(s=!0);s||u.push([c,{name:n(c).replace("/",""),type:1,clsid:A,ct:l,mt:l,content:null}])}for(u.sort((function(e,t){return function(e,t){for(var r=e.split("/"),n=t.split("/"),i=0,s=0,o=Math.min(r.length,n.length);i<o;++i){if(s=r[i].length-n[i].length)return s;if(r[i]!=n[i])return r[i]<n[i]?-1:1}return r.length-n.length}(e[0],t[0])})),e.FullPaths=[],e.FileIndex=[],o=0;o<u.length;++o)e.FullPaths[o]=u[o][0],e.FileIndex[o]=u[o][1];for(o=0;o<u.length;++o){var f=e.FileIndex[o],p=e.FullPaths[o];if(f.name=n(p).replace("/",""),f.L=f.R=f.C=-(f.color=1),f.size=f.content?f.content.length:0,f.start=0,f.clsid=f.clsid||A,0===o)f.C=u.length>1?1:-1,f.size=0,f.type=5;else if("/"==p.slice(-1)){for(h=o+1;h<u.length&&r(e.FullPaths[h])!=p;++h);for(f.C=h>=u.length?-1:h,h=o+1;h<u.length&&r(e.FullPaths[h])!=r(p);++h);f.R=h>=u.length?-1:h,f.type=1}else r(e.FullPaths[o+1]||"")==r(p)&&(f.R=o+1),f.type=2}}}function p(e,t){var r=t||{};if(f(e),"zip"==r.fileType)return function(e,t){var r=t||{},n=[],s=[],o=Lt(1),a=r.compression?8:0,l=0,h=0,u=0,c=0,d=e.FullPaths[0],f=d,p=e.FileIndex[0],m=[],_=0;for(l=1;l<e.FullPaths.length;++l)if(f=e.FullPaths[l].slice(d.length),(p=e.FileIndex[l]).size&&p.content&&"Sh33tJ5"!=f){var g=u,v=Lt(f.length);for(h=0;h<f.length;++h)v.write_shift(1,127&f.charCodeAt(h));v=v.slice(0,v.l),m[c]=I.buf(p.content,0);var y=p.content;8==a&&(y=M(y)),(o=Lt(30)).write_shift(4,67324752),o.write_shift(2,20),o.write_shift(2,0),o.write_shift(2,a),p.mt?i(o,p.mt):o.write_shift(4,0),o.write_shift(-4,m[c]),o.write_shift(4,y.length),o.write_shift(4,p.content.length),o.write_shift(2,v.length),o.write_shift(2,0),u+=o.length,n.push(o),u+=v.length,n.push(v),u+=y.length,n.push(y),(o=Lt(46)).write_shift(4,33639248),o.write_shift(2,0),o.write_shift(2,20),o.write_shift(2,0),o.write_shift(2,a),o.write_shift(4,0),o.write_shift(-4,m[c]),o.write_shift(4,y.length),o.write_shift(4,p.content.length),o.write_shift(2,v.length),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(4,0),o.write_shift(4,g),_+=o.l,s.push(o),_+=v.length,s.push(v),++c}return(o=Lt(22)).write_shift(4,101010256),o.write_shift(2,0),o.write_shift(2,0),o.write_shift(2,c),o.write_shift(2,c),o.write_shift(4,_),o.write_shift(4,u),o.write_shift(2,0),w([w(n),w(s),o])}(e,r);var n=function(e){for(var t=0,r=0,n=0;n<e.FileIndex.length;++n){var i=e.FileIndex[n];if(i.content){var s=i.content.length;s>0&&(s<4096?t+=s+63>>6:r+=s+511>>9)}}for(var o=e.FullPaths.length+3>>2,a=t+127>>7,l=(t+7>>3)+r+o+a,h=l+127>>7,u=h<=109?0:Math.ceil((h-109)/127);l+h+u+127>>7>h;)u=++h<=109?0:Math.ceil((h-109)/127);var c=[1,u,h,a,o,r,t,0];return e.FileIndex[0].size=t<<6,c[7]=(e.FileIndex[0].start=c[0]+c[1]+c[2]+c[3]+c[4]+c[5])+(c[6]+7>>3),c}(e),s=Lt(n[7]<<9),o=0,a=0;for(o=0;o<8;++o)s.write_shift(1,E[o]);for(o=0;o<8;++o)s.write_shift(2,0);for(s.write_shift(2,62),s.write_shift(2,3),s.write_shift(2,65534),s.write_shift(2,9),s.write_shift(2,6),o=0;o<3;++o)s.write_shift(2,0);for(s.write_shift(4,0),s.write_shift(4,n[2]),s.write_shift(4,n[0]+n[1]+n[2]+n[3]-1),s.write_shift(4,0),s.write_shift(4,4096),s.write_shift(4,n[3]?n[0]+n[1]+n[2]-1:y),s.write_shift(4,n[3]),s.write_shift(-4,n[1]?n[0]-1:y),s.write_shift(4,n[1]),o=0;o<109;++o)s.write_shift(-4,o<n[2]?n[1]+o:-1);if(n[1])for(a=0;a<n[1];++a){for(;o<236+127*a;++o)s.write_shift(-4,o<n[2]?n[1]+o:-1);s.write_shift(-4,a===n[1]-1?y:a+1)}var l=function(e){for(a+=e;o<a-1;++o)s.write_shift(-4,o+1);e&&(++o,s.write_shift(-4,y))};for(a=o=0,a+=n[1];o<a;++o)s.write_shift(-4,R.DIFSECT);for(a+=n[2];o<a;++o)s.write_shift(-4,R.FATSECT);l(n[3]),l(n[4]);for(var h=0,u=0,c=e.FileIndex[0];h<e.FileIndex.length;++h)(c=e.FileIndex[h]).content&&!((u=c.content.length)<4096)&&(c.start=a,l(u+511>>9));for(l(n[6]+7>>3);511&s.l;)s.write_shift(-4,R.ENDOFCHAIN);for(a=o=0,h=0;h<e.FileIndex.length;++h)(c=e.FileIndex[h]).content&&(u=c.content.length)&&!(u>=4096)&&(c.start=a,l(u+63>>6));for(;511&s.l;)s.write_shift(-4,R.ENDOFCHAIN);for(o=0;o<n[4]<<2;++o){var d=e.FullPaths[o];if(d&&0!==d.length){c=e.FileIndex[o],0===o&&(c.start=c.size?c.start-1:y);var p=0===o&&r.root||c.name;if(u=2*(p.length+1),s.write_shift(64,p,"utf16le"),s.write_shift(2,u),s.write_shift(1,c.type),s.write_shift(1,c.color),s.write_shift(-4,c.L),s.write_shift(-4,c.R),s.write_shift(-4,c.C),c.clsid)s.write_shift(16,c.clsid,"hex");else for(h=0;h<4;++h)s.write_shift(4,0);s.write_shift(4,c.state||0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,c.start),s.write_shift(4,c.size),s.write_shift(4,0)}else{for(h=0;h<17;++h)s.write_shift(4,0);for(h=0;h<3;++h)s.write_shift(4,-1);for(h=0;h<12;++h)s.write_shift(4,0)}}for(o=1;o<e.FileIndex.length;++o)if((c=e.FileIndex[o]).size>=4096){for(s.l=c.start+1<<9,h=0;h<c.size;++h)s.write_shift(1,c.content[h]);for(;511&h;++h)s.write_shift(1,0)}for(o=1;o<e.FileIndex.length;++o)if((c=e.FileIndex[o]).size>0&&c.size<4096){for(h=0;h<c.size;++h)s.write_shift(1,c.content[h]);for(;63&h;++h)s.write_shift(1,0)}for(;s.l<s.length;)s.write_shift(1,0);return s}t.version="1.1.4";var m,v=64,y=-2,T="d0cf11e0a1b11ae1",E=[208,207,17,224,161,177,26,225],A="00000000000000000000000000000000",R={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:y,FREESECT:-1,HEADER_SIGNATURE:T,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:A,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function D(e){for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function M(e){return m?m.deflateRawSync(e):$(e)}for(var N,P,k=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],L=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],B=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],U="undefined"!=typeof Uint8Array,G=U?new Uint8Array(256):[],j=0;j<256;++j)G[j]=(void 0,255&((P=139536&((N=j)<<1|N<<11)|558144&(N<<5|N<<15))>>16|P>>8|P));function V(e,t){var r=G[255&e];return t<=8?r>>>8-t:(r=r<<8|G[e>>8&255],t<=16?r>>>16-t:(r=r<<8|G[e>>16&255])>>>24-t)}function z(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=6?0:e[n+1]<<8))>>>r&3}function H(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=5?0:e[n+1]<<8))>>>r&7}function X(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=3?0:e[n+1]<<8))>>>r&31}function W(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=1?0:e[n+1]<<8))>>>r&127}function q(e,t,r){var n=7&t,i=t>>>3,s=(1<<r)-1,o=e[i]>>>n;return r<8-n||(o|=e[i+1]<<8-n,r<16-n)||(o|=e[i+2]<<16-n,r<24-n)||(o|=e[i+3]<<24-n),o&s}function Y(e,t){var r=e.length,n=2*r>t?2*r:t+5,i=0;if(r>=t)return e;if(g){var s=x(n);if(e.copy)e.copy(s);else for(;i<e.length;++i)s[i]=e[i];return s}if(U){var o=new Uint8Array(n);if(o.set)o.set(e);else for(;i<e.length;++i)o[i]=e[i];return o}return e.length=n,e}function J(e){for(var t=new Array(e),r=0;r<e;++r)t[r]=0;return t}var K,$=(K=function(e,t){for(var r=0;r<e.length;){var n=Math.min(65535,e.length-r),i=r+n==e.length;for(t.write_shift(1,+i),t.write_shift(2,n),t.write_shift(2,65535&~n);n-- >0;)t[t.l++]=e[r++]}return t.l},function(e){var t=Lt(50+Math.floor(1.1*e.length)),r=K(e,t);return t.slice(0,r)});function Q(e,t,r){var n=1,i=0,s=0,o=0,a=0,l=e.length,h=U?new Uint16Array(32):J(32);for(s=0;s<32;++s)h[s]=0;for(s=l;s<r;++s)e[s]=0;l=e.length;var u=U?new Uint16Array(l):J(l);for(s=0;s<l;++s)h[i=e[s]]++,n<i&&(n=i),u[s]=0;for(h[0]=0,s=1;s<=n;++s)h[s+16]=a=a+h[s-1]<<1;for(s=0;s<l;++s)0!=(a=e[s])&&(u[s]=h[a+16]++);var c=0;for(s=0;s<l;++s)if(0!=(c=e[s]))for(a=V(u[s],n)>>n-c,o=(1<<n+4-c)-1;o>=0;--o)t[a|o<<c]=15&c|s<<4;return n}var Z=U?new Uint16Array(512):J(512),ee=U?new Uint16Array(32):J(32);if(!U){for(var te=0;te<512;++te)Z[te]=0;for(te=0;te<32;++te)ee[te]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);Q(e,ee,32);var r=[];for(t=0;t<=143;t++)r.push(8);for(;t<=255;t++)r.push(9);for(;t<=279;t++)r.push(7);for(;t<=287;t++)r.push(8);Q(r,Z,288)}();var re=U?new Uint16Array(32768):J(32768),ne=U?new Uint16Array(32768):J(32768),ie=U?new Uint16Array(128):J(128),se=1,oe=1;function ae(e,t){var r=X(e,t)+257,n=X(e,t+=5)+1,i=function(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=4?0:e[n+1]<<8))>>>r&15}(e,t+=5)+4;t+=4;for(var s=0,o=U?new Uint8Array(19):J(19),a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=1,h=U?new Uint8Array(8):J(8),u=U?new Uint8Array(8):J(8),c=o.length,d=0;d<i;++d)o[k[d]]=s=H(e,t),l<s&&(l=s),h[s]++,t+=3;var f=0;for(h[0]=0,d=1;d<=l;++d)u[d]=f=f+h[d-1]<<1;for(d=0;d<c;++d)0!=(f=o[d])&&(a[d]=u[f]++);var p=0;for(d=0;d<c;++d)if(0!=(p=o[d])){f=G[a[d]]>>8-p;for(var m=(1<<7-p)-1;m>=0;--m)ie[f|m<<p]=7&p|d<<3}var _=[];for(l=1;_.length<r+n;)switch(f=ie[W(e,t)],t+=7&f,f>>>=3){case 16:for(s=3+z(e,t),t+=2,f=_[_.length-1];s-- >0;)_.push(f);break;case 17:for(s=3+H(e,t),t+=3;s-- >0;)_.push(0);break;case 18:for(s=11+W(e,t),t+=7;s-- >0;)_.push(0);break;default:_.push(f),l<f&&(l=f)}var g=_.slice(0,r),v=_.slice(r);for(d=r;d<286;++d)g[d]=0;for(d=n;d<30;++d)v[d]=0;return se=Q(g,re,286),oe=Q(v,ne,30),t}function le(e,t){var r=function(e,t){if(3==e[0]&&!(3&e[1]))return[b(t),2];for(var r=0,n=0,i=x(t||1<<18),s=0,o=i.length>>>0,a=0,l=0;0==(1&n);)if(n=H(e,r),r+=3,n>>>1!=0)for(n>>>1==1?(a=9,l=5):(r=ae(e,r),a=se,l=oe),!t&&o<s+32767&&(o=(i=Y(i,s+32767)).length);;){var h=q(e,r,a),u=n>>>1==1?Z[h]:re[h];if(r+=15&u,0==((u>>>=4)>>>8&255))i[s++]=u;else{if(256==u)break;var c=(u-=257)<8?0:u-4>>2;c>5&&(c=0);var d=s+L[u];c>0&&(d+=q(e,r,c),r+=c),h=q(e,r,l),r+=15&(u=n>>>1==1?ee[h]:ne[h]);var f=(u>>>=4)<4?0:u-2>>1,p=B[u];for(f>0&&(p+=q(e,r,f),r+=f),!t&&o<d&&(o=(i=Y(i,d)).length);s<d;)i[s]=i[s-p],++s}}else{7&r&&(r+=8-(7&r));var m=e[r>>>3]|e[1+(r>>>3)]<<8;if(r+=32,!t&&o<s+m&&(o=(i=Y(i,s+m)).length),"function"==typeof e.copy)e.copy(i,s,r>>>3,(r>>>3)+m),s+=m,r+=8*m;else for(;m-- >0;)i[s++]=e[r>>>3],r+=8}return[t?i:i.slice(0,s),r+7>>>3]}(e.slice(e.l||0),t);return e.l+=r[1],r[0]}function he(e,t){if(!e)throw new Error(t);"undefined"!=typeof console&&console.error(t)}function ue(e,t){var r=e;kt(r,0);var n={FileIndex:[],FullPaths:[]};d(n,{root:t.root});for(var i=r.length-4;(80!=r[i]||75!=r[i+1]||5!=r[i+2]||6!=r[i+3])&&i>=0;)--i;r.l=i+4,r.l+=4;var o=r.read_shift(2);r.l+=6;var a=r.read_shift(4);for(r.l=a,i=0;i<o;++i){r.l+=20;var l=r.read_shift(4),h=r.read_shift(4),u=r.read_shift(2),c=r.read_shift(2),f=r.read_shift(2);r.l+=8;var p=r.read_shift(4),m=s(r.slice(r.l+u,r.l+u+c));r.l+=u+c+f;var _=r.l;r.l=p+4,ce(r,l,h,n,m),r.l=_}return n}function ce(e,t,r,n,i){e.l+=2;var o=e.read_shift(2),a=e.read_shift(2),l=function(e){var t=65535&e.read_shift(2),r=65535&e.read_shift(2),n=new Date,i=31&r,s=15&(r>>>=5);r>>>=4,n.setMilliseconds(0),n.setFullYear(r+1980),n.setMonth(s-1),n.setDate(i);var o=31&t,a=63&(t>>>=5);return t>>>=6,n.setHours(t),n.setMinutes(a),n.setSeconds(o<<1),n}(e);if(8257&o)throw new Error("Unsupported ZIP encryption");for(var h=e.read_shift(4),u=e.read_shift(4),c=e.read_shift(4),d=e.read_shift(2),f=e.read_shift(2),p="",_=0;_<d;++_)p+=String.fromCharCode(e[e.l++]);if(f){var g=s(e.slice(e.l,e.l+f));(g[21589]||{}).mt&&(l=g[21589].mt),((i||{})[21589]||{}).mt&&(l=i[21589].mt)}e.l+=f;var v=e.slice(e.l,e.l+u);switch(a){case 8:v=function(e,t){if(!m)return le(e,t);var r=new(0,m.InflateRaw),n=r._processChunk(e.slice(e.l),r._finishFlushFlag);return e.l+=r.bytesRead,n}(e,c);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+a)}var y=!1;8&o&&(134695760==(h=e.read_shift(4))&&(h=e.read_shift(4),y=!0),u=e.read_shift(4),c=e.read_shift(4)),u!=t&&he(y,"Bad compressed size: "+t+" != "+u),c!=r&&he(y,"Bad uncompressed size: "+r+" != "+c);var b=I.buf(v,0);h>>0!=b>>0&&he(y,"Bad CRC32 checksum: "+h+" != "+b),de(n,p,v,{unsafe:!0,mt:l})}function de(e,t,r,i){var s=i&&i.unsafe;s||d(e);var o=!s&&F.find(e,t);if(!o){var a=e.FullPaths[0];t.slice(0,a.length)==a?a=t:("/"!=a.slice(-1)&&(a+="/"),a=(a+t).replace("//","/")),o={name:n(t),type:2},e.FileIndex.push(o),e.FullPaths.push(a),s||F.utils.cfb_gc(e)}return o.content=r,o.size=r?r.length:0,i&&(i.CLSID&&(o.clsid=i.CLSID),i.mt&&(o.mt=i.mt),i.ct&&(o.ct=i.ct)),o}return t.find=function(e,t){var r=e.FullPaths.map((function(e){return e.toUpperCase()})),n=r.map((function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]})),i=!1;47===t.charCodeAt(0)?(i=!0,t=r[0].slice(0,-1)+t):i=-1!==t.indexOf("/");var s=t.toUpperCase(),o=!0===i?r.indexOf(s):n.indexOf(s);if(-1!==o)return e.FileIndex[o];var a=!s.match(O);for(s=s.replace(C,""),a&&(s=s.replace(O,"!")),o=0;o<r.length;++o)if((a?r[o].replace(O,"!"):r[o]).replace(C,"")==s||(a?n[o].replace(O,"!"):n[o]).replace(C,"")==s)return e.FileIndex[o];return null},t.read=function(t,r){switch(r&&r.type||"base64"){case"file":return function(t,r){return o(),a(e.readFileSync(t),r)}(t,r);case"base64":return a(S(_.decode(t)),r);case"binary":return a(S(t),r)}return a(t,r)},t.parse=a,t.write=function(t,r){var n=p(t,r);switch(r&&r.type){case"file":return o(),e.writeFileSync(r.filename,n),n;case"binary":return D(n);case"base64":return _.encode(D(n))}return n},t.writeFile=function(t,r,n){o();var i=p(t,n);e.writeFileSync(r,i)},t.utils={cfb_new:function(e){var t={};return d(t,e),t},cfb_add:de,cfb_del:function(e,t){d(e);var r=F.find(e,t);if(r)for(var n=0;n<e.FileIndex.length;++n)if(e.FileIndex[n]==r)return e.FileIndex.splice(n,1),e.FullPaths.splice(n,1),!0;return!1},cfb_mov:function(e,t,r){d(e);var i=F.find(e,t);if(i)for(var s=0;s<e.FileIndex.length;++s)if(e.FileIndex[s]==i)return e.FileIndex[s].name=n(r),e.FullPaths[s]=r,!0;return!1},cfb_gc:function(e){f(e,!0)},ReadShift:It,CheckField:Pt,prep_blob:kt,bconcat:w,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");m=e}catch(e){console.error("cannot use native zlib: "+(e.message||e))}},_deflateRaw:$,_inflateRaw:le,consts:R},t}();if(void 0!==__require)try{k=require_fs()}catch(e){}function L(e){return"string"==typeof e?T(e):Array.isArray(e)?function(e){if("undefined"==typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(e)}(e):e}function B(e,t,r){if(void 0!==k&&k.writeFileSync)return r?k.writeFileSync(e,t,r):k.writeFileSync(e,t);var n="utf8"==r?Fe(t):t;if("undefined"!=typeof IE_SaveFile)return IE_SaveFile(n,e);if("undefined"!=typeof Blob){var i=new Blob([L(n)],{type:"application/octet-stream"});if("undefined"!=typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if("undefined"!=typeof saveAs)return saveAs(i,e);if("undefined"!=typeof URL&&"undefined"!=typeof document&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if("object"==typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout((function(){URL.revokeObjectURL(s)}),6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var o=document.createElement("a");if(null!=o.download)return o.download=e,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout((function(){URL.revokeObjectURL(s)}),6e4),s}}if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var a=File(e);return a.open("w"),a.encoding="binary",Array.isArray(t)&&(t=E(t)),a.write(t),a.close(),t}catch(e){if(!e.message||!e.message.match(/onstruct/))throw e}throw new Error("cannot save file "+e)}function U(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function G(e,t){for(var r=[],n=U(e),i=0;i!==n.length;++i)null==r[e[n[i]][t]]&&(r[e[n[i]][t]]=n[i]);return r}function j(e){for(var t=[],r=U(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function V(e){for(var t=[],r=U(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}var z=new Date(1899,11,30,0,0,0);function H(e,t){var r=e.getTime();return t&&(r-=1263168e5),(r-(z.getTime()+6e4*(e.getTimezoneOffset()-z.getTimezoneOffset())))/864e5}var X=new Date,W=z.getTime()+6e4*(X.getTimezoneOffset()-z.getTimezoneOffset()),q=X.getTimezoneOffset();function Y(e){var t=new Date;return t.setTime(24*e*60*60*1e3+W),t.getTimezoneOffset()!==q&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-q)),t}function J(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(!n)throw new Error("Unsupported ISO Duration Field: M");r*=60}t+=r*parseInt(i[s],10)}return t}var K=new Date("2017-02-19T19:06:09.000Z");isNaN(K.getFullYear())&&(K=new Date("2/19/17"));var Q=2017==K.getFullYear();function Z(e,t){var r=new Date(e);if(Q)return t>0?r.setTime(r.getTime()+60*r.getTimezoneOffset()*1e3):t<0&&r.setTime(r.getTime()-60*r.getTimezoneOffset()*1e3),r;if(e instanceof Date)return e;if(1917==K.getFullYear()&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-60*s.getTimezoneOffset()*1e3)),s}function ee(e){for(var t="",r=0;r!=e.length;++r)t+=String.fromCharCode(e[r]);return t}function te(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=te(e[r]));return t}function re(e,t){for(var r="";r.length<t;)r+=e;return r}function ne(e){var t=Number(e);if(!isNaN(t)||!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,(function(){return r*=100,""}));return isNaN(t=Number(n))&&(n=n.replace(/[(](.*)[)]/,(function(e,t){return r=-r,t})),isNaN(t=Number(n)))?t:t/r}function ie(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),s=t.getDate();return isNaN(s)||n<0||n>8099?r:(i>0||s>1)&&101!=n||e.toLowerCase().match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)?t:e.match(/[^-0-9:,\/\\]/)?r:t}var se,oe=5=="abacaba".split(/(:?b)/i).length;function ae(e){return e?e.data?d(e.data):e.asNodeBuffer&&g?d(e.asNodeBuffer().toString("binary")):e.asBinary?d(e.asBinary()):e._data&&e._data.getContent?d(ee(Array.prototype.slice.call(e._data.getContent(),0))):e.content&&e.type?d(ee(e.content)):null:null}function le(e,t){for(var r=e.FullPaths||U(e.files),n=t.toLowerCase(),i=n.replace(/\//g,"\\"),s=0;s<r.length;++s){var o=r[s].toLowerCase();if(n==o||i==o)return e.files[r[s]]}return null}function he(e,t){var r=le(e,t);if(null==r)throw new Error("Cannot find file "+t+" in zip");return r}function ue(e,t,r){if(!r)return(n=he(e,t))&&".bin"===n.name.slice(-4)?function(e){if(!e)return null;if(e.data)return c(e.data);if(e.asNodeBuffer&&g)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return"string"==typeof t?c(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}(n):ae(n);var n;if(!t)return null;try{return ue(e,t)}catch(e){return null}}function ce(e,t,r){if(!r)return ae(he(e,t));if(!t)return null;try{return ce(e,t)}catch(e){return null}}function de(e,t,r){e.FullPaths?F.utils.cfb_add(e,t,r):e.file(t,r)}function fe(){return se?new se:F.utils.cfb_new()}function pe(e,t){if("/"==e.charAt(0))return e.slice(1);var r=t.split("/");"/"!=t.slice(-1)&&r.pop();for(var n=e.split("/");0!==n.length;){var i=n.shift();".."===i?r.pop():"."!==i&&r.push(i)}return r.join("/")}"undefined"!=typeof JSZipSync&&(se=JSZipSync),void 0!==e&&void 0!==t&&t.exports&&void 0===se&&(se=require_jszip());var me='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',_e=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,ge=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm;me.match(ge)||(ge=/<[^>]*>/g);var ve=/<\w*:/,ye=/<(\/?)\w+:/;function be(e,t,r){for(var n={},i=0,s=0;i!==e.length&&32!==(s=e.charCodeAt(i))&&10!==s&&13!==s;++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var o=e.match(_e),a=0,l="",h=0,u="",c="",d=1;if(o)for(h=0;h!=o.length;++h){for(c=o[h],s=0;s!=c.length&&61!==c.charCodeAt(s);++s);for(u=c.slice(0,s).trim();32==c.charCodeAt(s+1);)++s;for(d=34==(i=c.charCodeAt(s+1))||39==i?1:0,l=c.slice(s+1+d,c.length-d),a=0;a!=u.length&&58!==u.charCodeAt(a);++a);if(a===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,r||(n[u.toLowerCase()]=l);else{var f=(5===a&&"xmlns"===u.slice(0,5)?"xmlns":"")+u.slice(a+1);if(n[f]&&"ext"==u.slice(a-3,a))continue;n[f]=l,r||(n[f.toLowerCase()]=l)}}return n}function xe(e){return e.replace(ye,"<$1")}var Se,Te,Ee={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Ae=j(Ee),we=(Se=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,Te=/_x([\da-fA-F]{4})_/gi,function e(t){var r=t+"",n=r.indexOf("<![CDATA[");if(-1==n)return r.replace(Se,(function(e,t){return Ee[e]||String.fromCharCode(parseInt(t,e.indexOf("x")>-1?16:10))||e})).replace(Te,(function(e,t){return String.fromCharCode(parseInt(t,16))}));var i=r.indexOf("]]>");return e(r.slice(0,n))+r.slice(n+9,i)+e(r.slice(i+3))}),Ce=/[&<>'"]/g,Oe=/[\u0000-\u0008\u000b-\u001f]/g;function Re(e){return(e+"").replace(Ce,(function(e){return Ae[e]})).replace(Oe,(function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"}))}function De(e){return Re(e).replace(/ /g,"_x0020_")}var Ie=/[\u0000-\u001f]/g;function Me(e){return(e+"").replace(Ce,(function(e){return Ae[e]})).replace(/\n/g,"<br/>").replace(Ie,(function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"}))}var Ne=function(){var e=/&#(\d+);/g;function t(e,t){return String.fromCharCode(parseInt(t,10))}return function(r){return r.replace(e,t)}}();function Pe(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}var ke=function(e){for(var t="",r=0,n=0,i=0,s=0,o=0,a=0;r<e.length;)(n=e.charCodeAt(r++))<128?t+=String.fromCharCode(n):(i=e.charCodeAt(r++),n>191&&n<224?(o=(31&n)<<6,o|=63&i,t+=String.fromCharCode(o)):(s=e.charCodeAt(r++),n<240?t+=String.fromCharCode((15&n)<<12|(63&i)<<6|63&s):(a=((7&n)<<18|(63&i)<<12|(63&s)<<6|63&(o=e.charCodeAt(r++)))-65536,t+=String.fromCharCode(55296+(a>>>10&1023)),t+=String.fromCharCode(56320+(1023&a)))));return t},Fe=function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(63&n)));break;case n>=55296&&n<57344:n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(63&i)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(63&n)))}return t.join("")};if(g){var Le=function(e){var t,r,n,i=Buffer.alloc(2*e.length),s=1,o=0,a=0;for(r=0;r<e.length;r+=s)s=1,(n=e.charCodeAt(r))<128?t=n:n<224?(t=64*(31&n)+(63&e.charCodeAt(r+1)),s=2):n<240?(t=4096*(15&n)+64*(63&e.charCodeAt(r+1))+(63&e.charCodeAt(r+2)),s=3):(s=4,t=262144*(7&n)+4096*(63&e.charCodeAt(r+1))+64*(63&e.charCodeAt(r+2))+(63&e.charCodeAt(r+3)),a=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==a&&(i[o++]=255&a,i[o++]=a>>>8,a=0),i[o++]=t%256,i[o++]=t>>>8;return i.slice(0,o).toString("ucs2")},Be="foo bar baz";ke(Be)==Le(Be)&&(ke=Le);var Ue=function(e){return v(e,"binary").toString("utf8")};ke(Be)==Ue(Be)&&(ke=Ue),Fe=function(e){return v(e,"utf8").toString("binary")}}var Ge,je,Ve,ze=(Ve={},function(e,t){var r=e+"|"+(t||"");return Ve[r]?Ve[r]:Ve[r]=new RegExp("<(?:\\w+:)?"+e+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+e+">",t||"")}),He=(je=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map((function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]})),function(e){for(var t=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),r=0;r<je.length;++r)t=t.replace(je[r][0],je[r][1]);return t}),Xe=(Ge={},function(e){return void 0!==Ge[e]?Ge[e]:Ge[e]=new RegExp("<(?:vt:)?"+e+">([\\s\\S]*?)</(?:vt:)?"+e+">","g")}),We=/<\/?(?:vt:)?variant>/g,qe=/<(?:vt:)([^>]*)>([\s\S]*)</;function Ye(e,t){var r=be(e),n=e.match(Xe(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach((function(e){var t=e.replace(We,"").match(qe);t&&i.push({v:ke(t[2]),t:t[1]})})),i}var Je=/(^\s|\s$|\n)/;function Ke(e,t){return"<"+e+(t.match(Je)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function $e(e){return U(e).map((function(t){return" "+t+'="'+e[t]+'"'})).join("")}function Qe(e,t,r){return"<"+e+(null!=r?$e(r):"")+(null!=t?(t.match(Je)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Ze(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(e){if(t)throw e}return""}var et,tt,rt={dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema",main:["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"]},nt="urn:schemas-microsoft-com:office:office",it="urn:schemas-microsoft-com:office:excel",st="urn:schemas-microsoft-com:office:spreadsheet",ot=function(e){for(var t=[],r=0;r<e[0].length;++r)if(e[0][r])for(var n=0,i=e[0][r].length;n<i;n+=10240)t.push.apply(t,e[0][r].slice(n,n+10240));return t},at=ot,lt=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(wt(e,i)));return n.join("").replace(C,"")},ht=lt,ut=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},ct=ut,dt=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(At(e,i)));return n.join("")},ft=dt,pt=function(e,t){var r=Ot(e,t);return r>0?dt(e,t+4,t+4+r-1):""},mt=pt,_t=function(e,t){var r=Ot(e,t);return r>0?dt(e,t+4,t+4+r-1):""},gt=_t,vt=function(e,t){var r=2*Ot(e,t);return r>0?dt(e,t+4,t+4+r-1):""},yt=vt;et=tt=function(e,t){var r=Ot(e,t);return r>0?lt(e,t+4,t+4+r):""};var bt,xt,St=function(e,t){var r=Ot(e,t);return r>0?dt(e,t+4,t+4+r):""},Tt=St;bt=xt=function(e,t){return function(e,t){for(var r=1-2*(e[t+7]>>>7),n=((127&e[t+7])<<4)+(e[t+6]>>>4&15),i=15&e[t+6],s=5;s>=0;--s)i=256*i+e[t+s];return 2047==n?0==i?r*(1/0):NaN:(0==n?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}(e,t)};var Et=function(e){return Array.isArray(e)};g&&(lt=function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(C,""):ht(e,t,r)},ut=function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):ct(e,t,r)},pt=function(e,t){if(!Buffer.isBuffer(e))return mt(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},_t=function(e,t){if(!Buffer.isBuffer(e))return gt(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},vt=function(e,t){if(!Buffer.isBuffer(e))return yt(e,t);var r=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r-1)},et=function(e,t){if(!Buffer.isBuffer(e))return tt(e,t);var r=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r)},St=function(e,t){if(!Buffer.isBuffer(e))return Tt(e,t);var r=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+r)},dt=function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):ft(e,t,r)},ot=function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0]):at(e)},w=function(e){return Buffer.isBuffer(e[0])?Buffer.concat(e):[].concat.apply([],e)},bt=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):xt(e,t)},Et=function(e){return Buffer.isBuffer(e)||Array.isArray(e)}),"undefined"!=typeof cptable&&(lt=function(e,t,r){return cptable.utils.decode(1200,e.slice(t,r)).replace(C,"")},dt=function(e,t,r){return cptable.utils.decode(65001,e.slice(t,r))},pt=function(e,t){var r=Ot(e,t);return r>0?cptable.utils.decode(i,e.slice(t+4,t+4+r-1)):""},_t=function(e,t){var r=Ot(e,t);return r>0?cptable.utils.decode(n,e.slice(t+4,t+4+r-1)):""},vt=function(e,t){var r=2*Ot(e,t);return r>0?cptable.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},et=function(e,t){var r=Ot(e,t);return r>0?cptable.utils.decode(1200,e.slice(t+4,t+4+r)):""},St=function(e,t){var r=Ot(e,t);return r>0?cptable.utils.decode(65001,e.slice(t+4,t+4+r)):""});var At=function(e,t){return e[t]},wt=function(e,t){return 256*e[t+1]+e[t]},Ct=function(e,t){var r=256*e[t+1]+e[t];return r<32768?r:-1*(65535-r+1)},Ot=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Rt=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Dt=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function It(e,t){var r,i,s,o,a,l,h="",u=[];switch(t){case"dbcs":if(l=this.l,g&&Buffer.isBuffer(this))h=this.slice(this.l,this.l+2*e).toString("utf16le");else for(a=0;a<e;++a)h+=String.fromCharCode(wt(this,l)),l+=2;e*=2;break;case"utf8":h=dt(this,this.l,this.l+e);break;case"utf16le":e*=2,h=lt(this,this.l,this.l+e);break;case"wstr":if("undefined"==typeof cptable)return It.call(this,e,"dbcs");h=cptable.utils.decode(n,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":h=pt(this,this.l),e=4+Ot(this,this.l);break;case"lpstr-cp":h=_t(this,this.l),e=4+Ot(this,this.l);break;case"lpwstr":h=vt(this,this.l),e=4+2*Ot(this,this.l);break;case"lpp4":e=4+Ot(this,this.l),h=et(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+Ot(this,this.l),h=St(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,h="";0!==(s=At(this,this.l+e++));)u.push(f(s));h=u.join("");break;case"_wstr":for(e=0,h="";0!==(s=wt(this,this.l+e));)u.push(f(s)),e+=2;e+=2,h=u.join("");break;case"dbcs-cont":for(h="",l=this.l,a=0;a<e;++a){if(this.lens&&-1!==this.lens.indexOf(l))return s=At(this,l),this.l=l+1,o=It.call(this,e-a,s?"dbcs-cont":"sbcs-cont"),u.join("")+o;u.push(f(wt(this,l))),l+=2}h=u.join(""),e*=2;break;case"cpstr":if("undefined"!=typeof cptable){h=cptable.utils.decode(n,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(h="",l=this.l,a=0;a!=e;++a){if(this.lens&&-1!==this.lens.indexOf(l))return s=At(this,l),this.l=l+1,o=It.call(this,e-a,s?"dbcs-cont":"sbcs-cont"),u.join("")+o;u.push(f(At(this,l))),l+=1}h=u.join("");break;default:switch(e){case 1:return r=At(this,this.l),this.l++,r;case 2:return r=("i"===t?Ct:wt)(this,this.l),this.l+=2,r;case 4:case-4:return"i"===t||0==(128&this[this.l+3])?(r=(e>0?Rt:Dt)(this,this.l),this.l+=4,r):(i=Ot(this,this.l),this.l+=4,i);case 8:case-8:if("f"===t)return i=8==e?bt(this,this.l):bt([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:h=ut(this,this.l,e)}}return this.l+=e,h}var Mt=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255};function Nt(e,t,r){var n=0,s=0;if("dbcs"===r){for(s=0;s!=t.length;++s)Mt(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if("sbcs"===r){if("undefined"!=typeof cptable&&874==i)for(s=0;s!=t.length;++s){var o=cptable.utils.encode(i,t.charAt(s));this[this.l+s]=o[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=255&t.charCodeAt(s);n=t.length}else{if("hex"===r){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}if("utf16le"===r){var a=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var l=t.charCodeAt(s);this[this.l++]=255&l,this[this.l++]=l>>8}for(;this.l<a;)this[this.l++]=0;return this}switch(e){case 1:n=1,this[this.l]=255&t;break;case 2:n=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:n=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:n=4,function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255}(this,t,this.l);break;case 8:if(n=8,"f"===r){!function(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,o=n?-t:t;isFinite(o)?0==o?i=s=0:(i=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var a=0;a<=5;++a,s/=256)e[r+a]=255&s;e[r+6]=(15&i)<<4|15&s,e[r+7]=i>>4|n}(this,t,this.l);break}case 16:break;case-4:n=4,function(e,t,r){e[r]=255&t,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255}(this,t,this.l)}}return this.l+=n,this}function Pt(e,t){var r=ut(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function kt(e,t){e.l=t,e.read_shift=It,e.chk=Pt,e.write_shift=Nt}function Ft(e,t){e.l+=t}function Lt(e){var t=b(e);return kt(t,0),t}function Bt(e,t,r){if(e){var n,i,s;kt(e,e.l||0);for(var o=e.length,a=0,l=0;e.l<o;){128&(a=e.read_shift(1))&&(a=(127&a)+((127&e.read_shift(1))<<7));var h=Ml[a]||Ml[65535];for(s=127&(n=e.read_shift(1)),i=1;i<4&&128&n;++i)s+=(127&(n=e.read_shift(1)))<<7*i;l=e.l+s;var u=(h.f||Ft)(e,s,r);if(e.l=l,t(u,h.n,a))return}}}function Ut(){var e=[],t=g?256:2048,r=function(e){var t=Lt(e);return kt(t,0),t},n=r(t),i=function(){!n||(n.length>n.l&&((n=n.slice(0,n.l)).l=n.length),n.length>0&&e.push(n),n=null)},s=function(e){return n&&e<n.length-n.l?n:(i(),n=r(Math.max(e+1,t)))};return{next:s,push:function(e){i(),null==(n=e).l&&(n.l=n.length),s(t)},end:function(){return i(),ot([e])},_bufs:e}}function Gt(e,t,r,n){var i,s=+Nl[t];if(!isNaN(s)){n||(n=Ml[s].p||(r||[]).length||0),i=1+(s>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var o=e.next(i);s<=127?o.write_shift(1,s):(o.write_shift(1,128+(127&s)),o.write_shift(1,s>>7));for(var a=0;4!=a;++a){if(!(n>=128)){o.write_shift(1,n);break}o.write_shift(1,128+(127&n)),n>>=7}n>0&&Et(r)&&e.push(r)}}function jt(e,t,r){var n=te(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Vt(e,t,r){var n=te(e);return n.s=jt(n.s,t.s,r),n.e=jt(n.e,t.s,r),n}function zt(e,t){if(e.cRel&&e.c<0)for(e=te(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=te(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Kt(e);return!e.cRel&&null!=e.cRel&&(r=r.replace(/^([A-Z])/,"$$$1")),!e.rRel&&null!=e.rRel&&(r=r.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")),r}function Ht(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?zt(e.s,t.biff)+":"+zt(e.e,t.biff):(e.s.rRel?"":"$")+Wt(e.s.r)+":"+(e.e.rRel?"":"$")+Wt(e.e.r):(e.s.cRel?"":"$")+Yt(e.s.c)+":"+(e.e.cRel?"":"$")+Yt(e.e.c)}function Xt(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function Wt(e){return""+(e+1)}function qt(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Yt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Jt(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function Kt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function $t(e){var t=e.indexOf(":");return-1==t?{s:Jt(e),e:Jt(e)}:{s:Jt(e.slice(0,t)),e:Jt(e.slice(t+1))}}function Qt(e,t){return void 0===t||"number"==typeof t?Qt(e.s,e.e):("string"!=typeof e&&(e=Kt(e)),"string"!=typeof t&&(t=Kt(t)),e==t?e:e+":"+t)}function Zt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=e.length;for(r=0;n<s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===s||58===e.charCodeAt(++n))return t.e.c=t.s.c,t.e.r=t.s.r,t;for(r=0;n!=s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function er(e,t,r){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),function(e,t){var r="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=R.format(e.z,r?H(t):t)}catch(e){}try{return e.w=R.format((e.XF||{}).numFmtId||(r?14:0),r?H(t):t)}catch(e){return""+t}}(e,null==t?e.v:t))}function tr(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function rr(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,s=e||(i?[]:{}),o=0,a=0;if(s&&null!=n.origin){if("number"==typeof n.origin)o=n.origin;else{var l="string"==typeof n.origin?Jt(n.origin):n.origin;o=l.r,a=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=Zt(s["!ref"]);h.s.c=u.s.c,h.s.r=u.s.r,h.e.c=Math.max(h.e.c,u.e.c),h.e.r=Math.max(h.e.r,u.e.r),-1==o&&(h.e.r=o=u.e.r+1)}for(var c=0;c!=t.length;++c)if(t[c]){if(!Array.isArray(t[c]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=t[c].length;++d)if(void 0!==t[c][d]){var f={v:t[c][d]},p=o+c,m=a+d;if(h.s.r>p&&(h.s.r=p),h.s.c>m&&(h.s.c=m),h.e.r<p&&(h.e.r=p),h.e.c<m&&(h.e.c=m),!t[c][d]||"object"!=typeof t[c][d]||Array.isArray(t[c][d])||t[c][d]instanceof Date)if(Array.isArray(f.v)&&(f.f=t[c][d][1],f.v=f.v[0]),null===f.v)if(f.f)f.t="n";else{if(!n.sheetStubs)continue;f.t="z"}else"number"==typeof f.v?f.t="n":"boolean"==typeof f.v?f.t="b":f.v instanceof Date?(f.z=n.dateNF||R._table[14],n.cellDates?(f.t="d",f.w=R.format(f.z,H(f.v))):(f.t="n",f.v=H(f.v),f.w=R.format(f.z,f.v))):f.t="s";else f=t[c][d];if(i)s[p]||(s[p]=[]),s[p][m]&&s[p][m].z&&(f.z=s[p][m].z),s[p][m]=f;else{var _=Kt({c:m,r:p});s[_]&&s[_].z&&(f.z=s[_].z),s[_]=f}}}return h.s.c<1e7&&(s["!ref"]=Qt(h)),s}function nr(e,t){return rr(null,e,t)}function ir(e,t){return t||(t=Lt(4)),t.write_shift(4,e),t}function sr(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function or(e,t){var r=!1;return null==t&&(r=!0,t=Lt(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function ar(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function lr(e,t){var r=e.l,n=e.read_shift(1),i=sr(e),s=[],o={t:i,h:i};if(0!=(1&n)){for(var a=e.read_shift(4),l=0;l!=a;++l)s.push(ar(e));o.r=s}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}!function(e,t){var r;if(void 0!==t)r=t;else if(void 0!==__require)try{r=require_crypto()}catch(e){r=null}e.rc4=function(e,t){var r=new Array(256),n=0,i=0,s=0,o=0;for(i=0;256!=i;++i)r[i]=i;for(i=0;256!=i;++i)s=s+r[i]+e[i%e.length].charCodeAt(0)&255,o=r[i],r[i]=r[s],r[s]=o;i=s=0;var a=b(t.length);for(n=0;n!=t.length;++n)s=(s+r[i=i+1&255])%256,o=r[i],r[i]=r[s],r[s]=o,a[n]=t[n]^r[r[i]+r[s]&255];return a},e.md5=function(e){if(!r)throw new Error("Unsupported crypto");return r.createHash("md5").update(e).digest("hex")}}({},"undefined"!=typeof crypto?crypto:void 0);var hr=lr;function ur(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function cr(e,t){return null==t&&(t=Lt(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var dr=sr,fr=or;function pr(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}function mr(e,t){var r=!1;return null==t&&(r=!0,t=Lt(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var _r=sr,gr=pr,vr=mr;function yr(e){var t=e.slice(e.l,e.l+4),r=1&t[0],n=2&t[0];e.l+=4,t[0]&=252;var i=0===n?bt([0,0,0,0,t[0],t[1],t[2],t[3]],0):Rt(t,0)>>2;return r?i/100:i}function br(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var xr=br,Sr=function(e,t){return t||(t=Lt(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t};function Tr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Er(e,t){return(t||Lt(8)).write_shift(8,e,"f")}function Ar(e,t){if(t||(t=Lt(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;null!=e.index?(t.write_shift(1,2),t.write_shift(1,e.index)):null!=e.theme?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),e.rgb&&null==e.theme){var n=e.rgb||"FFFFFF";"number"==typeof n&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}else t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);return t}function wr(e,t){var r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,1==t?"lpstr":"lpwstr")}var Cr=80,Or=[Cr,81],Rr={1:{n:"CodePage",t:2},2:{n:"Category",t:Cr},3:{n:"PresentationFormat",t:Cr},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:Cr},15:{n:"Company",t:Cr},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:Cr},27:{n:"ContentStatus",t:Cr},28:{n:"Language",t:Cr},29:{n:"Version",t:Cr},255:{}},Dr={1:{n:"CodePage",t:2},2:{n:"Title",t:Cr},3:{n:"Subject",t:Cr},4:{n:"Author",t:Cr},5:{n:"Keywords",t:Cr},6:{n:"Comments",t:Cr},7:{n:"Template",t:Cr},8:{n:"LastAuthor",t:Cr},9:{n:"RevNumber",t:Cr},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:Cr},19:{n:"DocSecurity",t:3},255:{}},Ir={2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}};!function(){for(var e in Ir)Object.prototype.hasOwnProperty.call(Ir,e)&&(Rr[e]=Dr[e]=Ir[e])}();var Mr,Nr=G(Rr,"n"),Pr=G(Dr,"n"),kr={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Fr=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Lr=[0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].map((function(e){return[e>>16&255,e>>8&255,255&e]})),Br=te(Lr),Ur={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Gr=V(Ur),jr={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.sheetMetadata":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"TODO","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"vba","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Vr=(U(Mr={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}}).forEach((function(e){["xlsm","xlam"].forEach((function(t){Mr[e][t]||(Mr[e][t]=Mr[e].xlsx)}))})),U(Mr).forEach((function(e){U(Mr[e]).forEach((function(t){jr[Mr[e][t]]=e}))})),Mr),zr=function(e){for(var t=[],r=U(e),n=0;n!==r.length;++n)null==t[e[r[n]]]&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}(jr);rt.CT="http://schemas.openxmlformats.org/package/2006/content-types";var Hr=Qe("Types",null,{xmlns:rt.CT,"xmlns:xsd":rt.xsd,"xmlns:xsi":rt.xsi}),Xr=[["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels",zr.rels[0]]].map((function(e){return Qe("Default",null,{Extension:e[0],ContentType:e[1]})})),Wr={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function qr(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Yr(e,t){var r={"!id":{}};if(!e)return r;"/"!==t.charAt(0)&&(t="/"+t);var n={};return(e.match(ge)||[]).forEach((function(e){var i=be(e);if("<Relationship"===i[0]){var s={};s.Type=i.Type,s.Target=i.Target,s.Id=i.Id,s.TargetMode=i.TargetMode;var o="External"===i.TargetMode?i.Target:pe(i.Target,t);r[o]=s,n[i.Id]=s}})),r["!id"]=n,r}rt.RELS="http://schemas.openxmlformats.org/package/2006/relationships";var Jr=Qe("Relationships",null,{xmlns:rt.RELS});function Kr(e){var t=[me,Jr];return U(e["!id"]).forEach((function(r){t[t.length]=Qe("Relationship",null,e["!id"][r])})),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}var $r=[Wr.HLINK,Wr.XPATH,Wr.XMISS];function Qr(e,t,r,n,i,s){if(i||(i={}),e["!id"]||(e["!id"]={}),t<0)for(t=1;e["!id"]["rId"+t];++t);if(i.Id="rId"+t,i.Type=n,i.Target=r,s?i.TargetMode=s:$r.indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}function Zr(e,t,r){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+'"/>\n',"  </rdf:Description>\n"].join("")}var en,tn=(en='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+r.version+"</meta:generator></office:meta></office:document-meta>",function(){return en}),rn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];rt.CORE_PROPS="http://schemas.openxmlformats.org/package/2006/metadata/core-properties",Wr.CORE_PROPS="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties";var nn=function(){for(var e=new Array(rn.length),t=0;t<rn.length;++t){var r=rn[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function sn(e){var t={};e=ke(e);for(var r=0;r<rn.length;++r){var n=rn[r],i=e.match(nn[r]);null!=i&&i.length>0&&(t[n[1]]=we(i[1])),"date"===n[2]&&t[n[1]]&&(t[n[1]]=Z(t[n[1]]))}return t}var on=Qe("cp:coreProperties",null,{"xmlns:cp":rt.CORE_PROPS,"xmlns:dc":rt.dc,"xmlns:dcterms":rt.dcterms,"xmlns:dcmitype":rt.dcmitype,"xmlns:xsi":rt.xsi});function an(e,t,r,n,i){null!=i[e]||null==t||""===t||(i[e]=t,t=Re(t),n[n.length]=r?Qe(e,t,r):Ke(e,t))}var ln=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function hn(e,t,r,n){var i=[];if("string"==typeof e)i=Ye(e,n);else for(var s=0;s<e.length;++s)i=i.concat(e[s].map((function(e){return{v:e}})));var o="string"==typeof t?Ye(t,n).map((function(e){return e.v})):t,a=0,l=0;if(o.length>0)for(var h=0;h!==i.length;h+=2){switch(l=+i[h+1].v,i[h].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=o.slice(a,a+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=o.slice(a,a+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=o.slice(a,a+l)}a+=l}}rt.EXT_PROPS="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",Wr.EXT_PROPS="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties";var un=Qe("Properties",null,{xmlns:rt.EXT_PROPS,"xmlns:vt":rt.vt});rt.CUST_PROPS="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",Wr.CUST_PROPS="http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties";var cn=/<[^>]+>[^<]*/g,dn=Qe("Properties",null,{xmlns:rt.CUST_PROPS,"xmlns:vt":rt.vt});var fn={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},pn=j(fn);function mn(e,t,r){e[t=pn[t]||t]=r}function _n(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date(1e3*(r/1e7*Math.pow(2,32)+t/1e7-11644473600)).toISOString().replace(/\.000/,"")}function gn(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function vn(e,t,r){var n=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(n.length+1&3)&3),n}function yn(e,t,r){return 31===t?vn(e):gn(e,0,r)}function bn(e,t,r){return yn(e,t,!1===r?0:4)}function xn(e){return[En(e,81),En(e,3)]}function Sn(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var s=e.read_shift(4),o=e.read_shift(4);n[s]=e.read_shift(o,1200===t?"utf16le":"utf8").replace(C,"").replace(O,"!"),1200===t&&o%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),n}function Tn(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(3&t)>0&&(e.l+=4-(3&t)&3),r}function En(e,t,r){var n,i=e.read_shift(2),s=r||{};if(e.l+=2,12!==t&&i!==t&&-1===Or.indexOf(t))throw new Error("Expected type "+t+" saw "+i);switch(12===t?i:t){case 2:return n=e.read_shift(2,"i"),s.raw||(e.l+=2),n;case 3:return e.read_shift(4,"i");case 11:return 0!==e.read_shift(4);case 19:return e.read_shift(4);case 30:return gn(e,0,4).replace(C,"");case 31:return vn(e);case 64:return _n(e);case 65:return Tn(e);case 71:return function(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}(e);case 80:return bn(e,i,!s.raw).replace(C,"");case 81:return function(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return yn(e,t,0)}(e,i).replace(C,"");case 4108:return function(e){return function(e){for(var t=e.read_shift(4),r=[],n=0;n!=t/2;++n)r.push(xn(e));return r}(e)}(e);case 4126:return function(e){return function(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(C,"");return r}(e)}(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+i)}}function An(e,t){var r=Lt(4),n=Lt(4);switch(r.write_shift(4,80==e?31:e),e){case 3:n.write_shift(-4,t);break;case 5:(n=Lt(8)).write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=function(e){var t=("string"==typeof e?new Date(Date.parse(e)):e).getTime()/1e3+11644473600,r=t%Math.pow(2,32),n=(t-r)/Math.pow(2,32);n*=1e7;var i=(r*=1e7)/Math.pow(2,32)|0;i>0&&(r%=Math.pow(2,32),n+=i);var s=Lt(8);return s.write_shift(4,r),s.write_shift(4,n),s}(t);break;case 31:case 80:for((n=Lt(4+2*(t.length+1)+(t.length%2?0:2))).write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return w([r,n])}function wn(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),s=[],o=0,a=0,l=-1,u={};for(o=0;o!=i;++o){var c=e.read_shift(4),d=e.read_shift(4);s[o]=[c,d+r]}s.sort((function(e,t){return e[1]-t[1]}));var f={};for(o=0;o!=i;++o){if(e.l!==s[o][1]){var p=!0;if(o>0&&t)switch(t[s[o-1][0]].t){case 2:e.l+2===s[o][1]&&(e.l+=2,p=!1);break;case 80:case 4108:e.l<=s[o][1]&&(e.l=s[o][1],p=!1)}if((!t||0==o)&&e.l<=s[o][1]&&(p=!1,e.l=s[o][1]),p)throw new Error("Read Error: Expected address "+s[o][1]+" at "+e.l+" :"+o)}if(t){var m=t[s[o][0]];if(f[m.n]=En(e,m.t,{raw:!0}),"version"===m.p&&(f[m.n]=String(f[m.n]>>16)+"."+("0000"+String(65535&f[m.n])).slice(-4)),"CodePage"==m.n)switch(f[m.n]){case 0:f[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:h(a=f[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[m.n])}}else if(1===s[o][0]){if(a=f.CodePage=En(e,2),h(a),-1!==l){var _=e.l;e.l=s[l][1],u=Sn(e,a),e.l=_}}else if(0===s[o][0]){if(0===a){l=o,e.l=s[o+1][1];continue}u=Sn(e,a)}else{var g,v=u[s[o][0]];switch(e[e.l]){case 65:e.l+=4,g=Tn(e);break;case 30:case 31:e.l+=4,g=bn(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,g=e.read_shift(4,"i");break;case 19:e.l+=4,g=e.read_shift(4);break;case 5:e.l+=4,g=e.read_shift(8,"f");break;case 11:e.l+=4,g=Nn(e,4);break;case 64:e.l+=4,g=Z(_n(e));break;default:throw new Error("unparsed value: "+e[e.l])}f[v]=g}}return e.l=r+n,f}var Cn=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"].concat(["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"]);function On(e){switch(typeof e){case"boolean":return 11;case"number":return(0|e)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64}return-1}function Rn(e,t,r){var n=Lt(8),i=[],s=[],o=8,a=0,l=Lt(8),h=Lt(8);if(l.write_shift(4,2),l.write_shift(4,1200),h.write_shift(4,1),s.push(l),i.push(h),o+=8+l.length,!t){(h=Lt(8)).write_shift(4,0),i.unshift(h);var u=[Lt(4)];for(u[0].write_shift(4,e.length),a=0;a<e.length;++a){var c=e[a][0];for((l=Lt(8+2*(c.length+1)+(c.length%2?0:2))).write_shift(4,a+2),l.write_shift(4,c.length+1),l.write_shift(0,c,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=w(u),s.unshift(l),o+=8+l.length}for(a=0;a<e.length;++a)if((!t||t[e[a][0]])&&!(Cn.indexOf(e[a][0])>-1)&&null!=e[a][1]){var d=e[a][1],f=0;if(t){var p=r[f=+t[e[a][0]]];if("version"==p.p&&"string"==typeof d){var m=d.split(".");d=(+m[0]<<16)+(+m[1]||0)}l=An(p.t,d)}else{var _=On(d);-1==_&&(_=31,d=String(d)),l=An(_,d)}s.push(l),(h=Lt(8)).write_shift(4,t?f:2+a),i.push(h),o+=8+l.length}var g=8*(s.length+1);for(a=0;a<s.length;++a)i[a].write_shift(4,g),g+=s[a].length;return n.write_shift(4,o),n.write_shift(4,s.length),w([n].concat(i).concat(s))}function Dn(e,t,r){var n=e.content;if(!n)return{};kt(n,0);var i,s,o,a,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var h=n.read_shift(4),u=n.read_shift(16);if(u!==F.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(1!==(i=n.read_shift(4))&&2!==i)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),a=n.read_shift(4),1===i&&a!==n.l)throw new Error("Length mismatch: "+a+" !== "+n.l);2===i&&(o=n.read_shift(16),l=n.read_shift(4));var c,d=wn(n,t),f={SystemIdentifier:h};for(var p in d)f[p]=d[p];if(f.FMTID=s,1===i)return f;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);try{c=wn(n,null)}catch(e){}for(p in c)f[p]=c[p];return f.FMTID=[s,o],f}function In(e,t,r,n,i,s){var o=Lt(i?68:48),a=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,F.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,i?68:48);var l=Rn(e,r,n);if(a.push(l),i){var h=Rn(i,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+l.length),a.push(h)}return w(a)}function Mn(e,t){return e.read_shift(t),null}function Nn(e,t){return 1===e.read_shift(t)}function Pn(e,t){return t||(t=Lt(2)),t.write_shift(2,+!!e),t}function kn(e){return e.read_shift(2,"u")}function Fn(e,t){return t||(t=Lt(2)),t.write_shift(2,e),t}function Ln(e,t){return function(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}(e,t,kn)}function Bn(e,t,r){var i=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont",o=n;r&&r.biff>=8&&(n=1200),r&&8!=r.biff?12==r.biff&&(s="wstr"):e.read_shift(1)&&(s="dbcs-cont"),r.biff>=2&&r.biff<=5&&(s="cpstr");var a=i?e.read_shift(i,s):"";return n=o,a}function Un(e){var t=n;n=1200;var r,i=e.read_shift(2),s=e.read_shift(1),o=4&s,a=8&s,l=1+(1&s),h=0,u={};a&&(h=e.read_shift(2)),o&&(r=e.read_shift(4));var c=2==l?"dbcs-cont":"sbcs-cont",d=0===i?"":e.read_shift(i,c);return a&&(e.l+=4*h),o&&(e.l+=r),u.t=d,a||(u.raw="<t>"+u.t+"</t>",u.r=u.t),n=t,u}function Gn(e){var t=e.t||"",r=Lt(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=Lt(2*t.length);return n.write_shift(2*t.length,t,"utf16le"),w([r,n])}function jn(e,t,r){if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}function Vn(e,t,r){var n=e.read_shift(r&&2==r.biff?1:2);return 0===n?(e.l++,""):jn(e,n,r)}function zn(e,t,r){if(r.biff>5)return Vn(e,0,r);var n=e.read_shift(1);return 0===n?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Hn(e,t,r){return r||(r=Lt(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function Xn(e){var t=e.read_shift(4);return t>0?e.read_shift(t,"utf16le").replace(C,""):""}function Wn(e){var t=Lt(512),r=0,n=e.Target,i=n.indexOf("#")>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3}t.write_shift(4,2),t.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(r=0;r<s.length;++r)t.write_shift(4,s[r]);if(28==i){for(n=n.slice(1),t.write_shift(4,n.length+1),r=0;r<n.length;++r)t.write_shift(2,n.charCodeAt(r));t.write_shift(2,0)}else if(2&i){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));for(t.write_shift(4,2*(n.length+1)),r=0;r<n.length;++r)t.write_shift(2,n.charCodeAt(r));t.write_shift(2,0)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));for(var o=0;"../"==n.slice(3*o,3*o+3)||"..\\"==n.slice(3*o,3*o+3);)++o;for(t.write_shift(2,o),t.write_shift(4,n.length+1),r=0;r<n.length;++r)t.write_shift(1,255&n.charCodeAt(r));for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function qn(e){return[e.read_shift(1),e.read_shift(1),e.read_shift(1),e.read_shift(1)]}function Yn(e,t){var r=qn(e);return r[3]=0,r}function Jn(e){return{r:e.read_shift(2),c:e.read_shift(2),ixfe:e.read_shift(2)}}function Kn(e,t,r,n){return n||(n=Lt(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function $n(e,t,r){var n=r.biff>8?4:2;return[e.read_shift(n),e.read_shift(n,"i"),e.read_shift(n,"i")]}function Qn(e){return[e.read_shift(2),yr(e)]}function Zn(e){var t=e.read_shift(2),r=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r}}}function ei(e,t){return t||(t=Lt(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function ti(e){var t=e.read_shift(2),r=e.read_shift(2);return{s:{c:e.read_shift(1),r:t},e:{c:e.read_shift(1),r}}}var ri=ti;function ni(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function ii(e){e.l+=2,e.l+=e.read_shift(2)}var si={0:ii,4:ii,5:ii,6:ii,7:function(e){return e.l+=4,e.cf=e.read_shift(2),{}},8:ii,9:ii,10:ii,11:ii,12:ii,13:function(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t},14:ii,15:ii,16:ii,17:ii,18:ii,19:ii,20:ii,21:ni};function oi(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),(t-=2)>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function ai(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":case"xla":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;default:throw new Error("unsupported BIFF version")}var s=Lt(i);return s.write_shift(2,n),s.write_shift(2,t),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function li(e,t){var r=!t||t.biff>=8?2:1,n=Lt(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function hi(e,t,r){var n=0;r&&2==r.biff||(n=e.read_shift(2));var i=e.read_shift(2);return r&&2==r.biff&&(n=1-(i>>15),i&=32767),[{Unsynced:1&n,DyZero:(2&n)>>1,ExAsc:(4&n)>>2,ExDsc:(8&n)>>3},i]}function ui(e,t,r,n){var i=r&&5==r.biff;n||(n=Lt(i?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(i?1:2,t.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return null==s.l&&(s.l=s.length),s}var ci=zn;function di(e,t,r){var n=e.l+t,i=8!=r.biff&&r.biff?2:4,s=e.read_shift(i),o=e.read_shift(i),a=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:s,c:a},e:{r:o,c:l}}}function fi(e,t,r,n){var i=r&&5==r.biff;return n||(n=Lt(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4)),n.write_shift(4,0),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function pi(e,t,r){var n=Jn(e);2==r.biff&&++e.l;var i=function(e){var t=e.read_shift(1);return 1===e.read_shift(1)?t:1===t}(e);return n.val=i,n.t=!0===i||!1===i?"b":"e",n}var mi=function(e,t,r){return 0===t?"":zn(e,0,r)};function _i(e,t,r){var n,i=e.read_shift(2),s={fBuiltIn:1&i,fWantAdvise:i>>>1&1,fWantPict:i>>>2&1,fOle:i>>>3&1,fOleLink:i>>>4&1,cf:i>>>5&1023,fIcon:i>>>15&1};return 14849===r.sbcch&&(n=function(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=Bn(e,0,r),s=e.read_shift(2);if(s!==(n-=e.l))throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,i}(e,t-2,r)),s.body=n||e.read_shift(t-2),"string"==typeof n&&(s.Name=n),s}var gi=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function vi(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(1),o=e.read_shift(1),a=e.read_shift(r&&2==r.biff?1:2),l=0;(!r||r.biff>=5)&&(5!=r.biff&&(e.l+=2),l=e.read_shift(2),5==r.biff&&(e.l+=2),e.l+=4);var h=jn(e,o,r);32&i&&(h=gi[h.charCodeAt(0)]);var u=n-e.l;r&&2==r.biff&&--u;var c=n!=e.l&&0!==a&&u>0?function(e,t,r,n){var i,s=e.l+t,o=Fo(e,n,r);return s!==e.l&&(i=ko(e,s-e.l,o,r)),[o,i]}(e,u,r,a):[];return{chKey:s,Name:h,itab:l,rgce:c}}function yi(e,t,r){if(r.biff<8)return function(e,t,r){3==e[e.l+1]&&e[e.l]++;var n=Bn(e,0,r);return 3==n.charCodeAt(0)?n.slice(1):n}(e,0,r);for(var n=[],i=e.l+t,s=e.read_shift(r.biff>8?4:2);0!=s--;)n.push($n(e,r.biff,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function bi(e,t,r){var n=ri(e,6);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,zo(e,t,r)]}var xi=[];function Si(e){var t=Lt(24),r=Jt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(n[i],16));return w([t,Wn(e[1])])}function Ti(e){var t=e[1].Tooltip,r=Lt(10+2*(t.length+1));r.write_shift(2,2048);var n=Jt(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function Ei(e,t,r){if(!r.cellStyles)return Ft(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),a=e.read_shift(n),l=e.read_shift(2);2==n&&(e.l+=2);var h={s:i,e:s,w:o,ixfe:a,flags:l};return(r.biff>=5||!r.biff)&&(h.level=l>>8&7),h}xi[8]=function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}};var Ai=Jn,wi=Ln,Ci=Vn,Oi=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,255:16969},t=j({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(t,r){var n=r||{};return n.dateNF||(n.dateNF="yyyymmdd"),nr(function(t,r){var n=[],i=b(1);switch(r.type){case"base64":i=S(_.decode(t));break;case"binary":i=S(t);break;case"buffer":case"array":i=t}kt(i,0);var s=i.read_shift(1),o=!1,a=!1,l=!1;switch(s){case 2:case 3:break;case 48:a=!0,o=!0;break;case 49:a=!0;break;case 131:case 139:case 245:o=!0;break;case 140:o=!0,l=!0;break;default:throw new Error("DBF Unsupported Version: "+s.toString(16))}var h=0,u=0;2==s&&(h=i.read_shift(2)),i.l+=3,2!=s&&(h=i.read_shift(4)),h>1048576&&(h=1e6),2!=s&&(u=i.read_shift(2));var c=i.read_shift(2),d=1252;2!=s&&(i.l+=16,i.read_shift(1),0!==i[i.l]&&(d=e[i[i.l]]),i.l+=1,i.l+=2),l&&(i.l+=36);for(var f=[],p={},m=u-10-(a?264:0),g=l?32:11;2==s?i.l<i.length&&13!=i[i.l]:i.l<m;)switch(p={},p.name=cptable.utils.decode(d,i.slice(i.l,i.l+g)).replace(/[\u0000\r\n].*$/g,""),i.l+=g,p.type=String.fromCharCode(i.read_shift(1)),2!=s&&!l&&(p.offset=i.read_shift(4)),p.len=i.read_shift(1),2==s&&(p.offset=i.read_shift(2)),p.dec=i.read_shift(1),p.name.length&&f.push(p),2!=s&&(i.l+=l?13:14),p.type){case"B":(!a||8!=p.len)&&r.WTF&&console.log("Skipping "+p.name+":"+p.type);break;case"G":case"P":r.WTF&&console.log("Skipping "+p.name+":"+p.type);break;case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":case"0":case"@":case"+":break;default:throw new Error("Unknown Field Type: "+p.type)}if(13!==i[i.l]?i.l=u-1:2==s&&(i.l=521),2!=s){if(13!==i.read_shift(1))throw new Error("DBF Terminator not found "+i.l+" "+i[i.l]);i.l=u}var v=0,y=0;for(n[0]=[],y=0;y!=f.length;++y)n[0][y]=f[y].name;for(;h-- >0;)if(42!==i[i.l])for(++i.l,n[++v]=[],y=0,y=0;y!=f.length;++y){var x=i.slice(i.l,i.l+f[y].len);i.l+=f[y].len,kt(x,0);var T=cptable.utils.decode(d,x);switch(f[y].type){case"C":n[v][y]=cptable.utils.decode(d,x),n[v][y]=n[v][y].trim();break;case"D":8===T.length?n[v][y]=new Date(+T.slice(0,4),+T.slice(4,6)-1,+T.slice(6,8)):n[v][y]=T;break;case"F":n[v][y]=parseFloat(T.trim());break;case"+":case"I":n[v][y]=l?2147483648^x.read_shift(-4,"i"):x.read_shift(4,"i");break;case"L":switch(T.toUpperCase()){case"Y":case"T":n[v][y]=!0;break;case"N":case"F":case" ":case"?":n[v][y]=!1;break;default:throw new Error("DBF Unrecognized L:|"+T+"|")}break;case"M":if(!o)throw new Error("DBF Unexpected MEMO for type "+s.toString(16));n[v][y]="##MEMO##"+(l?parseInt(T.trim(),10):x.read_shift(4));break;case"N":n[v][y]=+T.replace(/\u0000/g,"").trim();break;case"@":n[v][y]=new Date(x.read_shift(-8,"f")-621356832e5);break;case"T":n[v][y]=new Date(864e5*(x.read_shift(4)-2440588)+x.read_shift(4));break;case"Y":n[v][y]=x.read_shift(4,"i")/1e4;break;case"O":n[v][y]=-x.read_shift(-8,"f");break;case"B":if(a&&8==f[y].len){n[v][y]=x.read_shift(8,"f");break}case"G":case"P":x.l+=f[y].len;break;case"0":if("_NullFlags"===f[y].name)break;default:throw new Error("DBF Unsupported data type "+f[y].type)}}else i.l+=c;if(2!=s&&i.l<i.length&&26!=i[i.l++])throw new Error("DBF EOF Marker missing "+(i.l-1)+" of "+i.length+" "+i[i.l-1].toString(16));return r&&r.sheetRows&&(n=n.slice(0,r.sheetRows)),n}(t,n),n)}var n={B:8,C:250,L:1,D:8,"?":0,"":0};return{versions:[2,3,48,49,131,139,140,245],to_workbook:function(e,t){try{return tr(r(e,t),t)}catch(e){if(t&&t.WTF)throw e}return{SheetNames:[],Sheets:{}}},to_sheet:r,from_sheet:function(e,r){var s=r||{};if(+s.codepage>=0&&h(+s.codepage),"string"==s.type)throw new Error("Cannot write DBF to JS string");var o=Ut(),a=Ih(e,{header:1,raw:!0,cellDates:!0}),l=a[0],u=a.slice(1),c=0,d=0,f=0,p=1;for(c=0;c<l.length;++c)if(null!=c){if(++f,"number"==typeof l[c]&&(l[c]=l[c].toString(10)),"string"!=typeof l[c])throw new Error("DBF Invalid column name "+l[c]+" |"+typeof l[c]+"|");if(l.indexOf(l[c])!==c)for(d=0;d<1024;++d)if(-1==l.indexOf(l[c]+"_"+d)){l[c]+="_"+d;break}}var m=Zt(e["!ref"]),_=[];for(c=0;c<=m.e.c-m.s.c;++c){var g=[];for(d=0;d<u.length;++d)null!=u[d][c]&&g.push(u[d][c]);if(0!=g.length&&null!=l[c]){var v="",y="";for(d=0;d<g.length;++d){switch(typeof g[d]){case"number":y="B";break;default:y="C";break;case"boolean":y="L";break;case"object":y=g[d]instanceof Date?"D":"C"}if("C"==(v=v&&v!=y?"C":y))break}p+=n[v]||0,_[c]=v}else _[c]="?"}var b=o.next(32);for(b.write_shift(4,318902576),b.write_shift(4,u.length),b.write_shift(2,296+32*f),b.write_shift(2,p),c=0;c<4;++c)b.write_shift(4,0);for(b.write_shift(4,0|(+t[i]||3)<<8),c=0,d=0;c<l.length;++c)if(null!=l[c]){var x=o.next(32),S=(l[c].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);x.write_shift(1,S,"sbcs"),x.write_shift(1,"?"==_[c]?"C":_[c],"sbcs"),x.write_shift(4,d),x.write_shift(1,n[_[c]]||0),x.write_shift(1,0),x.write_shift(1,2),x.write_shift(4,0),x.write_shift(1,0),x.write_shift(4,0),x.write_shift(4,0),d+=n[_[c]]||0}var T=o.next(264);for(T.write_shift(4,13),c=0;c<65;++c)T.write_shift(4,0);for(c=0;c<u.length;++c){var E=o.next(p);for(E.write_shift(1,0),d=0;d<l.length;++d)if(null!=l[d])switch(_[d]){case"L":E.write_shift(1,null==u[c][d]?63:u[c][d]?84:70);break;case"B":E.write_shift(8,u[c][d]||0,"f");break;case"D":u[c][d]?(E.write_shift(4,("0000"+u[c][d].getFullYear()).slice(-4),"sbcs"),E.write_shift(2,("00"+(u[c][d].getMonth()+1)).slice(-2),"sbcs"),E.write_shift(2,("00"+u[c][d].getDate()).slice(-2),"sbcs")):E.write_shift(8,"00000000","sbcs");break;case"C":var A=String(u[c][d]||"");for(E.write_shift(1,A,"sbcs"),f=0;f<250-A.length;++f)E.write_shift(1,32)}}return o.next(1).write_shift(1,26),o.end()}}}(),Ri=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,B:180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("N("+U(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(t,r){var n=e[r];return"number"==typeof n?p(n):n},n=function(e,t,r){var n=t.charCodeAt(0)-32<<4|r.charCodeAt(0)-48;return 59==n?e:p(n)};function i(e,i){var s,o=e.split(/[\n\r]+/),a=-1,l=-1,u=0,c=0,d=[],f=[],p=null,m={},_=[],g=[],v=[],y=0;for(+i.codepage>=0&&h(+i.codepage);u!==o.length;++u){y=0;var b,x=o[u].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),S=x.replace(/;;/g,"\0").split(";").map((function(e){return e.replace(/\u0000/g,";")})),T=S[0];if(x.length>0)switch(T){case"ID":case"E":case"B":case"O":break;case"P":"P"==S[1].charAt(0)&&f.push(x.slice(3).replace(/;;/g,";"));break;case"C":var E=!1,A=!1;for(c=1;c<S.length;++c)switch(S[c].charAt(0)){case"X":l=parseInt(S[c].slice(1))-1,A=!0;break;case"Y":for(a=parseInt(S[c].slice(1))-1,A||(l=0),s=d.length;s<=a;++s)d[s]=[];break;case"K":'"'===(b=S[c].slice(1)).charAt(0)?b=b.slice(1,b.length-1):"TRUE"===b?b=!0:"FALSE"===b?b=!1:isNaN(ne(b))?isNaN(ie(b).getDate())||(b=Z(b)):(b=ne(b),null!==p&&R.is_date(p)&&(b=Y(b))),"undefined"!=typeof cptable&&"string"==typeof b&&"string"!=(i||{}).type&&(i||{}).codepage&&(b=cptable.utils.decode(i.codepage,b)),E=!0;break;case"E":var w=ro(S[c].slice(1),{r:a,c:l});d[a][l]=[d[a][l],w];break;default:if(i&&i.WTF)throw new Error("SYLK bad record "+x)}E&&(d[a][l]=b,p=null);break;case"F":var C=0;for(c=1;c<S.length;++c)switch(S[c].charAt(0)){case"X":l=parseInt(S[c].slice(1))-1,++C;break;case"Y":for(a=parseInt(S[c].slice(1))-1,s=d.length;s<=a;++s)d[s]=[];break;case"M":y=parseInt(S[c].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":p=f[parseInt(S[c].slice(1))];break;case"W":for(v=S[c].slice(1).split(" "),s=parseInt(v[0],10);s<=parseInt(v[1],10);++s)y=parseInt(v[2],10),g[s-1]=0===y?{hidden:!0}:{wch:y},_s(g[s-1]);break;case"C":g[l=parseInt(S[c].slice(1))-1]||(g[l]={});break;case"R":_[a=parseInt(S[c].slice(1))-1]||(_[a]={}),y>0?(_[a].hpt=y,_[a].hpx=vs(y)):0===y&&(_[a].hidden=!0);break;default:if(i&&i.WTF)throw new Error("SYLK bad record "+x)}C<1&&(p=null);break;default:if(i&&i.WTF)throw new Error("SYLK bad record "+x)}}return _.length>0&&(m["!rows"]=_),g.length>0&&(m["!cols"]=g),i&&i.sheetRows&&(d=d.slice(0,i.sheetRows)),[d,m]}function s(e,t){var r=function(e,t){switch(t.type){case"base64":return i(_.decode(e),t);case"binary":return i(e,t);case"buffer":return i(e.toString("binary"),t);case"array":return i(ee(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),n=r[0],s=r[1],o=nr(n,t);return U(s).forEach((function(e){o[e]=s[e]})),o}function o(e,t,r,n){var i="C;Y"+(r+1)+";X"+(n+1)+";K";switch(e.t){case"n":i+=e.v||0,e.f&&!e.F&&(i+=";E"+io(e.f,{r,c:n}));break;case"b":i+=e.v?"TRUE":"FALSE";break;case"e":i+=e.w||e.v;break;case"d":i+='"'+(e.w||e.v)+'"';break;case"s":i+='"'+e.v.replace(/"/g,"")+'"'}return i}return e["|"]=254,{to_workbook:function(e,t){return tr(s(e,t),t)},to_sheet:s,from_sheet:function(e,t){var r,n,i=["ID;PWXL;N;E"],s=[],a=Zt(e["!ref"]),l=Array.isArray(e),h="\r\n";i.push("P;PGeneral"),i.push("F;P0;DG0G8;M255"),e["!cols"]&&(n=i,e["!cols"].forEach((function(e,t){var r="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?r+="0":("number"==typeof e.width&&(e.wpx=cs(e.width)),"number"==typeof e.wpx&&(e.wch=ds(e.wpx)),"number"==typeof e.wch&&(r+=Math.round(e.wch)))," "!=r.charAt(r.length-1)&&n.push(r)}))),e["!rows"]&&function(e,t){t.forEach((function(t,r){var n="F;";t.hidden?n+="M0;":t.hpt?n+="M"+20*t.hpt+";":t.hpx&&(n+="M"+20*gs(t.hpx)+";"),n.length>2&&e.push(n+"R"+(r+1))}))}(i,e["!rows"]),i.push("B;Y"+(a.e.r-a.s.r+1)+";X"+(a.e.c-a.s.c+1)+";D"+[a.s.c,a.s.r,a.e.c,a.e.r].join(" "));for(var u=a.s.r;u<=a.e.r;++u)for(var c=a.s.c;c<=a.e.c;++c){var d=Kt({r:u,c});(r=l?(e[u]||[])[c]:e[d])&&(null!=r.v||r.f&&!r.F)&&s.push(o(r,0,u,c))}return i.join(h)+h+s.join(h)+h+"E"+h}}}(),Di=function(){function e(e,t){for(var r=e.split("\n"),n=-1,i=-1,s=0,o=[];s!==r.length;++s)if("BOT"!==r[s].trim()){if(!(n<0)){var a=r[s].trim().split(","),l=a[0],h=a[1],u=r[++s].trim();switch(+l){case-1:if("BOT"===u){o[++n]=[],i=0;continue}if("EOD"!==u)throw new Error("Unrecognized DIF special command "+u);break;case 0:"TRUE"===u?o[n][i]=!0:"FALSE"===u?o[n][i]=!1:isNaN(ne(h))?isNaN(ie(h).getDate())?o[n][i]=h:o[n][i]=Z(h):o[n][i]=ne(h),++i;break;case 1:u=u.slice(1,u.length-1),o[n][i++]=""!==u?u:null}if("EOD"===u)break}}else o[++n]=[],i=0;return t&&t.sheetRows&&(o=o.slice(0,t.sheetRows)),o}function t(t,r){return nr(function(t,r){switch(r.type){case"base64":return e(_.decode(t),r);case"binary":return e(t,r);case"buffer":return e(t.toString("binary"),r);case"array":return e(ee(t),r)}throw new Error("Unrecognized type "+r.type)}(t,r),r)}var r,n,i=(r=function(e,t,r,n,i){e.push(t),e.push(r+","+n),e.push('"'+i.replace(/"/g,'""')+'"')},n=function(e,t,r,n){e.push(t+","+r),e.push(1==t?'"'+n.replace(/"/g,'""')+'"':n)},function(e){var t,i=[],s=Zt(e["!ref"]),o=Array.isArray(e);r(i,"TABLE",0,1,"sheetjs"),r(i,"VECTORS",0,s.e.r-s.s.r+1,""),r(i,"TUPLES",0,s.e.c-s.s.c+1,""),r(i,"DATA",0,0,"");for(var a=s.s.r;a<=s.e.r;++a){n(i,-1,0,"BOT");for(var l=s.s.c;l<=s.e.c;++l){var h=Kt({r:a,c:l});if(t=o?(e[a]||[])[l]:e[h])switch(t.t){case"n":var u=t.w;!u&&null!=t.v&&(u=t.v),null==u?t.f&&!t.F?n(i,1,0,"="+t.f):n(i,1,0,""):n(i,0,u,"V");break;case"b":n(i,0,t.v?1:0,t.v?"TRUE":"FALSE");break;case"s":n(i,1,0,isNaN(t.v)?t.v:'="'+t.v+'"');break;case"d":t.w||(t.w=R.format(t.z||R._table[14],H(Z(t.v)))),n(i,0,t.w,"V");break;default:n(i,1,0,"")}else n(i,1,0,"")}}return n(i,-1,0,"EOD"),i.join("\r\n")});return{to_workbook:function(e,r){return tr(t(e,r),r)},to_sheet:t,from_sheet:i}}(),Ii=function(){function e(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(e,t){return nr(function(e,t){for(var r=e.split("\n"),n=-1,i=-1,s=0,o=[];s!==r.length;++s){var a=r[s].trim().split(":");if("cell"===a[0]){var l=Jt(a[1]);if(o.length<=l.r)for(n=o.length;n<=l.r;++n)o[n]||(o[n]=[]);switch(n=l.r,i=l.c,a[2]){case"t":o[n][i]=a[3].replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n");break;case"v":o[n][i]=+a[3];break;case"vtf":var h=a[a.length-1];case"vtc":"nl"===a[3]?o[n][i]=!!+a[4]:o[n][i]=+a[4],"vtf"==a[2]&&(o[n][i]=[o[n][i],h])}}}return t&&t.sheetRows&&(o=o.slice(0,t.sheetRows)),o}(e,t),t)}var r=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),n=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",i=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),s="--SocialCalcSpreadsheetControlSave--";function o(t){if(!t||!t["!ref"])return"";for(var r,n=[],i=[],s="",o=$t(t["!ref"]),a=Array.isArray(t),l=o.s.r;l<=o.e.r;++l)for(var h=o.s.c;h<=o.e.c;++h)if(s=Kt({r:l,c:h}),(r=a?(t[l]||[])[h]:t[s])&&null!=r.v&&"z"!==r.t){switch(i=["cell",s,"t"],r.t){case"s":case"str":i.push(e(r.v));break;case"n":r.f?(i[2]="vtf",i[3]="n",i[4]=r.v,i[5]=e(r.f)):(i[2]="v",i[3]=r.v);break;case"b":i[2]="vt"+(r.f?"f":"c"),i[3]="nl",i[4]=r.v?"1":"0",i[5]=e(r.f||(r.v?"TRUE":"FALSE"));break;case"d":var u=H(Z(r.v));i[2]="vtc",i[3]="nd",i[4]=""+u,i[5]=r.w||R.format(r.z||R._table[14],u);break;case"e":continue}n.push(i.join(":"))}return n.push("sheet:c:"+(o.e.c-o.s.c+1)+":r:"+(o.e.r-o.s.r+1)+":tvf:1"),n.push("valueformat:1:text-wiki"),n.join("\n")}return{to_workbook:function(e,r){return tr(t(e,r),r)},to_sheet:t,from_sheet:function(e){return[r,n,i,n,o(e),s].join("\n")}}}(),Mi=function(){function e(e,t,r,n,i){i.raw?t[r][n]=e:"TRUE"===e?t[r][n]=!0:"FALSE"===e?t[r][n]=!1:""===e||(isNaN(ne(e))?isNaN(ie(e).getDate())?t[r][n]=e:t[r][n]=Z(e):t[r][n]=ne(e))}var t={44:",",9:"\t",59:";"},r={44:3,9:2,59:1};function n(n,i){return!i||!i.PRN||"sep="==n.slice(0,4)||n.indexOf("\t")>=0||n.indexOf(",")>=0||n.indexOf(";")>=0?function(e,n){var i=n||{},s="",o=i.dense?[]:{},a={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(s=e.charAt(4),e=e.slice(7)):(13==e.charCodeAt(5)||10==e.charCodeAt(5))&&(s=e.charAt(4),e=e.slice(6)):s=function(e){for(var n={},i=!1,s=0,o=0;s<e.length;++s)34==(o=e.charCodeAt(s))?i=!i:!i&&o in t&&(n[o]=(n[o]||0)+1);for(s in o=[],n)Object.prototype.hasOwnProperty.call(n,s)&&o.push([n[s],s]);if(!o.length)for(s in n=r)Object.prototype.hasOwnProperty.call(n,s)&&o.push([n[s],s]);return o.sort((function(e,t){return e[0]-t[0]||r[e[1]]-r[t[1]]})),t[o.pop()[1]]}(e.slice(0,1024));var l=0,h=0,u=0,c=0,d=0,f=s.charCodeAt(0),p=!1,m=0;e=e.replace(/\r\n/gm,"\n");var _,g,v=null!=i.dateNF?(g=(g="number"==typeof(_=i.dateNF)?R._table[_]:_).replace(P,"(\\d+)"),new RegExp("^"+g+"$")):null;function y(){var t=e.slice(c,d),r={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)r.t="z";else if(i.raw)r.t="s",r.v=t;else if(0===t.trim().length)r.t="s",r.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(r.t="s",r.v=t.slice(2,-1).replace(/""/g,'"')):1!=t.length?(r.t="n",r.f=t.slice(1)):(r.t="s",r.v=t);else if("TRUE"==t)r.t="b",r.v=!0;else if("FALSE"==t)r.t="b",r.v=!1;else if(isNaN(u=ne(t)))if(!isNaN(ie(t).getDate())||v&&t.match(v)){r.z=i.dateNF||R._table[14];var n=0;v&&t.match(v)&&(t=function(e,t,r){var n=-1,i=-1,s=-1,o=-1,a=-1,l=-1;(t.match(P)||[]).forEach((function(e,t){var h=parseInt(r[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":n=h;break;case"d":s=h;break;case"h":o=h;break;case"s":l=h;break;case"m":o>=0?a=h:i=h}})),l>=0&&-1==a&&i>=0&&(a=i,i=-1);var h=(""+(n>=0?n:(new Date).getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);7==h.length&&(h="0"+h),8==h.length&&(h="20"+h);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return-1==o&&-1==a&&-1==l?h:-1==n&&-1==i&&-1==s?u:h+"T"+u}(0,i.dateNF,t.match(v)||[]),n=1),i.cellDates?(r.t="d",r.v=Z(t,n)):(r.t="n",r.v=H(Z(t,n))),!1!==i.cellText&&(r.w=R.format(r.z,r.v instanceof Date?H(r.v):r.v)),i.cellNF||delete r.z}else r.t="s",r.v=t;else r.t="n",!1!==i.cellText&&(r.w=t),r.v=u;if("z"==r.t||(i.dense?(o[l]||(o[l]=[]),o[l][h]=r):o[Kt({c:h,r:l})]=r),c=d+1,a.e.c<h&&(a.e.c=h),a.e.r<l&&(a.e.r=l),m==f)++h;else if(h=0,++l,i.sheetRows&&i.sheetRows<=l)return!0}e:for(;d<e.length;++d)switch(m=e.charCodeAt(d)){case 34:p=!p;break;case f:case 10:case 13:if(!p&&y())break e}return d-c>0&&y(),o["!ref"]=Qt(a),o}(n,i):nr(function(t,r){var n=r||{},i=[];if(!t||0===t.length)return i;for(var s=t.split(/[\r\n]/),o=s.length-1;o>=0&&0===s[o].length;)--o;for(var a=10,l=0,h=0;h<=o;++h)-1==(l=s[h].indexOf(" "))?l=s[h].length:l++,a=Math.max(a,l);for(h=0;h<=o;++h){i[h]=[];var u=0;for(e(s[h].slice(0,a).trim(),i,h,u,n),u=1;u<=(s[h].length-a)/10+1;++u)e(s[h].slice(a+10*(u-1),a+10*u).trim(),i,h,u,n)}return n.sheetRows&&(i=i.slice(0,n.sheetRows)),i}(n,i),i)}function i(e,t){var r="",i="string"==t.type?[0,0,0,0]:yh(e,t);switch(t.type){case"base64":r=_.decode(e);break;case"binary":case"string":r=e;break;case"buffer":r=65001==t.codepage?e.toString("utf8"):t.codepage&&"undefined"!=typeof cptable?cptable.utils.decode(t.codepage,e):e.toString("binary");break;case"array":r=ee(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==i[0]&&187==i[1]&&191==i[2]?r=ke(r.slice(3)):"binary"==t.type&&"undefined"!=typeof cptable&&t.codepage&&(r=cptable.utils.decode(t.codepage,cptable.utils.encode(1252,r))),"socialcalc:version:"==r.slice(0,19)?Ii.to_sheet("string"==t.type?r:ke(r),t):n(r,t)}return{to_workbook:function(e,t){return tr(i(e,t),t)},to_sheet:i,from_sheet:function(e){for(var t,r=[],n=Zt(e["!ref"]),i=Array.isArray(e),s=n.s.r;s<=n.e.r;++s){for(var o=[],a=n.s.c;a<=n.e.c;++a){var l=Kt({r:s,c:a});if((t=i?(e[s]||[])[a]:e[l])&&null!=t.v){for(var h=(t.w||(er(t),t.w)||"").slice(0,10);h.length<10;)h+=" ";o.push(h+(0===a?" ":""))}else o.push("          ")}r.push(o.join(""))}return r.join("\n")}}}(),Ni=function(){function e(e,t){if(!e)return e;var r=t||{},n=r.dense?[]:{},i="Sheet1",s=0,l={},h=[i],u={s:{r:0,c:0},e:{r:0,c:0}},c=r.sheetRows||0;if(2==e[2])r.Enum=o;else if(26==e[2])r.Enum=a;else{if(14!=e[2])throw new Error("Unrecognized LOTUS BOF "+e[2]);r.Enum=a,r.qpro=!0,e.l=0}return function(e,t,r){if(e){kt(e,e.l||0);for(var n=r.Enum||o;e.l<e.length;){var i=e.read_shift(2),s=n[i]||n[255],a=e.read_shift(2),l=e.l+a,h=(s.f||Ft)(e,a,r);if(e.l=l,t(h,s.n,i))return}}}(e,(function(t,o,a){if(2==e[2])switch(a){case 0:r.vers=t,t>=4096&&(r.qpro=!0);break;case 6:u=t;break;case 15:r.qpro||(t[1].v=t[1].v.slice(1));case 13:case 14:case 16:case 51:14==a&&112==(112&t[2])&&(15&t[2])>1&&(15&t[2])<15&&(t[1].z=r.dateNF||R._table[14],r.cellDates&&(t[1].t="d",t[1].v=Y(t[1].v))),r.dense?(n[t[0].r]||(n[t[0].r]=[]),n[t[0].r][t[0].c]=t[1]):n[Kt(t[0])]=t[1]}else switch(a){case 22:t[1].v=t[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(t[3]>s&&(n["!ref"]=Qt(u),l[i]=n,n=r.dense?[]:{},u={s:{r:0,c:0},e:{r:0,c:0}},s=t[3],i="Sheet"+(s+1),h.push(i)),c>0&&t[0].r>=c)break;r.dense?(n[t[0].r]||(n[t[0].r]=[]),n[t[0].r][t[0].c]=t[1]):n[Kt(t[0])]=t[1],u.e.c<t[0].c&&(u.e.c=t[0].c),u.e.r<t[0].r&&(u.e.r=t[0].r)}}),r),n["!ref"]=Qt(u),l[i]=n,{SheetNames:h,Sheets:l}}function t(e,t,r){var n=[{c:0,r:0},{t:"n",v:0},0];return r.qpro&&20768!=r.vers?(n[0].c=e.read_shift(1),e.l++,n[0].r=e.read_shift(2),e.l+=2):(n[2]=e.read_shift(1),n[0].c=e.read_shift(2),n[0].r=e.read_shift(2)),n}function r(e,r,n){var i=e.l+r,s=t(e,0,n);if(s[1].t="s",20768==n.vers){e.l++;var o=e.read_shift(1);return s[1].v=e.read_shift(o,"utf8"),s}return n.qpro&&e.l++,s[1].v=e.read_shift(i-e.l,"cstr"),s}function n(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function i(e,t){var r=n(e),i=e.read_shift(4),s=e.read_shift(4),o=e.read_shift(2);if(65535==o)return r[1].v=0,r;var a=32768&o;return o=(32767&o)-16446,r[1].v=(2*a-1)*((o>0?s<<o:s>>>-o)+(o>-32?i<<o+32:i>>>-(o+32))),r}function s(e,t){var r=n(e),i=e.read_shift(8,"f");return r[1].v=i,r}var o={0:{n:"BOF",f:kn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e){var t={s:{c:0,r:0},e:{c:0,r:0}};return t.s.c=e.read_shift(2),t.s.r=e.read_shift(2),t.e.c=e.read_shift(2),t.e.r=e.read_shift(2),65535==t.s.c&&(t.s.c=t.e.c=t.s.r=t.e.r=0),t}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,r,n){var i=t(e,0,n);return i[1].v=e.read_shift(2,"i"),i}},14:{n:"NUMBER",f:function(e,r,n){var i=t(e,0,n);return i[1].v=e.read_shift(8,"f"),i}},15:{n:"LABEL",f:r},16:{n:"FORMULA",f:function(e,r,n){var i=e.l+r,s=t(e,0,n);if(s[1].v=e.read_shift(8,"f"),n.qpro)e.l=i;else{var o=e.read_shift(2);e.l+=o}return s}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:r},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},255:{n:"",f:Ft}},a={0:{n:"BOF"},1:{n:"EOF"},3:{n:"??"},4:{n:"??"},5:{n:"??"},6:{n:"??"},7:{n:"??"},9:{n:"??"},10:{n:"??"},11:{n:"??"},12:{n:"??"},14:{n:"??"},15:{n:"??"},16:{n:"??"},17:{n:"??"},18:{n:"??"},19:{n:"??"},21:{n:"??"},22:{n:"LABEL16",f:function(e,t){var r=n(e);return r[1].t="s",r[1].v=e.read_shift(t-4,"cstr"),r}},23:{n:"NUMBER17",f:i},24:{n:"NUMBER18",f:function(e,t){var r=n(e);r[1].v=e.read_shift(2);var i=r[1].v>>1;if(1&r[1].v)switch(7&i){case 1:i=500*(i>>3);break;case 2:i=(i>>3)/20;break;case 4:i=(i>>3)/2e3;break;case 6:i=(i>>3)/16;break;case 7:i=(i>>3)/64;break;default:throw"unknown NUMBER_18 encoding "+(7&i)}return r[1].v=i,r}},25:{n:"FORMULA19",f:function(e,t){var r=i(e);return e.l+=t-14,r}},26:{n:"??"},27:{n:"??"},28:{n:"??"},29:{n:"??"},30:{n:"??"},31:{n:"??"},33:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var r=n(e),i=e.read_shift(4);return r[1].v=i>>6,r}},39:{n:"NUMBER27",f:s},40:{n:"FORMULA28",f:function(e,t){var r=s(e);return e.l+=t-10,r}},255:{n:"",f:Ft}};return{to_workbook:function(t,r){switch(r.type){case"base64":return e(S(_.decode(t)),r);case"binary":return e(S(t),r);case"buffer":case"array":return e(t,r)}throw"Unsupported type "+r.type}}}(),Pi=function(){var e=ze("t"),t=ze("rPr");function r(r){var n=r.match(e);if(!n)return{t:"s",v:""};var i={t:"s",v:we(n[1])},s=r.match(t);return s&&(i.s=function(e){var t={},r=e.match(ge),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=be(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==s.val)break;t.cp=a[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting"}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if("0"==s.val)break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if("0"==s.val)break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<family":t.family=s.val;break;case"<vertAlign":t.valign=s.val;break;case"<scheme":case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(47!==s[0].charCodeAt(1)&&!i)throw new Error("Unrecognized rich format "+s[0])}}return t}(s[1])),i}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(e){return e.replace(n,"").split(i).map(r).filter((function(e){return e.v}))}}(),ki=function(){var e=/(\r\n|\n)/g;function t(t){var r=[[],t.v,[]];return t.v?(t.s&&function(e,t,r){var n=[];e.u&&n.push("text-decoration: underline;"),e.uval&&n.push("text-underline-style:"+e.uval+";"),e.sz&&n.push("font-size:"+e.sz+"pt;"),e.outline&&n.push("text-effect: outline;"),e.shadow&&n.push("text-shadow: auto;"),t.push('<span style="'+n.join("")+'">'),e.b&&(t.push("<b>"),r.push("</b>")),e.i&&(t.push("<i>"),r.push("</i>")),e.strike&&(t.push("<s>"),r.push("</s>"));var i=e.valign||"";"superscript"==i||"super"==i?i="sup":"subscript"==i&&(i="sub"),""!=i&&(t.push("<"+i+">"),r.push("</"+i+">")),r.push("</span>")}(t.s,r[0],r[2]),r[0].join("")+r[1].replace(e,"<br/>")+r[2].join("")):""}return function(e){return e.map(t).join("")}}(),Fi=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Li=/<(?:\w+:)?r>/,Bi=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Ui(e,t){var r=!t||t.cellHTML,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=we(ke(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=ke(e),r&&(n.h=Me(n.t))):e.match(Li)&&(n.r=ke(e),n.t=we(ke((e.replace(Bi,"").match(Fi)||[]).join("").replace(ge,""))),r&&(n.h=ki(Pi(n.r)))),n):{t:""}}var Gi=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,ji=/<(?:\w+:)?(?:si|sstItem)>/g,Vi=/<\/(?:\w+:)?(?:si|sstItem)>/;Wr.SST="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings";var zi=/^\s|\s$|[\t\n\r]/;function Hi(e,t){if(!t.bookSST)return"";var r=[me];r[r.length]=Qe("sst",null,{xmlns:rt.main[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(null!=e[n]){var i=e[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(zi)&&(s+=' xml:space="preserve"'),s+=">"+Re(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}var Xi=function(e,t){var r=!1;return null==t&&(r=!0,t=Lt(15+4*e.t.length)),t.write_shift(1,0),or(e.t,t),r?t.slice(0,t.l):t};function Wi(e){var t=Ut();Gt(t,"BrtBeginSst",function(e,t){return t||(t=Lt(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}(e));for(var r=0;r<e.length;++r)Gt(t,"BrtSSTItem",Xi(e[r]));return Gt(t,"BrtEndSst"),t.end()}function qi(e){if("undefined"!=typeof cptable)return cptable.utils.encode(i,e);for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Yi(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function Ji(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),s=[];i-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function Ki(e,t){var r=e.l+t,n={};n.Flags=63&e.read_shift(4),e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=36==n.Flags;break;case 26625:i=4==n.Flags;break;case 0:i=16==n.Flags||4==n.Flags||36==n.Flags;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function $i(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function Qi(e){if(36!=(63&e.read_shift(4)))throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4);return{t:"Std",h:Ki(e,t),v:$i(e,e.length-e.l)}}function Zi(){throw new Error("File is password-protected: ECMA-376 Extensible")}function es(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(ge,(function(e){var r=be(e);switch(xe(r[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":t.forEach((function(e){n[e]=r[e]}));break;case"<dataIntegrity":n.encryptedHmacKey=r.encryptedHmacKey,n.encryptedHmacValue=r.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"<keyEncryptor":n.uri=r.uri;break;case"<encryptedKey":n.encs.push(r);break;default:throw r[0]}})),n}function ts(e){var t,r,n=0,i=qi(e),s=i.length+1;for((t=b(s))[0]=i.length,r=1;r!=s;++r)t[r]=i[r-1];for(r=s-1;r>=0;--r)n=((0==(16384&n)?0:1)|n<<1&32767)^t[r];return 52811^n}var rs,ns,is,ss,os=(rs=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],ns=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],is=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],ss=function(e,t){return 255&((r=e^t)/2|128*r);var r},function(e){for(var t=qi(e),r=function(e){for(var t=ns[e.length-1],r=104,n=e.length-1;n>=0;--n)for(var i=e[n],s=0;7!=s;++s)64&i&&(t^=is[r]),i*=2,--r;return t}(t),n=t.length,i=b(16),s=0;16!=s;++s)i[s]=0;var o,a,l;for(1==(1&n)&&(o=r>>8,i[n]=ss(rs[0],o),--n,o=255&r,a=t[t.length-1],i[n]=ss(a,o));n>0;)o=r>>8,i[--n]=ss(t[n],o),o=255&r,i[--n]=ss(t[n],o);for(n=15,l=15-t.length;l>0;)o=r>>8,i[n]=ss(rs[l],o),--l,o=255&r,i[--n]=ss(t[n],o),--n,--l;return i});var as=function(){function e(e,r){switch(r.type){case"base64":return t(_.decode(e),r);case"binary":return t(e,r);case"buffer":return t(e.toString("binary"),r);case"array":return t(ee(e),r)}throw new Error("Unrecognized type "+r.type)}function t(e,t){var r=(t||{}).dense?[]:{};if(!e.match(/\\trowd/))throw new Error("RTF missing table");return r["!ref"]=Qt({s:{c:0,r:0},e:{c:0,r:0}}),r}return{to_workbook:function(t,r){return tr(e(t,r),r)},to_sheet:e,from_sheet:function(e){for(var t,r=["{\\rtf1\\ansi"],n=Zt(e["!ref"]),i=Array.isArray(e),s=n.s.r;s<=n.e.r;++s){r.push("\\trowd\\trautofit1");for(var o=n.s.c;o<=n.e.c;++o)r.push("\\cellx"+(o+1));for(r.push("\\pard\\intbl"),o=n.s.c;o<=n.e.c;++o){var a=Kt({r:s,c:o});(t=i?(e[s]||[])[o]:e[a])&&(null!=t.v||t.f&&!t.F)&&(r.push(" "+(t.w||(er(t),t.w))),r.push("\\cell"))}r.push("\\pard\\intbl\\row")}return r.join("")+"}"}}}();function ls(e){for(var t=0,r=1;3!=t;++t)r=256*r+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function hs(e,t){if(0===t)return e;var r=function(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),s=Math.min(t,r,n),o=i-s;if(0===o)return[0,0,t];var a,l=0,h=i+s;switch(a=o/(h>1?2-h:h),i){case t:l=((r-n)/o+6)%6;break;case r:l=(n-t)/o+2;break;case n:l=(t-r)/o+4}return[l/6,a,h/2]}(function(e){var t=e.slice("#"===e[0]?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}(e));return r[2]=t<0?r[2]*(1+t):1-(1-r[2])*(1-t),ls(function(e){var t,r=e[0],n=e[1],i=e[2],s=2*n*(i<.5?i:1-i),o=i-s/2,a=[o,o,o],l=6*r;if(0!==n)switch(0|l){case 0:case 6:t=s*l,a[0]+=s,a[1]+=t;break;case 1:t=s*(2-l),a[0]+=t,a[1]+=s;break;case 2:t=s*(l-2),a[1]+=s,a[2]+=t;break;case 3:t=s*(4-l),a[1]+=t,a[2]+=s;break;case 4:t=s*(l-4),a[2]+=s,a[0]+=t;break;case 5:t=s*(6-l),a[2]+=t,a[0]+=s}for(var h=0;3!=h;++h)a[h]=Math.round(255*a[h]);return a}(r))}var us=6;function cs(e){return Math.floor((e+Math.round(128/us)/256)*us)}function ds(e){return Math.floor((e-5)/us*100+.5)/100}function fs(e){return Math.round((e*us+5)/us*256)/256}function ps(e){return fs(ds(cs(e)))}function ms(e){var t=Math.abs(e-ps(e)),r=us;if(t>.005)for(us=1;us<15;++us)Math.abs(e-ps(e))<=t&&(t=Math.abs(e-ps(e)),r=us);us=r}function _s(e){e.width?(e.wpx=cs(e.width),e.wch=ds(e.wpx),e.MDW=us):e.wpx?(e.wch=ds(e.wpx),e.width=fs(e.wch),e.MDW=us):"number"==typeof e.wch&&(e.width=fs(e.wch),e.wpx=cs(e.width),e.MDW=us),e.customWidth&&delete e.customWidth}function gs(e){return 96*e/96}function vs(e){return 96*e/96}var ys,bs,xs,Ss,Ts,Es={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"},As=["numFmtId","fillId","fontId","borderId","xfId"],ws=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"],Cs=(ys=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,bs=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,xs=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,Ss=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,Ts=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/,function(e,t,r){var n,i={};return e?((n=(e=e.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(ys))&&function(e,t,r){t.NumberFmt=[];for(var n=U(R._table),i=0;i<n.length;++i)t.NumberFmt[n[i]]=R._table[n[i]];var s=e[0].match(ge);if(s)for(i=0;i<s.length;++i){var o=be(s[i]);switch(xe(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var a=we(ke(o.formatCode)),l=parseInt(o.numFmtId,10);if(t.NumberFmt[l]=a,l>0){if(l>392){for(l=392;l>60&&null!=t.NumberFmt[l];--l);t.NumberFmt[l]=a}R.load(a,l)}break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}(n,i,r),(n=e.match(Ss))&&function(e,t,r,n){t.Fonts=[];var i={},s=!1;(e[0].match(ge)||[]).forEach((function(e){var o=be(e);switch(xe(o[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"<sz/>":case"</sz>":case"<vertAlign/>":case"</vertAlign>":case"<family/>":case"</family>":case"<scheme/>":case"</scheme>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=ke(o.val));break;case"<b":i.bold=o.val?Pe(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?Pe(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?Pe(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?Pe(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?Pe(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?Pe(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?Pe(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<charset":if("1"==o.val)break;o.codepage=a[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=Pe(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var l=Br[i.color.index];if(81==i.color.index&&(l=Br[1]),!l)throw new Error(e);i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=hs(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<AlternateContent":case"<ext":s=!0;break;case"</AlternateContent>":case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}}))}(n,i,t,r),(n=e.match(xs))&&function(e,t,r,n){t.Fills=[];var i={},s=!1;(e[0].match(ge)||[]).forEach((function(e){var r=be(e);switch(xe(r[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":r.patternType&&(i.patternType=r.patternType);break;case"<bgColor":i.bgColor||(i.bgColor={}),r.indexed&&(i.bgColor.indexed=parseInt(r.indexed,10)),r.theme&&(i.bgColor.theme=parseInt(r.theme,10)),r.tint&&(i.bgColor.tint=parseFloat(r.tint)),r.rgb&&(i.bgColor.rgb=r.rgb.slice(-6));break;case"<fgColor":i.fgColor||(i.fgColor={}),r.theme&&(i.fgColor.theme=parseInt(r.theme,10)),r.tint&&(i.fgColor.tint=parseFloat(r.tint)),null!=r.rgb&&(i.fgColor.rgb=r.rgb.slice(-6));break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+r[0]+" in fills")}}))}(n,i,0,r),(n=e.match(Ts))&&function(e,t,r,n){t.Borders=[];var i={},s=!1;(e[0].match(ge)||[]).forEach((function(e){var r=be(e);switch(xe(r[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":i={},r.diagonalUp&&(i.diagonalUp=Pe(r.diagonalUp)),r.diagonalDown&&(i.diagonalDown=Pe(r.diagonalDown)),t.Borders.push(i);break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+r[0]+" in borders")}}))}(n,i,0,r),(n=e.match(bs))&&function(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(ge)||[]).forEach((function(e){var s=be(e),o=0;switch(xe(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":for(delete(n=s)[0],o=0;o<As.length;++o)n[As[o]]&&(n[As[o]]=parseInt(n[As[o]],10));for(o=0;o<ws.length;++o)n[ws[o]]&&(n[ws[o]]=Pe(n[ws[o]]));if(n.numFmtId>392)for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}t.CellXf.push(n);break;case"<alignment":case"<alignment/>":var a={};s.vertical&&(a.vertical=s.vertical),s.horizontal&&(a.horizontal=s.horizontal),null!=s.textRotation&&(a.textRotation=s.textRotation),s.indent&&(a.indent=s.indent),s.wrapText&&(a.wrapText=Pe(s.wrapText)),n.alignment=a;break;case"<AlternateContent":case"<ext":i=!0;break;case"</AlternateContent>":case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+s[0]+" in cellXfs")}}))}(n,i,r),i):i}),Os=Qe("styleSheet",null,{xmlns:rt.main[0],"xmlns:vt":rt.vt});function Rs(e,t){var r,n=[me,Os];return e.SSF&&null!=(r=function(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach((function(r){for(var n=r[0];n<=r[1];++n)null!=e[n]&&(t[t.length]=Qe("numFmt",null,{numFmtId:n,formatCode:Re(e[n])}))})),1===t.length?"":(t[t.length]="</numFmts>",t[0]=Qe("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(e.SSF))&&(n[n.length]=r),n[n.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',n[n.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',n[n.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',n[n.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=function(e){var t=[];return t[t.length]=Qe("cellXfs",null),e.forEach((function(e){t[t.length]=Qe("xf",null,e)})),t[t.length]="</cellXfs>",2===t.length?"":(t[0]=Qe("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(t.cellXfs))&&(n[n.length]=r),n[n.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',n[n.length]='<dxfs count="0"/>',n[n.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',n.length>2&&(n[n.length]="</styleSheet>",n[1]=n[1].replace("/>",">")),n.join("")}function Ds(e,t,r){r||(r=Lt(6+4*t.length)),r.write_shift(2,e),or(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return null==r.l&&(r.l=r.length),n}Wr.STY="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles";var Is=j(["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"]),Ms=Ft;function Ns(e,t){t||(t=Lt(84));var r=Is[e.patternType];null==r&&(r=40),t.write_shift(4,r);var n=0;if(40!=r)for(Ar({auto:1},t),Ar({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Ps(e,t,r){return r||(r=Lt(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function ks(e,t){return t||(t=Lt(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Fs=Ft;function Ls(e,t){var r=Ut();return Gt(r,"BrtBeginStyleSheet"),function(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach((function(e){for(var n=e[0];n<=e[1];++n)null!=t[n]&&++r})),0!=r&&(Gt(e,"BrtBeginFmts",ir(r)),[[5,8],[23,26],[41,44],[50,392]].forEach((function(r){for(var n=r[0];n<=r[1];++n)null!=t[n]&&Gt(e,"BrtFmt",Ds(n,t[n]))})),Gt(e,"BrtEndFmts"))}}(r,e.SSF),function(e){Gt(e,"BrtBeginFonts",ir(1)),Gt(e,"BrtFont",function(e,t){t||(t=Lt(153)),t.write_shift(2,20*e.sz),function(e,t){t||(t=Lt(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);t.write_shift(1,r),t.write_shift(1,0)}(e,t),t.write_shift(2,e.bold?700:400);var r=0;"superscript"==e.vertAlign?r=1:"subscript"==e.vertAlign&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Ar(e.color,t);var n=0;return"major"==e.scheme&&(n=1),"minor"==e.scheme&&(n=2),t.write_shift(1,n),or(e.name,t),t.length>t.l?t.slice(0,t.l):t}({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),Gt(e,"BrtEndFonts")}(r),function(e){Gt(e,"BrtBeginFills",ir(2)),Gt(e,"BrtFill",Ns({patternType:"none"})),Gt(e,"BrtFill",Ns({patternType:"gray125"})),Gt(e,"BrtEndFills")}(r),function(e){Gt(e,"BrtBeginBorders",ir(1)),Gt(e,"BrtBorder",function(e,t){return t||(t=Lt(51)),t.write_shift(1,0),ks(0,t),ks(0,t),ks(0,t),ks(0,t),ks(0,t),t.length>t.l?t.slice(0,t.l):t}()),Gt(e,"BrtEndBorders")}(r),function(e){Gt(e,"BrtBeginCellStyleXFs",ir(1)),Gt(e,"BrtXF",Ps({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),Gt(e,"BrtEndCellStyleXFs")}(r),function(e,t){Gt(e,"BrtBeginCellXFs",ir(t.length)),t.forEach((function(t){Gt(e,"BrtXF",Ps(t,0))})),Gt(e,"BrtEndCellXFs")}(r,t.cellXfs),function(e){Gt(e,"BrtBeginStyles",ir(1)),Gt(e,"BrtStyle",function(e,t){return t||(t=Lt(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),mr(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}({xfId:0,builtinId:0,name:"Normal"})),Gt(e,"BrtEndStyles")}(r),function(e){Gt(e,"BrtBeginDXFs",ir(0)),Gt(e,"BrtEndDXFs")}(r),function(e){Gt(e,"BrtBeginTableStyles",function(e,t,r){var n=Lt(2052);return n.write_shift(4,0),mr("TableStyleMedium9",n),mr("PivotStyleMedium4",n),n.length>n.l?n.slice(0,n.l):n}()),Gt(e,"BrtEndTableStyles")}(r),Gt(r,"BrtEndStyleSheet"),r.end()}Wr.THEME="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme";var Bs=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Us(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(ge)||[]).forEach((function(e){var i=be(e);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===i[0].charAt(1)?(t.themeElements.clrScheme[Bs.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}}))}function Gs(){}function js(){}var Vs=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,zs=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Hs=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/,Xs=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Ws(e,t){if(!e||0===e.length)return Ws(qs());var r,n={};if(!(r=e.match(Xs)))throw new Error("themeElements not found in theme");return function(e,t,r){var n;t.themeElements={},[["clrScheme",Vs,Us],["fontScheme",zs,Gs],["fmtScheme",Hs,js]].forEach((function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)}))}(r[0],n,t),n.raw=e,n}function qs(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var r=[me];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Ys(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=function(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:case 4:e.l+=4;break;case 1:t.xclrValue=function(e,t){return Ft(e,4)}(e);break;case 2:t.xclrValue=qn(e);break;case 3:t.xclrValue=function(e){return e.read_shift(4)}(e)}return e.l+=8,t}(e);break;case 6:n[1]=function(e,t){return Ft(e,t)}(e,r);break;case 14:case 15:n[1]=e.read_shift(1===r?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}Wr.IMG="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Wr.DRAW="http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing";var Js=1024;function Ks(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[Qe("xml",null,{"xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:o":nt,"xmlns:x":it,"xmlns:mv":"http://macVmlSchemaUri"}).replace(/\/>/,">"),Qe("o:shapelayout",Qe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Qe("v:shapetype",[Qe("v:stroke",null,{joinstyle:"miter"}),Qe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Js<1e3*e;)Js+=1e3;return t.forEach((function(e){var t=Jt(e[0]),r={color2:"#BEFF82",type:"gradient"};"gradient"==r.type&&(r.angle="-180");var n="gradient"==r.type?Qe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,s=Qe("v:fill",n,r);++Js,i=i.concat(["<v:shape"+$e({id:"_x0000_s"+Js,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",s,Qe("v:shadow",null,{on:"t",obscured:"t"}),Qe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ke("x:Anchor",[t.c+1,0,t.r+1,0,t.c+3,20,t.r+5,20].join(",")),Ke("x:AutoFill","False"),Ke("x:Row",String(t.r)),Ke("x:Column",String(t.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])})),i.push("</xml>"),i.join("")}Wr.CMNT="http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments";var $s=Qe("comments",null,{xmlns:rt.main[0]});function Qs(e){var t=[me,$s],r=[];return t.push("<authors>"),e.forEach((function(e){e[1].forEach((function(e){var n=Re(e.a);r.indexOf(n)>-1||(r.push(n),t.push("<author>"+n+"</author>"))}))})),t.push("</authors>"),t.push("<commentList>"),e.forEach((function(e){e[1].forEach((function(n){t.push('<comment ref="'+e[0]+'" authorId="'+r.indexOf(Re(n.a))+'"><text>'),t.push(Ke("t",null==n.t?"":Re(n.t))),t.push("</text></comment>")}))})),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}var Zs=sr;function eo(e){var t=Ut(),r=[];return Gt(t,"BrtBeginComments"),Gt(t,"BrtBeginCommentAuthors"),e.forEach((function(e){e[1].forEach((function(e){r.indexOf(e.a)>-1||(r.push(e.a.slice(0,54)),Gt(t,"BrtCommentAuthor",function(e){return or(e.slice(0,54))}(e.a)))}))})),Gt(t,"BrtEndCommentAuthors"),Gt(t,"BrtBeginCommentList"),e.forEach((function(e){e[1].forEach((function(n){n.iauthor=r.indexOf(n.a);var i={s:Jt(e[0]),e:Jt(e[0])};Gt(t,"BrtBeginComment",function(e,t){return null==t&&(t=Lt(36)),t.write_shift(4,e[1].iauthor),Sr(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}([i,n])),n.t&&n.t.length>0&&Gt(t,"BrtCommentText",function(e,t){var r=!1;return null==t&&(r=!0,t=Lt(23+4*e.t.length)),t.write_shift(1,1),or(e.t,t),t.write_shift(4,1),function(e,t){t||(t=Lt(4)),t.write_shift(2,e.ich||0),t.write_shift(2,e.ifnt||0)}({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}(n)),Gt(t,"BrtEndComment"),delete n.iauthor}))})),Gt(t,"BrtEndCommentList"),Gt(t,"BrtEndComments"),t.end()}var to=["xlsb","xlsm","xlam","biff8","xla"];Wr.DS="http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",Wr.MS="http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet";var ro=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(e,r,n,i){var s=!1,o=!1;0==n.length?o=!0:"["==n.charAt(0)&&(o=!0,n=n.slice(1,-1)),0==i.length?s=!0:"["==i.charAt(0)&&(s=!0,i=i.slice(1,-1));var a=n.length>0?0|parseInt(n,10):0,l=i.length>0?0|parseInt(i,10):0;return s?l+=t.c:--l,o?a+=t.r:--a,r+(s?"":"$")+Yt(l)+(o?"":"$")+Wt(a)}return function(n,i){return t=i,n.replace(e,r)}}(),no=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,io=function(e,t){return e.replace(no,(function(e,r,n,i,s,o){var a=qt(i)-(n?0:t.c),l=Xt(o)-(s?0:t.r);return r+"R"+(0==l?"":s?l+1:"["+l+"]")+"C"+(0==a?"":n?a+1:"["+a+"]")}))};function so(e,t,r){var n=$t(t).s,i=Jt(r);return function(e,t){return e.replace(no,(function(e,r,n,i,s,o){return r+("$"==n?n+i:Yt(qt(i)+t.c))+("$"==s?s+o:Wt(Xt(o)+t.r))}))}(e,{r:i.r-n.r,c:i.c-n.c})}function oo(e){return e.replace(/_xlfn\./g,"")}function ao(e){e.l+=1}function lo(e,t){var r=e.read_shift(1==t?1:2);return[16383&r,r>>14&1,r>>15&1]}function ho(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return uo(e);12==r.biff&&(n=4)}var i=e.read_shift(n),s=e.read_shift(n),o=lo(e,2),a=lo(e,2);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function uo(e){var t=lo(e,2),r=lo(e,2),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function co(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return function(e){var t=lo(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}(e);var n=e.read_shift(r&&12==r.biff?4:2),i=lo(e,2);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function fo(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:255&r,fQuoted:!!(16384&r),cRel:r>>15,rRel:r>>15}}function po(e){return[e.read_shift(1),e.read_shift(1)]}function mo(e,t){var r=[e.read_shift(1)];if(12==t)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2}switch(r[0]){case 4:r[1]=Nn(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:r[1]=Ur[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Tr(e);break;case 2:r[1]=zn(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function _o(e,t,r){for(var n=e.read_shift(12==r.biff?4:2),i=[],s=0;s!=n;++s)i.push((12==r.biff?xr:Zn)(e,8));return i}function go(e,t,r){var n=0,i=0;12==r.biff?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,0==--i&&(i=256));for(var s=0,o=[];s!=n&&(o[s]=[]);++s)for(var a=0;a!=i;++a)o[s][a]=mo(e,r.biff);return o}function vo(e,t,r){return e.l+=2,[fo(e)]}function yo(e){return e.l+=6,[]}var bo=vo,xo=yo,So=yo,To=vo;function Eo(e){return e.l+=2,[kn(e),1&e.read_shift(2)]}var Ao=vo,wo=Eo,Co=yo,Oo=vo,Ro=vo,Do=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"],Io={1:{n:"PtgExp",f:function(e,t,r){return e.l++,r&&12==r.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(r&&2==r.biff?1:2)]}},2:{n:"PtgTbl",f:Ft},3:{n:"PtgAdd",f:ao},4:{n:"PtgSub",f:ao},5:{n:"PtgMul",f:ao},6:{n:"PtgDiv",f:ao},7:{n:"PtgPower",f:ao},8:{n:"PtgConcat",f:ao},9:{n:"PtgLt",f:ao},10:{n:"PtgLe",f:ao},11:{n:"PtgEq",f:ao},12:{n:"PtgGe",f:ao},13:{n:"PtgGt",f:ao},14:{n:"PtgNe",f:ao},15:{n:"PtgIsect",f:ao},16:{n:"PtgUnion",f:ao},17:{n:"PtgRange",f:ao},18:{n:"PtgUplus",f:ao},19:{n:"PtgUminus",f:ao},20:{n:"PtgPercent",f:ao},21:{n:"PtgParen",f:ao},22:{n:"PtgMissArg",f:ao},23:{n:"PtgStr",f:function(e,t,r){return e.l++,Bn(e,0,r)}},26:{n:"PtgSheet",f:function(e,t,r){return e.l+=5,e.l+=2,e.l+=2==r.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,r){return e.l+=2==r.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,Ur[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,Tr(e)}},32:{n:"PtgArray",f:function(e,t,r){var n=(96&e[e.l++])>>5;return e.l+=2==r.biff?6:12==r.biff?14:7,[n]}},33:{n:"PtgFunc",f:function(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[Zo[i],Qo[i],n]}},34:{n:"PtgFuncVar",f:function(e,t,r){var n=e[e.l++],i=e.read_shift(1),s=r&&r.biff<=3?[88==n?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[i,(0===s[0]?Qo:$o)[s[1]]]}},35:{n:"PtgName",f:function(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[n,0,s]}},36:{n:"PtgRef",f:function(e,t,r){var n=(96&e[e.l])>>5;return e.l+=1,[n,co(e,0,r)]}},37:{n:"PtgArea",f:function(e,t,r){return[(96&e[e.l++])>>5,ho(e,r.biff>=2&&r.biff,r)]}},38:{n:"PtgMemArea",f:function(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=r&&2==r.biff?3:4,[n,e.read_shift(r&&2==r.biff?1:2)]}},39:{n:"PtgMemErr",f:Ft},40:{n:"PtgMemNoMem",f:Ft},41:{n:"PtgMemFunc",f:function(e,t,r){return[e.read_shift(1)>>>5&3,e.read_shift(r&&2==r.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,12==r.biff&&(e.l+=2),[n]}},43:{n:"PtgAreaErr",f:function(e,t,r){var n=(96&e[e.l++])>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}},44:{n:"PtgRefN",f:function(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var i=function(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return function(e){var t=e.read_shift(2),r=e.read_shift(1),n=(32768&t)>>15,i=(16384&t)>>14;return t&=16383,1==n&&t>=8192&&(t-=16384),1==i&&r>=128&&(r-=256),{r:t,c:r,cRel:i,rRel:n}}(e);var i=e.read_shift(n>=12?4:2),s=e.read_shift(2),o=(16384&s)>>14,a=(32768&s)>>15;if(s&=16383,1==a)for(;i>524287;)i-=1048576;if(1==o)for(;s>8191;)s-=16384;return{r:i,c:s,cRel:o,rRel:a}}(e,0,r);return[n,i]}},45:{n:"PtgAreaN",f:function(e,t,r){var n=(96&e[e.l++])>>5,i=function(e,t,r){if(r.biff<8)return uo(e);var n=e.read_shift(12==r.biff?4:2),i=e.read_shift(12==r.biff?4:2),s=lo(e,2),o=lo(e,2);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}(e,0,r);return[n,i]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,r){return 5==r.biff?function(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var i=e.read_shift(2);return r&&5==r.biff&&(e.l+=12),[n,i,co(e,0,r)]}},59:{n:"PtgArea3d",f:function(e,t,r){var n=(96&e[e.l++])>>5,i=e.read_shift(2,"i");if(r&&5===r.biff)e.l+=12;return[n,i,ho(e,0,r)]}},60:{n:"PtgRefErr3d",f:function(e,t,r){var n=(96&e[e.l++])>>5,i=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6}return e.l+=s,[n,i]}},61:{n:"PtgAreaErr3d",f:function(e,t,r){var n=(96&e[e.l++])>>5,i=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12}return e.l+=s,[n,i]}},255:{}},Mo={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61};!function(){for(var e in Mo)Io[e]=Io[Mo[e]]}();var No={1:{n:"PtgElfLel",f:Eo},2:{n:"PtgElfRw",f:Oo},3:{n:"PtgElfCol",f:bo},6:{n:"PtgElfRwV",f:Ro},7:{n:"PtgElfColV",f:To},10:{n:"PtgElfRadical",f:Ao},11:{n:"PtgElfRadicalS",f:Co},13:{n:"PtgElfColS",f:xo},15:{n:"PtgElfColSV",f:So},16:{n:"PtgElfRadicalLel",f:wo},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2);return{ixti:t,coltype:3&r,rt:Do[r>>2&31],idx:n,c:i,C:s}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},Po={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=r&&2==r.biff?3:4,[n]}},2:{n:"PtgAttrIf",f:function(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=2,[n,e.read_shift(r&&2==r.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,r){e.l+=2;for(var n=e.read_shift(r&&2==r.biff?1:2),i=[],s=0;s<=n;++s)i.push(e.read_shift(r&&2==r.biff?1:2));return i}},8:{n:"PtgAttrGoto",f:function(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=2,[n,e.read_shift(r&&2==r.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,r){e.l+=r&&2==r.biff?3:4}},32:{n:"PtgAttrBaxcel",f:function(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),po(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),po(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function ko(e,t,r,n){if(n.biff<8)return Ft(e,t);for(var i=e.l+t,s=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=go(e,0,n),s.push(r[o][1]);break;case"PtgMemArea":r[o][2]=_o(e,r[o][1],n),s.push(r[o][2]);break;case"PtgExp":n&&12==n.biff&&(r[o][1][1]=e.read_shift(4),s.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return 0!=(t=i-e.l)&&s.push(Ft(e,t)),s}function Fo(e,t,r){for(var n,i,s=e.l+t,o=[];s!=e.l;)t=s-e.l,i=e[e.l],n=Io[i],(24===i||25===i)&&(n=(24===i?No:Po)[e[e.l+1]]),n&&n.f?o.push([n.n,n.f(e,t,r)]):Ft(e,t);return o}function Lo(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],s=0;s<n.length;++s){var o=n[s];o?2===o[0]?i.push('"'+o[1].replace(/"/g,'""')+'"'):i.push(o[1]):i.push("")}t.push(i.join(","))}return t.join(";")}Po[33]=Po[32];var Bo={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"},Uo=new RegExp(/[^\w\u4E00-\u9FFF\u3040-\u30FF]/);function Go(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=-1==n[1]?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return null!=r.SID?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=-1==n[1]?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map((function(e){return e.Name})).join(";;");default:return e[n[0]][0][3]?(i=-1==n[1]?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function jo(e,t,r){return function(e,t){if(!(e||t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return Uo.test(e)?"'"+e+"'":e}(Go(e,t,r),r)}function Vo(e,t,r,n,i){var s,o,a,l,h=i&&i.biff||8,u={s:{c:0,r:0},e:{c:0,r:0}},c=[],d=0,f=0,p="";if(!e[0]||!e[0][0])return"";for(var m=-1,_="",g=0,v=e[0].length;g<v;++g){var y=e[0][g];switch(y[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(s=c.pop(),o=c.pop(),m>=0){switch(e[0][m][1][0]){case 0:_=re(" ",e[0][m][1][1]);break;case 1:_=re("\r",e[0][m][1][1]);break;default:if(_="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}o+=_,m=-1}c.push(o+Bo[y[0]]+s);break;case"PtgIsect":s=c.pop(),o=c.pop(),c.push(o+" "+s);break;case"PtgUnion":s=c.pop(),o=c.pop(),c.push(o+","+s);break;case"PtgRange":s=c.pop(),o=c.pop(),c.push(o+":"+s);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":a=jt(y[1][1],u,i),c.push(zt(a,h));break;case"PtgRefN":a=r?jt(y[1][1],r,i):y[1][1],c.push(zt(a,h));break;case"PtgRef3d":d=y[1][1],a=jt(y[1][2],u,i),p=jo(n,d,i),c.push(p+"!"+zt(a,h));break;case"PtgFunc":case"PtgFuncVar":var b=y[1][0],x=y[1][1];b||(b=0);var S=0==(b&=127)?[]:c.slice(-b);c.length-=b,"User"===x&&(x=S.shift()),c.push(x+"("+S.join(",")+")");break;case"PtgBool":c.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":c.push(y[1]);break;case"PtgNum":c.push(String(y[1]));break;case"PtgStr":c.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":l=Vt(y[1][1],r?{s:r}:u,i),c.push(Ht(l,i));break;case"PtgArea":l=Vt(y[1][1],u,i),c.push(Ht(l,i));break;case"PtgArea3d":d=y[1][1],l=y[1][2],p=jo(n,d,i),c.push(p+"!"+Ht(l,i));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgName":f=y[1][2];var T=(n.names||[])[f-1]||(n[0]||[])[f],E=T?T.Name:"SH33TJSNAME"+String(f);E in ea&&(E=ea[E]),c.push(E);break;case"PtgNameX":var A,w=y[1][1];if(f=y[1][2],!(i.biff<=5)){var C="";if(14849==((n[w]||[])[0]||[])[0]||(1025==((n[w]||[])[0]||[])[0]?n[w][f]&&n[w][f].itab>0&&(C=n.SheetNames[n[w][f].itab-1]+"!"):C=n.SheetNames[f-1]+"!"),n[w]&&n[w][f])C+=n[w][f].Name;else if(n[0]&&n[0][f])C+=n[0][f].Name;else{var O=Go(n,w,i).split(";;");O[f-1]?C=O[f-1]:C+="SH33TJSERRX"}c.push(C);break}w<0&&(w=-w),n[w]&&(A=n[w][f]),A||(A={Name:"SH33TJSERRY"}),c.push(A.Name);break;case"PtgParen":var R="(",D=")";if(m>=0){switch(_="",e[0][m][1][0]){case 2:R=re(" ",e[0][m][1][1])+R;break;case 3:R=re("\r",e[0][m][1][1])+R;break;case 4:D=re(" ",e[0][m][1][1])+D;break;case 5:D=re("\r",e[0][m][1][1])+D;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}c.push(R+c.pop()+D);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":c.push("#REF!");break;case"PtgExp":a={c:y[1][1],r:y[1][0]};var I={c:r.c,r:r.r};if(n.sharedf[Kt(a)]){var M=n.sharedf[Kt(a)];c.push(Vo(M,0,I,n,i))}else{var N=!1;for(s=0;s!=n.arrayf.length;++s)if(o=n.arrayf[s],!(a.c<o[0].s.c||a.c>o[0].e.c||a.r<o[0].s.r||a.r>o[0].e.r)){c.push(Vo(o[1],0,I,n,i)),N=!0;break}N||c.push(y[1])}break;case"PtgArray":c.push("{"+Lo(y[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=g;break;case"PtgMissArg":c.push("");break;case"PtgList":c.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(y))}if(3!=i.biff&&m>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][g][0])){var P=!0;switch((y=e[0][m])[1][0]){case 4:P=!1;case 0:_=re(" ",y[1][1]);break;case 5:P=!1;case 1:_=re("\r",y[1][1]);break;default:if(_="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}c.push((P?_:"")+c.pop()+(P?"":_)),m=-1}}if(c.length>1&&i.WTF)throw new Error("bad formula stack");return c[0]}function zo(e,t,r){var n,i=e.l+t,s=2==r.biff?1:2,o=e.read_shift(s);if(65535==o)return[[],Ft(e,t-2)];var a=Fo(e,o,r);return t!==o+s&&(n=ko(e,t-o-s,a,r)),e.l=i,[a,n]}function Ho(e,t,r){var n,i=e.l+t,s=e.read_shift(2),o=Fo(e,s,r);return 65535==s?[[],Ft(e,t-2)]:(t!==s+2&&(n=ko(e,i-s-2,o,r)),[o,n])}function Xo(e,t,r){var n=e.l+t,i=Jn(e);2==r.biff&&++e.l;var s=function(e){var t;if(65535!==wt(e,e.l+6))return[Tr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=1===e[e.l+2],e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}(e),o=e.read_shift(1);2!=r.biff&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var a=function(e,t,r){var n,i=e.l+t,s=2==r.biff?1:2,o=e.read_shift(s);if(65535==o)return[[],Ft(e,t-2)];var a=Fo(e,o,r);return t!==o+s&&(n=ko(e,t-o-s,a,r)),e.l=i,[a,n]}(e,n-e.l,r);return{cell:i,val:s[0],formula:a,shared:o>>3&1,tt:s[1]}}function Wo(e,t,r){var n=e.read_shift(4),i=Fo(e,n,r),s=e.read_shift(4);return[i,s>0?ko(e,s,i,r):null]}var qo=Wo,Yo=Wo,Jo=Wo,Ko=Wo,$o={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Qo={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Zo={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0},ea={"_xlfn.ACOT":"ACOT","_xlfn.ACOTH":"ACOTH","_xlfn.AGGREGATE":"AGGREGATE","_xlfn.ARABIC":"ARABIC","_xlfn.AVERAGEIF":"AVERAGEIF","_xlfn.AVERAGEIFS":"AVERAGEIFS","_xlfn.BASE":"BASE","_xlfn.BETA.DIST":"BETA.DIST","_xlfn.BETA.INV":"BETA.INV","_xlfn.BINOM.DIST":"BINOM.DIST","_xlfn.BINOM.DIST.RANGE":"BINOM.DIST.RANGE","_xlfn.BINOM.INV":"BINOM.INV","_xlfn.BITAND":"BITAND","_xlfn.BITLSHIFT":"BITLSHIFT","_xlfn.BITOR":"BITOR","_xlfn.BITRSHIFT":"BITRSHIFT","_xlfn.BITXOR":"BITXOR","_xlfn.CEILING.MATH":"CEILING.MATH","_xlfn.CEILING.PRECISE":"CEILING.PRECISE","_xlfn.CHISQ.DIST":"CHISQ.DIST","_xlfn.CHISQ.DIST.RT":"CHISQ.DIST.RT","_xlfn.CHISQ.INV":"CHISQ.INV","_xlfn.CHISQ.INV.RT":"CHISQ.INV.RT","_xlfn.CHISQ.TEST":"CHISQ.TEST","_xlfn.COMBINA":"COMBINA","_xlfn.CONCAT":"CONCAT","_xlfn.CONFIDENCE.NORM":"CONFIDENCE.NORM","_xlfn.CONFIDENCE.T":"CONFIDENCE.T","_xlfn.COT":"COT","_xlfn.COTH":"COTH","_xlfn.COUNTIFS":"COUNTIFS","_xlfn.COVARIANCE.P":"COVARIANCE.P","_xlfn.COVARIANCE.S":"COVARIANCE.S","_xlfn.CSC":"CSC","_xlfn.CSCH":"CSCH","_xlfn.DAYS":"DAYS","_xlfn.DECIMAL":"DECIMAL","_xlfn.ECMA.CEILING":"ECMA.CEILING","_xlfn.ERF.PRECISE":"ERF.PRECISE","_xlfn.ERFC.PRECISE":"ERFC.PRECISE","_xlfn.EXPON.DIST":"EXPON.DIST","_xlfn.F.DIST":"F.DIST","_xlfn.F.DIST.RT":"F.DIST.RT","_xlfn.F.INV":"F.INV","_xlfn.F.INV.RT":"F.INV.RT","_xlfn.F.TEST":"F.TEST","_xlfn.FILTERXML":"FILTERXML","_xlfn.FLOOR.MATH":"FLOOR.MATH","_xlfn.FLOOR.PRECISE":"FLOOR.PRECISE","_xlfn.FORECAST.ETS":"FORECAST.ETS","_xlfn.FORECAST.ETS.CONFINT":"FORECAST.ETS.CONFINT","_xlfn.FORECAST.ETS.SEASONALITY":"FORECAST.ETS.SEASONALITY","_xlfn.FORECAST.ETS.STAT":"FORECAST.ETS.STAT","_xlfn.FORECAST.LINEAR":"FORECAST.LINEAR","_xlfn.FORMULATEXT":"FORMULATEXT","_xlfn.GAMMA":"GAMMA","_xlfn.GAMMA.DIST":"GAMMA.DIST","_xlfn.GAMMA.INV":"GAMMA.INV","_xlfn.GAMMALN.PRECISE":"GAMMALN.PRECISE","_xlfn.GAUSS":"GAUSS","_xlfn.HYPGEOM.DIST":"HYPGEOM.DIST","_xlfn.IFERROR":"IFERROR","_xlfn.IFNA":"IFNA","_xlfn.IFS":"IFS","_xlfn.IMCOSH":"IMCOSH","_xlfn.IMCOT":"IMCOT","_xlfn.IMCSC":"IMCSC","_xlfn.IMCSCH":"IMCSCH","_xlfn.IMSEC":"IMSEC","_xlfn.IMSECH":"IMSECH","_xlfn.IMSINH":"IMSINH","_xlfn.IMTAN":"IMTAN","_xlfn.ISFORMULA":"ISFORMULA","_xlfn.ISO.CEILING":"ISO.CEILING","_xlfn.ISOWEEKNUM":"ISOWEEKNUM","_xlfn.LOGNORM.DIST":"LOGNORM.DIST","_xlfn.LOGNORM.INV":"LOGNORM.INV","_xlfn.MAXIFS":"MAXIFS","_xlfn.MINIFS":"MINIFS","_xlfn.MODE.MULT":"MODE.MULT","_xlfn.MODE.SNGL":"MODE.SNGL","_xlfn.MUNIT":"MUNIT","_xlfn.NEGBINOM.DIST":"NEGBINOM.DIST","_xlfn.NETWORKDAYS.INTL":"NETWORKDAYS.INTL","_xlfn.NIGBINOM":"NIGBINOM","_xlfn.NORM.DIST":"NORM.DIST","_xlfn.NORM.INV":"NORM.INV","_xlfn.NORM.S.DIST":"NORM.S.DIST","_xlfn.NORM.S.INV":"NORM.S.INV","_xlfn.NUMBERVALUE":"NUMBERVALUE","_xlfn.PDURATION":"PDURATION","_xlfn.PERCENTILE.EXC":"PERCENTILE.EXC","_xlfn.PERCENTILE.INC":"PERCENTILE.INC","_xlfn.PERCENTRANK.EXC":"PERCENTRANK.EXC","_xlfn.PERCENTRANK.INC":"PERCENTRANK.INC","_xlfn.PERMUTATIONA":"PERMUTATIONA","_xlfn.PHI":"PHI","_xlfn.POISSON.DIST":"POISSON.DIST","_xlfn.QUARTILE.EXC":"QUARTILE.EXC","_xlfn.QUARTILE.INC":"QUARTILE.INC","_xlfn.QUERYSTRING":"QUERYSTRING","_xlfn.RANK.AVG":"RANK.AVG","_xlfn.RANK.EQ":"RANK.EQ","_xlfn.RRI":"RRI","_xlfn.SEC":"SEC","_xlfn.SECH":"SECH","_xlfn.SHEET":"SHEET","_xlfn.SHEETS":"SHEETS","_xlfn.SKEW.P":"SKEW.P","_xlfn.STDEV.P":"STDEV.P","_xlfn.STDEV.S":"STDEV.S","_xlfn.SUMIFS":"SUMIFS","_xlfn.SWITCH":"SWITCH","_xlfn.T.DIST":"T.DIST","_xlfn.T.DIST.2T":"T.DIST.2T","_xlfn.T.DIST.RT":"T.DIST.RT","_xlfn.T.INV":"T.INV","_xlfn.T.INV.2T":"T.INV.2T","_xlfn.T.TEST":"T.TEST","_xlfn.TEXTJOIN":"TEXTJOIN","_xlfn.UNICHAR":"UNICHAR","_xlfn.UNICODE":"UNICODE","_xlfn.VAR.P":"VAR.P","_xlfn.VAR.S":"VAR.S","_xlfn.WEBSERVICE":"WEBSERVICE","_xlfn.WEIBULL.DIST":"WEIBULL.DIST","_xlfn.WORKDAY.INTL":"WORKDAY.INTL","_xlfn.XOR":"XOR","_xlfn.Z.TEST":"Z.TEST"};function ta(e){return"of:"==e.slice(0,3)&&(e=e.slice(3)),61==e.charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)&&(e=e.slice(1)),(e=(e=(e=e.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,(function(e,t){return t.replace(/\./g,"")}))).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function ra(e){var t=e.split(":");return[t[0].split(".")[0],t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var na={},ia={};Wr.WS=["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"];var sa="undefined"!=typeof Map;function oa(e,t,r){var n=0,i=e.length;if(r){if(sa?r.has(t):Object.prototype.hasOwnProperty.call(r,t))for(var s=sa?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t},e.Count++,e.Unique++,r&&(sa?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function aa(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(us=t.MDW),null!=t.width?r.customWidth=1:null!=t.wpx?n=ds(t.wpx):null!=t.wch&&(n=t.wch),n>-1?(r.width=fs(n),r.customWidth=1):null!=t.width&&(r.width=t.width),t.hidden&&(r.hidden=!0),r}function la(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(r=[1,1,1,1,.5,.5]),null==e.left&&(e.left=r[0]),null==e.right&&(e.right=r[1]),null==e.top&&(e.top=r[2]),null==e.bottom&&(e.bottom=r[3]),null==e.header&&(e.header=r[4]),null==e.footer&&(e.footer=r[5])}}function ha(e,t,r){var n=r.revssf[null!=t.z?t.z:"General"],i=60,s=e.length;if(null==n&&r.ssf)for(;i<392;++i)if(null==r.ssf[i]){R.load(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}for(i=0;i!=s;++i)if(e[i].numFmtId===n)return i;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function ua(e,t,r,n,i,s){try{n.cellNF&&(e.z=R._table[t])}catch(e){if(n.WTF)throw e}if("z"!==e.t){if("d"===e.t&&"string"==typeof e.v&&(e.v=Z(e.v)),!n||!1!==n.cellText)try{if(null==R._table[t]&&R.load(N[t]||"General",t),"e"===e.t)e.w=e.w||Ur[e.v];else if(0===t)if("n"===e.t)(0|e.v)===e.v?e.w=R._general_int(e.v):e.w=R._general_num(e.v);else if("d"===e.t){var o=H(e.v);e.w=(0|o)===o?R._general_int(o):R._general_num(o)}else{if(void 0===e.v)return"";e.w=R._general(e.v,ia)}else"d"===e.t?e.w=R.format(t,H(e.v),ia):e.w=R.format(t,e.v,ia)}catch(e){if(n.WTF)throw e}if(n.cellStyles&&null!=r)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=hs(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=hs(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(e){if(n.WTF&&s.Fills)throw e}}}function ca(e,t,r){if(e&&e["!ref"]){var n=Zt(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}var da=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,fa=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,pa=/<(?:\w:)?hyperlink [^>]*>/gm,ma=/"(\w*:\w*)"/,_a=/<(?:\w:)?col\b[^>]*[\/]?>/g,ga=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,va=/<(?:\w:)?pageMargins[^>]*\/>/g,ya=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,ba=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function xa(e,t,r,n){var i=be(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=we(ke(i.codeName)))}var Sa=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Ta=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"],Ea=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Aa(e,t,r,n){if(void 0===e.v&&"string"!=typeof e.f||"z"===e.t)return"";var i="",s=e.t,o=e.v;if("z"!==e.t)switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=Ur[e.v];break;case"d":n&&n.cellDates?i=Z(e.v,-1).toISOString():((e=te(e)).t="n",i=""+(e.v=H(Z(e.v)))),void 0===e.z&&(e.z=R._table[14]);break;default:i=e.v}var a=Ke("v",Re(i)),l={r:t},h=ha(n.cellXfs,e,n);switch(0!==h&&(l.s=h),e.t){case"n":case"z":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;default:if(null==e.v){delete e.t;break}if(n&&n.bookSST){a=Ke("v",""+oa(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str"}if(e.t!=s&&(e.t=s,e.v=o),"string"==typeof e.f&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;a=Qe("f",Re(e.f),u)+(null!=e.v?a:"")}return e.l&&r["!links"].push([t,e.l]),e.c&&r["!comments"].push([t,e.c]),Qe("c",a,l)}var wa,Ca,Oa,Ra,Da,Ia,Ma,Na=(wa=/<(?:\w+:)?c[ \/>]/,Ca=/<\/(?:\w+:)?row>/,Oa=/r=["']([^"']*)["']/,Ra=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,Da=/ref=["']([^"']*)["']/,Ia=ze("v"),Ma=ze("f"),function(e,t,r,n,i,s){for(var o,a,l,h,u,c=0,d="",f=[],p=[],m=0,_=0,g=0,v="",y=0,b=0,x=0,S=0,T=Array.isArray(s.CellXf),E=[],A=[],w=Array.isArray(t),C=[],O={},D=!1,I=!!r.sheetStubs,M=e.split(Ca),N=0,P=M.length;N!=P;++N){var k=(d=M[N].trim()).length;if(0!==k){for(c=0;c<k&&62!==d.charCodeAt(c);++c);if(++c,y=null!=(a=be(d.slice(0,c),!0)).r?parseInt(a.r,10):y+1,b=-1,!(r.sheetRows&&r.sheetRows<y)){n.s.r>y-1&&(n.s.r=y-1),n.e.r<y-1&&(n.e.r=y-1),r&&r.cellStyles&&(O={},D=!1,a.ht&&(D=!0,O.hpt=parseFloat(a.ht),O.hpx=vs(O.hpt)),"1"==a.hidden&&(D=!0,O.hidden=!0),null!=a.outlineLevel&&(D=!0,O.level=+a.outlineLevel),D&&(C[y-1]=O)),f=d.slice(c).split(wa);for(var F=0;F!=f.length&&"<"==f[F].trim().charAt(0);++F);for(f=f.slice(F),c=0;c!=f.length;++c)if(0!==(d=f[c].trim()).length){if(p=d.match(Oa),m=c,_=0,g=0,d="<c "+("<"==d.slice(0,1)?">":"")+d,null!=p&&2===p.length){for(m=0,v=p[1],_=0;_!=v.length&&!((g=v.charCodeAt(_)-64)<1||g>26);++_)m=26*m+g;b=--m}else++b;for(_=0;_!=d.length&&62!==d.charCodeAt(_);++_);if(++_,(a=be(d.slice(0,_),!0)).r||(a.r=Kt({r:y-1,c:b})),o={t:""},null!=(p=(v=d.slice(_)).match(Ia))&&""!==p[1]&&(o.v=we(p[1])),r.cellFormula){if(null!=(p=v.match(Ma))&&""!==p[1]){if(o.f=we(ke(p[1])).replace(/\r\n/g,"\n"),r.xlfn||(o.f=oo(o.f)),p[0].indexOf('t="array"')>-1)o.F=(v.match(Da)||[])[1],o.F.indexOf(":")>-1&&E.push([Zt(o.F),o.F]);else if(p[0].indexOf('t="shared"')>-1){h=be(p[0]);var L=we(ke(p[1]));r.xlfn||(L=oo(L)),A[parseInt(h.si,10)]=[h,L,a.r]}}else(p=v.match(/<f[^>]*\/>/))&&A[(h=be(p[0])).si]&&(o.f=so(A[h.si][1],A[h.si][2],a.r));var B=Jt(a.r);for(_=0;_<E.length;++_)B.r>=E[_][0].s.r&&B.r<=E[_][0].e.r&&B.c>=E[_][0].s.c&&B.c<=E[_][0].e.c&&(o.F=E[_][1])}if(null==a.t&&void 0===o.v)if(o.f||o.F)o.v=0,o.t="n";else{if(!I)continue;o.t="z"}else o.t=a.t||"n";switch(n.s.c>b&&(n.s.c=b),n.e.c<b&&(n.e.c=b),o.t){case"n":if(""==o.v||null==o.v){if(!I)continue;o.t="z"}else o.v=parseFloat(o.v);break;case"s":if(void 0===o.v){if(!I)continue;o.t="z"}else l=na[parseInt(o.v,10)],o.v=l.t,o.r=l.r,r.cellHTML&&(o.h=l.h);break;case"str":o.t="s",o.v=null!=o.v?ke(o.v):"",r.cellHTML&&(o.h=Me(o.v));break;case"inlineStr":p=v.match(Ra),o.t="s",null!=p&&(l=Ui(p[1]))?(o.v=l.t,r.cellHTML&&(o.h=l.h)):o.v="";break;case"b":o.v=Pe(o.v);break;case"d":r.cellDates?o.v=Z(o.v,1):(o.v=H(Z(o.v,1)),o.t="n");break;case"e":(!r||!1!==r.cellText)&&(o.w=o.v),o.v=Gr[o.v]}if(x=S=0,u=null,T&&void 0!==a.s&&null!=(u=s.CellXf[a.s])&&(null!=u.numFmtId&&(x=u.numFmtId),r.cellStyles&&null!=u.fillId&&(S=u.fillId)),ua(o,x,S,r,i,s),r.cellDates&&T&&"n"==o.t&&R.is_date(R._table[x])&&(o.t="d",o.v=Y(o.v)),w){var U=Jt(a.r);t[U.r]||(t[U.r]=[]),t[U.r][U.c]=o}else t[a.r]=o}}}}C.length>0&&(t["!rows"]=C)}),Pa=Qe("worksheet",null,{xmlns:rt.main[0],"xmlns:r":rt.r});function ka(e,t,r,n){var i,s=[me,Pa],o=r.SheetNames[e],a="",l=r.Sheets[o];null==l&&(l={});var h=l["!ref"]||"A1",u=Zt(h);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),h=Qt(u)}n||(n={}),l["!comments"]=[];var c=[];(function(e,t,r,n,i){var s=!1,o={},a=null;if("xlsx"!==n.bookType&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch(e){}s=!0,o.codeName=Fe(Re(l))}if(e&&e["!outline"]){var h={summaryBelow:1,summaryRight:1};e["!outline"].above&&(h.summaryBelow=0),e["!outline"].left&&(h.summaryRight=0),a=(a||"")+Qe("outlinePr",null,h)}!s&&!a||(i[i.length]=Qe("sheetPr",a,o))})(l,r,e,t,s),s[s.length]=Qe("dimension",null,{ref:h}),s[s.length]=function(e,t,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Qe("sheetViews",Qe("sheetView",null,i),{})}(0,0,0,r),t.sheetFormat&&(s[s.length]=Qe("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),null!=l["!cols"]&&l["!cols"].length>0&&(s[s.length]=function(e,t){for(var r,n=["<cols>"],i=0;i!=t.length;++i)!(r=t[i])||(n[n.length]=Qe("col",null,aa(i,r)));return n[n.length]="</cols>",n.join("")}(0,l["!cols"])),s[i=s.length]="<sheetData/>",l["!links"]=[],null!=l["!ref"]&&(a=function(e,t,r,n){var i,s,o=[],a=[],l=Zt(e["!ref"]),h="",u="",c=[],d=0,f=0,p=e["!rows"],m=Array.isArray(e),_={r:u},g=-1;for(f=l.s.c;f<=l.e.c;++f)c[f]=Yt(f);for(d=l.s.r;d<=l.e.r;++d){for(a=[],u=Wt(d),f=l.s.c;f<=l.e.c;++f){i=c[f]+u;var v=m?(e[d]||[])[f]:e[i];void 0!==v&&null!=(h=Aa(v,i,e,t))&&a.push(h)}(a.length>0||p&&p[d])&&(_={r:u},p&&p[d]&&((s=p[d]).hidden&&(_.hidden=1),g=-1,s.hpx?g=gs(s.hpx):s.hpt&&(g=s.hpt),g>-1&&(_.ht=g,_.customHeight=1),s.level&&(_.outlineLevel=s.level)),o[o.length]=Qe("row",a.join(""),_))}if(p)for(;d<p.length;++d)p&&p[d]&&(_={r:d+1},(s=p[d]).hidden&&(_.hidden=1),g=-1,s.hpx?g=gs(s.hpx):s.hpt&&(g=s.hpt),g>-1&&(_.ht=g,_.customHeight=1),s.level&&(_.outlineLevel=s.level),o[o.length]=Qe("row","",_));return o.join("")}(l,t),a.length>0&&(s[s.length]=a)),s.length>i+1&&(s[s.length]="</sheetData>",s[i]=s[i].replace("/>",">")),null!=l["!protect"]&&(s[s.length]=function(e){var t={sheet:1};return Sa.forEach((function(r){null!=e[r]&&e[r]&&(t[r]="1")})),Ta.forEach((function(r){null!=e[r]&&!e[r]&&(t[r]="0")})),e.password&&(t.password=ts(e.password).toString(16).toUpperCase()),Qe("sheetProtection",null,t)}(l["!protect"])),null!=l["!autofilter"]&&(s[s.length]=function(e,t,r,n){var i="string"==typeof e.ref?e.ref:Qt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=$t(i);o.s.r==o.e.r&&(o.e.r=$t(t["!ref"]).e.r,i=Qt(o));for(var a=0;a<s.length;++a){var l=s[a];if("_xlnm._FilterDatabase"==l.Name&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return a==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Qe("autoFilter",null,{ref:i})}(l["!autofilter"],l,r,e)),null!=l["!merges"]&&l["!merges"].length>0&&(s[s.length]=function(e){if(0===e.length)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Qt(e[r])+'"/>';return t+"</mergeCells>"}(l["!merges"]));var d,f,p=-1,m=-1;return l["!links"].length>0&&(s[s.length]="<hyperlinks>",l["!links"].forEach((function(e){!e[1].Target||(d={ref:e[0]},"#"!=e[1].Target.charAt(0)&&(m=Qr(n,-1,Re(e[1].Target).replace(/#.*$/,""),Wr.HLINK),d["r:id"]="rId"+m),(p=e[1].Target.indexOf("#"))>-1&&(d.location=Re(e[1].Target.slice(p+1))),e[1].Tooltip&&(d.tooltip=Re(e[1].Tooltip)),s[s.length]=Qe("hyperlink",null,d))})),s[s.length]="</hyperlinks>"),delete l["!links"],null!=l["!margins"]&&(s[s.length]=(la(f=l["!margins"]),Qe("pageMargins",null,f))),(!t||t.ignoreEC||null==t.ignoreEC)&&(s[s.length]=Ke("ignoredErrors",Qe("ignoredError",null,{numberStoredAsText:1,sqref:h}))),c.length>0&&(m=Qr(n,-1,"../drawings/drawing"+(e+1)+".xml",Wr.DRAW),s[s.length]=Qe("drawing",null,{"r:id":"rId"+m}),l["!drawing"]=c),l["!comments"].length>0&&(m=Qr(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Wr.VML),s[s.length]=Qe("legacyDrawing",null,{"r:id":"rId"+m}),l["!legacy"]=m),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function Fa(e,t,r,n){var i=function(e,t,r){var n=Lt(145),i=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;i.hpx?s=20*gs(i.hpx):i.hpt&&(s=20*i.hpt),n.write_shift(2,s),n.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var a=0,l=n.l;n.l+=4;for(var h={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var c=-1,d=-1,f=u<<10;f<u+1<<10;++f)h.c=f,(Array.isArray(r)?(r[h.r]||[])[h.c]:r[Kt(h)])&&(c<0&&(c=f),d=f);c<0||(++a,n.write_shift(4,c),n.write_shift(4,d))}var p=n.l;return n.l=l,n.write_shift(4,a),n.l=p,n.length>n.l?n.slice(0,n.l):n}(n,r,t);(i.length>17||(t["!rows"]||[])[n])&&Gt(e,"BrtRowHdr",i)}var La=xr,Ba=Sr;var Ua=xr,Ga=Sr,ja=["left","right","top","bottom","header","footer"];function Va(e,t,r,n,i,s){if(void 0!==t.v){var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":(t=te(t)).z=t.z||R._table[14],t.v=H(Z(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v}var a={r,c:n};switch(a.s=ha(i.cellXfs,t,i),t.l&&s["!links"].push([Kt(a),t.l]),t.c&&s["!comments"].push([Kt(a),t.c]),t.t){case"s":case"str":return void(i.bookSST?(o=oa(i.Strings,t.v,i.revStrings),a.t="s",a.v=o,Gt(e,"BrtCellIsst",function(e,t,r){return null==r&&(r=Lt(12)),cr(t,r),r.write_shift(4,t.v),r}(0,a))):(a.t="str",Gt(e,"BrtCellSt",function(e,t,r){return null==r&&(r=Lt(12+4*e.v.length)),cr(t,r),or(e.v,r),r.length>r.l?r.slice(0,r.l):r}(t,a))));case"n":return void(t.v==(0|t.v)&&t.v>-1e3&&t.v<1e3?Gt(e,"BrtCellRk",function(e,t,r){return null==r&&(r=Lt(12)),cr(t,r),function(e,t){null==t&&(t=Lt(4));var r=0,n=0,i=100*e;if(e==(0|e)&&e>=-(1<<29)&&e<1<<29?n=1:i==(0|i)&&i>=-(1<<29)&&i<1<<29&&(n=1,r=1),!n)throw new Error("unsupported RkNumber "+e);t.write_shift(-4,((r?i:e)<<2)+(r+2))}(e.v,r),r}(t,a)):Gt(e,"BrtCellReal",function(e,t,r){return null==r&&(r=Lt(16)),cr(t,r),Er(e.v,r),r}(t,a)));case"b":return a.t="b",void Gt(e,"BrtCellBool",function(e,t,r){return null==r&&(r=Lt(9)),cr(t,r),r.write_shift(1,e.v?1:0),r}(t,a));case"e":a.t="e"}Gt(e,"BrtCellBlank",function(e,t,r){return null==r&&(r=Lt(8)),cr(t,r)}(0,a))}}function za(e,t,r,n){var i=Ut(),s=r.SheetNames[e],o=r.Sheets[s]||{},a=s;try{r&&r.Workbook&&(a=r.Workbook.Sheets[e].CodeName||a)}catch(e){}var l=Zt(o["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Gt(i,"BrtBeginSheet"),r.vbaraw&&Gt(i,"BrtWsProp",function(e,t){null==t&&(t=Lt(84+4*e.length));for(var r=0;r<3;++r)t.write_shift(1,0);return Ar({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),fr(e,t),t.slice(0,t.l)}(a)),Gt(i,"BrtWsDim",Ba(l)),function(e,t,r){Gt(e,"BrtBeginWsViews"),Gt(e,"BrtBeginWsView",function(e,t,r){null==r&&(r=Lt(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}(0,r)),Gt(e,"BrtEndWsView"),Gt(e,"BrtEndWsViews")}(i,0,r.Workbook),function(e,t){!t||!t["!cols"]||(Gt(e,"BrtBeginColInfos"),t["!cols"].forEach((function(t,r){t&&Gt(e,"BrtColInfo",function(e,t,r){null==r&&(r=Lt(18));var n=aa(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,256*(n.width||10)),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),"number"==typeof n.width&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}(r,t))})),Gt(e,"BrtEndColInfos"))}(i,o),function(e,t,r,n){var i,s=Zt(t["!ref"]||"A1"),o="",a=[];Gt(e,"BrtBeginSheetData");var l=Array.isArray(t),h=s.e.r;t["!rows"]&&(h=Math.max(s.e.r,t["!rows"].length-1));for(var u=s.s.r;u<=h;++u)if(o=Wt(u),Fa(e,t,s,u),u<=s.e.r)for(var c=s.s.c;c<=s.e.c;++c){u===s.s.r&&(a[c]=Yt(c)),i=a[c]+o;var d=l?(t[u]||[])[c]:t[i];!d||Va(e,d,u,c,n,t)}Gt(e,"BrtEndSheetData")}(i,o,0,t),function(e,t){!t["!protect"]||Gt(e,"BrtSheetProtection",function(e,t){return null==t&&(t=Lt(66)),t.write_shift(2,e.password?ts(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach((function(r){r[1]?t.write_shift(4,null==e[r[0]]||e[r[0]]?0:1):t.write_shift(4,null!=e[r[0]]&&e[r[0]]?0:1)})),t}(t["!protect"]))}(i,o),function(e,t,r,n){if(t["!autofilter"]){var i=t["!autofilter"],s="string"==typeof i.ref?i.ref:Qt(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,a=$t(s);a.s.r==a.e.r&&(a.e.r=$t(t["!ref"]).e.r,s=Qt(a));for(var l=0;l<o.length;++l){var h=o[l];if("_xlnm._FilterDatabase"==h.Name&&h.Sheet==n){h.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Gt(e,"BrtBeginAFilter",Sr(Zt(s))),Gt(e,"BrtEndAFilter")}}(i,o,r,e),function(e,t){!t||!t["!merges"]||(Gt(e,"BrtBeginMergeCells",function(e,t){return null==t&&(t=Lt(4)),t.write_shift(4,e),t}(t["!merges"].length)),t["!merges"].forEach((function(t){Gt(e,"BrtMergeCell",Ga(t))})),Gt(e,"BrtEndMergeCells"))}(i,o),function(e,t,r){t["!links"].forEach((function(t){if(t[1].Target){var n=Qr(r,-1,t[1].Target.replace(/#.*$/,""),Wr.HLINK);Gt(e,"BrtHLink",function(e,t){var r=Lt(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Sr({s:Jt(e[0]),e:Jt(e[0])},r),vr("rId"+t,r);var n=e[1].Target.indexOf("#");return or((-1==n?"":e[1].Target.slice(n+1))||"",r),or(e[1].Tooltip||"",r),or("",r),r.slice(0,r.l)}(t,n))}})),delete t["!links"]}(i,o,n),o["!margins"]&&Gt(i,"BrtMargins",function(e,t){return null==t&&(t=Lt(48)),la(e),ja.forEach((function(r){Er(e[r],t)})),t}(o["!margins"])),(!t||t.ignoreEC||null==t.ignoreEC)&&function(e,t){!t||!t["!ref"]||(Gt(e,"BrtBeginCellIgnoreECs"),Gt(e,"BrtCellIgnoreEC",function(e){var t=Lt(24);return t.write_shift(4,4),t.write_shift(4,1),Sr(e,t),t}(Zt(t["!ref"]))),Gt(e,"BrtEndCellIgnoreECs"))}(i,o),function(e,t,r,n){if(t["!comments"].length>0){var i=Qr(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Wr.VML);Gt(e,"BrtLegacyDrawing",vr("rId"+i)),t["!legacy"]=i}}(i,o,e,n),Gt(i,"BrtEndSheet"),i.end()}Wr.CHART="http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",Wr.CHARTEX="http://schemas.microsoft.com/office/2014/relationships/chartEx",Wr.CS="http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",Qe("chartsheet",null,{xmlns:rt.main[0],"xmlns:r":rt.r});var Ha=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Xa=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Wa=[],qa=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Ya(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var s=t[i];if(null==n[s[0]])n[s[0]]=s[1];else switch(s[2]){case"bool":"string"==typeof n[s[0]]&&(n[s[0]]=Pe(n[s[0]]));break;case"int":"string"==typeof n[s[0]]&&(n[s[0]]=parseInt(n[s[0]],10))}}}function Ja(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(null==e[n[0]])e[n[0]]=n[1];else switch(n[2]){case"bool":"string"==typeof e[n[0]]&&(e[n[0]]=Pe(e[n[0]]));break;case"int":"string"==typeof e[n[0]]&&(e[n[0]]=parseInt(e[n[0]],10))}}}function Ka(e){Ja(e.WBProps,Ha),Ja(e.CalcPr,qa),Ya(e.WBView,Xa),Ya(e.Sheets,Wa),ia.date1904=Pe(e.WBProps.date1904)}var $a="][*?/\\".split("");function Qa(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return $a.forEach((function(n){if(-1!=e.indexOf(n)){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}})),r}var Za=/<\w+:workbook/,el=Qe("workbook",null,{xmlns:rt.main[0],"xmlns:r":rt.r});function tl(e){var t=[me];t[t.length]=el;var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Ha.forEach((function(t){null!=e.Workbook.WBProps[t[0]]&&e.Workbook.WBProps[t[0]]!=t[1]&&(n[t[0]]=e.Workbook.WBProps[t[0]])})),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Qe("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&i[s]&&i[s].Hidden;++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var o={name:Re(e.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden"}t[t.length]=Qe("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach((function(e){var r={name:e.Name};e.Comment&&(r.comment=e.Comment),null!=e.Sheet&&(r.localSheetId=""+e.Sheet),e.Hidden&&(r.hidden="1"),e.Ref&&(t[t.length]=Qe("definedName",Re(e.Ref),r))})),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function rl(e,t){return t||(t=Lt(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),vr(e.strRelID,t),or(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function nl(e,t){var n=Ut();return Gt(n,"BrtBeginBook"),Gt(n,"BrtFileVersion",function(e,t){t||(t=Lt(127));for(var n=0;4!=n;++n)t.write_shift(4,0);return or("SheetJS",t),or(r.version,t),or(r.version,t),or("7262",t),t.length=t.l,t.length>t.l?t.slice(0,t.l):t}()),Gt(n,"BrtWbProp",function(e,t){t||(t=Lt(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),fr(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}(e.Workbook&&e.Workbook.WBProps||null)),function(e,t){if(t.Workbook&&t.Workbook.Sheets){for(var r=t.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&-1==i?i=n:1==r[n].Hidden&&-1==s&&(s=n);s>i||(Gt(e,"BrtBeginBookViews"),Gt(e,"BrtBookView",function(e,t){return t||(t=Lt(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e),t.write_shift(1,120),t.length>t.l?t.slice(0,t.l):t}(i)),Gt(e,"BrtEndBookViews"))}}(n,e),function(e,t){Gt(e,"BrtBeginBundleShs");for(var r=0;r!=t.SheetNames.length;++r)Gt(e,"BrtBundleSh",rl({Hidden:t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]}));Gt(e,"BrtEndBundleShs")}(n,e),Gt(n,"BrtEndBook"),n.end()}function il(e,t,r,n,i,s,o,a){return".bin"===t.slice(-4)?function(e,t,r,n,i,s,o){if(!e)return e;var a=t||{};n||(n={"!id":{}});var l,h,u,c,d,f,p,m,_,g,v=a.dense?[]:{},y={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=[],x=!1,S=!1,T=[];a.biff=12,a["!row"]=0;var E=0,A=!1,w=[],C={},O=a.supbooks||i.supbooks||[[]];if(O.sharedf=C,O.arrayf=w,O.SheetNames=i.SheetNames||i.Sheets.map((function(e){return e.name})),!a.supbooks&&(a.supbooks=O,i.Names))for(var D=0;D<i.Names.length;++D)O[0][D+1]=i.Names[D];var I=[],M=[],N=!1;if(Bt(e,(function(e,t,D){if(!S)switch(D){case 148:l=e;break;case 0:h=e,a.sheetRows&&a.sheetRows<=h.r&&(S=!0),_=Wt(d=h.r),a["!row"]=h.r,(e.hidden||e.hpt||null!=e.level)&&(e.hpt&&(e.hpx=vs(e.hpt)),M[e.r]=e);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:switch(u={t:e[2]},e[2]){case"n":u.v=e[1];break;case"s":m=na[e[1]],u.v=m.t,u.r=m.r;break;case"b":u.v=!!e[1];break;case"e":u.v=e[1],!1!==a.cellText&&(u.w=Ur[u.v]);break;case"str":u.t="s",u.v=e[1]}if((c=o.CellXf[e[0].iStyleRef])&&ua(u,c.numFmtId,null,a,s,o),f=e[0].c,a.dense?(v[d]||(v[d]=[]),v[d][f]=u):v[Yt(f)+_]=u,a.cellFormula){for(A=!1,E=0;E<w.length;++E){var P=w[E];h.r>=P[0].s.r&&h.r<=P[0].e.r&&f>=P[0].s.c&&f<=P[0].e.c&&(u.F=Qt(P[0]),A=!0)}!A&&e.length>3&&(u.f=e[3])}if(y.s.r>h.r&&(y.s.r=h.r),y.s.c>f&&(y.s.c=f),y.e.r<h.r&&(y.e.r=h.r),y.e.c<f&&(y.e.c=f),a.cellDates&&c&&"n"==u.t&&R.is_date(R._table[c.numFmtId])){var k=R.parse_date_code(u.v);k&&(u.t="d",u.v=new Date(k.y,k.m-1,k.d,k.H,k.M,k.S,k.u))}break;case 1:if(!a.sheetStubs||x)break;u={t:"z",v:void 0},f=e[0].c,a.dense?(v[d]||(v[d]=[]),v[d][f]=u):v[Yt(f)+_]=u,y.s.r>h.r&&(y.s.r=h.r),y.s.c>f&&(y.s.c=f),y.e.r<h.r&&(y.e.r=h.r),y.e.c<f&&(y.e.c=f);break;case 176:T.push(e);break;case 494:var F=n["!id"][e.relId];for(F?(e.Target=F.Target,e.loc&&(e.Target+="#"+e.loc),e.Rel=F):""==e.relId&&(e.Target="#"+e.loc),d=e.rfx.s.r;d<=e.rfx.e.r;++d)for(f=e.rfx.s.c;f<=e.rfx.e.c;++f)a.dense?(v[d]||(v[d]=[]),v[d][f]||(v[d][f]={t:"z",v:void 0}),v[d][f].l=e):(p=Kt({c:f,r:d}),v[p]||(v[p]={t:"z",v:void 0}),v[p].l=e);break;case 426:if(!a.cellFormula)break;w.push(e),(g=a.dense?v[d][f]:v[Yt(f)+_]).f=Vo(e[1],0,{r:h.r,c:f},O,a),g.F=Qt(e[0]);break;case 427:if(!a.cellFormula)break;C[Kt(e[0].s)]=e[1],(g=a.dense?v[d][f]:v[Yt(f)+_]).f=Vo(e[1],0,{r:h.r,c:f},O,a);break;case 60:if(!a.cellStyles)break;for(;e.e>=e.s;)I[e.e--]={width:e.w/256,hidden:!!(1&e.flags),level:e.level},N||(N=!0,ms(e.w/256)),_s(I[e.e+1]);break;case 161:v["!autofilter"]={ref:Qt(e)};break;case 476:v["!margins"]=e;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),e.name&&(i.Sheets[r].CodeName=e.name);break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),e.RTL&&(i.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 49:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 152:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:x=!0;break;case 36:x=!1;break;case 37:b.push(t),x=!0;break;case 38:b.pop(),x=!1;break;default:if(!((t||"").indexOf("Begin")>0)&&!((t||"").indexOf("End")>0)&&(!x||a.WTF))throw new Error("Unexpected record "+D+" "+t)}}),a),delete a.supbooks,delete a["!row"],!v["!ref"]&&(y.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(v["!ref"]=Qt(l||y)),a.sheetRows&&v["!ref"]){var P=Zt(v["!ref"]);a.sheetRows<=+P.e.r&&(P.e.r=a.sheetRows-1,P.e.r>y.e.r&&(P.e.r=y.e.r),P.e.r<P.s.r&&(P.s.r=P.e.r),P.e.c>y.e.c&&(P.e.c=y.e.c),P.e.c<P.s.c&&(P.s.c=P.e.c),v["!fullref"]=v["!ref"],v["!ref"]=Qt(P))}return T.length>0&&(v["!merges"]=T),I.length>0&&(v["!cols"]=I),M.length>0&&(v["!rows"]=M),v}(e,n,r,i,s,o,a):function(e,t,r,n,i,s,o){if(!e)return e;n||(n={"!id":{}});var a=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",u="",c=e.match(fa);c?(h=e.slice(0,c.index),u=e.slice(c.index+c[0].length)):h=u=e;var d=h.match(ya);d&&xa(d[0],0,i,r);var f=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(f>0){var p=h.slice(f,f+50).match(ma);p&&function(e,t){var r=Zt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Qt(r))}(a,p[1])}var m=h.match(ba);m&&m[1]&&function(e,t){t.Views||(t.Views=[{}]),(e.match(Ea)||[]).forEach((function(e,r){var n=be(e);t.Views[r]||(t.Views[r]={}),+n.zoomScale&&(t.Views[r].zoom=+n.zoomScale),Pe(n.rightToLeft)&&(t.Views[r].RTL=!0)}))}(m[1],i);var _=[];if(t.cellStyles){var g=h.match(_a);g&&function(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=be(t[n],!0);i.hidden&&(i.hidden=Pe(i.hidden));var s=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,ms(i.width)),_s(i);s<=o;)e[s++]=te(i)}}(_,g)}c&&Na(c[1],a,t,l,s,o);var v=u.match(ga);v&&(a["!autofilter"]=function(e){return{ref:(e.match(/ref="([^"]*)"/)||[])[1]}}(v[0]));var y=[],b=u.match(da);if(b)for(f=0;f!=b.length;++f)y[f]=Zt(b[f].slice(b[f].indexOf('"')+1));var x=u.match(pa);x&&function(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var s=be(ke(t[i]),!0);if(!s.ref)return;var o=((r||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+s.location)):(s.Target="#"+s.location,o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var a=Zt(s.ref),l=a.s.r;l<=a.e.r;++l)for(var h=a.s.c;h<=a.e.c;++h){var u=Kt({c:h,r:l});n?(e[l]||(e[l]=[]),e[l][h]||(e[l][h]={t:"z",v:void 0}),e[l][h].l=s):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=s)}}}(a,x,n);var S=u.match(va);if(S&&(a["!margins"]=function(e){var t={};return["left","right","top","bottom","header","footer"].forEach((function(r){e[r]&&(t[r]=parseFloat(e[r]))})),t}(be(S[0]))),!a["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(a["!ref"]=Qt(l)),t.sheetRows>0&&a["!ref"]){var T=Zt(a["!ref"]);t.sheetRows<=+T.e.r&&(T.e.r=t.sheetRows-1,T.e.r>l.e.r&&(T.e.r=l.e.r),T.e.r<T.s.r&&(T.s.r=T.e.r),T.e.c>l.e.c&&(T.e.c=l.e.c),T.e.c<T.s.c&&(T.s.c=T.e.c),a["!fullref"]=a["!ref"],a["!ref"]=Qt(T))}return _.length>0&&(a["!cols"]=_),y.length>0&&(a["!merges"]=y),a}(e,n,r,i,s,o,a)}function sl(e,t,r){return(".bin"===t.slice(-4)?nl:tl)(e,r)}function ol(e,t,r,n,i){return(".bin"===t.slice(-4)?za:ka)(e,r,n,i)}function al(e,t,r){return(".bin"===t.slice(-4)?Wi:Hi)(e,r)}function ll(e,t,r){return(".bin"===t.slice(-4)?eo:Qs)(e,r)}var hl=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,ul=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function cl(e,t){var r=e.split(/\s+/),n=[];if(t||(n[0]=r[0]),1===r.length)return n;var i,s,o,a=e.match(hl);if(a)for(o=0;o!=a.length;++o)-1===(s=(i=a[o].match(ul))[1].indexOf(":"))?n[i[1]]=i[2].slice(1,i[2].length-1):n["xmlns:"===i[1].slice(0,6)?"xmlns"+i[1].slice(6):i[1].slice(s+1)]=i[2].slice(1,i[2].length-1);return n}function dl(e){var t={};if(1===e.split(/\s+/).length)return t;var r,n,i,s=e.match(hl);if(s)for(i=0;i!=s.length;++i)-1===(n=(r=s[i].match(ul))[1].indexOf(":"))?t[r[1]]=r[2].slice(1,r[2].length-1):t["xmlns:"===r[1].slice(0,6)?"xmlns"+r[1].slice(6):r[1].slice(n+1)]=r[2].slice(1,r[2].length-1);return t}function fl(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Pe(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=Z(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[we(t)]=i}function pl(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=Es[n.Pattern]||n.Pattern)}e[t.ID]=t}function ml(e,t,r,n,i,s,o,a,l,h){var u="General",c=n.StyleID,d={};h=h||{};var f=[],p=0;for(void 0===c&&a&&(c=a.StyleID),void 0===c&&o&&(c=o.StyleID);void 0!==s[c]&&(s[c].nf&&(u=s[c].nf),s[c].Interior&&f.push(s[c].Interior),s[c].Parent);)c=s[c].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Pe(e);break;case"String":n.t="s",n.r=Ne(we(e)),n.v=e.indexOf("<")>-1?we(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),n.v=(Z(e)-new Date(Date.UTC(1899,11,30)))/864e5,n.v!=n.v?n.v=we(e):n.v<60&&(n.v=n.v-1),(!u||"General"==u)&&(u="yyyy-mm-dd");case"Number":void 0===n.v&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Gr[e],!1!==h.cellText&&(n.w=e);break;default:""==e&&""==t?n.t="z":(n.t="s",n.v=Ne(t||e))}if(function(e,t,r){if("z"!==e.t){if(!r||!1!==r.cellText)try{"e"===e.t?e.w=e.w||Ur[e.v]:"General"===t?"n"===e.t?(0|e.v)===e.v?e.w=R._general_int(e.v):e.w=R._general_num(e.v):e.w=R._general(e.v):e.w=(s=t||"General",o=e.v,"General"===(a=M[s]||we(s))?R._general(o):R.format(a,o))}catch(e){if(r.WTF)throw e}try{var n=M[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&"n"==e.t&&R.is_date(n)){var i=R.parse_date_code(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(e){if(r.WTF)throw e}}var s,o,a}(n,u,h),!1!==h.cellFormula)if(n.Formula){var m=we(n.Formula);61==m.charCodeAt(0)&&(m=m.slice(1)),n.f=ro(m,i),delete n.Formula,"RC"==n.ArrayRange?n.F=ro("RC:RC",i):n.ArrayRange&&(n.F=ro(n.ArrayRange,i),l.push([Zt(n.F),n.F]))}else for(p=0;p<l.length;++p)i.r>=l[p][0].s.r&&i.r<=l[p][0].e.r&&i.c>=l[p][0].s.c&&i.c<=l[p][0].e.c&&(n.F=l[p][1]);h.cellStyles&&(f.forEach((function(e){!d.patternType&&e.patternType&&(d.patternType=e.patternType)})),n.s=d),void 0!==n.StyleID&&(n.ixfe=n.StyleID)}function _l(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e.v=e.w=e.ixfe=void 0}function gl(e){if(g&&Buffer.isBuffer(e))return e.toString("utf8");if("string"==typeof e)return e;if("undefined"!=typeof Uint8Array&&e instanceof Uint8Array)return ke(E(A(e)));throw new Error("Bad input format: expected Buffer or string")}var vl=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm;function yl(e,t){var r=t||{};D(R);var n=d(gl(e));("binary"==r.type||"array"==r.type||"base64"==r.type)&&(n="undefined"!=typeof cptable?cptable.utils.decode(65001,c(n)):ke(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(-1==i.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach((function(e){i.indexOf("<"+e)>=0&&(s=!0)})),s)return zl.to_workbook(n,r);var o,a,l,h=[],u={},f=[],p=r.dense?[]:{},m="",_={},g={},v=cl('<Data ss:Type="String">'),y=0,b=0,x=0,S={s:{r:2e6,c:2e6},e:{r:0,c:0}},T={},E={},A="",w=0,C=[],O={},I={},N=0,P=[],k=[],F={},L=[],B=!1,U=[],G=[],j={},V=0,z=0,H={Sheets:[],WBProps:{date1904:!1}},X={};vl.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/gm,"");for(var W="";o=vl.exec(n);)switch(o[3]=(W=o[3]).toLowerCase()){case"data":if("data"==W){if("/"===o[1]){if((a=h.pop())[0]!==o[3])throw new Error("Bad state: "+a.join("|"))}else"/"!==o[0].charAt(o[0].length-2)&&h.push([o[3],!0]);break}if(h[h.length-1][1])break;"/"===o[1]?ml(n.slice(y,o.index),A,v,"comment"==h[h.length-1][0]?F:_,{c:b,r:x},T,L[b],g,U,r):(A="",v=cl(o[0]),y=o.index+o[0].length);break;case"cell":if("/"===o[1])if(k.length>0&&(_.c=k),(!r.sheetRows||r.sheetRows>x)&&void 0!==_.v&&(r.dense?(p[x]||(p[x]=[]),p[x][b]=_):p[Yt(b)+Wt(x)]=_),_.HRef&&(_.l={Target:_.HRef},_.HRefScreenTip&&(_.l.Tooltip=_.HRefScreenTip),delete _.HRef,delete _.HRefScreenTip),(_.MergeAcross||_.MergeDown)&&(V=b+(0|parseInt(_.MergeAcross,10)),z=x+(0|parseInt(_.MergeDown,10)),C.push({s:{c:b,r:x},e:{c:V,r:z}})),r.sheetStubs)if(_.MergeAcross||_.MergeDown){for(var q=b;q<=V;++q)for(var Y=x;Y<=z;++Y)(q>b||Y>x)&&(r.dense?(p[Y]||(p[Y]=[]),p[Y][q]={t:"z"}):p[Yt(q)+Wt(Y)]={t:"z"});b=V+1}else++b;else _.MergeAcross?b=V+1:++b;else(_=dl(o[0])).Index&&(b=+_.Index-1),b<S.s.c&&(S.s.c=b),b>S.e.c&&(S.e.c=b),"/>"===o[0].slice(-2)&&++b,k=[];break;case"row":"/"===o[1]||"/>"===o[0].slice(-2)?(x<S.s.r&&(S.s.r=x),x>S.e.r&&(S.e.r=x),"/>"===o[0].slice(-2)&&(g=cl(o[0])).Index&&(x=+g.Index-1),b=0,++x):((g=cl(o[0])).Index&&(x=+g.Index-1),j={},("0"==g.AutoFitHeight||g.Height)&&(j.hpx=parseInt(g.Height,10),j.hpt=gs(j.hpx),G[x]=j),"1"==g.Hidden&&(j.hidden=!0,G[x]=j));break;case"worksheet":if("/"===o[1]){if((a=h.pop())[0]!==o[3])throw new Error("Bad state: "+a.join("|"));f.push(m),S.s.r<=S.e.r&&S.s.c<=S.e.c&&(p["!ref"]=Qt(S),r.sheetRows&&r.sheetRows<=S.e.r&&(p["!fullref"]=p["!ref"],S.e.r=r.sheetRows-1,p["!ref"]=Qt(S))),C.length&&(p["!merges"]=C),L.length>0&&(p["!cols"]=L),G.length>0&&(p["!rows"]=G),u[m]=p}else S={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=b=0,h.push([o[3],!1]),a=cl(o[0]),m=we(a.Name),p=r.dense?[]:{},C=[],U=[],G=[],X={name:m,Hidden:0},H.Sheets.push(X);break;case"table":if("/"===o[1]){if((a=h.pop())[0]!==o[3])throw new Error("Bad state: "+a.join("|"))}else{if("/>"==o[0].slice(-2))break;cl(o[0]),h.push([o[3],!1]),L=[],B=!1}break;case"style":"/"===o[1]?pl(T,E,r):E=cl(o[0]);break;case"numberformat":E.nf=we(cl(o[0]).Format||"General"),M[E.nf]&&(E.nf=M[E.nf]);for(var J=0;392!=J&&R._table[J]!=E.nf;++J);if(392==J)for(J=57;392!=J;++J)if(null==R._table[J]){R.load(E.nf,J);break}break;case"column":if("table"!==h[h.length-1][0])break;if((l=cl(o[0])).Hidden&&(l.hidden=!0,delete l.Hidden),l.Width&&(l.wpx=parseInt(l.Width,10)),!B&&l.wpx>10){B=!0,us=6;for(var K=0;K<L.length;++K)L[K]&&_s(L[K])}B&&_s(l),L[l.Index-1||L.length]=l;for(var $=0;$<+l.Span;++$)L[L.length]=te(l);break;case"namedrange":if("/"===o[1])break;H.Names||(H.Names=[]);var Q=be(o[0]),Z={Name:Q.Name,Ref:ro(Q.RefersTo.slice(1),{r:0,c:0})};H.Sheets.length>0&&(Z.Sheet=H.Sheets.length-1),H.Names.push(Z);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":break;case"font":if("/>"===o[0].slice(-2))break;"/"===o[1]?A+=n.slice(w,o.index):w=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;E.Interior=cl(o[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if("/>"===o[0].slice(-2))break;"/"===o[1]?mn(O,W,n.slice(N,o.index)):N=o.index+o[0].length;break;case"styles":case"workbook":if("/"===o[1]){if((a=h.pop())[0]!==o[3])throw new Error("Bad state: "+a.join("|"))}else h.push([o[3],!1]);break;case"comment":if("/"===o[1]){if((a=h.pop())[0]!==o[3])throw new Error("Bad state: "+a.join("|"));_l(F),k.push(F)}else h.push([o[3],!1]),F={a:(a=cl(o[0])).Author};break;case"autofilter":if("/"===o[1]){if((a=h.pop())[0]!==o[3])throw new Error("Bad state: "+a.join("|"))}else if("/"!==o[0].charAt(o[0].length-2)){var ee=cl(o[0]);p["!autofilter"]={ref:ro(ee.Range).replace(/\$/g,"")},h.push([o[3],!0])}break;case"datavalidation":if("/"===o[1]){if((a=h.pop())[0]!==o[3])throw new Error("Bad state: "+a.join("|"))}else"/"!==o[0].charAt(o[0].length-2)&&h.push([o[3],!0]);break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===o[1]){if((a=h.pop())[0]!==o[3])throw new Error("Bad state: "+a.join("|"))}else"/"!==o[0].charAt(o[0].length-2)&&h.push([o[3],!0]);break;default:if(0==h.length&&"document"==o[3]||0==h.length&&"uof"==o[3])return Jl(n,r);var re=!0;switch(h[h.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:re=!1}break;case"componentoptions":switch(o[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:re=!1}break;case"excelworkbook":switch(o[3]){case"date1904":H.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:re=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":case"height":case"width":break;default:re=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if("/>"!==o[0].slice(-2))if("/"===o[1])switch(n.slice(N,o.index)){case"SheetHidden":X.Hidden=1;break;case"SheetVeryHidden":X.Hidden=2}else N=o.index+o[0].length;break;case"header":p["!margins"]||la(p["!margins"]={},"xlml"),p["!margins"].header=be(o[0]).Margin;break;case"footer":p["!margins"]||la(p["!margins"]={},"xlml"),p["!margins"].footer=be(o[0]).Margin;break;case"pagemargins":var ne=be(o[0]);p["!margins"]||la(p["!margins"]={},"xlml"),ne.Top&&(p["!margins"].top=ne.Top),ne.Left&&(p["!margins"].left=ne.Left),ne.Right&&(p["!margins"].right=ne.Right),ne.Bottom&&(p["!margins"].bottom=ne.Bottom);break;case"displayrighttoleft":H.Views||(H.Views=[]),H.Views[0]||(H.Views[0]={}),H.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"nosummaryrowsbelowdetail":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"nosummarycolumnsrightdetail":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;default:re=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:re=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:re=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:re=!1}break;case"querytable":switch(o[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:re=!1}break;case"datavalidation":switch(o[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:re=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:re=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:re=!1}break;case"smarttags":break;default:re=!1}if(re||o[3].match(/!\[CDATA/))break;if(!h[h.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+h.join("|");if("customdocumentproperties"===h[h.length-1][0]){if("/>"===o[0].slice(-2))break;"/"===o[1]?fl(I,W,P,n.slice(N,o.index)):(P=o,N=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+h.join("|")}var ie={};return!r.bookSheets&&!r.bookProps&&(ie.Sheets=u),ie.SheetNames=f,ie.Workbook=H,ie.SSF=R.get_table(),ie.Props=O,ie.Custprops=I,ie}function bl(e,t){switch(dh(t=t||{}),t.type||"base64"){case"base64":return yl(_.decode(e),t);case"binary":case"buffer":case"file":return yl(e,t);case"array":return yl(E(e),t)}}function xl(e){return Qe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+io(e.Ref,{r:0,c:0})})}function Sl(e,t,r,n,i,s,o){if(!e||null==e.v&&null==e.f)return"";var a={};if(e.f&&(a["ss:Formula"]="="+Re(io(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var l=Jt(e.F.slice(t.length+1));a["ss:ArrayRange"]="RC:R"+(l.r==o.r?"":"["+(l.r-o.r)+"]")+"C"+(l.c==o.c?"":"["+(l.c-o.c)+"]")}if(e.l&&e.l.Target&&(a["ss:HRef"]=Re(e.l.Target),e.l.Tooltip&&(a["x:HRefScreenTip"]=Re(e.l.Tooltip))),r["!merges"])for(var h=r["!merges"],u=0;u!=h.length;++u)h[u].s.c!=o.c||h[u].s.r!=o.r||(h[u].e.c>h[u].s.c&&(a["ss:MergeAcross"]=h[u].e.c-h[u].s.c),h[u].e.r>h[u].s.r&&(a["ss:MergeDown"]=h[u].e.r-h[u].s.r));var c="",d="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":c="Number",d=String(e.v);break;case"b":c="Boolean",d=e.v?"1":"0";break;case"e":c="Error",d=Ur[e.v];break;case"d":c="DateTime",d=new Date(e.v).toISOString(),null==e.z&&(e.z=e.z||R._table[14]);break;case"s":c="String",d=((e.v||"")+"").replace(Ce,(function(e){return Ae[e]})).replace(Ie,(function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"}))}var f=ha(n.cellXfs,e,n);a["ss:StyleID"]="s"+(21+f),a["ss:Index"]=o.c+1;var p=null!=e.v?d:"",m="z"==e.t?"":'<Data ss:Type="'+c+'">'+p+"</Data>";return(e.c||[]).length>0&&(m+=e.c.map((function(e){var t=Qe("ss:Data",(e.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return Qe("Comment",t,{"ss:Author":e.a})})).join("")),Qe("Cell",m,a)}function Tl(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=vs(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function El(e,t,r){var n=[],i=r.SheetNames[e],s=r.Sheets[i],o=s?function(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],o=0;o<i.length;++o){var a=i[o];a.Sheet==r&&(a.Name.match(/^_xlfn\./)||s.push(xl(a)))}return s.join("")}(s,0,e,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=s?function(e,t,r,n){if(!e["!ref"])return"";var i=Zt(e["!ref"]),s=e["!merges"]||[],o=0,a=[];e["!cols"]&&e["!cols"].forEach((function(e,t){_s(e);var r=!!e.width,n=aa(t,e),i={"ss:Index":t+1};r&&(i["ss:Width"]=cs(n.width)),e.hidden&&(i["ss:Hidden"]="1"),a.push(Qe("Column",null,i))}));for(var l=Array.isArray(e),h=i.s.r;h<=i.e.r;++h){for(var u=[Tl(h,(e["!rows"]||[])[h])],c=i.s.c;c<=i.e.c;++c){var d=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>c||s[o].s.r>h||s[o].e.c<c||s[o].e.r<h)){(s[o].s.c!=c||s[o].s.r!=h)&&(d=!0);break}if(!d){var f={r:h,c},p=Kt(f),m=l?(e[h]||[])[c]:e[p];u.push(Sl(m,p,e,t,0,0,f))}}u.push("</Row>"),u.length>2&&a.push(u.join(""))}return a.join("")}(s,t):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(function(e,t,r,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(Qe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(Qe("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(Qe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(Qe("Visible",1==n.Workbook.Sheets[r].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&(!n.Workbook.Sheets[s]||n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(Ke("ProtectContents","True")),e["!protect"].objects&&i.push(Ke("ProtectObjects","True")),e["!protect"].scenarios&&i.push(Ke("ProtectScenarios","True")),null==e["!protect"].selectLockedCells||e["!protect"].selectLockedCells?null!=e["!protect"].selectUnlockedCells&&!e["!protect"].selectUnlockedCells&&i.push(Ke("EnableSelection","UnlockedCells")):i.push(Ke("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach((function(t){e["!protect"][t[0]]&&i.push("<"+t[1]+"/>")}))),0==i.length?"":Qe("WorksheetOptions",i.join(""),{xmlns:it})}(s,0,e,r)),n.join("")}function Al(e,t){t||(t={}),e.SSF||(e.SSF=R.get_table()),e.SSF&&(D(R),R.load_table(e.SSF),t.revssf=V(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],ha(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(function(e,t){var r=[];return e.Props&&r.push(function(e,t){var r=[];return U(fn).map((function(e){for(var t=0;t<rn.length;++t)if(rn[t][1]==e)return rn[t];for(t=0;t<ln.length;++t)if(ln[t][1]==e)return ln[t];throw e})).forEach((function(n){if(null!=e[n[1]]){var i=t&&t.Props&&null!=t.Props[n[1]]?t.Props[n[1]]:e[n[1]];"date"===n[2]&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof i?i=String(i):!0===i||!1===i?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(Ke(fn[n[1]]||n[1],i))}})),Qe("DocumentProperties",r.join(""),{xmlns:nt})}(e.Props,t)),e.Custprops&&r.push(function(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&U(e).forEach((function(t){if(Object.prototype.hasOwnProperty.call(e,t)){for(var n=0;n<rn.length;++n)if(t==rn[n][1])return;for(n=0;n<ln.length;++n)if(t==ln[n][1])return;for(n=0;n<r.length;++n)if(t==r[n])return;var s=e[t],o="string";"number"==typeof s?(o="float",s=String(s)):!0===s||!1===s?(o="boolean",s=s?"1":"0"):s=String(s),i.push(Qe(De(t),s,{"dt:dt":o}))}})),t&&U(t).forEach((function(r){if(Object.prototype.hasOwnProperty.call(t,r)&&(!e||!Object.prototype.hasOwnProperty.call(e,r))){var n=t[r],s="string";"number"==typeof n?(s="float",n=String(n)):!0===n||!1===n?(s="boolean",n=n?"1":"0"):n instanceof Date?(s="dateTime.tz",n=n.toISOString()):n=String(n),i.push(Qe(De(r),n,{"dt:dt":s}))}})),"<"+n+' xmlns="'+nt+'">'+i.join("")+"</"+n+">"}(e.Props,e.Custprops)),r.join("")}(e,t)),r.push(""),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Qe("Worksheet",El(n,t,e),{"ss:Name":Re(e.SheetNames[n])}));return r[2]=function(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach((function(e,t){var n=[];n.push(Qe("NumberFormat",null,{"ss:Format":Re(R._table[e.numFmtId])}));var i={"ss:ID":"s"+(21+t)};r.push(Qe("Style",n.join(""),i))})),Qe("Styles",r.join(""))}(0,t),r[3]=function(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];null==i.Sheet&&(i.Name.match(/^_xlfn\./)||r.push(xl(i)))}return Qe("Names",r.join(""))}(e),me+Qe("Workbook",r.join(""),{xmlns:st,"xmlns:o":nt,"xmlns:x":it,"xmlns:ss":st,"xmlns:dt":"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882","xmlns:html":"http://www.w3.org/TR/REC-html40"})}function wl(e,t,r,n){var i=r,s=[],o=t.slice(t.l,t.l+i);if(n&&n.enc&&n.enc.insitu&&o.length>0)switch(e.n){case"BOF":case"FilePass":case"FileLock":case"InterfaceHdr":case"RRDInfo":case"RRDHead":case"UsrExcl":case"EOF":case"BoundSheet8":break;default:n.enc.insitu(o)}s.push(o),t.l+=i;for(var a=Pl[wt(t,t.l)],l=0;null!=a&&"Continue"===a.n.slice(0,8);)i=wt(t,t.l+2),l=t.l+4,"ContinueFrt"==a.n?l+=4:"ContinueFrt"==a.n.slice(0,11)&&(l+=12),o=t.slice(l,t.l+4+i),s.push(o),t.l+=4+i,a=Pl[wt(t,t.l)];var h=w(s);kt(h,0);var u=0;h.lens=[];for(var c=0;c<s.length;++c)h.lens.push(u),u+=s[c].length;if(h.length<r)throw"XLS Record "+(e&&e.n||"??")+" Truncated: "+h.length+" < "+r;return e.f(h,h.length,n)}function Cl(e,t,r){if("z"!==e.t&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=R._table[n])}catch(e){if(t.WTF)throw e}if(!t||!1!==t.cellText)try{"e"===e.t?e.w=e.w||Ur[e.v]:0===n||"General"==n?"n"===e.t?(0|e.v)===e.v?e.w=R._general_int(e.v):e.w=R._general_num(e.v):e.w=R._general(e.v):e.w=R.format(n,e.v,{date1904:!!r})}catch(e){if(t.WTF)throw e}if(t.cellDates&&n&&"n"==e.t&&R.is_date(R._table[n]||String(n))){var i=R.parse_date_code(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Ol(e,t,r){return{v:e,ixfe:t,t:r}}var Rl="e0859ff2f94f6810ab9108002b27b3d9",Dl="02d5cdd59c2e1b10939708002b2cf9ae";function Il(e,t){var r,n,i,s;if(t||(t={}),dh(t),u(),t.codepage&&l(t.codepage),e.FullPaths){if(F.find(e,"/encryption"))throw new Error("File is password-protected");r=F.find(e,"!CompObj"),n=F.find(e,"/Workbook")||F.find(e,"/Book")}else{switch(t.type){case"base64":e=S(_.decode(e));break;case"binary":e=S(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e))}kt(e,0),n={content:e}}if(r&&function(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=function(e){return wr(e,1)}(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(0==n||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||1907505652!==(n=r.read_shift(4))||(t.UnicodeClipboardFormat=function(e){return wr(e,2)}(r),0==(n=r.read_shift(4))||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}(r),t.bookProps&&!t.bookSheets)i={};else{var o=g?"buffer":"array";if(n&&n.content)i=function(e,t){var r,n,i,s,o,a,l,u={opts:{}},c={},d=t.dense?[]:{},f={},p={},m=null,_=[],g="",v={},y="",b={},x=[],S=!0,T=[],E=[],A={Sheets:[],WBProps:{date1904:!1},Views:[{}]},w={},C=function(e){return e<8?Br[e]:e<64&&E[e-8]||Br[e]},O=function(e,t,n){if(!(j>1)&&(n.sheetRows&&e.r>=n.sheetRows&&(S=!1),S)){if(n.cellStyles&&t.XF&&t.XF.data&&function(e,t,r){var n,i=t.XF.data;i&&i.patternType&&r&&r.cellStyles&&(t.s={},t.s.patternType=i.patternType,(n=ls(C(i.icvFore)))&&(t.s.fgColor={rgb:n}),(n=ls(C(i.icvBack)))&&(t.s.bgColor={rgb:n}))}(0,t,n),delete t.ixfe,delete t.XF,r=e,y=Kt(e),(!p||!p.s||!p.e)&&(p={s:{r:0,c:0},e:{r:0,c:0}}),e.r<p.s.r&&(p.s.r=e.r),e.c<p.s.c&&(p.s.c=e.c),e.r+1>p.e.r&&(p.e.r=e.r+1),e.c+1>p.e.c&&(p.e.c=e.c+1),n.cellFormula&&t.f)for(var i=0;i<x.length;++i)if(!(x[i][0].s.c>e.c||x[i][0].s.r>e.r||x[i][0].e.c<e.c||x[i][0].e.r<e.r)){t.F=Qt(x[i][0]),(x[i][0].s.c!=e.c||x[i][0].s.r!=e.r)&&delete t.f,t.f&&(t.f=""+Vo(x[i][1],0,e,L,D));break}n.dense?(d[e.r]||(d[e.r]=[]),d[e.r][e.c]=t):d[y]=t}},D={enc:!1,sbcch:0,snames:[],sharedf:b,arrayf:x,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(D.password=t.password);var I,M=[],N=[],P=[],k=[],F=!1,L=[];L.SheetNames=D.snames,L.sharedf=D.sharedf,L.arrayf=D.arrayf,L.names=[],L.XTI=[];var B,G="",j=0,V=0,z=[],H=[];D.codepage=1200,h(1200);for(var X=!1;e.l<e.length-1;){var W=e.l,q=e.read_shift(2);if(0===q&&"EOF"===G)break;var Y=e.l===e.length?0:e.read_shift(2),J=Pl[q];if(J&&J.f){if(t.bookSheets&&"BoundSheet8"===G&&"BoundSheet8"!==J.n)break;if(G=J.n,2===J.r||12==J.r){var K=e.read_shift(2);if(Y-=2,!D.enc&&K!==q&&((255&K)<<8|K>>8)!==q)throw new Error("rt mismatch: "+K+"!="+q);12==J.r&&(e.l+=10,Y-=10)}var $={};$="EOF"===J.n?J.f(e,Y,D):wl(J,e,Y,D);var Q=J.n;if(0==j&&"BOF"!=Q)continue;switch(Q){case"Date1904":u.opts.Date1904=A.WBProps.date1904=$;break;case"WriteProtect":u.opts.WriteProtect=!0;break;case"FilePass":if(D.enc||(e.l=0),D.enc=$,!t.password)throw new Error("File is password-protected");if(null==$.valid)throw new Error("Encryption scheme unsupported");if(!$.valid)throw new Error("Password is incorrect");break;case"WriteAccess":D.lastuser=$;break;case"FileSharing":case"Template":case"BookBool":case"UsesELFs":case"MTRSettings":case"Uncalced":case"ExtSST":case"BookExt":case"RichTextStream":case"BkHim":case"Index":case"Prot4Rev":case"Prot4RevPass":break;case"CodePage":var Z=Number($);switch(Z){case 21010:Z=1200;break;case 32768:Z=1e4;break;case 32769:Z=1252}h(D.codepage=Z),X=!0;break;case"RRTabId":D.rrtabid=$;break;case"WinProtect":D.winlocked=$;break;case"RefreshAll":case"CalcCount":case"CalcDelta":case"CalcIter":case"CalcMode":case"CalcPrecision":case"CalcSaveRecalc":u.opts[Q]=$;break;case"CalcRefMode":D.CalcRefMode=$;break;case"ForceFullCalculation":u.opts.FullCalc=$;break;case"WsBool":$.fDialog&&(d["!type"]="dialog");break;case"XF":T.push($);break;case"SupBook":L.push([$]),L[L.length-1].XTI=[];break;case"ExternName":L[L.length-1].push($);break;case"Lbl":B={Name:$.Name,Ref:Vo($.rgce,0,null,L,D)},$.itab>0&&(B.Sheet=$.itab-1),L.names.push(B),L[0]||(L[0]=[],L[0].XTI=[]),L[L.length-1].push($),"_xlnm._FilterDatabase"==$.Name&&$.itab>0&&$.rgce&&$.rgce[0]&&$.rgce[0][0]&&"PtgArea3d"==$.rgce[0][0][0]&&(H[$.itab-1]={ref:Qt($.rgce[0][0][1][2])});break;case"ExternCount":D.ExternCount=$;break;case"ExternSheet":0==L.length&&(L[0]=[],L[0].XTI=[]),L[L.length-1].XTI=L[L.length-1].XTI.concat($),L.XTI=L.XTI.concat($);break;case"NameCmt":if(D.biff<8)break;null!=B&&(B.Comment=$[1]);break;case"Protect":d["!protect"]=$;break;case"Password":0!==$&&D.WTF&&console.error("Password verifier: "+$);break;case"BoundSheet8":f[$.pos]=$,D.snames.push($.name);break;case"EOF":if(--j)break;if(p.e){if(p.e.r>0&&p.e.c>0){if(p.e.r--,p.e.c--,d["!ref"]=Qt(p),t.sheetRows&&t.sheetRows<=p.e.r){var ee=p.e.r;p.e.r=t.sheetRows-1,d["!fullref"]=d["!ref"],d["!ref"]=Qt(p),p.e.r=ee}p.e.r++,p.e.c++}M.length>0&&(d["!merges"]=M),N.length>0&&(d["!objects"]=N),P.length>0&&(d["!cols"]=P),k.length>0&&(d["!rows"]=k),A.Sheets.push(w)}""===g?v=d:c[g]=d,d=t.dense?[]:{};break;case"BOF":if(8===D.biff&&(D.biff={9:2,521:3,1033:4}[q]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[$.BIFFVer]||8),8==D.biff&&0==$.BIFFVer&&16==$.dt&&(D.biff=2),j++)break;if(S=!0,d=t.dense?[]:{},D.biff<8&&!X&&(X=!0,h(D.codepage=t.codepage||1252)),D.biff<5){""===g&&(g="Sheet1"),p={s:{r:0,c:0},e:{r:0,c:0}};var te={pos:e.l-Y,name:g};f[te.pos]=te,D.snames.push(g)}else g=(f[W]||{name:""}).name;32==$.dt&&(d["!type"]="chart"),64==$.dt&&(d["!type"]="macro"),M=[],N=[],D.arrayf=x=[],P=[],k=[],F=!1,w={Hidden:(f[W]||{hs:0}).hs,name:g};break;case"Number":case"BIFF2NUM":case"BIFF2INT":"chart"==d["!type"]&&(t.dense?(d[$.r]||[])[$.c]:d[Kt({c:$.c,r:$.r})])&&++$.c,a={ixfe:$.ixfe,XF:T[$.ixfe]||{},v:$.val,t:"n"},V>0&&(a.z=z[a.ixfe>>8&31]),Cl(a,t,u.opts.Date1904),O({c:$.c,r:$.r},a,t);break;case"BoolErr":a={ixfe:$.ixfe,XF:T[$.ixfe],v:$.val,t:$.t},V>0&&(a.z=z[a.ixfe>>8&31]),Cl(a,t,u.opts.Date1904),O({c:$.c,r:$.r},a,t);break;case"RK":a={ixfe:$.ixfe,XF:T[$.ixfe],v:$.rknum,t:"n"},V>0&&(a.z=z[a.ixfe>>8&31]),Cl(a,t,u.opts.Date1904),O({c:$.c,r:$.r},a,t);break;case"MulRk":for(var re=$.c;re<=$.C;++re){var ne=$.rkrec[re-$.c][0];a={ixfe:ne,XF:T[ne],v:$.rkrec[re-$.c][1],t:"n"},V>0&&(a.z=z[a.ixfe>>8&31]),Cl(a,t,u.opts.Date1904),O({c:re,r:$.r},a,t)}break;case"Formula":if("String"==$.val){m=$;break}if((a=Ol($.val,$.cell.ixfe,$.tt)).XF=T[a.ixfe],t.cellFormula){var ie=$.formula;if(ie&&ie[0]&&ie[0][0]&&"PtgExp"==ie[0][0][0]){var se=ie[0][0][1][0],oe=ie[0][0][1][1],ae=Kt({r:se,c:oe});b[ae]?a.f=""+Vo($.formula,0,$.cell,L,D):a.F=((t.dense?(d[se]||[])[oe]:d[ae])||{}).F}else a.f=""+Vo($.formula,0,$.cell,L,D)}V>0&&(a.z=z[a.ixfe>>8&31]),Cl(a,t,u.opts.Date1904),O($.cell,a,t),m=$;break;case"String":if(!m)throw new Error("String record expects Formula");m.val=$,(a=Ol($,m.cell.ixfe,"s")).XF=T[a.ixfe],t.cellFormula&&(a.f=""+Vo(m.formula,0,m.cell,L,D)),V>0&&(a.z=z[a.ixfe>>8&31]),Cl(a,t,u.opts.Date1904),O(m.cell,a,t),m=null;break;case"Array":x.push($);var le=Kt($[0].s);if(n=t.dense?(d[$[0].s.r]||[])[$[0].s.c]:d[le],t.cellFormula&&n){if(!m||!le||!n)break;n.f=""+Vo($[1],0,$[0],L,D),n.F=Qt($[0])}break;case"ShrFmla":if(!S||!t.cellFormula)break;if(y){if(!m)break;b[Kt(m.cell)]=$[0],((n=t.dense?(d[m.cell.r]||[])[m.cell.c]:d[Kt(m.cell)])||{}).f=""+Vo($[0],0,r,L,D)}break;case"LabelSst":a=Ol(_[$.isst].t,$.ixfe,"s"),_[$.isst].h&&(a.h=_[$.isst].h),a.XF=T[a.ixfe],V>0&&(a.z=z[a.ixfe>>8&31]),Cl(a,t,u.opts.Date1904),O({c:$.c,r:$.r},a,t);break;case"Blank":t.sheetStubs&&(a={ixfe:$.ixfe,XF:T[$.ixfe],t:"z"},V>0&&(a.z=z[a.ixfe>>8&31]),Cl(a,t,u.opts.Date1904),O({c:$.c,r:$.r},a,t));break;case"MulBlank":if(t.sheetStubs)for(var he=$.c;he<=$.C;++he){var ue=$.ixfe[he-$.c];a={ixfe:ue,XF:T[ue],t:"z"},V>0&&(a.z=z[a.ixfe>>8&31]),Cl(a,t,u.opts.Date1904),O({c:he,r:$.r},a,t)}break;case"RString":case"Label":case"BIFF2STR":(a=Ol($.val,$.ixfe,"s")).XF=T[a.ixfe],V>0&&(a.z=z[a.ixfe>>8&31]),Cl(a,t,u.opts.Date1904),O({c:$.c,r:$.r},a,t);break;case"Dimensions":1===j&&(p=$);break;case"SST":_=$;break;case"Format":if(4==D.biff){z[V++]=$[1];for(var ce=0;ce<V+163&&R._table[ce]!=$[1];++ce);ce>=163&&R.load($[1],V+163)}else R.load($[1],$[0]);break;case"BIFF2FORMAT":z[V++]=$;for(var de=0;de<V+163&&R._table[de]!=$;++de);de>=163&&R.load($,V+163);break;case"MergeCells":M=M.concat($);break;case"Obj":N[$.cmo[0]]=D.lastobj=$;break;case"TxO":D.lastobj.TxO=$;break;case"ImData":D.lastobj.ImData=$;break;case"HLink":for(o=$[0].s.r;o<=$[0].e.r;++o)for(s=$[0].s.c;s<=$[0].e.c;++s)(n=t.dense?(d[o]||[])[s]:d[Kt({c:s,r:o})])&&(n.l=$[1]);break;case"HLinkTooltip":for(o=$[0].s.r;o<=$[0].e.r;++o)for(s=$[0].s.c;s<=$[0].e.c;++s)(n=t.dense?(d[o]||[])[s]:d[Kt({c:s,r:o})])&&n.l&&(n.l.Tooltip=$[1]);break;case"Note":if(D.biff<=5&&D.biff>=2)break;n=t.dense?(d[$[0].r]||[])[$[0].c]:d[Kt($[0])];var fe=N[$[2]];n||(t.dense?(d[$[0].r]||(d[$[0].r]=[]),n=d[$[0].r][$[0].c]={t:"z"}):n=d[Kt($[0])]={t:"z"},p.e.r=Math.max(p.e.r,$[0].r),p.s.r=Math.min(p.s.r,$[0].r),p.e.c=Math.max(p.e.c,$[0].c),p.s.c=Math.min(p.s.c,$[0].c)),n.c||(n.c=[]),i={a:$[1],t:fe.TxO.t},n.c.push(i);break;default:switch(J.n){case"ClrtClient":case"Header":case"Footer":case"HCenter":case"VCenter":case"Pls":case"GCW":case"LHRecord":case"DBCell":case"EntExU2":case"SxView":case"Sxvd":case"SXVI":case"SXVDEx":case"SxIvd":case"SXString":case"Sync":case"Addin":case"SXDI":case"SXLI":case"SXEx":case"QsiSXTag":case"Selection":case"Feat":case"FeatHdr":case"FeatHdr11":case"Feature11":case"Feature12":case"List12":case"RecalcId":case"DxGCol":case"Fbi":case"Fbi2":case"GelFrame":case"Font":case"XFCRC":case"Style":case"StyleExt":case"ScenarioProtect":case"ObjProtect":case"CondFmt12":case"Table":case"TableStyles":case"TableStyle":case"TableStyleElement":case"SXStreamID":case"SXVS":case"DConRef":case"SXAddl":case"DConBin":case"DConName":case"SXPI":case"SxFormat":case"SxSelect":case"SxRule":case"SxFilt":case"SxItm":case"SxDXF":case"ScenMan":case"DCon":case"CellWatch":case"PrintRowCol":case"PrintGrid":case"PrintSize":case"XCT":case"CRN":case"Scl":case"SheetExt":case"SheetExtOptional":case"ObNoMacros":case"ObProj":case"GUIDTypeLib":case"WOpt":case"PhoneticInfo":case"OleObjectSize":case"DXF":case"DXFN":case"DXFN12":case"DXFN12List":case"DXFN12NoCB":case"Dv":case"DVal":case"BRAI":case"Series":case"SeriesText":case"DConn":case"DbOrParamQry":case"DBQueryExt":case"OleDbConn":case"ExtString":case"IFmtRecord":case"CondFmt":case"CF":case"CF12":case"CFEx":case"Excel9File":case"Units":case"InterfaceHdr":case"Mms":case"InterfaceEnd":case"DSF":case"BuiltInFnGroupCount":case"Window1":case"HideObj":case"GridSet":case"Guts":case"UserBView":case"UserSViewBegin":case"UserSViewEnd":case"Pane":case"DefColWidth":break;case"XFExt":T[$.ixfe],$.ext.forEach((function(e){e[0]}));break;case"DefaultRowHeight":$[1];break;case"ColInfo":if(!D.cellStyles)break;for(;$.e>=$.s;)P[$.e--]={width:$.w/256},F||(F=!0,ms($.w/256)),_s(P[$.e+1]);break;case"Row":var pe={};null!=$.level&&(k[$.r]=pe,pe.level=$.level),$.hidden&&(k[$.r]=pe,pe.hidden=!0),$.hpt&&(k[$.r]=pe,pe.hpt=$.hpt,pe.hpx=vs($.hpt));break;case"LeftMargin":case"RightMargin":case"TopMargin":case"BottomMargin":d["!margins"]||la(d["!margins"]={}),d["!margins"][Q.slice(0,-6).toLowerCase()]=$;break;case"Setup":d["!margins"]||la(d["!margins"]={}),d["!margins"].header=$.header,d["!margins"].footer=$.footer;break;case"Window2":$.RTL&&(A.Views[0].RTL=!0);break;case"Country":l=$;break;case"Palette":E=$;break;case"Theme":I=$;break;case"CodeName":g?w.CodeName=$||w.name:A.WBProps.CodeName=$||"ThisWorkbook";break;default:switch(J.n){case"Dat":case"Begin":case"End":case"StartBlock":case"EndBlock":case"Frame":case"Area":case"Axis":case"AxisLine":case"Tick":case"AxesUsed":case"CrtLayout12":case"CrtLayout12A":case"CrtLink":case"CrtLine":case"CrtMlFrt":case"CrtMlFrtContinue":case"LineFormat":case"AreaFormat":case"Chart":case"Chart3d":case"Chart3DBarShape":case"ChartFormat":case"ChartFrtInfo":case"PlotArea":case"PlotGrowth":case"SeriesList":case"SerParent":case"SerAuxTrend":case"DataFormat":case"SerToCrt":case"FontX":case"CatSerRange":case"AxcExt":case"SerFmt":case"ShtProps":case"DefaultText":case"Text":case"CatLab":case"DataLabExtContents":case"Legend":case"LegendException":case"Pie":case"Scatter":case"PieFormat":case"MarkerFormat":case"StartObject":case"EndObject":case"AlRuns":case"ObjectLink":case"SIIndex":case"AttachedLabel":case"YMult":case"Line":case"Bar":case"Surf":case"AxisParent":case"Pos":case"ValueRange":case"SXViewEx9":case"SXViewLink":case"PivotChartBits":case"SBaseRef":case"TextPropsStream":case"LnExt":case"MkrExt":case"CrtCoopt":case"Qsi":case"Qsif":case"Qsir":case"QsiSXTag":case"TxtQry":case"FilterMode":case"AutoFilter":case"AutoFilterInfo":case"AutoFilter12":case"DropDownObjIds":case"Sort":case"SortData":case"ShapePropsStream":case"MsoDrawing":case"MsoDrawingGroup":case"MsoDrawingSelection":case"WebPub":case"AutoWebPub":case"HeaderFooter":case"HFPicture":case"PLV":case"HorizontalPageBreaks":case"VerticalPageBreaks":case"Backup":case"CompressPictures":case"Compat12":case"Continue":case"ContinueFrt12":case"FrtFontList":case"FrtWrapper":break;default:switch(J.n){case"TabIdConf":case"Radar":case"RadarArea":case"DropBar":case"Intl":case"CoordList":case"SerAuxErrBar":case"BIFF2FONTCLR":case"BIFF2FMTCNT":case"BIFF2FONTXTRA":case"BIFF2XF":case"BIFF3XF":case"BIFF4XF":case"BIFF4FMTCNT":case"BIFF2ROW":case"BIFF2WINDOW2":case"SCENARIO":case"DConBin":case"PicF":case"DataLabExt":case"Lel":case"BopPop":case"BopPopCustom":case"RealTimeData":case"Name":case"LHNGraph":case"FnGroupName":case"AddMenu":case"LPr":case"ListObj":case"ListField":case"RRSort":case"BigName":case"ToolbarHdr":case"ToolbarEnd":case"DDEObjName":case"FRTArchId$":break;default:if(t.WTF)throw"Unrecognized Record "+J.n}}}}}else e.l+=Y}return u.SheetNames=U(f).sort((function(e,t){return Number(e)-Number(t)})).map((function(e){return f[e].name})),t.bookSheets||(u.Sheets=c),u.Sheets&&H.forEach((function(e,t){u.Sheets[u.SheetNames[t]]["!autofilter"]=e})),u.Preamble=v,u.Strings=_,u.SSF=R.get_table(),D.enc&&(u.Encryption=D.enc),I&&(u.Themes=I),u.Metadata={},void 0!==l&&(u.Metadata.Country=l),L.names.length>0&&(A.Names=L.names),u.Workbook=A,u}(n.content,t);else if((s=F.find(e,"PerfectOffice_MAIN"))&&s.content)i=Ni.to_workbook(s.content,(t.type=o,t));else{if(!(s=F.find(e,"NativeContent_MAIN"))||!s.content)throw new Error("Cannot find Workbook stream");i=Ni.to_workbook(s.content,(t.type=o,t))}t.bookVBA&&e.FullPaths&&F.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=function(e){var t=F.utils.cfb_new({root:"R"});return e.FullPaths.forEach((function(r,n){if("/"!==r.slice(-1)&&r.match(/_VBA_PROJECT_CUR/)){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");F.utils.cfb_add(t,i,e.FileIndex[n].content)}})),F.write(t)}(e))}var a={};return e.FullPaths&&function(e,t,r){var n=F.find(e,"!DocumentSummaryInformation");if(n&&n.size>0)try{var i=Dn(n,Rr,Dl);for(var s in i)t[s]=i[s]}catch(e){if(r.WTF)throw e}var o=F.find(e,"!SummaryInformation");if(o&&o.size>0)try{var a=Dn(o,Dr,Rl);for(var l in a)null==t[l]&&(t[l]=a[l])}catch(e){if(r.WTF)throw e}t.HeadingPairs&&t.TitlesOfParts&&(hn(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}(e,a,t),i.Props=i.Custprops=a,t.bookFiles&&(i.cfb=e),i}var Ml={0:{n:"BrtRowHdr",f:function(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,7&s&&(r.level=7&s),16&s&&(r.hidden=!0),32&s&&(r.hpt=i/20),r}},1:{n:"BrtCellBlank",f:function(e){return[ur(e)]}},2:{n:"BrtCellRk",f:function(e){return[ur(e),yr(e),"n"]}},3:{n:"BrtCellError",f:function(e){return[ur(e),e.read_shift(1),"e"]}},4:{n:"BrtCellBool",f:function(e){return[ur(e),e.read_shift(1),"b"]}},5:{n:"BrtCellReal",f:function(e){return[ur(e),Tr(e),"n"]}},6:{n:"BrtCellSt",f:function(e){return[ur(e),sr(e),"str"]}},7:{n:"BrtCellIsst",f:function(e){return[ur(e),e.read_shift(4),"s"]}},8:{n:"BrtFmlaString",f:function(e,t,r){var n=e.l+t,i=ur(e);i.r=r["!row"];var s=[i,sr(e),"str"];if(r.cellFormula){e.l+=2;var o=Yo(e,n-e.l,r);s[3]=Vo(o,0,i,r.supbooks,r)}else e.l=n;return s}},9:{n:"BrtFmlaNum",f:function(e,t,r){var n=e.l+t,i=ur(e);i.r=r["!row"];var s=[i,Tr(e),"n"];if(r.cellFormula){e.l+=2;var o=Yo(e,n-e.l,r);s[3]=Vo(o,0,i,r.supbooks,r)}else e.l=n;return s}},10:{n:"BrtFmlaBool",f:function(e,t,r){var n=e.l+t,i=ur(e);i.r=r["!row"];var s=[i,e.read_shift(1),"b"];if(r.cellFormula){e.l+=2;var o=Yo(e,n-e.l,r);s[3]=Vo(o,0,i,r.supbooks,r)}else e.l=n;return s}},11:{n:"BrtFmlaError",f:function(e,t,r){var n=e.l+t,i=ur(e);i.r=r["!row"];var s=[i,e.read_shift(1),"e"];if(r.cellFormula){e.l+=2;var o=Yo(e,n-e.l,r);s[3]=Vo(o,0,i,r.supbooks,r)}else e.l=n;return s}},16:{n:"BrtFRTArchID$",f:function(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}},19:{n:"BrtSSTItem",f:lr},20:{n:"BrtPCDIMissing"},21:{n:"BrtPCDINumber"},22:{n:"BrtPCDIBoolean"},23:{n:"BrtPCDIError"},24:{n:"BrtPCDIString"},25:{n:"BrtPCDIDatetime"},26:{n:"BrtPCDIIndex"},27:{n:"BrtPCDIAMissing"},28:{n:"BrtPCDIANumber"},29:{n:"BrtPCDIABoolean"},30:{n:"BrtPCDIAError"},31:{n:"BrtPCDIAString"},32:{n:"BrtPCDIADatetime"},33:{n:"BrtPCRRecord"},34:{n:"BrtPCRRecordDt"},35:{n:"BrtFRTBegin"},36:{n:"BrtFRTEnd"},37:{n:"BrtACBegin"},38:{n:"BrtACEnd"},39:{n:"BrtName",f:function(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=_r(e),o=Jo(e,0,r),a=pr(e);e.l=n;var l={Name:s,Ptg:o};return i<268435455&&(l.Sheet=i),a&&(l.Comment=a),l}},40:{n:"BrtIndexRowBlock"},42:{n:"BrtIndexBlock"},43:{n:"BrtFont",f:function(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=function(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1),700===e.read_shift(2)&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript"}var s=e.read_shift(1);0!=s&&(n.underline=s);var o=e.read_shift(1);o>0&&(n.family=o);var a=e.read_shift(1);switch(a>0&&(n.charset=a),e.l++,n.color=function(e){var t={},r=e.read_shift(1)>>>1,n=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),a=e.read_shift(1);switch(e.l++,r){case 0:t.auto=1;break;case 1:t.index=n;var l=Br[n];l&&(t.rgb=ls(l));break;case 2:t.rgb=ls([s,o,a]);break;case 3:t.theme=n}return 0!=i&&(t.tint=i>0?i/32767:i/32768),t}(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor"}return n.name=sr(e),n}},44:{n:"BrtFmt",f:function(e,t){return[e.read_shift(2),sr(e)]}},45:{n:"BrtFill",f:Ms},46:{n:"BrtBorder",f:Fs},47:{n:"BrtXF",f:function(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}},48:{n:"BrtStyle"},49:{n:"BrtCellMeta"},50:{n:"BrtValueMeta"},51:{n:"BrtMdb"},52:{n:"BrtBeginFmd"},53:{n:"BrtEndFmd"},54:{n:"BrtBeginMdx"},55:{n:"BrtEndMdx"},56:{n:"BrtBeginMdxTuple"},57:{n:"BrtEndMdxTuple"},58:{n:"BrtMdxMbrIstr"},59:{n:"BrtStr"},60:{n:"BrtColInfo",f:Ei},62:{n:"BrtCellRString"},63:{n:"BrtCalcChainItem$",f:function(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Kt(r);var n=e.read_shift(1);return 2&n&&(t.l="1"),8&n&&(t.a="1"),t}},64:{n:"BrtDVal",f:function(){}},65:{n:"BrtSxvcellNum"},66:{n:"BrtSxvcellStr"},67:{n:"BrtSxvcellBool"},68:{n:"BrtSxvcellErr"},69:{n:"BrtSxvcellDate"},70:{n:"BrtSxvcellNil"},128:{n:"BrtFileVersion"},129:{n:"BrtBeginSheet"},130:{n:"BrtEndSheet"},131:{n:"BrtBeginBook",f:Ft,p:0},132:{n:"BrtEndBook"},133:{n:"BrtBeginWsViews"},134:{n:"BrtEndWsViews"},135:{n:"BrtBeginBookViews"},136:{n:"BrtEndBookViews"},137:{n:"BrtBeginWsView",f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{n:"BrtEndWsView"},139:{n:"BrtBeginCsViews"},140:{n:"BrtEndCsViews"},141:{n:"BrtBeginCsView"},142:{n:"BrtEndCsView"},143:{n:"BrtBeginBundleShs"},144:{n:"BrtEndBundleShs"},145:{n:"BrtBeginSheetData"},146:{n:"BrtEndSheetData"},147:{n:"BrtWsProp",f:function(e,t){var r={};return e.l+=19,r.name=dr(e,t-19),r}},148:{n:"BrtWsDim",f:La,p:16},151:{n:"BrtPane",f:function(){}},152:{n:"BrtSel"},153:{n:"BrtWbProp",f:function(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?sr(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(65536&n),r.backupFile=!!(64&n),r.checkCompatibility=!!(4096&n),r.date1904=!!(1&n),r.filterPrivacy=!!(8&n),r.hidePivotFieldList=!!(1024&n),r.promptedSolutions=!!(16&n),r.publishItems=!!(2048&n),r.refreshAllConnections=!!(262144&n),r.saveExternalLinkValues=!!(128&n),r.showBorderUnselectedTables=!!(4&n),r.showInkAnnotation=!!(32&n),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(32768&n),r.updateLinks=["userSet","never","always"][n>>8&3],r}},154:{n:"BrtWbFactoid"},155:{n:"BrtFileRecover"},156:{n:"BrtBundleSh",f:function(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=gr(e,t-8),r.name=sr(e),r}},157:{n:"BrtCalcProp"},158:{n:"BrtBookView"},159:{n:"BrtBeginSst",f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{n:"BrtEndSst"},161:{n:"BrtBeginAFilter",f:xr},162:{n:"BrtEndAFilter"},163:{n:"BrtBeginFilterColumn"},164:{n:"BrtEndFilterColumn"},165:{n:"BrtBeginFilters"},166:{n:"BrtEndFilters"},167:{n:"BrtFilter"},168:{n:"BrtColorFilter"},169:{n:"BrtIconFilter"},170:{n:"BrtTop10Filter"},171:{n:"BrtDynamicFilter"},172:{n:"BrtBeginCustomFilters"},173:{n:"BrtEndCustomFilters"},174:{n:"BrtCustomFilter"},175:{n:"BrtAFilterDateGroupItem"},176:{n:"BrtMergeCell",f:Ua},177:{n:"BrtBeginMergeCells"},178:{n:"BrtEndMergeCells"},179:{n:"BrtBeginPivotCacheDef"},180:{n:"BrtEndPivotCacheDef"},181:{n:"BrtBeginPCDFields"},182:{n:"BrtEndPCDFields"},183:{n:"BrtBeginPCDField"},184:{n:"BrtEndPCDField"},185:{n:"BrtBeginPCDSource"},186:{n:"BrtEndPCDSource"},187:{n:"BrtBeginPCDSRange"},188:{n:"BrtEndPCDSRange"},189:{n:"BrtBeginPCDFAtbl"},190:{n:"BrtEndPCDFAtbl"},191:{n:"BrtBeginPCDIRun"},192:{n:"BrtEndPCDIRun"},193:{n:"BrtBeginPivotCacheRecords"},194:{n:"BrtEndPivotCacheRecords"},195:{n:"BrtBeginPCDHierarchies"},196:{n:"BrtEndPCDHierarchies"},197:{n:"BrtBeginPCDHierarchy"},198:{n:"BrtEndPCDHierarchy"},199:{n:"BrtBeginPCDHFieldsUsage"},200:{n:"BrtEndPCDHFieldsUsage"},201:{n:"BrtBeginExtConnection"},202:{n:"BrtEndExtConnection"},203:{n:"BrtBeginECDbProps"},204:{n:"BrtEndECDbProps"},205:{n:"BrtBeginECOlapProps"},206:{n:"BrtEndECOlapProps"},207:{n:"BrtBeginPCDSConsol"},208:{n:"BrtEndPCDSConsol"},209:{n:"BrtBeginPCDSCPages"},210:{n:"BrtEndPCDSCPages"},211:{n:"BrtBeginPCDSCPage"},212:{n:"BrtEndPCDSCPage"},213:{n:"BrtBeginPCDSCPItem"},214:{n:"BrtEndPCDSCPItem"},215:{n:"BrtBeginPCDSCSets"},216:{n:"BrtEndPCDSCSets"},217:{n:"BrtBeginPCDSCSet"},218:{n:"BrtEndPCDSCSet"},219:{n:"BrtBeginPCDFGroup"},220:{n:"BrtEndPCDFGroup"},221:{n:"BrtBeginPCDFGItems"},222:{n:"BrtEndPCDFGItems"},223:{n:"BrtBeginPCDFGRange"},224:{n:"BrtEndPCDFGRange"},225:{n:"BrtBeginPCDFGDiscrete"},226:{n:"BrtEndPCDFGDiscrete"},227:{n:"BrtBeginPCDSDTupleCache"},228:{n:"BrtEndPCDSDTupleCache"},229:{n:"BrtBeginPCDSDTCEntries"},230:{n:"BrtEndPCDSDTCEntries"},231:{n:"BrtBeginPCDSDTCEMembers"},232:{n:"BrtEndPCDSDTCEMembers"},233:{n:"BrtBeginPCDSDTCEMember"},234:{n:"BrtEndPCDSDTCEMember"},235:{n:"BrtBeginPCDSDTCQueries"},236:{n:"BrtEndPCDSDTCQueries"},237:{n:"BrtBeginPCDSDTCQuery"},238:{n:"BrtEndPCDSDTCQuery"},239:{n:"BrtBeginPCDSDTCSets"},240:{n:"BrtEndPCDSDTCSets"},241:{n:"BrtBeginPCDSDTCSet"},242:{n:"BrtEndPCDSDTCSet"},243:{n:"BrtBeginPCDCalcItems"},244:{n:"BrtEndPCDCalcItems"},245:{n:"BrtBeginPCDCalcItem"},246:{n:"BrtEndPCDCalcItem"},247:{n:"BrtBeginPRule"},248:{n:"BrtEndPRule"},249:{n:"BrtBeginPRFilters"},250:{n:"BrtEndPRFilters"},251:{n:"BrtBeginPRFilter"},252:{n:"BrtEndPRFilter"},253:{n:"BrtBeginPNames"},254:{n:"BrtEndPNames"},255:{n:"BrtBeginPName"},256:{n:"BrtEndPName"},257:{n:"BrtBeginPNPairs"},258:{n:"BrtEndPNPairs"},259:{n:"BrtBeginPNPair"},260:{n:"BrtEndPNPair"},261:{n:"BrtBeginECWebProps"},262:{n:"BrtEndECWebProps"},263:{n:"BrtBeginEcWpTables"},264:{n:"BrtEndECWPTables"},265:{n:"BrtBeginECParams"},266:{n:"BrtEndECParams"},267:{n:"BrtBeginECParam"},268:{n:"BrtEndECParam"},269:{n:"BrtBeginPCDKPIs"},270:{n:"BrtEndPCDKPIs"},271:{n:"BrtBeginPCDKPI"},272:{n:"BrtEndPCDKPI"},273:{n:"BrtBeginDims"},274:{n:"BrtEndDims"},275:{n:"BrtBeginDim"},276:{n:"BrtEndDim"},277:{n:"BrtIndexPartEnd"},278:{n:"BrtBeginStyleSheet"},279:{n:"BrtEndStyleSheet"},280:{n:"BrtBeginSXView"},281:{n:"BrtEndSXVI"},282:{n:"BrtBeginSXVI"},283:{n:"BrtBeginSXVIs"},284:{n:"BrtEndSXVIs"},285:{n:"BrtBeginSXVD"},286:{n:"BrtEndSXVD"},287:{n:"BrtBeginSXVDs"},288:{n:"BrtEndSXVDs"},289:{n:"BrtBeginSXPI"},290:{n:"BrtEndSXPI"},291:{n:"BrtBeginSXPIs"},292:{n:"BrtEndSXPIs"},293:{n:"BrtBeginSXDI"},294:{n:"BrtEndSXDI"},295:{n:"BrtBeginSXDIs"},296:{n:"BrtEndSXDIs"},297:{n:"BrtBeginSXLI"},298:{n:"BrtEndSXLI"},299:{n:"BrtBeginSXLIRws"},300:{n:"BrtEndSXLIRws"},301:{n:"BrtBeginSXLICols"},302:{n:"BrtEndSXLICols"},303:{n:"BrtBeginSXFormat"},304:{n:"BrtEndSXFormat"},305:{n:"BrtBeginSXFormats"},306:{n:"BrtEndSxFormats"},307:{n:"BrtBeginSxSelect"},308:{n:"BrtEndSxSelect"},309:{n:"BrtBeginISXVDRws"},310:{n:"BrtEndISXVDRws"},311:{n:"BrtBeginISXVDCols"},312:{n:"BrtEndISXVDCols"},313:{n:"BrtEndSXLocation"},314:{n:"BrtBeginSXLocation"},315:{n:"BrtEndSXView"},316:{n:"BrtBeginSXTHs"},317:{n:"BrtEndSXTHs"},318:{n:"BrtBeginSXTH"},319:{n:"BrtEndSXTH"},320:{n:"BrtBeginISXTHRws"},321:{n:"BrtEndISXTHRws"},322:{n:"BrtBeginISXTHCols"},323:{n:"BrtEndISXTHCols"},324:{n:"BrtBeginSXTDMPS"},325:{n:"BrtEndSXTDMPs"},326:{n:"BrtBeginSXTDMP"},327:{n:"BrtEndSXTDMP"},328:{n:"BrtBeginSXTHItems"},329:{n:"BrtEndSXTHItems"},330:{n:"BrtBeginSXTHItem"},331:{n:"BrtEndSXTHItem"},332:{n:"BrtBeginMetadata"},333:{n:"BrtEndMetadata"},334:{n:"BrtBeginEsmdtinfo"},335:{n:"BrtMdtinfo"},336:{n:"BrtEndEsmdtinfo"},337:{n:"BrtBeginEsmdb"},338:{n:"BrtEndEsmdb"},339:{n:"BrtBeginEsfmd"},340:{n:"BrtEndEsfmd"},341:{n:"BrtBeginSingleCells"},342:{n:"BrtEndSingleCells"},343:{n:"BrtBeginList"},344:{n:"BrtEndList"},345:{n:"BrtBeginListCols"},346:{n:"BrtEndListCols"},347:{n:"BrtBeginListCol"},348:{n:"BrtEndListCol"},349:{n:"BrtBeginListXmlCPr"},350:{n:"BrtEndListXmlCPr"},351:{n:"BrtListCCFmla"},352:{n:"BrtListTrFmla"},353:{n:"BrtBeginExternals"},354:{n:"BrtEndExternals"},355:{n:"BrtSupBookSrc",f:gr},357:{n:"BrtSupSelf"},358:{n:"BrtSupSame"},359:{n:"BrtSupTabs"},360:{n:"BrtBeginSupBook"},361:{n:"BrtPlaceholderName"},362:{n:"BrtExternSheet",f:yi},363:{n:"BrtExternTableStart"},364:{n:"BrtExternTableEnd"},366:{n:"BrtExternRowHdr"},367:{n:"BrtExternCellBlank"},368:{n:"BrtExternCellReal"},369:{n:"BrtExternCellBool"},370:{n:"BrtExternCellError"},371:{n:"BrtExternCellString"},372:{n:"BrtBeginEsmdx"},373:{n:"BrtEndEsmdx"},374:{n:"BrtBeginMdxSet"},375:{n:"BrtEndMdxSet"},376:{n:"BrtBeginMdxMbrProp"},377:{n:"BrtEndMdxMbrProp"},378:{n:"BrtBeginMdxKPI"},379:{n:"BrtEndMdxKPI"},380:{n:"BrtBeginEsstr"},381:{n:"BrtEndEsstr"},382:{n:"BrtBeginPRFItem"},383:{n:"BrtEndPRFItem"},384:{n:"BrtBeginPivotCacheIDs"},385:{n:"BrtEndPivotCacheIDs"},386:{n:"BrtBeginPivotCacheID"},387:{n:"BrtEndPivotCacheID"},388:{n:"BrtBeginISXVIs"},389:{n:"BrtEndISXVIs"},390:{n:"BrtBeginColInfos"},391:{n:"BrtEndColInfos"},392:{n:"BrtBeginRwBrk"},393:{n:"BrtEndRwBrk"},394:{n:"BrtBeginColBrk"},395:{n:"BrtEndColBrk"},396:{n:"BrtBrk"},397:{n:"BrtUserBookView"},398:{n:"BrtInfo"},399:{n:"BrtCUsr"},400:{n:"BrtUsr"},401:{n:"BrtBeginUsers"},403:{n:"BrtEOF"},404:{n:"BrtUCR"},405:{n:"BrtRRInsDel"},406:{n:"BrtRREndInsDel"},407:{n:"BrtRRMove"},408:{n:"BrtRREndMove"},409:{n:"BrtRRChgCell"},410:{n:"BrtRREndChgCell"},411:{n:"BrtRRHeader"},412:{n:"BrtRRUserView"},413:{n:"BrtRRRenSheet"},414:{n:"BrtRRInsertSh"},415:{n:"BrtRRDefName"},416:{n:"BrtRRNote"},417:{n:"BrtRRConflict"},418:{n:"BrtRRTQSIF"},419:{n:"BrtRRFormat"},420:{n:"BrtRREndFormat"},421:{n:"BrtRRAutoFmt"},422:{n:"BrtBeginUserShViews"},423:{n:"BrtBeginUserShView"},424:{n:"BrtEndUserShView"},425:{n:"BrtEndUserShViews"},426:{n:"BrtArrFmla",f:function(e,t,r){var n=e.l+t,i=br(e),s=e.read_shift(1),o=[i];if(o[2]=s,r.cellFormula){var a=qo(e,n-e.l,r);o[1]=a}else e.l=n;return o}},427:{n:"BrtShrFmla",f:function(e,t,r){var n=e.l+t,i=[xr(e,16)];if(r.cellFormula){var s=Ko(e,n-e.l,r);i[1]=s,e.l=n}else e.l=n;return i}},428:{n:"BrtTable"},429:{n:"BrtBeginExtConnections"},430:{n:"BrtEndExtConnections"},431:{n:"BrtBeginPCDCalcMems"},432:{n:"BrtEndPCDCalcMems"},433:{n:"BrtBeginPCDCalcMem"},434:{n:"BrtEndPCDCalcMem"},435:{n:"BrtBeginPCDHGLevels"},436:{n:"BrtEndPCDHGLevels"},437:{n:"BrtBeginPCDHGLevel"},438:{n:"BrtEndPCDHGLevel"},439:{n:"BrtBeginPCDHGLGroups"},440:{n:"BrtEndPCDHGLGroups"},441:{n:"BrtBeginPCDHGLGroup"},442:{n:"BrtEndPCDHGLGroup"},443:{n:"BrtBeginPCDHGLGMembers"},444:{n:"BrtEndPCDHGLGMembers"},445:{n:"BrtBeginPCDHGLGMember"},446:{n:"BrtEndPCDHGLGMember"},447:{n:"BrtBeginQSI"},448:{n:"BrtEndQSI"},449:{n:"BrtBeginQSIR"},450:{n:"BrtEndQSIR"},451:{n:"BrtBeginDeletedNames"},452:{n:"BrtEndDeletedNames"},453:{n:"BrtBeginDeletedName"},454:{n:"BrtEndDeletedName"},455:{n:"BrtBeginQSIFs"},456:{n:"BrtEndQSIFs"},457:{n:"BrtBeginQSIF"},458:{n:"BrtEndQSIF"},459:{n:"BrtBeginAutoSortScope"},460:{n:"BrtEndAutoSortScope"},461:{n:"BrtBeginConditionalFormatting"},462:{n:"BrtEndConditionalFormatting"},463:{n:"BrtBeginCFRule"},464:{n:"BrtEndCFRule"},465:{n:"BrtBeginIconSet"},466:{n:"BrtEndIconSet"},467:{n:"BrtBeginDatabar"},468:{n:"BrtEndDatabar"},469:{n:"BrtBeginColorScale"},470:{n:"BrtEndColorScale"},471:{n:"BrtCFVO"},472:{n:"BrtExternValueMeta"},473:{n:"BrtBeginColorPalette"},474:{n:"BrtEndColorPalette"},475:{n:"BrtIndexedColor"},476:{n:"BrtMargins",f:function(e){var t={};return ja.forEach((function(r){t[r]=Tr(e)})),t}},477:{n:"BrtPrintOptions"},478:{n:"BrtPageSetup"},479:{n:"BrtBeginHeaderFooter"},480:{n:"BrtEndHeaderFooter"},481:{n:"BrtBeginSXCrtFormat"},482:{n:"BrtEndSXCrtFormat"},483:{n:"BrtBeginSXCrtFormats"},484:{n:"BrtEndSXCrtFormats"},485:{n:"BrtWsFmtInfo",f:function(){}},486:{n:"BrtBeginMgs"},487:{n:"BrtEndMGs"},488:{n:"BrtBeginMGMaps"},489:{n:"BrtEndMGMaps"},490:{n:"BrtBeginMG"},491:{n:"BrtEndMG"},492:{n:"BrtBeginMap"},493:{n:"BrtEndMap"},494:{n:"BrtHLink",f:function(e,t){var r=e.l+t,n=xr(e,16),i=pr(e),s=sr(e),o=sr(e),a=sr(e);e.l=r;var l={rfx:n,relId:i,loc:s,display:a};return o&&(l.Tooltip=o),l}},495:{n:"BrtBeginDCon"},496:{n:"BrtEndDCon"},497:{n:"BrtBeginDRefs"},498:{n:"BrtEndDRefs"},499:{n:"BrtDRef"},500:{n:"BrtBeginScenMan"},501:{n:"BrtEndScenMan"},502:{n:"BrtBeginSct"},503:{n:"BrtEndSct"},504:{n:"BrtSlc"},505:{n:"BrtBeginDXFs"},506:{n:"BrtEndDXFs"},507:{n:"BrtDXF"},508:{n:"BrtBeginTableStyles"},509:{n:"BrtEndTableStyles"},510:{n:"BrtBeginTableStyle"},511:{n:"BrtEndTableStyle"},512:{n:"BrtTableStyleElement"},513:{n:"BrtTableStyleClient"},514:{n:"BrtBeginVolDeps"},515:{n:"BrtEndVolDeps"},516:{n:"BrtBeginVolType"},517:{n:"BrtEndVolType"},518:{n:"BrtBeginVolMain"},519:{n:"BrtEndVolMain"},520:{n:"BrtBeginVolTopic"},521:{n:"BrtEndVolTopic"},522:{n:"BrtVolSubtopic"},523:{n:"BrtVolRef"},524:{n:"BrtVolNum"},525:{n:"BrtVolErr"},526:{n:"BrtVolStr"},527:{n:"BrtVolBool"},528:{n:"BrtBeginCalcChain$"},529:{n:"BrtEndCalcChain$"},530:{n:"BrtBeginSortState"},531:{n:"BrtEndSortState"},532:{n:"BrtBeginSortCond"},533:{n:"BrtEndSortCond"},534:{n:"BrtBookProtection"},535:{n:"BrtSheetProtection"},536:{n:"BrtRangeProtection"},537:{n:"BrtPhoneticInfo"},538:{n:"BrtBeginECTxtWiz"},539:{n:"BrtEndECTxtWiz"},540:{n:"BrtBeginECTWFldInfoLst"},541:{n:"BrtEndECTWFldInfoLst"},542:{n:"BrtBeginECTwFldInfo"},548:{n:"BrtFileSharing"},549:{n:"BrtOleSize"},550:{n:"BrtDrawing",f:gr},551:{n:"BrtLegacyDrawing"},552:{n:"BrtLegacyDrawingHF"},553:{n:"BrtWebOpt"},554:{n:"BrtBeginWebPubItems"},555:{n:"BrtEndWebPubItems"},556:{n:"BrtBeginWebPubItem"},557:{n:"BrtEndWebPubItem"},558:{n:"BrtBeginSXCondFmt"},559:{n:"BrtEndSXCondFmt"},560:{n:"BrtBeginSXCondFmts"},561:{n:"BrtEndSXCondFmts"},562:{n:"BrtBkHim"},564:{n:"BrtColor"},565:{n:"BrtBeginIndexedColors"},566:{n:"BrtEndIndexedColors"},569:{n:"BrtBeginMRUColors"},570:{n:"BrtEndMRUColors"},572:{n:"BrtMRUColor"},573:{n:"BrtBeginDVals"},574:{n:"BrtEndDVals"},577:{n:"BrtSupNameStart"},578:{n:"BrtSupNameValueStart"},579:{n:"BrtSupNameValueEnd"},580:{n:"BrtSupNameNum"},581:{n:"BrtSupNameErr"},582:{n:"BrtSupNameSt"},583:{n:"BrtSupNameNil"},584:{n:"BrtSupNameBool"},585:{n:"BrtSupNameFmla"},586:{n:"BrtSupNameBits"},587:{n:"BrtSupNameEnd"},588:{n:"BrtEndSupBook"},589:{n:"BrtCellSmartTagProperty"},590:{n:"BrtBeginCellSmartTag"},591:{n:"BrtEndCellSmartTag"},592:{n:"BrtBeginCellSmartTags"},593:{n:"BrtEndCellSmartTags"},594:{n:"BrtBeginSmartTags"},595:{n:"BrtEndSmartTags"},596:{n:"BrtSmartTagType"},597:{n:"BrtBeginSmartTagTypes"},598:{n:"BrtEndSmartTagTypes"},599:{n:"BrtBeginSXFilters"},600:{n:"BrtEndSXFilters"},601:{n:"BrtBeginSXFILTER"},602:{n:"BrtEndSXFilter"},603:{n:"BrtBeginFills"},604:{n:"BrtEndFills"},605:{n:"BrtBeginCellWatches"},606:{n:"BrtEndCellWatches"},607:{n:"BrtCellWatch"},608:{n:"BrtBeginCRErrs"},609:{n:"BrtEndCRErrs"},610:{n:"BrtCrashRecErr"},611:{n:"BrtBeginFonts"},612:{n:"BrtEndFonts"},613:{n:"BrtBeginBorders"},614:{n:"BrtEndBorders"},615:{n:"BrtBeginFmts"},616:{n:"BrtEndFmts"},617:{n:"BrtBeginCellXFs"},618:{n:"BrtEndCellXFs"},619:{n:"BrtBeginStyles"},620:{n:"BrtEndStyles"},625:{n:"BrtBigName"},626:{n:"BrtBeginCellStyleXFs"},627:{n:"BrtEndCellStyleXFs"},628:{n:"BrtBeginComments"},629:{n:"BrtEndComments"},630:{n:"BrtBeginCommentAuthors"},631:{n:"BrtEndCommentAuthors"},632:{n:"BrtCommentAuthor",f:Zs},633:{n:"BrtBeginCommentList"},634:{n:"BrtEndCommentList"},635:{n:"BrtBeginComment",f:function(e){var t={};t.iauthor=e.read_shift(4);var r=xr(e,16);return t.rfx=r.s,t.ref=Kt(r.s),e.l+=16,t}},636:{n:"BrtEndComment"},637:{n:"BrtCommentText",f:hr},638:{n:"BrtBeginOleObjects"},639:{n:"BrtOleObject"},640:{n:"BrtEndOleObjects"},641:{n:"BrtBeginSxrules"},642:{n:"BrtEndSxRules"},643:{n:"BrtBeginActiveXControls"},644:{n:"BrtActiveX"},645:{n:"BrtEndActiveXControls"},646:{n:"BrtBeginPCDSDTCEMembersSortBy"},648:{n:"BrtBeginCellIgnoreECs"},649:{n:"BrtCellIgnoreEC"},650:{n:"BrtEndCellIgnoreECs"},651:{n:"BrtCsProp",f:function(e,t){return e.l+=10,{name:sr(e)}}},652:{n:"BrtCsPageSetup"},653:{n:"BrtBeginUserCsViews"},654:{n:"BrtEndUserCsViews"},655:{n:"BrtBeginUserCsView"},656:{n:"BrtEndUserCsView"},657:{n:"BrtBeginPcdSFCIEntries"},658:{n:"BrtEndPCDSFCIEntries"},659:{n:"BrtPCDSFCIEntry"},660:{n:"BrtBeginListParts"},661:{n:"BrtListPart"},662:{n:"BrtEndListParts"},663:{n:"BrtSheetCalcProp"},664:{n:"BrtBeginFnGroup"},665:{n:"BrtFnGroup"},666:{n:"BrtEndFnGroup"},667:{n:"BrtSupAddin"},668:{n:"BrtSXTDMPOrder"},669:{n:"BrtCsProtection"},671:{n:"BrtBeginWsSortMap"},672:{n:"BrtEndWsSortMap"},673:{n:"BrtBeginRRSort"},674:{n:"BrtEndRRSort"},675:{n:"BrtRRSortItem"},676:{n:"BrtFileSharingIso"},677:{n:"BrtBookProtectionIso"},678:{n:"BrtSheetProtectionIso"},679:{n:"BrtCsProtectionIso"},680:{n:"BrtRangeProtectionIso"},681:{n:"BrtDValList"},1024:{n:"BrtRwDescent"},1025:{n:"BrtKnownFonts"},1026:{n:"BrtBeginSXTupleSet"},1027:{n:"BrtEndSXTupleSet"},1028:{n:"BrtBeginSXTupleSetHeader"},1029:{n:"BrtEndSXTupleSetHeader"},1030:{n:"BrtSXTupleSetHeaderItem"},1031:{n:"BrtBeginSXTupleSetData"},1032:{n:"BrtEndSXTupleSetData"},1033:{n:"BrtBeginSXTupleSetRow"},1034:{n:"BrtEndSXTupleSetRow"},1035:{n:"BrtSXTupleSetRowItem"},1036:{n:"BrtNameExt"},1037:{n:"BrtPCDH14"},1038:{n:"BrtBeginPCDCalcMem14"},1039:{n:"BrtEndPCDCalcMem14"},1040:{n:"BrtSXTH14"},1041:{n:"BrtBeginSparklineGroup"},1042:{n:"BrtEndSparklineGroup"},1043:{n:"BrtSparkline"},1044:{n:"BrtSXDI14"},1045:{n:"BrtWsFmtInfoEx14"},1046:{n:"BrtBeginConditionalFormatting14"},1047:{n:"BrtEndConditionalFormatting14"},1048:{n:"BrtBeginCFRule14"},1049:{n:"BrtEndCFRule14"},1050:{n:"BrtCFVO14"},1051:{n:"BrtBeginDatabar14"},1052:{n:"BrtBeginIconSet14"},1053:{n:"BrtDVal14",f:function(){}},1054:{n:"BrtBeginDVals14"},1055:{n:"BrtColor14"},1056:{n:"BrtBeginSparklines"},1057:{n:"BrtEndSparklines"},1058:{n:"BrtBeginSparklineGroups"},1059:{n:"BrtEndSparklineGroups"},1061:{n:"BrtSXVD14"},1062:{n:"BrtBeginSXView14"},1063:{n:"BrtEndSXView14"},1064:{n:"BrtBeginSXView16"},1065:{n:"BrtEndSXView16"},1066:{n:"BrtBeginPCD14"},1067:{n:"BrtEndPCD14"},1068:{n:"BrtBeginExtConn14"},1069:{n:"BrtEndExtConn14"},1070:{n:"BrtBeginSlicerCacheIDs"},1071:{n:"BrtEndSlicerCacheIDs"},1072:{n:"BrtBeginSlicerCacheID"},1073:{n:"BrtEndSlicerCacheID"},1075:{n:"BrtBeginSlicerCache"},1076:{n:"BrtEndSlicerCache"},1077:{n:"BrtBeginSlicerCacheDef"},1078:{n:"BrtEndSlicerCacheDef"},1079:{n:"BrtBeginSlicersEx"},1080:{n:"BrtEndSlicersEx"},1081:{n:"BrtBeginSlicerEx"},1082:{n:"BrtEndSlicerEx"},1083:{n:"BrtBeginSlicer"},1084:{n:"BrtEndSlicer"},1085:{n:"BrtSlicerCachePivotTables"},1086:{n:"BrtBeginSlicerCacheOlapImpl"},1087:{n:"BrtEndSlicerCacheOlapImpl"},1088:{n:"BrtBeginSlicerCacheLevelsData"},1089:{n:"BrtEndSlicerCacheLevelsData"},1090:{n:"BrtBeginSlicerCacheLevelData"},1091:{n:"BrtEndSlicerCacheLevelData"},1092:{n:"BrtBeginSlicerCacheSiRanges"},1093:{n:"BrtEndSlicerCacheSiRanges"},1094:{n:"BrtBeginSlicerCacheSiRange"},1095:{n:"BrtEndSlicerCacheSiRange"},1096:{n:"BrtSlicerCacheOlapItem"},1097:{n:"BrtBeginSlicerCacheSelections"},1098:{n:"BrtSlicerCacheSelection"},1099:{n:"BrtEndSlicerCacheSelections"},1100:{n:"BrtBeginSlicerCacheNative"},1101:{n:"BrtEndSlicerCacheNative"},1102:{n:"BrtSlicerCacheNativeItem"},1103:{n:"BrtRangeProtection14"},1104:{n:"BrtRangeProtectionIso14"},1105:{n:"BrtCellIgnoreEC14"},1111:{n:"BrtList14"},1112:{n:"BrtCFIcon"},1113:{n:"BrtBeginSlicerCachesPivotCacheIDs"},1114:{n:"BrtEndSlicerCachesPivotCacheIDs"},1115:{n:"BrtBeginSlicers"},1116:{n:"BrtEndSlicers"},1117:{n:"BrtWbProp14"},1118:{n:"BrtBeginSXEdit"},1119:{n:"BrtEndSXEdit"},1120:{n:"BrtBeginSXEdits"},1121:{n:"BrtEndSXEdits"},1122:{n:"BrtBeginSXChange"},1123:{n:"BrtEndSXChange"},1124:{n:"BrtBeginSXChanges"},1125:{n:"BrtEndSXChanges"},1126:{n:"BrtSXTupleItems"},1128:{n:"BrtBeginSlicerStyle"},1129:{n:"BrtEndSlicerStyle"},1130:{n:"BrtSlicerStyleElement"},1131:{n:"BrtBeginStyleSheetExt14"},1132:{n:"BrtEndStyleSheetExt14"},1133:{n:"BrtBeginSlicerCachesPivotCacheID"},1134:{n:"BrtEndSlicerCachesPivotCacheID"},1135:{n:"BrtBeginConditionalFormattings"},1136:{n:"BrtEndConditionalFormattings"},1137:{n:"BrtBeginPCDCalcMemExt"},1138:{n:"BrtEndPCDCalcMemExt"},1139:{n:"BrtBeginPCDCalcMemsExt"},1140:{n:"BrtEndPCDCalcMemsExt"},1141:{n:"BrtPCDField14"},1142:{n:"BrtBeginSlicerStyles"},1143:{n:"BrtEndSlicerStyles"},1144:{n:"BrtBeginSlicerStyleElements"},1145:{n:"BrtEndSlicerStyleElements"},1146:{n:"BrtCFRuleExt"},1147:{n:"BrtBeginSXCondFmt14"},1148:{n:"BrtEndSXCondFmt14"},1149:{n:"BrtBeginSXCondFmts14"},1150:{n:"BrtEndSXCondFmts14"},1152:{n:"BrtBeginSortCond14"},1153:{n:"BrtEndSortCond14"},1154:{n:"BrtEndDVals14"},1155:{n:"BrtEndIconSet14"},1156:{n:"BrtEndDatabar14"},1157:{n:"BrtBeginColorScale14"},1158:{n:"BrtEndColorScale14"},1159:{n:"BrtBeginSxrules14"},1160:{n:"BrtEndSxrules14"},1161:{n:"BrtBeginPRule14"},1162:{n:"BrtEndPRule14"},1163:{n:"BrtBeginPRFilters14"},1164:{n:"BrtEndPRFilters14"},1165:{n:"BrtBeginPRFilter14"},1166:{n:"BrtEndPRFilter14"},1167:{n:"BrtBeginPRFItem14"},1168:{n:"BrtEndPRFItem14"},1169:{n:"BrtBeginCellIgnoreECs14"},1170:{n:"BrtEndCellIgnoreECs14"},1171:{n:"BrtDxf14"},1172:{n:"BrtBeginDxF14s"},1173:{n:"BrtEndDxf14s"},1177:{n:"BrtFilter14"},1178:{n:"BrtBeginCustomFilters14"},1180:{n:"BrtCustomFilter14"},1181:{n:"BrtIconFilter14"},1182:{n:"BrtPivotCacheConnectionName"},2048:{n:"BrtBeginDecoupledPivotCacheIDs"},2049:{n:"BrtEndDecoupledPivotCacheIDs"},2050:{n:"BrtDecoupledPivotCacheID"},2051:{n:"BrtBeginPivotTableRefs"},2052:{n:"BrtEndPivotTableRefs"},2053:{n:"BrtPivotTableRef"},2054:{n:"BrtSlicerCacheBookPivotTables"},2055:{n:"BrtBeginSxvcells"},2056:{n:"BrtEndSxvcells"},2057:{n:"BrtBeginSxRow"},2058:{n:"BrtEndSxRow"},2060:{n:"BrtPcdCalcMem15"},2067:{n:"BrtQsi15"},2068:{n:"BrtBeginWebExtensions"},2069:{n:"BrtEndWebExtensions"},2070:{n:"BrtWebExtension"},2071:{n:"BrtAbsPath15"},2072:{n:"BrtBeginPivotTableUISettings"},2073:{n:"BrtEndPivotTableUISettings"},2075:{n:"BrtTableSlicerCacheIDs"},2076:{n:"BrtTableSlicerCacheID"},2077:{n:"BrtBeginTableSlicerCache"},2078:{n:"BrtEndTableSlicerCache"},2079:{n:"BrtSxFilter15"},2080:{n:"BrtBeginTimelineCachePivotCacheIDs"},2081:{n:"BrtEndTimelineCachePivotCacheIDs"},2082:{n:"BrtTimelineCachePivotCacheID"},2083:{n:"BrtBeginTimelineCacheIDs"},2084:{n:"BrtEndTimelineCacheIDs"},2085:{n:"BrtBeginTimelineCacheID"},2086:{n:"BrtEndTimelineCacheID"},2087:{n:"BrtBeginTimelinesEx"},2088:{n:"BrtEndTimelinesEx"},2089:{n:"BrtBeginTimelineEx"},2090:{n:"BrtEndTimelineEx"},2091:{n:"BrtWorkBookPr15"},2092:{n:"BrtPCDH15"},2093:{n:"BrtBeginTimelineStyle"},2094:{n:"BrtEndTimelineStyle"},2095:{n:"BrtTimelineStyleElement"},2096:{n:"BrtBeginTimelineStylesheetExt15"},2097:{n:"BrtEndTimelineStylesheetExt15"},2098:{n:"BrtBeginTimelineStyles"},2099:{n:"BrtEndTimelineStyles"},2100:{n:"BrtBeginTimelineStyleElements"},2101:{n:"BrtEndTimelineStyleElements"},2102:{n:"BrtDxf15"},2103:{n:"BrtBeginDxfs15"},2104:{n:"brtEndDxfs15"},2105:{n:"BrtSlicerCacheHideItemsWithNoData"},2106:{n:"BrtBeginItemUniqueNames"},2107:{n:"BrtEndItemUniqueNames"},2108:{n:"BrtItemUniqueName"},2109:{n:"BrtBeginExtConn15"},2110:{n:"BrtEndExtConn15"},2111:{n:"BrtBeginOledbPr15"},2112:{n:"BrtEndOledbPr15"},2113:{n:"BrtBeginDataFeedPr15"},2114:{n:"BrtEndDataFeedPr15"},2115:{n:"BrtTextPr15"},2116:{n:"BrtRangePr15"},2117:{n:"BrtDbCommand15"},2118:{n:"BrtBeginDbTables15"},2119:{n:"BrtEndDbTables15"},2120:{n:"BrtDbTable15"},2121:{n:"BrtBeginDataModel"},2122:{n:"BrtEndDataModel"},2123:{n:"BrtBeginModelTables"},2124:{n:"BrtEndModelTables"},2125:{n:"BrtModelTable"},2126:{n:"BrtBeginModelRelationships"},2127:{n:"BrtEndModelRelationships"},2128:{n:"BrtModelRelationship"},2129:{n:"BrtBeginECTxtWiz15"},2130:{n:"BrtEndECTxtWiz15"},2131:{n:"BrtBeginECTWFldInfoLst15"},2132:{n:"BrtEndECTWFldInfoLst15"},2133:{n:"BrtBeginECTWFldInfo15"},2134:{n:"BrtFieldListActiveItem"},2135:{n:"BrtPivotCacheIdVersion"},2136:{n:"BrtSXDI15"},2137:{n:"BrtBeginModelTimeGroupings"},2138:{n:"BrtEndModelTimeGroupings"},2139:{n:"BrtBeginModelTimeGrouping"},2140:{n:"BrtEndModelTimeGrouping"},2141:{n:"BrtModelTimeGroupingCalcCol"},3072:{n:"BrtUid"},3073:{n:"BrtRevisionPtr"},5095:{n:"BrtBeginCalcFeatures"},5096:{n:"BrtEndCalcFeatures"},5097:{n:"BrtCalcFeature"},65535:{n:""}},Nl=G(Ml,"n"),Pl={3:{n:"BIFF2NUM",f:function(e){var t=Jn(e);++e.l;var r=Tr(e);return t.t="n",t.val=r,t}},4:{n:"BIFF2STR",f:function(e,t,r){var n=Jn(e);++e.l;var i=zn(e,0,r);return n.t="str",n.val=i,n}},6:{n:"Formula",f:Xo},9:{n:"BOF",f:oi},10:{n:"EOF",f:Mn},12:{n:"CalcCount",f:kn},13:{n:"CalcMode",f:kn},14:{n:"CalcPrecision",f:Nn},15:{n:"CalcRefMode",f:Nn},16:{n:"CalcDelta",f:Tr},17:{n:"CalcIter",f:Nn},18:{n:"Protect",f:Nn},19:{n:"Password",f:kn},20:{n:"Header",f:mi},21:{n:"Footer",f:mi},23:{n:"ExternSheet",f:yi},24:{n:"Lbl",f:vi},25:{n:"WinProtect",f:Nn},26:{n:"VerticalPageBreaks"},27:{n:"HorizontalPageBreaks"},28:{n:"Note",f:function(e,t,r){return function(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),a=zn(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},a,o,s]}}(e,0,r)}},29:{n:"Selection"},34:{n:"Date1904",f:Nn},35:{n:"ExternName",f:_i},36:{n:"COLWIDTH"},38:{n:"LeftMargin",f:Tr},39:{n:"RightMargin",f:Tr},40:{n:"TopMargin",f:Tr},41:{n:"BottomMargin",f:Tr},42:{n:"PrintRowCol",f:Nn},43:{n:"PrintGrid",f:Nn},47:{n:"FilePass",f:function(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?function(e,t,r){var n=r||{};n.Info=e.read_shift(2),e.l-=2,1===n.Info?n.Data=function(e){var t={},r=t.EncryptionVersionInfo=Yi(e,4);if(1!=r.Major||1!=r.Minor)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}(e):n.Data=function(e,t){var r={},n=r.EncryptionVersionInfo=Yi(e,4);if(t-=4,2!=n.Minor)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=Ki(e,i),t-=i,r.EncryptionVerifier=$i(e,t),r}(e,t)}(e,t-2,n):function(e,t,r,n){var i,s,o,a={key:kn(e),verificationBytes:kn(e)};r.password&&(a.verifier=ts(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=(i=r.password,s=0,o=os(i),function(e){var t=function(e,t,r,n,i){var s,o;for(i||(i=t),n||(n=os("")),s=0;s!=t.length;++s)o=t[s],o=255&((o^=n[r])>>5|o<<3),i[s]=o,++r;return[i,r,n]}(0,e,s,o);return s=t[1],t[0]}))}(e,r.biff,r,n),n}},49:{n:"Font",f:function(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10}return n.name=Bn(e,0,r),n}},51:{n:"PrintSize",f:kn},60:{n:"Continue"},61:{n:"Window1",f:function(e){return{Pos:[e.read_shift(2),e.read_shift(2)],Dim:[e.read_shift(2),e.read_shift(2)],Flags:e.read_shift(2),CurTab:e.read_shift(2),FirstTab:e.read_shift(2),Selected:e.read_shift(2),TabRatio:e.read_shift(2)}}},64:{n:"Backup",f:Nn},65:{n:"Pane",f:function(){}},66:{n:"CodePage",f:kn},77:{n:"Pls"},80:{n:"DCon"},81:{n:"DConRef"},82:{n:"DConName"},85:{n:"DefColWidth",f:kn},89:{n:"XCT"},90:{n:"CRN"},91:{n:"FileSharing"},92:{n:"WriteAccess",f:function(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=zn(e,0,r);return e.read_shift(t+n-e.l),i}},93:{n:"Obj",f:function(e,t,r){if(r&&r.biff<8)return function(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((xi[n]||Ft)(e,t,r)),{cmo:[i,n,s],ft:o}}(e,t,r);var n=ni(e),i=function(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(si[i](e,r-e.l))}catch(t){return e.l=r,n}}return e.l!=r&&(e.l=r),n}(e,t-22,n[1]);return{cmo:n,ft:i}}},94:{n:"Uncalced"},95:{n:"CalcSaveRecalc",f:Nn},96:{n:"Template"},97:{n:"Intl"},99:{n:"ObjProtect",f:Nn},125:{n:"ColInfo",f:Ei},128:{n:"Guts",f:function(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(0!==t[0]&&t[0]--,0!==t[1]&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}},129:{n:"WsBool",f:function(e,t,r){return{fDialog:16&(r&&8==r.biff||2==t?e.read_shift(2):(e.l+=t,0))}}},130:{n:"GridSet",f:kn},131:{n:"HCenter",f:Nn},132:{n:"VCenter",f:Nn},133:{n:"BoundSheet8",f:function(e,t,r){var n=e.read_shift(4),i=3&e.read_shift(1),s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule"}var o=Bn(e,0,r);return 0===o.length&&(o="Sheet1"),{pos:n,hs:i,dt:s,name:o}}},134:{n:"WriteProtect"},140:{n:"Country",f:function(e){var t,r=[0,0];return t=e.read_shift(2),r[0]=kr[t]||t,t=e.read_shift(2),r[1]=kr[t]||t,r}},141:{n:"HideObj",f:kn},144:{n:"Sort"},146:{n:"Palette",f:function(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Yn(e));return r}},151:{n:"Sync"},152:{n:"LPr"},153:{n:"DxGCol"},154:{n:"FnGroupName"},155:{n:"FilterMode"},156:{n:"BuiltInFnGroupCount",f:kn},157:{n:"AutoFilterInfo"},158:{n:"AutoFilter"},160:{n:"Scl",f:wi},161:{n:"Setup",f:function(e,t){var r={};return t<32||(e.l+=16,r.header=Tr(e),r.footer=Tr(e),e.l+=2),r}},174:{n:"ScenMan"},175:{n:"SCENARIO"},176:{n:"SxView"},177:{n:"Sxvd"},178:{n:"SXVI"},180:{n:"SxIvd"},181:{n:"SXLI"},182:{n:"SXPI"},184:{n:"DocRoute"},185:{n:"RecipName"},189:{n:"MulRk",f:function(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(Qn(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(s.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:o,rkrec:s}}},190:{n:"MulBlank",f:function(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(s.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:o,ixfe:s}}},193:{n:"Mms",f:Mn},197:{n:"SXDI"},198:{n:"SXDB"},199:{n:"SXFDB"},200:{n:"SXDBB"},201:{n:"SXNum"},202:{n:"SxBool",f:Nn},203:{n:"SxErr"},204:{n:"SXInt"},205:{n:"SXString"},206:{n:"SXDtr"},207:{n:"SxNil"},208:{n:"SXTbl"},209:{n:"SXTBRGIITM"},210:{n:"SxTbpg"},211:{n:"ObProj"},213:{n:"SXStreamID"},215:{n:"DBCell"},216:{n:"SXRng"},217:{n:"SxIsxoper"},218:{n:"BookBool",f:kn},220:{n:"DbOrParamQry"},221:{n:"ScenarioProtect",f:Nn},222:{n:"OleObjectSize"},224:{n:"XF",f:function(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,n.data=function(e,t,r,n){var i={},s=e.read_shift(4),o=e.read_shift(4),a=e.read_shift(4),l=e.read_shift(2);return i.patternType=Fr[a>>26],n.cellStyles&&(i.alc=7&s,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=15&o,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=127&a,i.icvBottom=a>>7&127,i.icvDiag=a>>14&127,i.dgDiag=a>>21&15,i.icvFore=127&l,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}(e,0,n.fStyle,r),n}},225:{n:"InterfaceHdr",f:function(e,t){return 0===t||e.read_shift(2),1200}},226:{n:"InterfaceEnd",f:Mn},227:{n:"SXVS"},229:{n:"MergeCells",f:function(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Zn(e));return r}},233:{n:"BkHim"},235:{n:"MsoDrawingGroup"},236:{n:"MsoDrawing"},237:{n:"MsoDrawingSelection"},239:{n:"PhoneticInfo"},240:{n:"SxRule"},241:{n:"SXEx"},242:{n:"SxFilt"},244:{n:"SxDXF"},245:{n:"SxItm"},246:{n:"SxName"},247:{n:"SxSelect"},248:{n:"SXPair"},249:{n:"SxFmla"},251:{n:"SxFormat"},252:{n:"SST",f:function(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),s=[],o=0;o!=i&&e.l<r;++o)s.push(Un(e));return s.Count=n,s.Unique=i,s}},253:{n:"LabelSst",f:function(e){var t=Jn(e);return t.isst=e.read_shift(4),t}},255:{n:"ExtSST",f:function(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}},256:{n:"SXVDEx"},259:{n:"SXFormula"},290:{n:"SXDBEx"},311:{n:"RRDInsDel"},312:{n:"RRDHead"},315:{n:"RRDChgCell"},317:{n:"RRTabId",f:Ln},318:{n:"RRDRenSheet"},319:{n:"RRSort"},320:{n:"RRDMove"},330:{n:"RRFormat"},331:{n:"RRAutoFmt"},333:{n:"RRInsertSh"},334:{n:"RRDMoveBegin"},335:{n:"RRDMoveEnd"},336:{n:"RRDInsDelBegin"},337:{n:"RRDInsDelEnd"},338:{n:"RRDConflict"},339:{n:"RRDDefName"},340:{n:"RRDRstEtxp"},351:{n:"LRng"},352:{n:"UsesELFs",f:Nn},353:{n:"DSF",f:Mn},401:{n:"CUsr"},402:{n:"CbUsr"},403:{n:"UsrInfo"},404:{n:"UsrExcl"},405:{n:"FileLock"},406:{n:"RRDInfo"},407:{n:"BCUsrs"},408:{n:"UsrChk"},425:{n:"UserBView"},426:{n:"UserSViewBegin"},427:{n:"UserSViewEnd"},428:{n:"RRDUserView"},429:{n:"Qsi"},430:{n:"SupBook",f:function(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,1025==s||14849==s)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=jn(e,s),a=[];n>e.l;)a.push(Vn(e));return[s,i,o,a]}},431:{n:"Prot4Rev",f:Nn},432:{n:"CondFmt"},433:{n:"CF"},434:{n:"DVal"},437:{n:"DConBin"},438:{n:"TxO",f:function(e,t,r){var n=e.l,i="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1];-1==[0,5,7,11,12,14].indexOf(s)?e.l+=6:function(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);e.l+=2}(e);var o=e.read_shift(2);e.read_shift(2),kn(e);var a=e.read_shift(2);e.l+=a;for(var l=1;l<e.lens.length-1;++l){if(e.l-n!=e.lens[l])throw new Error("TxO: bad continue record");var h=e[e.l];if((i+=jn(e,e.lens[l+1]-e.lens[l]-1)).length>=(h?o:2*o))break}if(i.length!==o&&i.length!==2*o)throw new Error("cchText: "+o+" != "+i.length);return e.l=n+t,{t:i}}catch(r){return e.l=n+t,{t:i}}}},439:{n:"RefreshAll",f:Nn},440:{n:"HLink",f:function(e,t){var r=Zn(e);e.l+=16;var n=function(e,t){var r=e.l+t,n=e.read_shift(4);if(2!==n)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var s,o,a,l,h,u,c="";16&i&&(s=Xn(e,e.l)),128&i&&(o=Xn(e,e.l)),257==(257&i)&&(a=Xn(e,e.l)),1==(257&i)&&(l=function(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return function(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,"795881f43b1d7f48af2c825dc4852763"===e.read_shift(16)&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(C,"");return n&&(e.l+=24),i}(e);case"0303000000000000c000000000000046":return function(e){e.l+=2;var t=e.read_shift(0,"lpstr-ansi");if(e.l+=2,57005!=e.read_shift(2))throw new Error("Bad FileMoniker");if(0===e.read_shift(4))return t.replace(/\\/g,"/");var r=e.read_shift(4);if(3!=e.read_shift(2))throw new Error("Bad FileMoniker");return e.read_shift(r>>1,"utf16le").replace(C,"")}(e);default:throw new Error("Unsupported Moniker "+r)}}(e,e.l)),8&i&&(c=Xn(e,e.l)),32&i&&(h=e.read_shift(16)),64&i&&(u=_n(e)),e.l=r;var d=o||a||l||"";d&&c&&(d+="#"+c),d||(d="#"+c);var f={Target:d};return h&&(f.guid=h),u&&(f.time=u),s&&(f.Tooltip=s),f}(e,t-24);return[r,n]}},441:{n:"Lel"},442:{n:"CodeName",f:Vn},443:{n:"SXFDBType"},444:{n:"Prot4RevPass",f:kn},445:{n:"ObNoMacros"},446:{n:"Dv"},448:{n:"Excel9File",f:Mn},449:{n:"RecalcId",f:function(e){return e.read_shift(2),e.read_shift(4)},r:2},450:{n:"EntExU2",f:Mn},512:{n:"Dimensions",f:di},513:{n:"Blank",f:Ai},515:{n:"Number",f:function(e){var t=Jn(e),r=Tr(e);return t.val=r,t}},516:{n:"Label",f:function(e,t,r){e.l;var n=Jn(e);2==r.biff&&e.l++;var i=Vn(e,e.l,r);return n.val=i,n}},517:{n:"BoolErr",f:pi},518:{n:"Formula",f:Xo},519:{n:"String",f:Ci},520:{n:"Row",f:function(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,7&n&&(t.level=7&n),32&n&&(t.hidden=!0),64&n&&(t.hpt=r/20),t}},523:{n:"Index"},545:{n:"Array",f:bi},549:{n:"DefaultRowHeight",f:hi},566:{n:"Table"},574:{n:"Window2",f:function(e,t,r){return r&&r.biff>=2&&r.biff<5?{}:{RTL:64&e.read_shift(2)}}},638:{n:"RK",f:function(e){var t=e.read_shift(2),r=e.read_shift(2),n=Qn(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}},659:{n:"Style"},1030:{n:"Formula",f:Xo},1048:{n:"BigName"},1054:{n:"Format",f:function(e,t,r){return[e.read_shift(2),zn(e,0,r)]}},1084:{n:"ContinueBigName"},1212:{n:"ShrFmla",f:function(e,t,r){var n=ti(e);e.l++;var i=e.read_shift(1);return[Ho(e,t-=8,r),i,n]}},2048:{n:"HLinkTooltip",f:function(e,t){e.read_shift(2);var r=Zn(e),n=e.read_shift((t-10)/2,"dbcs-cont");return[r,n=n.replace(C,"")]}},2049:{n:"WebPub"},2050:{n:"QsiSXTag"},2051:{n:"DBQueryExt"},2052:{n:"ExtString"},2053:{n:"TxtQry"},2054:{n:"Qsir"},2055:{n:"Qsif"},2056:{n:"RRDTQSIF"},2057:{n:"BOF",f:oi},2058:{n:"OleDbConn"},2059:{n:"WOpt"},2060:{n:"SXViewEx"},2061:{n:"SXTH"},2062:{n:"SXPIEx"},2063:{n:"SXVDTEx"},2064:{n:"SXViewEx9"},2066:{n:"ContinueFrt"},2067:{n:"RealTimeData"},2128:{n:"ChartFrtInfo"},2129:{n:"FrtWrapper"},2130:{n:"StartBlock"},2131:{n:"EndBlock"},2132:{n:"StartObject"},2133:{n:"EndObject"},2134:{n:"CatLab"},2135:{n:"YMult"},2136:{n:"SXViewLink"},2137:{n:"PivotChartBits"},2138:{n:"FrtFontList"},2146:{n:"SheetExt"},2147:{n:"BookExt",r:12},2148:{n:"SXAddl"},2149:{n:"CrErr"},2150:{n:"HFPicture"},2151:{n:"FeatHdr",f:Mn},2152:{n:"Feat"},2154:{n:"DataLabExt"},2155:{n:"DataLabExtContents"},2156:{n:"CellWatch"},2161:{n:"FeatHdr11"},2162:{n:"Feature11"},2164:{n:"DropDownObjIds"},2165:{n:"ContinueFrt11"},2166:{n:"DConn"},2167:{n:"List12"},2168:{n:"Feature12"},2169:{n:"CondFmt12"},2170:{n:"CF12"},2171:{n:"CFEx"},2172:{n:"XFCRC",f:function(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t},r:12},2173:{n:"XFExt",f:function(e,t){e.l,e.l+=2;var r=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),i=[];n-- >0;)i.push(Ys(e,e.l));return{ixfe:r,ext:i}},r:12},2174:{n:"AutoFilter12"},2175:{n:"ContinueFrt12"},2180:{n:"MDTInfo"},2181:{n:"MDXStr"},2182:{n:"MDXTuple"},2183:{n:"MDXSet"},2184:{n:"MDXProp"},2185:{n:"MDXKPI"},2186:{n:"MDB"},2187:{n:"PLV"},2188:{n:"Compat12",f:Nn,r:12},2189:{n:"DXF"},2190:{n:"TableStyles",r:12},2191:{n:"TableStyle"},2192:{n:"TableStyleElement"},2194:{n:"StyleExt"},2195:{n:"NamePublish"},2196:{n:"NameCmt",f:function(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2);return[jn(e,n,r),jn(e,i,r)]}e.l+=t},r:12},2197:{n:"SortData"},2198:{n:"Theme",f:function(e,t,r){var n=e.l+t;if(124226!==e.read_shift(4)){if(!r.cellStyles||!se)return void(e.l=n);var i,s=e.slice(e.l);e.l=n;try{i=new se(s)}catch(e){return}var o=ce(i,"theme/theme/theme1.xml",!0);if(o)return Ws(o,r)}},r:12},2199:{n:"GUIDTypeLib"},2200:{n:"FnGrp12"},2201:{n:"NameFnGrp12"},2202:{n:"MTRSettings",f:function(e){return[0!==e.read_shift(4),0!==e.read_shift(4),e.read_shift(4)]},r:12},2203:{n:"CompressPictures",f:Mn},2204:{n:"HeaderFooter"},2205:{n:"CrtLayout12"},2206:{n:"CrtMlFrt"},2207:{n:"CrtMlFrtContinue"},2211:{n:"ForceFullCalculation",f:function(e){var t=function(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}(e);if(2211!=t.type)throw new Error("Invalid Future Record "+t.type);return 0!==e.read_shift(4)}},2212:{n:"ShapePropsStream"},2213:{n:"TextPropsStream"},2214:{n:"RichTextStream"},2215:{n:"CrtLayout12A"},4097:{n:"Units"},4098:{n:"Chart"},4099:{n:"Series"},4102:{n:"DataFormat"},4103:{n:"LineFormat"},4105:{n:"MarkerFormat"},4106:{n:"AreaFormat"},4107:{n:"PieFormat"},4108:{n:"AttachedLabel"},4109:{n:"SeriesText"},4116:{n:"ChartFormat"},4117:{n:"Legend"},4118:{n:"SeriesList"},4119:{n:"Bar"},4120:{n:"Line"},4121:{n:"Pie"},4122:{n:"Area"},4123:{n:"Scatter"},4124:{n:"CrtLine"},4125:{n:"Axis"},4126:{n:"Tick"},4127:{n:"ValueRange"},4128:{n:"CatSerRange"},4129:{n:"AxisLine"},4130:{n:"CrtLink"},4132:{n:"DefaultText"},4133:{n:"Text"},4134:{n:"FontX",f:kn},4135:{n:"ObjectLink"},4146:{n:"Frame"},4147:{n:"Begin"},4148:{n:"End"},4149:{n:"PlotArea"},4154:{n:"Chart3d"},4156:{n:"PicF"},4157:{n:"DropBar"},4158:{n:"Radar"},4159:{n:"Surf"},4160:{n:"RadarArea"},4161:{n:"AxisParent"},4163:{n:"LegendException"},4164:{n:"ShtProps",f:function(e,t,r){var n={area:!1};if(5!=r.biff)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,16&i&&(n.area=!0),n}},4165:{n:"SerToCrt"},4166:{n:"AxesUsed"},4168:{n:"SBaseRef"},4170:{n:"SerParent"},4171:{n:"SerAuxTrend"},4174:{n:"IFmtRecord"},4175:{n:"Pos"},4176:{n:"AlRuns"},4177:{n:"BRAI"},4187:{n:"SerAuxErrBar"},4188:{n:"ClrtClient",f:function(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Yn(e));return r}},4189:{n:"SerFmt"},4191:{n:"Chart3DBarShape"},4192:{n:"Fbi"},4193:{n:"BopPop"},4194:{n:"AxcExt"},4195:{n:"Dat"},4196:{n:"PlotGrowth"},4197:{n:"SIIndex"},4198:{n:"GelFrame"},4199:{n:"BopPopCustom"},4200:{n:"Fbi2"},0:{n:"Dimensions",f:di},2:{n:"BIFF2INT",f:function(e){var t=Jn(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}},5:{n:"BoolErr",f:pi},7:{n:"String",f:function(e){var t=e.read_shift(1);return 0===t?(e.l++,""):e.read_shift(t,"sbcs-cont")}},8:{n:"BIFF2ROW"},11:{n:"Index"},22:{n:"ExternCount",f:kn},30:{n:"BIFF2FORMAT",f:ci},31:{n:"BIFF2FMTCNT"},32:{n:"BIFF2COLINFO"},33:{n:"Array",f:bi},37:{n:"DefaultRowHeight",f:hi},50:{n:"BIFF2FONTXTRA",f:function(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}},52:{n:"DDEObjName"},62:{n:"BIFF2WINDOW2"},67:{n:"BIFF2XF"},69:{n:"BIFF2FONTCLR"},86:{n:"BIFF4FMTCNT"},126:{n:"RK"},127:{n:"ImData",f:function(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}},135:{n:"Addin"},136:{n:"Edg"},137:{n:"Pub"},145:{n:"Sub"},148:{n:"LHRecord"},149:{n:"LHNGraph"},150:{n:"Sound"},169:{n:"CoordList"},171:{n:"GCW"},188:{n:"ShrFmla"},191:{n:"ToolbarHdr"},192:{n:"ToolbarEnd"},194:{n:"AddMenu"},195:{n:"DelMenu"},214:{n:"RString",f:function(e,t,r){var n=e.l+t,i=Jn(e),s=e.read_shift(2),o=jn(e,s,r);return e.l=n,i.t="str",i.val=o,i}},223:{n:"UDDesc"},234:{n:"TabIdConf"},354:{n:"XL5Modify"},421:{n:"FileSharing2"},521:{n:"BOF",f:oi},536:{n:"Lbl",f:vi},547:{n:"ExternName",f:_i},561:{n:"Font"},579:{n:"BIFF3XF"},1033:{n:"BOF",f:oi},1091:{n:"BIFF4XF"},2157:{n:"FeatInfo"},2163:{n:"FeatInfo11"},2177:{n:"SXAddl12"},2240:{n:"AutoWebPub"},2241:{n:"ListObj"},2242:{n:"ListField"},2243:{n:"ListDV"},2244:{n:"ListCondFmt"},2245:{n:"ListCF"},2246:{n:"FMQry"},2247:{n:"FMSQry"},2248:{n:"PLV"},2249:{n:"LnExt"},2250:{n:"MkrExt"},2251:{n:"CrtCoopt"},2262:{n:"FRTArchId$",r:12},29282:{}},kl=G(Pl,"n");function Fl(e,t,r,n){var i=+t||+kl[t];if(!isNaN(i)){var s=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,i),o.write_shift(2,s),s>0&&Et(r)&&e.push(r)}}function Ll(e,t,r){return e||(e=Lt(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function Bl(e,t,r,n){if(null!=t.v)switch(t.t){case"d":case"n":var i="d"==t.t?H(Z(t.v)):t.v;return void(i==(0|i)&&i>=0&&i<65536?Fl(e,2,(s=r,o=n,a=i,l=Lt(9),Ll(l,s,o),l.write_shift(2,a),l)):Fl(e,3,function(e,t,r){var n=Lt(15);return Ll(n,e,t),n.write_shift(8,r,"f"),n}(r,n,i)));case"b":case"e":return void Fl(e,5,function(e,t,r,n){var i=Lt(9);return Ll(i,e,t),"e"==n?(i.write_shift(1,r),i.write_shift(1,1)):(i.write_shift(1,r?1:0),i.write_shift(1,0)),i}(r,n,t.v,t.t));case"s":case"str":return void Fl(e,4,function(e,t,r){var n=Lt(8+2*r.length);return Ll(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}(r,n,t.v))}var s,o,a,l;Fl(e,1,Ll(null,r,n))}function Ul(e,t,r,n,i){var s=16+ha(i.cellXfs,t,i);if(null!=t.v||t.bf)if(t.bf)Fl(e,"Formula",function(e,t,r,n,i){var s=Kn(t,r,i),o=function(e){if(null==e){var t=Lt(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}return Er("number"==typeof e?e:0)}(e.v),a=Lt(6);a.write_shift(2,33),a.write_shift(4,0);for(var l=Lt(e.bf.length),h=0;h<e.bf.length;++h)l[h]=e.bf[h];return w([s,o,a,l])}(t,r,n,0,s));else switch(t.t){case"d":case"n":Fl(e,"Number",function(e,t,r,n){var i=Lt(14);return Kn(e,t,n,i),Er(r,i),i}(r,n,"d"==t.t?H(Z(t.v)):t.v,s));break;case"b":case"e":Fl(e,517,function(e,t,r,n,i,s){var o=Lt(8);return Kn(e,t,n,o),function(e,t,r){r||(r=Lt(2)),r.write_shift(1,+e),r.write_shift(1,"e"==t?1:0)}(r,s,o),o}(r,n,t.v,s,0,t.t));break;case"s":case"str":i.bookSST?Fl(e,"LabelSst",function(e,t,r,n){var i=Lt(10);return Kn(e,t,n,i),i.write_shift(4,r),i}(r,n,oa(i.Strings,t.v,i.revStrings),s)):Fl(e,"Label",function(e,t,r,n,i){var s=!i||8==i.biff,o=Lt(+s+8+(1+s)*r.length);return Kn(e,t,n,o),o.write_shift(2,r.length),s&&o.write_shift(1,1),o.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),o}(r,n,t.v,s,i));break;default:Fl(e,"Blank",Kn(r,n,s))}else Fl(e,"Blank",Kn(r,n,s))}function Gl(e,t,r){var n,i=Ut(),s=r.SheetNames[e],o=r.Sheets[s]||{},a=(r||{}).Workbook||{},l=(a.Sheets||[])[e]||{},h=Array.isArray(o),u=8==t.biff,c="",d=[],f=Zt(o["!ref"]||"A1"),p=u?65536:16384;if(f.e.c>255||f.e.r>=p){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV16384");f.e.c=Math.min(f.e.c,255),f.e.r=Math.min(f.e.c,p-1)}Fl(i,2057,ai(0,16,t)),Fl(i,"CalcMode",Fn(1)),Fl(i,"CalcCount",Fn(100)),Fl(i,"CalcRefMode",Pn(!0)),Fl(i,"CalcIter",Pn(!1)),Fl(i,"CalcDelta",Er(.001)),Fl(i,"CalcSaveRecalc",Pn(!0)),Fl(i,"PrintRowCol",Pn(!1)),Fl(i,"PrintGrid",Pn(!1)),Fl(i,"GridSet",Fn(1)),Fl(i,"Guts",function(e){var t=Lt(8);return t.write_shift(4,0),t.write_shift(2,e[0]?e[0]+1:0),t.write_shift(2,e[1]?e[1]+1:0),t}([0,0])),Fl(i,"HCenter",Pn(!1)),Fl(i,"VCenter",Pn(!1)),Fl(i,512,function(e,t){var r=8!=t.biff&&t.biff?2:4,n=Lt(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}(f,t)),u&&(o["!links"]=[]);for(var m=f.s.r;m<=f.e.r;++m){c=Wt(m);for(var _=f.s.c;_<=f.e.c;++_){m===f.s.r&&(d[_]=Yt(_)),n=d[_]+c;var g=h?(o[m]||[])[_]:o[n];!g||(Ul(i,g,m,_,t),u&&g.l&&o["!links"].push([n,g.l]))}}var v=l.CodeName||l.name||s;return u&&Fl(i,"Window2",function(e){var t=Lt(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}((a.Views||[])[0])),u&&(o["!merges"]||[]).length&&Fl(i,"MergeCells",function(e){var t=Lt(2+8*e.length);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)ei(e[r],t);return t}(o["!merges"])),u&&function(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Fl(e,"HLink",Si(n)),n[1].Tooltip&&Fl(e,"HLinkTooltip",Ti(n))}delete t["!links"]}(i,o),Fl(i,"CodeName",Hn(v)),u&&function(e,t){var r=Lt(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Fl(e,"FeatHdr",r),(r=Lt(39)).write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),ei(Zt(t["!ref"]||"A1"),r),r.write_shift(4,4),Fl(e,"Feat",r)}(i,o),Fl(i,"EOF"),i.end()}function jl(e,t,r){var n=Ut(),i=(e||{}).Workbook||{},s=i.Sheets||[],o=i.WBProps||{},a=8==r.biff,l=5==r.biff;Fl(n,2057,ai(0,5,r)),"xla"==r.bookType&&Fl(n,"Addin"),Fl(n,"InterfaceHdr",a?Fn(1200):null),Fl(n,"Mms",function(e,t){t||(t=Lt(2));for(var r=0;r<2;++r)t.write_shift(1,0);return t}()),l&&Fl(n,"ToolbarHdr"),l&&Fl(n,"ToolbarEnd"),Fl(n,"InterfaceEnd"),Fl(n,"WriteAccess",function(e,t){var r=!t||8==t.biff,n=Lt(r?112:54);for(n.write_shift(8==t.biff?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}(0,r)),Fl(n,"CodePage",Fn(a?1200:1252)),a&&Fl(n,"DSF",Fn(0)),a&&Fl(n,"Excel9File"),Fl(n,"RRTabId",function(e){for(var t=Lt(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}(e.SheetNames.length)),a&&e.vbaraw&&Fl(n,"ObProj"),a&&e.vbaraw&&Fl(n,"CodeName",Hn(o.CodeName||"ThisWorkbook")),Fl(n,"BuiltInFnGroupCount",Fn(17)),Fl(n,"WinProtect",Pn(!1)),Fl(n,"Protect",Pn(!1)),Fl(n,"Password",Fn(0)),a&&Fl(n,"Prot4Rev",Pn(!1)),a&&Fl(n,"Prot4RevPass",Fn(0)),Fl(n,"Window1",function(){var e=Lt(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}()),Fl(n,"Backup",Pn(!1)),Fl(n,"HideObj",Fn(0)),Fl(n,"Date1904",Pn("true"==function(e){return e.Workbook&&e.Workbook.WBProps&&Pe(e.Workbook.WBProps.date1904)?"true":"false"}(e))),Fl(n,"CalcPrecision",Pn(!0)),a&&Fl(n,"RefreshAll",Pn(!1)),Fl(n,"BookBool",Fn(0)),function(e,t,r){Fl(e,"Font",function(e,t){var r=e.name||"Arial",n=t&&5==t.biff,i=Lt(n?15+r.length:16+2*r.length);return i.write_shift(2,20*(e.sz||12)),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}(n,0,r),function(e,t,r){!t||[[5,8],[23,26],[41,44],[50,392]].forEach((function(n){for(var i=n[0];i<=n[1];++i)null!=t[i]&&Fl(e,"Format",ui(i,t[i],r))}))}(n,e.SSF,r),function(e,t){for(var r=0;r<16;++r)Fl(e,"XF",fi({numFmtId:0,style:!0},0,t));t.cellXfs.forEach((function(r){Fl(e,"XF",fi(r,0,t))}))}(n,r),a&&Fl(n,"UsesELFs",Pn(!1));var h=n.end(),u=Ut();a&&Fl(u,"Country",function(e){return e||(e=Lt(4)),e.write_shift(2,1),e.write_shift(2,1),e}()),a&&r.Strings&&function(e,t,r,n){var i=(r||[]).length||0;if(i<=8224)return Fl(e,t,r,i);var s=+kl.SST;if(!isNaN(s)){for(var o=r.parts||[],a=0,l=0,h=0;h+(o[a]||8224)<=8224;)h+=o[a]||8224,a++;var u=e.next(4);for(u.write_shift(2,s),u.write_shift(2,h),e.push(r.slice(l,l+h)),l+=h;l<i;){for((u=e.next(4)).write_shift(2,60),h=0;h+(o[a]||8224)<=8224;)h+=o[a]||8224,a++;u.write_shift(2,h),e.push(r.slice(l,l+h)),l+=h}}}(u,"SST",function(e,t){var r=Lt(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=Gn(e[i]);var s=w([r].concat(n));return s.parts=[r.length].concat(n.map((function(e){return e.length}))),s}(r.Strings)),Fl(u,"EOF");var c=u.end(),d=Ut(),f=0,p=0;for(p=0;p<e.SheetNames.length;++p)f+=(a?12:11)+(a?2:1)*e.SheetNames[p].length;var m=h.length+f+c.length;for(p=0;p<e.SheetNames.length;++p)Fl(d,"BoundSheet8",li({pos:m,hs:(s[p]||{}).Hidden||0,dt:0,name:e.SheetNames[p]},r)),m+=t[p].length;var _=d.end();if(f!=_.length)throw new Error("BS8 "+f+" != "+_.length);var g=[];return h.length&&g.push(h),_.length&&g.push(_),c.length&&g.push(c),ot([g])}function Vl(e,t){var r=t||{};switch(r.biff||2){case 8:case 5:return function(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=R.get_table()),e&&e.SSF&&(D(R),R.load_table(e.SSF),r.revssf=V(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,fh(r),r.cellXfs=[],ha(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=Gl(i,r,e);return n.unshift(jl(e,n,r)),ot([n])}(e,t);case 4:case 3:case 2:return function(e,t){for(var r=t||{},n=Ut(),i=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(i=s);if(0==i&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Fl(n,9,ai(0,16,r)),function(e,t,r,n){var i,s=Array.isArray(t),o=Zt(t["!ref"]||"A1"),a="",l=[];if(o.e.c>255||o.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.c,16383),i=Qt(o)}for(var h=o.s.r;h<=o.e.r;++h){a=Wt(h);for(var u=o.s.c;u<=o.e.c;++u){h===o.s.r&&(l[u]=Yt(u)),i=l[u]+a;var c=s?(t[h]||[])[u]:t[i];!c||Bl(e,c,h,u)}}}(n,e.Sheets[e.SheetNames[i]],0,r),Fl(n,10),n.end()}(e,t)}throw new Error("invalid type "+r.bookType+" for BIFF")}var zl=function(){function e(e,t){var r=t||{},n=r.dense?[]:{},i=(e=e.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),o=i.index,a=s&&s.index||e.length,l=function(e,t,r){if(oe||"string"==typeof t)return e.split(t);for(var n=e.split(t),i=[n[0]],s=1;s<n.length;++s)i.push("<tr>"),i.push(n[s]);return i}(e.slice(o,a),/(:?<tr[^>]*>)/i),h=-1,u=0,c=0,d=0,f={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(o=0;o<l.length;++o){var m=l[o].trim(),_=m.slice(0,3).toLowerCase();if("<tr"!=_){if("<td"==_||"<th"==_){var g=m.split(/<\/t[dh]>/i);for(a=0;a<g.length;++a){var v=g[a].trim();if(v.match(/<t[dh]/i)){for(var y=v,b=0;"<"==y.charAt(0)&&(b=y.indexOf(">"))>-1;)y=y.slice(b+1);for(var x=0;x<p.length;++x){var S=p[x];S.s.c==u&&S.s.r<h&&h<=S.e.r&&(u=S.e.c+1,x=-1)}var T=be(v.slice(0,v.indexOf(">")));d=T.colspan?+T.colspan:1,((c=+T.rowspan)>1||d>1)&&p.push({s:{r:h,c:u},e:{r:h+(c||1)-1,c:u+d-1}});var E=T.t||"";if(!y.length){u+=d;continue}if(y=He(y),f.s.r>h&&(f.s.r=h),f.e.r<h&&(f.e.r=h),f.s.c>u&&(f.s.c=u),f.e.c<u&&(f.e.c=u),y.length){var A={t:"s",v:y};r.raw||!y.trim().length||"s"==E||("TRUE"===y?A={t:"b",v:!0}:"FALSE"===y?A={t:"b",v:!1}:isNaN(ne(y))?isNaN(ie(y).getDate())||(A={t:"d",v:Z(y)},r.cellDates||(A={t:"n",v:H(A.v)}),A.z=r.dateNF||R._table[14]):A={t:"n",v:ne(y)}),r.dense?(n[h]||(n[h]=[]),n[h][u]=A):n[Kt({r:h,c:u})]=A,u+=d}}}}}else{if(++h,r.sheetRows&&r.sheetRows<=h){--h;break}u=0}}return n["!ref"]=Qt(f),p.length&&(n["!merges"]=p),n}function t(e,t,r,n){for(var i=e["!merges"]||[],s=[],o=t.s.c;o<=t.e.c;++o){for(var a=0,l=0,h=0;h<i.length;++h)if(!(i[h].s.r>r||i[h].s.c>o||i[h].e.r<r||i[h].e.c<o)){if(i[h].s.r<r||i[h].s.c<o){a=-1;break}a=i[h].e.r-i[h].s.r+1,l=i[h].e.c-i[h].s.c+1;break}if(!(a<0)){var u=Kt({r,c:o}),c=n.dense?(e[r]||[])[o]:e[u],d=c&&null!=c.v&&(c.h||Me(c.w||(er(c),c.w)||""))||"",f={};a>1&&(f.rowspan=a),l>1&&(f.colspan=l),f.t=c&&c.t||"z",n.editable&&(d='<span contenteditable="true">'+d+"</span>"),f.id=(n.id||"sjs")+"-"+u,"z"!=f.t&&(f.v=c.v,null!=c.z&&(f.z=c.z)),s.push(Qe("td",d,f))}}return"<tr>"+s.join("")+"</tr>"}function r(e,t,r){return[].join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}var n='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',i="</body></html>";return{to_workbook:function(t,r){return tr(e(t,r),r)},to_sheet:e,_row:t,BEGIN:n,END:i,_preamble:r,from_sheet:function(e,s){var o=s||{},a=null!=o.header?o.header:n,l=null!=o.footer?o.footer:i,h=[a],u=$t(e["!ref"]);o.dense=Array.isArray(e),h.push(r(0,0,o));for(var c=u.s.r;c<=u.e.r;++c)h.push(t(e,u,c,o));return h.push("</table>"+l),h.join("")}}}();function Hl(e,t,r){var n=r||{},i=0,s=0;if(null!=n.origin)if("number"==typeof n.origin)i=n.origin;else{var o="string"==typeof n.origin?Jt(n.origin):n.origin;i=o.r,s=o.c}var a=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,a.length),h={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var u=$t(e["!ref"]);h.s.r=Math.min(h.s.r,u.s.r),h.s.c=Math.min(h.s.c,u.s.c),h.e.r=Math.max(h.e.r,u.e.r),h.e.c=Math.max(h.e.c,u.e.c),-1==i&&(h.e.r=i=u.e.r+1)}var c=[],d=0,f=e["!rows"]||(e["!rows"]=[]),p=0,m=0,_=0,g=0,v=0,y=0;for(e["!cols"]||(e["!cols"]=[]);p<a.length&&m<l;++p){var b=a[p];if(Wl(b)){if(n.display)continue;f[m]={hidden:!0}}var x=b.children;for(_=g=0;_<x.length;++_){var S=x[_];if(!n.display||!Wl(S)){var T=S.hasAttribute("v")?S.getAttribute("v"):He(S.innerHTML),E=S.getAttribute("z");for(d=0;d<c.length;++d){var A=c[d];A.s.c==g+s&&A.s.r<m+i&&m+i<=A.e.r&&(g=A.e.c+1-s,d=-1)}y=+S.getAttribute("colspan")||1,((v=+S.getAttribute("rowspan")||1)>1||y>1)&&c.push({s:{r:m+i,c:g+s},e:{r:m+i+(v||1)-1,c:g+s+(y||1)-1}});var w={t:"s",v:T},C=S.getAttribute("t")||"";null!=T&&(0==T.length?w.t=C||"z":n.raw||0==T.trim().length||"s"==C||("TRUE"===T?w={t:"b",v:!0}:"FALSE"===T?w={t:"b",v:!1}:isNaN(ne(T))?isNaN(ie(T).getDate())||(w={t:"d",v:Z(T)},n.cellDates||(w={t:"n",v:H(w.v)}),w.z=n.dateNF||R._table[14]):w={t:"n",v:ne(T)})),void 0===w.z&&null!=E&&(w.z=E),n.dense?(e[m+i]||(e[m+i]=[]),e[m+i][g+s]=w):e[Kt({c:g+s,r:m+i})]=w,h.e.c<g+s&&(h.e.c=g+s),g+=y}}++m}return c.length&&(e["!merges"]=(e["!merges"]||[]).concat(c)),h.e.r=Math.max(h.e.r,m-1+i),e["!ref"]=Qt(h),m>=l&&(e["!fullref"]=Qt((h.e.r=a.length-p+m-1+i,h))),e}function Xl(e,t){return Hl((t||{}).dense?[]:{},e,t)}function Wl(e){var t="",r=function(e){return e.ownerDocument.defaultView&&"function"==typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"==typeof getComputedStyle?getComputedStyle:null}(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style.display),"none"===t}var ql,Yl=(ql={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']},function(e,t){var r,n,i,s,o,a,l,h=t||{},u=gl(e),c=[],d={name:""},f="",p=0,m={},_=[],g=h.dense?[]:{},v={value:""},y="",b=0,x=[],S=-1,T=-1,E={s:{r:1e6,c:1e7},e:{r:0,c:0}},A=0,w={},C=[],O={},R=[],D=1,I=1,M=[],N={Names:[]},P={},k=["",""],F=[],L={},B="",U=0,G=!1,j=!1,V=0;for(vl.lastIndex=0,u=u.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");o=vl.exec(u);)switch(o[3]=o[3].replace(/_.*$/,"")){case"table":case"":"/"===o[1]?(E.e.c>=E.s.c&&E.e.r>=E.s.r?g["!ref"]=Qt(E):g["!ref"]="A1:A1",h.sheetRows>0&&h.sheetRows<=E.e.r&&(g["!fullref"]=g["!ref"],E.e.r=h.sheetRows-1,g["!ref"]=Qt(E)),C.length&&(g["!merges"]=C),R.length&&(g["!rows"]=R),i.name=i.||i.name,"undefined"!=typeof JSON&&JSON.stringify(i),_.push(i.name),m[i.name]=g,j=!1):"/"!==o[0].charAt(o[0].length-2)&&(i=be(o[0],!1),S=T=-1,E.s.r=E.s.c=1e7,E.e.r=E.e.c=0,g=h.dense?[]:{},C=[],R=[],j=!0);break;case"table-row-group":"/"===o[1]?--A:++A;break;case"table-row":case"":if("/"===o[1]){S+=D,D=1;break}if((s=be(o[0],!1)).?S=s.-1:-1==S&&(S=0),(D=+s["number-rows-repeated"]||1)<10)for(V=0;V<D;++V)A>0&&(R[S+V]={level:A});T=-1;break;case"covered-table-cell":"/"!==o[1]&&++T,h.sheetStubs&&(h.dense?(g[S]||(g[S]=[]),g[S][T]={t:"z"}):g[Kt({r:S,c:T})]={t:"z"}),y="",x=[];break;case"table-cell":case"":if("/"===o[0].charAt(o[0].length-2))++T,v=be(o[0],!1),I=parseInt(v["number-columns-repeated"]||"1",10),a={t:"z",v:null},v.formula&&0!=h.cellFormula&&(a.f=ta(we(v.formula))),"string"==(v.||v["value-type"])&&(a.t="s",a.v=we(v["string-value"]||""),h.dense?(g[S]||(g[S]=[]),g[S][T]=a):g[Kt({r:S,c:T})]=a),T+=I-1;else if("/"!==o[1]){I=1;var z=D?S+D-1:S;if(++T>E.e.c&&(E.e.c=T),T<E.s.c&&(E.s.c=T),S<E.s.r&&(E.s.r=S),z>E.e.r&&(E.e.r=z),F=[],L={},a={t:(v=be(o[0],!1)).||v["value-type"],v:null},h.cellFormula)if(v.formula&&(v.formula=we(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(O={s:{r:S,c:T},e:{r:S+(parseInt(v["number-matrix-rows-spanned"],10)||0)-1,c:T+(parseInt(v["number-matrix-columns-spanned"],10)||0)-1}},a.F=Qt(O),M.push([O,a.F])),v.formula)a.f=ta(v.formula);else for(V=0;V<M.length;++V)S>=M[V][0].s.r&&S<=M[V][0].e.r&&T>=M[V][0].s.c&&T<=M[V][0].e.c&&(a.F=M[V][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(O={s:{r:S,c:T},e:{r:S+(parseInt(v["number-rows-spanned"],10)||0)-1,c:T+(parseInt(v["number-columns-spanned"],10)||0)-1}},C.push(O)),v["number-columns-repeated"]&&(I=parseInt(v["number-columns-repeated"],10)),a.t){case"boolean":a.t="b",a.v=Pe(v["boolean-value"]);break;case"float":case"percentage":case"currency":a.t="n",a.v=parseFloat(v.value);break;case"date":a.t="d",a.v=Z(v["date-value"]),h.cellDates||(a.t="n",a.v=H(a.v)),a.z="m/d/yy";break;case"time":a.t="n",a.v=J(v["time-value"])/86400;break;case"number":a.t="n",a.v=parseFloat(v.);break;default:if("string"!==a.t&&"text"!==a.t&&a.t)throw new Error("Unsupported value type "+a.t);a.t="s",null!=v["string-value"]&&(y=we(v["string-value"]),x=[])}}else{if(G=!1,"s"===a.t&&(a.v=y||"",x.length&&(a.R=x),G=0==b),P.Target&&(a.l=P),F.length>0&&(a.c=F,F=[]),y&&!1!==h.cellText&&(a.w=y),G&&(a.t="z",delete a.v),(!G||h.sheetStubs)&&!(h.sheetRows&&h.sheetRows<=S))for(var X=0;X<D;++X){if(I=parseInt(v["number-columns-repeated"]||"1",10),h.dense)for(g[S+X]||(g[S+X]=[]),g[S+X][T]=0==X?a:te(a);--I>0;)g[S+X][T+I]=te(a);else for(g[Kt({r:S+X,c:T})]=a;--I>0;)g[Kt({r:S+X,c:T+I})]=te(a);E.e.c<=T&&(E.e.c=T)}T+=(I=parseInt(v["number-columns-repeated"]||"1",10))-1,I=0,a={},y="",x=[]}P={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===o[1]){if((r=c.pop())[0]!==o[3])throw"Bad state: "+r}else"/"!==o[0].charAt(o[0].length-2)&&c.push([o[3],!0]);break;case"annotation":if("/"===o[1]){if((r=c.pop())[0]!==o[3])throw"Bad state: "+r;L.t=y,x.length&&(L.R=x),L.a=B,F.push(L)}else"/"!==o[0].charAt(o[0].length-2)&&c.push([o[3],!1]);B="",U=0,y="",b=0,x=[];break;case"creator":"/"===o[1]?B=u.slice(U,o.index):U=o.index+o[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===o[1]){if((r=c.pop())[0]!==o[3])throw"Bad state: "+r}else"/"!==o[0].charAt(o[0].length-2)&&c.push([o[3],!1]);y="",b=0,x=[];break;case"scientific-number":case"currency-symbol":case"currency-style":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"fraction":case"boolean-style":case"boolean":case"text-style":case"text-content":case"text-properties":case"embedded-text":case"body":case"":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===o[1]){if(w[d.name]=f,(r=c.pop())[0]!==o[3])throw"Bad state: "+r}else"/"!==o[0].charAt(o[0].length-2)&&(f="",d=be(o[0],!1),c.push([o[3],!0]));break;case"number":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(c[c.length-1][0]){case"time-style":case"date-style":n=be(o[0],!1),f+=ql[o[3]]["long"===n.style?1:0]}break;case"text":if("/>"===o[0].slice(-2))break;if("/"===o[1])switch(c[c.length-1][0]){case"number-style":case"date-style":case"time-style":f+=u.slice(p,o.index)}else p=o.index+o[0].length;break;case"named-range":k=ra((n=be(o[0],!1))["cell-range-address"]);var W={Name:n.name,Ref:k[0]+"!"+k[1]};j&&(W.Sheet=_.length),N.Names.push(W);break;case"p":case"":if(["master-styles"].indexOf(c[c.length-1][0])>-1)break;if("/"!==o[1]||v&&v["string-value"])be(o[0],!1),b=o.index+o[0].length;else{var q=(l=void 0,l=u.slice(b,o.index).replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,(function(e,t){return Array(parseInt(t,10)+1).join(" ")})).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n"),[we(l.replace(/<[^>]*>/g,""))]);y=(y.length>0?y+"\n":"")+q[0]}break;case"database-range":if("/"===o[1])break;try{m[(k=ra(be(o[0])["target-range-address"]))[0]]["!autofilter"]={ref:k[1]}}catch(e){}break;case"a":if("/"!==o[1]){if(!(P=be(o[0],!1)).href)break;P.Target=P.href,delete P.href,"#"==P.Target.charAt(0)&&P.Target.indexOf(".")>-1&&(k=ra(P.Target.slice(1)),P.Target="#"+k[0]+"!"+k[1])}break;default:switch(o[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(h.WTF)throw new Error(o)}}var Y={Sheets:m,SheetNames:_,Workbook:N};return h.bookSheets&&delete Y.Sheets,Y});function Jl(e,t){return Yl(e,t)}var Kl,$l,Ql=function(){var e="<office:document-styles "+$e({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+"></office:document-styles>";return function(){return me+e}}(),Zl=(Kl="          <table:table-cell />\n",$l=function(e,t,r){var n=[];n.push('      <table:table table:name="'+Re(t.SheetNames[r])+'" table:style-name="ta1">\n');var i=0,s=0,o=$t(e["!ref"]),a=e["!merges"]||[],l=0,h=Array.isArray(e);for(i=0;i<o.s.r;++i)n.push("        <table:table-row></table:table-row>\n");for(;i<=o.e.r;++i){for(n.push("        <table:table-row>\n"),s=0;s<o.s.c;++s)n.push(Kl);for(;s<=o.e.c;++s){var u=!1,c={},d="";for(l=0;l!=a.length;++l)if(!(a[l].s.c>s||a[l].s.r>i||a[l].e.c<s||a[l].e.r<i)){(a[l].s.c!=s||a[l].s.r!=i)&&(u=!0),c["table:number-columns-spanned"]=a[l].e.c-a[l].s.c+1,c["table:number-rows-spanned"]=a[l].e.r-a[l].s.r+1;break}if(u)n.push("          <table:covered-table-cell/>\n");else{var f=Kt({r:i,c:s}),p=h?(e[i]||[])[s]:e[f];if(p&&p.f&&(c["table:formula"]=Re(("of:="+p.f.replace(no,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")),p.F&&p.F.slice(0,f.length)==f)){var m=$t(p.F);c["table:number-matrix-columns-spanned"]=m.e.c-m.s.c+1,c["table:number-matrix-rows-spanned"]=m.e.r-m.s.r+1}if(p){switch(p.t){case"b":d=p.v?"TRUE":"FALSE",c["office:value-type"]="boolean",c["office:boolean-value"]=p.v?"true":"false";break;case"n":d=p.w||String(p.v||0),c["office:value-type"]="float",c["office:value"]=p.v||0;break;case"s":case"str":d=null==p.v?"":p.v,c["office:value-type"]="string";break;case"d":d=p.w||Z(p.v).toISOString(),c["office:value-type"]="date",c["office:date-value"]=Z(p.v).toISOString(),c["table:style-name"]="ce1";break;default:n.push(Kl);continue}var _=Re(d).replace(/  +/g,(function(e){return'<text:s text:c="'+e.length+'"/>'})).replace(/\t/g,"<text:tab/>").replace(/\n/g,"<text:line-break/>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>");if(p.l&&p.l.Target){var g=p.l.Target;_=Qe("text:a",_,{"xlink:href":g="#"==g.charAt(0)?"#"+g.slice(1).replace(/\./,"!"):g})}n.push("          "+Qe("table:table-cell",Qe("text:p",_,{}),c)+"\n")}else n.push(Kl)}}n.push("        </table:table-row>\n")}return n.push("      </table:table>\n"),n.join("")},function(e,t){var r=[me],n=$e({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),i=$e({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==t.bookType?r.push("<office:document"+n+i+">\n"):r.push("<office:document-content"+n+">\n"),function(e){e.push(" <office:automatic-styles>\n"),e.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),e.push('   <number:month number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push('   <number:day number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push("   <number:year/>\n"),e.push("  </number:date-style>\n"),e.push('  <style:style style:name="ta1" style:family="table">\n'),e.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),e.push("  </style:style>\n"),e.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),e.push(" </office:automatic-styles>\n")}(r),r.push("  <office:body>\n"),r.push("    <office:spreadsheet>\n");for(var s=0;s!=e.SheetNames.length;++s)r.push($l(e.Sheets[e.SheetNames[s]],e,s));return r.push("    </office:spreadsheet>\n"),r.push("  </office:body>\n"),"fods"==t.bookType?r.push("</office:document>"):r.push("</office:document-content>"),r.join("")});function eh(e,t){if("fods"==t.bookType)return Zl(e,t);var r=fe(),n="",i=[],s=[];return de(r,n="mimetype","application/vnd.oasis.opendocument.spreadsheet"),de(r,n="content.xml",Zl(e,t)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),de(r,n="styles.xml",Ql(e,t)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),de(r,n="meta.xml",tn()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),de(r,n="manifest.rdf",function(e){var t=[me];t.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var r=0;r!=e.length;++r)t.push(Zr(e[r][0],e[r][1])),t.push(("",['  <rdf:Description rdf:about="">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e[r][0]+'"/>\n',"  </rdf:Description>\n"].join("")));return t.push(Zr("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}(s)),i.push([n,"application/rdf+xml"]),de(r,n="META-INF/manifest.xml",function(e){var t=[me];t.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),t.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+'"/>\n');return t.push("</manifest:manifest>"),t.join("")}(i)),r}function th(e){return function(t,r){var n=function(e,t){if(!t)return 0;var r=e.SheetNames.indexOf(t);if(-1==r)throw new Error("Sheet not found: "+t);return r}(t,r.sheet);return e.from_sheet(t.Sheets[t.SheetNames[n]],r,t)}}var rh=th(zl),nh=th({from_sheet:Ph}),ih=th(void 0!==Ri?Ri:{}),sh=th(void 0!==Di?Di:{}),oh=th(void 0!==Mi?Mi:{}),ah=th(void 0!==as?as:{}),lh=th({from_sheet:kh}),hh=th(void 0!==Oi?Oi:{}),uh=th(void 0!==Ii?Ii:{});function ch(e){return function(t){for(var r=0;r!=e.length;++r){var n=e[r];void 0===t[n[0]]&&(t[n[0]]=n[1]),"n"===n[2]&&(t[n[0]]=Number(t[n[0]]))}}}var dh=function(e){ch([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)},fh=ch([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]]);function ph(e,t,r,n,i,s,o,a,l,h,u,c){try{s[n]=Yr(ce(e,r,!0),t);var d,f=ue(e,t);switch(a){case"sheet":d=il(f,t,i,l,s[n],h,u,c);break;case"chart":if(!(d=function(e,t,r,n,i,s,o,a){return".bin"===t.slice(-4)?function(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=[],a=!1;return Bt(e,(function(e,n,l){switch(l){case 550:s["!rel"]=e;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),e.name&&(i.Sheets[r].CodeName=e.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:o.push(n);break;case 38:o.pop();break;default:if((n||"").indexOf("Begin")>0)o.push(n);else if((n||"").indexOf("End")>0)o.pop();else if(!a||t.WTF)throw new Error("Unexpected record "+l+" "+n)}}),t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}(e,n,r,i,s):function(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s,o={"!type":"chart","!drawel":null,"!rel":""},a=e.match(ya);return a&&xa(a[0],0,i,r),(s=e.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=s[1]),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}(e,0,r,i,s)}(f,t,i,l,s[n],h))||!d["!drawel"])break;var p=pe(d["!drawel"].Target,t),m=qr(p),_=function(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}(ce(e,p,!0),Yr(ce(e,m,!0),p)),g=pe(_,p),v=qr(g);d=function(e,t,r,n,i,s){var o=s||{"!type":"chart"};if(!e)return s;var a=0,l=0,h="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach((function(e){var t=function(e){var t,r=[],n=e.match(/^<c:numCache>/);(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach((function(e){var t=e.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);!t||(r[+t[1]]=n?+t[2]:t[2])}));var i=we((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach((function(e){t=e.replace(/<.*?>/g,"")})),[r,i,t]}(e);u.s.r=u.s.c=0,u.e.c=a,h=Yt(a),t[0].forEach((function(e,r){o[h+Wt(r)]={t:"n",v:e,z:t[1]},l=r})),u.e.r<l&&(u.e.r=l),++a})),a>0&&(o["!ref"]=Qt(u)),o}(ce(e,g,!0),0,0,Yr(ce(e,v,!0),g),0,d);break;case"macro":d=function(e,t,r,n,i,s,o,a){return t.slice(-4),{"!type":"macro"}}(0,t,0,0,s[n]);break;case"dialog":d=function(e,t,r,n,i,s,o,a){return t.slice(-4),{"!type":"dialog"}}(0,t,0,0,s[n]);break;default:throw new Error("Unrecognized sheet type "+a)}o[n]=d;var y=[];s&&s[n]&&U(s[n]).forEach((function(r){if(s[n][r].Type==Wr.CMNT){var i=pe(s[n][r].Target,t);if(!(y=function(e,t,r){return".bin"===t.slice(-4)?function(e,t){var r=[],n=[],i={},s=!1;return Bt(e,(function(e,o,a){switch(a){case 632:n.push(e);break;case 635:i=e;break;case 637:i.t=e.t,i.h=e.h,i.r=e.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:case 37:case 38:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!((o||"").indexOf("Begin")>0)&&!((o||"").indexOf("End")>0)&&(!s||t.WTF))throw new Error("Unexpected record "+a+" "+o)}})),r}(e,r):function(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach((function(e){if(""!==e&&""!==e.trim()){var t=e.match(/<(?:\w+:)?author[^>]*>(.*)/);t&&r.push(t[1])}}));var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach((function(e){if(""!==e&&""!==e.trim()){var i=e.match(/<(?:\w+:)?comment[^>]*>/);if(i){var s=be(i[0]),o={author:s.authorId&&r[s.authorId]||"sheetjsghost",ref:s.ref,guid:s.guid},a=Jt(s.ref);if(!(t.sheetRows&&t.sheetRows<=a.r)){var l=e.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!l&&!!l[1]&&Ui(l[1])||{r:"",t:"",h:""};o.r=h.r,"<t></t>"==h.r&&(h.t=h.h=""),o.t=h.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),t.cellHTML&&(o.h=h.h),n.push(o)}}}})),n}(e,r)}(ue(e,i,!0),i,l))||!y.length)return;!function(e,t){var r,n=Array.isArray(e);t.forEach((function(t){var i=Jt(t.ref);if(n?(e[i.r]||(e[i.r]=[]),r=e[i.r][i.c]):r=e[t.ref],!r){r={t:"z"},n?e[i.r][i.c]=r:e[t.ref]=r;var s=Zt(e["!ref"]||"BDWGO1000001:A1");s.s.r>i.r&&(s.s.r=i.r),s.e.r<i.r&&(s.e.r=i.r),s.s.c>i.c&&(s.s.c=i.c),s.e.c<i.c&&(s.e.c=i.c);var o=Qt(s);o!==e["!ref"]&&(e["!ref"]=o)}r.c||(r.c=[]);var a={a:t.author,t:t.t,r:t.r};t.h&&(a.h=t.h),r.c.push(a)}))}(d,y)}}))}catch(e){if(l.WTF)throw e}}function mh(e){return"/"==e.charAt(0)?e.slice(1):e}function _h(e,t){if(D(R),dh(t=t||{}),le(e,"META-INF/manifest.xml")||le(e,"objectdata.xml"))return function(e,t){t=t||{};var r=!!le(e,"objectdata");r&&function(e,t){for(var r,n,i=gl(e);r=vl.exec(i);)switch(r[3]){case"manifest":break;case"file-entry":if("/"==(n=be(r[0],!1)).path&&"application/vnd.oasis.opendocument.spreadsheet"!==n.type)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw r}}(ue(e,"META-INF/manifest.xml"),t);var n=ce(e,"content.xml");if(!n)throw new Error("Missing content.xml in "+(r?"ODS":"UOF")+" file");var i=Yl(r?n:ke(n),t);return le(e,"meta.xml")&&(i.Props=sn(ue(e,"meta.xml"))),i}(e,t);if(le(e,"Index/Document.iwa"))throw new Error("Unsupported NUMBERS file");var r,n,i=function(e){for(var t=e.FullPaths||U(e.files),r=[],n=0;n<t.length;++n)"/"!=t[n].slice(-1)&&r.push(t[n]);return r.sort()}(e),s=function(e){var t={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],TODO:[],xmlns:""};if(!e||!e.match)return t;var r={};if((e.match(ge)||[]).forEach((function(e){var n=be(e);switch(n[0].replace(ve,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":void 0!==t[jr[n.ContentType]]&&t[jr[n.ContentType]].push(n.PartName)}})),t.xmlns!==rt.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}(ce(e,"[Content_Types].xml")),o=!1;if(0===s.workbooks.length&&ue(e,n="xl/workbook.xml",!0)&&s.workbooks.push(n),0===s.workbooks.length){if(!ue(e,n="xl/workbook.bin",!0))throw new Error("Could not find workbook");s.workbooks.push(n),o=!0}"bin"==s.workbooks[0].slice(-3)&&(o=!0);var a={},l={};if(!t.bookSheets&&!t.bookProps){if(na=[],s.sst)try{na=function(e,t,r){return".bin"===t.slice(-4)?function(e,t){var r=[],n=!1;return Bt(e,(function(e,i,s){switch(s){case 159:r.Count=e[0],r.Unique=e[1];break;case 19:r.push(e);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.indexOf("Begin")>0||i.indexOf("End"),!n||t.WTF)throw new Error("Unexpected record "+s+" "+i)}})),r}(e,r):function(e,t){var r=[],n="";if(!e)return r;var i=e.match(Gi);if(i){n=i[2].replace(ji,"").split(Vi);for(var s=0;s!=n.length;++s){var o=Ui(n[s].trim(),t);null!=o&&(r[r.length]=o)}i=be(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}(e,r)}(ue(e,mh(s.sst)),s.sst,t)}catch(e){if(t.WTF)throw e}t.cellStyles&&s.themes.length&&(a=function(e,t,r){return Ws(e,r)}(ce(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(l=function(e,t,r,n){return".bin"===t.slice(-4)?function(e,t,r){var n={NumberFmt:[]};for(var i in R._table)n.NumberFmt[i]=R._table[i];n.CellXf=[],n.Fonts=[];var s=[],o=!1;return Bt(e,(function(e,i,a){switch(a){case 44:n.NumberFmt[e[0]]=e[1],R.load(e[1],e[0]);break;case 43:n.Fonts.push(e),null!=e.color.theme&&t&&t.themeElements&&t.themeElements.clrScheme&&(e.color.rgb=hs(t.themeElements.clrScheme[e.color.theme].rgb,e.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:"BrtBeginCellXFs"==s[s.length-1]&&n.CellXf.push(e);break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(i),o=!0;break;case 38:s.pop(),o=!1;break;default:if((i||"").indexOf("Begin")>0)s.push(i);else if((i||"").indexOf("End")>0)s.pop();else if(!o||r.WTF&&"BrtACBegin"!=s[s.length-1])throw new Error("Unexpected record "+a+" "+i)}})),n}(e,r,n):Cs(e,r,n)}(ue(e,mh(s.style)),s.style,a,t))}s.links.map((function(r){try{return Yr(ce(e,qr(mh(r))),r),function(e,t,r,n){return".bin"===r.slice(-4)?function(e,t,r,n){if(!e)return e;var i=n||{},s=!1;Bt(e,(function(e,t,r){switch(r){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!((t||"").indexOf("Begin")>0)&&!((t||"").indexOf("End")>0)&&(!s||i.WTF))throw new Error("Unexpected record "+r.toString(16)+" "+t)}}),i)}(e,0,0,n):void 0}(ue(e,mh(r)),0,r,t)}catch(e){}}));var h=function(e,t,r){return".bin"===t.slice(-4)?function(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],Bt(e,(function(e,a,l){switch(l){case 156:o.SheetNames.push(e.name),r.Sheets.push(e);break;case 153:r.WBProps=e;break;case 39:null!=e.Sheet&&(t.SID=e.Sheet),e.Ref=Vo(e.Ptg,0,null,o,t),delete t.SID,delete e.Ptg,s.push(e);break;case 1036:case 361:case 3072:case 3073:case 2071:case 534:case 677:case 158:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:o[0].length?o.push([l,e]):o[0]=[l,e],o[o.length-1].XTI=[];break;case 362:0===o.length&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(e),o.XTI=o.XTI.concat(e);break;case 35:case 37:n.push(a),i=!0;break;case 36:case 38:n.pop(),i=!1;break;default:if(!((a||"").indexOf("Begin")>0)&&!((a||"").indexOf("End")>0)&&(!i||t.WTF&&"BrtACBegin"!=n[n.length-1]&&"BrtFRTBegin"!=n[n.length-1]))throw new Error("Unexpected record "+l+" "+a)}}),t),Ka(r),r.Names=s,r.supbooks=o,r}(e,r):function(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},o=0;if(e.replace(ge,(function(a,l){var h=be(a);switch(xe(h[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":a.match(Za)&&(i="xmlns"+a.match(/<(\w+):/)[1]),r.xmlns=h[i];break;case"<fileVersion":delete h[0],r.AppVersion=h;break;case"<workbookPr":case"<workbookPr/>":Ha.forEach((function(e){if(null!=h[e[0]])switch(e[2]){case"bool":r.WBProps[e[0]]=Pe(h[e[0]]);break;case"int":r.WBProps[e[0]]=parseInt(h[e[0]],10);break;default:r.WBProps[e[0]]=h[e[0]]}})),h.codeName&&(r.WBProps.CodeName=ke(h.codeName));break;case"<workbookView":case"<workbookView/>":delete h[0],r.WBView.push(h);break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=we(ke(h.name)),delete h[0],r.Sheets.push(h);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":n=!1;break;case"<definedName":(s={}).Name=ke(h.name),h.comment&&(s.Comment=h.comment),h.localSheetId&&(s.Sheet=+h.localSheetId),Pe(h.hidden||"0")&&(s.Hidden=!0),o=l+a.length;break;case"</definedName>":s.Ref=we(ke(e.slice(o,l))),r.Names.push(s);break;case"<calcPr":case"<calcPr/>":delete h[0],r.CalcPr=h;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return a})),-1===rt.main.indexOf(r.xmlns))throw new Error("Unknown Namespace: "+r.xmlns);return Ka(r),r}(e,r)}(ue(e,mh(s.workbooks[0])),s.workbooks[0],t),u={},c="";s.coreprops.length&&((c=ue(e,mh(s.coreprops[0]),!0))&&(u=sn(c)),0!==s.extprops.length&&(c=ue(e,mh(s.extprops[0]),!0))&&function(e,t,r){var n={};t||(t={}),e=ke(e),ln.forEach((function(r){var i=(e.match(ze(r[0]))||[])[1];switch(r[2]){case"string":i&&(t[r[1]]=we(i));break;case"bool":t[r[1]]="true"===i;break;case"raw":var s=e.match(new RegExp("<"+r[0]+"[^>]*>([\\s\\S]*?)</"+r[0]+">"));s&&s.length>0&&(n[r[1]]=s[1])}})),n.HeadingPairs&&n.TitlesOfParts&&hn(n.HeadingPairs,n.TitlesOfParts,t,r)}(c,u,t));var d={};(!t.bookSheets||t.bookProps)&&0!==s.custprops.length&&(c=ce(e,mh(s.custprops[0]),!0))&&(d=function(e,t){var r={},n="",i=e.match(cn);if(i)for(var s=0;s!=i.length;++s){var o=i[s],a=be(o);switch(a[0]){case"<?xml":case"<Properties":break;case"<property":n=we(a.name);break;case"</property>":n=null;break;default:if(0===o.indexOf("<vt:")){var l=o.split(">"),h=l[0].slice(4),u=l[1];switch(h){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":r[n]=we(u);break;case"bool":r[n]=Pe(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=Z(u);break;default:if("/"==h.slice(-1))break;t.WTF&&"undefined"!=typeof console&&console.warn("Unexpected",o,h,l)}}else if("</"!==o.slice(0,2)&&t.WTF)throw new Error(o)}}return r}(c,t));var f={};if((t.bookSheets||t.bookProps)&&(h.Sheets?r=h.Sheets.map((function(e){return e.name})):u.Worksheets&&u.SheetNames.length>0&&(r=u.SheetNames),t.bookProps&&(f.Props=u,f.Custprops=d),t.bookSheets&&void 0!==r&&(f.SheetNames=r),t.bookSheets?f.SheetNames:t.bookProps))return f;r={};var p={};t.bookDeps&&s.calcchain&&(p=function(e,t,r){return".bin"===t.slice(-4)?function(e,t,r){var n=[];return Bt(e,(function(e,t,r){if(63===r)n.push(e);else if(!((t||"").indexOf("Begin")>0||(t||"").indexOf("End")>0))throw new Error("Unexpected record "+r+" "+t)})),n}(e):function(e){var t=[];if(!e)return t;var r=1;return(e.match(ge)||[]).forEach((function(e){var n=be(e);switch(n[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n)}})),t}(e)}(ue(e,mh(s.calcchain)),s.calcchain));var m,_,g=0,v={},y=h.Sheets;u.Worksheets=y.length,u.SheetNames=[];for(var b=0;b!=y.length;++b)u.SheetNames[b]=y[b].name;var x=o?"bin":"xml",S=s.workbooks[0].lastIndexOf("/"),T=(s.workbooks[0].slice(0,S+1)+"_rels/"+s.workbooks[0].slice(S+1)+".rels").replace(/^\//,"");le(e,T)||(T="xl/_rels/workbook."+x+".rels");var E=Yr(ce(e,T,!0),T);E&&(E=function(e,t){if(!e)return 0;try{e=t.map((function(t){return t.id||(t.id=t.strRelID),[t.name,e["!id"][t.id].Target,(r=e["!id"][t.id].Type,Wr.WS.indexOf(r)>-1?"sheet":Wr.CS&&r==Wr.CS?"chart":Wr.DS&&r==Wr.DS?"dialog":Wr.MS&&r==Wr.MS?"macro":r&&r.length?r:"sheet")];var r}))}catch(e){return null}return e&&0!==e.length?e:null}(E,h.Sheets));var A=ue(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=u.Worksheets;++g){var w="sheet";if(E&&E[g]?(m="xl/"+E[g][1].replace(/[\/]?xl\//,""),le(e,m)||(m=E[g][1]),le(e,m)||(m=T.replace(/_rels\/.*$/,"")+E[g][1]),w=E[g][2]):m=(m="xl/worksheets/sheet"+(g+1-A)+"."+x).replace(/sheet0\./,"sheet."),_=m.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&null!=t.sheets)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(u.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var C=!1,O=0;O!=t.sheets.length;++O)"number"==typeof t.sheets[O]&&t.sheets[O]==g&&(C=1),"string"==typeof t.sheets[O]&&t.sheets[O].toLowerCase()==u.SheetNames[g].toLowerCase()&&(C=1);if(!C)continue e}}ph(e,m,_,u.SheetNames[g],g,v,r,w,t,h,a,l)}return f={Directory:s,Workbook:h,Props:u,Custprops:d,Deps:p,Sheets:r,SheetNames:u.SheetNames,Strings:na,Styles:l,Themes:a,SSF:R.get_table()},t&&t.bookFiles&&(f.keys=i,f.files=e.files),t&&t.bookVBA&&(s.vba.length>0?f.vbaraw=ue(e,mh(s.vba[0]),!0):s.defaults&&"application/vnd.ms-office.vbaProject"===s.defaults.bin&&(f.vbaraw=ue(e,"xl/vbaProject.bin",!0))),f}function gh(e,t){var r=t||{},n="Workbook",i=F.find(e,n);try{if(n="/!DataSpaces/Version",!(i=F.find(e,n))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(function(e){var t={};t.id=e.read_shift(0,"lpp4"),t.R=Yi(e,4),t.U=Yi(e,4),t.W=Yi(e,4)}(i.content),n="/!DataSpaces/DataSpaceMap",!(i=F.find(e,n))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=function(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(Ji(e));return t}(i.content);if(1!==s.length||1!==s[0].comps.length||0!==s[0].comps[0].t||"StrongEncryptionDataSpace"!==s[0].name||"EncryptedPackage"!==s[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(i=F.find(e,n))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=function(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}(i.content);if(1!=o.length||"StrongEncryptionTransform"!=o[0])throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(i=F.find(e,n))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);!function(e){var t=function(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Yi(e,4),t.U=Yi(e,4),t.W=Yi(e,4),t}(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),4!=e.read_shift(4))throw new Error("Bad !Primary record")}(i.content)}catch(e){}if(n="/EncryptionInfo",!(i=F.find(e,n))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=function(e){var t=Yi(e);switch(t.Minor){case 2:return[t.Minor,Qi(e)];case 3:return[t.Minor,Zi()];case 4:return[t.Minor,es(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}(i.content);if(n="/EncryptedPackage",!(i=F.find(e,n))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(4==a[0]&&"undefined"!=typeof decrypt_agile)return decrypt_agile(a[1],i.content,r.password||"",r);if(2==a[0]&&"undefined"!=typeof decrypt_std76)return decrypt_std76(a[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function vh(e,t){if(Js=1024,"ods"==t.bookType)return eh(e,t);e&&!e.SSF&&(e.SSF=R.get_table()),e&&e.SSF&&(D(R),R.load_table(e.SSF),t.revssf=V(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,sa?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xlsb"==t.bookType?"bin":"xml",n=to.indexOf(t.bookType)>-1,i={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],TODO:[],xmlns:""};fh(t=t||{});var s=fe(),o="",a=0;if(t.cellXfs=[],ha(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),de(s,o="docProps/core.xml",function(e,t){var r=t||{},n=[me,on],i={};if(!e&&!r.Props)return n.join("");e&&(null!=e.CreatedDate&&an("dcterms:created","string"==typeof e.CreatedDate?e.CreatedDate:Ze(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),null!=e.ModifiedDate&&an("dcterms:modified","string"==typeof e.ModifiedDate?e.ModifiedDate:Ze(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=rn.length;++s){var o=rn[s],a=r.Props&&null!=r.Props[o[1]]?r.Props[o[1]]:e?e[o[1]]:null;!0===a?a="1":!1===a?a="0":"number"==typeof a&&(a=String(a)),null!=a&&an(o[0],a,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}(e.Props,t)),i.coreprops.push(o),Qr(t.rels,2,o,Wr.CORE_PROPS),o="docProps/app.xml",!e.Props||!e.Props.SheetNames)if(e.Workbook&&e.Workbook.Sheets){for(var l=[],h=0;h<e.SheetNames.length;++h)2!=(e.Workbook.Sheets[h]||{}).Hidden&&l.push(e.SheetNames[h]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;for(e.Props.Worksheets=e.Props.SheetNames.length,de(s,o,function(e){var t=[],r=Qe;return e||(e={}),e.Application="SheetJS",t[t.length]=me,t[t.length]=un,ln.forEach((function(n){if(void 0!==e[n[1]]){var i;switch(n[2]){case"string":i=Re(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false"}void 0!==i&&(t[t.length]=r(n[0],i))}})),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map((function(e){return"<vt:lpstr>"+Re(e)+"</vt:lpstr>"})).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}(e.Props)),i.extprops.push(o),Qr(t.rels,3,o,Wr.EXT_PROPS),e.Custprops!==e.Props&&U(e.Custprops||{}).length>0&&(de(s,o="docProps/custom.xml",function(e){var t=[me,dn];if(!e)return t.join("");var r=1;return U(e).forEach((function(n){++r,t[t.length]=Qe("property",function(e,t){switch(typeof e){case"string":var r=Qe("vt:lpwstr",Re(e));return r.replace(/&quot;/g,"_x0022_");case"number":return Qe((0|e)==e?"vt:i4":"vt:r8",Re(String(e)));case"boolean":return Qe("vt:bool",e?"true":"false")}if(e instanceof Date)return Qe("vt:filetime",Ze(e));throw new Error("Unable to serialize "+e)}(e[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Re(n)})})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}(e.Custprops)),i.custprops.push(o),Qr(t.rels,4,o,Wr.CUST_PROPS)),a=1;a<=e.SheetNames.length;++a){var u={"!id":{}},c=e.Sheets[e.SheetNames[a-1]];if((c||{})["!type"],de(s,o="xl/worksheets/sheet"+a+"."+r,ol(a-1,o,t,e,u)),i.sheets.push(o),Qr(t.wbrels,-1,"worksheets/sheet"+a+"."+r,Wr.WS[0]),c){var d=c["!comments"],f=!1;if(d&&d.length>0){var p="xl/comments"+a+"."+r;de(s,p,ll(d,p,t)),i.comments.push(p),Qr(u,-1,"../comments"+a+"."+r,Wr.CMNT),f=!0}c["!legacy"]&&f&&de(s,"xl/drawings/vmlDrawing"+a+".vml",Ks(a,c["!comments"])),delete c["!comments"],delete c["!legacy"]}u["!id"].rId1&&de(s,qr(o),Kr(u))}return null!=t.Strings&&t.Strings.length>0&&(de(s,o="xl/sharedStrings."+r,al(t.Strings,o,t)),i.strs.push(o),Qr(t.wbrels,-1,"sharedStrings."+r,Wr.SST)),de(s,o="xl/workbook."+r,sl(e,o,t)),i.workbooks.push(o),Qr(t.rels,1,o,Wr.WB),de(s,o="xl/theme/theme1.xml",qs(e.Themes,t)),i.themes.push(o),Qr(t.wbrels,-1,"theme/theme1.xml",Wr.THEME),de(s,o="xl/styles."+r,function(e,t,r){return(".bin"===t.slice(-4)?Ls:Rs)(e,r)}(e,o,t)),i.styles.push(o),Qr(t.wbrels,-1,"styles."+r,Wr.STY),e.vbaraw&&n&&(de(s,o="xl/vbaProject.bin",e.vbaraw),i.vba.push(o),Qr(t.wbrels,-1,"vbaProject.bin",Wr.VBA)),de(s,"[Content_Types].xml",function(e,t){var r,n=[];n[n.length]=me,n[n.length]=Hr,n=n.concat(Xr);var i=function(i){e[i]&&e[i].length>0&&(r=e[i][0],n[n.length]=Qe("Override",null,{PartName:("/"==r[0]?"":"/")+r,ContentType:Vr[i][t.bookType||"xlsx"]}))},s=function(r){(e[r]||[]).forEach((function(e){n[n.length]=Qe("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:Vr[r][t.bookType||"xlsx"]})}))},o=function(t){(e[t]||[]).forEach((function(e){n[n.length]=Qe("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:zr[t][0]})}))};return i("workbooks"),s("sheets"),s("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("drawings"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}(i,t)),de(s,"_rels/.rels",Kr(t.rels)),de(s,"xl/_rels/workbook."+r+".rels",Kr(t.wbrels)),delete t.revssf,delete t.ssf,s}function yh(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=_.decode(e.slice(0,12));break;case"binary":r=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function bh(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return bl(e.slice(r),t);default:break e}return Mi.to_workbook(e,t)}function xh(e,t,r,n){return n?(r.type="string",Mi.to_workbook(e,r)):Mi.to_workbook(t,r)}function Sh(e,t){if(u(),"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer)return Sh(new Uint8Array(e),t);var r,n=e,i=!1,s=t||{};if(s.cellStyles&&(s.cellNF=!0,s.sheetStubs=!0),ia={},s.dateNF&&(ia.dateNF=s.dateNF),s.type||(s.type=g&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==s.type&&(s.type=g?"buffer":"binary",n=function(e){if(void 0!==k)return k.readFileSync(e);if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(e){if(!e.message||!e.message.match(/onstruct/))throw e}throw new Error("Cannot access file "+e)}(e)),"string"==s.type&&(i=!0,s.type="binary",s.codepage=65001,n=function(e){return e.match(/[^\x00-\x7F]/)?Fe(e):e}(e)),"array"==s.type&&"undefined"!=typeof Uint8Array&&e instanceof Uint8Array&&"undefined"!=typeof ArrayBuffer){var o=new ArrayBuffer(3),a=new Uint8Array(o);if(a.foo="bar",!a.foo)return(s=te(s)).type="array",Sh(A(n),s)}switch((r=yh(n,s))[0]){case 208:if(207===r[1]&&17===r[2]&&224===r[3]&&161===r[4]&&177===r[5]&&26===r[6]&&225===r[7])return function(e,t){return F.find(e,"EncryptedPackage")?gh(e,t):Il(e,t)}(F.read(n,s),s);break;case 9:if(r[1]<=4)return Il(n,s);break;case 60:return bl(n,s);case 73:if(68===r[1])return function(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=Ri.to_workbook(e,r);return r.WTF=n,i}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return Mi.to_workbook(e,t)}}(n,s);break;case 84:if(65===r[1]&&66===r[2]&&76===r[3])return Di.to_workbook(n,s);break;case 80:return 75===r[1]&&r[2]<9&&r[3]<9?function(e,t){var r,n=e,i=t||{};return i.type||(i.type=g&&Buffer.isBuffer(e)?"buffer":"base64"),r=function(e,t){var r;if(se)switch(t.type){case"base64":r=new se(e,{base64:!0});break;case"binary":case"array":r=new se(e,{base64:!1});break;case"buffer":r=new se(e);break;default:throw new Error("Unrecognized type "+t.type)}else switch(t.type){case"base64":r=F.read(e,{type:"base64"});break;case"binary":r=F.read(e,{type:"binary"});break;case"buffer":case"array":r=F.read(e,{type:"buffer"});break;default:throw new Error("Unrecognized type "+t.type)}return r}(n,i),_h(r,i)}(n,s):xh(e,n,s,i);case 239:return 60===r[3]?bl(n,s):xh(e,n,s,i);case 255:if(254===r[1])return function(e,t){var r=e;return"base64"==t.type&&(r=_.decode(r)),r=cptable.utils.decode(1200,r.slice(2),"str"),t.type="binary",bh(r,t)}(n,s);break;case 0:if(0===r[1]&&r[2]>=2&&0===r[3])return Ni.to_workbook(n,s);break;case 3:case 131:case 139:case 140:return Oi.to_workbook(n,s);case 123:if(92===r[1]&&114===r[2]&&116===r[3])return as.to_workbook(n,s);break;case 10:case 13:case 32:return function(e,t){var r="",n=yh(e,t);switch(t.type){case"base64":r=_.decode(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=ee(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==n[0]&&187==n[1]&&191==n[2]&&(r=ke(r)),bh(r,t)}(n,s)}return Oi.versions.indexOf(r[0])>-1&&r[2]<=12&&r[3]<=31?Oi.to_workbook(n,s):xh(e,n,s,i)}function Th(e,t){var r=t||{};return r.type="file",Sh(e,r)}function Eh(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return B(t.file,F.write(e,{type:g?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return F.write(e,t)}function Ah(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return _.encode(Fe(n));case"binary":return Fe(n);case"string":return e;case"file":return B(t.file,n,"utf8");case"buffer":return g?v(n,"utf8"):Ah(n,{type:"binary"}).split("").map((function(e){return e.charCodeAt(0)}))}throw new Error("Unrecognized type "+t.type)}function wh(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return"base64"==t.type?_.encode(r):"string"==t.type?ke(r):r;case"file":return B(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Ch(e,t){u(),function(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t,r,n,i=e.Workbook&&e.Workbook.Sheets||[];t=e.SheetNames,r=i,n=!!e.vbaraw,t.forEach((function(e,i){Qa(e);for(var s=0;s<i;++s)if(e==t[s])throw new Error("Duplicate Sheet Name: "+e);if(n){var o=r&&r[i]&&r[i].CodeName||e;if(95==o.charCodeAt(0)&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}}));for(var s=0;s<e.SheetNames.length;++s)ca(e.Sheets[e.SheetNames[s]],e.SheetNames[s],s)}(e);var r=t||{};if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),"array"==r.type){r.type="binary";var n=Ch(e,r);return r.type="array",T(n)}switch(r.bookType||"xlsb"){case"xml":case"xlml":return Ah(Al(e,r),r);case"slk":case"sylk":return Ah(ih(e,r),r);case"htm":case"html":return Ah(rh(e,r),r);case"txt":return function(e,t){switch(t.type){case"base64":return _.encode(e);case"binary":case"string":return e;case"file":return B(t.file,e,"binary");case"buffer":return g?v(e,"binary"):e.split("").map((function(e){return e.charCodeAt(0)}))}throw new Error("Unrecognized type "+t.type)}(lh(e,r),r);case"csv":return Ah(nh(e,r),r,"\ufeff");case"dif":return Ah(sh(e,r),r);case"dbf":return wh(hh(e,r),r);case"prn":return Ah(oh(e,r),r);case"rtf":return Ah(ah(e,r),r);case"eth":return Ah(uh(e,r),r);case"fods":return Ah(eh(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),wh(Vl(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),function(e,t){var r=t||{};return Eh(function(e,t){var r=t||{},n=F.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return F.utils.cfb_add(n,i,Vl(e,r)),8==r.biff&&(e.Props||e.Custprops)&&function(e,t){var r,n=[],i=[],s=[],o=0;if(e.Props)for(r=U(e.Props),o=0;o<r.length;++o)(Object.prototype.hasOwnProperty.call(Nr,r[o])?n:Object.prototype.hasOwnProperty.call(Pr,r[o])?i:s).push([r[o],e.Props[r[o]]]);if(e.Custprops)for(r=U(e.Custprops),o=0;o<r.length;++o)Object.prototype.hasOwnProperty.call(e.Props||{},r[o])||(Object.prototype.hasOwnProperty.call(Nr,r[o])?n:Object.prototype.hasOwnProperty.call(Pr,r[o])?i:s).push([r[o],e.Custprops[r[o]]]);var a=[];for(o=0;o<s.length;++o)Cn.indexOf(s[o][0])>-1||null!=s[o][1]&&a.push(s[o]);i.length&&F.utils.cfb_add(t,"/SummaryInformation",In(i,Rl,Pr,Dr)),(n.length||a.length)&&F.utils.cfb_add(t,"/DocumentSummaryInformation",In(n,Dl,Nr,Rr,a.length?a:null,"05d5cdd59c2e1b10939708002b2cf9ae"))}(e,n),8==r.biff&&e.vbaraw&&function(e,t){t.FullPaths.forEach((function(r,n){if(0!=n){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==i.slice(-1)&&F.utils.cfb_add(e,i,t.FileIndex[n].content)}}))}(n,F.read(e.vbaraw,{type:"string"==typeof e.vbaraw?"binary":"buffer"})),n}(e,r),r)}(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"ods":return function(e,t){var r=t||{},n=vh(e,r),i={};if(r.compression&&(i.compression="DEFLATE"),r.password)i.type=g?"nodebuffer":"string";else switch(r.type){case"base64":i.type="base64";break;case"binary":i.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":case"file":i.type=g?"nodebuffer":"string";break;default:throw new Error("Unrecognized type "+r.type)}var s=n.FullPaths?F.write(n,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[i.type]||i.type}):n.generate(i);return r.password&&"undefined"!=typeof encrypt_agile?Eh(encrypt_agile(s,r.password),r):"file"===r.type?B(r.file,s):"string"==r.type?ke(s):s}(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Oh(e){if(!e.bookType){var t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[e.bookType]||e.bookType}}function Rh(e,t,r){var n=r||{};return n.type="file",n.file=t,Oh(n),Ch(e,n)}function Dh(e,t,r,n,i,s,o,a){var l=Wt(r),h=a.defval,u=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),c=!0,d=1===i?[]:{};if(1!==i)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch(e){d.__rowNum__=r}else d.__rowNum__=r;if(!o||e[r])for(var f=t.s.c;f<=t.e.c;++f){var p=o?e[r][f]:e[n[f]+l];if(void 0!==p&&void 0!==p.t){var m=p.v;switch(p.t){case"z":if(null==m)break;continue;case"e":m=void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(null!=s[f]){if(null==m)if(void 0!==h)d[s[f]]=h;else{if(!u||null!==m)continue;d[s[f]]=null}else d[s[f]]=u||a.rawNumbers&&"n"==p.t?m:er(p,m,a);null!=m&&(c=!1)}}else{if(void 0===h)continue;null!=s[f]&&(d[s[f]]=h)}}return{row:d,isempty:c}}function Ih(e,t){if(null==e||null==e["!ref"])return[];var r={t:"n",v:0},n=0,i=1,s=[],o=0,a="",l={s:{r:0,c:0},e:{r:0,c:0}},h=t||{},u=null!=h.range?h.range:e["!ref"];switch(1===h.header?n=1:"A"===h.header?n=2:Array.isArray(h.header)?n=3:null==h.header&&(n=0),typeof u){case"string":l=Zt(u);break;case"number":(l=Zt(e["!ref"])).s.r=u;break;default:l=u}n>0&&(i=0);var c=Wt(l.s.r),d=[],f=[],p=0,m=0,_=Array.isArray(e),g=l.s.r,v=0,y=0;for(_&&!e[g]&&(e[g]=[]),v=l.s.c;v<=l.e.c;++v)switch(d[v]=Yt(v),r=_?e[g][v]:e[d[v]+c],n){case 1:s[v]=v-l.s.c;break;case 2:s[v]=d[v];break;case 3:s[v]=h.header[v-l.s.c];break;default:for(null==r&&(r={w:"__EMPTY",t:"s"}),a=o=er(r,null,h),m=0,y=0;y<s.length;++y)s[y]==a&&(a=o+"_"+ ++m);s[v]=a}for(g=l.s.r+i;g<=l.e.r;++g){var b=Dh(e,l,g,d,n,s,_,h);(!1===b.isempty||(1===n?!1!==h.blankrows:h.blankrows))&&(f[p++]=b.row)}return f.length=p,f}var Mh=/"/g;function Nh(e,t,r,n,i,s,o,a){for(var l=!0,h=[],u="",c=Wt(r),d=t.s.c;d<=t.e.c;++d)if(n[d]){var f=a.dense?(e[r]||[])[d]:e[n[d]+c];if(null==f)u="";else if(null!=f.v){l=!1,u=""+(a.rawNumbers&&"n"==f.t?f.v:er(f,null,a));for(var p=0,m=0;p!==u.length;++p)if((m=u.charCodeAt(p))===i||m===s||34===m||a.forceQuotes){u='"'+u.replace(Mh,'""')+'"';break}"ID"==u&&(u='"ID"')}else null==f.f||f.F?u="":(l=!1,(u="="+f.f).indexOf(",")>=0&&(u='"'+u.replace(Mh,'""')+'"'));h.push(u)}return!1===a.blankrows&&l?null:h.join(o)}function Ph(e,t){var r=[],n=null==t?{}:t;if(null==e||null==e["!ref"])return"";var i=Zt(e["!ref"]),s=void 0!==n.FS?n.FS:",",o=s.charCodeAt(0),a=void 0!==n.RS?n.RS:"\n",l=a.charCodeAt(0),h=new RegExp(("|"==s?"\\|":s)+"+$"),u="",c=[];n.dense=Array.isArray(e);for(var d=n.skipHidden&&e["!cols"]||[],f=n.skipHidden&&e["!rows"]||[],p=i.s.c;p<=i.e.c;++p)(d[p]||{}).hidden||(c[p]=Yt(p));for(var m=i.s.r;m<=i.e.r;++m)(f[m]||{}).hidden||null!=(u=Nh(e,i,m,c,o,l,s,n))&&(n.strip&&(u=u.replace(h,"")),r.push(u+a));return delete n.dense,r.join("")}function kh(e,t){t||(t={}),t.FS="\t",t.RS="\n";var r=Ph(e,t);if("undefined"==typeof cptable||"string"==t.type)return r;var n=cptable.utils.encode(1200,r,"str");return String.fromCharCode(255)+String.fromCharCode(254)+n}function Fh(e){var t,r="",n="";if(null==e||null==e["!ref"])return[];var i,s=Zt(e["!ref"]),o="",a=[],l=[],h=Array.isArray(e);for(i=s.s.c;i<=s.e.c;++i)a[i]=Yt(i);for(var u=s.s.r;u<=s.e.r;++u)for(o=Wt(u),i=s.s.c;i<=s.e.c;++i)if(r=a[i]+o,n="",void 0!==(t=h?(e[u]||[])[i]:e[r])){if(null!=t.F){if(r=t.F,!t.f)continue;n=t.f,-1==r.indexOf(":")&&(r=r+":"+r)}if(null!=t.f)n=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)n=""+t.v;else if("b"==t.t)n=t.v?"TRUE":"FALSE";else if(void 0!==t.w)n="'"+t.w;else{if(void 0===t.v)continue;n="s"==t.t?"'"+t.v:""+t.v}}l[l.length]=r+"="+n}return l}function Lh(e,t,r){var n=r||{},i=+!n.skipHeader,s=e||{},o=0,a=0;if(s&&null!=n.origin)if("number"==typeof n.origin)o=n.origin;else{var l="string"==typeof n.origin?Jt(n.origin):n.origin;o=l.r,a=l.c}var h,u={s:{c:0,r:0},e:{c:a,r:o+t.length-1+i}};if(s["!ref"]){var c=Zt(s["!ref"]);u.e.c=Math.max(u.e.c,c.e.c),u.e.r=Math.max(u.e.r,c.e.r),-1==o&&(o=c.e.r+1,u.e.r=o+t.length-1+i)}else-1==o&&(o=0,u.e.r=t.length-1+i);var d=n.header||[],f=0;t.forEach((function(e,t){U(e).forEach((function(r){-1==(f=d.indexOf(r))&&(d[f=d.length]=r);var l=e[r],u="z",c="",p=Kt({c:a+f,r:o+t+i});h=Uh.sheet_get_cell(s,p),!l||"object"!=typeof l||l instanceof Date?("number"==typeof l?u="n":"boolean"==typeof l?u="b":"string"==typeof l?u="s":l instanceof Date&&(u="d",n.cellDates||(u="n",l=H(l)),c=n.dateNF||R._table[14]),h?(h.t=u,h.v=l,delete h.w,delete h.R,c&&(h.z=c)):s[p]=h={t:u,v:l},c&&(h.z=c)):s[p]=l}))})),u.e.c=Math.max(u.e.c,a+d.length-1);var p=Wt(o);if(i)for(f=0;f<d.length;++f)s[Yt(f+a)+p]={t:"s",v:d[f]};return s["!ref"]=Qt(u),s}var Bh,Uh={encode_col:Yt,encode_row:Wt,encode_cell:Kt,encode_range:Qt,decode_col:qt,decode_row:Xt,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:Jt,decode_range:$t,format_cell:er,get_formulae:Fh,make_csv:Ph,make_json:Ih,make_formulae:Fh,sheet_add_aoa:rr,sheet_add_json:Lh,sheet_add_dom:Hl,aoa_to_sheet:nr,json_to_sheet:function(e,t){return Lh(null,e,t)},table_to_sheet:Xl,table_to_book:function(e,t){return tr(Xl(e,t),t)},sheet_to_csv:Ph,sheet_to_txt:kh,sheet_to_json:Ih,sheet_to_html:zl.from_sheet,sheet_to_formulae:Fh,sheet_to_row_object_array:Ih};(function(e){function t(e,t,r){return null!=e[t]?e[t]:e[t]=r}function r(e,t,n){if("string"==typeof t){if(Array.isArray(e)){var i=Jt(t);return e[i.r]||(e[i.r]=[]),e[i.r][i.c]||(e[i.r][i.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return r(e,Kt("number"!=typeof t?t:{r:t,c:n||0}))}e.consts=e.consts||{},e.sheet_get_cell=r,e.book_new=function(){return{SheetNames:[],Sheets:{}}},e.book_append_sheet=function(e,t,r){if(!r)for(var n=1;n<=65535&&-1!=e.SheetNames.indexOf(r="Sheet"+n);++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(Qa(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");e.SheetNames.push(r),e.Sheets[r]=t},e.book_set_sheet_visibility=function(e,r,n){t(e,"Workbook",{}),t(e.Workbook,"Sheets",[]);var i=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,r);switch(t(e.Workbook.Sheets,i,{}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[i].Hidden=n},[["SHEET_VISIBLE",0],["SHEET_HIDDEN",1],["SHEET_VERY_HIDDEN",2]].forEach((function(t){e.consts[t[0]]=t[1]})),e.cell_set_number_format=function(e,t){return e.z=t,e},e.cell_set_hyperlink=function(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e},e.cell_set_internal_link=function(t,r,n){return e.cell_set_hyperlink(t,"#"+r,n)},e.cell_add_comment=function(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})},e.sheet_set_array_formula=function(e,t,n){for(var i="string"!=typeof t?t:Zt(t),s="string"==typeof t?t:Qt(t),o=i.s.r;o<=i.e.r;++o)for(var a=i.s.c;a<=i.e.c;++a){var l=r(e,o,a);l.t="n",l.F=s,delete l.v,o==i.s.r&&a==i.s.c&&(l.f=n)}return e}})(Uh),g&&void 0!==__require&&(Bh=require_stream().Readable,r.stream={to_json:function(e,t){var r=Bh({objectMode:!0});if(null==e||null==e["!ref"])return r.push(null),r;var n={t:"n",v:0},i=0,s=1,o=[],a=0,l="",h={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},c=null!=u.range?u.range:e["!ref"];switch(1===u.header?i=1:"A"===u.header?i=2:Array.isArray(u.header)&&(i=3),typeof c){case"string":h=Zt(c);break;case"number":(h=Zt(e["!ref"])).s.r=c;break;default:h=c}i>0&&(s=0);var d=Wt(h.s.r),f=[],p=0,m=Array.isArray(e),_=h.s.r,g=0,v=0;for(m&&!e[_]&&(e[_]=[]),g=h.s.c;g<=h.e.c;++g)switch(f[g]=Yt(g),n=m?e[_][g]:e[f[g]+d],i){case 1:o[g]=g-h.s.c;break;case 2:o[g]=f[g];break;case 3:o[g]=u.header[g-h.s.c];break;default:for(null==n&&(n={w:"__EMPTY",t:"s"}),l=a=er(n,null,u),p=0,v=0;v<o.length;++v)o[v]==l&&(l=a+"_"+ ++p);o[g]=l}return _=h.s.r+s,r._read=function(){if(_>h.e.r)return r.push(null);for(;_<=h.e.r;){var t=Dh(e,h,_,f,i,o,m,u);if(++_,!1===t.isempty||(1===i?!1!==u.blankrows:u.blankrows)){r.push(t.row);break}}},r},to_html:function(e,t){var r=Bh(),n=t||{},i=null!=n.header?n.header:zl.BEGIN,s=null!=n.footer?n.footer:zl.END;r.push(i);var o=$t(e["!ref"]);n.dense=Array.isArray(e),r.push(zl._preamble(e,o,n));var a=o.s.r,l=!1;return r._read=function(){if(a>o.e.r)return l||(l=!0,r.push("</table>"+s)),r.push(null);for(;a<=o.e.r;){r.push(zl._row(e,o,a,n)),++a;break}},r},to_csv:function(e,t){var r=Bh(),n=null==t?{}:t;if(null==e||null==e["!ref"])return r.push(null),r;var i=Zt(e["!ref"]),s=void 0!==n.FS?n.FS:",",o=s.charCodeAt(0),a=void 0!==n.RS?n.RS:"\n",l=a.charCodeAt(0),h=new RegExp(("|"==s?"\\|":s)+"+$"),u="",c=[];n.dense=Array.isArray(e);for(var d=n.skipHidden&&e["!cols"]||[],f=n.skipHidden&&e["!rows"]||[],p=i.s.c;p<=i.e.c;++p)(d[p]||{}).hidden||(c[p]=Yt(p));var m=i.s.r,_=!1;return r._read=function(){if(!_)return _=!0,r.push("\ufeff");for(;m<=i.e.r;)if(++m,!(f[m-1]||{}).hidden&&null!=(u=Nh(e,i,m-1,c,o,l,s,n))){n.strip&&(u=u.replace(h,"")),r.push(u+a);break}return m>i.e.r?r.push(null):void 0},r}}),r.parse_xlscfb=Il,r.parse_zip=_h,r.read=Sh,r.readFile=Th,r.readFileSync=Th,r.write=Ch,r.writeFile=Rh,r.writeFileSync=Rh,r.writeFileAsync=function(e,t,r,n){var i=r||{};i.type="file",i.file=e,Oh(i),i.type="buffer";var s=n;return s instanceof Function||(s=r),k.writeFile(e,Ch(t,i),s)},r.utils=Uh,r.SSF=R,void 0!==F&&(r.CFB=F)}void 0!==e?n(e):void 0!==t&&t.exports?n(t.exports):"function"==typeof define&&define.amd?define((function(){return r.version||n(r),r})):n(r)}}),require_arrayWithHoles=__commonJS({"node_modules/@babel/runtime/helpers/arrayWithHoles.js"(e,t){t.exports=function(e){if(Array.isArray(e))return e},t.exports.default=t.exports,t.exports.__esModule=!0}}),require_iterableToArrayLimit=__commonJS({"node_modules/@babel/runtime/helpers/iterableToArrayLimit.js"(e,t){t.exports=function(e,t){var r=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=r){var n,i,s=[],o=!0,a=!1;try{for(r=r.call(e);!(o=(n=r.next()).done)&&(s.push(n.value),!t||s.length!==t);o=!0);}catch(e){a=!0,i=e}finally{try{!o&&null!=r.return&&r.return()}finally{if(a)throw i}}return s}},t.exports.default=t.exports,t.exports.__esModule=!0}}),require_arrayLikeToArray=__commonJS({"node_modules/@babel/runtime/helpers/arrayLikeToArray.js"(e,t){t.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n},t.exports.default=t.exports,t.exports.__esModule=!0}}),require_unsupportedIterableToArray=__commonJS({"node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js"(e,t){var r=require_arrayLikeToArray();t.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}},t.exports.default=t.exports,t.exports.__esModule=!0}}),require_nonIterableRest=__commonJS({"node_modules/@babel/runtime/helpers/nonIterableRest.js"(e,t){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.default=t.exports,t.exports.__esModule=!0}}),require_slicedToArray=__commonJS({"node_modules/@babel/runtime/helpers/slicedToArray.js"(e,t){var r=require_arrayWithHoles(),n=require_iterableToArrayLimit(),i=require_unsupportedIterableToArray(),s=require_nonIterableRest();t.exports=function(e,t){return r(e)||n(e,t)||i(e,t)||s()},t.exports.default=t.exports,t.exports.__esModule=!0}}),require_classCallCheck=__commonJS({"node_modules/@babel/runtime/helpers/classCallCheck.js"(e,t){t.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},t.exports.default=t.exports,t.exports.__esModule=!0}}),require_createClass=__commonJS({"node_modules/@babel/runtime/helpers/createClass.js"(e,t){function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}t.exports=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e},t.exports.default=t.exports,t.exports.__esModule=!0}}),require_bundle=__commonJS({"node_modules/automation-events/build/es5/bundle.js"(e,t){var r,n;r=e,n=function(e,t,r,n){function i(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var s=i(t),o=i(r),a=i(n),l=function(e,t,r){return{endTime:t,insertTime:r,type:"exponentialRampToValue",value:e}},h=function(e,t,r){return{endTime:t,insertTime:r,type:"linearRampToValue",value:e}},u=function(e,t){return{startTime:t,type:"setValue",value:e}},c=function(e,t,r){return{duration:r,startTime:t,type:"setValueCurve",values:e}},d=function(e,t,r){var n=r.startTime,i=r.target,s=r.timeConstant;return i+(t-i)*Math.exp((n-e)/s)},f=function(e){return"exponentialRampToValue"===e.type},p=function(e){return"linearRampToValue"===e.type},m=function(e){return f(e)||p(e)},_=function(e){return"setValue"===e.type},g=function(e){return"setValueCurve"===e.type},v=function e(t,r,n,i){var s=t[r];return void 0===s?i:m(s)||_(s)?s.value:g(s)?s.values[s.values.length-1]:d(n,e(t,r-1,s.startTime,i),s)},y=function(e,t,r,n,i){return void 0===r?[n.insertTime,i]:m(r)?[r.endTime,r.value]:_(r)?[r.startTime,r.value]:g(r)?[r.startTime+r.duration,r.values[r.values.length-1]]:[r.startTime,v(e,t-1,r.startTime,i)]},b=function(e){return"cancelAndHold"===e.type},x=function(e){return"cancelScheduledValues"===e.type},S=function(e){return b(e)||x(e)?e.cancelTime:f(e)||p(e)?e.endTime:e.startTime},T=function(e,t,r,n){var i=n.endTime,s=n.value;return r===s?s:0<r&&0<s||r<0&&s<0?r*Math.pow(s/r,(e-t)/(i-t)):0},E=function(e,t,r,n){return r+(e-t)/(n.endTime-t)*(n.value-r)},A=function(e){return"setTarget"===e.type},w=function(){function e(t){o.default(this,e),this._automationEvents=[],this._currenTime=0,this._defaultValue=t}return a.default(e,[{key:Symbol.iterator,value:function(){return this._automationEvents[Symbol.iterator]()}},{key:"add",value:function(e){var t=S(e);if(b(e)||x(e)){var r=this._automationEvents.findIndex((function(r){return x(e)&&g(r)?r.startTime+r.duration>=t:S(r)>=t})),n=this._automationEvents[r];if(-1!==r&&(this._automationEvents=this._automationEvents.slice(0,r)),b(e)){var i=this._automationEvents[this._automationEvents.length-1];if(void 0!==n&&m(n)){if(A(i))throw new Error("The internal list is malformed.");var s=g(i)?i.startTime+i.duration:S(i),o=g(i)?i.values[i.values.length-1]:i.value,a=f(n)?T(t,s,o,n):E(t,s,o,n),d=f(n)?l(a,t,this._currenTime):h(a,t,this._currenTime);this._automationEvents.push(d)}void 0!==i&&A(i)&&this._automationEvents.push(u(this.getValue(t),t)),void 0!==i&&g(i)&&i.startTime+i.duration>t&&(this._automationEvents[this._automationEvents.length-1]=c(new Float32Array([6,7]),i.startTime,t-i.startTime))}}else{var _=this._automationEvents.findIndex((function(e){return S(e)>t})),v=-1===_?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[_-1];if(void 0!==v&&g(v)&&S(v)+v.duration>t)return!1;var y=f(e)?l(e.value,e.endTime,this._currenTime):p(e)?h(e.value,t,this._currenTime):e;if(-1===_)this._automationEvents.push(y);else{if(g(e)&&t+e.duration>S(this._automationEvents[_]))return!1;this._automationEvents.splice(_,0,y)}}return!0}},{key:"flush",value:function(e){var t=this._automationEvents.findIndex((function(t){return S(t)>e}));if(t>1){var r=this._automationEvents.slice(t-1),n=r[0];A(n)&&r.unshift(u(v(this._automationEvents,t-2,n.startTime,this._defaultValue),n.startTime)),this._automationEvents=r}}},{key:"getValue",value:function(e){if(0===this._automationEvents.length)return this._defaultValue;var t=this._automationEvents.findIndex((function(t){return S(t)>e})),r=this._automationEvents[t],n=(-1===t?this._automationEvents.length:t)-1,i=this._automationEvents[n];if(void 0!==i&&A(i)&&(void 0===r||!m(r)||r.insertTime>e))return d(e,v(this._automationEvents,n-1,i.startTime,this._defaultValue),i);if(void 0!==i&&_(i)&&(void 0===r||!m(r)))return i.value;if(void 0!==i&&g(i)&&(void 0===r||!m(r)||i.startTime+i.duration>e))return e<i.startTime+i.duration?function(e,t){var r=t.duration,n=t.startTime,i=t.values;return function(e,t){var r=Math.floor(t),n=Math.ceil(t);return r===n?e[r]:(1-(t-r))*e[r]+(1-(n-t))*e[n]}(i,(e-n)/r*(i.length-1))}(e,i):i.values[i.values.length-1];if(void 0!==i&&m(i)&&(void 0===r||!m(r)))return i.value;if(void 0!==r&&f(r)){var o=y(this._automationEvents,n,i,r,this._defaultValue),a=s.default(o,2),l=a[0],h=a[1];return T(e,l,h,r)}if(void 0!==r&&p(r)){var u=y(this._automationEvents,n,i,r,this._defaultValue),c=s.default(u,2),b=c[0],x=c[1];return E(e,b,x,r)}return this._defaultValue}}]),e}();e.AutomationEventList=w,e.createCancelAndHoldAutomationEvent=function(e){return{cancelTime:e,type:"cancelAndHold"}},e.createCancelScheduledValuesAutomationEvent=function(e){return{cancelTime:e,type:"cancelScheduledValues"}},e.createExponentialRampToValueAutomationEvent=function(e,t){return{endTime:t,type:"exponentialRampToValue",value:e}},e.createLinearRampToValueAutomationEvent=function(e,t){return{endTime:t,type:"linearRampToValue",value:e}},e.createSetTargetAutomationEvent=function(e,t,r){return{startTime:t,target:e,timeConstant:r,type:"setTarget"}},e.createSetValueAutomationEvent=u,e.createSetValueCurveAutomationEvent=c,Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof e&&void 0!==t?n(e,require_slicedToArray(),require_classCallCheck(),require_createClass()):"function"==typeof define&&define.amd?define(["exports","@babel/runtime/helpers/slicedToArray","@babel/runtime/helpers/classCallCheck","@babel/runtime/helpers/createClass"],n):n((r="undefined"!=typeof globalThis?globalThis:r||self).automationEvents={},r._slicedToArray,r._classCallCheck,r._createClass)}}),require_tslib=__commonJS({"node_modules/tslib/tslib.js"(e,t){var r,n,i,s,o,a,l,h,u,c,d,f,p,m,_,g,v,y,b,x,S,T,E,A;!function(e){var r="object"==typeof global?global:"object"==typeof self?self:"object"==typeof this?this:{};function n(e,t){return e!==r&&("function"==typeof Object.create?Object.defineProperty(e,"__esModule",{value:!0}):e.__esModule=!0),function(r,n){return e[r]=t?t(r,n):n}}"function"==typeof define&&define.amd?define("tslib",["exports"],(function(t){e(n(r,n(t)))})):"object"==typeof t&&"object"==typeof t.exports?e(n(r,n(t.exports))):e(n(r))}((function(e){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])};r=function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)},n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},i=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r},s=function(e,t,r,n){var i,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,r,o):i(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o},o=function(e,t){return function(r,n){t(r,n,e)}},a=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},l=function(e,t,r,n){return new(r||(r=Promise))((function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))},h=function(e,t){var r,n,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},u=function(e,t){for(var r in e)"default"!==r&&!Object.prototype.hasOwnProperty.call(t,r)&&A(t,e,r)},A=Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]},c=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},d=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,s=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o},f=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(d(arguments[t]));return e},p=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var s=arguments[t],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n},m=function(e,t){for(var r=0,n=t.length,i=e.length;r<n;r++,i++)e[i]=t[r];return e},_=function(e){return this instanceof _?(this.v=e,this):new _(e)},g=function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(e){i[e]&&(n[e]=function(t){return new Promise((function(r,n){s.push([e,t,r,n])>1||a(e,t)}))})}function a(e,t){try{(r=i[e](t)).value instanceof _?Promise.resolve(r.value.v).then(l,h):u(s[0][2],r)}catch(e){u(s[0][3],e)}var r}function l(e){a("next",e)}function h(e){a("throw",e)}function u(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}},v=function(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:_(e[n](t)),done:"return"===n}:i?i(t):t}:i}},y=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=c(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,i){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,i,(t=e[r](t)).done,t.value)}))}}},b=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};var w=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};x=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&A(t,e,r);return w(t,e),t},S=function(e){return e&&e.__esModule?e:{default:e}},T=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},E=function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r},e("__extends",r),e("__assign",n),e("__rest",i),e("__decorate",s),e("__param",o),e("__metadata",a),e("__awaiter",l),e("__generator",h),e("__exportStar",u),e("__createBinding",A),e("__values",c),e("__read",d),e("__spread",f),e("__spreadArrays",p),e("__spreadArray",m),e("__await",_),e("__asyncGenerator",g),e("__asyncDelegator",v),e("__asyncValues",y),e("__makeTemplateObject",b),e("__importStar",x),e("__importDefault",S),e("__classPrivateFieldGet",T),e("__classPrivateFieldSet",E)}))}}),require_howler=__commonJS({"node_modules/howler/dist/howler.js"(e){!function(){var t=function(){this.init()};t.prototype={init:function(){var e=this||r;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var t=this||r;if(e=parseFloat(e),t.ctx||u(),void 0!==e&&e>=0&&e<=1){if(t._volume=e,t._muted)return t;t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e,r.ctx.currentTime);for(var n=0;n<t._howls.length;n++)if(!t._howls[n]._webAudio)for(var i=t._howls[n]._getSoundIds(),s=0;s<i.length;s++){var o=t._howls[n]._soundById(i[s]);o&&o._node&&(o._node.volume=o._volume*e)}return t}return t._volume},mute:function(e){var t=this||r;t.ctx||u(),t._muted=e,t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e?0:t._volume,r.ctx.currentTime);for(var n=0;n<t._howls.length;n++)if(!t._howls[n]._webAudio)for(var i=t._howls[n]._getSoundIds(),s=0;s<i.length;s++){var o=t._howls[n]._soundById(i[s]);o&&o._node&&(o._node.muted=!!e||o._muted)}return t},stop:function(){for(var e=this||r,t=0;t<e._howls.length;t++)e._howls[t].stop();return e},unload:function(){for(var e=this||r,t=e._howls.length-1;t>=0;t--)e._howls[t].unload();return e.usingWebAudio&&e.ctx&&void 0!==e.ctx.close&&(e.ctx.close(),e.ctx=null,u()),e},codecs:function(e){return(this||r)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||r;if(e.state=e.ctx&&e.ctx.state||"suspended",e._autoSuspend(),!e.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(e._canPlayEvent="canplay")}catch(t){e.noAudio=!0}else e.noAudio=!0;try{(new Audio).muted&&(e.noAudio=!0)}catch(e){}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||r,t=null;try{t="undefined"!=typeof Audio?new Audio:null}catch(t){return e}if(!t||"function"!=typeof t.canPlayType)return e;var n=t.canPlayType("audio/mpeg;").replace(/^no$/,""),i=e._navigator&&e._navigator.userAgent.match(/OPR\/([0-6].)/g),s=i&&parseInt(i[0].split("/")[1],10)<33;return e._codecs={mp3:!(s||!n&&!t.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!n,opus:!!t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(t.canPlayType('audio/wav; codecs="1"')||t.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!t.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!t.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(t.canPlayType("audio/x-m4b;")||t.canPlayType("audio/m4b;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!t.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(t.canPlayType("audio/x-flac;")||t.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_unlockAudio:function(){var e=this||r;if(!e._audioUnlocked&&e.ctx){e._audioUnlocked=!1,e.autoUnlock=!1,!e._mobileUnloaded&&44100!==e.ctx.sampleRate&&(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var t=function(r){for(;e._html5AudioPool.length<e.html5PoolSize;)try{var n=new Audio;n._unlocked=!0,e._releaseHtml5Audio(n)}catch(t){e.noAudio=!0;break}for(var i=0;i<e._howls.length;i++)if(!e._howls[i]._webAudio)for(var s=e._howls[i]._getSoundIds(),o=0;o<s.length;o++){var a=e._howls[i]._soundById(s[o]);a&&a._node&&!a._node._unlocked&&(a._node._unlocked=!0,a._node.load())}e._autoResume();var l=e.ctx.createBufferSource();l.buffer=e._scratchBuffer,l.connect(e.ctx.destination),void 0===l.start?l.noteOn(0):l.start(0),"function"==typeof e.ctx.resume&&e.ctx.resume(),l.onended=function(){l.disconnect(0),e._audioUnlocked=!0,document.removeEventListener("touchstart",t,!0),document.removeEventListener("touchend",t,!0),document.removeEventListener("click",t,!0);for(var r=0;r<e._howls.length;r++)e._howls[r]._emit("unlock")}};return document.addEventListener("touchstart",t,!0),document.addEventListener("touchend",t,!0),document.addEventListener("click",t,!0),e}},_obtainHtml5Audio:function(){var e=this||r;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var t=(new Audio).play();return t&&"undefined"!=typeof Promise&&(t instanceof Promise||"function"==typeof t.then)&&t.catch((function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")})),new Audio},_releaseHtml5Audio:function(e){var t=this||r;return e._unlocked&&t._html5AudioPool.push(e),t},_autoSuspend:function(){var e=this;if(e.autoSuspend&&e.ctx&&void 0!==e.ctx.suspend&&r.usingWebAudio){for(var t=0;t<e._howls.length;t++)if(e._howls[t]._webAudio)for(var n=0;n<e._howls[t]._sounds.length;n++)if(!e._howls[t]._sounds[n]._paused)return e;return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout((function(){if(e.autoSuspend){e._suspendTimer=null,e.state="suspending";var t=function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())};e.ctx.suspend().then(t,t)}}),3e4),e}},_autoResume:function(){var e=this;if(e.ctx&&void 0!==e.ctx.resume&&r.usingWebAudio)return"running"===e.state&&"interrupted"!==e.ctx.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state||"running"===e.state&&"interrupted"===e.ctx.state?(e.ctx.resume().then((function(){e.state="running";for(var t=0;t<e._howls.length;t++)e._howls[t]._emit("resume")})),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}};var r=new t,n=function(e){e.src&&0!==e.src.length?this.init(e):console.error("An array of source files must be passed with any new Howl.")};n.prototype={init:function(e){var t=this;return r.ctx||u(),t._autoplay=e.autoplay||!1,t._format="string"!=typeof e.format?e.format:[e.format],t._html5=e.html5||!1,t._muted=e.mute||!1,t._loop=e.loop||!1,t._pool=e.pool||5,t._preload="boolean"!=typeof e.preload&&"metadata"!==e.preload||e.preload,t._rate=e.rate||1,t._sprite=e.sprite||{},t._src="string"!=typeof e.src?e.src:[e.src],t._volume=void 0!==e.volume?e.volume:1,t._xhr={method:e.xhr&&e.xhr.method?e.xhr.method:"GET",headers:e.xhr&&e.xhr.headers?e.xhr.headers:null,withCredentials:!(!e.xhr||!e.xhr.withCredentials)&&e.xhr.withCredentials},t._duration=0,t._state="unloaded",t._sounds=[],t._endTimers={},t._queue=[],t._playLock=!1,t._onend=e.onend?[{fn:e.onend}]:[],t._onfade=e.onfade?[{fn:e.onfade}]:[],t._onload=e.onload?[{fn:e.onload}]:[],t._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],t._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],t._onpause=e.onpause?[{fn:e.onpause}]:[],t._onplay=e.onplay?[{fn:e.onplay}]:[],t._onstop=e.onstop?[{fn:e.onstop}]:[],t._onmute=e.onmute?[{fn:e.onmute}]:[],t._onvolume=e.onvolume?[{fn:e.onvolume}]:[],t._onrate=e.onrate?[{fn:e.onrate}]:[],t._onseek=e.onseek?[{fn:e.onseek}]:[],t._onunlock=e.onunlock?[{fn:e.onunlock}]:[],t._onresume=[],t._webAudio=r.usingWebAudio&&!t._html5,void 0!==r.ctx&&r.ctx&&r.autoUnlock&&r._unlockAudio(),r._howls.push(t),t._autoplay&&t._queue.push({event:"play",action:function(){t.play()}}),t._preload&&"none"!==t._preload&&t.load(),t},load:function(){var e=this,t=null;if(r.noAudio)e._emit("loaderror",null,"No audio support.");else{"string"==typeof e._src&&(e._src=[e._src]);for(var n=0;n<e._src.length;n++){var s,a;if(e._format&&e._format[n])s=e._format[n];else{if("string"!=typeof(a=e._src[n])){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(s=/^data:audio\/([^;,]+);/i.exec(a))||(s=/\.([^.]+)$/.exec(a.split("?",1)[0])),s&&(s=s[1].toLowerCase())}if(s||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),s&&r.codecs(s)){t=e._src[n];break}}if(t)return e._src=t,e._state="loading","https:"===window.location.protocol&&"http:"===t.slice(0,5)&&(e._html5=!0,e._webAudio=!1),new i(e),e._webAudio&&o(e),e;e._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(e,t){var n=this,i=null;if("number"==typeof e)i=e,e=null;else{if("string"==typeof e&&"loaded"===n._state&&!n._sprite[e])return null;if(void 0===e&&(e="__default",!n._playLock)){for(var s=0,o=0;o<n._sounds.length;o++)n._sounds[o]._paused&&!n._sounds[o]._ended&&(s++,i=n._sounds[o]._id);1===s?e=null:i=null}}var a=i?n._soundById(i):n._inactiveSound();if(!a)return null;if(i&&!e&&(e=a._sprite||"__default"),"loaded"!==n._state){a._sprite=e,a._ended=!1;var l=a._id;return n._queue.push({event:"play",action:function(){n.play(l)}}),l}if(i&&!a._paused)return t||n._loadQueue("play"),a._id;n._webAudio&&r._autoResume();var h=Math.max(0,a._seek>0?a._seek:n._sprite[e][0]/1e3),u=Math.max(0,(n._sprite[e][0]+n._sprite[e][1])/1e3-h),c=1e3*u/Math.abs(a._rate),d=n._sprite[e][0]/1e3,f=(n._sprite[e][0]+n._sprite[e][1])/1e3;a._sprite=e,a._ended=!1;var p=function(){a._paused=!1,a._seek=h,a._start=d,a._stop=f,a._loop=!(!a._loop&&!n._sprite[e][2])};if(!(h>=f)){var m=a._node;if(n._webAudio){var _=function(){n._playLock=!1,p(),n._refreshBuffer(a);var e=a._muted||n._muted?0:a._volume;m.gain.setValueAtTime(e,r.ctx.currentTime),a._playStart=r.ctx.currentTime,void 0===m.bufferSource.start?a._loop?m.bufferSource.noteGrainOn(0,h,86400):m.bufferSource.noteGrainOn(0,h,u):a._loop?m.bufferSource.start(0,h,86400):m.bufferSource.start(0,h,u),c!==1/0&&(n._endTimers[a._id]=setTimeout(n._ended.bind(n,a),c)),t||setTimeout((function(){n._emit("play",a._id),n._loadQueue()}),0)};"running"===r.state&&"interrupted"!==r.ctx.state?_():(n._playLock=!0,n.once("resume",_),n._clearTimer(a._id))}else{var g=function(){m.currentTime=h,m.muted=a._muted||n._muted||r._muted||m.muted,m.volume=a._volume*r.volume(),m.playbackRate=a._rate;try{var i=m.play();if(i&&"undefined"!=typeof Promise&&(i instanceof Promise||"function"==typeof i.then)?(n._playLock=!0,p(),i.then((function(){n._playLock=!1,m._unlocked=!0,t||(n._emit("play",a._id),n._loadQueue())})).catch((function(){n._playLock=!1,n._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),a._ended=!0,a._paused=!0}))):t||(n._playLock=!1,p(),n._emit("play",a._id),n._loadQueue()),m.playbackRate=a._rate,m.paused)return void n._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==e||a._loop?n._endTimers[a._id]=setTimeout(n._ended.bind(n,a),c):(n._endTimers[a._id]=function(){n._ended(a),m.removeEventListener("ended",n._endTimers[a._id],!1)},m.addEventListener("ended",n._endTimers[a._id],!1))}catch(e){n._emit("playerror",a._id,e)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===m.src&&(m.src=n._src,m.load());var v=window&&window.ejecta||!m.readyState&&r._navigator.isCocoonJS;if(m.readyState>=3||v)g();else{n._playLock=!0;var y=function(){g(),m.removeEventListener(r._canPlayEvent,y,!1)};m.addEventListener(r._canPlayEvent,y,!1),n._clearTimer(a._id)}}return a._id}n._ended(a)},pause:function(e){var t=this;if("loaded"!==t._state||t._playLock)return t._queue.push({event:"pause",action:function(){t.pause(e)}}),t;for(var r=t._getSoundIds(e),n=0;n<r.length;n++){t._clearTimer(r[n]);var i=t._soundById(r[n]);if(i&&!i._paused&&(i._seek=t.seek(r[n]),i._rateSeek=0,i._paused=!0,t._stopFade(r[n]),i._node))if(t._webAudio){if(!i._node.bufferSource)continue;void 0===i._node.bufferSource.stop?i._node.bufferSource.noteOff(0):i._node.bufferSource.stop(0),t._cleanBuffer(i._node)}else(!isNaN(i._node.duration)||i._node.duration===1/0)&&i._node.pause();arguments[1]||t._emit("pause",i?i._id:null)}return t},stop:function(e,t){var r=this;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"stop",action:function(){r.stop(e)}}),r;for(var n=r._getSoundIds(e),i=0;i<n.length;i++){r._clearTimer(n[i]);var s=r._soundById(n[i]);s&&(s._seek=s._start||0,s._rateSeek=0,s._paused=!0,s._ended=!0,r._stopFade(n[i]),s._node&&(r._webAudio?s._node.bufferSource&&(void 0===s._node.bufferSource.stop?s._node.bufferSource.noteOff(0):s._node.bufferSource.stop(0),r._cleanBuffer(s._node)):(!isNaN(s._node.duration)||s._node.duration===1/0)&&(s._node.currentTime=s._start||0,s._node.pause(),s._node.duration===1/0&&r._clearSound(s._node))),t||r._emit("stop",s._id))}return r},mute:function(e,t){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"mute",action:function(){n.mute(e,t)}}),n;if(void 0===t){if("boolean"!=typeof e)return n._muted;n._muted=e}for(var i=n._getSoundIds(t),s=0;s<i.length;s++){var o=n._soundById(i[s]);o&&(o._muted=e,o._interval&&n._stopFade(o._id),n._webAudio&&o._node?o._node.gain.setValueAtTime(e?0:o._volume,r.ctx.currentTime):o._node&&(o._node.muted=!!r._muted||e),n._emit("mute",o._id))}return n},volume:function(){var e,t,n,i=this,s=arguments;if(0===s.length)return i._volume;if(1===s.length||2===s.length&&void 0===s[1]){var o=i._getSoundIds(),a=o.indexOf(s[0]);a>=0?t=parseInt(s[0],10):e=parseFloat(s[0])}else s.length>=2&&(e=parseFloat(s[0]),t=parseInt(s[1],10));if(!(void 0!==e&&e>=0&&e<=1))return(n=t?i._soundById(t):i._sounds[0])?n._volume:0;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"volume",action:function(){i.volume.apply(i,s)}}),i;void 0===t&&(i._volume=e),t=i._getSoundIds(t);for(var l=0;l<t.length;l++)(n=i._soundById(t[l]))&&(n._volume=e,s[2]||i._stopFade(t[l]),i._webAudio&&n._node&&!n._muted?n._node.gain.setValueAtTime(e,r.ctx.currentTime):n._node&&!n._muted&&(n._node.volume=e*r.volume()),i._emit("volume",n._id));return i},fade:function(e,t,n,i){var s=this;if("loaded"!==s._state||s._playLock)return s._queue.push({event:"fade",action:function(){s.fade(e,t,n,i)}}),s;e=Math.min(Math.max(0,parseFloat(e)),1),t=Math.min(Math.max(0,parseFloat(t)),1),n=parseFloat(n),s.volume(e,i);for(var o=s._getSoundIds(i),a=0;a<o.length;a++){var l=s._soundById(o[a]);if(l){if(i||s._stopFade(o[a]),s._webAudio&&!l._muted){var h=r.ctx.currentTime,u=h+n/1e3;l._volume=e,l._node.gain.setValueAtTime(e,h),l._node.gain.linearRampToValueAtTime(t,u)}s._startFadeInterval(l,e,t,n,o[a],void 0===i)}}return s},_startFadeInterval:function(e,t,r,n,i,s){var o=this,a=t,l=r-t,h=Math.abs(l/.01),u=Math.max(4,h>0?n/h:n),c=Date.now();e._fadeTo=r,e._interval=setInterval((function(){var i=(Date.now()-c)/n;c=Date.now(),a+=l*i,a=Math.round(100*a)/100,a=l<0?Math.max(r,a):Math.min(r,a),o._webAudio?e._volume=a:o.volume(a,e._id,!0),s&&(o._volume=a),(r<t&&a<=r||r>t&&a>=r)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,o.volume(r,e._id),o._emit("fade",e._id))}),u)},_stopFade:function(e){var t=this,n=t._soundById(e);return n&&n._interval&&(t._webAudio&&n._node.gain.cancelScheduledValues(r.ctx.currentTime),clearInterval(n._interval),n._interval=null,t.volume(n._fadeTo,e),n._fadeTo=null,t._emit("fade",e)),t},loop:function(){var e,t,r,n=this,i=arguments;if(0===i.length)return n._loop;if(1===i.length){if("boolean"!=typeof i[0])return!!(r=n._soundById(parseInt(i[0],10)))&&r._loop;e=i[0],n._loop=e}else 2===i.length&&(e=i[0],t=parseInt(i[1],10));for(var s=n._getSoundIds(t),o=0;o<s.length;o++)(r=n._soundById(s[o]))&&(r._loop=e,n._webAudio&&r._node&&r._node.bufferSource&&(r._node.bufferSource.loop=e,e&&(r._node.bufferSource.loopStart=r._start||0,r._node.bufferSource.loopEnd=r._stop)));return n},rate:function(){var e,t,n,i=this,s=arguments;if(0===s.length)t=i._sounds[0]._id;else if(1===s.length){var o=i._getSoundIds(),a=o.indexOf(s[0]);a>=0?t=parseInt(s[0],10):e=parseFloat(s[0])}else 2===s.length&&(e=parseFloat(s[0]),t=parseInt(s[1],10));if("number"!=typeof e)return(n=i._soundById(t))?n._rate:i._rate;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"rate",action:function(){i.rate.apply(i,s)}}),i;void 0===t&&(i._rate=e),t=i._getSoundIds(t);for(var l=0;l<t.length;l++)if(n=i._soundById(t[l])){i.playing(t[l])&&(n._rateSeek=i.seek(t[l]),n._playStart=i._webAudio?r.ctx.currentTime:n._playStart),n._rate=e,i._webAudio&&n._node&&n._node.bufferSource?n._node.bufferSource.playbackRate.setValueAtTime(e,r.ctx.currentTime):n._node&&(n._node.playbackRate=e);var h=i.seek(t[l]),u=(i._sprite[n._sprite][0]+i._sprite[n._sprite][1])/1e3-h,c=1e3*u/Math.abs(n._rate);(i._endTimers[t[l]]||!n._paused)&&(i._clearTimer(t[l]),i._endTimers[t[l]]=setTimeout(i._ended.bind(i,n),c)),i._emit("rate",n._id)}return i},seek:function(){var e,t,n=this,i=arguments;if(0===i.length)t=n._sounds[0]._id;else if(1===i.length){var s=n._getSoundIds(),o=s.indexOf(i[0]);o>=0?t=parseInt(i[0],10):n._sounds.length&&(t=n._sounds[0]._id,e=parseFloat(i[0]))}else 2===i.length&&(e=parseFloat(i[0]),t=parseInt(i[1],10));if(void 0===t)return n;if("number"==typeof e&&("loaded"!==n._state||n._playLock))return n._queue.push({event:"seek",action:function(){n.seek.apply(n,i)}}),n;var a=n._soundById(t);if(a){if(!("number"==typeof e&&e>=0)){if(n._webAudio){var l=n.playing(t)?r.ctx.currentTime-a._playStart:0,h=a._rateSeek?a._rateSeek-a._seek:0;return a._seek+(h+l*Math.abs(a._rate))}return a._node.currentTime}var u=n.playing(t);u&&n.pause(t,!0),a._seek=e,a._ended=!1,n._clearTimer(t),!n._webAudio&&a._node&&!isNaN(a._node.duration)&&(a._node.currentTime=e);var c=function(){n._emit("seek",t),u&&n.play(t,!0)};if(u&&!n._webAudio){var d=function(){n._playLock?setTimeout(d,0):c()};setTimeout(d,0)}else c()}return n},playing:function(e){var t=this;if("number"==typeof e){var r=t._soundById(e);return!!r&&!r._paused}for(var n=0;n<t._sounds.length;n++)if(!t._sounds[n]._paused)return!0;return!1},duration:function(e){var t=this,r=t._duration,n=t._soundById(e);return n&&(r=t._sprite[n._sprite][1]/1e3),r},state:function(){return this._state},unload:function(){for(var e=this,t=e._sounds,n=0;n<t.length;n++)t[n]._paused||e.stop(t[n]._id),e._webAudio||(e._clearSound(t[n]._node),t[n]._node.removeEventListener("error",t[n]._errorFn,!1),t[n]._node.removeEventListener(r._canPlayEvent,t[n]._loadFn,!1),t[n]._node.removeEventListener("ended",t[n]._endFn,!1),r._releaseHtml5Audio(t[n]._node)),delete t[n]._node,e._clearTimer(t[n]._id);var i=r._howls.indexOf(e);i>=0&&r._howls.splice(i,1);var o=!0;for(n=0;n<r._howls.length;n++)if(r._howls[n]._src===e._src||e._src.indexOf(r._howls[n]._src)>=0){o=!1;break}return s&&o&&delete s[e._src],r.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,t,r,n){var i=this["_on"+e];return"function"==typeof t&&i.push(n?{id:r,fn:t,once:n}:{id:r,fn:t}),this},off:function(e,t,r){var n=this,i=n["_on"+e],s=0;if("number"==typeof t&&(r=t,t=null),t||r)for(s=0;s<i.length;s++){var o=r===i[s].id;if(t===i[s].fn&&o||!t&&o){i.splice(s,1);break}}else if(e)n["_on"+e]=[];else{var a=Object.keys(n);for(s=0;s<a.length;s++)0===a[s].indexOf("_on")&&Array.isArray(n[a[s]])&&(n[a[s]]=[])}return n},once:function(e,t,r){return this.on(e,t,r,1),this},_emit:function(e,t,r){for(var n=this,i=n["_on"+e],s=i.length-1;s>=0;s--)(!i[s].id||i[s].id===t||"load"===e)&&(setTimeout(function(e){e.call(this,t,r)}.bind(n,i[s].fn),0),i[s].once&&n.off(e,i[s].fn,i[s].id));return n._loadQueue(e),n},_loadQueue:function(e){var t=this;if(t._queue.length>0){var r=t._queue[0];r.event===e&&(t._queue.shift(),t._loadQueue()),e||r.action()}return t},_ended:function(e){var t=this,n=e._sprite;if(!t._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(t._ended.bind(t,e),100),t;var i=!(!e._loop&&!t._sprite[n][2]);if(t._emit("end",e._id),!t._webAudio&&i&&t.stop(e._id,!0).play(e._id),t._webAudio&&i){t._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=r.ctx.currentTime;var s=1e3*(e._stop-e._start)/Math.abs(e._rate);t._endTimers[e._id]=setTimeout(t._ended.bind(t,e),s)}return t._webAudio&&!i&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,t._clearTimer(e._id),t._cleanBuffer(e._node),r._autoSuspend()),!t._webAudio&&!i&&t.stop(e._id,!0),t},_clearTimer:function(e){var t=this;if(t._endTimers[e]){if("function"!=typeof t._endTimers[e])clearTimeout(t._endTimers[e]);else{var r=t._soundById(e);r&&r._node&&r._node.removeEventListener("ended",t._endTimers[e],!1)}delete t._endTimers[e]}return t},_soundById:function(e){for(var t=this,r=0;r<t._sounds.length;r++)if(e===t._sounds[r]._id)return t._sounds[r];return null},_inactiveSound:function(){var e=this;e._drain();for(var t=0;t<e._sounds.length;t++)if(e._sounds[t]._ended)return e._sounds[t].reset();return new i(e)},_drain:function(){var e=this,t=e._pool,r=0,n=0;if(!(e._sounds.length<t)){for(n=0;n<e._sounds.length;n++)e._sounds[n]._ended&&r++;for(n=e._sounds.length-1;n>=0;n--){if(r<=t)return;e._sounds[n]._ended&&(e._webAudio&&e._sounds[n]._node&&e._sounds[n]._node.disconnect(0),e._sounds.splice(n,1),r--)}}},_getSoundIds:function(e){if(void 0===e){for(var t=[],r=0;r<this._sounds.length;r++)t.push(this._sounds[r]._id);return t}return[e]},_refreshBuffer:function(e){return e._node.bufferSource=r.ctx.createBufferSource(),e._node.bufferSource.buffer=s[this._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,r.ctx.currentTime),this},_cleanBuffer:function(e){var t=r._navigator&&r._navigator.vendor.indexOf("Apple")>=0;if(r._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),t))try{e.bufferSource.buffer=r._scratchBuffer}catch(e){}return e.bufferSource=null,this},_clearSound:function(e){/MSIE |Trident\//.test(r._navigator&&r._navigator.userAgent)||(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var i=function(e){this._parent=e,this.init()};i.prototype={init:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++r._counter,t._sounds.push(e),e.create(),e},create:function(){var e=this,t=e._parent,n=r._muted||e._muted||e._parent._muted?0:e._volume;return t._webAudio?(e._node=void 0===r.ctx.createGain?r.ctx.createGainNode():r.ctx.createGain(),e._node.gain.setValueAtTime(n,r.ctx.currentTime),e._node.paused=!0,e._node.connect(r.masterGain)):r.noAudio||(e._node=r._obtainHtml5Audio(),e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(r._canPlayEvent,e._loadFn,!1),e._endFn=e._endListener.bind(e),e._node.addEventListener("ended",e._endFn,!1),e._node.src=t._src,e._node.preload=!0===t._preload?"auto":t._preload,e._node.volume=n*r.volume(),e._node.load()),e},reset:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++r._counter,e},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var e=this,t=e._parent;t._duration=Math.ceil(10*e._node.duration)/10,0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue()),e._node.removeEventListener(r._canPlayEvent,e._loadFn,!1)},_endListener:function(){var e=this,t=e._parent;t._duration===1/0&&(t._duration=Math.ceil(10*e._node.duration)/10,t._sprite.__default[1]===1/0&&(t._sprite.__default[1]=1e3*t._duration),t._ended(e)),e._node.removeEventListener("ended",e._endFn,!1)}};var s={},o=function(e){var t=e._src;if(s[t])return e._duration=s[t].duration,void h(e);if(/^data:[^;]+;base64,/.test(t)){for(var r=atob(t.split(",")[1]),n=new Uint8Array(r.length),i=0;i<r.length;++i)n[i]=r.charCodeAt(i);l(n.buffer,e)}else{var o=new XMLHttpRequest;o.open(e._xhr.method,t,!0),o.withCredentials=e._xhr.withCredentials,o.responseType="arraybuffer",e._xhr.headers&&Object.keys(e._xhr.headers).forEach((function(t){o.setRequestHeader(t,e._xhr.headers[t])})),o.onload=function(){var t=(o.status+"")[0];"0"===t||"2"===t||"3"===t?l(o.response,e):e._emit("loaderror",null,"Failed loading audio file with status: "+o.status+".")},o.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete s[t],e.load())},a(o)}},a=function(e){try{e.send()}catch(t){e.onerror()}},l=function(e,t){var n=function(){t._emit("loaderror",null,"Decoding audio data failed.")},i=function(e){e&&t._sounds.length>0?(s[t._src]=e,h(t,e)):n()};"undefined"!=typeof Promise&&1===r.ctx.decodeAudioData.length?r.ctx.decodeAudioData(e).then(i).catch(n):r.ctx.decodeAudioData(e,i,n)},h=function(e,t){t&&!e._duration&&(e._duration=t.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},u=function(){if(r.usingWebAudio){try{"undefined"!=typeof AudioContext?r.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?r.ctx=new webkitAudioContext:r.usingWebAudio=!1}catch(e){r.usingWebAudio=!1}r.ctx||(r.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(r._navigator&&r._navigator.platform),t=r._navigator&&r._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),n=t?parseInt(t[1],10):null;if(e&&n&&n<9){var i=/safari/.test(r._navigator&&r._navigator.userAgent.toLowerCase());r._navigator&&!i&&(r.usingWebAudio=!1)}r.usingWebAudio&&(r.masterGain=void 0===r.ctx.createGain?r.ctx.createGainNode():r.ctx.createGain(),r.masterGain.gain.setValueAtTime(r._muted?0:r._volume,r.ctx.currentTime),r.masterGain.connect(r.ctx.destination)),r._setup()}};"function"==typeof define&&define.amd&&define([],(function(){return{Howler:r,Howl:n}})),void 0!==e&&(e.Howler=r,e.Howl=n),"undefined"!=typeof global?(global.HowlerGlobal=t,global.Howler=r,global.Howl=n,global.Sound=i):"undefined"!=typeof window&&(window.HowlerGlobal=t,window.Howler=r,window.Howl=n,window.Sound=i)}(),function(){var e;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var t=this;if(!t.ctx||!t.ctx.listener)return t;for(var r=t._howls.length-1;r>=0;r--)t._howls[r].stereo(e);return t},HowlerGlobal.prototype.pos=function(e,t,r){var n=this;return n.ctx&&n.ctx.listener?(t="number"!=typeof t?n._pos[1]:t,r="number"!=typeof r?n._pos[2]:r,"number"!=typeof e?n._pos:(n._pos=[e,t,r],void 0!==n.ctx.listener.positionX?(n.ctx.listener.positionX.setTargetAtTime(n._pos[0],Howler.ctx.currentTime,.1),n.ctx.listener.positionY.setTargetAtTime(n._pos[1],Howler.ctx.currentTime,.1),n.ctx.listener.positionZ.setTargetAtTime(n._pos[2],Howler.ctx.currentTime,.1)):n.ctx.listener.setPosition(n._pos[0],n._pos[1],n._pos[2]),n)):n},HowlerGlobal.prototype.orientation=function(e,t,r,n,i,s){var o=this;if(!o.ctx||!o.ctx.listener)return o;var a=o._orientation;return t="number"!=typeof t?a[1]:t,r="number"!=typeof r?a[2]:r,n="number"!=typeof n?a[3]:n,i="number"!=typeof i?a[4]:i,s="number"!=typeof s?a[5]:s,"number"!=typeof e?a:(o._orientation=[e,t,r,n,i,s],void 0!==o.ctx.listener.forwardX?(o.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),o.ctx.listener.forwardY.setTargetAtTime(t,Howler.ctx.currentTime,.1),o.ctx.listener.forwardZ.setTargetAtTime(r,Howler.ctx.currentTime,.1),o.ctx.listener.upX.setTargetAtTime(n,Howler.ctx.currentTime,.1),o.ctx.listener.upY.setTargetAtTime(i,Howler.ctx.currentTime,.1),o.ctx.listener.upZ.setTargetAtTime(s,Howler.ctx.currentTime,.1)):o.ctx.listener.setOrientation(e,t,r,n,i,s),o)},Howl.prototype.init=(e=Howl.prototype.init,function(t){var r=this;return r._orientation=t.orientation||[1,0,0],r._stereo=t.stereo||null,r._pos=t.pos||null,r._pannerAttr={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:360,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:360,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:0,distanceModel:void 0!==t.distanceModel?t.distanceModel:"inverse",maxDistance:void 0!==t.maxDistance?t.maxDistance:1e4,panningModel:void 0!==t.panningModel?t.panningModel:"HRTF",refDistance:void 0!==t.refDistance?t.refDistance:1,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:1},r._onstereo=t.onstereo?[{fn:t.onstereo}]:[],r._onpos=t.onpos?[{fn:t.onpos}]:[],r._onorientation=t.onorientation?[{fn:t.onorientation}]:[],e.call(this,t)}),Howl.prototype.stereo=function(e,r){var n=this;if(!n._webAudio)return n;if("loaded"!==n._state)return n._queue.push({event:"stereo",action:function(){n.stereo(e,r)}}),n;var i=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===r){if("number"!=typeof e)return n._stereo;n._stereo=e,n._pos=[e,0,0]}for(var s=n._getSoundIds(r),o=0;o<s.length;o++){var a=n._soundById(s[o]);if(a){if("number"!=typeof e)return a._stereo;a._stereo=e,a._pos=[e,0,0],a._node&&(a._pannerAttr.panningModel="equalpower",(!a._panner||!a._panner.pan)&&t(a,i),"spatial"===i?void 0!==a._panner.positionX?(a._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),a._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),a._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):a._panner.setPosition(e,0,0):a._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),n._emit("stereo",a._id)}}return n},Howl.prototype.pos=function(e,r,n,i){var s=this;if(!s._webAudio)return s;if("loaded"!==s._state)return s._queue.push({event:"pos",action:function(){s.pos(e,r,n,i)}}),s;if(r="number"!=typeof r?0:r,n="number"!=typeof n?-.5:n,void 0===i){if("number"!=typeof e)return s._pos;s._pos=[e,r,n]}for(var o=s._getSoundIds(i),a=0;a<o.length;a++){var l=s._soundById(o[a]);if(l){if("number"!=typeof e)return l._pos;l._pos=[e,r,n],l._node&&((!l._panner||l._panner.pan)&&t(l,"spatial"),void 0!==l._panner.positionX?(l._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(r,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(n,Howler.ctx.currentTime)):l._panner.setPosition(e,r,n)),s._emit("pos",l._id)}}return s},Howl.prototype.orientation=function(e,r,n,i){var s=this;if(!s._webAudio)return s;if("loaded"!==s._state)return s._queue.push({event:"orientation",action:function(){s.orientation(e,r,n,i)}}),s;if(r="number"!=typeof r?s._orientation[1]:r,n="number"!=typeof n?s._orientation[2]:n,void 0===i){if("number"!=typeof e)return s._orientation;s._orientation=[e,r,n]}for(var o=s._getSoundIds(i),a=0;a<o.length;a++){var l=s._soundById(o[a]);if(l){if("number"!=typeof e)return l._orientation;l._orientation=[e,r,n],l._node&&(l._panner||(l._pos||(l._pos=s._pos||[0,0,-.5]),t(l,"spatial")),void 0!==l._panner.orientationX?(l._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),l._panner.orientationY.setValueAtTime(r,Howler.ctx.currentTime),l._panner.orientationZ.setValueAtTime(n,Howler.ctx.currentTime)):l._panner.setOrientation(e,r,n)),s._emit("orientation",l._id)}}return s},Howl.prototype.pannerAttr=function(){var e,r,n,i=this,s=arguments;if(!i._webAudio)return i;if(0===s.length)return i._pannerAttr;if(1===s.length){if("object"!=typeof s[0])return(n=i._soundById(parseInt(s[0],10)))?n._pannerAttr:i._pannerAttr;e=s[0],void 0===r&&(e.pannerAttr||(e.pannerAttr={coneInnerAngle:e.coneInnerAngle,coneOuterAngle:e.coneOuterAngle,coneOuterGain:e.coneOuterGain,distanceModel:e.distanceModel,maxDistance:e.maxDistance,refDistance:e.refDistance,rolloffFactor:e.rolloffFactor,panningModel:e.panningModel}),i._pannerAttr={coneInnerAngle:void 0!==e.pannerAttr.coneInnerAngle?e.pannerAttr.coneInnerAngle:i._coneInnerAngle,coneOuterAngle:void 0!==e.pannerAttr.coneOuterAngle?e.pannerAttr.coneOuterAngle:i._coneOuterAngle,coneOuterGain:void 0!==e.pannerAttr.coneOuterGain?e.pannerAttr.coneOuterGain:i._coneOuterGain,distanceModel:void 0!==e.pannerAttr.distanceModel?e.pannerAttr.distanceModel:i._distanceModel,maxDistance:void 0!==e.pannerAttr.maxDistance?e.pannerAttr.maxDistance:i._maxDistance,refDistance:void 0!==e.pannerAttr.refDistance?e.pannerAttr.refDistance:i._refDistance,rolloffFactor:void 0!==e.pannerAttr.rolloffFactor?e.pannerAttr.rolloffFactor:i._rolloffFactor,panningModel:void 0!==e.pannerAttr.panningModel?e.pannerAttr.panningModel:i._panningModel})}else 2===s.length&&(e=s[0],r=parseInt(s[1],10));for(var o=i._getSoundIds(r),a=0;a<o.length;a++)if(n=i._soundById(o[a])){var l=n._pannerAttr;l={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:l.coneInnerAngle,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:l.coneOuterAngle,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:l.coneOuterGain,distanceModel:void 0!==e.distanceModel?e.distanceModel:l.distanceModel,maxDistance:void 0!==e.maxDistance?e.maxDistance:l.maxDistance,refDistance:void 0!==e.refDistance?e.refDistance:l.refDistance,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:l.rolloffFactor,panningModel:void 0!==e.panningModel?e.panningModel:l.panningModel};var h=n._panner;h?(h.coneInnerAngle=l.coneInnerAngle,h.coneOuterAngle=l.coneOuterAngle,h.coneOuterGain=l.coneOuterGain,h.distanceModel=l.distanceModel,h.maxDistance=l.maxDistance,h.refDistance=l.refDistance,h.rolloffFactor=l.rolloffFactor,h.panningModel=l.panningModel):(n._pos||(n._pos=i._pos||[0,0,-.5]),t(n,"spatial"))}return i},Sound.prototype.init=function(e){return function(){var t=this,r=t._parent;t._orientation=r._orientation,t._stereo=r._stereo,t._pos=r._pos,t._pannerAttr=r._pannerAttr,e.call(this),t._stereo?r.stereo(t._stereo):t._pos&&r.pos(t._pos[0],t._pos[1],t._pos[2],t._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var t=this,r=t._parent;return t._orientation=r._orientation,t._stereo=r._stereo,t._pos=r._pos,t._pannerAttr=r._pannerAttr,t._stereo?r.stereo(t._stereo):t._pos?r.pos(t._pos[0],t._pos[1],t._pos[2],t._id):t._panner&&(t._panner.disconnect(0),t._panner=void 0,r._refreshBuffer(t)),e.call(this)}}(Sound.prototype.reset);var t=function(e,t){"spatial"===(t=t||"spatial")?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,void 0!==e._panner.positionX?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),void 0!==e._panner.orientationX?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}}()}}),require_common=__commonJS({"node_modules/pako/lib/utils/common.js"(e){var t="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var i in n)r(n,i)&&(e[i]=n[i])}}return e},e.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var n={arraySet:function(e,t,r,n,i){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+n),i);else for(var s=0;s<n;s++)e[i+s]=t[r+s]},flattenChunks:function(e){var t,r,n,i,s,o;for(n=0,t=0,r=e.length;t<r;t++)n+=e[t].length;for(o=new Uint8Array(n),i=0,t=0,r=e.length;t<r;t++)s=e[t],o.set(s,i),i+=s.length;return o}},i={arraySet:function(e,t,r,n,i){for(var s=0;s<n;s++)e[i+s]=t[r+s]},flattenChunks:function(e){return[].concat.apply([],e)}};e.setTyped=function(t){t?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,n)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,i))},e.setTyped(t)}}),require_trees=__commonJS({"node_modules/pako/lib/zlib/trees.js"(e){var t=require_common();function r(e){for(var t=e.length;--t>=0;)e[t]=0}var n=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],i=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],o=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],a=new Array(576);r(a);var l=new Array(60);r(l);var h=new Array(512);r(h);var u=new Array(256);r(u);var c=new Array(29);r(c);var d,f,p,m=new Array(30);function _(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}function g(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function v(e){return e<256?h[e]:h[256+(e>>>7)]}function y(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function b(e,t,r){e.bi_valid>16-r?(e.bi_buf|=t<<e.bi_valid&65535,y(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=r-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function x(e,t,r){b(e,r[2*t],r[2*t+1])}function S(e,t){var r=0;do{r|=1&e,e>>>=1,r<<=1}while(--t>0);return r>>>1}function T(e,t,r){var n,i,s=new Array(16),o=0;for(n=1;n<=15;n++)s[n]=o=o+r[n-1]<<1;for(i=0;i<=t;i++){var a=e[2*i+1];0!==a&&(e[2*i]=S(s[a]++,a))}}function E(e){var t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function A(e){e.bi_valid>8?y(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function w(e,t,r,n){var i=2*t,s=2*r;return e[i]<e[s]||e[i]===e[s]&&n[t]<=n[r]}function C(e,t,r){for(var n=e.heap[r],i=r<<1;i<=e.heap_len&&(i<e.heap_len&&w(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!w(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n}function O(e,t,r){var s,o,a,l,h=0;if(0!==e.last_lit)do{s=e.pending_buf[e.d_buf+2*h]<<8|e.pending_buf[e.d_buf+2*h+1],o=e.pending_buf[e.l_buf+h],h++,0===s?x(e,o,t):(x(e,(a=u[o])+256+1,t),0!==(l=n[a])&&b(e,o-=c[a],l),x(e,a=v(--s),r),0!==(l=i[a])&&b(e,s-=m[a],l))}while(h<e.last_lit);x(e,256,t)}function R(e,t){var r,n,i,s=t.dyn_tree,o=t.stat_desc.static_tree,a=t.stat_desc.has_stree,l=t.stat_desc.elems,h=-1;for(e.heap_len=0,e.heap_max=573,r=0;r<l;r++)0!==s[2*r]?(e.heap[++e.heap_len]=h=r,e.depth[r]=0):s[2*r+1]=0;for(;e.heap_len<2;)s[2*(i=e.heap[++e.heap_len]=h<2?++h:0)]=1,e.depth[i]=0,e.opt_len--,a&&(e.static_len-=o[2*i+1]);for(t.max_code=h,r=e.heap_len>>1;r>=1;r--)C(e,s,r);i=l;do{r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],C(e,s,1),n=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=n,s[2*i]=s[2*r]+s[2*n],e.depth[i]=(e.depth[r]>=e.depth[n]?e.depth[r]:e.depth[n])+1,s[2*r+1]=s[2*n+1]=i,e.heap[1]=i++,C(e,s,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var r,n,i,s,o,a,l=t.dyn_tree,h=t.max_code,u=t.stat_desc.static_tree,c=t.stat_desc.has_stree,d=t.stat_desc.extra_bits,f=t.stat_desc.extra_base,p=t.stat_desc.max_length,m=0;for(s=0;s<=15;s++)e.bl_count[s]=0;for(l[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<573;r++)(s=l[2*l[2*(n=e.heap[r])+1]+1]+1)>p&&(s=p,m++),l[2*n+1]=s,!(n>h)&&(e.bl_count[s]++,o=0,n>=f&&(o=d[n-f]),a=l[2*n],e.opt_len+=a*(s+o),c&&(e.static_len+=a*(u[2*n+1]+o)));if(0!==m){do{for(s=p-1;0===e.bl_count[s];)s--;e.bl_count[s]--,e.bl_count[s+1]+=2,e.bl_count[p]--,m-=2}while(m>0);for(s=p;0!==s;s--)for(n=e.bl_count[s];0!==n;)!((i=e.heap[--r])>h)&&(l[2*i+1]!==s&&(e.opt_len+=(s-l[2*i+1])*l[2*i],l[2*i+1]=s),n--)}}(e,t),T(s,h,e.bl_count)}function D(e,t,r){var n,i,s=-1,o=t[1],a=0,l=7,h=4;for(0===o&&(l=138,h=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)i=o,o=t[2*(n+1)+1],!(++a<l&&i===o)&&(a<h?e.bl_tree[2*i]+=a:0!==i?(i!==s&&e.bl_tree[2*i]++,e.bl_tree[32]++):a<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=0,s=i,0===o?(l=138,h=3):i===o?(l=6,h=3):(l=7,h=4))}function I(e,t,r){var n,i,s=-1,o=t[1],a=0,l=7,h=4;for(0===o&&(l=138,h=3),n=0;n<=r;n++)if(i=o,o=t[2*(n+1)+1],!(++a<l&&i===o)){if(a<h)do{x(e,i,e.bl_tree)}while(0!=--a);else 0!==i?(i!==s&&(x(e,i,e.bl_tree),a--),x(e,16,e.bl_tree),b(e,a-3,2)):a<=10?(x(e,17,e.bl_tree),b(e,a-3,3)):(x(e,18,e.bl_tree),b(e,a-11,7));a=0,s=i,0===o?(l=138,h=3):i===o?(l=6,h=3):(l=7,h=4)}}r(m);var M=!1;function N(e,r,n,i){b(e,0+(i?1:0),3),function(e,r,n,i){A(e),y(e,n),y(e,~n),t.arraySet(e.pending_buf,e.window,r,n,e.pending),e.pending+=n}(e,r,n)}e._tr_init=function(e){M||(function(){var e,t,r,o,g,v=new Array(16);for(r=0,o=0;o<28;o++)for(c[o]=r,e=0;e<1<<n[o];e++)u[r++]=o;for(u[r-1]=o,g=0,o=0;o<16;o++)for(m[o]=g,e=0;e<1<<i[o];e++)h[g++]=o;for(g>>=7;o<30;o++)for(m[o]=g<<7,e=0;e<1<<i[o]-7;e++)h[256+g++]=o;for(t=0;t<=15;t++)v[t]=0;for(e=0;e<=143;)a[2*e+1]=8,e++,v[8]++;for(;e<=255;)a[2*e+1]=9,e++,v[9]++;for(;e<=279;)a[2*e+1]=7,e++,v[7]++;for(;e<=287;)a[2*e+1]=8,e++,v[8]++;for(T(a,287,v),e=0;e<30;e++)l[2*e+1]=5,l[2*e]=S(e,5);d=new _(a,n,257,286,15),f=new _(l,i,0,30,15),p=new _(new Array(0),s,0,19,7)}(),M=!0),e.l_desc=new g(e.dyn_ltree,d),e.d_desc=new g(e.dyn_dtree,f),e.bl_desc=new g(e.bl_tree,p),e.bi_buf=0,e.bi_valid=0,E(e)},e._tr_stored_block=N,e._tr_flush_block=function(e,t,r,n){var i,s,h=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),R(e,e.l_desc),R(e,e.d_desc),h=function(e){var t;for(D(e,e.dyn_ltree,e.l_desc.max_code),D(e,e.dyn_dtree,e.d_desc.max_code),R(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*o[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(s=e.static_len+3+7>>>3)<=i&&(i=s)):i=s=r+5,r+4<=i&&-1!==t?N(e,t,r,n):4===e.strategy||s===i?(b(e,2+(n?1:0),3),O(e,a,l)):(b(e,4+(n?1:0),3),function(e,t,r,n){var i;for(b(e,t-257,5),b(e,r-1,5),b(e,n-4,4),i=0;i<n;i++)b(e,e.bl_tree[2*o[i]+1],3);I(e,e.dyn_ltree,t-1),I(e,e.dyn_dtree,r-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,h+1),O(e,e.dyn_ltree,e.dyn_dtree)),E(e),n&&A(e)},e._tr_tally=function(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(u[r]+256+1)]++,e.dyn_dtree[2*v(t)]++),e.last_lit===e.lit_bufsize-1},e._tr_align=function(e){b(e,2,3),x(e,256,a),function(e){16===e.bi_valid?(y(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}}}),require_adler32=__commonJS({"node_modules/pako/lib/zlib/adler32.js"(e,t){t.exports=function(e,t,r,n){for(var i=65535&e|0,s=e>>>16&65535|0,o=0;0!==r;){r-=o=r>2e3?2e3:r;do{s=s+(i=i+t[n++]|0)|0}while(--o);i%=65521,s%=65521}return i|s<<16|0}}}),require_crc32=__commonJS({"node_modules/pako/lib/zlib/crc32.js"(e,t){var r=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();t.exports=function(e,t,n,i){var s=r,o=i+n;e^=-1;for(var a=i;a<o;a++)e=e>>>8^s[255&(e^t[a])];return-1^e}}}),require_messages=__commonJS({"node_modules/pako/lib/zlib/messages.js"(e,t){t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}}}),require_deflate=__commonJS({"node_modules/pako/lib/zlib/deflate.js"(e){var t,r=require_common(),n=require_trees(),i=require_adler32(),s=require_crc32(),o=require_messages(),a=-2,l=258,h=262,u=103,c=113,d=666;function f(e,t){return e.msg=o[t],t}function p(e){return(e<<1)-(e>4?9:0)}function m(e){for(var t=e.length;--t>=0;)e[t]=0}function _(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(r.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function g(e,t){n._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,_(e.strm)}function v(e,t){e.pending_buf[e.pending++]=t}function y(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function b(e,t){var r,n,i=e.max_chain_length,s=e.strstart,o=e.prev_length,a=e.nice_match,u=e.strstart>e.w_size-h?e.strstart-(e.w_size-h):0,c=e.window,d=e.w_mask,f=e.prev,p=e.strstart+l,m=c[s+o-1],_=c[s+o];e.prev_length>=e.good_match&&(i>>=2),a>e.lookahead&&(a=e.lookahead);do{if(c[(r=t)+o]===_&&c[r+o-1]===m&&c[r]===c[s]&&c[++r]===c[s+1]){s+=2,r++;do{}while(c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&s<p);if(n=l-(p-s),s=p-l,n>o){if(e.match_start=t,o=n,n>=a)break;m=c[s+o-1],_=c[s+o]}}}while((t=f[t&d])>u&&0!=--i);return o<=e.lookahead?o:e.lookahead}function x(e){var t,n,o,a,l,u,c,d,f,p,m=e.w_size;do{if(a=e.window_size-e.lookahead-e.strstart,e.strstart>=m+(m-h)){r.arraySet(e.window,e.window,m,m,0),e.match_start-=m,e.strstart-=m,e.block_start-=m,t=n=e.hash_size;do{o=e.head[--t],e.head[t]=o>=m?o-m:0}while(--n);t=n=m;do{o=e.prev[--t],e.prev[t]=o>=m?o-m:0}while(--n);a+=m}if(0===e.strm.avail_in)break;if(u=e.strm,c=e.window,d=e.strstart+e.lookahead,f=a,p=void 0,(p=u.avail_in)>f&&(p=f),n=0===p?0:(u.avail_in-=p,r.arraySet(c,u.input,u.next_in,p,d),1===u.state.wrap?u.adler=i(u.adler,c,p,d):2===u.state.wrap&&(u.adler=s(u.adler,c,p,d)),u.next_in+=p,u.total_in+=p,p),e.lookahead+=n,e.lookahead+e.insert>=3)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+3-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<h&&0!==e.strm.avail_in)}function S(e,t){for(var r,i;;){if(e.lookahead<h){if(x(e),e.lookahead<h&&0===t)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-h&&(e.match_length=b(e,r)),e.match_length>=3)if(i=n._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else i=n._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(g(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(g(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(g(e,!1),0===e.strm.avail_out)?1:2}function T(e,t){for(var r,i,s;;){if(e.lookahead<h){if(x(e),e.lookahead<h&&0===t)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-h&&(e.match_length=b(e,r),e.match_length<=5&&(1===e.strategy||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){s=e.strstart+e.lookahead-3,i=n._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=s&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,i&&(g(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((i=n._tr_tally(e,0,e.window[e.strstart-1]))&&g(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=n._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(g(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(g(e,!1),0===e.strm.avail_out)?1:2}function E(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}function A(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(1146),this.dyn_dtree=new r.Buf16(122),this.bl_tree=new r.Buf16(78),m(this.dyn_ltree),m(this.dyn_dtree),m(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(16),this.heap=new r.Buf16(573),m(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(573),m(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function w(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:c,e.adler=2===t.wrap?0:1,t.last_flush=0,n._tr_init(t),0):f(e,a)}function C(e){var r,n=w(e);return 0===n&&((r=e.state).window_size=2*r.w_size,m(r.head),r.max_lazy_match=t[r.level].max_lazy,r.good_match=t[r.level].good_length,r.nice_match=t[r.level].nice_length,r.max_chain_length=t[r.level].max_chain,r.strstart=0,r.block_start=0,r.lookahead=0,r.insert=0,r.match_length=r.prev_length=2,r.match_available=0,r.ins_h=0),n}function O(e,t,n,i,s,o){if(!e)return a;var l=1;if(-1===t&&(t=6),i<0?(l=0,i=-i):i>15&&(l=2,i-=16),s<1||s>9||8!==n||i<8||i>15||t<0||t>9||o<0||o>4)return f(e,a);8===i&&(i=9);var h=new A;return e.state=h,h.strm=e,h.wrap=l,h.gzhead=null,h.w_bits=i,h.w_size=1<<h.w_bits,h.w_mask=h.w_size-1,h.hash_bits=s+7,h.hash_size=1<<h.hash_bits,h.hash_mask=h.hash_size-1,h.hash_shift=~~((h.hash_bits+3-1)/3),h.window=new r.Buf8(2*h.w_size),h.head=new r.Buf16(h.hash_size),h.prev=new r.Buf16(h.w_size),h.lit_bufsize=1<<s+6,h.pending_buf_size=4*h.lit_bufsize,h.pending_buf=new r.Buf8(h.pending_buf_size),h.d_buf=1*h.lit_bufsize,h.l_buf=3*h.lit_bufsize,h.level=t,h.strategy=o,h.method=n,C(e)}t=[new E(0,0,0,0,(function(e,t){var r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(x(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var n=e.block_start+r;if((0===e.strstart||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,g(e,!1),0===e.strm.avail_out)||e.strstart-e.block_start>=e.w_size-h&&(g(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(g(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(g(e,!1),e.strm.avail_out),1)})),new E(4,4,8,4,S),new E(4,5,16,8,S),new E(4,6,32,32,S),new E(4,4,16,16,T),new E(8,16,32,32,T),new E(8,16,128,128,T),new E(8,32,128,256,T),new E(32,128,258,1024,T),new E(32,258,258,4096,T)],e.deflateInit=function(e,t){return O(e,t,8,15,8,0)},e.deflateInit2=O,e.deflateReset=C,e.deflateResetKeep=w,e.deflateSetHeader=function(e,t){return e&&e.state&&2===e.state.wrap?(e.state.gzhead=t,0):a},e.deflate=function(e,r){var i,o,h,b;if(!e||!e.state||r>5||r<0)return e?f(e,a):a;if(o=e.state,!e.output||!e.input&&0!==e.avail_in||o.status===d&&4!==r)return f(e,0===e.avail_out?-5:a);if(o.strm=e,i=o.last_flush,o.last_flush=r,42===o.status)if(2===o.wrap)e.adler=0,v(o,31),v(o,139),v(o,8),o.gzhead?(v(o,(o.gzhead.text?1:0)+(o.gzhead.hcrc?2:0)+(o.gzhead.extra?4:0)+(o.gzhead.name?8:0)+(o.gzhead.comment?16:0)),v(o,255&o.gzhead.time),v(o,o.gzhead.time>>8&255),v(o,o.gzhead.time>>16&255),v(o,o.gzhead.time>>24&255),v(o,9===o.level?2:o.strategy>=2||o.level<2?4:0),v(o,255&o.gzhead.os),o.gzhead.extra&&o.gzhead.extra.length&&(v(o,255&o.gzhead.extra.length),v(o,o.gzhead.extra.length>>8&255)),o.gzhead.hcrc&&(e.adler=s(e.adler,o.pending_buf,o.pending,0)),o.gzindex=0,o.status=69):(v(o,0),v(o,0),v(o,0),v(o,0),v(o,0),v(o,9===o.level?2:o.strategy>=2||o.level<2?4:0),v(o,3),o.status=c);else{var S=8+(o.w_bits-8<<4)<<8;S|=(o.strategy>=2||o.level<2?0:o.level<6?1:6===o.level?2:3)<<6,0!==o.strstart&&(S|=32),S+=31-S%31,o.status=c,y(o,S),0!==o.strstart&&(y(o,e.adler>>>16),y(o,65535&e.adler)),e.adler=1}if(69===o.status)if(o.gzhead.extra){for(h=o.pending;o.gzindex<(65535&o.gzhead.extra.length)&&(o.pending!==o.pending_buf_size||(o.gzhead.hcrc&&o.pending>h&&(e.adler=s(e.adler,o.pending_buf,o.pending-h,h)),_(e),h=o.pending,o.pending!==o.pending_buf_size));)v(o,255&o.gzhead.extra[o.gzindex]),o.gzindex++;o.gzhead.hcrc&&o.pending>h&&(e.adler=s(e.adler,o.pending_buf,o.pending-h,h)),o.gzindex===o.gzhead.extra.length&&(o.gzindex=0,o.status=73)}else o.status=73;if(73===o.status)if(o.gzhead.name){h=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>h&&(e.adler=s(e.adler,o.pending_buf,o.pending-h,h)),_(e),h=o.pending,o.pending===o.pending_buf_size)){b=1;break}b=o.gzindex<o.gzhead.name.length?255&o.gzhead.name.charCodeAt(o.gzindex++):0,v(o,b)}while(0!==b);o.gzhead.hcrc&&o.pending>h&&(e.adler=s(e.adler,o.pending_buf,o.pending-h,h)),0===b&&(o.gzindex=0,o.status=91)}else o.status=91;if(91===o.status)if(o.gzhead.comment){h=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>h&&(e.adler=s(e.adler,o.pending_buf,o.pending-h,h)),_(e),h=o.pending,o.pending===o.pending_buf_size)){b=1;break}b=o.gzindex<o.gzhead.comment.length?255&o.gzhead.comment.charCodeAt(o.gzindex++):0,v(o,b)}while(0!==b);o.gzhead.hcrc&&o.pending>h&&(e.adler=s(e.adler,o.pending_buf,o.pending-h,h)),0===b&&(o.status=u)}else o.status=u;if(o.status===u&&(o.gzhead.hcrc?(o.pending+2>o.pending_buf_size&&_(e),o.pending+2<=o.pending_buf_size&&(v(o,255&e.adler),v(o,e.adler>>8&255),e.adler=0,o.status=c)):o.status=c),0!==o.pending){if(_(e),0===e.avail_out)return o.last_flush=-1,0}else if(0===e.avail_in&&p(r)<=p(i)&&4!==r)return f(e,-5);if(o.status===d&&0!==e.avail_in)return f(e,-5);if(0!==e.avail_in||0!==o.lookahead||0!==r&&o.status!==d){var T=2===o.strategy?function(e,t){for(var r;;){if(0===e.lookahead&&(x(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,r=n._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(g(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(g(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(g(e,!1),0===e.strm.avail_out)?1:2}(o,r):3===o.strategy?function(e,t){for(var r,i,s,o,a=e.window;;){if(e.lookahead<=l){if(x(e),e.lookahead<=l&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(i=a[s=e.strstart-1])===a[++s]&&i===a[++s]&&i===a[++s]){o=e.strstart+l;do{}while(i===a[++s]&&i===a[++s]&&i===a[++s]&&i===a[++s]&&i===a[++s]&&i===a[++s]&&i===a[++s]&&i===a[++s]&&s<o);e.match_length=l-(o-s),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(r=n._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=n._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(g(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(g(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(g(e,!1),0===e.strm.avail_out)?1:2}(o,r):t[o.level].func(o,r);if((3===T||4===T)&&(o.status=d),1===T||3===T)return 0===e.avail_out&&(o.last_flush=-1),0;if(2===T&&(1===r?n._tr_align(o):5!==r&&(n._tr_stored_block(o,0,0,!1),3===r&&(m(o.head),0===o.lookahead&&(o.strstart=0,o.block_start=0,o.insert=0))),_(e),0===e.avail_out))return o.last_flush=-1,0}return 4!==r?0:o.wrap<=0?1:(2===o.wrap?(v(o,255&e.adler),v(o,e.adler>>8&255),v(o,e.adler>>16&255),v(o,e.adler>>24&255),v(o,255&e.total_in),v(o,e.total_in>>8&255),v(o,e.total_in>>16&255),v(o,e.total_in>>24&255)):(y(o,e.adler>>>16),y(o,65535&e.adler)),_(e),o.wrap>0&&(o.wrap=-o.wrap),0!==o.pending?0:1)},e.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&t!==u&&t!==c&&t!==d?f(e,a):(e.state=null,t===c?f(e,-3):0):a},e.deflateSetDictionary=function(e,t){var n,s,o,l,h,u,c,d,f=t.length;if(!e||!e.state||2===(l=(n=e.state).wrap)||1===l&&42!==n.status||n.lookahead)return a;for(1===l&&(e.adler=i(e.adler,t,f,0)),n.wrap=0,f>=n.w_size&&(0===l&&(m(n.head),n.strstart=0,n.block_start=0,n.insert=0),d=new r.Buf8(n.w_size),r.arraySet(d,t,f-n.w_size,n.w_size,0),t=d,f=n.w_size),h=e.avail_in,u=e.next_in,c=e.input,e.avail_in=f,e.next_in=0,e.input=t,x(n);n.lookahead>=3;){s=n.strstart,o=n.lookahead-2;do{n.ins_h=(n.ins_h<<n.hash_shift^n.window[s+3-1])&n.hash_mask,n.prev[s&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=s,s++}while(--o);n.strstart=s,n.lookahead=2,x(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,e.next_in=u,e.input=c,e.avail_in=h,n.wrap=l,0},e.deflateInfo="pako deflate (from Nodeca project)"}}),require_strings=__commonJS({"node_modules/pako/lib/utils/strings.js"(e){var t=require_common(),r=!0,n=!0;try{String.fromCharCode.apply(null,[0])}catch(e){r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){n=!1}for(var i=new t.Buf8(256),s=0;s<256;s++)i[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;function o(e,i){if(i<65534&&(e.subarray&&n||!e.subarray&&r))return String.fromCharCode.apply(null,t.shrinkBuf(e,i));for(var s="",o=0;o<i;o++)s+=String.fromCharCode(e[o]);return s}i[254]=i[254]=1,e.string2buf=function(e){var r,n,i,s,o,a=e.length,l=0;for(s=0;s<a;s++)55296==(64512&(n=e.charCodeAt(s)))&&s+1<a&&56320==(64512&(i=e.charCodeAt(s+1)))&&(n=65536+(n-55296<<10)+(i-56320),s++),l+=n<128?1:n<2048?2:n<65536?3:4;for(r=new t.Buf8(l),o=0,s=0;o<l;s++)55296==(64512&(n=e.charCodeAt(s)))&&s+1<a&&56320==(64512&(i=e.charCodeAt(s+1)))&&(n=65536+(n-55296<<10)+(i-56320),s++),n<128?r[o++]=n:n<2048?(r[o++]=192|n>>>6,r[o++]=128|63&n):n<65536?(r[o++]=224|n>>>12,r[o++]=128|n>>>6&63,r[o++]=128|63&n):(r[o++]=240|n>>>18,r[o++]=128|n>>>12&63,r[o++]=128|n>>>6&63,r[o++]=128|63&n);return r},e.buf2binstring=function(e){return o(e,e.length)},e.binstring2buf=function(e){for(var r=new t.Buf8(e.length),n=0,i=r.length;n<i;n++)r[n]=e.charCodeAt(n);return r},e.buf2string=function(e,t){var r,n,s,a,l=t||e.length,h=new Array(2*l);for(n=0,r=0;r<l;)if((s=e[r++])<128)h[n++]=s;else if((a=i[s])>4)h[n++]=65533,r+=a-1;else{for(s&=2===a?31:3===a?15:7;a>1&&r<l;)s=s<<6|63&e[r++],a--;a>1?h[n++]=65533:s<65536?h[n++]=s:(s-=65536,h[n++]=55296|s>>10&1023,h[n++]=56320|1023&s)}return o(h,n)},e.utf8border=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;r>=0&&128==(192&e[r]);)r--;return r<0||0===r?t:r+i[e[r]]>t?r:t}}}),require_zstream=__commonJS({"node_modules/pako/lib/zlib/zstream.js"(e,t){t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}}}),require_deflate2=__commonJS({"node_modules/pako/lib/deflate.js"(e){var t=require_deflate(),r=require_common(),n=require_strings(),i=require_messages(),s=require_zstream(),o=Object.prototype.toString;function a(e){if(!(this instanceof a))return new a(e);this.options=r.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var l=this.options;l.raw&&l.windowBits>0?l.windowBits=-l.windowBits:l.gzip&&l.windowBits>0&&l.windowBits<16&&(l.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var h=t.deflateInit2(this.strm,l.level,l.method,l.windowBits,l.memLevel,l.strategy);if(0!==h)throw new Error(i[h]);if(l.header&&t.deflateSetHeader(this.strm,l.header),l.dictionary){var u;if(u="string"==typeof l.dictionary?n.string2buf(l.dictionary):"[object ArrayBuffer]"===o.call(l.dictionary)?new Uint8Array(l.dictionary):l.dictionary,0!==(h=t.deflateSetDictionary(this.strm,u)))throw new Error(i[h]);this._dict_set=!0}}function l(e,t){var r=new a(t);if(r.push(e,!0),r.err)throw r.msg||i[r.err];return r.result}a.prototype.push=function(e,i){var s,a,l=this.strm,h=this.options.chunkSize;if(this.ended)return!1;a=i===~~i?i:!0===i?4:0,"string"==typeof e?l.input=n.string2buf(e):"[object ArrayBuffer]"===o.call(e)?l.input=new Uint8Array(e):l.input=e,l.next_in=0,l.avail_in=l.input.length;do{if(0===l.avail_out&&(l.output=new r.Buf8(h),l.next_out=0,l.avail_out=h),1!==(s=t.deflate(l,a))&&0!==s)return this.onEnd(s),this.ended=!0,!1;(0===l.avail_out||0===l.avail_in&&(4===a||2===a))&&("string"===this.options.to?this.onData(n.buf2binstring(r.shrinkBuf(l.output,l.next_out))):this.onData(r.shrinkBuf(l.output,l.next_out)))}while((l.avail_in>0||0===l.avail_out)&&1!==s);return 4===a?(s=t.deflateEnd(this.strm),this.onEnd(s),this.ended=!0,0===s):(2===a&&(this.onEnd(0),l.avail_out=0),!0)},a.prototype.onData=function(e){this.chunks.push(e)},a.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},e.Deflate=a,e.deflate=l,e.deflateRaw=function(e,t){return(t=t||{}).raw=!0,l(e,t)},e.gzip=function(e,t){return(t=t||{}).gzip=!0,l(e,t)}}}),require_inffast=__commonJS({"node_modules/pako/lib/zlib/inffast.js"(e,t){t.exports=function(e,t){var r,n,i,s,o,a,l,h,u,c,d,f,p,m,_,g,v,y,b,x,S,T,E,A,w;r=e.state,n=e.next_in,A=e.input,i=n+(e.avail_in-5),s=e.next_out,w=e.output,o=s-(t-e.avail_out),a=s+(e.avail_out-257),l=r.dmax,h=r.wsize,u=r.whave,c=r.wnext,d=r.window,f=r.hold,p=r.bits,m=r.lencode,_=r.distcode,g=(1<<r.lenbits)-1,v=(1<<r.distbits)-1;e:do{p<15&&(f+=A[n++]<<p,p+=8,f+=A[n++]<<p,p+=8),y=m[f&g];t:for(;;){if(f>>>=b=y>>>24,p-=b,0==(b=y>>>16&255))w[s++]=65535&y;else{if(!(16&b)){if(0==(64&b)){y=m[(65535&y)+(f&(1<<b)-1)];continue t}if(32&b){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}x=65535&y,(b&=15)&&(p<b&&(f+=A[n++]<<p,p+=8),x+=f&(1<<b)-1,f>>>=b,p-=b),p<15&&(f+=A[n++]<<p,p+=8,f+=A[n++]<<p,p+=8),y=_[f&v];r:for(;;){if(f>>>=b=y>>>24,p-=b,!(16&(b=y>>>16&255))){if(0==(64&b)){y=_[(65535&y)+(f&(1<<b)-1)];continue r}e.msg="invalid distance code",r.mode=30;break e}if(S=65535&y,p<(b&=15)&&(f+=A[n++]<<p,(p+=8)<b&&(f+=A[n++]<<p,p+=8)),(S+=f&(1<<b)-1)>l){e.msg="invalid distance too far back",r.mode=30;break e}if(f>>>=b,p-=b,S>(b=s-o)){if((b=S-b)>u&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(T=0,E=d,0===c){if(T+=h-b,b<x){x-=b;do{w[s++]=d[T++]}while(--b);T=s-S,E=w}}else if(c<b){if(T+=h+c-b,(b-=c)<x){x-=b;do{w[s++]=d[T++]}while(--b);if(T=0,c<x){x-=b=c;do{w[s++]=d[T++]}while(--b);T=s-S,E=w}}}else if(T+=c-b,b<x){x-=b;do{w[s++]=d[T++]}while(--b);T=s-S,E=w}for(;x>2;)w[s++]=E[T++],w[s++]=E[T++],w[s++]=E[T++],x-=3;x&&(w[s++]=E[T++],x>1&&(w[s++]=E[T++]))}else{T=s-S;do{w[s++]=w[T++],w[s++]=w[T++],w[s++]=w[T++],x-=3}while(x>2);x&&(w[s++]=w[T++],x>1&&(w[s++]=w[T++]))}break}}break}}while(n<i&&s<a);n-=x=p>>3,f&=(1<<(p-=x<<3))-1,e.next_in=n,e.next_out=s,e.avail_in=n<i?i-n+5:5-(n-i),e.avail_out=s<a?a-s+257:257-(s-a),r.hold=f,r.bits=p}}}),require_inftrees=__commonJS({"node_modules/pako/lib/zlib/inftrees.js"(e,t){var r=require_common(),n=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],i=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],o=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,a,l,h,u,c,d){var f,p,m,_,g,v,y,b,x,S=d.bits,T=0,E=0,A=0,w=0,C=0,O=0,R=0,D=0,I=0,M=0,N=null,P=0,k=new r.Buf16(16),F=new r.Buf16(16),L=null,B=0;for(T=0;T<=15;T++)k[T]=0;for(E=0;E<l;E++)k[t[a+E]]++;for(C=S,w=15;w>=1&&0===k[w];w--);if(C>w&&(C=w),0===w)return h[u++]=20971520,h[u++]=20971520,d.bits=1,0;for(A=1;A<w&&0===k[A];A++);for(C<A&&(C=A),D=1,T=1;T<=15;T++)if(D<<=1,(D-=k[T])<0)return-1;if(D>0&&(0===e||1!==w))return-1;for(F[1]=0,T=1;T<15;T++)F[T+1]=F[T]+k[T];for(E=0;E<l;E++)0!==t[a+E]&&(c[F[t[a+E]]++]=E);if(0===e?(N=L=c,v=19):1===e?(N=n,P-=257,L=i,B-=257,v=256):(N=s,L=o,v=-1),M=0,E=0,T=A,g=u,O=C,R=0,m=-1,_=(I=1<<C)-1,1===e&&I>852||2===e&&I>592)return 1;for(;;){y=T-R,c[E]<v?(b=0,x=c[E]):c[E]>v?(b=L[B+c[E]],x=N[P+c[E]]):(b=96,x=0),f=1<<T-R,A=p=1<<O;do{h[g+(M>>R)+(p-=f)]=y<<24|b<<16|x|0}while(0!==p);for(f=1<<T-1;M&f;)f>>=1;if(0!==f?(M&=f-1,M+=f):M=0,E++,0==--k[T]){if(T===w)break;T=t[a+c[E]]}if(T>C&&(M&_)!==m){for(0===R&&(R=C),g+=A,D=1<<(O=T-R);O+R<w&&!((D-=k[O+R])<=0);)O++,D<<=1;if(I+=1<<O,1===e&&I>852||2===e&&I>592)return 1;h[m=M&_]=C<<24|O<<16|g-u|0}}return 0!==M&&(h[g+M]=T-R<<24|64<<16|0),d.bits=C,0}}}),require_inflate=__commonJS({"node_modules/pako/lib/zlib/inflate.js"(e){var t=require_common(),r=require_adler32(),n=require_crc32(),i=require_inffast(),s=require_inftrees(),o=-2,a=12,l=30;function h(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function u(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new t.Buf16(320),this.work=new t.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function c(e){var r;return e&&e.state?(r=e.state,e.total_in=e.total_out=r.total=0,e.msg="",r.wrap&&(e.adler=1&r.wrap),r.mode=1,r.last=0,r.havedict=0,r.dmax=32768,r.head=null,r.hold=0,r.bits=0,r.lencode=r.lendyn=new t.Buf32(852),r.distcode=r.distdyn=new t.Buf32(592),r.sane=1,r.back=-1,0):o}function d(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,c(e)):o}function f(e,t){var r,n;return!e||!e.state||(n=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15))?o:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,d(e))}function p(e,t){var r,n;return e?(n=new u,e.state=n,n.window=null,0!==(r=f(e,t))&&(e.state=null),r):o}var m,_,g=!0;function v(e){if(g){var r;for(m=new t.Buf32(512),_=new t.Buf32(32),r=0;r<144;)e.lens[r++]=8;for(;r<256;)e.lens[r++]=9;for(;r<280;)e.lens[r++]=7;for(;r<288;)e.lens[r++]=8;for(s(1,e.lens,0,288,m,0,e.work,{bits:9}),r=0;r<32;)e.lens[r++]=5;s(2,e.lens,0,32,_,0,e.work,{bits:5}),g=!1}e.lencode=m,e.lenbits=9,e.distcode=_,e.distbits=5}function y(e,r,n,i){var s,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new t.Buf8(o.wsize)),i>=o.wsize?(t.arraySet(o.window,r,n-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):((s=o.wsize-o.wnext)>i&&(s=i),t.arraySet(o.window,r,n-i,s,o.wnext),(i-=s)?(t.arraySet(o.window,r,n-i,i,0),o.wnext=i,o.whave=o.wsize):(o.wnext+=s,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=s))),0}e.inflateReset=d,e.inflateReset2=f,e.inflateResetKeep=c,e.inflateInit=function(e){return p(e,15)},e.inflateInit2=p,e.inflate=function(e,u){var c,d,f,p,m,_,g,b,x,S,T,E,A,w,C,O,R,D,I,M,N,P,k,F,L=0,B=new t.Buf8(4),U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return o;(c=e.state).mode===a&&(c.mode=13),m=e.next_out,f=e.output,g=e.avail_out,p=e.next_in,d=e.input,_=e.avail_in,b=c.hold,x=c.bits,S=_,T=g,P=0;e:for(;;)switch(c.mode){case 1:if(0===c.wrap){c.mode=13;break}for(;x<16;){if(0===_)break e;_--,b+=d[p++]<<x,x+=8}if(2&c.wrap&&35615===b){c.check=0,B[0]=255&b,B[1]=b>>>8&255,c.check=n(c.check,B,2,0),b=0,x=0,c.mode=2;break}if(c.flags=0,c.head&&(c.head.done=!1),!(1&c.wrap)||(((255&b)<<8)+(b>>8))%31){e.msg="incorrect header check",c.mode=l;break}if(8!=(15&b)){e.msg="unknown compression method",c.mode=l;break}if(x-=4,N=8+(15&(b>>>=4)),0===c.wbits)c.wbits=N;else if(N>c.wbits){e.msg="invalid window size",c.mode=l;break}c.dmax=1<<N,e.adler=c.check=1,c.mode=512&b?10:a,b=0,x=0;break;case 2:for(;x<16;){if(0===_)break e;_--,b+=d[p++]<<x,x+=8}if(c.flags=b,8!=(255&c.flags)){e.msg="unknown compression method",c.mode=l;break}if(57344&c.flags){e.msg="unknown header flags set",c.mode=l;break}c.head&&(c.head.text=b>>8&1),512&c.flags&&(B[0]=255&b,B[1]=b>>>8&255,c.check=n(c.check,B,2,0)),b=0,x=0,c.mode=3;case 3:for(;x<32;){if(0===_)break e;_--,b+=d[p++]<<x,x+=8}c.head&&(c.head.time=b),512&c.flags&&(B[0]=255&b,B[1]=b>>>8&255,B[2]=b>>>16&255,B[3]=b>>>24&255,c.check=n(c.check,B,4,0)),b=0,x=0,c.mode=4;case 4:for(;x<16;){if(0===_)break e;_--,b+=d[p++]<<x,x+=8}c.head&&(c.head.xflags=255&b,c.head.os=b>>8),512&c.flags&&(B[0]=255&b,B[1]=b>>>8&255,c.check=n(c.check,B,2,0)),b=0,x=0,c.mode=5;case 5:if(1024&c.flags){for(;x<16;){if(0===_)break e;_--,b+=d[p++]<<x,x+=8}c.length=b,c.head&&(c.head.extra_len=b),512&c.flags&&(B[0]=255&b,B[1]=b>>>8&255,c.check=n(c.check,B,2,0)),b=0,x=0}else c.head&&(c.head.extra=null);c.mode=6;case 6:if(1024&c.flags&&((E=c.length)>_&&(E=_),E&&(c.head&&(N=c.head.extra_len-c.length,c.head.extra||(c.head.extra=new Array(c.head.extra_len)),t.arraySet(c.head.extra,d,p,E,N)),512&c.flags&&(c.check=n(c.check,d,E,p)),_-=E,p+=E,c.length-=E),c.length))break e;c.length=0,c.mode=7;case 7:if(2048&c.flags){if(0===_)break e;E=0;do{N=d[p+E++],c.head&&N&&c.length<65536&&(c.head.name+=String.fromCharCode(N))}while(N&&E<_);if(512&c.flags&&(c.check=n(c.check,d,E,p)),_-=E,p+=E,N)break e}else c.head&&(c.head.name=null);c.length=0,c.mode=8;case 8:if(4096&c.flags){if(0===_)break e;E=0;do{N=d[p+E++],c.head&&N&&c.length<65536&&(c.head.comment+=String.fromCharCode(N))}while(N&&E<_);if(512&c.flags&&(c.check=n(c.check,d,E,p)),_-=E,p+=E,N)break e}else c.head&&(c.head.comment=null);c.mode=9;case 9:if(512&c.flags){for(;x<16;){if(0===_)break e;_--,b+=d[p++]<<x,x+=8}if(b!==(65535&c.check)){e.msg="header crc mismatch",c.mode=l;break}b=0,x=0}c.head&&(c.head.hcrc=c.flags>>9&1,c.head.done=!0),e.adler=c.check=0,c.mode=a;break;case 10:for(;x<32;){if(0===_)break e;_--,b+=d[p++]<<x,x+=8}e.adler=c.check=h(b),b=0,x=0,c.mode=11;case 11:if(0===c.havedict)return e.next_out=m,e.avail_out=g,e.next_in=p,e.avail_in=_,c.hold=b,c.bits=x,2;e.adler=c.check=1,c.mode=a;case a:if(5===u||6===u)break e;case 13:if(c.last){b>>>=7&x,x-=7&x,c.mode=27;break}for(;x<3;){if(0===_)break e;_--,b+=d[p++]<<x,x+=8}switch(c.last=1&b,x-=1,3&(b>>>=1)){case 0:c.mode=14;break;case 1:if(v(c),c.mode=20,6===u){b>>>=2,x-=2;break e}break;case 2:c.mode=17;break;case 3:e.msg="invalid block type",c.mode=l}b>>>=2,x-=2;break;case 14:for(b>>>=7&x,x-=7&x;x<32;){if(0===_)break e;_--,b+=d[p++]<<x,x+=8}if((65535&b)!=(b>>>16^65535)){e.msg="invalid stored block lengths",c.mode=l;break}if(c.length=65535&b,b=0,x=0,c.mode=15,6===u)break e;case 15:c.mode=16;case 16:if(E=c.length){if(E>_&&(E=_),E>g&&(E=g),0===E)break e;t.arraySet(f,d,p,E,m),_-=E,p+=E,g-=E,m+=E,c.length-=E;break}c.mode=a;break;case 17:for(;x<14;){if(0===_)break e;_--,b+=d[p++]<<x,x+=8}if(c.nlen=257+(31&b),b>>>=5,x-=5,c.ndist=1+(31&b),b>>>=5,x-=5,c.ncode=4+(15&b),b>>>=4,x-=4,c.nlen>286||c.ndist>30){e.msg="too many length or distance symbols",c.mode=l;break}c.have=0,c.mode=18;case 18:for(;c.have<c.ncode;){for(;x<3;){if(0===_)break e;_--,b+=d[p++]<<x,x+=8}c.lens[U[c.have++]]=7&b,b>>>=3,x-=3}for(;c.have<19;)c.lens[U[c.have++]]=0;if(c.lencode=c.lendyn,c.lenbits=7,k={bits:c.lenbits},P=s(0,c.lens,0,19,c.lencode,0,c.work,k),c.lenbits=k.bits,P){e.msg="invalid code lengths set",c.mode=l;break}c.have=0,c.mode=19;case 19:for(;c.have<c.nlen+c.ndist;){for(;O=(L=c.lencode[b&(1<<c.lenbits)-1])>>>16&255,R=65535&L,!((C=L>>>24)<=x);){if(0===_)break e;_--,b+=d[p++]<<x,x+=8}if(R<16)b>>>=C,x-=C,c.lens[c.have++]=R;else{if(16===R){for(F=C+2;x<F;){if(0===_)break e;_--,b+=d[p++]<<x,x+=8}if(b>>>=C,x-=C,0===c.have){e.msg="invalid bit length repeat",c.mode=l;break}N=c.lens[c.have-1],E=3+(3&b),b>>>=2,x-=2}else if(17===R){for(F=C+3;x<F;){if(0===_)break e;_--,b+=d[p++]<<x,x+=8}x-=C,N=0,E=3+(7&(b>>>=C)),b>>>=3,x-=3}else{for(F=C+7;x<F;){if(0===_)break e;_--,b+=d[p++]<<x,x+=8}x-=C,N=0,E=11+(127&(b>>>=C)),b>>>=7,x-=7}if(c.have+E>c.nlen+c.ndist){e.msg="invalid bit length repeat",c.mode=l;break}for(;E--;)c.lens[c.have++]=N}}if(c.mode===l)break;if(0===c.lens[256]){e.msg="invalid code -- missing end-of-block",c.mode=l;break}if(c.lenbits=9,k={bits:c.lenbits},P=s(1,c.lens,0,c.nlen,c.lencode,0,c.work,k),c.lenbits=k.bits,P){e.msg="invalid literal/lengths set",c.mode=l;break}if(c.distbits=6,c.distcode=c.distdyn,k={bits:c.distbits},P=s(2,c.lens,c.nlen,c.ndist,c.distcode,0,c.work,k),c.distbits=k.bits,P){e.msg="invalid distances set",c.mode=l;break}if(c.mode=20,6===u)break e;case 20:c.mode=21;case 21:if(_>=6&&g>=258){e.next_out=m,e.avail_out=g,e.next_in=p,e.avail_in=_,c.hold=b,c.bits=x,i(e,T),m=e.next_out,f=e.output,g=e.avail_out,p=e.next_in,d=e.input,_=e.avail_in,b=c.hold,x=c.bits,c.mode===a&&(c.back=-1);break}for(c.back=0;O=(L=c.lencode[b&(1<<c.lenbits)-1])>>>16&255,R=65535&L,!((C=L>>>24)<=x);){if(0===_)break e;_--,b+=d[p++]<<x,x+=8}if(O&&0==(240&O)){for(D=C,I=O,M=R;O=(L=c.lencode[M+((b&(1<<D+I)-1)>>D)])>>>16&255,R=65535&L,!(D+(C=L>>>24)<=x);){if(0===_)break e;_--,b+=d[p++]<<x,x+=8}b>>>=D,x-=D,c.back+=D}if(b>>>=C,x-=C,c.back+=C,c.length=R,0===O){c.mode=26;break}if(32&O){c.back=-1,c.mode=a;break}if(64&O){e.msg="invalid literal/length code",c.mode=l;break}c.extra=15&O,c.mode=22;case 22:if(c.extra){for(F=c.extra;x<F;){if(0===_)break e;_--,b+=d[p++]<<x,x+=8}c.length+=b&(1<<c.extra)-1,b>>>=c.extra,x-=c.extra,c.back+=c.extra}c.was=c.length,c.mode=23;case 23:for(;O=(L=c.distcode[b&(1<<c.distbits)-1])>>>16&255,R=65535&L,!((C=L>>>24)<=x);){if(0===_)break e;_--,b+=d[p++]<<x,x+=8}if(0==(240&O)){for(D=C,I=O,M=R;O=(L=c.distcode[M+((b&(1<<D+I)-1)>>D)])>>>16&255,R=65535&L,!(D+(C=L>>>24)<=x);){if(0===_)break e;_--,b+=d[p++]<<x,x+=8}b>>>=D,x-=D,c.back+=D}if(b>>>=C,x-=C,c.back+=C,64&O){e.msg="invalid distance code",c.mode=l;break}c.offset=R,c.extra=15&O,c.mode=24;case 24:if(c.extra){for(F=c.extra;x<F;){if(0===_)break e;_--,b+=d[p++]<<x,x+=8}c.offset+=b&(1<<c.extra)-1,b>>>=c.extra,x-=c.extra,c.back+=c.extra}if(c.offset>c.dmax){e.msg="invalid distance too far back",c.mode=l;break}c.mode=25;case 25:if(0===g)break e;if(E=T-g,c.offset>E){if((E=c.offset-E)>c.whave&&c.sane){e.msg="invalid distance too far back",c.mode=l;break}E>c.wnext?(E-=c.wnext,A=c.wsize-E):A=c.wnext-E,E>c.length&&(E=c.length),w=c.window}else w=f,A=m-c.offset,E=c.length;E>g&&(E=g),g-=E,c.length-=E;do{f[m++]=w[A++]}while(--E);0===c.length&&(c.mode=21);break;case 26:if(0===g)break e;f[m++]=c.length,g--,c.mode=21;break;case 27:if(c.wrap){for(;x<32;){if(0===_)break e;_--,b|=d[p++]<<x,x+=8}if(T-=g,e.total_out+=T,c.total+=T,T&&(e.adler=c.check=c.flags?n(c.check,f,T,m-T):r(c.check,f,T,m-T)),T=g,(c.flags?b:h(b))!==c.check){e.msg="incorrect data check",c.mode=l;break}b=0,x=0}c.mode=28;case 28:if(c.wrap&&c.flags){for(;x<32;){if(0===_)break e;_--,b+=d[p++]<<x,x+=8}if(b!==(4294967295&c.total)){e.msg="incorrect length check",c.mode=l;break}b=0,x=0}c.mode=29;case 29:P=1;break e;case l:P=-3;break e;case 31:return-4;default:return o}return e.next_out=m,e.avail_out=g,e.next_in=p,e.avail_in=_,c.hold=b,c.bits=x,(c.wsize||T!==e.avail_out&&c.mode<l&&(c.mode<27||4!==u))&&y(e,e.output,e.next_out,T-e.avail_out)?(c.mode=31,-4):(S-=e.avail_in,T-=e.avail_out,e.total_in+=S,e.total_out+=T,c.total+=T,c.wrap&&T&&(e.adler=c.check=c.flags?n(c.check,f,T,e.next_out-T):r(c.check,f,T,e.next_out-T)),e.data_type=c.bits+(c.last?64:0)+(c.mode===a?128:0)+(20===c.mode||15===c.mode?256:0),(0===S&&0===T||4===u)&&0===P&&(P=-5),P)},e.inflateEnd=function(e){if(!e||!e.state)return o;var t=e.state;return t.window&&(t.window=null),e.state=null,0},e.inflateGetHeader=function(e,t){var r;return e&&e.state&&0!=(2&(r=e.state).wrap)?(r.head=t,t.done=!1,0):o},e.inflateSetDictionary=function(e,t){var n,i=t.length;return e&&e.state&&(0===(n=e.state).wrap||11===n.mode)?11===n.mode&&r(1,t,i,0)!==n.check?-3:y(e,t,i,i)?(n.mode=31,-4):(n.havedict=1,0):o},e.inflateInfo="pako inflate (from Nodeca project)"}}),require_constants=__commonJS({"node_modules/pako/lib/zlib/constants.js"(e,t){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}}}),require_gzheader=__commonJS({"node_modules/pako/lib/zlib/gzheader.js"(e,t){t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}}}),require_inflate2=__commonJS({"node_modules/pako/lib/inflate.js"(e){var t=require_inflate(),r=require_common(),n=require_strings(),i=require_constants(),s=require_messages(),o=require_zstream(),a=require_gzheader(),l=Object.prototype.toString;function h(e){if(!(this instanceof h))return new h(e);this.options=r.assign({chunkSize:16384,windowBits:0,to:""},e||{});var u=this.options;u.raw&&u.windowBits>=0&&u.windowBits<16&&(u.windowBits=-u.windowBits,0===u.windowBits&&(u.windowBits=-15)),u.windowBits>=0&&u.windowBits<16&&!(e&&e.windowBits)&&(u.windowBits+=32),u.windowBits>15&&u.windowBits<48&&0==(15&u.windowBits)&&(u.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0;var c=t.inflateInit2(this.strm,u.windowBits);if(c!==i.Z_OK)throw new Error(s[c]);if(this.header=new a,t.inflateGetHeader(this.strm,this.header),u.dictionary&&("string"==typeof u.dictionary?u.dictionary=n.string2buf(u.dictionary):"[object ArrayBuffer]"===l.call(u.dictionary)&&(u.dictionary=new Uint8Array(u.dictionary)),u.raw&&(c=t.inflateSetDictionary(this.strm,u.dictionary))!==i.Z_OK))throw new Error(s[c])}function u(e,t){var r=new h(t);if(r.push(e,!0),r.err)throw r.msg||s[r.err];return r.result}h.prototype.push=function(e,s){var o,a,h,u,c,d=this.strm,f=this.options.chunkSize,p=this.options.dictionary,m=!1;if(this.ended)return!1;a=s===~~s?s:!0===s?i.Z_FINISH:i.Z_NO_FLUSH,"string"==typeof e?d.input=n.binstring2buf(e):"[object ArrayBuffer]"===l.call(e)?d.input=new Uint8Array(e):d.input=e,d.next_in=0,d.avail_in=d.input.length;do{if(0===d.avail_out&&(d.output=new r.Buf8(f),d.next_out=0,d.avail_out=f),(o=t.inflate(d,i.Z_NO_FLUSH))===i.Z_NEED_DICT&&p&&(o=t.inflateSetDictionary(this.strm,p)),o===i.Z_BUF_ERROR&&!0===m&&(o=i.Z_OK,m=!1),o!==i.Z_STREAM_END&&o!==i.Z_OK)return this.onEnd(o),this.ended=!0,!1;d.next_out&&(0===d.avail_out||o===i.Z_STREAM_END||0===d.avail_in&&(a===i.Z_FINISH||a===i.Z_SYNC_FLUSH))&&("string"===this.options.to?(h=n.utf8border(d.output,d.next_out),u=d.next_out-h,c=n.buf2string(d.output,h),d.next_out=u,d.avail_out=f-u,u&&r.arraySet(d.output,d.output,h,u,0),this.onData(c)):this.onData(r.shrinkBuf(d.output,d.next_out))),0===d.avail_in&&0===d.avail_out&&(m=!0)}while((d.avail_in>0||0===d.avail_out)&&o!==i.Z_STREAM_END);return o===i.Z_STREAM_END&&(a=i.Z_FINISH),a===i.Z_FINISH?(o=t.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,o===i.Z_OK):(a===i.Z_SYNC_FLUSH&&(this.onEnd(i.Z_OK),d.avail_out=0),!0)},h.prototype.onData=function(e){this.chunks.push(e)},h.prototype.onEnd=function(e){e===i.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},e.Inflate=h,e.inflate=u,e.inflateRaw=function(e,t){return(t=t||{}).raw=!0,u(e,t)},e.ungzip=u}}),require_pako=__commonJS({"node_modules/pako/index.js"(e,t){var r={};(0,require_common().assign)(r,require_deflate2(),require_inflate2(),require_constants()),t.exports=r}}),require_alea=__commonJS({"node_modules/seedrandom/lib/alea.js"(e,t){!function(e,t,r){function n(e){var t,r=this,n=(t=4022871197,function(e){e=String(e);for(var r=0;r<e.length;r++){var n=.02519603282416938*(t+=e.charCodeAt(r));n-=t=n>>>0,t=(n*=t)>>>0,t+=4294967296*(n-=t)}return 2.3283064365386963e-10*(t>>>0)});r.next=function(){var e=2091639*r.s0+2.3283064365386963e-10*r.c;return r.s0=r.s1,r.s1=r.s2,r.s2=e-(r.c=0|e)},r.c=1,r.s0=n(" "),r.s1=n(" "),r.s2=n(" "),r.s0-=n(e),r.s0<0&&(r.s0+=1),r.s1-=n(e),r.s1<0&&(r.s1+=1),r.s2-=n(e),r.s2<0&&(r.s2+=1),n=null}function i(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function s(e,t){var r=new n(e),s=t&&t.state,o=r.next;return o.int32=function(){return 4294967296*r.next()|0},o.double=function(){return o()+11102230246251565e-32*(2097152*o()|0)},o.quick=o,s&&("object"==typeof s&&i(s,r),o.state=function(){return i(r,{})}),o}t&&t.exports?t.exports=s:r&&r.amd?r((function(){return s})):this.alea=s}(0,"object"==typeof t&&t,"function"==typeof define&&define)}}),require_xor128=__commonJS({"node_modules/seedrandom/lib/xor128.js"(e,t){!function(e,t,r){function n(e){var t=this,r="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:r+=e;for(var n=0;n<r.length+64;n++)t.x^=0|r.charCodeAt(n),t.next()}function i(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function s(e,t){var r=new n(e),s=t&&t.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var e=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=r.next,o.quick=o,s&&("object"==typeof s&&i(s,r),o.state=function(){return i(r,{})}),o}t&&t.exports?t.exports=s:r&&r.amd?r((function(){return s})):this.xor128=s}(0,"object"==typeof t&&t,"function"==typeof define&&define)}}),require_xorwow=__commonJS({"node_modules/seedrandom/lib/xorwow.js"(e,t){!function(e,t,r){function n(e){var t=this,r="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:r+=e;for(var n=0;n<r.length+64;n++)t.x^=0|r.charCodeAt(n),n==r.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function i(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function s(e,t){var r=new n(e),s=t&&t.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var e=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=r.next,o.quick=o,s&&("object"==typeof s&&i(s,r),o.state=function(){return i(r,{})}),o}t&&t.exports?t.exports=s:r&&r.amd?r((function(){return s})):this.xorwow=s}(0,"object"==typeof t&&t,"function"==typeof define&&define)}}),require_xorshift7=__commonJS({"node_modules/seedrandom/lib/xorshift7.js"(e,t){!function(e,t,r){function n(e){var t=this;t.next=function(){var e,r,n=t.x,i=t.i;return e=n[i],r=(e^=e>>>7)^e<<24,r^=(e=n[i+1&7])^e>>>10,r^=(e=n[i+3&7])^e>>>3,r^=(e=n[i+4&7])^e<<7,e=n[i+7&7],r^=(e^=e<<13)^e<<9,n[i]=r,t.i=i+1&7,r},function(e,t){var r,n=[];if(t===(0|t))n[0]=t;else for(t=""+t,r=0;r<t.length;++r)n[7&r]=n[7&r]<<15^t.charCodeAt(r)+n[r+1&7]<<13;for(;n.length<8;)n.push(0);for(r=0;r<8&&0===n[r];++r);for(8==r?n[7]=-1:n[r],e.x=n,e.i=0,r=256;r>0;--r)e.next()}(t,e)}function i(e,t){return t.x=e.x.slice(),t.i=e.i,t}function s(e,t){null==e&&(e=+new Date);var r=new n(e),s=t&&t.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var e=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=r.next,o.quick=o,s&&(s.x&&i(s,r),o.state=function(){return i(r,{})}),o}t&&t.exports?t.exports=s:r&&r.amd?r((function(){return s})):this.xorshift7=s}(0,"object"==typeof t&&t,"function"==typeof define&&define)}}),require_xor4096=__commonJS({"node_modules/seedrandom/lib/xor4096.js"(e,t){!function(e,t,r){function n(e){var t=this;t.next=function(){var e,r,n=t.w,i=t.X,s=t.i;return t.w=n=n+1640531527|0,r=i[s+34&127],e=i[s=s+1&127],r^=r<<13,e^=e<<17,r^=r>>>15,e^=e>>>12,r=i[s]=r^e,t.i=s,r+(n^n>>>16)|0},function(e,t){var r,n,i,s,o,a=[],l=128;for(t===(0|t)?(n=t,t=null):(t+="\0",n=0,l=Math.max(l,t.length)),i=0,s=-32;s<l;++s)t&&(n^=t.charCodeAt((s+32)%t.length)),0===s&&(o=n),n^=n<<10,n^=n>>>15,n^=n<<4,n^=n>>>13,s>=0&&(o=o+1640531527|0,i=0==(r=a[127&s]^=n+o)?i+1:0);for(i>=128&&(a[127&(t&&t.length||0)]=-1),i=127,s=512;s>0;--s)n=a[i+34&127],r=a[i=i+1&127],n^=n<<13,r^=r<<17,n^=n>>>15,r^=r>>>12,a[i]=n^r;e.w=o,e.X=a,e.i=i}(t,e)}function i(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function s(e,t){null==e&&(e=+new Date);var r=new n(e),s=t&&t.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var e=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=r.next,o.quick=o,s&&(s.X&&i(s,r),o.state=function(){return i(r,{})}),o}t&&t.exports?t.exports=s:r&&r.amd?r((function(){return s})):this.xor4096=s}(0,"object"==typeof t&&t,"function"==typeof define&&define)}}),require_tychei=__commonJS({"node_modules/seedrandom/lib/tychei.js"(e,t){!function(e,t,r){function n(e){var t=this,r="";t.next=function(){var e=t.b,r=t.c,n=t.d,i=t.a;return e=e<<25^e>>>7^r,r=r-n|0,n=n<<24^n>>>8^i,i=i-e|0,t.b=e=e<<20^e>>>12^r,t.c=r=r-n|0,t.d=n<<16^r>>>16^i,t.a=i-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):r+=e;for(var n=0;n<r.length+20;n++)t.b^=0|r.charCodeAt(n),t.next()}function i(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function s(e,t){var r=new n(e),s=t&&t.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var e=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=r.next,o.quick=o,s&&("object"==typeof s&&i(s,r),o.state=function(){return i(r,{})}),o}t&&t.exports?t.exports=s:r&&r.amd?r((function(){return s})):this.tychei=s}(0,"object"==typeof t&&t,"function"==typeof define&&define)}}),require_seedrandom=__commonJS({"node_modules/seedrandom/seedrandom.js"(e,t){!function(e,r,n){var i,s=256,o=n.pow(s,6),a=n.pow(2,52),l=2*a,h=255;function u(t,h,u){var _=[],g=p(f((h=1==h?{entropy:!0}:h||{}).entropy?[t,m(r)]:null==t?function(){try{var t;return i&&(t=i.randomBytes)?t=t(s):(t=new Uint8Array(s),(e.crypto||e.msCrypto).getRandomValues(t)),m(t)}catch(t){var n=e.navigator,o=n&&n.plugins;return[+new Date,e,o,e.screen,m(r)]}}():t,3),_),v=new c(_),y=function(){for(var e=v.g(6),t=o,r=0;e<a;)e=(e+r)*s,t*=s,r=v.g(1);for(;e>=l;)e/=2,t/=2,r>>>=1;return(e+r)/t};return y.int32=function(){return 0|v.g(4)},y.quick=function(){return v.g(4)/4294967296},y.double=y,p(m(v.S),r),(h.pass||u||function(e,t,r,i){return i&&(i.S&&d(i,v),e.state=function(){return d(v,{})}),r?(n.random=e,t):e})(y,g,"global"in h?h.global:this==n,h.state)}function c(e){var t,r=e.length,n=this,i=0,o=n.i=n.j=0,a=n.S=[];for(r||(e=[r++]);i<s;)a[i]=i++;for(i=0;i<s;i++)a[i]=a[o=h&o+e[i%r]+(t=a[i])],a[o]=t;(n.g=function(e){for(var t,r=0,i=n.i,o=n.j,a=n.S;e--;)t=a[i=h&i+1],r=r*s+a[h&(a[i]=a[o=h&o+t])+(a[o]=t)];return n.i=i,n.j=o,r})(s)}function d(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function f(e,t){var r,n=[],i=typeof e;if(t&&"object"==i)for(r in e)try{n.push(f(e[r],t-1))}catch(e){}return n.length?n:"string"==i?e:e+"\0"}function p(e,t){for(var r,n=e+"",i=0;i<n.length;)t[h&i]=h&(r^=19*t[h&i])+n.charCodeAt(i++);return m(t)}function m(e){return String.fromCharCode.apply(0,e)}if(p(n.random(),r),"object"==typeof t&&t.exports){t.exports=u;try{i=require_crypto()}catch(e){}}else"function"==typeof define&&define.amd?define((function(){return u})):n.seedrandom=u}("undefined"!=typeof self?self:e,[],Math)}}),require_seedrandom2=__commonJS({"node_modules/seedrandom/index.js"(e,t){var r=require_alea(),n=require_xor128(),i=require_xorwow(),s=require_xorshift7(),o=require_xor4096(),a=require_tychei(),l=require_seedrandom();l.alea=r,l.xor128=n,l.xorwow=i,l.xorshift7=s,l.xor4096=o,l.tychei=a,t.exports=l}}),util_exports={};__export(util_exports,{Clock:()=>Clock,Color:()=>Color,ColorMixin:()=>ColorMixin,CountdownTimer:()=>CountdownTimer,EventEmitter:()=>EventEmitter,IsPointInsidePolygon:()=>IsPointInsidePolygon,MonotonicClock:()=>MonotonicClock,PsychObject:()=>PsychObject,Scheduler:()=>Scheduler,addInfoFromUrl:()=>addInfoFromUrl,average:()=>average,count:()=>count,detectBrowser:()=>detectBrowser,extensionFromMimeType:()=>extensionFromMimeType,flattenArray:()=>flattenArray,getErrorStack:()=>getErrorStack,getPositionFromObject:()=>getPositionFromObject,getRequestError:()=>getRequestError,getUrlParameters:()=>getUrlParameters,index:()=>index,isEmpty:()=>isEmpty,isInt:()=>isInt,isNumeric:()=>isNumeric,makeUuid:()=>makeUuid,mix:()=>mix,offerDataForDownload:()=>offerDataForDownload,promiseToTupple:()=>promiseToTupple,randchoice:()=>randchoice,randint:()=>randint,range:()=>range,round:()=>round,selectFromArray:()=>selectFromArray,shuffle:()=>shuffle,sliceArray:()=>sliceArray,sort:()=>sort,sum:()=>sum,toNumerical:()=>toNumerical,toString:()=>toString,to_height:()=>to_height,to_norm:()=>to_norm,to_pixiPoint:()=>to_pixiPoint,to_px:()=>to_px,to_unit:()=>to_unit,to_win:()=>to_win,turnSquareBracketsIntoArrays:()=>turnSquareBracketsIntoArrays});var MonotonicClock=class{constructor(e=MonotonicClock.getReferenceTime()){this._timeAtLastReset=e}getTime(){return MonotonicClock.getReferenceTime()-this._timeAtLastReset}getLastResetTime(){return this._timeAtLastReset}static getReferenceTime(){return performance.now()/1e3-MonotonicClock._referenceTime}static getDate(e="en-CA",t){let r=new Date,n=Object.assign({hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"numeric",minute:"numeric",second:"numeric",fractionalSecondDigits:3},t);return new Intl.DateTimeFormat(e,n).format(r)}static getDateStr(){return MonotonicClock.getDate().replace(", ","_").replace(":","h").replace(":",".")}};MonotonicClock._referenceTime=performance.now()/1e3;var Clock=class extends MonotonicClock{constructor(){super()}reset(e=0){this._timeAtLastReset=MonotonicClock.getReferenceTime()+e}add(e){this._timeAtLastReset+=e}},CountdownTimer=class extends Clock{constructor(e=0){super(),this._timeAtLastReset=MonotonicClock.getReferenceTime(),this._countdown_duration=e,e&&this.add(e)}add(e){this._timeAtLastReset+=e}reset(e){void 0===e?this._timeAtLastReset=MonotonicClock.getReferenceTime()+this._countdown_duration:(this._countdown_duration=e,this._timeAtLastReset=MonotonicClock.getReferenceTime()+e)}getTime(){return this._timeAtLastReset-MonotonicClock.getReferenceTime()}},Color=class{constructor(e="black",t=Color.COLOR_SPACE.RGB){let r={origin:"Color",context:"when defining a color"};if("string"==typeof e){if(t!==Color.COLOR_SPACE.RGB)throw Object.assign(r,{error:"the colorspace must be RGB for a named color"});if("#"===e[0])this._hex=e;else{if(!(e.toLowerCase()in Color.NAMED_COLORS))throw Object.assign(r,{error:"unknown named color: "+e});this._hex=Color.NAMED_COLORS[e.toLowerCase()]}this._rgb=Color.hexToRgb(this._hex)}else if("number"==typeof e){if(t!==Color.COLOR_SPACE.RGB)throw Object.assign(r,{error:"the colorspace must be RGB for a named color"});this._rgb=Color._intToRgb(e)}else if(Array.isArray(e)){Color._checkTypeAndRange(e);let[n,i,s]=e;switch(t!==Color.COLOR_SPACE.RGB255&&(Color._checkTypeAndRange(e,[-1,1]),n=(n+1)/2,i=(i+1)/2,s=(s+1)/2),t){case Color.COLOR_SPACE.RGB255:Color._checkTypeAndRange(e,[0,255]),this._rgb=[n/255,i/255,s/255];break;case Color.COLOR_SPACE.RGB:this._rgb=[n,i,s];break;case Color.COLOR_SPACE.HSV:case Color.COLOR_SPACE.DKL:case Color.COLOR_SPACE.LMS:break;default:throw Object.assign(r,{error:"unknown colorspace: "+t})}}else e instanceof Color&&(this._rgb=e._rgb.slice())}get rgb(){return this._rgb}get rgb255(){return[Math.round(255*this._rgb[0]),Math.round(255*this._rgb[1]),Math.round(255*this._rgb[2])]}get hex(){return void 0===this._hex&&(this._hex=Color._rgbToHex(this._rgb)),this._hex}get int(){return void 0===this._int&&(this._int=Color._rgbToInt(this._rgb)),this._int}toString(){return this.hex}static hexToRgb255(e){let t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);if(null==t)throw{origin:"Color.hexToRgb255",context:"when converting an hexadecimal color code to its 255- or [0,1]-based RGB color representation",error:"unable to parse the argument: wrong type or wrong code"};return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}static hexToRgb(e){let[t,r,n]=Color.hexToRgb255(e);return[t/255,r/255,n/255]}static rgb255ToHex(e){let t={origin:"Color.rgb255ToHex",context:"when converting an rgb triplet to its hexadecimal color representation"};try{return Color._checkTypeAndRange(e,[0,255]),Color._rgb255ToHex(e)}catch(e){throw Object.assign(t,{error:e})}}static rgbToHex(e){let t={origin:"Color.rgbToHex",context:"when converting an rgb triplet to its hexadecimal color representation"};try{return Color._checkTypeAndRange(e,[0,1]),Color._rgbToHex(e)}catch(e){throw Object.assign(t,{error:e})}}static rgbToInt(e){let t={origin:"Color.rgbToInt",context:"when converting an rgb triplet to its integer representation"};try{return Color._checkTypeAndRange(e,[0,1]),Color._rgbToInt(e)}catch(e){throw Object.assign(t,{error:e})}}static rgb255ToInt(e){let t={origin:"Color.rgb255ToInt",context:"when converting an rgb triplet to its integer representation"};try{return Color._checkTypeAndRange(e,[0,255]),Color._rgb255ToInt(e)}catch(e){throw Object.assign(t,{error:e})}}static _rgb255ToHex(e){return"#"+((1<<24)+(e[0]<<16)+(e[1]<<8)+e[2]).toString(16).slice(1)}static _rgbToHex(e){let t=[Math.round(255*e[0]),Math.round(255*e[1]),Math.round(255*e[2])];return Color._rgb255ToHex(t)}static _rgbToInt(e){let t=[Math.round(255*e[0]),Math.round(255*e[1]),Math.round(255*e[2])];return Color._rgb255ToInt(t)}static _rgb255ToInt(e){return 65536*e[0]+256*e[1]+e[2]}static _intToRgb255(e){return[e>>>16,(65280&e)/256,255&e]}static _intToRgb(e){let[t,r,n]=Color._intToRgb255(e);return[t/255,r/255,n/255]}static _checkTypeAndRange(e,t){if(!Array.isArray(e)||3!==e.length||"number"!=typeof e[0]||"number"!=typeof e[1]||"number"!=typeof e[2])throw"the argument should be an array of numbers of length 3";if(void 0!==t&&(e[0]<t[0]||e[0]>t[1]||e[1]<t[0]||e[1]>t[1]||e[2]<t[0]||e[2]>t[1]))throw"the color components should all belong to ["+t[0]+", "+t[1]+"]"}};Color.COLOR_SPACE={RGB:Symbol.for("RGB"),RGB255:Symbol.for("RGB255")},Color.NAMED_COLORS={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8B",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};var ColorMixin=e=>class extends e{constructor(e){super(e)}setColor(e,t){this._setAttribute("color",e,t),this._needUpdate=!0,this._needPixiUpdate=!0}setContrast(e,t){this._setAttribute("contrast",e,t),this._needUpdate=!0,this._needPixiUpdate=!0}getContrastedColor(e,t){let r=e.rgb.map((e=>(2*e-1)*t));return new Color(r,Color.COLOR_SPACE.RGB)}},mix=e=>new MixinBuilder(e),MixinBuilder=class{constructor(e){this.superclass=e}with(...e){return e.reduce(((e,t)=>t(e)),this.superclass)}};function promiseToTupple(e){return e.then((e=>[null,e])).catch((e=>[e,null]))}function makeUuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}function getErrorStack(){try{throw Error("")}catch(e){let t=e.stack.split("\n");return t.splice(1,1),JSON.stringify(t.join("\n"))}}function isEmpty(e){return void 0===e||!!Array.isArray(e)&&(0===e.length||1===e.length&&void 0===e[0])}function detectBrowser(){let e=!!window.opr&&!!opr.addons||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0;if(e)return"Opera";if("undefined"!=typeof InstallTrigger)return"Firefox";if(/constructor/i.test(window.HTMLElement)||"[object SafariRemoteNotification]"===(!window.safari||"undefined"!=typeof safari&&safari.pushNotification).toString())return"Safari";let t=!!document.documentMode;if(t)return"IE";if(!t&&window.StyleMedia)return"Edge";let r=window.chrome;return r?"Chrome":r&&-1!==navigator.userAgent.indexOf("Edg")?"EdgeChromium":(r||e)&&window.CSS?"Blink":"unknown"}function toNumerical(e){let t={origin:"util.toNumerical",context:"when converting an object to its numerical form"};try{if(null===e)throw"unable to convert null to a number";if(void 0===e)throw"unable to convert undefined to a number";if("number"==typeof e)return e;let t=e=>{let t=Number.parseFloat(e);if(Number.isNaN(t))throw`unable to convert ${e} to a number`;return t};if(Array.isArray(e))return e.map(t);let r=turnSquareBracketsIntoArrays(e);if(Array.isArray(r))return r.map(t);if("string"==typeof e)return t(e);throw"unable to convert the object to a number"}catch(e){throw Object.assign(t,{error:e})}}function isNumeric(e){return!1===Number.isNaN(Number(e))}function IsPointInsidePolygon(e,t){let r=e[0],n=e[1],i=!1;for(let e=0,s=t.length-1;e<t.length;s=e++){let o=t[e][0],a=t[e][1],l=t[s][0],h=t[s][1];a>n!=h>n&&r<(l-o)*(n-a)/(h-a)+o&&(i=!i)}return i}function shuffle(e,t){void 0===t&&(t=Math.random);for(let r=e.length-1;r>0;r--){let n=Math.floor(t()*(r+1));[e[r],e[n]]=[e[n],e[r]]}return e}function randchoice(e,t){return void 0===t&&(t=Math.random),e[Math.floor(t()*e.length)]}function getPositionFromObject(e,t){let r={origin:"util.getPositionFromObject",context:"when getting the position of an object"};try{if(void 0===e)throw"cannot get the position of an undefined object";let r;return"function"==typeof e.getPos&&(t=e.units,r=e.win,e=e.getPos()),to_px(e,t,r)}catch(e){throw Object.assign(r,{error:e})}}function to_px(e,t,r,n=!1){let i;if("pix"===t)i=e;else if("norm"===t)i=[e[0]*r.size[0]/2,e[1]*r.size[1]/2];else{if("height"!==t)throw Object.assign({origin:"util.to_px",context:"when converting a position to pixel units"},{error:`unknown position units: ${t}`});{let t=Math.min(r.size[0],r.size[1]);i=[e[0]*t,e[1]*t]}}return n?[Math.round(i[0]),Math.round(i[1])]:i}function to_norm(e,t,r){if("norm"===t)return e;if("pix"===t)return[e[0]/(r.size[0]/2),e[1]/(r.size[1]/2)];if("height"===t){let t=Math.min(r.size[0],r.size[1]);return[e[0]*t/(r.size[0]/2),e[1]*t/(r.size[1]/2)]}throw Object.assign({origin:"util.to_norm",context:"when converting a position to norm units"},{error:`unknown position units: ${t}`})}function to_height(e,t,r){if("height"===t)return e;if("pix"===t){let t=Math.min(r.size[0],r.size[1]);return[e[0]/t,e[1]/t]}if("norm"===t){let t=Math.min(r.size[0],r.size[1]);return[e[0]*r.size[0]/2/t,e[1]*r.size[1]/2/t]}throw Object.assign({origin:"util.to_height",context:"when converting a position to height units"},{error:`unknown position units: ${t}`})}function to_win(e,t,r){let n={origin:"util.to_win",context:"when converting a position to window units"};try{if("pix"===r._units)return to_px(e,t,r);if("norm"===r._units)return to_norm(e,t,r);if("height"===r._units)return to_height(e,t,r);throw`unknown window units: ${r._units}`}catch(e){throw Object.assign(n,{response:n,error:e})}}function to_unit(e,t,r,n){let i={origin:"util.to_unit",context:"when converting a position to different units"};try{if("pix"===n)return to_px(e,t,r);if("norm"===n)return to_norm(e,t,r);if("height"===n)return to_height(e,t,r);throw`unknown target units: ${n}`}catch(e){throw Object.assign(i,{error:e})}}function toString(e){if(void 0===e)return"undefined";if(!e)return"null";if("string"==typeof e)return e;if("class"===e.constructor.toString().substring(0,5)&&"function"==typeof e.toString)return e.toString();try{let t=(e,t)=>("symbol"==typeof t&&(t=Symbol.keyFor(t)),t);return JSON.stringify(e,t)}catch(e){return"Object (circular)"}}function getRequestError(e,t,r){let n="unknown error";return void 0!==e.responseJSON?n=e.responseJSON:void 0!==e.responseText?n=e.responseText:void 0!==r&&(n=r),n}function isInt(e){if(isNaN(e))return!1;let t=parseFloat(e);return(0|t)===t}function getUrlParameters(){let e=window.location.search.slice(1);return new URLSearchParams(e)}function addInfoFromUrl(e){return getUrlParameters().forEach(((t,r)=>{0!==r.indexOf("__")&&(e[r]=t)})),e}function selectFromArray(e,t){if(isInt(t))return[e[parseInt(t)]];if(Array.isArray(t))return t.map((t=>e[t]));if("string"!=typeof t)throw{origin:"selectFromArray",context:"when selecting entries from an array",error:"unknown selection type: "+typeof t};if(t.indexOf(",")>-1)return t.split(",").map((t=>selectFromArray(e,t)));if(t.indexOf(":")>-1){let r=t.split(":").map((e=>parseInt(e)));return 3===r.length?sliceArray(e,r[0],r[2],r[1]):sliceArray(e,...r)}}function flattenArray(e){return e.reduce(((e,t)=>(e.push(Array.isArray(t)&&Array.isArray(t[0])?flattenArray(t):t),e)),[])}function sliceArray(e,t=NaN,r=NaN,n=NaN){isNaN(t)&&(t=0),isNaN(r)&&(r=e.length);let i=e.slice(t,r);return isNaN(n)||(n<0&&i.reverse(),1===(n=Math.abs(n)))?i:i.filter(((e,t)=>t%n==0))}function offerDataForDownload(e,t,r){let n=new Blob([t],{type:r});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveBlob(n,e);else{let t=document.createElement("a");t.href=window.URL.createObjectURL(n),t.download=e,document.body.appendChild(t),t.click(),document.body.removeChild(t)}}function turnSquareBracketsIntoArrays(e,t=1){if(String(e)!==e)return;let r=e.match(/\[(.*?)\]/g);if(null===r)return;let n=r.map((e=>e.replace(/[\[\]]+/g,"").split(/[, ]+/)));return t<2?n[0]:n}function randint(e=0,t){let r=e,n=t;if(void 0===t&&(n=r,r=0),n<r)throw{origin:"util.randint",context:"when generating a random integer",error:"min should be <= max"};return Math.floor(Math.random()*(n-r))+r}function round(e,t=0){return+(Math.round(`${e}e+${t}`)+`e-${t}`)}function sum(e=[],t=0){return Array.isArray(e)?e.map((e=>Number(e))).filter((e=>!1===Number.isNaN(e))).reduce(((e,t)=>e+t),t):t}function average(e=[]){return Array.isArray(e)&&0!==e.length?sum(e,0)/e.length:0}function sort(e){let t={origin:"util.sort",context:"when sorting the elements of an array"};try{if(!Array.isArray(e))throw"the input argument should be an array";if(e.every((e=>"number"==typeof e)))return e.sort(((e,t)=>e-t));if(e.every((e=>"string"==typeof e)))return e.sort();throw"the input array should either consist entirely of strings or of numbers"}catch(e){throw __spreadProps(__spreadValues({},t),{error:e})}}function range(...e){let t={origin:"util.range",context:"when building a range of numbers"};try{let t,r,n;switch(e.length){case 0:throw"at least one argument is required";case 1:t=0,r=e[0],n=1;break;case 2:t=e[0],r=e[1],n=1;break;case 3:t=e[0],r=e[1],n=e[2];break;default:throw"range requires at least one and at most 3 arguments"}if(!Number.isInteger(t))throw"start should be an integer";if(!Number.isInteger(r))throw"stop should be an integer";if(!Number.isInteger(n))throw"step should be an integer";if(t>=r)return[];let i=[];for(let e=t;e<r;e+=n)i.push(e);return i}catch(e){throw __spreadProps(__spreadValues({},t),{error:e})}}function _match(e){let t={origin:"util._match",context:"when creating a function that compares an input element to the given value"};try{if("function"==typeof e)throw"the value cannot be a function";if(Number.isNaN(e))return e=>Number.isNaN(e);if(null===e)return e=>null===e;if("object"==typeof e){let t=JSON.stringify(e);if(void 0===t)throw"value could not be converted to a JSON string";return e=>JSON.stringify(e)===t}return t=>t===e}catch(e){throw __spreadProps(__spreadValues({},t),{error:e})}}function count(e,t){let r={origin:"util.count",context:"when counting how many elements in the input array match the given value"};try{if(!Array.isArray(e))throw"the input argument should be an array";let r=_match(t),n=0;return e.forEach((e=>{r(e)&&++n})),n}catch(e){throw __spreadProps(__spreadValues({},r),{error:e})}}function index(e,t){let r={origin:"util.index",context:"when getting the index in the input array of the first element that matches the given value"};try{if(!Array.isArray(e))throw"the input argument should be an array";let r=_match(t),n=e.findIndex(r);if(-1===n)throw"no element in the input array matches the value";return n}catch(e){throw __spreadProps(__spreadValues({},r),{error:e})}}function extensionFromMimeType(e){return"string"!=typeof e?".dat":0===e.indexOf("audio/webm")?".webm":0===e.indexOf("audio/ogg")?".ogg":0===e.indexOf("audio/wav")?".wav":0===e.indexOf("video/webm")?".webm":".dat"}String.prototype.format||(String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,(function(t,r){return void 0!==e[r]?e[r]:t})).replace(/{([$_a-zA-Z][$_a-zA-Z0-9]*)}/g,(function(t,r){return e.length>0&&void 0!==e[0][r]?e[0][r]:t}))});var EventEmitter=class{constructor(){this._listeners=new Map,this._onceUuids=new Map}on(e,t){if("function"!=typeof t)throw new TypeError("listener must be a function");let r=makeUuid();return this._listeners.has(e)||this._listeners.set(e,[]),this._listeners.get(e).push({uuid:r,listener:t}),r}once(e,t){let r=this.on(e,t);return this._onceUuids.has(e)||this._onceUuids.set(e,[]),this._onceUuids.get(e).push(r),r}off(e,t){let r=this._listeners.get(e);return!(!r||!r.length||(this._listeners.set(e,r.filter((e=>e.uuid!=t))),0))}emit(e,t){let r=this._listeners.get(e);if(r&&r.length){let n=this._onceUuids.get(e),i=this;return r.forEach((({uuid:r,listener:s})=>{s(t),void 0!==n&&n.includes(r)&&i.off(e,r)})),!0}return!1}};function finallyConstructor(e){var t=this.constructor;return this.then((function(r){return t.resolve(e()).then((function(){return r}))}),(function(r){return t.resolve(e()).then((function(){return t.reject(r)}))}))}var finally_default=finallyConstructor;function allSettled(e){return new this((function(t,r){if(!e||void 0===e.length)return r(new TypeError(typeof e+" "+e+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var n=Array.prototype.slice.call(e);if(0===n.length)return t([]);var i=n.length;function s(e,r){if(r&&("object"==typeof r||"function"==typeof r)){var o=r.then;if("function"==typeof o)return void o.call(r,(function(t){s(e,t)}),(function(r){n[e]={status:"rejected",reason:r},0==--i&&t(n)}))}n[e]={status:"fulfilled",value:r},0==--i&&t(n)}for(var o=0;o<n.length;o++)s(o,n[o])}))}var allSettled_default=allSettled,setTimeoutFunc=setTimeout;function isArray(e){return Boolean(e&&void 0!==e.length)}function noop(){}function bind(e,t){return function(){e.apply(t,arguments)}}function Promise2(e){if(!(this instanceof Promise2))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],doResolve(e,this)}function handle(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,Promise2._immediateFn((function(){var r=1===e._state?t.onFulfilled:t.onRejected;if(null!==r){var n;try{n=r(e._value)}catch(e){return void reject(t.promise,e)}resolve(t.promise,n)}else(1===e._state?resolve:reject)(t.promise,e._value)}))):e._deferreds.push(t)}function resolve(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var r=t.then;if(t instanceof Promise2)return e._state=3,e._value=t,void finale(e);if("function"==typeof r)return void doResolve(bind(r,t),e)}e._state=1,e._value=t,finale(e)}catch(t){reject(e,t)}}function reject(e,t){e._state=2,e._value=t,finale(e)}function finale(e){2===e._state&&0===e._deferreds.length&&Promise2._immediateFn((function(){e._handled||Promise2._unhandledRejectionFn(e._value)}));for(var t=0,r=e._deferreds.length;t<r;t++)handle(e,e._deferreds[t]);e._deferreds=null}function Handler(e,t,r){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=r}function doResolve(e,t){var r=!1;try{e((function(e){r||(r=!0,resolve(t,e))}),(function(e){r||(r=!0,reject(t,e))}))}catch(e){if(r)return;r=!0,reject(t,e)}}Promise2.prototype.catch=function(e){return this.then(null,e)},Promise2.prototype.then=function(e,t){var r=new this.constructor(noop);return handle(this,new Handler(e,t,r)),r},Promise2.prototype.finally=finally_default,Promise2.all=function(e){return new Promise2((function(t,r){if(!isArray(e))return r(new TypeError("Promise.all accepts an array"));var n=Array.prototype.slice.call(e);if(0===n.length)return t([]);var i=n.length;function s(e,o){try{if(o&&("object"==typeof o||"function"==typeof o)){var a=o.then;if("function"==typeof a)return void a.call(o,(function(t){s(e,t)}),r)}n[e]=o,0==--i&&t(n)}catch(e){r(e)}}for(var o=0;o<n.length;o++)s(o,n[o])}))},Promise2.allSettled=allSettled_default,Promise2.resolve=function(e){return e&&"object"==typeof e&&e.constructor===Promise2?e:new Promise2((function(t){t(e)}))},Promise2.reject=function(e){return new Promise2((function(t,r){r(e)}))},Promise2.race=function(e){return new Promise2((function(t,r){if(!isArray(e))return r(new TypeError("Promise.race accepts an array"));for(var n=0,i=e.length;n<i;n++)Promise2.resolve(e[n]).then(t,r)}))},Promise2._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){setTimeoutFunc(e,0)},Promise2._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};var src_default=Promise2,import_object_assign=__toModule(require_object_assign());self.Promise||(self.Promise=src_default),Object.assign||(Object.assign=import_object_assign.default);var ONE_FRAME_TIME=16;Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),self.performance&&self.performance.now||(startTime_1=Date.now(),self.performance||(self.performance={}),self.performance.now=function(){return Date.now()-startTime_1});for(var startTime_1,lastTime=Date.now(),vendors=["ms","moz","webkit","o"],x=0,p;x<vendors.length&&!self.requestAnimationFrame;++x)p=vendors[x],self.requestAnimationFrame=self[p+"RequestAnimationFrame"],self.cancelAnimationFrame=self[p+"CancelAnimationFrame"]||self[p+"CancelRequestAnimationFrame"];self.requestAnimationFrame||(self.requestAnimationFrame=function(e){if("function"!=typeof e)throw new TypeError(e+"is not a function");var t=Date.now(),r=ONE_FRAME_TIME+lastTime-t;return r<0&&(r=0),lastTime=t,self.setTimeout((function(){lastTime=Date.now(),e(performance.now())}),r)}),self.cancelAnimationFrame||(self.cancelAnimationFrame=function(e){return clearTimeout(e)}),Math.sign||(Math.sign=function(e){return 0===(e=Number(e))||isNaN(e)?e:e>0?1:-1}),Number.isInteger||(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),self.ArrayBuffer||(self.ArrayBuffer=Array),self.Float32Array||(self.Float32Array=Array),self.Uint32Array||(self.Uint32Array=Array),self.Uint16Array||(self.Uint16Array=Array),self.Uint8Array||(self.Uint8Array=Array),self.Int32Array||(self.Int32Array=Array);var appleIphone=/iPhone/i,appleIpod=/iPod/i,appleTablet=/iPad/i,appleUniversal=/\biOS-universal(?:.+)Mac\b/i,androidPhone=/\bAndroid(?:.+)Mobile\b/i,androidTablet=/Android/i,amazonPhone=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,amazonTablet=/Silk/i,windowsPhone=/Windows Phone/i,windowsTablet=/\bWindows(?:.+)ARM\b/i,otherBlackBerry=/BlackBerry/i,otherBlackBerry10=/BB10/i,otherOpera=/Opera Mini/i,otherChrome=/\b(CriOS|Chrome)(?:.+)Mobile/i,otherFirefox=/Mobile(?:.+)Firefox\b/i,isAppleTabletOnIos13=function(e){return void 0!==e&&"MacIntel"===e.platform&&"number"==typeof e.maxTouchPoints&&e.maxTouchPoints>1&&"undefined"==typeof MSStream};function createMatch(e){return function(t){return t.test(e)}}function isMobile(e){var t={userAgent:"",platform:"",maxTouchPoints:0};e||"undefined"==typeof navigator?"string"==typeof e?t.userAgent=e:e&&e.userAgent&&(t={userAgent:e.userAgent,platform:e.platform,maxTouchPoints:e.maxTouchPoints||0}):t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var r=t.userAgent,n=r.split("[FBAN");void 0!==n[1]&&(r=n[0]),void 0!==(n=r.split("Twitter"))[1]&&(r=n[0]);var i=createMatch(r),s={apple:{phone:i(appleIphone)&&!i(windowsPhone),ipod:i(appleIpod),tablet:!i(appleIphone)&&(i(appleTablet)||isAppleTabletOnIos13(t))&&!i(windowsPhone),universal:i(appleUniversal),device:(i(appleIphone)||i(appleIpod)||i(appleTablet)||i(appleUniversal)||isAppleTabletOnIos13(t))&&!i(windowsPhone)},amazon:{phone:i(amazonPhone),tablet:!i(amazonPhone)&&i(amazonTablet),device:i(amazonPhone)||i(amazonTablet)},android:{phone:!i(windowsPhone)&&i(amazonPhone)||!i(windowsPhone)&&i(androidPhone),tablet:!i(windowsPhone)&&!i(amazonPhone)&&!i(androidPhone)&&(i(amazonTablet)||i(androidTablet)),device:!i(windowsPhone)&&(i(amazonPhone)||i(amazonTablet)||i(androidPhone)||i(androidTablet))||i(/\bokhttp\b/i)},windows:{phone:i(windowsPhone),tablet:i(windowsTablet),device:i(windowsPhone)||i(windowsTablet)},other:{blackberry:i(otherBlackBerry),blackberry10:i(otherBlackBerry10),opera:i(otherOpera),firefox:i(otherFirefox),chrome:i(otherChrome),device:i(otherBlackBerry)||i(otherBlackBerry10)||i(otherOpera)||i(otherFirefox)||i(otherChrome)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}var isMobile2=isMobile(self.navigator),ENV,ENV4,RENDERER_TYPE,RENDERER_TYPE4,BUFFER_BITS,BUFFER_BITS4,BLEND_MODES,BLEND_MODES4,DRAW_MODES,DRAW_MODES4,FORMATS,FORMATS4,TARGETS,TARGETS4,TYPES,TYPES4,SAMPLER_TYPES,SAMPLER_TYPES4,SCALE_MODES,SCALE_MODES4,WRAP_MODES,WRAP_MODES4,MIPMAP_MODES,MIPMAP_MODES4,ALPHA_MODES,ALPHA_MODES4,CLEAR_MODES,CLEAR_MODES4,GC_MODES,GC_MODES4,PRECISION,PRECISION4,MASK_TYPES,MASK_TYPES4,MSAA_QUALITY,MSAA_QUALITY4;function maxRecommendedTextures(e){var t,r=!0;(isMobile2.tablet||isMobile2.phone)&&(isMobile2.apple.device&&(t=navigator.userAgent.match(/OS (\d+)_(\d+)?/))&&parseInt(t[1],10)<11&&(r=!1),isMobile2.android.device&&(t=navigator.userAgent.match(/Android\s([0-9.]*)/))&&parseInt(t[1],10)<7&&(r=!1));return r?e:4}function canUploadSameBuffer(){return!isMobile2.apple.device}ENV4=ENV||(ENV={}),ENV4[ENV4.WEBGL_LEGACY=0]="WEBGL_LEGACY",ENV4[ENV4.WEBGL=1]="WEBGL",ENV4[ENV4.WEBGL2=2]="WEBGL2",RENDERER_TYPE4=RENDERER_TYPE||(RENDERER_TYPE={}),RENDERER_TYPE4[RENDERER_TYPE4.UNKNOWN=0]="UNKNOWN",RENDERER_TYPE4[RENDERER_TYPE4.WEBGL=1]="WEBGL",RENDERER_TYPE4[RENDERER_TYPE4.CANVAS=2]="CANVAS",BUFFER_BITS4=BUFFER_BITS||(BUFFER_BITS={}),BUFFER_BITS4[BUFFER_BITS4.COLOR=16384]="COLOR",BUFFER_BITS4[BUFFER_BITS4.DEPTH=256]="DEPTH",BUFFER_BITS4[BUFFER_BITS4.STENCIL=1024]="STENCIL",BLEND_MODES4=BLEND_MODES||(BLEND_MODES={}),BLEND_MODES4[BLEND_MODES4.NORMAL=0]="NORMAL",BLEND_MODES4[BLEND_MODES4.ADD=1]="ADD",BLEND_MODES4[BLEND_MODES4.MULTIPLY=2]="MULTIPLY",BLEND_MODES4[BLEND_MODES4.SCREEN=3]="SCREEN",BLEND_MODES4[BLEND_MODES4.OVERLAY=4]="OVERLAY",BLEND_MODES4[BLEND_MODES4.DARKEN=5]="DARKEN",BLEND_MODES4[BLEND_MODES4.LIGHTEN=6]="LIGHTEN",BLEND_MODES4[BLEND_MODES4.COLOR_DODGE=7]="COLOR_DODGE",BLEND_MODES4[BLEND_MODES4.COLOR_BURN=8]="COLOR_BURN",BLEND_MODES4[BLEND_MODES4.HARD_LIGHT=9]="HARD_LIGHT",BLEND_MODES4[BLEND_MODES4.SOFT_LIGHT=10]="SOFT_LIGHT",BLEND_MODES4[BLEND_MODES4.DIFFERENCE=11]="DIFFERENCE",BLEND_MODES4[BLEND_MODES4.EXCLUSION=12]="EXCLUSION",BLEND_MODES4[BLEND_MODES4.HUE=13]="HUE",BLEND_MODES4[BLEND_MODES4.SATURATION=14]="SATURATION",BLEND_MODES4[BLEND_MODES4.COLOR=15]="COLOR",BLEND_MODES4[BLEND_MODES4.LUMINOSITY=16]="LUMINOSITY",BLEND_MODES4[BLEND_MODES4.NORMAL_NPM=17]="NORMAL_NPM",BLEND_MODES4[BLEND_MODES4.ADD_NPM=18]="ADD_NPM",BLEND_MODES4[BLEND_MODES4.SCREEN_NPM=19]="SCREEN_NPM",BLEND_MODES4[BLEND_MODES4.NONE=20]="NONE",BLEND_MODES4[BLEND_MODES4.SRC_OVER=0]="SRC_OVER",BLEND_MODES4[BLEND_MODES4.SRC_IN=21]="SRC_IN",BLEND_MODES4[BLEND_MODES4.SRC_OUT=22]="SRC_OUT",BLEND_MODES4[BLEND_MODES4.SRC_ATOP=23]="SRC_ATOP",BLEND_MODES4[BLEND_MODES4.DST_OVER=24]="DST_OVER",BLEND_MODES4[BLEND_MODES4.DST_IN=25]="DST_IN",BLEND_MODES4[BLEND_MODES4.DST_OUT=26]="DST_OUT",BLEND_MODES4[BLEND_MODES4.DST_ATOP=27]="DST_ATOP",BLEND_MODES4[BLEND_MODES4.ERASE=26]="ERASE",BLEND_MODES4[BLEND_MODES4.SUBTRACT=28]="SUBTRACT",BLEND_MODES4[BLEND_MODES4.XOR=29]="XOR",DRAW_MODES4=DRAW_MODES||(DRAW_MODES={}),DRAW_MODES4[DRAW_MODES4.POINTS=0]="POINTS",DRAW_MODES4[DRAW_MODES4.LINES=1]="LINES",DRAW_MODES4[DRAW_MODES4.LINE_LOOP=2]="LINE_LOOP",DRAW_MODES4[DRAW_MODES4.LINE_STRIP=3]="LINE_STRIP",DRAW_MODES4[DRAW_MODES4.TRIANGLES=4]="TRIANGLES",DRAW_MODES4[DRAW_MODES4.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",DRAW_MODES4[DRAW_MODES4.TRIANGLE_FAN=6]="TRIANGLE_FAN",FORMATS4=FORMATS||(FORMATS={}),FORMATS4[FORMATS4.RGBA=6408]="RGBA",FORMATS4[FORMATS4.RGB=6407]="RGB",FORMATS4[FORMATS4.ALPHA=6406]="ALPHA",FORMATS4[FORMATS4.LUMINANCE=6409]="LUMINANCE",FORMATS4[FORMATS4.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",FORMATS4[FORMATS4.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",FORMATS4[FORMATS4.DEPTH_STENCIL=34041]="DEPTH_STENCIL",TARGETS4=TARGETS||(TARGETS={}),TARGETS4[TARGETS4.TEXTURE_2D=3553]="TEXTURE_2D",TARGETS4[TARGETS4.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",TARGETS4[TARGETS4.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",TARGETS4[TARGETS4.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",TARGETS4[TARGETS4.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",TARGETS4[TARGETS4.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",TARGETS4[TARGETS4.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",TARGETS4[TARGETS4.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",TARGETS4[TARGETS4.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",TYPES4=TYPES||(TYPES={}),TYPES4[TYPES4.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",TYPES4[TYPES4.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",TYPES4[TYPES4.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",TYPES4[TYPES4.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",TYPES4[TYPES4.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",TYPES4[TYPES4.FLOAT=5126]="FLOAT",TYPES4[TYPES4.HALF_FLOAT=36193]="HALF_FLOAT",SAMPLER_TYPES4=SAMPLER_TYPES||(SAMPLER_TYPES={}),SAMPLER_TYPES4[SAMPLER_TYPES4.FLOAT=0]="FLOAT",SAMPLER_TYPES4[SAMPLER_TYPES4.INT=1]="INT",SAMPLER_TYPES4[SAMPLER_TYPES4.UINT=2]="UINT",SCALE_MODES4=SCALE_MODES||(SCALE_MODES={}),SCALE_MODES4[SCALE_MODES4.NEAREST=0]="NEAREST",SCALE_MODES4[SCALE_MODES4.LINEAR=1]="LINEAR",WRAP_MODES4=WRAP_MODES||(WRAP_MODES={}),WRAP_MODES4[WRAP_MODES4.CLAMP=33071]="CLAMP",WRAP_MODES4[WRAP_MODES4.REPEAT=10497]="REPEAT",WRAP_MODES4[WRAP_MODES4.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",MIPMAP_MODES4=MIPMAP_MODES||(MIPMAP_MODES={}),MIPMAP_MODES4[MIPMAP_MODES4.OFF=0]="OFF",MIPMAP_MODES4[MIPMAP_MODES4.POW2=1]="POW2",MIPMAP_MODES4[MIPMAP_MODES4.ON=2]="ON",MIPMAP_MODES4[MIPMAP_MODES4.ON_MANUAL=3]="ON_MANUAL",ALPHA_MODES4=ALPHA_MODES||(ALPHA_MODES={}),ALPHA_MODES4[ALPHA_MODES4.NPM=0]="NPM",ALPHA_MODES4[ALPHA_MODES4.UNPACK=1]="UNPACK",ALPHA_MODES4[ALPHA_MODES4.PMA=2]="PMA",ALPHA_MODES4[ALPHA_MODES4.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",ALPHA_MODES4[ALPHA_MODES4.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",ALPHA_MODES4[ALPHA_MODES4.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",CLEAR_MODES4=CLEAR_MODES||(CLEAR_MODES={}),CLEAR_MODES4[CLEAR_MODES4.NO=0]="NO",CLEAR_MODES4[CLEAR_MODES4.YES=1]="YES",CLEAR_MODES4[CLEAR_MODES4.AUTO=2]="AUTO",CLEAR_MODES4[CLEAR_MODES4.BLEND=0]="BLEND",CLEAR_MODES4[CLEAR_MODES4.CLEAR=1]="CLEAR",CLEAR_MODES4[CLEAR_MODES4.BLIT=2]="BLIT",GC_MODES4=GC_MODES||(GC_MODES={}),GC_MODES4[GC_MODES4.AUTO=0]="AUTO",GC_MODES4[GC_MODES4.MANUAL=1]="MANUAL",PRECISION4=PRECISION||(PRECISION={}),PRECISION4.LOW="lowp",PRECISION4.MEDIUM="mediump",PRECISION4.HIGH="highp",MASK_TYPES4=MASK_TYPES||(MASK_TYPES={}),MASK_TYPES4[MASK_TYPES4.NONE=0]="NONE",MASK_TYPES4[MASK_TYPES4.SCISSOR=1]="SCISSOR",MASK_TYPES4[MASK_TYPES4.STENCIL=2]="STENCIL",MASK_TYPES4[MASK_TYPES4.SPRITE=3]="SPRITE",MSAA_QUALITY4=MSAA_QUALITY||(MSAA_QUALITY={}),MSAA_QUALITY4[MSAA_QUALITY4.NONE=0]="NONE",MSAA_QUALITY4[MSAA_QUALITY4.LOW=2]="LOW",MSAA_QUALITY4[MSAA_QUALITY4.MEDIUM=4]="MEDIUM",MSAA_QUALITY4[MSAA_QUALITY4.HIGH=8]="HIGH";var settings={MIPMAP_TEXTURES:MIPMAP_MODES.POW2,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:maxRecommendedTextures(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,useContextAlpha:!0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:GC_MODES.AUTO,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:WRAP_MODES.CLAMP,SCALE_MODE:SCALE_MODES.LINEAR,PRECISION_VERTEX:PRECISION.HIGH,PRECISION_FRAGMENT:isMobile2.apple.device?PRECISION.HIGH:PRECISION.MEDIUM,CAN_UPLOAD_SAME_BUFFER:canUploadSameBuffer(),CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},import_eventemitter3=__toModule(require_eventemitter3()),import_earcut=__toModule(require_earcut()),import_url=__toModule(require_url()),ENV2,RENDERER_TYPE2,BUFFER_BITS2,BLEND_MODES2,DRAW_MODES2,FORMATS2,TARGETS2,TYPES2,SAMPLER_TYPES2,SCALE_MODES2,WRAP_MODES2,MIPMAP_MODES2,ALPHA_MODES2,CLEAR_MODES2,GC_MODES2,PRECISION2,MASK_TYPES2,MSAA_QUALITY2;!function(e){e[e.WEBGL_LEGACY=0]="WEBGL_LEGACY",e[e.WEBGL=1]="WEBGL",e[e.WEBGL2=2]="WEBGL2"}(ENV2||(ENV2={})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.WEBGL=1]="WEBGL",e[e.CANVAS=2]="CANVAS"}(RENDERER_TYPE2||(RENDERER_TYPE2={})),function(e){e[e.COLOR=16384]="COLOR",e[e.DEPTH=256]="DEPTH",e[e.STENCIL=1024]="STENCIL"}(BUFFER_BITS2||(BUFFER_BITS2={})),function(e){e[e.NORMAL=0]="NORMAL",e[e.ADD=1]="ADD",e[e.MULTIPLY=2]="MULTIPLY",e[e.SCREEN=3]="SCREEN",e[e.OVERLAY=4]="OVERLAY",e[e.DARKEN=5]="DARKEN",e[e.LIGHTEN=6]="LIGHTEN",e[e.COLOR_DODGE=7]="COLOR_DODGE",e[e.COLOR_BURN=8]="COLOR_BURN",e[e.HARD_LIGHT=9]="HARD_LIGHT",e[e.SOFT_LIGHT=10]="SOFT_LIGHT",e[e.DIFFERENCE=11]="DIFFERENCE",e[e.EXCLUSION=12]="EXCLUSION",e[e.HUE=13]="HUE",e[e.SATURATION=14]="SATURATION",e[e.COLOR=15]="COLOR",e[e.LUMINOSITY=16]="LUMINOSITY",e[e.NORMAL_NPM=17]="NORMAL_NPM",e[e.ADD_NPM=18]="ADD_NPM",e[e.SCREEN_NPM=19]="SCREEN_NPM",e[e.NONE=20]="NONE",e[e.SRC_OVER=0]="SRC_OVER",e[e.SRC_IN=21]="SRC_IN",e[e.SRC_OUT=22]="SRC_OUT",e[e.SRC_ATOP=23]="SRC_ATOP",e[e.DST_OVER=24]="DST_OVER",e[e.DST_IN=25]="DST_IN",e[e.DST_OUT=26]="DST_OUT",e[e.DST_ATOP=27]="DST_ATOP",e[e.ERASE=26]="ERASE",e[e.SUBTRACT=28]="SUBTRACT",e[e.XOR=29]="XOR"}(BLEND_MODES2||(BLEND_MODES2={})),function(e){e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(DRAW_MODES2||(DRAW_MODES2={})),function(e){e[e.RGBA=6408]="RGBA",e[e.RGB=6407]="RGB",e[e.ALPHA=6406]="ALPHA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(FORMATS2||(FORMATS2={})),function(e){e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(TARGETS2||(TARGETS2={})),function(e){e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.FLOAT=5126]="FLOAT",e[e.HALF_FLOAT=36193]="HALF_FLOAT"}(TYPES2||(TYPES2={})),function(e){e[e.FLOAT=0]="FLOAT",e[e.INT=1]="INT",e[e.UINT=2]="UINT"}(SAMPLER_TYPES2||(SAMPLER_TYPES2={})),function(e){e[e.NEAREST=0]="NEAREST",e[e.LINEAR=1]="LINEAR"}(SCALE_MODES2||(SCALE_MODES2={})),function(e){e[e.CLAMP=33071]="CLAMP",e[e.REPEAT=10497]="REPEAT",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(WRAP_MODES2||(WRAP_MODES2={})),function(e){e[e.OFF=0]="OFF",e[e.POW2=1]="POW2",e[e.ON=2]="ON",e[e.ON_MANUAL=3]="ON_MANUAL"}(MIPMAP_MODES2||(MIPMAP_MODES2={})),function(e){e[e.NPM=0]="NPM",e[e.UNPACK=1]="UNPACK",e[e.PMA=2]="PMA",e[e.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",e[e.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",e[e.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(ALPHA_MODES2||(ALPHA_MODES2={})),function(e){e[e.NO=0]="NO",e[e.YES=1]="YES",e[e.AUTO=2]="AUTO",e[e.BLEND=0]="BLEND",e[e.CLEAR=1]="CLEAR",e[e.BLIT=2]="BLIT"}(CLEAR_MODES2||(CLEAR_MODES2={})),function(e){e[e.AUTO=0]="AUTO",e[e.MANUAL=1]="MANUAL"}(GC_MODES2||(GC_MODES2={})),function(e){e.LOW="lowp",e.MEDIUM="mediump",e.HIGH="highp"}(PRECISION2||(PRECISION2={})),function(e){e[e.NONE=0]="NONE",e[e.SCISSOR=1]="SCISSOR",e[e.STENCIL=2]="STENCIL",e[e.SPRITE=3]="SPRITE"}(MASK_TYPES2||(MASK_TYPES2={})),function(e){e[e.NONE=0]="NONE",e[e.LOW=2]="LOW",e[e.MEDIUM=4]="MEDIUM",e[e.HIGH=8]="HIGH"}(MSAA_QUALITY2||(MSAA_QUALITY2={}));var url={parse:import_url.parse,format:import_url.format,resolve:import_url.resolve};settings.RETINA_PREFIX=/@([0-9\.]+)x/,settings.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var saidHello=!1,VERSION="6.0.4",supported;function sayHello(e){var t;if(!saidHello){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var r=["\n %c %c %c PixiJS "+VERSION+" -  "+e+"   %c  %c  http://www.pixijs.com/  %c %c %c%c \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(t=self.console).log.apply(t,r)}else self.console&&self.console.log("PixiJS "+VERSION+" - "+e+" - http://www.pixijs.com/");saidHello=!0}}function isWebGLSupported(){return void 0===supported&&(supported=function(){var e={stencil:!0,failIfMajorPerformanceCaveat:settings.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!self.WebGLRenderingContext)return!1;var t=document.createElement("canvas"),r=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),n=!(!r||!r.getContextAttributes().stencil);if(r){var i=r.getExtension("WEBGL_lose_context");i&&i.loseContext()}return r=null,n}catch(e){return!1}}()),supported}var aliceblue="#f0f8ff",antiquewhite="#faebd7",aqua="#00ffff",aquamarine="#7fffd4",azure="#f0ffff",beige="#f5f5dc",bisque="#ffe4c4",black="#000000",blanchedalmond="#ffebcd",blue="#0000ff",blueviolet="#8a2be2",brown="#a52a2a",burlywood="#deb887",cadetblue="#5f9ea0",chartreuse="#7fff00",chocolate="#d2691e",coral="#ff7f50",cornflowerblue="#6495ed",cornsilk="#fff8dc",crimson="#dc143c",cyan="#00ffff",darkblue="#00008b",darkcyan="#008b8b",darkgoldenrod="#b8860b",darkgray="#a9a9a9",darkgreen="#006400",darkgrey="#a9a9a9",darkkhaki="#bdb76b",darkmagenta="#8b008b",darkolivegreen="#556b2f",darkorange="#ff8c00",darkorchid="#9932cc",darkred="#8b0000",darksalmon="#e9967a",darkseagreen="#8fbc8f",darkslateblue="#483d8b",darkslategray="#2f4f4f",darkslategrey="#2f4f4f",darkturquoise="#00ced1",darkviolet="#9400d3",deeppink="#ff1493",deepskyblue="#00bfff",dimgray="#696969",dimgrey="#696969",dodgerblue="#1e90ff",firebrick="#b22222",floralwhite="#fffaf0",forestgreen="#228b22",fuchsia="#ff00ff",gainsboro="#dcdcdc",ghostwhite="#f8f8ff",goldenrod="#daa520",gold="#ffd700",gray="#808080",green="#008000",greenyellow="#adff2f",grey="#808080",honeydew="#f0fff0",hotpink="#ff69b4",indianred="#cd5c5c",indigo="#4b0082",ivory="#fffff0",khaki="#f0e68c",lavenderblush="#fff0f5",lavender="#e6e6fa",lawngreen="#7cfc00",lemonchiffon="#fffacd",lightblue="#add8e6",lightcoral="#f08080",lightcyan="#e0ffff",lightgoldenrodyellow="#fafad2",lightgray="#d3d3d3",lightgreen="#90ee90",lightgrey="#d3d3d3",lightpink="#ffb6c1",lightsalmon="#ffa07a",lightseagreen="#20b2aa",lightskyblue="#87cefa",lightslategray="#778899",lightslategrey="#778899",lightsteelblue="#b0c4de",lightyellow="#ffffe0",lime="#00ff00",limegreen="#32cd32",linen="#faf0e6",magenta="#ff00ff",maroon="#800000",mediumaquamarine="#66cdaa",mediumblue="#0000cd",mediumorchid="#ba55d3",mediumpurple="#9370db",mediumseagreen="#3cb371",mediumslateblue="#7b68ee",mediumspringgreen="#00fa9a",mediumturquoise="#48d1cc",mediumvioletred="#c71585",midnightblue="#191970",mintcream="#f5fffa",mistyrose="#ffe4e1",moccasin="#ffe4b5",navajowhite="#ffdead",navy="#000080",oldlace="#fdf5e6",olive="#808000",olivedrab="#6b8e23",orange="#ffa500",orangered="#ff4500",orchid="#da70d6",palegoldenrod="#eee8aa",palegreen="#98fb98",paleturquoise="#afeeee",palevioletred="#db7093",papayawhip="#ffefd5",peachpuff="#ffdab9",peru="#cd853f",pink="#ffc0cb",plum="#dda0dd",powderblue="#b0e0e6",purple="#800080",rebeccapurple="#663399",red="#ff0000",rosybrown="#bc8f8f",royalblue="#4169e1",saddlebrown="#8b4513",salmon="#fa8072",sandybrown="#f4a460",seagreen="#2e8b57",seashell="#fff5ee",sienna="#a0522d",silver="#c0c0c0",skyblue="#87ceeb",slateblue="#6a5acd",slategray="#708090",slategrey="#708090",snow="#fffafa",springgreen="#00ff7f",steelblue="#4682b4",tan="#d2b48c",teal="#008080",thistle="#d8bfd8",tomato="#ff6347",turquoise="#40e0d0",violet="#ee82ee",wheat="#f5deb3",white="#ffffff",whitesmoke="#f5f5f5",yellow="#ffff00",yellowgreen="#9acd32",cssColorNames={aliceblue,antiquewhite,aqua,aquamarine,azure,beige,bisque,black,blanchedalmond,blue,blueviolet,brown,burlywood,cadetblue,chartreuse,chocolate,coral,cornflowerblue,cornsilk,crimson,cyan,darkblue,darkcyan,darkgoldenrod,darkgray,darkgreen,darkgrey,darkkhaki,darkmagenta,darkolivegreen,darkorange,darkorchid,darkred,darksalmon,darkseagreen,darkslateblue,darkslategray,darkslategrey,darkturquoise,darkviolet,deeppink,deepskyblue,dimgray,dimgrey,dodgerblue,firebrick,floralwhite,forestgreen,fuchsia,gainsboro,ghostwhite,goldenrod,gold,gray,green,greenyellow,grey,honeydew,hotpink,indianred,indigo,ivory,khaki,lavenderblush,lavender,lawngreen,lemonchiffon,lightblue,lightcoral,lightcyan,lightgoldenrodyellow,lightgray,lightgreen,lightgrey,lightpink,lightsalmon,lightseagreen,lightskyblue,lightslategray,lightslategrey,lightsteelblue,lightyellow,lime,limegreen,linen,magenta,maroon,mediumaquamarine,mediumblue,mediumorchid,mediumpurple,mediumseagreen,mediumslateblue,mediumspringgreen,mediumturquoise,mediumvioletred,midnightblue,mintcream,mistyrose,moccasin,navajowhite,navy,oldlace,olive,olivedrab,orange,orangered,orchid,palegoldenrod,palegreen,paleturquoise,palevioletred,papayawhip,peachpuff,peru,pink,plum,powderblue,purple,rebeccapurple,red,rosybrown,royalblue,saddlebrown,salmon,sandybrown,seagreen,seashell,sienna,silver,skyblue,slateblue,slategray,slategrey,snow,springgreen,steelblue,tan,teal,thistle,tomato,turquoise,violet,wheat,white,whitesmoke,yellow,yellowgreen};function hex2rgb(e,t){return void 0===t&&(t=[]),t[0]=(e>>16&255)/255,t[1]=(e>>8&255)/255,t[2]=(255&e)/255,t}function hex2string(e){var t=e.toString(16);return"#"+("000000".substr(0,6-t.length)+t)}function string2hex(e){return"string"==typeof e&&"#"===(e=cssColorNames[e.toLowerCase()]||e)[0]&&(e=e.substr(1)),parseInt(e,16)}function rgb2hex(e){return(255*e[0]<<16)+(255*e[1]<<8)+(255*e[2]|0)}function mapPremultipliedBlendModes(){for(var e=[],t=[],r=0;r<32;r++)e[r]=r,t[r]=r;e[BLEND_MODES2.NORMAL_NPM]=BLEND_MODES2.NORMAL,e[BLEND_MODES2.ADD_NPM]=BLEND_MODES2.ADD,e[BLEND_MODES2.SCREEN_NPM]=BLEND_MODES2.SCREEN,t[BLEND_MODES2.NORMAL]=BLEND_MODES2.NORMAL_NPM,t[BLEND_MODES2.ADD]=BLEND_MODES2.ADD_NPM,t[BLEND_MODES2.SCREEN]=BLEND_MODES2.SCREEN_NPM;var n=[];return n.push(t),n.push(e),n}var premultiplyBlendMode=mapPremultipliedBlendModes();function correctBlendMode(e,t){return premultiplyBlendMode[t?1:0][e]}function premultiplyRgba(e,t,r,n){return r=r||new Float32Array(4),n||void 0===n?(r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t):(r[0]=e[0],r[1]=e[1],r[2]=e[2]),r[3]=t,r}function premultiplyTint(e,t){if(1===t)return(255*t<<24)+e;if(0===t)return 0;var r=e>>16&255,n=e>>8&255,i=255&e;return(255*t<<24)+((r=r*t+.5|0)<<16)+((n=n*t+.5|0)<<8)+(i*t+.5|0)}function premultiplyTintToRgba(e,t,r,n){return(r=r||new Float32Array(4))[0]=(e>>16&255)/255,r[1]=(e>>8&255)/255,r[2]=(255&e)/255,(n||void 0===n)&&(r[0]*=t,r[1]*=t,r[2]*=t),r[3]=t,r}function createIndicesForQuads(e,t){void 0===t&&(t=null);var r=6*e;if((t=t||new Uint16Array(r)).length!==r)throw new Error("Out buffer length is incorrect, got "+t.length+" and expected "+r);for(var n=0,i=0;n<r;n+=6,i+=4)t[n+0]=i+0,t[n+1]=i+1,t[n+2]=i+2,t[n+3]=i+0,t[n+4]=i+2,t[n+5]=i+3;return t}function nextPow2(e){return e+=0===e?1:0,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,1+(e|=e>>>16)}function isPow2(e){return!(e&e-1||!e)}function log2(e){var t=(e>65535?1:0)<<4,r=((e>>>=t)>255?1:0)<<3;return t|=r,t|=r=((e>>>=r)>15?1:0)<<2,(t|=r=((e>>>=r)>3?1:0)<<1)|(e>>>=r)>>1}function removeItems(e,t,r){var n,i=e.length;if(!(t>=i||0===r)){var s=i-(r=t+r>i?i-t:r);for(n=t;n<s;++n)e[n]=e[n+r];e.length=s}}function sign(e){return 0===e?0:e<0?-1:1}var nextUid=0;function uid(){return++nextUid}var warnings={};function deprecation(e,t,r){if(void 0===r&&(r=3),!warnings[t]){var n=(new Error).stack;void 0===n?console.warn("PixiJS Deprecation Warning: ",t+"\nDeprecated since v"+e):(n=n.split("\n").splice(r).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",t+"\nDeprecated since v"+e),console.warn(n),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",t+"\nDeprecated since v"+e),console.warn(n))),warnings[t]=!0}}var ProgramCache={},TextureCache=Object.create(null),BaseTextureCache=Object.create(null),CanvasRenderTarget=function(){function e(e,t,r){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=r||settings.RESOLUTION,this.resize(e,t)}return e.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},e.prototype.resize=function(e,t){this.canvas.width=e*this.resolution,this.canvas.height=t*this.resolution},e.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(e.prototype,"width",{get:function(){return this.canvas.width},set:function(e){this.canvas.width=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.canvas.height},set:function(e){this.canvas.height=e},enumerable:!1,configurable:!0}),e}(),tempAnchor;function trimCanvas(e){var t,r,n,i=e.width,s=e.height,o=e.getContext("2d"),a=o.getImageData(0,0,i,s).data,l=a.length,h={top:null,left:null,right:null,bottom:null},u=null;for(t=0;t<l;t+=4)0!==a[t+3]&&(r=t/4%i,n=~~(t/4/i),null===h.top&&(h.top=n),(null===h.left||r<h.left)&&(h.left=r),(null===h.right||h.right<r)&&(h.right=r+1),(null===h.bottom||h.bottom<n)&&(h.bottom=n));return null!==h.top&&(i=h.right-h.left,s=h.bottom-h.top+1,u=o.getImageData(h.left,h.top,i,s)),{height:s,width:i,data:u}}function determineCrossOrigin(e,t){if(void 0===t&&(t=self.location),0===e.indexOf("data:"))return"";t=t||self.location,tempAnchor||(tempAnchor=document.createElement("a")),tempAnchor.href=e;var r=url.parse(tempAnchor.href),n=!r.port&&""===t.port||r.port===t.port;return r.hostname===t.hostname&&n&&r.protocol===t.protocol?"":"anonymous"}function getResolutionOfUrl(e,t){var r=settings.RETINA_PREFIX.exec(e);return r?parseFloat(r[1]):void 0!==t?t:1}var PI_2=2*Math.PI,RAD_TO_DEG=180/Math.PI,DEG_TO_RAD=Math.PI/180,SHAPES,SHAPES3;SHAPES3=SHAPES||(SHAPES={}),SHAPES3[SHAPES3.POLY=0]="POLY",SHAPES3[SHAPES3.RECT=1]="RECT",SHAPES3[SHAPES3.CIRC=2]="CIRC",SHAPES3[SHAPES3.ELIP=3]="ELIP",SHAPES3[SHAPES3.RREC=4]="RREC";var Rectangle=function(){function e(e,t,r,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),void 0===n&&(n=0),this.x=Number(e),this.y=Number(t),this.width=Number(r),this.height=Number(n),this.type=SHAPES.RECT}return Object.defineProperty(e.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(e,"EMPTY",{get:function(){return new e(0,0,0,0)},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e.prototype.copyFrom=function(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this},e.prototype.copyTo=function(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e},e.prototype.contains=function(e,t){return!(this.width<=0||this.height<=0)&&e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height},e.prototype.pad=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=e),this.x-=e,this.y-=t,this.width+=2*e,this.height+=2*t,this},e.prototype.fit=function(e){var t=Math.max(this.x,e.x),r=Math.min(this.x+this.width,e.x+e.width),n=Math.max(this.y,e.y),i=Math.min(this.y+this.height,e.y+e.height);return this.x=t,this.width=Math.max(r-t,0),this.y=n,this.height=Math.max(i-n,0),this},e.prototype.ceil=function(e,t){void 0===e&&(e=1),void 0===t&&(t=.001);var r=Math.ceil((this.x+this.width-t)*e)/e,n=Math.ceil((this.y+this.height-t)*e)/e;return this.x=Math.floor((this.x+t)*e)/e,this.y=Math.floor((this.y+t)*e)/e,this.width=r-this.x,this.height=n-this.y,this},e.prototype.enlarge=function(e){var t=Math.min(this.x,e.x),r=Math.max(this.x+this.width,e.x+e.width),n=Math.min(this.y,e.y),i=Math.max(this.y+this.height,e.y+e.height);return this.x=t,this.width=r-t,this.y=n,this.height=i-n,this},e.prototype.toString=function(){return"[@pixi/math:Rectangle x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},e}(),Circle=function(){function e(e,t,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),this.x=e,this.y=t,this.radius=r,this.type=SHAPES.CIRC}return e.prototype.clone=function(){return new e(this.x,this.y,this.radius)},e.prototype.contains=function(e,t){if(this.radius<=0)return!1;var r=this.radius*this.radius,n=this.x-e,i=this.y-t;return(n*=n)+(i*=i)<=r},e.prototype.getBounds=function(){return new Rectangle(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},e.prototype.toString=function(){return"[@pixi/math:Circle x="+this.x+" y="+this.y+" radius="+this.radius+"]"},e}(),Ellipse=function(){function e(e,t,r,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),void 0===n&&(n=0),this.x=e,this.y=t,this.width=r,this.height=n,this.type=SHAPES.ELIP}return e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e.prototype.contains=function(e,t){if(this.width<=0||this.height<=0)return!1;var r=(e-this.x)/this.width,n=(t-this.y)/this.height;return(r*=r)+(n*=n)<=1},e.prototype.getBounds=function(){return new Rectangle(this.x-this.width,this.y-this.height,this.width,this.height)},e.prototype.toString=function(){return"[@pixi/math:Ellipse x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},e}(),Polygon=function(){function e(){for(var e=arguments,t=[],r=0;r<arguments.length;r++)t[r]=e[r];var n=Array.isArray(t[0])?t[0]:t;if("number"!=typeof n[0]){for(var i=[],s=0,o=n.length;s<o;s++)i.push(n[s].x,n[s].y);n=i}this.points=n,this.type=SHAPES.POLY,this.closeStroke=!0}return e.prototype.clone=function(){var t=new e(this.points.slice());return t.closeStroke=this.closeStroke,t},e.prototype.contains=function(e,t){for(var r=!1,n=this.points.length/2,i=0,s=n-1;i<n;s=i++){var o=this.points[2*i],a=this.points[2*i+1],l=this.points[2*s],h=this.points[2*s+1];a>t!=h>t&&e<(t-a)/(h-a)*(l-o)+o&&(r=!r)}return r},e.prototype.toString=function(){return"[@pixi/math:PolygoncloseStroke="+this.closeStroke+"points="+this.points.reduce((function(e,t){return e+", "+t}),"")+"]"},e}(),RoundedRectangle=function(){function e(e,t,r,n,i){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),void 0===n&&(n=0),void 0===i&&(i=20),this.x=e,this.y=t,this.width=r,this.height=n,this.radius=i,this.type=SHAPES.RREC}return e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height,this.radius)},e.prototype.contains=function(e,t){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height){if(t>=this.y+this.radius&&t<=this.y+this.height-this.radius||e>=this.x+this.radius&&e<=this.x+this.width-this.radius)return!0;var r=e-(this.x+this.radius),n=t-(this.y+this.radius),i=this.radius*this.radius;if(r*r+n*n<=i||(r=e-(this.x+this.width-this.radius))*r+n*n<=i||r*r+(n=t-(this.y+this.height-this.radius))*n<=i||(r=e-(this.x+this.radius))*r+n*n<=i)return!0}return!1},e.prototype.toString=function(){return"[@pixi/math:RoundedRectangle x="+this.x+" y="+this.y+"width="+this.width+" height="+this.height+" radius="+this.radius+"]"},e}(),Point=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.x=0,this.y=0,this.x=e,this.y=t}return e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.copyFrom=function(e){return this.set(e.x,e.y),this},e.prototype.copyTo=function(e){return e.set(this.x,this.y),e},e.prototype.equals=function(e){return e.x===this.x&&e.y===this.y},e.prototype.set=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=e),this.x=e,this.y=t,this},e.prototype.toString=function(){return"[@pixi/math:Point x="+this.x+" y="+this.y+"]"},e}(),ObservablePoint=function(){function e(e,t,r,n){void 0===r&&(r=0),void 0===n&&(n=0),this._x=r,this._y=n,this.cb=e,this.scope=t}return e.prototype.clone=function(t,r){return void 0===t&&(t=this.cb),void 0===r&&(r=this.scope),new e(t,r,this._x,this._y)},e.prototype.set=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=e),(this._x!==e||this._y!==t)&&(this._x=e,this._y=t,this.cb.call(this.scope)),this},e.prototype.copyFrom=function(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this},e.prototype.copyTo=function(e){return e.set(this._x,this._y),e},e.prototype.equals=function(e){return e.x===this._x&&e.y===this._y},e.prototype.toString=function(){return"[@pixi/math:ObservablePoint x=0 y=0 scope="+this.scope+"]"},Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),e}(),Matrix=function(){function e(e,t,r,n,i,s){void 0===e&&(e=1),void 0===t&&(t=0),void 0===r&&(r=0),void 0===n&&(n=1),void 0===i&&(i=0),void 0===s&&(s=0),this.array=null,this.a=e,this.b=t,this.c=r,this.d=n,this.tx=i,this.ty=s}return e.prototype.fromArray=function(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]},e.prototype.set=function(e,t,r,n,i,s){return this.a=e,this.b=t,this.c=r,this.d=n,this.tx=i,this.ty=s,this},e.prototype.toArray=function(e,t){this.array||(this.array=new Float32Array(9));var r=t||this.array;return e?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r},e.prototype.apply=function(e,t){t=t||new Point;var r=e.x,n=e.y;return t.x=this.a*r+this.c*n+this.tx,t.y=this.b*r+this.d*n+this.ty,t},e.prototype.applyInverse=function(e,t){t=t||new Point;var r=1/(this.a*this.d+this.c*-this.b),n=e.x,i=e.y;return t.x=this.d*r*n+-this.c*r*i+(this.ty*this.c-this.tx*this.d)*r,t.y=this.a*r*i+-this.b*r*n+(-this.ty*this.a+this.tx*this.b)*r,t},e.prototype.translate=function(e,t){return this.tx+=e,this.ty+=t,this},e.prototype.scale=function(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this},e.prototype.rotate=function(e){var t=Math.cos(e),r=Math.sin(e),n=this.a,i=this.c,s=this.tx;return this.a=n*t-this.b*r,this.b=n*r+this.b*t,this.c=i*t-this.d*r,this.d=i*r+this.d*t,this.tx=s*t-this.ty*r,this.ty=s*r+this.ty*t,this},e.prototype.append=function(e){var t=this.a,r=this.b,n=this.c,i=this.d;return this.a=e.a*t+e.b*n,this.b=e.a*r+e.b*i,this.c=e.c*t+e.d*n,this.d=e.c*r+e.d*i,this.tx=e.tx*t+e.ty*n+this.tx,this.ty=e.tx*r+e.ty*i+this.ty,this},e.prototype.setTransform=function(e,t,r,n,i,s,o,a,l){return this.a=Math.cos(o+l)*i,this.b=Math.sin(o+l)*i,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=e-(r*this.a+n*this.c),this.ty=t-(r*this.b+n*this.d),this},e.prototype.prepend=function(e){var t=this.tx;if(1!==e.a||0!==e.b||0!==e.c||1!==e.d){var r=this.a,n=this.c;this.a=r*e.a+this.b*e.c,this.b=r*e.b+this.b*e.d,this.c=n*e.a+this.d*e.c,this.d=n*e.b+this.d*e.d}return this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty,this},e.prototype.decompose=function(e){var t=this.a,r=this.b,n=this.c,i=this.d,s=e.pivot,o=-Math.atan2(-n,i),a=Math.atan2(r,t),l=Math.abs(o+a);return l<1e-5||Math.abs(PI_2-l)<1e-5?(e.rotation=a,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=o,e.skew.y=a),e.scale.x=Math.sqrt(t*t+r*r),e.scale.y=Math.sqrt(n*n+i*i),e.position.x=this.tx+(s.x*t+s.y*n),e.position.y=this.ty+(s.x*r+s.y*i),e},e.prototype.invert=function(){var e=this.a,t=this.b,r=this.c,n=this.d,i=this.tx,s=e*n-t*r;return this.a=n/s,this.b=-t/s,this.c=-r/s,this.d=e/s,this.tx=(r*this.ty-n*i)/s,this.ty=-(e*this.ty-t*i)/s,this},e.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},e.prototype.clone=function(){var t=new e;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},e.prototype.copyTo=function(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},e.prototype.copyFrom=function(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this},e.prototype.toString=function(){return"[@pixi/math:Matrix a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+"]"},Object.defineProperty(e,"IDENTITY",{get:function(){return new e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"TEMP_MATRIX",{get:function(){return new e},enumerable:!1,configurable:!0}),e}(),ux=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],uy=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],vx=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],vy=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],rotationCayley=[],rotationMatrices=[],signum=Math.sign;function init(){for(var e=0;e<16;e++){var t=[];rotationCayley.push(t);for(var r=0;r<16;r++)for(var n=signum(ux[e]*ux[r]+vx[e]*uy[r]),i=signum(uy[e]*ux[r]+vy[e]*uy[r]),s=signum(ux[e]*vx[r]+vx[e]*vy[r]),o=signum(uy[e]*vx[r]+vy[e]*vy[r]),a=0;a<16;a++)if(ux[a]===n&&uy[a]===i&&vx[a]===s&&vy[a]===o){t.push(a);break}}for(e=0;e<16;e++){var l=new Matrix;l.set(ux[e],uy[e],vx[e],vy[e],0,0),rotationMatrices.push(l)}}init();var groupD8={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(e){return ux[e]},uY:function(e){return uy[e]},vX:function(e){return vx[e]},vY:function(e){return vy[e]},inv:function(e){return 8&e?15&e:7&-e},add:function(e,t){return rotationCayley[e][t]},sub:function(e,t){return rotationCayley[e][groupD8.inv(t)]},rotate180:function(e){return 4^e},isVertical:function(e){return 2==(3&e)},byDirection:function(e,t){return 2*Math.abs(e)<=Math.abs(t)?t>=0?groupD8.S:groupD8.N:2*Math.abs(t)<=Math.abs(e)?e>0?groupD8.E:groupD8.W:t>0?e>0?groupD8.SE:groupD8.SW:e>0?groupD8.NE:groupD8.NW},matrixAppendRotationInv:function(e,t,r,n){void 0===r&&(r=0),void 0===n&&(n=0);var i=rotationMatrices[groupD8.inv(t)];i.tx=r,i.ty=n,e.append(i)}},Transform=function(){function e(){this.worldTransform=new Matrix,this.localTransform=new Matrix,this.position=new ObservablePoint(this.onChange,this,0,0),this.scale=new ObservablePoint(this.onChange,this,1,1),this.pivot=new ObservablePoint(this.onChange,this,0,0),this.skew=new ObservablePoint(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return e.prototype.onChange=function(){this._localID++},e.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},e.prototype.toString=function(){return"[@pixi/math:Transform position=("+this.position.x+", "+this.position.y+") rotation="+this.rotation+" scale=("+this.scale.x+", "+this.scale.y+") skew=("+this.skew.x+", "+this.skew.y+") ]"},e.prototype.updateLocalTransform=function(){var e=this.localTransform;this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1)},e.prototype.updateTransform=function(e){var t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==e._worldID){var r=e.worldTransform,n=this.worldTransform;n.a=t.a*r.a+t.b*r.c,n.b=t.a*r.b+t.b*r.d,n.c=t.c*r.a+t.d*r.c,n.d=t.c*r.b+t.d*r.d,n.tx=t.tx*r.a+t.ty*r.c+r.tx,n.ty=t.tx*r.b+t.ty*r.d+r.ty,this._parentID=e._worldID,this._worldID++}},e.prototype.setFromMatrix=function(e){e.decompose(this),this._localID++},Object.defineProperty(e.prototype,"rotation",{get:function(){return this._rotation},set:function(e){this._rotation!==e&&(this._rotation=e,this.updateSkew())},enumerable:!1,configurable:!0}),e.IDENTITY=new e,e}();settings.SORTABLE_CHILDREN=!1;var Bounds=function(){function e(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}return e.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},e.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},e.prototype.getRectangle=function(e){return this.minX>this.maxX||this.minY>this.maxY?Rectangle.EMPTY:((e=e||new Rectangle(0,0,1,1)).x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)},e.prototype.addPoint=function(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)},e.prototype.addPointMatrix=function(e,t){var r=e.a,n=e.b,i=e.c,s=e.d,o=e.tx,a=e.ty,l=r*t.x+i*t.y+o,h=n*t.x+s*t.y+a;this.minX=Math.min(this.minX,l),this.maxX=Math.max(this.maxX,l),this.minY=Math.min(this.minY,h),this.maxY=Math.max(this.maxY,h)},e.prototype.addQuad=function(e){var t=this.minX,r=this.minY,n=this.maxX,i=this.maxY,s=e[0],o=e[1];t=s<t?s:t,r=o<r?o:r,n=s>n?s:n,i=o>i?o:i,t=(s=e[2])<t?s:t,r=(o=e[3])<r?o:r,n=s>n?s:n,i=o>i?o:i,t=(s=e[4])<t?s:t,r=(o=e[5])<r?o:r,n=s>n?s:n,i=o>i?o:i,t=(s=e[6])<t?s:t,r=(o=e[7])<r?o:r,n=s>n?s:n,i=o>i?o:i,this.minX=t,this.minY=r,this.maxX=n,this.maxY=i},e.prototype.addFrame=function(e,t,r,n,i){this.addFrameMatrix(e.worldTransform,t,r,n,i)},e.prototype.addFrameMatrix=function(e,t,r,n,i){var s=e.a,o=e.b,a=e.c,l=e.d,h=e.tx,u=e.ty,c=this.minX,d=this.minY,f=this.maxX,p=this.maxY,m=s*t+a*r+h,_=o*t+l*r+u;c=m<c?m:c,d=_<d?_:d,f=m>f?m:f,p=_>p?_:p,c=(m=s*n+a*r+h)<c?m:c,d=(_=o*n+l*r+u)<d?_:d,f=m>f?m:f,p=_>p?_:p,c=(m=s*t+a*i+h)<c?m:c,d=(_=o*t+l*i+u)<d?_:d,f=m>f?m:f,p=_>p?_:p,c=(m=s*n+a*i+h)<c?m:c,d=(_=o*n+l*i+u)<d?_:d,f=m>f?m:f,p=_>p?_:p,this.minX=c,this.minY=d,this.maxX=f,this.maxY=p},e.prototype.addVertexData=function(e,t,r){for(var n=this.minX,i=this.minY,s=this.maxX,o=this.maxY,a=t;a<r;a+=2){var l=e[a],h=e[a+1];n=l<n?l:n,i=h<i?h:i,s=l>s?l:s,o=h>o?h:o}this.minX=n,this.minY=i,this.maxX=s,this.maxY=o},e.prototype.addVertices=function(e,t,r,n){this.addVerticesMatrix(e.worldTransform,t,r,n)},e.prototype.addVerticesMatrix=function(e,t,r,n,i,s){void 0===i&&(i=0),void 0===s&&(s=i);for(var o=e.a,a=e.b,l=e.c,h=e.d,u=e.tx,c=e.ty,d=this.minX,f=this.minY,p=this.maxX,m=this.maxY,_=r;_<n;_+=2){var g=t[_],v=t[_+1],y=o*g+l*v+u,b=h*v+a*g+c;d=Math.min(d,y-i),p=Math.max(p,y+i),f=Math.min(f,b-s),m=Math.max(m,b+s)}this.minX=d,this.minY=f,this.maxX=p,this.maxY=m},e.prototype.addBounds=function(e){var t=this.minX,r=this.minY,n=this.maxX,i=this.maxY;this.minX=e.minX<t?e.minX:t,this.minY=e.minY<r?e.minY:r,this.maxX=e.maxX>n?e.maxX:n,this.maxY=e.maxY>i?e.maxY:i},e.prototype.addBoundsMask=function(e,t){var r=e.minX>t.minX?e.minX:t.minX,n=e.minY>t.minY?e.minY:t.minY,i=e.maxX<t.maxX?e.maxX:t.maxX,s=e.maxY<t.maxY?e.maxY:t.maxY;if(r<=i&&n<=s){var o=this.minX,a=this.minY,l=this.maxX,h=this.maxY;this.minX=r<o?r:o,this.minY=n<a?n:a,this.maxX=i>l?i:l,this.maxY=s>h?s:h}},e.prototype.addBoundsMatrix=function(e,t){this.addFrameMatrix(t,e.minX,e.minY,e.maxX,e.maxY)},e.prototype.addBoundsArea=function(e,t){var r=e.minX>t.x?e.minX:t.x,n=e.minY>t.y?e.minY:t.y,i=e.maxX<t.x+t.width?e.maxX:t.x+t.width,s=e.maxY<t.y+t.height?e.maxY:t.y+t.height;if(r<=i&&n<=s){var o=this.minX,a=this.minY,l=this.maxX,h=this.maxY;this.minX=r<o?r:o,this.minY=n<a?n:a,this.maxX=i>l?i:l,this.maxY=s>h?s:h}},e.prototype.pad=function(e,t){void 0===e&&(e=0),void 0===t&&(t=e),this.isEmpty()||(this.minX-=e,this.maxX+=e,this.minY-=t,this.maxY+=t)},e.prototype.addFramePad=function(e,t,r,n,i,s){e-=i,t-=s,r+=i,n+=s,this.minX=this.minX<e?this.minX:e,this.maxX=this.maxX>r?this.maxX:r,this.minY=this.minY<t?this.minY:t,this.maxY=this.maxY>n?this.maxY:n},e}(),extendStatics=function(e,t){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},extendStatics(e,t)};function __extends(e,t){function r(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var DisplayObject=function(e){function t(){var t=e.call(this)||this;return t.tempDisplayObjectParent=null,t.transform=new Transform,t.alpha=1,t.visible=!0,t.renderable=!0,t.parent=null,t.worldAlpha=1,t._lastSortedIndex=0,t._zIndex=0,t.filterArea=null,t.filters=null,t._enabledFilters=null,t._bounds=new Bounds,t._localBounds=null,t._boundsID=0,t._boundsRect=null,t._localBoundsRect=null,t._mask=null,t._destroyed=!1,t.isSprite=!1,t.isMask=!1,t}return __extends(t,e),t.mixin=function(e){for(var r=Object.keys(e),n=0;n<r.length;++n){var i=r[n];Object.defineProperty(t.prototype,i,Object.getOwnPropertyDescriptor(e,i))}},t.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},t.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},t.prototype.getBounds=function(e,t){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),t||(this._boundsRect||(this._boundsRect=new Rectangle),t=this._boundsRect),this._bounds.getRectangle(t)},t.prototype.getLocalBounds=function(e){e||(this._localBoundsRect||(this._localBoundsRect=new Rectangle),e=this._localBoundsRect),this._localBounds||(this._localBounds=new Bounds);var t=this.transform,r=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;var n=this._bounds,i=this._boundsID;this._bounds=this._localBounds;var s=this.getBounds(!1,e);return this.parent=r,this.transform=t,this._bounds=n,this._bounds.updateID+=this._boundsID-i,s},t.prototype.toGlobal=function(e,t,r){return void 0===r&&(r=!1),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,t)},t.prototype.toLocal=function(e,t,r,n){return t&&(e=t.toGlobal(e,r,n)),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,r)},t.prototype.setParent=function(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e},t.prototype.setTransform=function(e,t,r,n,i,s,o,a,l){return void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=1),void 0===n&&(n=1),void 0===i&&(i=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===l&&(l=0),this.position.x=e,this.position.y=t,this.scale.x=r||1,this.scale.y=n||1,this.rotation=i,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=l,this},t.prototype.destroy=function(e){this.parent&&this.parent.removeChild(this),this.removeAllListeners(),this.transform=null,this.parent=null,this._bounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},Object.defineProperty(t.prototype,"_tempDisplayObjectParent",{get:function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new TemporaryDisplayObject),this.tempDisplayObjectParent},enumerable:!1,configurable:!0}),t.prototype.enableTempParent=function(){var e=this.parent;return this.parent=this._tempDisplayObjectParent,e},t.prototype.disableTempParent=function(e){this.parent=e},Object.defineProperty(t.prototype,"x",{get:function(){return this.position.x},set:function(e){this.transform.position.x=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.position.y},set:function(e){this.transform.position.y=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"worldTransform",{get:function(){return this.transform.worldTransform},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localTransform",{get:function(){return this.transform.localTransform},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this.transform.position},set:function(e){this.transform.position.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scale",{get:function(){return this.transform.scale},set:function(e){this.transform.scale.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pivot",{get:function(){return this.transform.pivot},set:function(e){this.transform.pivot.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"skew",{get:function(){return this.transform.skew},set:function(e){this.transform.skew.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(e){this.transform.rotation=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"angle",{get:function(){return this.transform.rotation*RAD_TO_DEG},set:function(e){this.transform.rotation=e*DEG_TO_RAD},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"zIndex",{get:function(){return this._zIndex},set:function(e){this._zIndex=e,this.parent&&(this.parent.sortDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"worldVisible",{get:function(){var e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mask",{get:function(){return this._mask},set:function(e){var t;this._mask&&((t=this._mask.maskObject||this._mask).renderable=!0,t.isMask=!1),this._mask=e,this._mask&&((t=this._mask.maskObject||this._mask).renderable=!1,t.isMask=!0)},enumerable:!1,configurable:!0}),t}(import_eventemitter3.default),TemporaryDisplayObject=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sortDirty=null,t}return __extends(t,e),t}(DisplayObject);function sortChildren(e,t){return e.zIndex===t.zIndex?e._lastSortedIndex-t._lastSortedIndex:e.zIndex-t.zIndex}DisplayObject.prototype.displayObjectUpdateTransform=DisplayObject.prototype.updateTransform;var Container=function(e){function t(){var t=e.call(this)||this;return t.children=[],t.sortableChildren=settings.SORTABLE_CHILDREN,t.sortDirty=!1,t}return __extends(t,e),t.prototype.onChildrenChange=function(e){},t.prototype.addChild=function(){for(var e=arguments,t=[],r=0;r<arguments.length;r++)t[r]=e[r];if(t.length>1)for(var n=0;n<t.length;n++)this.addChild(t[n]);else{var i=t[0];i.parent&&i.parent.removeChild(i),i.parent=this,this.sortDirty=!0,i.transform._parentID=-1,this.children.push(i),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",i,this,this.children.length-1),i.emit("added",this)}return t[0]},t.prototype.addChildAt=function(e,t){if(t<0||t>this.children.length)throw new Error(e+"addChildAt: The index "+t+" supplied is out of bounds "+this.children.length);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(t,0,e),this._boundsID++,this.onChildrenChange(t),e.emit("added",this),this.emit("childAdded",e,this,t),e},t.prototype.swapChildren=function(e,t){if(e!==t){var r=this.getChildIndex(e),n=this.getChildIndex(t);this.children[r]=t,this.children[n]=e,this.onChildrenChange(r<n?r:n)}},t.prototype.getChildIndex=function(e){var t=this.children.indexOf(e);if(-1===t)throw new Error("The supplied DisplayObject must be a child of the caller");return t},t.prototype.setChildIndex=function(e,t){if(t<0||t>=this.children.length)throw new Error("The index "+t+" supplied is out of bounds "+this.children.length);var r=this.getChildIndex(e);removeItems(this.children,r,1),this.children.splice(t,0,e),this.onChildrenChange(t)},t.prototype.getChildAt=function(e){if(e<0||e>=this.children.length)throw new Error("getChildAt: Index ("+e+") does not exist.");return this.children[e]},t.prototype.removeChild=function(){for(var e=arguments,t=[],r=0;r<arguments.length;r++)t[r]=e[r];if(t.length>1)for(var n=0;n<t.length;n++)this.removeChild(t[n]);else{var i=t[0],s=this.children.indexOf(i);if(-1===s)return null;i.parent=null,i.transform._parentID=-1,removeItems(this.children,s,1),this._boundsID++,this.onChildrenChange(s),i.emit("removed",this),this.emit("childRemoved",i,this,s)}return t[0]},t.prototype.removeChildAt=function(e){var t=this.getChildAt(e);return t.parent=null,t.transform._parentID=-1,removeItems(this.children,e,1),this._boundsID++,this.onChildrenChange(e),t.emit("removed",this),this.emit("childRemoved",t,this,e),t},t.prototype.removeChildren=function(e,t){void 0===e&&(e=0),void 0===t&&(t=this.children.length);var r,n=e,i=t-n;if(i>0&&i<=t){r=this.children.splice(n,i);for(var s=0;s<r.length;++s)r[s].parent=null,r[s].transform&&(r[s].transform._parentID=-1);for(this._boundsID++,this.onChildrenChange(e),s=0;s<r.length;++s)r[s].emit("removed",this),this.emit("childRemoved",r[s],this,s);return r}if(0===i&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},t.prototype.sortChildren=function(){for(var e=!1,t=0,r=this.children.length;t<r;++t){var n=this.children[t];n._lastSortedIndex=t,!e&&0!==n.zIndex&&(e=!0)}e&&this.children.length>1&&this.children.sort(sortChildren),this.sortDirty=!1},t.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var e=0,t=this.children.length;e<t;++e){var r=this.children[e];r.visible&&r.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var e=0;e<this.children.length;e++){var t=this.children[e];if(t.visible&&t.renderable)if(t.calculateBounds(),t._mask){var r=t._mask.maskObject||t._mask;r.calculateBounds(),this._bounds.addBoundsMask(t._bounds,r._bounds)}else t.filterArea?this._bounds.addBoundsArea(t._bounds,t.filterArea):this._bounds.addBounds(t._bounds)}this._bounds.updateID=this._boundsID},t.prototype.getLocalBounds=function(t,r){void 0===r&&(r=!1);var n=e.prototype.getLocalBounds.call(this,t);if(!r)for(var i=0,s=this.children.length;i<s;++i){var o=this.children[i];o.visible&&o.updateTransform()}return n},t.prototype._calculateBounds=function(){},t.prototype.render=function(e){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(e);else{this._render(e);for(var t=0,r=this.children.length;t<r;++t)this.children[t].render(e)}},t.prototype.renderAdvanced=function(e){e.batch.flush();var t=this.filters,r=this._mask;if(t){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var n=0;n<t.length;n++)t[n].enabled&&this._enabledFilters.push(t[n]);this._enabledFilters.length&&e.filter.push(this,this._enabledFilters)}r&&e.mask.push(this,this._mask),this._render(e),n=0;for(var i=this.children.length;n<i;n++)this.children[n].render(e);e.batch.flush(),r&&e.mask.pop(this),t&&this._enabledFilters&&this._enabledFilters.length&&e.filter.pop()},t.prototype._render=function(e){},t.prototype.destroy=function(t){e.prototype.destroy.call(this),this.sortDirty=!1;var r="boolean"==typeof t?t:t&&t.children,n=this.removeChildren(0,this.children.length);if(r)for(var i=0;i<n.length;++i)n[i].destroy(t)},Object.defineProperty(t.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(e){var t=this.getLocalBounds().width;this.scale.x=0!==t?e/t:1,this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(e){var t=this.getLocalBounds().height;this.scale.y=0!==t?e/t:1,this._height=e},enumerable:!1,configurable:!0}),t}(DisplayObject);Container.prototype.containerUpdateTransform=Container.prototype.updateTransform;var accessibleTarget={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};DisplayObject.mixin(accessibleTarget);var KEY_CODE_TAB=9,DIV_TOUCH_SIZE=100,DIV_TOUCH_POS_X=0,DIV_TOUCH_POS_Y=0,DIV_TOUCH_ZINDEX=2,DIV_HOOK_SIZE=1,DIV_HOOK_POS_X=-1e3,DIV_HOOK_POS_Y=-1e3,DIV_HOOK_ZINDEX=2,AccessibilityManager=function(){function e(e){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(isMobile2.tablet||isMobile2.phone)&&this.createTouchHook();var t=document.createElement("div");t.style.width=DIV_TOUCH_SIZE+"px",t.style.height=DIV_TOUCH_SIZE+"px",t.style.position="absolute",t.style.top=DIV_TOUCH_POS_X+"px",t.style.left=DIV_TOUCH_POS_Y+"px",t.style.zIndex=DIV_TOUCH_ZINDEX.toString(),this.div=t,this.renderer=e,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),self.addEventListener("keydown",this._onKeyDown,!1)}return Object.defineProperty(e.prototype,"isActive",{get:function(){return this._isActive},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMobileAccessibility",{get:function(){return this._isMobileAccessibility},enumerable:!1,configurable:!0}),e.prototype.createTouchHook=function(){var e=this,t=document.createElement("button");t.style.width=DIV_HOOK_SIZE+"px",t.style.height=DIV_HOOK_SIZE+"px",t.style.position="absolute",t.style.top=DIV_HOOK_POS_X+"px",t.style.left=DIV_HOOK_POS_Y+"px",t.style.zIndex=DIV_HOOK_ZINDEX.toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",(function(){e._isMobileAccessibility=!0,e.activate(),e.destroyTouchHook()})),document.body.appendChild(t),this._hookDiv=t},e.prototype.destroyTouchHook=function(){!this._hookDiv||(document.body.removeChild(this._hookDiv),this._hookDiv=null)},e.prototype.activate=function(){var e;this._isActive||(this._isActive=!0,self.document.addEventListener("mousemove",this._onMouseMove,!0),self.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),null===(e=this.renderer.view.parentNode)||void 0===e||e.appendChild(this.div))},e.prototype.deactivate=function(){var e;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,self.document.removeEventListener("mousemove",this._onMouseMove,!0),self.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),null===(e=this.div.parentNode)||void 0===e||e.removeChild(this.div))},e.prototype.updateAccessibleObjects=function(e){if(e.visible&&e.accessibleChildren){e.accessible&&e.interactive&&(e._accessibleActive||this.addChild(e),e.renderId=this.renderId);for(var t=e.children,r=0;r<t.length;r++)this.updateAccessibleObjects(t[r])}},e.prototype.update=function(){var e=performance.now();if(!(isMobile2.android.device&&e<this.androidUpdateCount)&&(this.androidUpdateCount=e+this.androidUpdateFrequency,this.renderer.renderingToScreen)){this.renderer._lastObjectRendered&&this.updateAccessibleObjects(this.renderer._lastObjectRendered);var t=this.renderer.view.getBoundingClientRect(),r=t.left,n=t.top,i=t.width,s=t.height,o=this.renderer,a=o.width,l=o.height,h=o.resolution,u=i/a*h,c=s/l*h,d=this.div;d.style.left=r+"px",d.style.top=n+"px",d.style.width=a+"px",d.style.height=l+"px";for(var f=0;f<this.children.length;f++){var p=this.children[f];if(p.renderId!==this.renderId)p._accessibleActive=!1,removeItems(this.children,f,1),this.div.removeChild(p._accessibleDiv),this.pool.push(p._accessibleDiv),p._accessibleDiv=null,f--;else{d=p._accessibleDiv;var m=p.hitArea,_=p.worldTransform;p.hitArea?(d.style.left=(_.tx+m.x*_.a)*u+"px",d.style.top=(_.ty+m.y*_.d)*c+"px",d.style.width=m.width*_.a*u+"px",d.style.height=m.height*_.d*c+"px"):(m=p.getBounds(),this.capHitArea(m),d.style.left=m.x*u+"px",d.style.top=m.y*c+"px",d.style.width=m.width*u+"px",d.style.height=m.height*c+"px",d.title!==p.accessibleTitle&&null!==p.accessibleTitle&&(d.title=p.accessibleTitle),d.getAttribute("aria-label")!==p.accessibleHint&&null!==p.accessibleHint&&d.setAttribute("aria-label",p.accessibleHint)),(p.accessibleTitle!==d.title||p.tabIndex!==d.tabIndex)&&(d.title=p.accessibleTitle,d.tabIndex=p.tabIndex,this.debug&&this.updateDebugHTML(d))}}this.renderId++}},e.prototype.updateDebugHTML=function(e){e.innerHTML="type: "+e.type+"</br> title : "+e.title+"</br> tabIndex: "+e.tabIndex},e.prototype.capHitArea=function(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0);var t=this.renderer,r=t.width,n=t.height;e.x+e.width>r&&(e.width=r-e.x),e.y+e.height>n&&(e.height=n-e.y)},e.prototype.addChild=function(e){var t=this.pool.pop();t||((t=document.createElement("button")).style.width=DIV_TOUCH_SIZE+"px",t.style.height=DIV_TOUCH_SIZE+"px",t.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",t.style.position="absolute",t.style.zIndex=DIV_TOUCH_ZINDEX.toString(),t.style.borderStyle="none",navigator.userAgent.toLowerCase().indexOf("chrome")>-1?t.setAttribute("aria-live","off"):t.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?t.setAttribute("aria-relevant","additions"):t.setAttribute("aria-relevant","text"),t.addEventListener("click",this._onClick.bind(this)),t.addEventListener("focus",this._onFocus.bind(this)),t.addEventListener("focusout",this._onFocusOut.bind(this))),t.style.pointerEvents=e.accessiblePointerEvents,t.type=e.accessibleType,e.accessibleTitle&&null!==e.accessibleTitle?t.title=e.accessibleTitle:(!e.accessibleHint||null===e.accessibleHint)&&(t.title="displayObject "+e.tabIndex),e.accessibleHint&&null!==e.accessibleHint&&t.setAttribute("aria-label",e.accessibleHint),this.debug&&this.updateDebugHTML(t),e._accessibleActive=!0,e._accessibleDiv=t,t.displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex},e.prototype._onClick=function(e){var t=this.renderer.plugins.interaction,r=e.target.displayObject,n=t.eventData;t.dispatchEvent(r,"click",n),t.dispatchEvent(r,"pointertap",n),t.dispatchEvent(r,"tap",n)},e.prototype._onFocus=function(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive");var t=this.renderer.plugins.interaction,r=e.target.displayObject,n=t.eventData;t.dispatchEvent(r,"mouseover",n)},e.prototype._onFocusOut=function(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite");var t=this.renderer.plugins.interaction,r=e.target.displayObject,n=t.eventData;t.dispatchEvent(r,"mouseout",n)},e.prototype._onKeyDown=function(e){e.keyCode===KEY_CODE_TAB&&this.activate()},e.prototype._onMouseMove=function(e){0===e.movementX&&0===e.movementY||this.deactivate()},e.prototype.destroy=function(){this.destroyTouchHook(),this.div=null,self.document.removeEventListener("mousemove",this._onMouseMove,!0),self.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},e}(),UPDATE_PRIORITY,UPDATE_PRIORITY3;settings.TARGET_FPMS=.06,UPDATE_PRIORITY3=UPDATE_PRIORITY||(UPDATE_PRIORITY={}),UPDATE_PRIORITY3[UPDATE_PRIORITY3.INTERACTION=50]="INTERACTION",UPDATE_PRIORITY3[UPDATE_PRIORITY3.HIGH=25]="HIGH",UPDATE_PRIORITY3[UPDATE_PRIORITY3.NORMAL=0]="NORMAL",UPDATE_PRIORITY3[UPDATE_PRIORITY3.LOW=-25]="LOW",UPDATE_PRIORITY3[UPDATE_PRIORITY3.UTILITY=-50]="UTILITY";var TickerListener=function(){function e(e,t,r,n){void 0===t&&(t=null),void 0===r&&(r=0),void 0===n&&(n=!1),this.next=null,this.previous=null,this._destroyed=!1,this.fn=e,this.context=t,this.priority=r,this.once=n}return e.prototype.match=function(e,t){return void 0===t&&(t=null),this.fn===e&&this.context===t},e.prototype.emit=function(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));var t=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),t},e.prototype.connect=function(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this},e.prototype.destroy=function(e){void 0===e&&(e=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var t=this.next;return this.next=e?null:t,this.previous=null,t},e}(),Ticker=function(){function e(){var e=this;this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new TickerListener(null,null,1/0),this.deltaMS=1/settings.TARGET_FPMS,this.elapsedMS=1/settings.TARGET_FPMS,this._tick=function(t){e._requestId=null,e.started&&(e.update(t),e.started&&null===e._requestId&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}return e.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},e.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},e.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},e.prototype.add=function(e,t,r){return void 0===r&&(r=UPDATE_PRIORITY.NORMAL),this._addListener(new TickerListener(e,t,r))},e.prototype.addOnce=function(e,t,r){return void 0===r&&(r=UPDATE_PRIORITY.NORMAL),this._addListener(new TickerListener(e,t,r,!0))},e.prototype._addListener=function(e){var t=this._head.next,r=this._head;if(t){for(;t;){if(e.priority>t.priority){e.connect(r);break}r=t,t=t.next}e.previous||e.connect(r)}else e.connect(r);return this._startIfPossible(),this},e.prototype.remove=function(e,t){for(var r=this._head.next;r;)r=r.match(e,t)?r.destroy():r.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(e.prototype,"count",{get:function(){if(!this._head)return 0;for(var e=0,t=this._head;t=t.next;)e++;return e},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},e.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},e.prototype.destroy=function(){if(!this._protected){this.stop();for(var e=this._head.next;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}},e.prototype.update=function(e){var t;if(void 0===e&&(e=performance.now()),e>this.lastTime){if((t=this.elapsedMS=e-this.lastTime)>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){var r=e-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=e-r%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*settings.TARGET_FPMS;for(var n=this._head,i=n.next;i;)i=i.emit(this.deltaTime);n.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e},Object.defineProperty(e.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(e){var t=Math.min(this.maxFPS,e),r=Math.min(Math.max(0,t)/1e3,settings.TARGET_FPMS);this._maxElapsedMS=1/r},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(e){if(0===e)this._minElapsedMS=0;else{var t=Math.max(this.minFPS,e);this._minElapsedMS=1/(t/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(e,"shared",{get:function(){if(!e._shared){var t=e._shared=new e;t.autoStart=!0,t._protected=!0}return e._shared},enumerable:!1,configurable:!0}),Object.defineProperty(e,"system",{get:function(){if(!e._system){var t=e._system=new e;t.autoStart=!0,t._protected=!0}return e._system},enumerable:!1,configurable:!0}),e}(),TickerPlugin=function(){function e(){}return e.init=function(e){var t=this;e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set:function(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,UPDATE_PRIORITY.LOW)},get:function(){return this._ticker}}),this.stop=function(){t._ticker.stop()},this.start=function(){t._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?Ticker.shared:new Ticker,e.autoStart&&this.start()},e.destroy=function(){if(this._ticker){var e=this._ticker;this.ticker=null,e.destroy()}},e}(),InteractionData=function(){function e(){this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0,this.global=new Point,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return Object.defineProperty(e.prototype,"pointerId",{get:function(){return this.identifier},enumerable:!1,configurable:!0}),e.prototype.getLocalPosition=function(e,t,r){return e.worldTransform.applyInverse(r||this.global,t)},e.prototype.copyEvent=function(e){"isPrimary"in e&&e.isPrimary&&(this.isPrimary=!0),this.button="button"in e&&e.button;var t="buttons"in e&&e.buttons;this.buttons=Number.isInteger(t)?t:"which"in e&&e.which,this.width="width"in e&&e.width,this.height="height"in e&&e.height,this.tiltX="tiltX"in e&&e.tiltX,this.tiltY="tiltY"in e&&e.tiltY,this.pointerType="pointerType"in e&&e.pointerType,this.pressure="pressure"in e&&e.pressure,this.rotationAngle="rotationAngle"in e&&e.rotationAngle,this.twist="twist"in e&&e.twist||0,this.tangentialPressure="tangentialPressure"in e&&e.tangentialPressure||0},e.prototype.reset=function(){this.isPrimary=!1},e}(),extendStatics2=function(e,t){return extendStatics2=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},extendStatics2(e,t)};function __extends2(e,t){function r(){this.constructor=e}extendStatics2(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var InteractionEvent=function(){function e(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return e.prototype.stopPropagation=function(){this.stopped=!0,this.stopPropagationHint=!0,this.stopsPropagatingAt=this.currentTarget},e.prototype.reset=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.currentTarget=null,this.target=null},e}(),InteractionTrackingData=function(){function e(t){this._pointerId=t,this._flags=e.FLAGS.NONE}return e.prototype._doSet=function(e,t){this._flags=t?this._flags|e:this._flags&~e},Object.defineProperty(e.prototype,"pointerId",{get:function(){return this._pointerId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"flags",{get:function(){return this._flags},set:function(e){this._flags=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"none",{get:function(){return this._flags===e.FLAGS.NONE},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"over",{get:function(){return 0!=(this._flags&e.FLAGS.OVER)},set:function(t){this._doSet(e.FLAGS.OVER,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rightDown",{get:function(){return 0!=(this._flags&e.FLAGS.RIGHT_DOWN)},set:function(t){this._doSet(e.FLAGS.RIGHT_DOWN,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"leftDown",{get:function(){return 0!=(this._flags&e.FLAGS.LEFT_DOWN)},set:function(t){this._doSet(e.FLAGS.LEFT_DOWN,t)},enumerable:!1,configurable:!0}),e.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4}),e}(),TreeSearch=function(){function e(){this._tempPoint=new Point}return e.prototype.recursiveFindHit=function(e,t,r,n,i){if(!t||!t.visible)return!1;var s=e.data.global,o=!1,a=i=t.interactive||i,l=!0;if(t.hitArea?(n&&(t.worldTransform.applyInverse(s,this._tempPoint),t.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?o=!0:(n=!1,l=!1)),a=!1):t._mask&&n&&(t._mask.containsPoint&&t._mask.containsPoint(s)||(n=!1)),l&&t.interactiveChildren&&t.children)for(var h=t.children,u=h.length-1;u>=0;u--){var c=h[u],d=this.recursiveFindHit(e,c,r,n,a);if(d){if(!c.parent)continue;a=!1,d&&(e.target&&(n=!1),o=!0)}}return i&&(n&&!e.target&&!t.hitArea&&t.containsPoint&&t.containsPoint(s)&&(o=!0),t.interactive&&(o&&!e.target&&(e.target=t),r&&r(e,t,!!o))),o},e.prototype.findHit=function(e,t,r,n){this.recursiveFindHit(e,t,r,n,!1)},e}(),interactiveTarget={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return"pointer"===this.cursor},set buttonMode(e){e?this.cursor="pointer":"pointer"===this.cursor&&(this.cursor=null)},cursor:null,get trackedPointers(){return void 0===this._trackedPointers&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0};DisplayObject.mixin(interactiveTarget);var MOUSE_POINTER_ID=1,hitTestEvent={target:null,data:{global:null}},InteractionManager=function(e){function t(t,r){var n=e.call(this)||this;return r=r||{},n.renderer=t,n.autoPreventDefault=void 0===r.autoPreventDefault||r.autoPreventDefault,n.interactionFrequency=r.interactionFrequency||10,n.mouse=new InteractionData,n.mouse.identifier=MOUSE_POINTER_ID,n.mouse.global.set(-999999),n.activeInteractionData={},n.activeInteractionData[MOUSE_POINTER_ID]=n.mouse,n.interactionDataPool=[],n.eventData=new InteractionEvent,n.interactionDOMElement=null,n.moveWhenInside=!1,n.eventsAdded=!1,n.tickerAdded=!1,n.mouseOverRenderer=!("PointerEvent"in self),n.supportsTouchEvents="ontouchstart"in self,n.supportsPointerEvents=!!self.PointerEvent,n.onPointerUp=n.onPointerUp.bind(n),n.processPointerUp=n.processPointerUp.bind(n),n.onPointerCancel=n.onPointerCancel.bind(n),n.processPointerCancel=n.processPointerCancel.bind(n),n.onPointerDown=n.onPointerDown.bind(n),n.processPointerDown=n.processPointerDown.bind(n),n.onPointerMove=n.onPointerMove.bind(n),n.processPointerMove=n.processPointerMove.bind(n),n.onPointerOut=n.onPointerOut.bind(n),n.processPointerOverOut=n.processPointerOverOut.bind(n),n.onPointerOver=n.onPointerOver.bind(n),n.cursorStyles={default:"inherit",pointer:"pointer"},n.currentCursorMode=null,n.cursor=null,n.resolution=1,n.delayedEvents=[],n.search=new TreeSearch,n._tempDisplayObject=new TemporaryDisplayObject,n._useSystemTicker=void 0===r.useSystemTicker||r.useSystemTicker,n.setTargetElement(n.renderer.view,n.renderer.resolution),n}return __extends2(t,e),Object.defineProperty(t.prototype,"useSystemTicker",{get:function(){return this._useSystemTicker},set:function(e){this._useSystemTicker=e,e?this.addTickerListener():this.removeTickerListener()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastObjectRendered",{get:function(){return this.renderer._lastObjectRendered||this._tempDisplayObject},enumerable:!1,configurable:!0}),t.prototype.hitTest=function(e,t){return hitTestEvent.target=null,hitTestEvent.data.global=e,t||(t=this.lastObjectRendered),this.processInteractive(hitTestEvent,t,null,!0),hitTestEvent.target},t.prototype.setTargetElement=function(e,t){void 0===t&&(t=1),this.removeTickerListener(),this.removeEvents(),this.interactionDOMElement=e,this.resolution=t,this.addEvents(),this.addTickerListener()},t.prototype.addTickerListener=function(){this.tickerAdded||!this.interactionDOMElement||!this._useSystemTicker||(Ticker.system.add(this.tickerUpdate,this,UPDATE_PRIORITY.INTERACTION),this.tickerAdded=!0)},t.prototype.removeTickerListener=function(){!this.tickerAdded||(Ticker.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)},t.prototype.addEvents=function(){if(!this.eventsAdded&&this.interactionDOMElement){var e=this.interactionDOMElement.style;self.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none"),this.supportsPointerEvents?(self.document.addEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,!0),self.addEventListener("pointercancel",this.onPointerCancel,!0),self.addEventListener("pointerup",this.onPointerUp,!0)):(self.document.addEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,!0),self.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,!0)),this.eventsAdded=!0}},t.prototype.removeEvents=function(){if(this.eventsAdded&&this.interactionDOMElement){var e=this.interactionDOMElement.style;self.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(self.document.removeEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,!0),self.removeEventListener("pointercancel",this.onPointerCancel,!0),self.removeEventListener("pointerup",this.onPointerUp,!0)):(self.document.removeEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,!0),self.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.interactionDOMElement=null,this.eventsAdded=!1}},t.prototype.tickerUpdate=function(e){this._deltaTime+=e,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())},t.prototype.update=function(){if(this.interactionDOMElement){if(this._didMove)return void(this._didMove=!1);for(var e in this.cursor=null,this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(e)){var t=this.activeInteractionData[e];if(t.originalEvent&&"touch"!==t.pointerType){var r=this.configureInteractionEventForDOMEvent(this.eventData,t.originalEvent,t);this.processInteractive(r,this.lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},t.prototype.setCursorMode=function(e){e=e||"default";var t=!0;if(self.OffscreenCanvas&&this.interactionDOMElement instanceof OffscreenCanvas&&(t=!1),this.currentCursorMode!==e){this.currentCursorMode=e;var r=this.cursorStyles[e];if(r)switch(typeof r){case"string":t&&(this.interactionDOMElement.style.cursor=r);break;case"function":r(e);break;case"object":t&&Object.assign(this.interactionDOMElement.style,r)}else t&&"string"==typeof e&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.interactionDOMElement.style.cursor=e)}},t.prototype.dispatchEvent=function(e,t,r){(!r.stopPropagationHint||e===r.stopsPropagatingAt)&&(r.currentTarget=e,r.type=t,e.emit(t,r),e[t]&&e[t](r))},t.prototype.delayDispatchEvent=function(e,t,r){this.delayedEvents.push({displayObject:e,eventString:t,eventData:r})},t.prototype.mapPositionToPoint=function(e,t,r){var n;n=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:this.interactionDOMElement.width,height:this.interactionDOMElement.height,left:0,top:0};var i=1/this.resolution;e.x=(t-n.left)*(this.interactionDOMElement.width/n.width)*i,e.y=(r-n.top)*(this.interactionDOMElement.height/n.height)*i},t.prototype.processInteractive=function(e,t,r,n){var i=this.search.findHit(e,t,r,n),s=this.delayedEvents;if(!s.length)return i;e.stopPropagationHint=!1;var o=s.length;this.delayedEvents=[];for(var a=0;a<o;a++){var l=s[a],h=l.displayObject,u=l.eventString,c=l.eventData;c.stopsPropagatingAt===h&&(c.stopPropagationHint=!0),this.dispatchEvent(h,u,c)}return i},t.prototype.onPointerDown=function(e){if(!this.supportsTouchEvents||"touch"!==e.pointerType){var t=this.normalizeToPointerData(e);this.autoPreventDefault&&t[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(var r=t.length,n=0;n<r;n++){var i=t[n],s=this.getInteractionDataForPointerId(i),o=this.configureInteractionEventForDOMEvent(this.eventData,i,s);if(o.data.originalEvent=e,this.processInteractive(o,this.lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",o),"touch"===i.pointerType)this.emit("touchstart",o);else if("mouse"===i.pointerType||"pen"===i.pointerType){var a=2===i.button;this.emit(a?"rightdown":"mousedown",this.eventData)}}}},t.prototype.processPointerDown=function(e,t,r){var n=e.data,i=e.data.identifier;if(r)if(t.trackedPointers[i]||(t.trackedPointers[i]=new InteractionTrackingData(i)),this.dispatchEvent(t,"pointerdown",e),"touch"===n.pointerType)this.dispatchEvent(t,"touchstart",e);else if("mouse"===n.pointerType||"pen"===n.pointerType){var s=2===n.button;s?t.trackedPointers[i].rightDown=!0:t.trackedPointers[i].leftDown=!0,this.dispatchEvent(t,s?"rightdown":"mousedown",e)}},t.prototype.onPointerComplete=function(e,t,r){for(var n=this.normalizeToPointerData(e),i=n.length,s=e.target!==this.interactionDOMElement?"outside":"",o=0;o<i;o++){var a=n[o],l=this.getInteractionDataForPointerId(a),h=this.configureInteractionEventForDOMEvent(this.eventData,a,l);if(h.data.originalEvent=e,this.processInteractive(h,this.lastObjectRendered,r,t||!s),this.emit(t?"pointercancel":"pointerup"+s,h),"mouse"===a.pointerType||"pen"===a.pointerType){var u=2===a.button;this.emit(u?"rightup"+s:"mouseup"+s,h)}else"touch"===a.pointerType&&(this.emit(t?"touchcancel":"touchend"+s,h),this.releaseInteractionDataForPointerId(a.pointerId))}},t.prototype.onPointerCancel=function(e){this.supportsTouchEvents&&"touch"===e.pointerType||this.onPointerComplete(e,!0,this.processPointerCancel)},t.prototype.processPointerCancel=function(e,t){var r=e.data,n=e.data.identifier;void 0!==t.trackedPointers[n]&&(delete t.trackedPointers[n],this.dispatchEvent(t,"pointercancel",e),"touch"===r.pointerType&&this.dispatchEvent(t,"touchcancel",e))},t.prototype.onPointerUp=function(e){this.supportsTouchEvents&&"touch"===e.pointerType||this.onPointerComplete(e,!1,this.processPointerUp)},t.prototype.processPointerUp=function(e,t,r){var n=e.data,i=e.data.identifier,s=t.trackedPointers[i],o="touch"===n.pointerType,a="mouse"===n.pointerType||"pen"===n.pointerType,l=!1;if(a){var h=2===n.button,u=InteractionTrackingData.FLAGS,c=h?u.RIGHT_DOWN:u.LEFT_DOWN,d=void 0!==s&&s.flags&c;r?(this.dispatchEvent(t,h?"rightup":"mouseup",e),d&&(this.dispatchEvent(t,h?"rightclick":"click",e),l=!0)):d&&this.dispatchEvent(t,h?"rightupoutside":"mouseupoutside",e),s&&(h?s.rightDown=!1:s.leftDown=!1)}r?(this.dispatchEvent(t,"pointerup",e),o&&this.dispatchEvent(t,"touchend",e),s&&((!a||l)&&this.dispatchEvent(t,"pointertap",e),o&&(this.dispatchEvent(t,"tap",e),s.over=!1))):s&&(this.dispatchEvent(t,"pointerupoutside",e),o&&this.dispatchEvent(t,"touchendoutside",e)),s&&s.none&&delete t.trackedPointers[i]},t.prototype.onPointerMove=function(e){if(!this.supportsTouchEvents||"touch"!==e.pointerType){var t=this.normalizeToPointerData(e);("mouse"===t[0].pointerType||"pen"===t[0].pointerType)&&(this._didMove=!0,this.cursor=null);for(var r=t.length,n=0;n<r;n++){var i=t[n],s=this.getInteractionDataForPointerId(i),o=this.configureInteractionEventForDOMEvent(this.eventData,i,s);o.data.originalEvent=e,this.processInteractive(o,this.lastObjectRendered,this.processPointerMove,!0),this.emit("pointermove",o),"touch"===i.pointerType&&this.emit("touchmove",o),("mouse"===i.pointerType||"pen"===i.pointerType)&&this.emit("mousemove",o)}"mouse"===t[0].pointerType&&this.setCursorMode(this.cursor)}},t.prototype.processPointerMove=function(e,t,r){var n=e.data,i="touch"===n.pointerType,s="mouse"===n.pointerType||"pen"===n.pointerType;s&&this.processPointerOverOut(e,t,r),(!this.moveWhenInside||r)&&(this.dispatchEvent(t,"pointermove",e),i&&this.dispatchEvent(t,"touchmove",e),s&&this.dispatchEvent(t,"mousemove",e))},t.prototype.onPointerOut=function(e){if(!this.supportsTouchEvents||"touch"!==e.pointerType){var t=this.normalizeToPointerData(e)[0];"mouse"===t.pointerType&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var r=this.getInteractionDataForPointerId(t),n=this.configureInteractionEventForDOMEvent(this.eventData,t,r);n.data.originalEvent=t,this.processInteractive(n,this.lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",n),"mouse"===t.pointerType||"pen"===t.pointerType?this.emit("mouseout",n):this.releaseInteractionDataForPointerId(r.identifier)}},t.prototype.processPointerOverOut=function(e,t,r){var n=e.data,i=e.data.identifier,s="mouse"===n.pointerType||"pen"===n.pointerType,o=t.trackedPointers[i];r&&!o&&(o=t.trackedPointers[i]=new InteractionTrackingData(i)),void 0!==o&&(r&&this.mouseOverRenderer?(o.over||(o.over=!0,this.delayDispatchEvent(t,"pointerover",e),s&&this.delayDispatchEvent(t,"mouseover",e)),s&&null===this.cursor&&(this.cursor=t.cursor)):o.over&&(o.over=!1,this.dispatchEvent(t,"pointerout",this.eventData),s&&this.dispatchEvent(t,"mouseout",e),o.none&&delete t.trackedPointers[i]))},t.prototype.onPointerOver=function(e){var t=this.normalizeToPointerData(e)[0],r=this.getInteractionDataForPointerId(t),n=this.configureInteractionEventForDOMEvent(this.eventData,t,r);n.data.originalEvent=t,"mouse"===t.pointerType&&(this.mouseOverRenderer=!0),this.emit("pointerover",n),("mouse"===t.pointerType||"pen"===t.pointerType)&&this.emit("mouseover",n)},t.prototype.getInteractionDataForPointerId=function(e){var t,r=e.pointerId;return r===MOUSE_POINTER_ID||"mouse"===e.pointerType?t=this.mouse:this.activeInteractionData[r]?t=this.activeInteractionData[r]:((t=this.interactionDataPool.pop()||new InteractionData).identifier=r,this.activeInteractionData[r]=t),t.copyEvent(e),t},t.prototype.releaseInteractionDataForPointerId=function(e){var t=this.activeInteractionData[e];t&&(delete this.activeInteractionData[e],t.reset(),this.interactionDataPool.push(t))},t.prototype.configureInteractionEventForDOMEvent=function(e,t,r){return e.data=r,this.mapPositionToPoint(r.global,t.clientX,t.clientY),"touch"===t.pointerType&&(t.globalX=r.global.x,t.globalY=r.global.y),r.originalEvent=t,e.reset(),e},t.prototype.normalizeToPointerData=function(e){var t=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(var r=0,n=e.changedTouches.length;r<n;r++){var i=e.changedTouches[r];void 0===i.button&&(i.button=e.touches.length?1:0),void 0===i.buttons&&(i.buttons=e.touches.length?1:0),void 0===i.isPrimary&&(i.isPrimary=1===e.touches.length&&"touchstart"===e.type),void 0===i.width&&(i.width=i.radiusX||1),void 0===i.height&&(i.height=i.radiusY||1),void 0===i.tiltX&&(i.tiltX=0),void 0===i.tiltY&&(i.tiltY=0),void 0===i.pointerType&&(i.pointerType="touch"),void 0===i.pointerId&&(i.pointerId=i.identifier||0),void 0===i.pressure&&(i.pressure=i.force||.5),void 0===i.twist&&(i.twist=0),void 0===i.tangentialPressure&&(i.tangentialPressure=0),void 0===i.layerX&&(i.layerX=i.offsetX=i.clientX),void 0===i.layerY&&(i.layerY=i.offsetY=i.clientY),i.isNormalized=!0,t.push(i)}else if(!self.MouseEvent||e instanceof MouseEvent&&!(this.supportsPointerEvents&&e instanceof self.PointerEvent)){var s=e;void 0===s.isPrimary&&(s.isPrimary=!0),void 0===s.width&&(s.width=1),void 0===s.height&&(s.height=1),void 0===s.tiltX&&(s.tiltX=0),void 0===s.tiltY&&(s.tiltY=0),void 0===s.pointerType&&(s.pointerType="mouse"),void 0===s.pointerId&&(s.pointerId=MOUSE_POINTER_ID),void 0===s.pressure&&(s.pressure=.5),void 0===s.twist&&(s.twist=0),void 0===s.tangentialPressure&&(s.tangentialPressure=0),s.isNormalized=!0,t.push(s)}else t.push(e);return t},t.prototype.destroy=function(){this.removeEvents(),this.removeTickerListener(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this.search=null},t}(import_eventemitter3.default),Runner=function(){function e(e){this.items=[],this._name=e,this._aliasCount=0}return e.prototype.emit=function(e,t,r,n,i,s,o,a){if(arguments.length>8)throw new Error("max arguments reached");var l=this,h=l.name,u=l.items;this._aliasCount++;for(var c=0,d=u.length;c<d;c++)u[c][h](e,t,r,n,i,s,o,a);return u===this.items&&this._aliasCount--,this},e.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},e.prototype.add=function(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this},e.prototype.remove=function(e){var t=this.items.indexOf(e);return-1!==t&&(this.ensureNonAliasedItems(),this.items.splice(t,1)),this},e.prototype.contains=function(e){return-1!==this.items.indexOf(e)},e.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},e.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(e.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),e}();Object.defineProperties(Runner.prototype,{dispatch:{value:Runner.prototype.emit},run:{value:Runner.prototype.emit}}),settings.PREFER_ENV=isMobile2.any?ENV2.WEBGL:ENV2.WEBGL2,settings.STRICT_TEXTURE_CACHE=!1;var INSTALLED=[];function autoDetectResource(e,t){if(!e)return null;var r="";if("string"==typeof e){var n=/\.(\w{3,4})(?:$|\?|#)/i.exec(e);n&&(r=n[1].toLowerCase())}for(var i=INSTALLED.length-1;i>=0;--i){var s=INSTALLED[i];if(s.test&&s.test(e,r))return new s(e,t)}throw new Error("Unrecognized source type to auto-detect Resource")}var extendStatics3=function(e,t){return extendStatics3=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},extendStatics3(e,t)};function __extends3(e,t){function r(){this.constructor=e}extendStatics3(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var Resource=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this._width=e,this._height=t,this.destroyed=!1,this.internal=!1,this.onResize=new Runner("setRealSize"),this.onUpdate=new Runner("update"),this.onError=new Runner("onError")}return e.prototype.bind=function(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},e.prototype.unbind=function(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)},e.prototype.resize=function(e,t){(e!==this._width||t!==this._height)&&(this._width=e,this._height=t,this.onResize.emit(e,t))},Object.defineProperty(e.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),e.prototype.update=function(){this.destroyed||this.onUpdate.emit()},e.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),e.prototype.style=function(e,t,r){return!1},e.prototype.dispose=function(){},e.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},e.test=function(e,t){return!1},e}(),BufferResource=function(e){function t(t,r){var n=this,i=r||{},s=i.width,o=i.height;if(!s||!o)throw new Error("BufferResource width or height invalid");return(n=e.call(this,s,o)||this).data=t,n}return __extends3(t,e),t.prototype.upload=function(e,t,r){var n=e.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===ALPHA_MODES2.UNPACK);var i=t.realWidth,s=t.realHeight;return r.width===i&&r.height===s?n.texSubImage2D(t.target,0,0,0,i,s,t.format,t.type,this.data):(r.width=i,r.height=s,n.texImage2D(t.target,0,r.internalFormat,i,s,0,t.format,r.type,this.data)),!0},t.prototype.dispose=function(){this.data=null},t.test=function(e){return e instanceof Float32Array||e instanceof Uint8Array||e instanceof Uint32Array},t}(Resource),defaultBufferOptions={scaleMode:SCALE_MODES2.NEAREST,format:FORMATS2.RGBA,alphaMode:ALPHA_MODES2.NPM},BaseTexture=function(e){function t(t,r){void 0===t&&(t=null),void 0===r&&(r=null);var n=e.call(this)||this,i=(r=r||{}).alphaMode,s=r.mipmap,o=r.anisotropicLevel,a=r.scaleMode,l=r.width,h=r.height,u=r.wrapMode,c=r.format,d=r.type,f=r.target,p=r.resolution,m=r.resourceOptions;return t&&!(t instanceof Resource)&&((t=autoDetectResource(t,m)).internal=!0),n.width=l||0,n.height=h||0,n.resolution=p||settings.RESOLUTION,n.mipmap=void 0!==s?s:settings.MIPMAP_TEXTURES,n.anisotropicLevel=void 0!==o?o:settings.ANISOTROPIC_LEVEL,n.wrapMode=u||settings.WRAP_MODE,n.scaleMode=void 0!==a?a:settings.SCALE_MODE,n.format=c||FORMATS2.RGBA,n.type=d||TYPES2.UNSIGNED_BYTE,n.target=f||TARGETS2.TEXTURE_2D,n.alphaMode=void 0!==i?i:ALPHA_MODES2.UNPACK,n.uid=uid(),n.touched=0,n.isPowerOfTwo=!1,n._refreshPOT(),n._glTextures={},n.dirtyId=0,n.dirtyStyleId=0,n.cacheId=null,n.valid=l>0&&h>0,n.textureCacheIds=[],n.destroyed=!1,n.resource=null,n._batchEnabled=0,n._batchLocation=0,n.parentTextureArray=null,n.setResource(t),n}return __extends3(t,e),Object.defineProperty(t.prototype,"realWidth",{get:function(){return Math.ceil(this.width*this.resolution-1e-4)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"realHeight",{get:function(){return Math.ceil(this.height*this.resolution-1e-4)},enumerable:!1,configurable:!0}),t.prototype.setStyle=function(e,t){var r;return void 0!==e&&e!==this.scaleMode&&(this.scaleMode=e,r=!0),void 0!==t&&t!==this.mipmap&&(this.mipmap=t,r=!0),r&&this.dirtyStyleId++,this},t.prototype.setSize=function(e,t,r){return this.resolution=r||this.resolution,this.width=e,this.height=t,this._refreshPOT(),this.update(),this},t.prototype.setRealSize=function(e,t,r){return this.resolution=r||this.resolution,this.width=e/this.resolution,this.height=t/this.resolution,this._refreshPOT(),this.update(),this},t.prototype._refreshPOT=function(){this.isPowerOfTwo=isPow2(this.realWidth)&&isPow2(this.realHeight)},t.prototype.setResolution=function(e){var t=this.resolution;return t===e||(this.resolution=e,this.valid&&(this.width=this.width*t/e,this.height=this.height*t/e,this.emit("update",this)),this._refreshPOT()),this},t.prototype.setResource=function(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this},t.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},t.prototype.onError=function(e){this.emit("error",this,e)},t.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete BaseTextureCache[this.cacheId],delete TextureCache[this.cacheId],this.cacheId=null),this.dispose(),t.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},t.prototype.dispose=function(){this.emit("dispose",this)},t.prototype.castToBaseTexture=function(){return this},t.from=function(e,r,n){void 0===n&&(n=settings.STRICT_TEXTURE_CACHE);var i="string"==typeof e,s=null;if(i)s=e;else{if(!e._pixiId){var o=r&&r.pixiIdPrefix||"pixiid";e._pixiId=o+"_"+uid()}s=e._pixiId}var a=BaseTextureCache[s];if(i&&n&&!a)throw new Error('The cacheId "'+s+'" does not exist in BaseTextureCache.');return a||((a=new t(e,r)).cacheId=s,t.addToCache(a,s)),a},t.fromBuffer=function(e,r,n,i){e=e||new Float32Array(r*n*4);var s=new BufferResource(e,{width:r,height:n}),o=e instanceof Float32Array?TYPES2.FLOAT:TYPES2.UNSIGNED_BYTE;return new t(s,Object.assign(defaultBufferOptions,i||{width:r,height:n,type:o}))},t.addToCache=function(e,t){t&&(-1===e.textureCacheIds.indexOf(t)&&e.textureCacheIds.push(t),BaseTextureCache[t]&&console.warn("BaseTexture added to the cache with an id ["+t+"] that already had an entry"),BaseTextureCache[t]=e)},t.removeFromCache=function(e){if("string"==typeof e){var t=BaseTextureCache[e];if(t){var r=t.textureCacheIds.indexOf(e);return r>-1&&t.textureCacheIds.splice(r,1),delete BaseTextureCache[e],t}}else if(e&&e.textureCacheIds){for(var n=0;n<e.textureCacheIds.length;++n)delete BaseTextureCache[e.textureCacheIds[n]];return e.textureCacheIds.length=0,e}return null},t._globalBatch=0,t}(import_eventemitter3.default),AbstractMultiResource=function(e){function t(t,r){var n=this,i=r||{},s=i.width,o=i.height;(n=e.call(this,s,o)||this).items=[],n.itemDirtyIds=[];for(var a=0;a<t;a++){var l=new BaseTexture;n.items.push(l),n.itemDirtyIds.push(-2)}return n.length=t,n._load=null,n.baseTexture=null,n}return __extends3(t,e),t.prototype.initFromArray=function(e,t){for(var r=0;r<this.length;r++)!e[r]||(e[r].castToBaseTexture?this.addBaseTextureAt(e[r].castToBaseTexture(),r):e[r]instanceof Resource?this.addResourceAt(e[r],r):this.addResourceAt(autoDetectResource(e[r],t),r))},t.prototype.dispose=function(){for(var e=0,t=this.length;e<t;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},t.prototype.addResourceAt=function(e,t){if(!this.items[t])throw new Error("Index "+t+" is out of bounds");return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[t].setResource(e),this},t.prototype.bind=function(t){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");e.prototype.bind.call(this,t);for(var r=0;r<this.length;r++)this.items[r].parentTextureArray=t,this.items[r].on("update",t.update,t)},t.prototype.unbind=function(t){e.prototype.unbind.call(this,t);for(var r=0;r<this.length;r++)this.items[r].parentTextureArray=null,this.items[r].off("update",t.update,t)},t.prototype.load=function(){var e=this;if(this._load)return this._load;var t=this.items.map((function(e){return e.resource})).filter((function(e){return e})).map((function(e){return e.load()}));return this._load=Promise.all(t).then((function(){var t=e.items[0],r=t.realWidth,n=t.realHeight;return e.resize(r,n),Promise.resolve(e)})),this._load},t}(Resource),ArrayResource=function(e){function t(t,r){var n,i,s=this,o=r||{},a=o.width,l=o.height;return Array.isArray(t)?(n=t,i=t.length):i=t,s=e.call(this,i,{width:a,height:l})||this,n&&s.initFromArray(n,r),s}return __extends3(t,e),t.prototype.addBaseTextureAt=function(e,t){if(!e.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(e.resource,t),this},t.prototype.bind=function(t){e.prototype.bind.call(this,t),t.target=TARGETS2.TEXTURE_2D_ARRAY},t.prototype.upload=function(e,t,r){var n=this,i=n.length,s=n.itemDirtyIds,o=n.items,a=e.gl;r.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,t.format,this._width,this._height,i,0,t.format,t.type,null);for(var l=0;l<i;l++){var h=o[l];s[l]<h.dirtyId&&(s[l]=h.dirtyId,h.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,l,h.resource.width,h.resource.height,1,t.format,t.type,h.resource.source))}return!0},t}(AbstractMultiResource),BaseImageResource=function(e){function t(t){var r=this,n=t,i=n.naturalWidth||n.videoWidth||n.width,s=n.naturalHeight||n.videoHeight||n.height;return(r=e.call(this,i,s)||this).source=t,r.noSubImage=!1,r}return __extends3(t,e),t.crossOrigin=function(e,t,r){void 0===r&&0!==t.indexOf("data:")?e.crossOrigin=determineCrossOrigin(t):!1!==r&&(e.crossOrigin="string"==typeof r?r:"anonymous")},t.prototype.upload=function(e,t,r,n){var i=e.gl,s=t.realWidth,o=t.realHeight;return n=n||this.source,i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===ALPHA_MODES2.UNPACK),this.noSubImage||t.target!==i.TEXTURE_2D||r.width!==s||r.height!==o?(r.width=s,r.height=o,i.texImage2D(t.target,0,t.format,t.format,t.type,n)):i.texSubImage2D(i.TEXTURE_2D,0,0,0,t.format,t.type,n),!0},t.prototype.update=function(){if(!this.destroyed){var t=this.source,r=t.naturalWidth||t.videoWidth||t.width,n=t.naturalHeight||t.videoHeight||t.height;this.resize(r,n),e.prototype.update.call(this)}},t.prototype.dispose=function(){this.source=null},t}(Resource),CanvasResource=function(e){function t(t){return e.call(this,t)||this}return __extends3(t,e),t.test=function(e){var t=self.OffscreenCanvas;return!!(t&&e instanceof t)||self.HTMLCanvasElement&&e instanceof HTMLCanvasElement},t}(BaseImageResource),CubeResource=function(e){function t(r,n){var i=this,s=n||{},o=s.width,a=s.height,l=s.autoLoad,h=s.linkBaseTexture;if(r&&r.length!==t.SIDES)throw new Error("Invalid length. Got "+r.length+", expected 6");i=e.call(this,6,{width:o,height:a})||this;for(var u=0;u<t.SIDES;u++)i.items[u].target=TARGETS2.TEXTURE_CUBE_MAP_POSITIVE_X+u;return i.linkBaseTexture=!1!==h,r&&i.initFromArray(r,n),!1!==l&&i.load(),i}return __extends3(t,e),t.prototype.bind=function(t){e.prototype.bind.call(this,t),t.target=TARGETS2.TEXTURE_CUBE_MAP},t.prototype.addBaseTextureAt=function(e,t,r){if(void 0===r&&(r=this.linkBaseTexture),!this.items[t])throw new Error("Index "+t+" is out of bounds");if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0){if(!e.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(e.resource,t)}else e.target=TARGETS2.TEXTURE_CUBE_MAP_POSITIVE_X+t,e.parentTextureArray=this.baseTexture,this.items[t]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[t]=e,this},t.prototype.upload=function(e,r,n){for(var i=this.itemDirtyIds,s=0;s<t.SIDES;s++){var o=this.items[s];i[s]<o.dirtyId&&(o.valid&&o.resource?(o.resource.upload(e,o,n),i[s]=o.dirtyId):i[s]<-1&&(e.gl.texImage2D(o.target,0,n.internalFormat,r.realWidth,r.realHeight,0,r.format,n.type,null),i[s]=-1))}return!0},t.test=function(e){return Array.isArray(e)&&e.length===t.SIDES},t.SIDES=6,t}(AbstractMultiResource),ImageResource=function(e){function t(t,r){var n=this;if(r=r||{},!(t instanceof HTMLImageElement)){var i=new Image;BaseImageResource.crossOrigin(i,t,r.crossorigin),i.src=t,t=i}return n=e.call(this,t)||this,!t.complete&&!!n._width&&!!n._height&&(n._width=0,n._height=0),n.url=t.src,n._process=null,n.preserveBitmap=!1,n.createBitmap=(void 0!==r.createBitmap?r.createBitmap:settings.CREATE_IMAGE_BITMAP)&&!!self.createImageBitmap,n.alphaMode="number"==typeof r.alphaMode?r.alphaMode:null,n.bitmap=null,n._load=null,!1!==r.autoLoad&&n.load(),n}return __extends3(t,e),t.prototype.load=function(e){var t=this;return this._load||(void 0!==e&&(this.createBitmap=e),this._load=new Promise((function(e,r){var n=t.source;t.url=n.src;var i=function(){t.destroyed||(n.onload=null,n.onerror=null,t.resize(n.width,n.height),t._load=null,t.createBitmap?e(t.process()):e(t))};n.complete&&n.src?i():(n.onload=i,n.onerror=function(e){r(e),t.onError.emit(e)})}))),this._load},t.prototype.process=function(){var e=this,t=this.source;return null!==this._process?this._process:null===this.bitmap&&self.createImageBitmap?(this._process=self.createImageBitmap(t,0,0,t.width,t.height,{premultiplyAlpha:this.alphaMode===ALPHA_MODES2.UNPACK?"premultiply":"none"}).then((function(t){return e.destroyed?Promise.reject():(e.bitmap=t,e.update(),e._process=null,Promise.resolve(e))})),this._process):Promise.resolve(this)},t.prototype.upload=function(t,r,n){if("number"==typeof this.alphaMode&&(r.alphaMode=this.alphaMode),!this.createBitmap)return e.prototype.upload.call(this,t,r,n);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(e.prototype.upload.call(this,t,r,n,this.bitmap),!this.preserveBitmap){var i=!0,s=r._glTextures;for(var o in s){var a=s[o];if(a!==n&&a.dirtyId!==r.dirtyId){i=!1;break}}i&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},t.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,e.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},t.test=function(e){return"string"==typeof e||e instanceof HTMLImageElement},t}(BaseImageResource),SVGResource=function(e){function t(t,r){var n=this;return r=r||{},(n=e.call(this,document.createElement("canvas"))||this)._width=0,n._height=0,n.svg=t,n.scale=r.scale||1,n._overrideWidth=r.width,n._overrideHeight=r.height,n._resolve=null,n._crossorigin=r.crossorigin,n._load=null,!1!==r.autoLoad&&n.load(),n}return __extends3(t,e),t.prototype.load=function(){var e=this;return this._load||(this._load=new Promise((function(t){if(e._resolve=function(){e.resize(e.source.width,e.source.height),t(e)},/^\<svg/.test(e.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");e.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.svg)))}e._loadSvg()}))),this._load},t.prototype._loadSvg=function(){var e=this,t=new Image;BaseImageResource.crossOrigin(t,this.svg,this._crossorigin),t.src=this.svg,t.onerror=function(r){!e._resolve||(t.onerror=null,e.onError.emit(r))},t.onload=function(){if(e._resolve){var r=t.width,n=t.height;if(!r||!n)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var i=r*e.scale,s=n*e.scale;(e._overrideWidth||e._overrideHeight)&&(i=e._overrideWidth||e._overrideHeight/n*r,s=e._overrideHeight||e._overrideWidth/r*n),i=Math.round(i),s=Math.round(s);var o=e.source;o.width=i,o.height=s,o._pixiId="canvas_"+uid(),o.getContext("2d").drawImage(t,0,0,r,n,0,0,i,s),e._resolve(),e._resolve=null}}},t.getSize=function(e){var r=t.SVG_SIZE.exec(e),n={};return r&&(n[r[1]]=Math.round(parseFloat(r[3])),n[r[5]]=Math.round(parseFloat(r[7]))),n},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},t.test=function(e,t){return"svg"===t||"string"==typeof e&&/^data:image\/svg\+xml(;(charset=utf8|utf8))?;base64/.test(e)||"string"==typeof e&&0===e.indexOf("<svg")},t.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,t}(BaseImageResource),VideoResource=function(e){function t(r,n){var i=this;if(n=n||{},!(r instanceof HTMLVideoElement)){var s=document.createElement("video");s.setAttribute("preload","auto"),s.setAttribute("webkit-playsinline",""),s.setAttribute("playsinline",""),"string"==typeof r&&(r=[r]);var o=r[0].src||r[0];BaseImageResource.crossOrigin(s,o,n.crossorigin);for(var a=0;a<r.length;++a){var l=document.createElement("source"),h=r[a],u=h.src,c=h.mime,d=(u=u||r[a]).split("?").shift().toLowerCase(),f=d.substr(d.lastIndexOf(".")+1);c=c||t.MIME_TYPES[f]||"video/"+f,l.src=u,l.type=c,s.appendChild(l)}r=s}return(i=e.call(this,r)||this).noSubImage=!0,i._autoUpdate=!0,i._isConnectedToTicker=!1,i._updateFPS=n.updateFPS||0,i._msToNextUpdate=0,i.autoPlay=!1!==n.autoPlay,i._load=null,i._resolve=null,i._onCanPlay=i._onCanPlay.bind(i),i._onError=i._onError.bind(i),!1!==n.autoLoad&&i.load(),i}return __extends3(t,e),t.prototype.update=function(t){if(!this.destroyed){var r=Ticker.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-r),(!this._updateFPS||this._msToNextUpdate<=0)&&(e.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},t.prototype.load=function(){var e=this;if(this._load)return this._load;var t=this.source;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart.bind(this)),t.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlay),t.addEventListener("error",this._onError,!0)),this._load=new Promise((function(r){e.valid?r(e):(e._resolve=r,t.load())})),this._load},t.prototype._onError=function(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e)},t.prototype._isSourcePlaying=function(){var e=this.source;return e.currentTime>0&&!1===e.paused&&!1===e.ended&&e.readyState>2},t.prototype._isSourceReady=function(){var e=this.source;return 3===e.readyState||4===e.readyState},t.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Ticker.shared.add(this.update,this),this._isConnectedToTicker=!0)},t.prototype._onPlayStop=function(){this._isConnectedToTicker&&(Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1)},t.prototype._onCanPlay=function(){var e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);var t=this.valid;this.resize(e.videoWidth,e.videoHeight),!t&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()},t.prototype.dispose=function(){this._isConnectedToTicker&&Ticker.shared.remove(this.update,this);var t=this.source;t&&(t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),e.prototype.dispose.call(this)},Object.defineProperty(t.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Ticker.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(e){e!==this._updateFPS&&(this._updateFPS=e)},enumerable:!1,configurable:!0}),t.test=function(e,r){return self.HTMLVideoElement&&e instanceof HTMLVideoElement||t.TYPES.indexOf(r)>-1},t.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],t.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},t}(BaseImageResource),ImageBitmapResource=function(e){function t(t){return e.call(this,t)||this}return __extends3(t,e),t.test=function(e){return!!self.createImageBitmap&&e instanceof ImageBitmap},t}(BaseImageResource);INSTALLED.push(ImageResource,ImageBitmapResource,CanvasResource,VideoResource,SVGResource,BufferResource,CubeResource,ArrayResource);var _resources={__proto__:null,Resource,BaseImageResource,INSTALLED,autoDetectResource,AbstractMultiResource,ArrayResource,BufferResource,CanvasResource,CubeResource,ImageResource,SVGResource,VideoResource,ImageBitmapResource},System=function(){function e(e){this.renderer=e}return e.prototype.destroy=function(){this.renderer=null},e}(),DepthResource=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends3(t,e),t.prototype.upload=function(e,t,r){var n=e.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===ALPHA_MODES2.UNPACK);var i=t.realWidth,s=t.realHeight;return r.width===i&&r.height===s?n.texSubImage2D(t.target,0,0,0,i,s,t.format,t.type,this.data):(r.width=i,r.height=s,n.texImage2D(t.target,0,1===e.context.webGLVersion?n.DEPTH_COMPONENT:n.DEPTH_COMPONENT16,i,s,0,t.format,t.type,this.data)),!0},t}(BufferResource),Framebuffer=function(){function e(e,t){this.width=Math.ceil(e||100),this.height=Math.ceil(t||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Runner("disposeFramebuffer"),this.multisample=MSAA_QUALITY2.NONE}return Object.defineProperty(e.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),e.prototype.addColorTexture=function(e,t){return void 0===e&&(e=0),this.colorTextures[e]=t||new BaseTexture(null,{scaleMode:SCALE_MODES2.NEAREST,resolution:1,mipmap:MIPMAP_MODES2.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},e.prototype.addDepthTexture=function(e){return this.depthTexture=e||new BaseTexture(new DepthResource(null,{width:this.width,height:this.height}),{scaleMode:SCALE_MODES2.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:MIPMAP_MODES2.OFF,format:FORMATS2.DEPTH_COMPONENT,type:TYPES2.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},e.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},e.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},e.prototype.resize=function(e,t){if(e=Math.ceil(e),t=Math.ceil(t),e!==this.width||t!==this.height){this.width=e,this.height=t,this.dirtyId++,this.dirtySize++;for(var r=0;r<this.colorTextures.length;r++){var n=this.colorTextures[r],i=n.resolution;n.setSize(e/i,t/i)}this.depthTexture&&(i=this.depthTexture.resolution,this.depthTexture.setSize(e/i,t/i))}},e.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},e.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},e}(),BaseRenderTexture=function(e){function t(t){var r=this;if("number"==typeof t){var n=arguments[0],i=arguments[1],s=arguments[2],o=arguments[3];t={width:n,height:i,scaleMode:s,resolution:o}}r=e.call(this,null,t)||this;var a=t||{},l=a.width,h=a.height;return r.mipmap=MIPMAP_MODES2.OFF,r.width=Math.ceil(l)||100,r.height=Math.ceil(h)||100,r.valid=!0,r.clearColor=[0,0,0,0],r.framebuffer=new Framebuffer(r.width*r.resolution,r.height*r.resolution).addColorTexture(0,r),r.maskStack=[],r.filterStack=[{}],r}return __extends3(t,e),t.prototype.resize=function(e,t){e=Math.ceil(e),t=Math.ceil(t),this.framebuffer.resize(e*this.resolution,t*this.resolution)},t.prototype.dispose=function(){this.framebuffer.dispose(),e.prototype.dispose.call(this)},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},t}(BaseTexture),TextureUvs=function(){function e(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return e.prototype.set=function(e,t,r){var n=t.width,i=t.height;if(r){var s=e.width/2/n,o=e.height/2/i,a=e.x/n+s,l=e.y/i+o;r=groupD8.add(r,groupD8.NW),this.x0=a+s*groupD8.uX(r),this.y0=l+o*groupD8.uY(r),r=groupD8.add(r,2),this.x1=a+s*groupD8.uX(r),this.y1=l+o*groupD8.uY(r),r=groupD8.add(r,2),this.x2=a+s*groupD8.uX(r),this.y2=l+o*groupD8.uY(r),r=groupD8.add(r,2),this.x3=a+s*groupD8.uX(r),this.y3=l+o*groupD8.uY(r)}else this.x0=e.x/n,this.y0=e.y/i,this.x1=(e.x+e.width)/n,this.y1=e.y/i,this.x2=(e.x+e.width)/n,this.y2=(e.y+e.height)/i,this.x3=e.x/n,this.y3=(e.y+e.height)/i;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},e.prototype.toString=function(){return"[@pixi/core:TextureUvs x0="+this.x0+" y0="+this.y0+" x1="+this.x1+" y1="+this.y1+" x2="+this.x2+" y2="+this.y2+" x3="+this.x3+" y3="+this.y3+"]"},e}(),DEFAULT_UVS=new TextureUvs,Texture=function(e){function t(r,n,i,s,o,a){var l=e.call(this)||this;if(l.noFrame=!1,n||(l.noFrame=!0,n=new Rectangle(0,0,1,1)),r instanceof t&&(r=r.baseTexture),l.baseTexture=r,l._frame=n,l.trim=s,l.valid=!1,l._uvs=DEFAULT_UVS,l.uvMatrix=null,l.orig=i||n,l._rotate=Number(o||0),!0===o)l._rotate=2;else if(l._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return l.defaultAnchor=a?new Point(a.x,a.y):new Point(0,0),l._updateID=0,l.textureCacheIds=[],r.valid?l.noFrame?r.valid&&l.onBaseTextureUpdated(r):l.frame=n:r.once("loaded",l.onBaseTextureUpdated,l),l.noFrame&&r.on("update",l.onBaseTextureUpdated,l),l}return __extends3(t,e),t.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},t.prototype.onBaseTextureUpdated=function(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},t.prototype.destroy=function(e){if(this.baseTexture){if(e){var r=this.baseTexture.resource;r&&r.url&&TextureCache[r.url]&&t.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,t.removeFromCache(this),this.textureCacheIds=null},t.prototype.clone=function(){var e=this._frame.clone(),r=this._frame===this.orig?e:this.orig.clone(),n=new t(this.baseTexture,!this.noFrame&&e,r,this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(n._frame=e),n},t.prototype.updateUvs=function(){this._uvs===DEFAULT_UVS&&(this._uvs=new TextureUvs),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},t.from=function(e,r,n){void 0===r&&(r={}),void 0===n&&(n=settings.STRICT_TEXTURE_CACHE);var i="string"==typeof e,s=null;if(i)s=e;else{if(!e._pixiId){var o=r&&r.pixiIdPrefix||"pixiid";e._pixiId=o+"_"+uid()}s=e._pixiId}var a=TextureCache[s];if(i&&n&&!a)throw new Error('The cacheId "'+s+'" does not exist in TextureCache.');return a||(r.resolution||(r.resolution=getResolutionOfUrl(e)),(a=new t(new BaseTexture(e,r))).baseTexture.cacheId=s,BaseTexture.addToCache(a.baseTexture,s),t.addToCache(a,s)),a},t.fromURL=function(e,r){var n=Object.assign({autoLoad:!1},null==r?void 0:r.resourceOptions),i=t.from(e,Object.assign({resourceOptions:n},r),!1),s=i.baseTexture.resource;return i.baseTexture.valid?Promise.resolve(i):s.load().then((function(){return Promise.resolve(i)}))},t.fromBuffer=function(e,r,n,i){return new t(BaseTexture.fromBuffer(e,r,n,i))},t.fromLoader=function(e,r,n,i){var s=new BaseTexture(e,Object.assign({scaleMode:settings.SCALE_MODE,resolution:getResolutionOfUrl(r)},i)),o=s.resource;o instanceof ImageResource&&(o.url=r);var a=new t(s);return n||(n=r),BaseTexture.addToCache(a.baseTexture,n),t.addToCache(a,n),n!==r&&(BaseTexture.addToCache(a.baseTexture,r),t.addToCache(a,r)),a.baseTexture.valid?Promise.resolve(a):new Promise((function(e){a.baseTexture.once("loaded",(function(){return e(a)}))}))},t.addToCache=function(e,t){t&&(-1===e.textureCacheIds.indexOf(t)&&e.textureCacheIds.push(t),TextureCache[t]&&console.warn("Texture added to the cache with an id ["+t+"] that already had an entry"),TextureCache[t]=e)},t.removeFromCache=function(e){if("string"==typeof e){var t=TextureCache[e];if(t){var r=t.textureCacheIds.indexOf(e);return r>-1&&t.textureCacheIds.splice(r,1),delete TextureCache[e],t}}else if(e&&e.textureCacheIds){for(var n=0;n<e.textureCacheIds.length;++n)TextureCache[e.textureCacheIds[n]]===e&&delete TextureCache[e.textureCacheIds[n]];return e.textureCacheIds.length=0,e}return null},Object.defineProperty(t.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"frame",{get:function(){return this._frame},set:function(e){this._frame=e,this.noFrame=!1;var t=e.x,r=e.y,n=e.width,i=e.height,s=t+n>this.baseTexture.width,o=r+i>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",l="X: "+t+" + "+n+" = "+(t+n)+" > "+this.baseTexture.width,h="Y: "+r+" + "+i+" = "+(r+i)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+l+" "+a+" "+h)}this.valid=n&&i&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=e),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rotate",{get:function(){return this._rotate},set:function(e){this._rotate=e,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),t.prototype.castToBaseTexture=function(){return this.baseTexture},t}(import_eventemitter3.default);function createWhiteTexture(){var e=document.createElement("canvas");e.width=16,e.height=16;var t=e.getContext("2d");return t.fillStyle="white",t.fillRect(0,0,16,16),new Texture(new BaseTexture(new CanvasResource(e)))}function removeAllHandlers(e){e.destroy=function(){},e.on=function(){},e.once=function(){},e.emit=function(){}}Texture.EMPTY=new Texture(new BaseTexture),removeAllHandlers(Texture.EMPTY),removeAllHandlers(Texture.EMPTY.baseTexture),Texture.WHITE=createWhiteTexture(),removeAllHandlers(Texture.WHITE),removeAllHandlers(Texture.WHITE.baseTexture);var RenderTexture=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.valid=!0,n.filterFrame=null,n.filterPoolKey=null,n.updateUvs(),n}return __extends3(t,e),Object.defineProperty(t.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),t.prototype.resize=function(e,t,r){void 0===r&&(r=!0),e=Math.ceil(e),t=Math.ceil(t),this.valid=e>0&&t>0,this._frame.width=this.orig.width=e,this._frame.height=this.orig.height=t,r&&this.baseTexture.resize(e,t),this.updateUvs()},t.prototype.setResolution=function(e){var t=this.baseTexture;t.resolution!==e&&(t.setResolution(e),this.resize(t.width,t.height,!1))},t.create=function(e){for(var r=arguments,n=[],i=1;i<arguments.length;i++)n[i-1]=r[i];return"number"==typeof e&&(deprecation("6.0.0","Arguments (width, height, scaleMode, resolution) have been deprecated."),e={width:e,height:n[0],scaleMode:n[1],resolution:n[2]}),new t(new BaseRenderTexture(e))},t}(Texture),RenderTexturePool=function(){function e(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return e.prototype.createTexture=function(e,t){var r=new BaseRenderTexture(Object.assign({width:e,height:t,resolution:1},this.textureOptions));return new RenderTexture(r)},e.prototype.getOptimalTexture=function(t,r,n){void 0===n&&(n=1);var i=e.SCREEN_KEY;t*=n,r*=n,(!this.enableFullScreen||t!==this._pixelsWidth||r!==this._pixelsHeight)&&(i=(65535&(t=nextPow2(t)))<<16|65535&(r=nextPow2(r))),this.texturePool[i]||(this.texturePool[i]=[]);var s=this.texturePool[i].pop();return s||(s=this.createTexture(t,r)),s.filterPoolKey=i,s.setResolution(n),s},e.prototype.getFilterTexture=function(e,t){var r=this.getOptimalTexture(e.width,e.height,t||e.resolution);return r.filterFrame=e.filterFrame,r},e.prototype.returnTexture=function(e){var t=e.filterPoolKey;e.filterFrame=null,this.texturePool[t].push(e)},e.prototype.returnFilterTexture=function(e){this.returnTexture(e)},e.prototype.clear=function(e){if(e=!1!==e)for(var t in this.texturePool){var r=this.texturePool[t];if(r)for(var n=0;n<r.length;n++)r[n].destroy(!0)}this.texturePool={}},e.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var r=e.SCREEN_KEY,n=this.texturePool[r];if(this.enableFullScreen=t.width>0&&t.height>0,n)for(var i=0;i<n.length;i++)n[i].destroy(!0);this.texturePool[r]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},e.SCREEN_KEY="screen",e}(),Attribute=function(){function e(e,t,r,n,i,s,o){void 0===t&&(t=0),void 0===r&&(r=!1),void 0===n&&(n=TYPES2.FLOAT),this.buffer=e,this.size=t,this.normalized=r,this.type=n,this.stride=i,this.start=s,this.instance=o}return e.prototype.destroy=function(){this.buffer=null},e.from=function(t,r,n,i,s){return new e(t,r,n,i,s)},e}(),UID=0,Buffer2=function(){function e(e,t,r){void 0===t&&(t=!0),void 0===r&&(r=!1),this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=t,this.id=UID++,this.disposeRunner=new Runner("disposeBuffer")}return e.prototype.update=function(e){this.data=e||this.data,this._updateID++},e.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},e.prototype.destroy=function(){this.dispose(),this.data=null},e.from=function(t){return t instanceof Array&&(t=new Float32Array(t)),new e(t)},e}();function getBufferType(e){if(4===e.BYTES_PER_ELEMENT)return e instanceof Float32Array?"Float32Array":e instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===e.BYTES_PER_ELEMENT){if(e instanceof Uint16Array)return"Uint16Array"}else if(1===e.BYTES_PER_ELEMENT&&e instanceof Uint8Array)return"Uint8Array";return null}var map={Float32Array,Uint32Array,Int32Array,Uint8Array};function interleaveTypedArrays(e,t){for(var r=0,n=0,i={},s=0;s<e.length;s++)n+=t[s],r+=e[s].length;var o=new ArrayBuffer(4*r),a=null,l=0;for(s=0;s<e.length;s++){var h=t[s],u=e[s],c=getBufferType(u);i[c]||(i[c]=new map[c](o)),a=i[c];for(var d=0;d<u.length;d++)a[(d/h|0)*n+l+d%h]=u[d];l+=h}return new Float32Array(o)}var byteSizeMap={5126:4,5123:2,5121:1},UID$1=0,map$1={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array},Geometry=function(){function e(e,t){void 0===e&&(e=[]),void 0===t&&(t={}),this.buffers=e,this.indexBuffer=null,this.attributes=t,this.glVertexArrayObjects={},this.id=UID$1++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Runner("disposeGeometry"),this.refCount=0}return e.prototype.addAttribute=function(e,t,r,n,i,s,o,a){if(void 0===r&&(r=0),void 0===n&&(n=!1),void 0===a&&(a=!1),!t)throw new Error("You must pass a buffer when creating an attribute");t instanceof Buffer2||(t instanceof Array&&(t=new Float32Array(t)),t=new Buffer2(t));var l=e.split("|");if(l.length>1){for(var h=0;h<l.length;h++)this.addAttribute(l[h],t,r,n,i);return this}var u=this.buffers.indexOf(t);return-1===u&&(this.buffers.push(t),u=this.buffers.length-1),this.attributes[e]=new Attribute(u,r,n,i,s,o,a),this.instanced=this.instanced||a,this},e.prototype.getAttribute=function(e){return this.attributes[e]},e.prototype.getBuffer=function(e){return this.buffers[this.getAttribute(e).buffer]},e.prototype.addIndex=function(e){return e instanceof Buffer2||(e instanceof Array&&(e=new Uint16Array(e)),e=new Buffer2(e)),e.index=!0,this.indexBuffer=e,-1===this.buffers.indexOf(e)&&this.buffers.push(e),this},e.prototype.getIndex=function(){return this.indexBuffer},e.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var e,t=[],r=[],n=new Buffer2;for(e in this.attributes){var i=this.attributes[e],s=this.buffers[i.buffer];t.push(s.data),r.push(i.size*byteSizeMap[i.type]/4),i.buffer=0}for(n.data=interleaveTypedArrays(t,r),e=0;e<this.buffers.length;e++)this.buffers[e]!==this.indexBuffer&&this.buffers[e].destroy();return this.buffers=[n],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},e.prototype.getSize=function(){for(var e in this.attributes){var t=this.attributes[e];return this.buffers[t.buffer].data.length/(t.stride/4||t.size)}return 0},e.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},e.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},e.prototype.clone=function(){for(var t=new e,r=0;r<this.buffers.length;r++)t.buffers[r]=new Buffer2(this.buffers[r].data.slice(0));for(var r in this.attributes){var n=this.attributes[r];t.attributes[r]=new Attribute(n.buffer,n.size,n.normalized,n.type,n.stride,n.start,n.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.index=!0),t},e.merge=function(t){for(var r,n=new e,i=[],s=[],o=[],a=0;a<t.length;a++){r=t[a];for(var l=0;l<r.buffers.length;l++)s[l]=s[l]||0,s[l]+=r.buffers[l].data.length,o[l]=0}for(a=0;a<r.buffers.length;a++)i[a]=new(map$1[getBufferType(r.buffers[a].data)])(s[a]),n.buffers[a]=new Buffer2(i[a]);for(a=0;a<t.length;a++)for(r=t[a],l=0;l<r.buffers.length;l++)i[l].set(r.buffers[l].data,o[l]),o[l]+=r.buffers[l].data.length;if(n.attributes=r.attributes,r.indexBuffer){n.indexBuffer=n.buffers[r.buffers.indexOf(r.indexBuffer)],n.indexBuffer.index=!0;var h=0,u=0,c=0,d=0;for(a=0;a<r.buffers.length;a++)if(r.buffers[a]!==r.indexBuffer){d=a;break}for(var a in r.attributes){var f=r.attributes[a];(0|f.buffer)===d&&(u+=f.size*byteSizeMap[f.type]/4)}for(a=0;a<t.length;a++){var p=t[a].indexBuffer.data;for(l=0;l<p.length;l++)n.indexBuffer.data[l+c]+=h;h+=r.buffers[d].data.length/u,c+=p.length}}return n},e}(),Quad=function(e){function t(){var t=e.call(this)||this;return t.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),t}return __extends3(t,e),t}(Geometry),QuadUv=function(e){function t(){var t=e.call(this)||this;return t.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),t.uvs=new Float32Array([0,0,1,0,1,1,0,1]),t.vertexBuffer=new Buffer2(t.vertices),t.uvBuffer=new Buffer2(t.uvs),t.addAttribute("aVertexPosition",t.vertexBuffer).addAttribute("aTextureCoord",t.uvBuffer).addIndex([0,1,2,0,2,3]),t}return __extends3(t,e),t.prototype.map=function(e,t){var r=0,n=0;return this.uvs[0]=r,this.uvs[1]=n,this.uvs[2]=r+t.width/e.width,this.uvs[3]=n,this.uvs[4]=r+t.width/e.width,this.uvs[5]=n+t.height/e.height,this.uvs[6]=r,this.uvs[7]=n+t.height/e.height,r=t.x,n=t.y,this.vertices[0]=r,this.vertices[1]=n,this.vertices[2]=r+t.width,this.vertices[3]=n,this.vertices[4]=r+t.width,this.vertices[5]=n+t.height,this.vertices[6]=r,this.vertices[7]=n+t.height,this.invalidate(),this},t.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},t}(Geometry),UID$2=0,UniformGroup=function(){function e(e,t){this.uniforms=e,this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=UID$2++,this.static=!!t}return e.prototype.update=function(){this.dirtyId++},e.prototype.add=function(t,r,n){this.uniforms[t]=new e(r,n)},e.from=function(t,r){return new e(t,r)},e}(),FilterState=function(){function e(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.sourceFrame=new Rectangle,this.destinationFrame=new Rectangle,this.bindingSourceFrame=new Rectangle,this.bindingDestinationFrame=new Rectangle,this.filters=[],this.transform=null}return e.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},e}(),tempPoints=[new Point,new Point,new Point,new Point],tempMatrix=new Matrix,FilterSystem=function(e){function t(t){var r=e.call(this,t)||this;return r.defaultFilterStack=[{}],r.texturePool=new RenderTexturePool,r.texturePool.setScreenSize(t.view),r.statePool=[],r.quad=new Quad,r.quadUv=new QuadUv,r.tempRect=new Rectangle,r.activeState={},r.globalUniforms=new UniformGroup({outputFrame:new Rectangle,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),r.forceClear=!1,r.useMaxPadding=!1,r}return __extends3(t,e),t.prototype.push=function(e,t){for(var r=this.renderer,n=this.defaultFilterStack,i=this.statePool.pop()||new FilterState,s=this.renderer.renderTexture,o=t[0].resolution,a=t[0].padding,l=t[0].autoFit,h=t[0].legacy,u=1;u<t.length;u++){var c=t[u];o=Math.min(o,c.resolution),a=this.useMaxPadding?Math.max(a,c.padding):a+c.padding,l=l&&c.autoFit,h=h||c.legacy}if(1===n.length&&(this.defaultFilterStack[0].renderTexture=s.current),n.push(i),i.resolution=o,i.legacy=h,i.target=e,i.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),i.sourceFrame.pad(a),l){var d=this.tempRect.copyFrom(s.sourceFrame);r.projection.transform&&this.transformAABB(tempMatrix.copyFrom(r.projection.transform).invert(),d),i.sourceFrame.fit(d)}this.roundFrame(i.sourceFrame,s.current?s.current.resolution:r.resolution,s.sourceFrame,s.destinationFrame,r.projection.transform),i.renderTexture=this.getOptimalFilterTexture(i.sourceFrame.width,i.sourceFrame.height,o),i.filters=t,i.destinationFrame.width=i.renderTexture.width,i.destinationFrame.height=i.renderTexture.height;var f=this.tempRect;f.x=0,f.y=0,f.width=i.sourceFrame.width,f.height=i.sourceFrame.height,i.renderTexture.filterFrame=i.sourceFrame,i.bindingSourceFrame.copyFrom(s.sourceFrame),i.bindingDestinationFrame.copyFrom(s.destinationFrame),i.transform=r.projection.transform,r.projection.transform=null,s.bind(i.renderTexture,i.sourceFrame,f),r.framebuffer.clear(0,0,0,0)},t.prototype.pop=function(){var e=this.defaultFilterStack,t=e.pop(),r=t.filters;this.activeState=t;var n=this.globalUniforms.uniforms;n.outputFrame=t.sourceFrame,n.resolution=t.resolution;var i=n.inputSize,s=n.inputPixel,o=n.inputClamp;if(i[0]=t.destinationFrame.width,i[1]=t.destinationFrame.height,i[2]=1/i[0],i[3]=1/i[1],s[0]=i[0]*t.resolution,s[1]=i[1]*t.resolution,s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=t.sourceFrame.width*i[2]-.5*s[2],o[3]=t.sourceFrame.height*i[3]-.5*s[3],t.legacy){var a=n.filterArea;a[0]=t.destinationFrame.width,a[1]=t.destinationFrame.height,a[2]=t.sourceFrame.x,a[3]=t.sourceFrame.y,n.filterClamp=n.inputClamp}this.globalUniforms.update();var l=e[e.length-1];if(t.renderTexture.framebuffer.multisample>1&&this.renderer.framebuffer.blit(),1===r.length)r[0].apply(this,t.renderTexture,l.renderTexture,CLEAR_MODES2.BLEND,t),this.returnFilterTexture(t.renderTexture);else{var h=t.renderTexture,u=this.getOptimalFilterTexture(h.width,h.height,t.resolution);u.filterFrame=h.filterFrame;var c=0;for(c=0;c<r.length-1;++c){r[c].apply(this,h,u,CLEAR_MODES2.CLEAR,t);var d=h;h=u,u=d}r[c].apply(this,h,l.renderTexture,CLEAR_MODES2.BLEND,t),this.returnFilterTexture(h),this.returnFilterTexture(u)}t.clear(),this.statePool.push(t)},t.prototype.bindAndClear=function(e,t){void 0===t&&(t=CLEAR_MODES2.CLEAR);var r=this.renderer,n=r.renderTexture,i=r.state;if(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,e&&e.filterFrame){var s=this.tempRect;s.x=0,s.y=0,s.width=e.filterFrame.width,s.height=e.filterFrame.height,n.bind(e,e.filterFrame,s)}else e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?n.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);var o=1&i.stateId||this.forceClear;(t===CLEAR_MODES2.CLEAR||t===CLEAR_MODES2.BLIT&&o)&&this.renderer.framebuffer.clear(0,0,0,0)},t.prototype.applyFilter=function(e,t,r,n){var i=this.renderer;i.state.set(e.state),this.bindAndClear(r,n),e.uniforms.uSampler=t,e.uniforms.filterGlobals=this.globalUniforms,i.shader.bind(e),e.legacy?(this.quadUv.map(t._frame,t.filterFrame),i.geometry.bind(this.quadUv),i.geometry.draw(DRAW_MODES2.TRIANGLES)):(i.geometry.bind(this.quad),i.geometry.draw(DRAW_MODES2.TRIANGLE_STRIP))},t.prototype.calculateSpriteMatrix=function(e,t){var r=this.activeState,n=r.sourceFrame,i=r.destinationFrame,s=t._texture.orig,o=e.set(i.width,0,0,i.height,n.x,n.y),a=t.worldTransform.copyTo(Matrix.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(t.anchor.x,t.anchor.y),o},t.prototype.destroy=function(){this.texturePool.clear(!1)},t.prototype.getOptimalFilterTexture=function(e,t,r){return void 0===r&&(r=1),this.texturePool.getOptimalTexture(e,t,r)},t.prototype.getFilterTexture=function(e,t){if("number"==typeof e){var r=e;e=t,t=r}e=e||this.activeState.renderTexture;var n=this.texturePool.getOptimalTexture(e.width,e.height,t||e.resolution);return n.filterFrame=e.filterFrame,n},t.prototype.returnFilterTexture=function(e){this.texturePool.returnTexture(e)},t.prototype.emptyPool=function(){this.texturePool.clear(!0)},t.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},t.prototype.transformAABB=function(e,t){var r=tempPoints[0],n=tempPoints[1],i=tempPoints[2],s=tempPoints[3];r.set(t.left,t.top),n.set(t.left,t.bottom),i.set(t.right,t.top),s.set(t.right,t.bottom),e.apply(r,r),e.apply(n,n),e.apply(i,i),e.apply(s,s);var o=Math.min(r.x,n.x,i.x,s.x),a=Math.min(r.y,n.y,i.y,s.y),l=Math.max(r.x,n.x,i.x,s.x),h=Math.max(r.y,n.y,i.y,s.y);t.x=o,t.y=a,t.width=l-o,t.height=h-a},t.prototype.roundFrame=function(e,t,r,n,i){if(i){var s=i.a,o=i.b,a=i.c,l=i.d;if(!(0===o&&0===a||0===s&&0===l))return}(i=i?tempMatrix.copyFrom(i):tempMatrix.identity()).translate(-r.x,-r.y).scale(n.width/r.width,n.height/r.height).translate(n.x,n.y),this.transformAABB(i,e),e.ceil(t),this.transformAABB(i.invert(),e)},t}(System),ObjectRenderer=function(){function e(e){this.renderer=e}return e.prototype.flush=function(){},e.prototype.destroy=function(){this.renderer=null},e.prototype.start=function(){},e.prototype.stop=function(){this.flush()},e.prototype.render=function(e){},e}(),BatchSystem=function(e){function t(t){var r=e.call(this,t)||this;return r.emptyRenderer=new ObjectRenderer(t),r.currentRenderer=r.emptyRenderer,r}return __extends3(t,e),t.prototype.setObjectRenderer=function(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.copyBoundTextures=function(e,t){for(var r=this.renderer.texture.boundTextures,n=t-1;n>=0;--n)e[n]=r[n]||null,e[n]&&(e[n]._batchLocation=n)},t.prototype.boundArray=function(e,t,r,n){for(var i=e.elements,s=e.ids,o=e.count,a=0,l=0;l<o;l++){var h=i[l],u=h._batchLocation;if(u>=0&&u<n&&t[u]===h)s[l]=u;else for(;a<n;){var c=t[a];if(!c||c._batchEnabled!==r||c._batchLocation!==a){s[l]=a,h._batchLocation=a,t[a]=h;break}a++}}},t}(System),CONTEXT_UID_COUNTER=0,ContextSystem=function(e){function t(t){var r=e.call(this,t)||this;return r.webGLVersion=1,r.extensions={},r.supports={uint32Indices:!1},r.handleContextLost=r.handleContextLost.bind(r),r.handleContextRestored=r.handleContextRestored.bind(r),t.view.addEventListener("webglcontextlost",r.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",r.handleContextRestored,!1),r}return __extends3(t,e),Object.defineProperty(t.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),t.prototype.contextChange=function(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=CONTEXT_UID_COUNTER++,e.isContextLost()&&e.getExtension("WEBGL_lose_context")&&e.getExtension("WEBGL_lose_context").restoreContext()},t.prototype.initFromContext=function(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=CONTEXT_UID_COUNTER++,this.renderer.runners.contextChange.emit(e)},t.prototype.initFromOptions=function(e){var t=this.createContext(this.renderer.view,e);this.initFromContext(t)},t.prototype.createContext=function(e,t){var r;if(settings.PREFER_ENV>=ENV2.WEBGL2&&(r=e.getContext("webgl2",t)),r)this.webGLVersion=2;else if(this.webGLVersion=1,!(r=e.getContext("webgl",t)||e.getContext("experimental-webgl",t)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=r,this.getExtensions(),this.gl},t.prototype.getExtensions=function(){var e=this.gl,t={anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc")};1===this.webGLVersion?Object.assign(this.extensions,t,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),loseContext:e.getExtension("WEBGL_lose_context"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,t,{colorBufferFloat:e.getExtension("EXT_color_buffer_float")})},t.prototype.handleContextLost=function(e){e.preventDefault()},t.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},t.prototype.destroy=function(){var e=this.renderer.view;e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},t.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},t.prototype.validateContext=function(e){var t=e.getContextAttributes(),r="WebGL2RenderingContext"in self&&e instanceof self.WebGL2RenderingContext;r&&(this.webGLVersion=2),t.stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var n=r||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=n,n||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},t}(System),GLFramebuffer=function(e){this.framebuffer=e,this.stencil=null,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.multisample=MSAA_QUALITY2.NONE,this.msaaBuffer=null,this.blitFramebuffer=null},tempRectangle=new Rectangle,FramebufferSystem=function(e){function t(t){var r=e.call(this,t)||this;return r.managedFramebuffers=[],r.unknownFramebuffer=new Framebuffer(10,10),r.msaaSamples=null,r}return __extends3(t,e),t.prototype.contextChange=function(){var e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Rectangle,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var t=this.renderer.context.extensions.drawBuffers,r=this.renderer.context.extensions.depthTexture;settings.PREFER_ENV===ENV2.WEBGL_LEGACY&&(t=null,r=null),t?e.drawBuffers=function(e){return t.drawBuffersWEBGL(e)}:(this.hasMRT=!1,e.drawBuffers=function(){}),r||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)},t.prototype.bind=function(e,t){var r=this.gl;if(e){var n=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,r.bindFramebuffer(r.FRAMEBUFFER,n.framebuffer)),n.dirtyId!==e.dirtyId&&(n.dirtyId=e.dirtyId,n.dirtyFormat!==e.dirtyFormat?(n.dirtyFormat=e.dirtyFormat,this.updateFramebuffer(e)):n.dirtySize!==e.dirtySize&&(n.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(var i=0;i<e.colorTextures.length;i++){var s=e.colorTextures[i];this.renderer.texture.unbind(s.parentTextureArray||s)}e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),t?this.setViewport(t.x,t.y,t.width,t.height):this.setViewport(0,0,e.width,e.height)}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),t?this.setViewport(t.x,t.y,t.width,t.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},t.prototype.setViewport=function(e,t,r,n){var i=this.viewport;(i.width!==r||i.height!==n||i.x!==e||i.y!==t)&&(i.x=e,i.y=t,i.width=r,i.height=n,this.gl.viewport(e,t,r,n))},Object.defineProperty(t.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),t.prototype.clear=function(e,t,r,n,i){void 0===i&&(i=BUFFER_BITS2.COLOR|BUFFER_BITS2.DEPTH);var s=this.gl;s.clearColor(e,t,r,n),s.clear(i)},t.prototype.initFramebuffer=function(e){var t=this.gl,r=new GLFramebuffer(t.createFramebuffer());return r.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=r,this.managedFramebuffers.push(e),e.disposeRunner.add(this),r},t.prototype.resizeFramebuffer=function(e){var t=this.gl,r=e.glFramebuffers[this.CONTEXT_UID];r.stencil&&(t.bindRenderbuffer(t.RENDERBUFFER,r.stencil),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,e.width,e.height));for(var n=e.colorTextures,i=0;i<n.length;i++)this.renderer.texture.bind(n[i],0);e.depthTexture&&this.renderer.texture.bind(e.depthTexture,0)},t.prototype.updateFramebuffer=function(e){var t=this.gl,r=e.glFramebuffers[this.CONTEXT_UID],n=e.colorTextures.length;t.drawBuffers||(n=Math.min(n,1)),r.multisample>1&&(r.msaaBuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,r.msaaBuffer),t.renderbufferStorageMultisample(t.RENDERBUFFER,r.multisample,t.RGBA8,e.width,e.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,r.msaaBuffer));for(var i=[],s=0;s<n;s++)if(!(0===s&&r.multisample>1)){var o=e.colorTextures[s],a=o.parentTextureArray||o;this.renderer.texture.bind(a,0),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+s,o.target,a._glTextures[this.CONTEXT_UID].texture,0),i.push(t.COLOR_ATTACHMENT0+s)}if(i.length>1&&t.drawBuffers(i),e.depthTexture&&this.writeDepthTexture){var l=e.depthTexture;this.renderer.texture.bind(l,0),t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,l._glTextures[this.CONTEXT_UID].texture,0)}!r.stencil&&(e.stencil||e.depth)&&(r.stencil=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,r.stencil),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,e.width,e.height),e.depthTexture||t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,r.stencil))},t.prototype.detectSamples=function(e){var t=this.msaaSamples,r=MSAA_QUALITY2.NONE;if(e<=1||null===t)return r;for(var n=0;n<t.length;n++)if(t[n]<=e){r=t[n];break}return 1===r&&(r=MSAA_QUALITY2.NONE),r},t.prototype.blit=function(e,t,r){var n=this,i=n.current,s=n.renderer,o=n.gl,a=n.CONTEXT_UID;if(2===s.context.webGLVersion&&i){var l=i.glFramebuffers[a];if(l){if(!e){if(l.multisample<=1)return;l.blitFramebuffer||(l.blitFramebuffer=new Framebuffer(i.width,i.height),l.blitFramebuffer.addColorTexture(0,i.colorTextures[0])),(e=l.blitFramebuffer).width=i.width,e.height=i.height}t||((t=tempRectangle).width=i.width,t.height=i.height),r||(r=t);var h=t.width===r.width&&t.height===r.height;this.bind(e),o.bindFramebuffer(o.READ_FRAMEBUFFER,l.framebuffer),o.blitFramebuffer(t.x,t.y,t.width,t.height,r.x,r.y,r.width,r.height,o.COLOR_BUFFER_BIT,h?o.NEAREST:o.LINEAR)}}},t.prototype.disposeFramebuffer=function(e,t){var r=e.glFramebuffers[this.CONTEXT_UID],n=this.gl;if(r){delete e.glFramebuffers[this.CONTEXT_UID];var i=this.managedFramebuffers.indexOf(e);i>=0&&this.managedFramebuffers.splice(i,1),e.disposeRunner.remove(this),t||(n.deleteFramebuffer(r.framebuffer),r.stencil&&n.deleteRenderbuffer(r.stencil))}},t.prototype.disposeAll=function(e){var t=this.managedFramebuffers;this.managedFramebuffers=[];for(var r=0;r<t.length;r++)this.disposeFramebuffer(t[r],e)},t.prototype.forceStencil=function(){var e=this.current;if(e){var t=e.glFramebuffers[this.CONTEXT_UID];if(t&&!t.stencil){e.enableStencil();var r=e.width,n=e.height,i=this.gl,s=i.createRenderbuffer();i.bindRenderbuffer(i.RENDERBUFFER,s),i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,r,n),t.stencil=s,i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,s)}}},t.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new Rectangle},t}(System),GLBuffer=function(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0},byteSizeMap$1={5126:4,5123:2,5121:1},GeometrySystem=function(e){function t(t){var r=e.call(this,t)||this;return r._activeGeometry=null,r._activeVao=null,r.hasVao=!0,r.hasInstance=!0,r.canUseUInt32ElementIndex=!1,r.managedGeometries={},r.managedBuffers={},r}return __extends3(t,e),t.prototype.contextChange=function(){this.disposeAll(!0);var e=this.gl=this.renderer.gl,t=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==t.webGLVersion){var r=this.renderer.context.extensions.vertexArrayObject;settings.PREFER_ENV===ENV2.WEBGL_LEGACY&&(r=null),r?(e.createVertexArray=function(){return r.createVertexArrayOES()},e.bindVertexArray=function(e){return r.bindVertexArrayOES(e)},e.deleteVertexArray=function(e){return r.deleteVertexArrayOES(e)}):(this.hasVao=!1,e.createVertexArray=function(){return null},e.bindVertexArray=function(){return null},e.deleteVertexArray=function(){return null})}if(2!==t.webGLVersion){var n=e.getExtension("ANGLE_instanced_arrays");n?(e.vertexAttribDivisor=function(e,t){return n.vertexAttribDivisorANGLE(e,t)},e.drawElementsInstanced=function(e,t,r,i,s){return n.drawElementsInstancedANGLE(e,t,r,i,s)},e.drawArraysInstanced=function(e,t,r,i){return n.drawArraysInstancedANGLE(e,t,r,i)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===t.webGLVersion||!!t.extensions.uint32ElementIndex},t.prototype.bind=function(e,t){t=t||this.renderer.shader.shader;var r=this.gl,n=e.glVertexArrayObjects[this.CONTEXT_UID],i=!1;n||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=n={},i=!0);var s=n[t.program.id]||this.initGeometryVao(e,t.program,i);this._activeGeometry=e,this._activeVao!==s&&(this._activeVao=s,this.hasVao?r.bindVertexArray(s):this.activateVao(e,t.program)),this.updateBuffers()},t.prototype.reset=function(){this.unbind()},t.prototype.updateBuffers=function(){for(var e=this._activeGeometry,t=this.gl,r=0;r<e.buffers.length;r++){var n=e.buffers[r],i=n._glBuffers[this.CONTEXT_UID];if(n._updateID!==i.updateID){i.updateID=n._updateID;var s=n.index?t.ELEMENT_ARRAY_BUFFER:t.ARRAY_BUFFER;if(t.bindBuffer(s,i.buffer),this._boundBuffer=i,i.byteLength>=n.data.byteLength)t.bufferSubData(s,0,n.data);else{var o=n.static?t.STATIC_DRAW:t.DYNAMIC_DRAW;i.byteLength=n.data.byteLength,t.bufferData(s,n.data,o)}}}},t.prototype.checkCompatibility=function(e,t){var r=e.attributes,n=t.attributeData;for(var i in n)if(!r[i])throw new Error('shader and geometry incompatible, geometry missing the "'+i+'" attribute')},t.prototype.getSignature=function(e,t){var r=e.attributes,n=t.attributeData,i=["g",e.id];for(var s in r)n[s]&&i.push(s);return i.join("-")},t.prototype.initGeometryVao=function(e,t,r){void 0===r&&(r=!0),this.checkCompatibility(e,t);var n=this.gl,i=this.CONTEXT_UID,s=this.getSignature(e,t),o=e.glVertexArrayObjects[this.CONTEXT_UID],a=o[s];if(a)return o[t.id]=a,a;var l=e.buffers,h=e.attributes,u={},c={};for(var d in l)u[d]=0,c[d]=0;for(var d in h)!h[d].size&&t.attributeData[d]?h[d].size=t.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[h[d].buffer]+=h[d].size*byteSizeMap$1[h[d].type];for(var d in h){var f=h[d],p=f.size;void 0===f.stride&&(u[f.buffer]===p*byteSizeMap$1[f.type]?f.stride=0:f.stride=u[f.buffer]),void 0===f.start&&(f.start=c[f.buffer],c[f.buffer]+=p*byteSizeMap$1[f.type])}a=n.createVertexArray(),n.bindVertexArray(a);for(var m=0;m<l.length;m++){var _=l[m];_._glBuffers[i]||(_._glBuffers[i]=new GLBuffer(n.createBuffer()),this.managedBuffers[_.id]=_,_.disposeRunner.add(this)),r&&_._glBuffers[i].refCount++}return this.activateVao(e,t),this._activeVao=a,o[t.id]=a,o[s]=a,a},t.prototype.disposeBuffer=function(e,t){if(this.managedBuffers[e.id]){delete this.managedBuffers[e.id];var r=e._glBuffers[this.CONTEXT_UID],n=this.gl;e.disposeRunner.remove(this),r&&(t||n.deleteBuffer(r.buffer),delete e._glBuffers[this.CONTEXT_UID])}},t.prototype.disposeGeometry=function(e,t){if(this.managedGeometries[e.id]){delete this.managedGeometries[e.id];var r=e.glVertexArrayObjects[this.CONTEXT_UID],n=this.gl,i=e.buffers;if(e.disposeRunner.remove(this),r){for(var s=0;s<i.length;s++){var o=i[s]._glBuffers[this.CONTEXT_UID];o.refCount--,0===o.refCount&&!t&&this.disposeBuffer(i[s],t)}if(!t)for(var a in r)if("g"===a[0]){var l=r[a];this._activeVao===l&&this.unbind(),n.deleteVertexArray(l)}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}},t.prototype.disposeAll=function(e){for(var t=Object.keys(this.managedGeometries),r=0;r<t.length;r++)this.disposeGeometry(this.managedGeometries[t[r]],e);for(t=Object.keys(this.managedBuffers),r=0;r<t.length;r++)this.disposeBuffer(this.managedBuffers[t[r]],e)},t.prototype.activateVao=function(e,t){var r=this.gl,n=this.CONTEXT_UID,i=e.buffers,s=e.attributes;e.indexBuffer&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e.indexBuffer._glBuffers[n].buffer);var o=null;for(var a in s){var l=s[a],h=i[l.buffer]._glBuffers[n];if(t.attributeData[a]){o!==h&&(r.bindBuffer(r.ARRAY_BUFFER,h.buffer),o=h);var u=t.attributeData[a].location;if(r.enableVertexAttribArray(u),r.vertexAttribPointer(u,l.size,l.type||r.FLOAT,l.normalized,l.stride,l.start),l.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");r.vertexAttribDivisor(u,1)}}}},t.prototype.draw=function(e,t,r,n){var i=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,a=2===o?i.UNSIGNED_SHORT:i.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?i.drawElementsInstanced(e,t||s.indexBuffer.data.length,a,(r||0)*o,n||1):i.drawElements(e,t||s.indexBuffer.data.length,a,(r||0)*o):console.warn("unsupported index buffer type: uint32")}else s.instanced?i.drawArraysInstanced(e,r,t||s.getSize(),n||1):i.drawArrays(e,r,t||s.getSize());return this},t.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},t}(System),MaskData=function(){function e(e){void 0===e&&(e=null),this.type=MASK_TYPES2.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._target=null}return e.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=MASK_TYPES2.NONE,this.autoDetect=!0),this._target=null},e.prototype.copyCountersOrReset=function(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},e}();function compileShader(e,t,r){var n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),n}function compileProgram(e,t,r,n){var i=compileShader(e,e.VERTEX_SHADER,t),s=compileShader(e,e.FRAGMENT_SHADER,r),o=e.createProgram();if(e.attachShader(o,i),e.attachShader(o,s),n)for(var a in n)e.bindAttribLocation(o,n[a],a);return e.linkProgram(o),e.getProgramParameter(o,e.LINK_STATUS)||(e.getShaderParameter(i,e.COMPILE_STATUS)||(console.warn(t),console.error(e.getShaderInfoLog(i))),e.getShaderParameter(s,e.COMPILE_STATUS)||(console.warn(r),console.error(e.getShaderInfoLog(s))),console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",e.getProgramParameter(o,e.VALIDATE_STATUS)),console.error("gl.getError()",e.getError()),""!==e.getProgramInfoLog(o)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",e.getProgramInfoLog(o)),e.deleteProgram(o),o=null),e.deleteShader(i),e.deleteShader(s),o}function booleanArray(e){for(var t=new Array(e),r=0;r<t.length;r++)t[r]=!1;return t}function defaultValue(e,t){switch(e){case"float":case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return booleanArray(2*t);case"bvec3":return booleanArray(3*t);case"bvec4":return booleanArray(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var unknownContext={},context=unknownContext,maxFragmentPrecision;function getTestContext(){if(context===unknownContext||context&&context.isContextLost()){var e=document.createElement("canvas"),t=void 0;settings.PREFER_ENV>=ENV2.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),context=t}return context}function getMaxFragmentPrecision(){if(!maxFragmentPrecision){maxFragmentPrecision=PRECISION2.MEDIUM;var e=getTestContext();if(e&&e.getShaderPrecisionFormat){var t=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT);maxFragmentPrecision=t.precision?PRECISION2.HIGH:PRECISION2.MEDIUM}}return maxFragmentPrecision}function setPrecision(e,t,r){if("precision"!==e.substring(0,9)){var n=t;return t===PRECISION2.HIGH&&r!==PRECISION2.HIGH&&(n=PRECISION2.MEDIUM),"precision "+n+" float;\n"+e}return r!==PRECISION2.HIGH&&"precision highp"===e.substring(0,15)?e.replace("precision highp","precision mediump"):e}var GLSL_TO_SIZE={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function mapSize(e){return GLSL_TO_SIZE[e]}var GL_TABLE=null,GL_TO_GLSL_TYPES={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function mapType(e,t){if(!GL_TABLE){var r=Object.keys(GL_TO_GLSL_TYPES);GL_TABLE={};for(var n=0;n<r.length;++n){var i=r[n];GL_TABLE[e[i]]=GL_TO_GLSL_TYPES[i]}}return GL_TABLE[t]}var uniformParsers=[{test:function(e){return"float"===e.type&&1===e.size},code:function(e){return'\n            if(uv["'+e+'"] !== ud["'+e+'"].value)\n            {\n                ud["'+e+'"].value = uv["'+e+'"]\n                gl.uniform1f(ud["'+e+'"].location, uv["'+e+'"])\n            }\n            '}},{test:function(e){return("sampler2D"===e.type||"samplerCube"===e.type||"sampler2DArray"===e.type)&&1===e.size&&!e.isArray},code:function(e){return't = syncData.textureCount++;\n\n            renderer.texture.bind(uv["'+e+'"], t);\n\n            if(ud["'+e+'"].value !== t)\n            {\n                ud["'+e+'"].value = t;\n                gl.uniform1i(ud["'+e+'"].location, t);\n; // eslint-disable-line max-len\n            }'}},{test:function(e,t){return"mat3"===e.type&&1===e.size&&void 0!==t.a},code:function(e){return'\n            gl.uniformMatrix3fv(ud["'+e+'"].location, false, uv["'+e+'"].toArray(true));\n            '}},{test:function(e,t){return"vec2"===e.type&&1===e.size&&void 0!==t.x},code:function(e){return'\n                cv = ud["'+e+'"].value;\n                v = uv["'+e+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["'+e+'"].location, v.x, v.y);\n                }'}},{test:function(e){return"vec2"===e.type&&1===e.size},code:function(e){return'\n                cv = ud["'+e+'"].value;\n                v = uv["'+e+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["'+e+'"].location, v[0], v[1]);\n                }\n            '}},{test:function(e,t){return"vec4"===e.type&&1===e.size&&void 0!==t.width},code:function(e){return'\n                cv = ud["'+e+'"].value;\n                v = uv["'+e+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["'+e+'"].location, v.x, v.y, v.width, v.height)\n                }'}},{test:function(e){return"vec4"===e.type&&1===e.size},code:function(e){return'\n                cv = ud["'+e+'"].value;\n                v = uv["'+e+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["'+e+'"].location, v[0], v[1], v[2], v[3])\n                }'}}],GLSL_TO_SINGLE_SETTERS_CACHED={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",uint:"gl.uniform1ui(location, v)",uvec2:"gl.uniform2ui(location, v[0], v[1])",uvec3:"gl.uniform3ui(location, v[0], v[1], v[2])",uvec4:"gl.uniform4ui(location, v[0], v[1], v[2], v[3])",bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},GLSL_TO_ARRAY_SETTERS={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function generateUniformsSync(e,t){var r=["\n        var v = null;\n        var cv = null\n        var t = 0;\n        var gl = renderer.gl\n    "];for(var n in e.uniforms){var i=t[n];if(i){for(var s=e.uniforms[n],o=!1,a=0;a<uniformParsers.length;a++)if(uniformParsers[a].test(i,s)){r.push(uniformParsers[a].code(n,s)),o=!0;break}if(!o){var l=(1===i.size?GLSL_TO_SINGLE_SETTERS_CACHED:GLSL_TO_ARRAY_SETTERS)[i.type].replace("location",'ud["'+n+'"].location');r.push('\n            cv = ud["'+n+'"].value;\n            v = uv["'+n+'"];\n            '+l+";")}}else e.uniforms[n].group&&r.push('\n                    renderer.shader.syncUniformGroup(uv["'+n+'"], syncData);\n                ')}return new Function("ud","uv","renderer","syncData",r.join("\n"))}var fragTemplate=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n"),unsafeEval;function generateIfTestSrc(e){for(var t="",r=0;r<e;++r)r>0&&(t+="\nelse "),r<e-1&&(t+="if(test == "+r+".0){}");return t}function checkMaxIfStatementsInShader(e,t){if(0===e)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var r=t.createShader(t.FRAGMENT_SHADER);;){var n=fragTemplate.replace(/%forloop%/gi,generateIfTestSrc(e));if(t.shaderSource(r,n),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS))break;e=e/2|0}return e}function unsafeEvalSupported(){if("boolean"==typeof unsafeEval)return unsafeEval;try{var e=new Function("param1","param2","param3","return param1[param2] === param3;");unsafeEval=!0===e({a:"b"},"a","b")}catch(e){unsafeEval=!1}return unsafeEval}var defaultFragment="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}",defaultVertex="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n",UID$3=0,nameCache={},Program=function(){function e(t,r,n){void 0===n&&(n="pixi-shader"),this.id=UID$3++,this.vertexSrc=t||e.defaultVertexSrc,this.fragmentSrc=r||e.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(n=n.replace(/\s+/g,"-"),nameCache[n]?(nameCache[n]++,n+="-"+nameCache[n]):nameCache[n]=1,this.vertexSrc="#define SHADER_NAME "+n+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+n+"\n"+this.fragmentSrc,this.vertexSrc=setPrecision(this.vertexSrc,settings.PRECISION_VERTEX,PRECISION2.HIGH),this.fragmentSrc=setPrecision(this.fragmentSrc,settings.PRECISION_FRAGMENT,getMaxFragmentPrecision())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},this.syncUniforms=null}return e.prototype.extractData=function(e,t){var r=getTestContext();if(r){var n=compileProgram(r,e,t);this.attributeData=this.getAttributeData(n,r),this.uniformData=this.getUniformData(n,r),r.deleteProgram(n)}else this.uniformData={},this.attributeData={}},e.prototype.getAttributeData=function(e,t){for(var r={},n=[],i=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),s=0;s<i;s++){var o=t.getActiveAttrib(e,s),a=mapType(t,o.type),l={type:a,name:o.name,size:mapSize(a),location:0};r[o.name]=l,n.push(l)}for(n.sort((function(e,t){return e.name>t.name?1:-1})),s=0;s<n.length;s++)n[s].location=s;return r},e.prototype.getUniformData=function(e,t){for(var r={},n=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),i=0;i<n;i++){var s=t.getActiveUniform(e,i),o=s.name.replace(/\[.*?\]$/,""),a=s.name.match(/\[.*?\]$/),l=mapType(t,s.type);r[o]={type:l,size:s.size,isArray:a,value:defaultValue(l,s.size)}}return r},Object.defineProperty(e,"defaultVertexSrc",{get:function(){return defaultVertex},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultFragmentSrc",{get:function(){return defaultFragment},enumerable:!1,configurable:!0}),e.from=function(t,r,n){var i=t+r,s=ProgramCache[i];return s||(ProgramCache[i]=s=new e(t,r,n)),s},e}(),Shader=function(){function e(e,t){for(var r in this.program=e,this.uniformGroup=t?t instanceof UniformGroup?t:new UniformGroup(t):new UniformGroup({}),e.uniformData)this.uniformGroup.uniforms[r]instanceof Array&&(this.uniformGroup.uniforms[r]=new Float32Array(this.uniformGroup.uniforms[r]))}return e.prototype.checkUniformExists=function(e,t){if(t.uniforms[e])return!0;for(var r in t.uniforms){var n=t.uniforms[r];if(n.group&&this.checkUniformExists(e,n))return!0}return!1},e.prototype.destroy=function(){this.uniformGroup=null},Object.defineProperty(e.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),e.from=function(t,r,n){return new e(Program.from(t,r),n)},e}(),BLEND=0,OFFSET=1,CULLING=2,DEPTH_TEST=3,WINDING=4,DEPTH_MASK=5,State=function(){function e(){this.data=0,this.blendMode=BLEND_MODES2.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}return Object.defineProperty(e.prototype,"blend",{get:function(){return!!(this.data&1<<BLEND)},set:function(e){!!(this.data&1<<BLEND)!==e&&(this.data^=1<<BLEND)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"offsets",{get:function(){return!!(this.data&1<<OFFSET)},set:function(e){!!(this.data&1<<OFFSET)!==e&&(this.data^=1<<OFFSET)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"culling",{get:function(){return!!(this.data&1<<CULLING)},set:function(e){!!(this.data&1<<CULLING)!==e&&(this.data^=1<<CULLING)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"depthTest",{get:function(){return!!(this.data&1<<DEPTH_TEST)},set:function(e){!!(this.data&1<<DEPTH_TEST)!==e&&(this.data^=1<<DEPTH_TEST)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"depthMask",{get:function(){return!!(this.data&1<<DEPTH_MASK)},set:function(e){!!(this.data&1<<DEPTH_MASK)!==e&&(this.data^=1<<DEPTH_MASK)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clockwiseFrontFace",{get:function(){return!!(this.data&1<<WINDING)},set:function(e){!!(this.data&1<<WINDING)!==e&&(this.data^=1<<WINDING)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this._blendMode},set:function(e){this.blend=e!==BLEND_MODES2.NONE,this._blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(e){this.offsets=!!e,this._polygonOffset=e},enumerable:!1,configurable:!0}),e.prototype.toString=function(){return"[@pixi/core:State blendMode="+this.blendMode+" clockwiseFrontFace="+this.clockwiseFrontFace+" culling="+this.culling+" depthMask="+this.depthMask+" polygonOffset="+this.polygonOffset+"]"},e.for2d=function(){var t=new e;return t.depthTest=!1,t.blend=!0,t},e}(),defaultVertex$1="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n",defaultFragment$1="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n",Filter=function(e){function t(r,n,i){var s=this,o=Program.from(r||t.defaultVertexSrc,n||t.defaultFragmentSrc);return(s=e.call(this,o,i)||this).padding=0,s.resolution=settings.FILTER_RESOLUTION,s.enabled=!0,s.autoFit=!0,s.legacy=!!s.program.attributeData.aTextureCoord,s.state=new State,s}return __extends3(t,e),t.prototype.apply=function(e,t,r,n,i){e.applyFilter(this,t,r,n)},Object.defineProperty(t.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(e){this.state.blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultVertexSrc",{get:function(){return defaultVertex$1},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultFragmentSrc",{get:function(){return defaultFragment$1},enumerable:!1,configurable:!0}),t}(Shader),vertex="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n",fragment="varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n",tempMat=new Matrix,TextureMatrix=function(){function e(e,t){this._texture=e,this.mapCoord=new Matrix,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=void 0===t?.5:t,this.isSimple=!1}return Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(e){this._texture=e,this._textureID=-1},enumerable:!1,configurable:!0}),e.prototype.multiplyUvs=function(e,t){void 0===t&&(t=e);for(var r=this.mapCoord,n=0;n<e.length;n+=2){var i=e[n],s=e[n+1];t[n]=i*r.a+s*r.c+r.tx,t[n+1]=i*r.b+s*r.d+r.ty}return t},e.prototype.update=function(e){var t=this._texture;if(!t||!t.valid||!e&&this._textureID===t._updateID)return!1;this._textureID=t._updateID,this._updateID++;var r=t._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);var n=t.orig,i=t.trim;i&&(tempMat.set(n.width/i.width,0,0,n.height/i.height,-i.x/i.width,-i.y/i.height),this.mapCoord.append(tempMat));var s=t.baseTexture,o=this.uClampFrame,a=this.clampMargin/s.resolution,l=this.clampOffset;return o[0]=(t._frame.x+a+l)/s.width,o[1]=(t._frame.y+a+l)/s.height,o[2]=(t._frame.x+t._frame.width-a+l)/s.width,o[3]=(t._frame.y+t._frame.height-a+l)/s.height,this.uClampOffset[0]=l/s.realWidth,this.uClampOffset[1]=l/s.realHeight,this.isSimple=t._frame.width===s.width&&t._frame.height===s.height&&0===t.rotate,!0},e}(),SpriteMaskFilter=function(e){function t(t){var r=this,n=new Matrix;return r=e.call(this,vertex,fragment)||this,t.renderable=!1,r.maskSprite=t,r.maskMatrix=n,r}return __extends3(t,e),t.prototype.apply=function(e,t,r,n){var i=this.maskSprite,s=i._texture;!s.valid||(s.uvMatrix||(s.uvMatrix=new TextureMatrix(s,0)),s.uvMatrix.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,i).prepend(s.uvMatrix.mapCoord),this.uniforms.alpha=i.worldAlpha,this.uniforms.maskClamp=s.uvMatrix.uClampFrame,e.applyFilter(this,t,r,n))},t}(Filter),MaskSystem=function(e){function t(t){var r=e.call(this,t)||this;return r.enableScissor=!0,r.alphaMaskPool=[],r.maskDataPool=[],r.maskStack=[],r.alphaMaskIndex=0,r}return __extends3(t,e),t.prototype.setMaskStack=function(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)},t.prototype.push=function(e,t){var r=t;if(!r.isMaskData){var n=this.maskDataPool.pop()||new MaskData;n.pooled=!0,n.maskObject=t,r=n}switch(r.autoDetect&&this.detect(r),r.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),r._target=e,r.type){case MASK_TYPES2.SCISSOR:this.maskStack.push(r),this.renderer.scissor.push(r);break;case MASK_TYPES2.STENCIL:this.maskStack.push(r),this.renderer.stencil.push(r);break;case MASK_TYPES2.SPRITE:r.copyCountersOrReset(null),this.pushSpriteMask(r),this.maskStack.push(r)}},t.prototype.pop=function(e){var t=this.maskStack.pop();if(t&&t._target===e){switch(t.type){case MASK_TYPES2.SCISSOR:this.renderer.scissor.pop();break;case MASK_TYPES2.STENCIL:this.renderer.stencil.pop(t.maskObject);break;case MASK_TYPES2.SPRITE:this.popSpriteMask()}t.reset(),t.pooled&&this.maskDataPool.push(t)}},t.prototype.detect=function(e){var t=e.maskObject;if(t.isSprite)e.type=MASK_TYPES2.SPRITE;else if(e.type=MASK_TYPES2.STENCIL,this.enableScissor&&t.isFastRect&&t.isFastRect()){var r=t.worldTransform,n=Math.atan2(r.b,r.a),i=Math.atan2(r.d,r.c);n=Math.round(n*(180/Math.PI)*100),i=((i=Math.round(i*(180/Math.PI)*100)-n)%18e3+18e3)%18e3,0==(n=(n%9e3+9e3)%9e3)&&9e3===i&&(e.type=MASK_TYPES2.SCISSOR)}},t.prototype.pushSpriteMask=function(e){var t=e.maskObject,r=e._target,n=this.alphaMaskPool[this.alphaMaskIndex];n||(n=this.alphaMaskPool[this.alphaMaskIndex]=[new SpriteMaskFilter(t)]),n[0].resolution=this.renderer.resolution,n[0].maskSprite=t;var i=r.filterArea;r.filterArea=t.getBounds(!0),this.renderer.filter.push(r,n),r.filterArea=i,this.alphaMaskIndex++},t.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},t}(System),AbstractMaskSystem=function(e){function t(t){var r=e.call(this,t)||this;return r.maskStack=[],r.glConst=0,r}return __extends3(t,e),t.prototype.getStackLength=function(){return this.maskStack.length},t.prototype.setMaskStack=function(e){var t=this.renderer.gl,r=this.getStackLength();this.maskStack=e;var n=this.getStackLength();n!==r&&(0===n?t.disable(this.glConst):(t.enable(this.glConst),this._useCurrent()))},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.maskStack=null},t}(System),ScissorSystem=function(e){function t(t){var r=e.call(this,t)||this;return r.glConst=WebGLRenderingContext.SCISSOR_TEST,r}return __extends3(t,e),t.prototype.getStackLength=function(){var e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0},t.prototype.push=function(e){var t=e.maskObject;t.renderable=!0;var r=e._scissorRect,n=t.getBounds(!0),i=this.renderer.gl;t.renderable=!1,r?n.fit(r):i.enable(i.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=n,this._useCurrent()},t.prototype.pop=function(){var e=this.renderer.gl;this.getStackLength()>0?this._useCurrent():e.disable(e.SCISSOR_TEST)},t.prototype._useCurrent=function(){var e=this.maskStack[this.maskStack.length-1]._scissorRect,t=this.renderer.renderTexture.current,r=this.renderer.projection,n=r.transform,i=r.sourceFrame,s=r.destinationFrame,o=t?t.resolution:this.renderer.resolution,a=s.width/i.width,l=s.height/i.height,h=((e.x-i.x)*a+s.x)*o,u=((e.y-i.y)*l+s.y)*o,c=e.width*a*o,d=e.height*l*o;n&&(h+=n.tx*o,u+=n.ty*o),t||(u=this.renderer.height-d-u),this.renderer.gl.scissor(h,u,c,d)},t}(AbstractMaskSystem),StencilSystem=function(e){function t(t){var r=e.call(this,t)||this;return r.glConst=WebGLRenderingContext.STENCIL_TEST,r}return __extends3(t,e),t.prototype.getStackLength=function(){var e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0},t.prototype.push=function(e){var t=e.maskObject,r=this.renderer.gl,n=e._stencilCounter;0===n&&(this.renderer.framebuffer.forceStencil(),r.enable(r.STENCIL_TEST)),e._stencilCounter++,r.colorMask(!1,!1,!1,!1),r.stencilFunc(r.EQUAL,n,this._getBitwiseMask()),r.stencilOp(r.KEEP,r.KEEP,r.INCR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),this.renderer.framebuffer.blit(),t.renderable=!1,this._useCurrent()},t.prototype.pop=function(e){var t=this.renderer.gl;0===this.getStackLength()?(t.disable(t.STENCIL_TEST),t.clear(t.STENCIL_BUFFER_BIT),t.clearStencil(0)):(t.colorMask(!1,!1,!1,!1),t.stencilOp(t.KEEP,t.KEEP,t.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent())},t.prototype._useCurrent=function(){var e=this.renderer.gl;e.colorMask(!0,!0,!0,!0),e.stencilFunc(e.EQUAL,this.getStackLength(),this._getBitwiseMask()),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)},t.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},t}(AbstractMaskSystem),ProjectionSystem=function(e){function t(t){var r=e.call(this,t)||this;return r.destinationFrame=null,r.sourceFrame=null,r.defaultFrame=null,r.projectionMatrix=new Matrix,r.transform=null,r}return __extends3(t,e),t.prototype.update=function(e,t,r,n){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=t||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,r,n),this.transform&&this.projectionMatrix.append(this.transform);var i=this.renderer;i.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,i.globalUniforms.update(),i.shader.shader&&i.shader.syncUniformGroup(i.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(e,t,r,n){var i=this.projectionMatrix,s=n?-1:1;i.identity(),i.a=1/t.width*2,i.d=s*(1/t.height*2),i.tx=-1-t.x*i.a,i.ty=-s-t.y*i.d},t.prototype.setTransform=function(e){},t}(System),tempRect=new Rectangle,tempRect2=new Rectangle,RenderTextureSystem=function(e){function t(t){var r=e.call(this,t)||this;return r.clearColor=t._backgroundColorRgba,r.defaultMaskStack=[],r.current=null,r.sourceFrame=new Rectangle,r.destinationFrame=new Rectangle,r.viewportFrame=new Rectangle,r}return __extends3(t,e),t.prototype.bind=function(e,t,r){void 0===e&&(e=null);var n,i,s,o=this.renderer;this.current=e,e?(s=(n=e.baseTexture).resolution,t||(tempRect.width=e.frame.width,tempRect.height=e.frame.height,t=tempRect),r||(tempRect2.x=e.frame.x,tempRect2.y=e.frame.y,tempRect2.width=t.width,tempRect2.height=t.height,r=tempRect2),i=n.framebuffer):(s=o.resolution,t||(tempRect.width=o.screen.width,tempRect.height=o.screen.height,t=tempRect),r||((r=tempRect).width=t.width,r.height=t.height));var a=this.viewportFrame;a.x=r.x*s,a.y=r.y*s,a.width=r.width*s,a.height=r.height*s,e||(a.y=o.view.height-(a.y+a.height)),this.renderer.framebuffer.bind(i,a),this.renderer.projection.update(r,t,s,!i),e?this.renderer.mask.setMaskStack(n.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(t),this.destinationFrame.copyFrom(r)},t.prototype.clear=function(e,t){e=this.current?e||this.current.baseTexture.clearColor:e||this.clearColor;var r=this.destinationFrame,n=this.current?this.current.baseTexture:this.renderer.screen,i=r.width!==n.width||r.height!==n.height;if(i){var s=this.viewportFrame,o=s.x,a=s.y,l=s.width,h=s.height;this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(o,a,l,h)}this.renderer.framebuffer.clear(e[0],e[1],e[2],e[3],t),i&&this.renderer.scissor.pop()},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t}(System),IGLUniformData=function(){},GLProgram=function(){function e(e,t){this.program=e,this.uniformData=t,this.uniformGroups={}}return e.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null},e}(),UID$4=0,defaultSyncData={textureCount:0},ShaderSystem=function(e){function t(t){var r=e.call(this,t)||this;return r.destroyed=!1,r.systemCheck(),r.gl=null,r.shader=null,r.program=null,r.cache={},r.id=UID$4++,r}return __extends3(t,e),t.prototype.systemCheck=function(){if(!unsafeEvalSupported())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},t.prototype.contextChange=function(e){this.gl=e,this.reset()},t.prototype.bind=function(e,t){e.uniforms.globals=this.renderer.globalUniforms;var r=e.program,n=r.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(e);return this.shader=e,this.program!==r&&(this.program=r,this.gl.useProgram(n.program)),t||(defaultSyncData.textureCount=0,this.syncUniformGroup(e.uniformGroup,defaultSyncData)),n},t.prototype.setUniforms=function(e){var t=this.shader.program,r=t.glPrograms[this.renderer.CONTEXT_UID];t.syncUniforms(r.uniformData,e,this.renderer)},t.prototype.syncUniformGroup=function(e,t){var r=this.getglProgram();(!e.static||e.dirtyId!==r.uniformGroups[e.id])&&(r.uniformGroups[e.id]=e.dirtyId,this.syncUniforms(e,r,t))},t.prototype.syncUniforms=function(e,t,r){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(t.uniformData,e.uniforms,this.renderer,r)},t.prototype.createSyncGroups=function(e){var t=this.getSignature(e,this.shader.program.uniformData);return this.cache[t]||(this.cache[t]=generateUniformsSync(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[t],e.syncUniforms[this.shader.program.id]},t.prototype.getSignature=function(e,t){var r=e.uniforms,n=[];for(var i in r)n.push(i),t[i]&&n.push(t[i].type);return n.join("-")},t.prototype.getglProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},t.prototype.generateShader=function(e){var t=this.gl,r=e.program,n={};for(var i in r.attributeData)n[i]=r.attributeData[i].location;var s=compileProgram(t,r.vertexSrc,r.fragmentSrc,n),o={};for(var i in r.uniformData){var a=r.uniformData[i];o[i]={location:t.getUniformLocation(s,i),value:defaultValue(a.type,a.size)}}var l=new GLProgram(s,o);return r.glPrograms[this.renderer.CONTEXT_UID]=l,l},t.prototype.reset=function(){this.program=null,this.shader=null},t.prototype.destroy=function(){this.destroyed=!0},t}(System);function mapWebGLBlendModesToPixi(e,t){return void 0===t&&(t=[]),t[BLEND_MODES2.NORMAL]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.ADD]=[e.ONE,e.ONE],t[BLEND_MODES2.MULTIPLY]=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.SCREEN]=[e.ONE,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.OVERLAY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.DARKEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.LIGHTEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.COLOR_DODGE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.COLOR_BURN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.HARD_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.SOFT_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.DIFFERENCE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.EXCLUSION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.HUE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.SATURATION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.COLOR]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.LUMINOSITY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.NONE]=[0,0],t[BLEND_MODES2.NORMAL_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.ADD_NPM]=[e.SRC_ALPHA,e.ONE,e.ONE,e.ONE],t[BLEND_MODES2.SCREEN_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.SRC_IN]=[e.DST_ALPHA,e.ZERO],t[BLEND_MODES2.SRC_OUT]=[e.ONE_MINUS_DST_ALPHA,e.ZERO],t[BLEND_MODES2.SRC_ATOP]=[e.DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.DST_OVER]=[e.ONE_MINUS_DST_ALPHA,e.ONE],t[BLEND_MODES2.DST_IN]=[e.ZERO,e.SRC_ALPHA],t[BLEND_MODES2.DST_OUT]=[e.ZERO,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.DST_ATOP]=[e.ONE_MINUS_DST_ALPHA,e.SRC_ALPHA],t[BLEND_MODES2.XOR]=[e.ONE_MINUS_DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.SUBTRACT]=[e.ONE,e.ONE,e.ONE,e.ONE,e.FUNC_REVERSE_SUBTRACT,e.FUNC_ADD],t}var BLEND$1=0,OFFSET$1=1,CULLING$1=2,DEPTH_TEST$1=3,WINDING$1=4,DEPTH_MASK$1=5,StateSystem=function(e){function t(t){var r=e.call(this,t)||this;return r.gl=null,r.stateId=0,r.polygonOffset=0,r.blendMode=BLEND_MODES2.NONE,r._blendEq=!1,r.map=[],r.map[BLEND$1]=r.setBlend,r.map[OFFSET$1]=r.setOffset,r.map[CULLING$1]=r.setCullFace,r.map[DEPTH_TEST$1]=r.setDepthTest,r.map[WINDING$1]=r.setFrontFace,r.map[DEPTH_MASK$1]=r.setDepthMask,r.checks=[],r.defaultState=new State,r.defaultState.blend=!0,r}return __extends3(t,e),t.prototype.contextChange=function(e){this.gl=e,this.blendModes=mapWebGLBlendModesToPixi(e),this.set(this.defaultState),this.reset()},t.prototype.set=function(e){if(e=e||this.defaultState,this.stateId!==e.data){for(var t=this.stateId^e.data,r=0;t;)1&t&&this.map[r].call(this,!!(e.data&1<<r)),t>>=1,r++;this.stateId=e.data}for(r=0;r<this.checks.length;r++)this.checks[r](this,e)},t.prototype.forceState=function(e){e=e||this.defaultState;for(var t=0;t<this.map.length;t++)this.map[t].call(this,!!(e.data&1<<t));for(t=0;t<this.checks.length;t++)this.checks[t](this,e);this.stateId=e.data},t.prototype.setBlend=function(e){this.updateCheck(t.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)},t.prototype.setOffset=function(e){this.updateCheck(t.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},t.prototype.setDepthTest=function(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)},t.prototype.setDepthMask=function(e){this.gl.depthMask(e)},t.prototype.setCullFace=function(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)},t.prototype.setFrontFace=function(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])},t.prototype.setBlendMode=function(e){if(e!==this.blendMode){this.blendMode=e;var t=this.blendModes[e],r=this.gl;2===t.length?r.blendFunc(t[0],t[1]):r.blendFuncSeparate(t[0],t[1],t[2],t[3]),6===t.length?(this._blendEq=!0,r.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}},t.prototype.setPolygonOffset=function(e,t){this.gl.polygonOffset(e,t)},t.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},t.prototype.updateCheck=function(e,t){var r=this.checks.indexOf(e);t&&-1===r?this.checks.push(e):!t&&-1!==r&&this.checks.splice(r,1)},t.checkBlendMode=function(e,t){e.setBlendMode(t.blendMode)},t.checkPolygonOffset=function(e,t){e.setPolygonOffset(1,t.polygonOffset)},t}(System),TextureGCSystem=function(e){function t(t){var r=e.call(this,t)||this;return r.count=0,r.checkCount=0,r.maxIdle=settings.GC_MAX_IDLE,r.checkCountMax=settings.GC_MAX_CHECK_COUNT,r.mode=settings.GC_MODE,r}return __extends3(t,e),t.prototype.postrender=function(){!this.renderer.renderingToScreen||(this.count++,this.mode!==GC_MODES2.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},t.prototype.run=function(){for(var e=this.renderer.texture,t=e.managedTextures,r=!1,n=0;n<t.length;n++){var i=t[n];!i.framebuffer&&this.count-i.touched>this.maxIdle&&(e.destroyTexture(i,!0),t[n]=null,r=!0)}if(r){var s=0;for(n=0;n<t.length;n++)null!==t[n]&&(t[s++]=t[n]);t.length=s}},t.prototype.unload=function(e){var t=this.renderer.texture,r=e._texture;r&&!r.framebuffer&&t.destroyTexture(r);for(var n=e.children.length-1;n>=0;n--)this.unload(e.children[n])},t}(System),GLTexture=function(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121,this.samplerType=0},TextureSystem=function(e){function t(t){var r=e.call(this,t)||this;return r.boundTextures=[],r.currentLocation=-1,r.managedTextures=[],r._unknownBoundTextures=!1,r.unknownTexture=new BaseTexture,r.hasIntegerTextures=!1,r}return __extends3(t,e),t.prototype.contextChange=function(){var e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var t=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=t;for(var r=0;r<t;r++)this.boundTextures[r]=null;this.emptyTextures={};var n=new GLTexture(e.createTexture());for(e.bindTexture(e.TEXTURE_2D,n.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=n,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new GLTexture(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture),r=0;r<6;r++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);for(e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR),r=0;r<this.boundTextures.length;r++)this.bind(null,r)},t.prototype.bind=function(e,t){void 0===t&&(t=0);var r=this.gl;if(e){if((e=e.castToBaseTexture()).parentTextureArray)return;if(e.valid){e.touched=this.renderer.textureGC.count;var n=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[t]!==e&&(this.currentLocation!==t&&(this.currentLocation=t,r.activeTexture(r.TEXTURE0+t)),r.bindTexture(e.target,n.texture)),n.dirtyId!==e.dirtyId&&(this.currentLocation!==t&&(this.currentLocation=t,r.activeTexture(r.TEXTURE0+t)),this.updateTexture(e)),this.boundTextures[t]=e}}else this.currentLocation!==t&&(this.currentLocation=t,r.activeTexture(r.TEXTURE0+t)),r.bindTexture(r.TEXTURE_2D,this.emptyTextures[r.TEXTURE_2D].texture),this.boundTextures[t]=null},t.prototype.reset=function(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(var e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture},t.prototype.unbind=function(e){var t=this.gl,r=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var n=0;n<r.length;n++)r[n]===this.unknownTexture&&this.bind(null,n)}for(n=0;n<r.length;n++)r[n]===e&&(this.currentLocation!==n&&(t.activeTexture(t.TEXTURE0+n),this.currentLocation=n),t.bindTexture(e.target,this.emptyTextures[e.target].texture),r[n]=null)},t.prototype.ensureSamplerType=function(e){var t=this,r=t.boundTextures,n=t.hasIntegerTextures,i=t.CONTEXT_UID;if(n)for(var s=e-1;s>=0;--s){var o=r[s];o&&o._glTextures[i].samplerType!==SAMPLER_TYPES2.FLOAT&&this.renderer.texture.unbind(o)}},t.prototype.initTexture=function(e){var t=new GLTexture(this.gl.createTexture());return t.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=t,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),t},t.prototype.initTextureType=function(e,t){if(t.internalFormat=e.format,t.type=e.type,2===this.webGLVersion){var r=this.renderer.gl;e.type===r.FLOAT&&e.format===r.RGBA&&(t.internalFormat=r.RGBA32F),e.type===TYPES2.HALF_FLOAT&&(t.type=r.HALF_FLOAT),t.type===r.HALF_FLOAT&&e.format===r.RGBA&&(t.internalFormat=r.RGBA16F)}},t.prototype.updateTexture=function(e){var t=e._glTextures[this.CONTEXT_UID];if(t){var r=this.renderer;if(this.initTextureType(e,t),e.resource&&e.resource.upload(r,e,t))t.samplerType!==SAMPLER_TYPES2.FLOAT&&(this.hasIntegerTextures=!0);else{var n=e.realWidth,i=e.realHeight,s=r.gl;(t.width!==n||t.height!==i||t.dirtyId<0)&&(t.width=n,t.height=i,s.texImage2D(e.target,0,t.internalFormat,n,i,0,e.format,t.type,null))}e.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(e),t.dirtyId=e.dirtyId}},t.prototype.destroyTexture=function(e,t){var r=this.gl;if((e=e.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(e),r.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!t)){var n=this.managedTextures.indexOf(e);-1!==n&&removeItems(this.managedTextures,n,1)}},t.prototype.updateTextureStyle=function(e){var t=e._glTextures[this.CONTEXT_UID];!t||(e.mipmap!==MIPMAP_MODES2.POW2&&2===this.webGLVersion||e.isPowerOfTwo?t.mipmap=e.mipmap>=1:t.mipmap=!1,2===this.webGLVersion||e.isPowerOfTwo?t.wrapMode=e.wrapMode:t.wrapMode=WRAP_MODES2.CLAMP,e.resource&&e.resource.style(this.renderer,e,t)||this.setStyle(e,t),t.dirtyStyleId=e.dirtyStyleId)},t.prototype.setStyle=function(e,t){var r=this.gl;if(t.mipmap&&e.mipmap!==MIPMAP_MODES2.ON_MANUAL&&r.generateMipmap(e.target),r.texParameteri(e.target,r.TEXTURE_WRAP_S,t.wrapMode),r.texParameteri(e.target,r.TEXTURE_WRAP_T,t.wrapMode),t.mipmap){r.texParameteri(e.target,r.TEXTURE_MIN_FILTER,e.scaleMode===SCALE_MODES2.LINEAR?r.LINEAR_MIPMAP_LINEAR:r.NEAREST_MIPMAP_NEAREST);var n=this.renderer.context.extensions.anisotropicFiltering;if(n&&e.anisotropicLevel>0&&e.scaleMode===SCALE_MODES2.LINEAR){var i=Math.min(e.anisotropicLevel,r.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT));r.texParameterf(e.target,n.TEXTURE_MAX_ANISOTROPY_EXT,i)}}else r.texParameteri(e.target,r.TEXTURE_MIN_FILTER,e.scaleMode===SCALE_MODES2.LINEAR?r.LINEAR:r.NEAREST);r.texParameteri(e.target,r.TEXTURE_MAG_FILTER,e.scaleMode===SCALE_MODES2.LINEAR?r.LINEAR:r.NEAREST)},t}(System),_systems={__proto__:null,FilterSystem,BatchSystem,ContextSystem,FramebufferSystem,GeometrySystem,MaskSystem,ScissorSystem,StencilSystem,ProjectionSystem,RenderTextureSystem,ShaderSystem,StateSystem,TextureGCSystem,TextureSystem},tempMatrix$1=new Matrix,AbstractRenderer=function(e){function t(t,r){void 0===t&&(t=RENDERER_TYPE2.UNKNOWN);var n=e.call(this)||this;return r=Object.assign({},settings.RENDER_OPTIONS,r),n.options=r,n.type=t,n.screen=new Rectangle(0,0,r.width,r.height),n.view=r.view||document.createElement("canvas"),n.resolution=r.resolution||settings.RESOLUTION,n.useContextAlpha=r.useContextAlpha,n.autoDensity=!!r.autoDensity,n.preserveDrawingBuffer=r.preserveDrawingBuffer,n.clearBeforeRender=r.clearBeforeRender,n._backgroundColor=0,n._backgroundColorRgba=[0,0,0,1],n._backgroundColorString="#000000",n.backgroundColor=r.backgroundColor||n._backgroundColor,n.backgroundAlpha=r.backgroundAlpha,void 0!==r.transparent&&(deprecation("6.0.0","Option transparent is deprecated, please use backgroundAlpha instead."),n.useContextAlpha=r.transparent,n.backgroundAlpha=r.transparent?0:1),n._lastObjectRendered=null,n.plugins={},n}return __extends3(t,e),t.prototype.initPlugins=function(e){for(var t in e)this.plugins[t]=new e[t](this)},Object.defineProperty(t.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),t.prototype.resize=function(e,t){this.screen.width=e,this.screen.height=t,this.view.width=e*this.resolution,this.view.height=t*this.resolution,this.autoDensity&&(this.view.style.width=e+"px",this.view.style.height=t+"px"),this.emit("resize",e,t)},t.prototype.generateTexture=function(e,t,r,n){0===(n=n||e.getLocalBounds(null,!0)).width&&(n.width=1),0===n.height&&(n.height=1);var i=RenderTexture.create({width:0|n.width,height:0|n.height,scaleMode:t,resolution:r});return tempMatrix$1.tx=-n.x,tempMatrix$1.ty=-n.y,this.render(e,{renderTexture:i,clear:!1,transform:tempMatrix$1,skipUpdateTransform:!!e.parent}),i},t.prototype.destroy=function(e){for(var t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null;e&&this.view.parentNode&&this.view.parentNode.removeChild(this.view);var r=this;r.plugins=null,r.type=RENDERER_TYPE2.UNKNOWN,r.view=null,r.screen=null,r._tempDisplayObjectParent=null,r.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(t.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(e){this._backgroundColor=e,this._backgroundColorString=hex2string(e),hex2rgb(e,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"backgroundAlpha",{get:function(){return this._backgroundColorRgba[3]},set:function(e){this._backgroundColorRgba[3]=e},enumerable:!1,configurable:!0}),t}(import_eventemitter3.default),Renderer=function(e){function t(r){var n=e.call(this,RENDERER_TYPE2.WEBGL,r)||this;return r=n.options,n.gl=null,n.CONTEXT_UID=0,n.runners={destroy:new Runner("destroy"),contextChange:new Runner("contextChange"),reset:new Runner("reset"),update:new Runner("update"),postrender:new Runner("postrender"),prerender:new Runner("prerender"),resize:new Runner("resize")},n.globalUniforms=new UniformGroup({projectionMatrix:new Matrix},!0),n.addSystem(MaskSystem,"mask").addSystem(ContextSystem,"context").addSystem(StateSystem,"state").addSystem(ShaderSystem,"shader").addSystem(TextureSystem,"texture").addSystem(GeometrySystem,"geometry").addSystem(FramebufferSystem,"framebuffer").addSystem(ScissorSystem,"scissor").addSystem(StencilSystem,"stencil").addSystem(ProjectionSystem,"projection").addSystem(TextureGCSystem,"textureGC").addSystem(FilterSystem,"filter").addSystem(RenderTextureSystem,"renderTexture").addSystem(BatchSystem,"batch"),n.initPlugins(t.__plugins),r.context?n.context.initFromContext(r.context):n.context.initFromOptions({alpha:!!n.useContextAlpha,antialias:r.antialias,premultipliedAlpha:n.useContextAlpha&&"notMultiplied"!==n.useContextAlpha,stencil:!0,preserveDrawingBuffer:r.preserveDrawingBuffer,powerPreference:n.options.powerPreference}),n.renderingToScreen=!0,sayHello(2===n.context.webGLVersion?"WebGL 2":"WebGL 1"),n.resize(n.options.width,n.options.height),n}return __extends3(t,e),t.create=function(e){if(isWebGLSupported())return new t(e);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},t.prototype.addSystem=function(e,t){t||(t=e.name);var r=new e(this);if(this[t])throw new Error('Whoops! The name "'+t+'" is already in use');for(var n in this[t]=r,this.runners)this.runners[n].add(r);return this},t.prototype.render=function(e,t){var r,n,i,s;if(t&&(t instanceof RenderTexture?(deprecation("6.0.0","Renderer#render arguments changed, use options instead."),r=t,n=arguments[2],i=arguments[3],s=arguments[4]):(r=t.renderTexture,n=t.clear,i=t.transform,s=t.skipUpdateTransform)),this.renderingToScreen=!r,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=i,!this.context.isLost){if(r||(this._lastObjectRendered=e),!s){var o=e.enableTempParent();e.updateTransform(),e.disableTempParent(o)}this.renderTexture.bind(r),this.batch.currentRenderer.start(),(void 0!==n?n:this.clearBeforeRender)&&this.renderTexture.clear(),e.render(this),this.batch.currentRenderer.flush(),r&&r.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},t.prototype.resize=function(t,r){e.prototype.resize.call(this,t,r),this.runners.resize.emit(t,r)},t.prototype.reset=function(){return this.runners.reset.emit(),this},t.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},t.prototype.destroy=function(t){for(var r in this.runners.destroy.emit(),this.runners)this.runners[r].destroy();e.prototype.destroy.call(this,t),this.gl=null},Object.defineProperty(t.prototype,"extract",{get:function(){return deprecation("6.0.0","Renderer#extract has been deprecated, please use Renderer#plugins.extract instead."),this.plugins.extract},enumerable:!1,configurable:!0}),t.registerPlugin=function(e,r){t.__plugins=t.__plugins||{},t.__plugins[e]=r},t}(AbstractRenderer);function autoDetectRenderer(e){return Renderer.create(e)}var $defaultVertex="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",$defaultFilterVertex="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n",defaultVertex$2=$defaultVertex,defaultFilterVertex=$defaultFilterVertex,BatchDrawCall=function(){this.texArray=null,this.blend=0,this.type=DRAW_MODES2.TRIANGLES,this.start=0,this.size=0,this.data=null},BatchTextureArray=function(){function e(){this.elements=[],this.ids=[],this.count=0}return e.prototype.clear=function(){for(var e=0;e<this.count;e++)this.elements[e]=null;this.count=0},e}(),ViewableBuffer=function(){function e(e){"number"==typeof e?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(e.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),e.prototype.view=function(e){return this[e+"View"]},e.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},e.sizeOf=function(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(e+" isn't a valid view type")}},e}(),AbstractBatchRenderer=function(e){function t(t){var r=e.call(this,t)||this;return r.shaderGenerator=null,r.geometryClass=null,r.vertexSize=null,r.state=State.for2d(),r.size=4*settings.SPRITE_BATCH_SIZE,r._vertexCount=0,r._indexCount=0,r._bufferedElements=[],r._bufferedTextures=[],r._bufferSize=0,r._shader=null,r._packedGeometries=[],r._packedGeometryPoolSize=2,r._flushId=0,r._aBuffers={},r._iBuffers={},r.MAX_TEXTURES=1,r.renderer.on("prerender",r.onPrerender,r),t.runners.contextChange.add(r),r._dcIndex=0,r._aIndex=0,r._iIndex=0,r._attributeBuffer=null,r._indexBuffer=null,r._tempBoundTextures=[],r}return __extends3(t,e),t.prototype.contextChange=function(){var e=this.renderer.gl;settings.PREFER_ENV===ENV2.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),settings.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=checkMaxIfStatementsInShader(this.MAX_TEXTURES,e)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]=new this.geometryClass;this.initFlushBuffers()},t.prototype.initFlushBuffers=function(){for(var e=t._drawCallPool,r=t._textureArrayPool,n=this.size/4,i=Math.floor(n/this.MAX_TEXTURES)+1;e.length<n;)e.push(new BatchDrawCall);for(;r.length<i;)r.push(new BatchTextureArray);for(var s=0;s<this.MAX_TEXTURES;s++)this._tempBoundTextures[s]=null},t.prototype.onPrerender=function(){this._flushId=0},t.prototype.render=function(e){!e._texture.valid||(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)},t.prototype.buildTexturesAndDrawCalls=function(){var e=this._bufferedTextures,r=this.MAX_TEXTURES,n=t._textureArrayPool,i=this.renderer.batch,s=this._tempBoundTextures,o=this.renderer.textureGC.count,a=++BaseTexture._globalBatch,l=0,h=n[0],u=0;i.copyBoundTextures(s,r);for(var c=0;c<this._bufferSize;++c){var d=e[c];e[c]=null,d._batchEnabled!==a&&(h.count>=r&&(i.boundArray(h,s,a,r),this.buildDrawCalls(h,u,c),u=c,h=n[++l],++a),d._batchEnabled=a,d.touched=o,h.elements[h.count++]=d)}for(h.count>0&&(i.boundArray(h,s,a,r),this.buildDrawCalls(h,u,this._bufferSize),++l,++a),c=0;c<s.length;c++)s[c]=null;BaseTexture._globalBatch=a},t.prototype.buildDrawCalls=function(e,r,n){var i=this,s=i._bufferedElements,o=i._attributeBuffer,a=i._indexBuffer,l=i.vertexSize,h=t._drawCallPool,u=this._dcIndex,c=this._aIndex,d=this._iIndex,f=h[u];f.start=this._iIndex,f.texArray=e;for(var p=r;p<n;++p){var m=s[p],_=m._texture.baseTexture,g=premultiplyBlendMode[_.alphaMode?1:0][m.blendMode];s[p]=null,r<p&&f.blend!==g&&(f.size=d-f.start,r=p,(f=h[++u]).texArray=e,f.start=d),this.packInterleavedGeometry(m,o,a,c,d),c+=m.vertexData.length/2*l,d+=m.indices.length,f.blend=g}r<n&&(f.size=d-f.start,++u),this._dcIndex=u,this._aIndex=c,this._iIndex=d},t.prototype.bindAndClearTexArray=function(e){for(var t=this.renderer.texture,r=0;r<e.count;r++)t.bind(e.elements[r],e.ids[r]),e.elements[r]=null;e.count=0},t.prototype.updateGeometry=function(){var e=this,t=e._packedGeometries,r=e._attributeBuffer,n=e._indexBuffer;settings.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(r.rawBinaryData),t[this._flushId]._indexBuffer.update(n),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(r.rawBinaryData),t[this._flushId]._indexBuffer.update(n),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},t.prototype.drawBatches=function(){for(var e=this._dcIndex,r=this.renderer,n=r.gl,i=r.state,s=t._drawCallPool,o=null,a=0;a<e;a++){var l=s[a],h=l.texArray,u=l.type,c=l.size,d=l.start,f=l.blend;o!==h&&(o=h,this.bindAndClearTexArray(h)),this.state.blendMode=f,i.set(this.state),n.drawElements(u,c,n.UNSIGNED_SHORT,2*d)}},t.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},t.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.MAX_TEXTURES),this.renderer.shader.bind(this._shader),settings.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},t.prototype.stop=function(){this.flush()},t.prototype.destroy=function(){for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),e.prototype.destroy.call(this)},t.prototype.getAttributeBuffer=function(e){var t=nextPow2(Math.ceil(e/8)),r=log2(t),n=8*t;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);var i=this._aBuffers[n];return i||(this._aBuffers[n]=i=new ViewableBuffer(n*this.vertexSize*4)),i},t.prototype.getIndexBuffer=function(e){var t=nextPow2(Math.ceil(e/12)),r=log2(t),n=12*t;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);var i=this._iBuffers[r];return i||(this._iBuffers[r]=i=new Uint16Array(n)),i},t.prototype.packInterleavedGeometry=function(e,t,r,n,i){for(var s=t.uint32View,o=t.float32View,a=n/this.vertexSize,l=e.uvs,h=e.indices,u=e.vertexData,c=e._texture.baseTexture._batchLocation,d=Math.min(e.worldAlpha,1),f=d<1&&e._texture.baseTexture.alphaMode?premultiplyTint(e._tintRGB,d):e._tintRGB+(255*d<<24),p=0;p<u.length;p+=2)o[n++]=u[p],o[n++]=u[p+1],o[n++]=l[p],o[n++]=l[p+1],s[n++]=f,o[n++]=c;for(p=0;p<h.length;p++)r[i++]=a+h[p]},t._drawCallPool=[],t._textureArrayPool=[],t}(ObjectRenderer),BatchShaderGenerator=function(){function e(e,t){if(this.vertexSrc=e,this.fragTemplate=t,this.programCache={},this.defaultGroupCache={},t.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(t.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}return e.prototype.generateShader=function(e){if(!this.programCache[e]){for(var t=new Int32Array(e),r=0;r<e;r++)t[r]=r;this.defaultGroupCache[e]=UniformGroup.from({uSamplers:t},!0);var n=this.fragTemplate;n=(n=n.replace(/%count%/gi,""+e)).replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new Program(this.vertexSrc,n)}var i={tint:new Float32Array([1,1,1,1]),translationMatrix:new Matrix,default:this.defaultGroupCache[e]};return new Shader(this.programCache[e],i)},e.prototype.generateSampleSrc=function(e){var t="";t+="\n",t+="\n";for(var r=0;r<e;r++)r>0&&(t+="\nelse "),r<e-1&&(t+="if(vTextureId < "+r+".5)"),t+="\n{",t+="\n\tcolor = texture2D(uSamplers["+r+"], vTextureCoord);",t+="\n}";return(t+="\n")+"\n"},e}(),BatchGeometry=function(e){function t(t){void 0===t&&(t=!1);var r=e.call(this)||this;return r._buffer=new Buffer2(null,t,!1),r._indexBuffer=new Buffer2(null,t,!0),r.addAttribute("aVertexPosition",r._buffer,2,!1,TYPES2.FLOAT).addAttribute("aTextureCoord",r._buffer,2,!1,TYPES2.FLOAT).addAttribute("aColor",r._buffer,4,!0,TYPES2.UNSIGNED_BYTE).addAttribute("aTextureId",r._buffer,1,!0,TYPES2.FLOAT).addIndex(r._indexBuffer),r}return __extends3(t,e),t}(Geometry),defaultVertex$3="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",defaultFragment$2="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",BatchPluginFactory=function(){function e(){}return e.create=function(e){var t=Object.assign({vertex:defaultVertex$3,fragment:defaultFragment$2,geometryClass:BatchGeometry,vertexSize:6},e),r=t.vertex,n=t.fragment,i=t.vertexSize,s=t.geometryClass;return function(e){function t(t){var o=e.call(this,t)||this;return o.shaderGenerator=new BatchShaderGenerator(r,n),o.geometryClass=s,o.vertexSize=i,o}return __extends3(t,e),t}(AbstractBatchRenderer)},Object.defineProperty(e,"defaultVertexSrc",{get:function(){return defaultVertex$3},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultFragmentTemplate",{get:function(){return defaultFragment$2},enumerable:!1,configurable:!0}),e}(),BatchRenderer=BatchPluginFactory.create(),resources={},_loop_1=function(e){Object.defineProperty(resources,e,{get:function(){return deprecation("6.0.0","PIXI.systems."+e+" has moved to PIXI."+e),_resources[e]}})};for(var name in _resources)_loop_1(name);var systems={},_loop_2=function(e){Object.defineProperty(systems,e,{get:function(){return deprecation("6.0.0","PIXI.resources."+e+" has moved to PIXI."+e),_systems[e]}})};for(var name in _systems)_loop_2(name);var Application=function(){function e(t){var r=this;this.stage=new Container,t=Object.assign({forceCanvas:!1},t),this.renderer=autoDetectRenderer(t),e._plugins.forEach((function(e){e.init.call(r,t)}))}return e.registerPlugin=function(t){e._plugins.push(t)},e.prototype.render=function(){this.renderer.render(this.stage)},Object.defineProperty(e.prototype,"view",{get:function(){return this.renderer.view},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"screen",{get:function(){return this.renderer.screen},enumerable:!1,configurable:!0}),e.prototype.destroy=function(t,r){var n=this,i=e._plugins.slice(0);i.reverse(),i.forEach((function(e){e.destroy.call(n)})),this.stage.destroy(r),this.stage=null,this.renderer.destroy(t),this.renderer=null},e._plugins=[],e}(),ResizePlugin=function(){function e(){}return e.init=function(e){var t=this;Object.defineProperty(this,"resizeTo",{set:function(e){self.removeEventListener("resize",this.queueResize),this._resizeTo=e,e&&(self.addEventListener("resize",this.queueResize),this.resize())},get:function(){return this._resizeTo}}),this.queueResize=function(){!t._resizeTo||(t.cancelResize(),t._resizeId=requestAnimationFrame((function(){return t.resize()})))},this.cancelResize=function(){t._resizeId&&(cancelAnimationFrame(t._resizeId),t._resizeId=null)},this.resize=function(){if(t._resizeTo){var e,r;if(t.cancelResize(),t._resizeTo===self)e=self.innerWidth,r=self.innerHeight;else{var n=t._resizeTo;e=n.clientWidth,r=n.clientHeight}t.renderer.resize(e,r)}},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null},e.destroy=function(){self.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null},e}();Application.registerPlugin(ResizePlugin);var TEMP_RECT=new Rectangle,BYTES_PER_PIXEL=4,Extract=function(){function e(e){this.renderer=e}return e.prototype.image=function(e,t,r){var n=new Image;return n.src=this.base64(e,t,r),n},e.prototype.base64=function(e,t,r){return this.canvas(e).toDataURL(t,r)},e.prototype.canvas=function(t){var r,n,i,s=this.renderer,o=!1,a=!1;t&&(t instanceof RenderTexture?i=t:(i=this.renderer.generateTexture(t),a=!0)),i?(r=i.baseTexture.resolution,n=i.frame,o=!1,s.renderTexture.bind(i)):(r=this.renderer.resolution,o=!0,(n=TEMP_RECT).width=this.renderer.width,n.height=this.renderer.height,s.renderTexture.bind(null));var l=Math.floor(n.width*r+1e-4),h=Math.floor(n.height*r+1e-4),u=new CanvasRenderTarget(l,h,1),c=new Uint8Array(BYTES_PER_PIXEL*l*h),d=s.gl;d.readPixels(n.x*r,n.y*r,l,h,d.RGBA,d.UNSIGNED_BYTE,c);var f=u.context.getImageData(0,0,l,h);if(e.arrayPostDivide(c,f.data),u.context.putImageData(f,0,0),o){var p=new CanvasRenderTarget(u.width,u.height,1);p.context.scale(1,-1),p.context.drawImage(u.canvas,0,-h),u.destroy(),u=p}return a&&i.destroy(!0),u.canvas},e.prototype.pixels=function(t){var r,n,i,s=this.renderer,o=!1;t&&(t instanceof RenderTexture?i=t:(i=this.renderer.generateTexture(t),o=!0)),i?(r=i.baseTexture.resolution,n=i.frame,s.renderTexture.bind(i)):(r=s.resolution,(n=TEMP_RECT).width=s.width,n.height=s.height,s.renderTexture.bind(null));var a=n.width*r,l=n.height*r,h=new Uint8Array(BYTES_PER_PIXEL*a*l),u=s.gl;return u.readPixels(n.x*r,n.y*r,a,l,u.RGBA,u.UNSIGNED_BYTE,h),o&&i.destroy(!0),e.arrayPostDivide(h,h),h},e.prototype.destroy=function(){this.renderer=null},e.arrayPostDivide=function(e,t){for(var r=0;r<e.length;r+=4){var n=t[r+3]=e[r+3];0!==n?(t[r]=Math.round(Math.min(255*e[r]/n,255)),t[r+1]=Math.round(Math.min(255*e[r+1]/n,255)),t[r+2]=Math.round(Math.min(255*e[r+2]/n,255))):(t[r]=e[r],t[r+1]=e[r+1],t[r+2]=e[r+2])}},e}(),import_parse_uri=__toModule(require_parse_uri()),import_mini_signals=__toModule(require_mini_signals());function _noop(){}function eachSeries(e,t,r,n){var i=0,s=e.length;!function o(a){a||i===s?r&&r(a):n?setTimeout((function(){t(e[i++],o)}),1):t(e[i++],o)}()}function onlyOnce(e){return function(){if(null===e)throw new Error("Callback was already called.");var t=e;e=null,t.apply(this,arguments)}}function queue(e,t){if(null==t)t=1;else if(0===t)throw new Error("Concurrency must not be zero");var r=0,n={_tasks:[],concurrency:t,saturated:_noop,unsaturated:_noop,buffer:t/4,empty:_noop,drain:_noop,error:_noop,started:!1,paused:!1,push:function(e,t){i(e,!1,t)},kill:function(){r=0,n.drain=_noop,n.started=!1,n._tasks=[]},unshift:function(e,t){i(e,!0,t)},process:function(){for(;!n.paused&&r<n.concurrency&&n._tasks.length;){var t=n._tasks.shift();0===n._tasks.length&&n.empty(),(r+=1)===n.concurrency&&n.saturated(),e(t.data,onlyOnce(s(t)))}},length:function(){return n._tasks.length},running:function(){return r},idle:function(){return n._tasks.length+r===0},pause:function(){!0!==n.paused&&(n.paused=!0)},resume:function(){if(!1!==n.paused){n.paused=!1;for(var e=1;e<=n.concurrency;e++)n.process()}}};function i(e,t,r){if(null!=r&&"function"!=typeof r)throw new Error("task callback must be a function");if(n.started=!0,null==e&&n.idle())setTimeout((function(){return n.drain()}),1);else{var i={data:e,callback:"function"==typeof r?r:_noop};t?n._tasks.unshift(i):n._tasks.push(i),setTimeout((function(){return n.process()}),1)}}function s(e){return function(){r-=1,e.callback.apply(e,arguments),null!=arguments[0]&&n.error(arguments[0],e.data),r<=n.concurrency-n.buffer&&n.unsaturated(),n.idle()&&n.drain(),n.process()}}return n}var cache={};function caching(e,t){var r=this;cache[e.url]?(e.data=cache[e.url],e.complete()):e.onComplete.once((function(){return cache[r.url]=r.data})),t()}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}var useXdr=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),tempAnchor2=null,STATUS_NONE=0,STATUS_OK=200,STATUS_EMPTY=204,STATUS_IE_BUG_EMPTY=1223,STATUS_TYPE_OK=2;function _noop$1(){}var Resource2=function(){function e(t,r,n){if("string"!=typeof t||"string"!=typeof r)throw new Error("Both name and url are required for constructing a resource.");n=n||{},this._flags=0,this._setFlag(e.STATUS_FLAGS.DATA_URL,0===r.indexOf("data:")),this.name=t,this.url=r,this.extension=this._getExtension(),this.data=null,this.crossOrigin=!0===n.crossOrigin?"anonymous":n.crossOrigin,this.timeout=n.timeout||0,this.loadType=n.loadType||this._determineLoadType(),this.xhrType=n.xhrType,this.metadata=n.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=e.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=_noop$1,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new import_mini_signals.default,this.onProgress=new import_mini_signals.default,this.onComplete=new import_mini_signals.default,this.onAfterMiddleware=new import_mini_signals.default}e.setExtensionLoadType=function(t,r){setExtMap(e._loadTypeMap,t,r)},e.setExtensionXhrType=function(t,r){setExtMap(e._xhrTypeMap,t,r)};var t=e.prototype;return t.complete=function(){this._clearEvents(),this._finish()},t.abort=function(t){if(!this.error){if(this.error=new Error(t),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=e.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},t.load=function(t){var r=this;if(!this.isLoading){if(this.isComplete)return void(t&&setTimeout((function(){return t(r)}),1));switch(t&&this.onComplete.once(t),this._setFlag(e.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),(!1===this.crossOrigin||"string"!=typeof this.crossOrigin)&&(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case e.LOAD_TYPE.IMAGE:this.type=e.TYPE.IMAGE,this._loadElement("image");break;case e.LOAD_TYPE.AUDIO:this.type=e.TYPE.AUDIO,this._loadSourceElement("audio");break;case e.LOAD_TYPE.VIDEO:this.type=e.TYPE.VIDEO,this._loadSourceElement("video");break;case e.LOAD_TYPE.XHR:default:useXdr&&this.crossOrigin?this._loadXdr():this._loadXhr()}}},t._hasFlag=function(e){return 0!=(this._flags&e)},t._setFlag=function(e,t){this._flags=t?this._flags|e:this._flags&~e},t._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},t._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(e.STATUS_FLAGS.COMPLETE,!0),this._setFlag(e.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},t._loadElement=function(e){this.metadata.loadElement?this.data=this.metadata.loadElement:"image"===e&&void 0!==window.Image?this.data=new Image:this.data=document.createElement(e),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},t._loadSourceElement=function(e){if(this.metadata.loadElement?this.data=this.metadata.loadElement:"audio"===e&&void 0!==window.Audio?this.data=new Audio:this.data=document.createElement(e),null!==this.data){if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var t=this.metadata.mimeType,r=0;r<this.url.length;++r)this.data.appendChild(this._createSource(e,this.url[r],Array.isArray(t)?t[r]:t));else{var n=this.metadata.mimeType;this.data.appendChild(this._createSource(e,this.url,Array.isArray(n)?n[0]:n))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))}else this.abort("Unsupported element: "+e)},t._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XMLHttpRequest;t.open("GET",this.url,!0),t.timeout=this.timeout,this.xhrType===e.XHR_RESPONSE_TYPE.JSON||this.xhrType===e.XHR_RESPONSE_TYPE.DOCUMENT?t.responseType=e.XHR_RESPONSE_TYPE.TEXT:t.responseType=this.xhrType,t.addEventListener("error",this._boundXhrOnError,!1),t.addEventListener("timeout",this._boundXhrOnTimeout,!1),t.addEventListener("abort",this._boundXhrOnAbort,!1),t.addEventListener("progress",this._boundOnProgress,!1),t.addEventListener("load",this._boundXhrOnLoad,!1),t.send()},t._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XDomainRequest;e.timeout=this.timeout||5e3,e.onerror=this._boundXhrOnError,e.ontimeout=this._boundXhrOnTimeout,e.onprogress=this._boundOnProgress,e.onload=this._boundXhrOnLoad,e.open("GET",this.url,!0),setTimeout((function(){return e.send()}),1)},t._createSource=function(e,t,r){r||(r=e+"/"+this._getExtension(t));var n=document.createElement("source");return n.src=t,n.type=r,n},t._onError=function(e){this.abort("Failed to load element using: "+e.target.nodeName)},t._onProgress=function(e){e&&e.lengthComputable&&this.onProgress.dispatch(this,e.loaded/e.total)},t._onTimeout=function(){this.abort("Load timed out.")},t._xhrOnError=function(){var e=this.xhr;this.abort(reqType(e)+" Request failed. Status: "+e.status+', text: "'+e.statusText+'"')},t._xhrOnTimeout=function(){var e=this.xhr;this.abort(reqType(e)+" Request timed out.")},t._xhrOnAbort=function(){var e=this.xhr;this.abort(reqType(e)+" Request was aborted by the user.")},t._xhrOnLoad=function(){var t=this.xhr,r="",n=void 0===t.status?STATUS_OK:t.status;if((""===t.responseType||"text"===t.responseType||void 0===t.responseType)&&(r=t.responseText),n===STATUS_NONE&&(r.length>0||t.responseType===e.XHR_RESPONSE_TYPE.BUFFER)?n=STATUS_OK:n===STATUS_IE_BUG_EMPTY&&(n=STATUS_EMPTY),(n/100|0)===STATUS_TYPE_OK){if(this.xhrType===e.XHR_RESPONSE_TYPE.TEXT)this.data=r,this.type=e.TYPE.TEXT;else if(this.xhrType===e.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(r),this.type=e.TYPE.JSON}catch(e){return void this.abort("Error trying to parse loaded json: "+e)}else if(this.xhrType===e.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var i=new DOMParser;this.data=i.parseFromString(r,"text/xml")}else{var s=document.createElement("div");s.innerHTML=r,this.data=s}this.type=e.TYPE.XML}catch(e){return void this.abort("Error trying to parse loaded xml: "+e)}else this.data=t.response||r;this.complete()}else this.abort("["+t.status+"] "+t.statusText+": "+t.responseURL)},t._determineCrossOrigin=function(e,t){if(0===e.indexOf("data:"))return"";if(window.origin!==window.location.origin)return"anonymous";t=t||window.location,tempAnchor2||(tempAnchor2=document.createElement("a")),tempAnchor2.href=e;var r=!(e=(0,import_parse_uri.default)(tempAnchor2.href,{strictMode:!0})).port&&""===t.port||e.port===t.port,n=e.protocol?e.protocol+":":"";return e.host===t.hostname&&r&&n===t.protocol?"":"anonymous"},t._determineXhrType=function(){return e._xhrTypeMap[this.extension]||e.XHR_RESPONSE_TYPE.TEXT},t._determineLoadType=function(){return e._loadTypeMap[this.extension]||e.LOAD_TYPE.XHR},t._getExtension=function(){var e=this.url,t="";if(this.isDataUrl){var r=e.indexOf("/");t=e.substring(r+1,e.indexOf(";",r))}else{var n=e.indexOf("?"),i=e.indexOf("#"),s=Math.min(n>-1?n:e.length,i>-1?i:e.length);t=(e=e.substring(0,s)).substring(e.lastIndexOf(".")+1)}return t.toLowerCase()},t._getMimeFromXhrType=function(t){switch(t){case e.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case e.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case e.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case e.XHR_RESPONSE_TYPE.JSON:return"application/json";case e.XHR_RESPONSE_TYPE.DEFAULT:case e.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},_createClass(e,[{key:"isDataUrl",get:function(){return this._hasFlag(e.STATUS_FLAGS.DATA_URL)}},{key:"isComplete",get:function(){return this._hasFlag(e.STATUS_FLAGS.COMPLETE)}},{key:"isLoading",get:function(){return this._hasFlag(e.STATUS_FLAGS.LOADING)}}]),e}();function setExtMap(e,t,r){t&&0===t.indexOf(".")&&(t=t.substring(1)),t&&(e[t]=r)}function reqType(e){return e.toString().replace("object ","")}Resource2.STATUS_FLAGS={NONE:0,DATA_URL:1,COMPLETE:2,LOADING:4},Resource2.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6},Resource2.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},Resource2.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},Resource2._loadTypeMap={gif:Resource2.LOAD_TYPE.IMAGE,png:Resource2.LOAD_TYPE.IMAGE,bmp:Resource2.LOAD_TYPE.IMAGE,jpg:Resource2.LOAD_TYPE.IMAGE,jpeg:Resource2.LOAD_TYPE.IMAGE,tif:Resource2.LOAD_TYPE.IMAGE,tiff:Resource2.LOAD_TYPE.IMAGE,webp:Resource2.LOAD_TYPE.IMAGE,tga:Resource2.LOAD_TYPE.IMAGE,svg:Resource2.LOAD_TYPE.IMAGE,"svg+xml":Resource2.LOAD_TYPE.IMAGE,mp3:Resource2.LOAD_TYPE.AUDIO,ogg:Resource2.LOAD_TYPE.AUDIO,wav:Resource2.LOAD_TYPE.AUDIO,mp4:Resource2.LOAD_TYPE.VIDEO,webm:Resource2.LOAD_TYPE.VIDEO},Resource2._xhrTypeMap={xhtml:Resource2.XHR_RESPONSE_TYPE.DOCUMENT,html:Resource2.XHR_RESPONSE_TYPE.DOCUMENT,htm:Resource2.XHR_RESPONSE_TYPE.DOCUMENT,xml:Resource2.XHR_RESPONSE_TYPE.DOCUMENT,tmx:Resource2.XHR_RESPONSE_TYPE.DOCUMENT,svg:Resource2.XHR_RESPONSE_TYPE.DOCUMENT,tsx:Resource2.XHR_RESPONSE_TYPE.DOCUMENT,gif:Resource2.XHR_RESPONSE_TYPE.BLOB,png:Resource2.XHR_RESPONSE_TYPE.BLOB,bmp:Resource2.XHR_RESPONSE_TYPE.BLOB,jpg:Resource2.XHR_RESPONSE_TYPE.BLOB,jpeg:Resource2.XHR_RESPONSE_TYPE.BLOB,tif:Resource2.XHR_RESPONSE_TYPE.BLOB,tiff:Resource2.XHR_RESPONSE_TYPE.BLOB,webp:Resource2.XHR_RESPONSE_TYPE.BLOB,tga:Resource2.XHR_RESPONSE_TYPE.BLOB,json:Resource2.XHR_RESPONSE_TYPE.JSON,text:Resource2.XHR_RESPONSE_TYPE.TEXT,txt:Resource2.XHR_RESPONSE_TYPE.TEXT,ttf:Resource2.XHR_RESPONSE_TYPE.BUFFER,otf:Resource2.XHR_RESPONSE_TYPE.BUFFER},Resource2.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";var _keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function encodeBinary(e){for(var t="",r=0;r<e.length;){for(var n=[0,0,0],i=[0,0,0,0],s=0;s<n.length;++s)r<e.length?n[s]=255&e.charCodeAt(r++):n[s]=0;switch(i[0]=n[0]>>2,i[1]=(3&n[0])<<4|n[1]>>4,i[2]=(15&n[1])<<2|n[2]>>6,i[3]=63&n[2],r-(e.length-1)){case 2:i[3]=64,i[2]=64;break;case 1:i[3]=64}for(var o=0;o<i.length;++o)t+=_keyStr.charAt(i[o])}return t}var Url=window.URL||window.webkitURL;function parsing(e,t){if(e.data){if(e.xhr&&e.xhrType===Resource2.XHR_RESPONSE_TYPE.BLOB)if(window.Blob&&"string"!=typeof e.data){if(0===e.data.type.indexOf("image")){var r=Url.createObjectURL(e.data);return e.blob=e.data,e.data=new Image,e.data.src=r,e.type=Resource2.TYPE.IMAGE,void(e.data.onload=function(){Url.revokeObjectURL(r),e.data.onload=null,t()})}}else{var n=e.xhr.getResponseHeader("content-type");if(n&&0===n.indexOf("image"))return e.data=new Image,e.data.src="data:"+n+";base64,"+encodeBinary(e.xhr.responseText),e.type=Resource2.TYPE.IMAGE,void(e.data.onload=function(){e.data.onload=null,t()})}t()}else t()}var index2={caching,parsing},MAX_PROGRESS=100,rgxExtractUrlHash=/(#[\w-]+)?$/,Loader=function(){function e(t,r){var n=this;void 0===t&&(t=""),void 0===r&&(r=10),this.baseUrl=t,this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(e,t){return n._loadResource(e,t)},this._queue=queue(this._boundLoadResource,r),this._queue.pause(),this.resources={},this.onProgress=new import_mini_signals.default,this.onError=new import_mini_signals.default,this.onLoad=new import_mini_signals.default,this.onStart=new import_mini_signals.default,this.onComplete=new import_mini_signals.default;for(var i=0;i<e._defaultBeforeMiddleware.length;++i)this.pre(e._defaultBeforeMiddleware[i]);for(var s=0;s<e._defaultAfterMiddleware.length;++s)this.use(e._defaultAfterMiddleware[s])}var t=e.prototype;return t.add=function(e,t,r,n){if(Array.isArray(e)){for(var i=0;i<e.length;++i)this.add(e[i]);return this}if("object"==typeof e&&(n=t||e.callback||e.onComplete,r=e,t=e.url,e=e.name||e.key||e.url),"string"!=typeof t&&(n=r,r=t,t=e),"string"!=typeof t)throw new Error("No url passed to add resource to loader.");if("function"==typeof r&&(n=r,r=null),this.loading&&(!r||!r.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[e])throw new Error('Resource named "'+e+'" already exists.');if(t=this._prepareUrl(t),this.resources[e]=new Resource2(e,t,r),"function"==typeof n&&this.resources[e].onAfterMiddleware.once(n),this.loading){for(var s=r.parentResource,o=[],a=0;a<s.children.length;++a)s.children[a].isComplete||o.push(s.children[a]);var l=s.progressChunk*(o.length+1)/(o.length+2);s.children.push(this.resources[e]),s.progressChunk=l;for(var h=0;h<o.length;++h)o[h].progressChunk=l;this.resources[e].progressChunk=l}return this._queue.push(this.resources[e]),this},t.pre=function(e){return this._beforeMiddleware.push(e),this},t.use=function(e){return this._afterMiddleware.push(e),this},t.reset=function(){for(var e in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources){var t=this.resources[e];t._onLoadBinding&&t._onLoadBinding.detach(),t.isLoading&&t.abort()}return this.resources={},this},t.load=function(e){if("function"==typeof e&&this.onComplete.once(e),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var t=this._queue._tasks.length,r=MAX_PROGRESS/t,n=0;n<this._queue._tasks.length;++n)this._queue._tasks[n].data.progressChunk=r;this._onStart(),this._queue.resume()}return this},t._prepareUrl=function(e){var t,r=(0,import_parse_uri.default)(e,{strictMode:!0});if(t=r.protocol||!r.path||0===e.indexOf("//")?e:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==e.charAt(0)?this.baseUrl+"/"+e:this.baseUrl+e,this.defaultQueryString){var n=rgxExtractUrlHash.exec(t)[0];-1!==(t=t.substr(0,t.length-n.length)).indexOf("?")?t+="&"+this.defaultQueryString:t+="?"+this.defaultQueryString,t+=n}return t},t._loadResource=function(e,t){var r=this;e._dequeue=t,eachSeries(this._beforeMiddleware,(function(t,n){t.call(r,e,(function(){n(e.isComplete?{}:null)}))}),(function(){e.isComplete?r._onLoad(e):(e._onLoadBinding=e.onComplete.once(r._onLoad,r),e.load())}),!0)},t._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},t._onComplete=function(){this.progress=MAX_PROGRESS,this.loading=!1,this.onComplete.dispatch(this,this.resources)},t._onLoad=function(e){var t=this;e._onLoadBinding=null,this._resourcesParsing.push(e),e._dequeue(),eachSeries(this._afterMiddleware,(function(r,n){r.call(t,e,n)}),(function(){e.onAfterMiddleware.dispatch(e),t.progress=Math.min(MAX_PROGRESS,t.progress+e.progressChunk),t.onProgress.dispatch(t,e),e.error?t.onError.dispatch(e.error,t,e):t.onLoad.dispatch(t,e),t._resourcesParsing.splice(t._resourcesParsing.indexOf(e),1),t._queue.idle()&&0===t._resourcesParsing.length&&t._onComplete()}),!0)},_createClass(e,[{key:"concurrency",get:function(){return this._queue.concurrency},set:function(e){this._queue.concurrency=e}}]),e}();Loader._defaultBeforeMiddleware=[],Loader._defaultAfterMiddleware=[],Loader.pre=function(e){return Loader._defaultBeforeMiddleware.push(e),Loader},Loader.use=function(e){return Loader._defaultAfterMiddleware.push(e),Loader};var extendStatics4=function(e,t){return extendStatics4=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},extendStatics4(e,t)};function __extends4(e,t){function r(){this.constructor=e}extendStatics4(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var TextureLoader=function(){function e(){}return e.add=function(){Resource2.setExtensionLoadType("svg",Resource2.LOAD_TYPE.XHR),Resource2.setExtensionXhrType("svg",Resource2.XHR_RESPONSE_TYPE.TEXT)},e.use=function(e,t){if(!e.data||e.type!==Resource2.TYPE.IMAGE&&"svg"!==e.extension)t();else{var r=e.data,n=e.url,i=e.name,s=e.metadata;Texture.fromLoader(r,n,i,s).then((function(r){e.texture=r,t()})).catch(t)}},e}(),Loader2=function(e){function t(r,n){for(var i=e.call(this,r,n)||this,s=0;s<t._plugins.length;++s){var o=t._plugins[s],a=o.pre,l=o.use;a&&i.pre(a),l&&i.use(l)}return i._protected=!1,i}return __extends4(t,e),t.prototype.destroy=function(){this._protected||this.reset()},Object.defineProperty(t,"shared",{get:function(){var e=t._shared;return e||((e=new t)._protected=!0,t._shared=e),e},enumerable:!1,configurable:!0}),t.registerPlugin=function(e){return t._plugins.push(e),e.add&&e.add(),t},t._plugins=[],t}(Loader);Loader2.registerPlugin({use:index2.parsing}),Loader2.registerPlugin(TextureLoader);var AppLoaderPlugin=function(){function e(){}return e.init=function(e){e=Object.assign({sharedLoader:!1},e),this.loader=e.sharedLoader?Loader2.shared:new Loader2},e.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},e}(),LoaderResource=Resource2,_a,INTERNAL_FORMATS,INTERNAL_FORMATS2;INTERNAL_FORMATS2=INTERNAL_FORMATS||(INTERNAL_FORMATS={}),INTERNAL_FORMATS2[INTERNAL_FORMATS2.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",INTERNAL_FORMATS2[INTERNAL_FORMATS2.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",INTERNAL_FORMATS2[INTERNAL_FORMATS2.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",INTERNAL_FORMATS2[INTERNAL_FORMATS2.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",INTERNAL_FORMATS2[INTERNAL_FORMATS2.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",INTERNAL_FORMATS2[INTERNAL_FORMATS2.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",INTERNAL_FORMATS2[INTERNAL_FORMATS2.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",INTERNAL_FORMATS2[INTERNAL_FORMATS2.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",INTERNAL_FORMATS2[INTERNAL_FORMATS2.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",INTERNAL_FORMATS2[INTERNAL_FORMATS2.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",INTERNAL_FORMATS2[INTERNAL_FORMATS2.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",INTERNAL_FORMATS2[INTERNAL_FORMATS2.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",INTERNAL_FORMATS2[INTERNAL_FORMATS2.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",INTERNAL_FORMATS2[INTERNAL_FORMATS2.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",INTERNAL_FORMATS2[INTERNAL_FORMATS2.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",INTERNAL_FORMATS2[INTERNAL_FORMATS2.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",INTERNAL_FORMATS2[INTERNAL_FORMATS2.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",INTERNAL_FORMATS2[INTERNAL_FORMATS2.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",INTERNAL_FORMATS2[INTERNAL_FORMATS2.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",INTERNAL_FORMATS2[INTERNAL_FORMATS2.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",INTERNAL_FORMATS2[INTERNAL_FORMATS2.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",INTERNAL_FORMATS2[INTERNAL_FORMATS2.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",INTERNAL_FORMATS2[INTERNAL_FORMATS2.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",INTERNAL_FORMATS2[INTERNAL_FORMATS2.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",INTERNAL_FORMATS2[INTERNAL_FORMATS2.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",INTERNAL_FORMATS2[INTERNAL_FORMATS2.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL";var INTERNAL_FORMAT_TO_BYTES_PER_PIXEL=(_a={},_a[INTERNAL_FORMATS.COMPRESSED_RGB_S3TC_DXT1_EXT]=.5,_a[INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT]=.5,_a[INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT]=1,_a[INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT]=1,_a[INTERNAL_FORMATS.COMPRESSED_SRGB_S3TC_DXT1_EXT]=.5,_a[INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT]=.5,_a[INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT]=1,_a[INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT]=1,_a[INTERNAL_FORMATS.COMPRESSED_R11_EAC]=.5,_a[INTERNAL_FORMATS.COMPRESSED_SIGNED_R11_EAC]=.5,_a[INTERNAL_FORMATS.COMPRESSED_RG11_EAC]=1,_a[INTERNAL_FORMATS.COMPRESSED_SIGNED_RG11_EAC]=1,_a[INTERNAL_FORMATS.COMPRESSED_RGB8_ETC2]=.5,_a[INTERNAL_FORMATS.COMPRESSED_RGBA8_ETC2_EAC]=1,_a[INTERNAL_FORMATS.COMPRESSED_SRGB8_ETC2]=.5,_a[INTERNAL_FORMATS.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC]=1,_a[INTERNAL_FORMATS.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,_a[INTERNAL_FORMATS.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,_a[INTERNAL_FORMATS.COMPRESSED_RGB_PVRTC_4BPPV1_IMG]=.5,_a[INTERNAL_FORMATS.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG]=.5,_a[INTERNAL_FORMATS.COMPRESSED_RGB_PVRTC_2BPPV1_IMG]=.25,_a[INTERNAL_FORMATS.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG]=.25,_a[INTERNAL_FORMATS.COMPRESSED_RGB_ETC1_WEBGL]=.5,_a[INTERNAL_FORMATS.COMPRESSED_RGB_ATC_WEBGL]=.5,_a[INTERNAL_FORMATS.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL]=1,_a[INTERNAL_FORMATS.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL]=1,_a),extendStatics5=function(e,t){return extendStatics5=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},extendStatics5(e,t)};function __extends5(e,t){function r(){this.constructor=e}extendStatics5(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function __awaiter(e,t,r,n){return new(r||(r=Promise))((function(i,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){e.done?i(e.value):new r((function(t){t(e.value)})).then(o,a)}l((n=n.apply(e,t||[])).next())}))}function __generator(e,t){var r,n,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}var BlobResource=function(e){function t(t,r){void 0===r&&(r={width:1,height:1,autoLoad:!0});var n,i,s=this;return"string"==typeof t?(n=t,i=new Uint8Array):(n=null,i=t),(s=e.call(this,i,r)||this).origin=n,s.buffer=i?new ViewableBuffer(i):null,s.origin&&!1!==r.autoLoad&&s.load(),i&&i.length&&(s.loaded=!0,s.onBlobLoaded(s.buffer.rawBinaryData)),s}return __extends5(t,e),t.prototype.onBlobLoaded=function(e){},t.prototype.load=function(){return __awaiter(this,void 0,Promise,(function(){var e;return __generator(this,(function(t){switch(t.label){case 0:return[4,fetch(this.origin)];case 1:return[4,t.sent().blob()];case 2:return[4,t.sent().arrayBuffer()];case 3:return e=t.sent(),this.data=new Uint32Array(e),this.buffer=new ViewableBuffer(e),this.loaded=!0,this.onBlobLoaded(e),this.update(),[2,this]}}))}))},t}(BufferResource),CompressedTextureResource=function(e){function t(r,n){var i=e.call(this,r,n)||this;return i.format=n.format,i.levels=n.levels||1,i._width=n.width,i._height=n.height,i._extension=t._formatToExtension(i.format),(n.levelBuffers||i.buffer)&&(i._levelBuffers=n.levelBuffers||t._createLevelBuffers(r instanceof Uint8Array?r:i.buffer.uint8View,i.format,i.levels,4,4,i.width,i.height)),i}return __extends5(t,e),t.prototype.upload=function(e,t,r){var n=e.gl;if(!e.context.extensions[this._extension])throw new Error(this._extension+" textures are not supported on the current machine");if(!this._levelBuffers)return!1;for(var i=0,s=this.levels;i<s;i++){var o=this._levelBuffers[i],a=o.levelID,l=o.levelWidth,h=o.levelHeight,u=o.levelBuffer;n.compressedTexImage2D(n.TEXTURE_2D,a,this.format,l,h,0,u)}return!0},t.prototype.onBlobLoaded=function(){this._levelBuffers=t._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)},t._formatToExtension=function(e){if(e>=33776&&e<=33779)return"s3tc";if(e>=37488&&e<=37497)return"etc";if(e>=35840&&e<=35843)return"pvrtc";if(e>=36196)return"etc1";if(e>=35986&&e<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")},t._createLevelBuffers=function(e,t,r,n,i,s,o){for(var a=new Array(r),l=e.byteOffset,h=s,u=o,c=h+n-1&~(n-1),d=u+i-1&~(i-1),f=c*d*INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[t],p=0;p<r;p++)a[p]={levelID:p,levelWidth:r>1?h:c,levelHeight:r>1?u:d,levelBuffer:new Uint8Array(e.buffer,l,f)},l+=f,f=(c=(h=h>>1||1)+n-1&~(n-1))*(d=(u=u>>1||1)+i-1&~(i-1))*INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[t];return a},t}(BlobResource),CompressedTextureLoader=function(){function e(){}return e.use=function(t,r){var n=t.data;if(t.type===LoaderResource.TYPE.JSON&&n&&n.cacheID&&n.textures){for(var i=n.textures,s=void 0,o=void 0,a=0,l=i.length;a<l;a++){var h=i[a],u=h.src,c=h.format;if(c||(o=u),e.textureFormats[c]){s=u;break}}if(!(s=s||o))return void r(new Error("Cannot load compressed-textures in "+t.url+", make sure you provide a fallback"));if(s===t.url)return void r(new Error("URL of compressed texture cannot be the same as the manifest's URL"));var d={crossOrigin:t.crossOrigin,metadata:t.metadata.imageMetadata,parentResource:t},f=url.resolve(t.url.replace(this.baseUrl,""),s),p=n.cacheID;this.add(p,f,d,(function(e){if(e.error)r(e.error);else{var n=e.texture,i=void 0===n?null:n,s=e.textures,o=void 0===s?{}:s;Object.assign(t,{texture:i,textures:o}),r()}}))}else r()},e.add=function(){var t=document.createElement("canvas").getContext("webgl");if(t){var r={s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};for(var n in e.textureExtensions=r,e.textureFormats={},r){var i=r[n];!i||Object.assign(e.textureFormats,Object.getPrototypeOf(i))}}else console.error("WebGL not available for compressed textures. Silently failing.")},e}(),_a$1,_b;function registerCompressedTextures(e,t,r){var n={textures:{},texture:null};return t?(t.map((function(e){return new Texture(new BaseTexture(e,Object.assign({mipmap:MIPMAP_MODES2.OFF,alphaMode:ALPHA_MODES2.NO_PREMULTIPLIED_ALPHA},r)))})).forEach((function(t,r){var i=t.baseTexture,s=e+"-"+(r+1);BaseTexture.addToCache(i,s),Texture.addToCache(t,s),0===r&&(BaseTexture.addToCache(i,e),Texture.addToCache(t,e),n.texture=t),n.textures[s]=t})),n):n}LoaderResource.setExtensionXhrType("dds",LoaderResource.XHR_RESPONSE_TYPE.BUFFER);var DDS_MAGIC_SIZE=4,DDS_HEADER_SIZE=124,DDS_HEADER_PF_SIZE=32,DDS_HEADER_DX10_SIZE=20,DDS_MAGIC=542327876,DDS_FIELDS={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},DDS_PF_FIELDS={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},DDS_DX10_FIELDS={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},DXGI_FORMAT,DXGI_FORMAT2,D3D10_RESOURCE_DIMENSION,D3D10_RESOURCE_DIMENSION2;DXGI_FORMAT2=DXGI_FORMAT||(DXGI_FORMAT={}),DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_UNKNOWN=0]="DXGI_FORMAT_UNKNOWN",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R32G32B32A32_TYPELESS=1]="DXGI_FORMAT_R32G32B32A32_TYPELESS",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R32G32B32A32_FLOAT=2]="DXGI_FORMAT_R32G32B32A32_FLOAT",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R32G32B32A32_UINT=3]="DXGI_FORMAT_R32G32B32A32_UINT",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R32G32B32A32_SINT=4]="DXGI_FORMAT_R32G32B32A32_SINT",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R32G32B32_TYPELESS=5]="DXGI_FORMAT_R32G32B32_TYPELESS",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R32G32B32_FLOAT=6]="DXGI_FORMAT_R32G32B32_FLOAT",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R32G32B32_UINT=7]="DXGI_FORMAT_R32G32B32_UINT",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R32G32B32_SINT=8]="DXGI_FORMAT_R32G32B32_SINT",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R16G16B16A16_TYPELESS=9]="DXGI_FORMAT_R16G16B16A16_TYPELESS",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R16G16B16A16_FLOAT=10]="DXGI_FORMAT_R16G16B16A16_FLOAT",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R16G16B16A16_UNORM=11]="DXGI_FORMAT_R16G16B16A16_UNORM",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R16G16B16A16_UINT=12]="DXGI_FORMAT_R16G16B16A16_UINT",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R16G16B16A16_SNORM=13]="DXGI_FORMAT_R16G16B16A16_SNORM",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R16G16B16A16_SINT=14]="DXGI_FORMAT_R16G16B16A16_SINT",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R32G32_TYPELESS=15]="DXGI_FORMAT_R32G32_TYPELESS",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R32G32_FLOAT=16]="DXGI_FORMAT_R32G32_FLOAT",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R32G32_UINT=17]="DXGI_FORMAT_R32G32_UINT",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R32G32_SINT=18]="DXGI_FORMAT_R32G32_SINT",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R32G8X24_TYPELESS=19]="DXGI_FORMAT_R32G8X24_TYPELESS",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_D32_FLOAT_S8X24_UINT=20]="DXGI_FORMAT_D32_FLOAT_S8X24_UINT",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS=21]="DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_X32_TYPELESS_G8X24_UINT=22]="DXGI_FORMAT_X32_TYPELESS_G8X24_UINT",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R10G10B10A2_TYPELESS=23]="DXGI_FORMAT_R10G10B10A2_TYPELESS",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R10G10B10A2_UNORM=24]="DXGI_FORMAT_R10G10B10A2_UNORM",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R10G10B10A2_UINT=25]="DXGI_FORMAT_R10G10B10A2_UINT",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R11G11B10_FLOAT=26]="DXGI_FORMAT_R11G11B10_FLOAT",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R8G8B8A8_TYPELESS=27]="DXGI_FORMAT_R8G8B8A8_TYPELESS",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R8G8B8A8_UNORM=28]="DXGI_FORMAT_R8G8B8A8_UNORM",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R8G8B8A8_UNORM_SRGB=29]="DXGI_FORMAT_R8G8B8A8_UNORM_SRGB",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R8G8B8A8_UINT=30]="DXGI_FORMAT_R8G8B8A8_UINT",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R8G8B8A8_SNORM=31]="DXGI_FORMAT_R8G8B8A8_SNORM",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R8G8B8A8_SINT=32]="DXGI_FORMAT_R8G8B8A8_SINT",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R16G16_TYPELESS=33]="DXGI_FORMAT_R16G16_TYPELESS",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R16G16_FLOAT=34]="DXGI_FORMAT_R16G16_FLOAT",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R16G16_UNORM=35]="DXGI_FORMAT_R16G16_UNORM",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R16G16_UINT=36]="DXGI_FORMAT_R16G16_UINT",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R16G16_SNORM=37]="DXGI_FORMAT_R16G16_SNORM",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R16G16_SINT=38]="DXGI_FORMAT_R16G16_SINT",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R32_TYPELESS=39]="DXGI_FORMAT_R32_TYPELESS",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_D32_FLOAT=40]="DXGI_FORMAT_D32_FLOAT",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R32_FLOAT=41]="DXGI_FORMAT_R32_FLOAT",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R32_UINT=42]="DXGI_FORMAT_R32_UINT",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R32_SINT=43]="DXGI_FORMAT_R32_SINT",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R24G8_TYPELESS=44]="DXGI_FORMAT_R24G8_TYPELESS",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_D24_UNORM_S8_UINT=45]="DXGI_FORMAT_D24_UNORM_S8_UINT",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R24_UNORM_X8_TYPELESS=46]="DXGI_FORMAT_R24_UNORM_X8_TYPELESS",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_X24_TYPELESS_G8_UINT=47]="DXGI_FORMAT_X24_TYPELESS_G8_UINT",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R8G8_TYPELESS=48]="DXGI_FORMAT_R8G8_TYPELESS",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R8G8_UNORM=49]="DXGI_FORMAT_R8G8_UNORM",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R8G8_UINT=50]="DXGI_FORMAT_R8G8_UINT",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R8G8_SNORM=51]="DXGI_FORMAT_R8G8_SNORM",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R8G8_SINT=52]="DXGI_FORMAT_R8G8_SINT",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R16_TYPELESS=53]="DXGI_FORMAT_R16_TYPELESS",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R16_FLOAT=54]="DXGI_FORMAT_R16_FLOAT",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_D16_UNORM=55]="DXGI_FORMAT_D16_UNORM",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R16_UNORM=56]="DXGI_FORMAT_R16_UNORM",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R16_UINT=57]="DXGI_FORMAT_R16_UINT",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R16_SNORM=58]="DXGI_FORMAT_R16_SNORM",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R16_SINT=59]="DXGI_FORMAT_R16_SINT",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R8_TYPELESS=60]="DXGI_FORMAT_R8_TYPELESS",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R8_UNORM=61]="DXGI_FORMAT_R8_UNORM",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R8_UINT=62]="DXGI_FORMAT_R8_UINT",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R8_SNORM=63]="DXGI_FORMAT_R8_SNORM",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R8_SINT=64]="DXGI_FORMAT_R8_SINT",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_A8_UNORM=65]="DXGI_FORMAT_A8_UNORM",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R1_UNORM=66]="DXGI_FORMAT_R1_UNORM",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R9G9B9E5_SHAREDEXP=67]="DXGI_FORMAT_R9G9B9E5_SHAREDEXP",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R8G8_B8G8_UNORM=68]="DXGI_FORMAT_R8G8_B8G8_UNORM",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_G8R8_G8B8_UNORM=69]="DXGI_FORMAT_G8R8_G8B8_UNORM",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_BC1_TYPELESS=70]="DXGI_FORMAT_BC1_TYPELESS",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_BC1_UNORM=71]="DXGI_FORMAT_BC1_UNORM",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_BC1_UNORM_SRGB=72]="DXGI_FORMAT_BC1_UNORM_SRGB",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_BC2_TYPELESS=73]="DXGI_FORMAT_BC2_TYPELESS",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_BC2_UNORM=74]="DXGI_FORMAT_BC2_UNORM",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_BC2_UNORM_SRGB=75]="DXGI_FORMAT_BC2_UNORM_SRGB",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_BC3_TYPELESS=76]="DXGI_FORMAT_BC3_TYPELESS",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_BC3_UNORM=77]="DXGI_FORMAT_BC3_UNORM",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_BC3_UNORM_SRGB=78]="DXGI_FORMAT_BC3_UNORM_SRGB",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_BC4_TYPELESS=79]="DXGI_FORMAT_BC4_TYPELESS",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_BC4_UNORM=80]="DXGI_FORMAT_BC4_UNORM",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_BC4_SNORM=81]="DXGI_FORMAT_BC4_SNORM",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_BC5_TYPELESS=82]="DXGI_FORMAT_BC5_TYPELESS",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_BC5_UNORM=83]="DXGI_FORMAT_BC5_UNORM",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_BC5_SNORM=84]="DXGI_FORMAT_BC5_SNORM",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_B5G6R5_UNORM=85]="DXGI_FORMAT_B5G6R5_UNORM",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_B5G5R5A1_UNORM=86]="DXGI_FORMAT_B5G5R5A1_UNORM",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_B8G8R8A8_UNORM=87]="DXGI_FORMAT_B8G8R8A8_UNORM",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_B8G8R8X8_UNORM=88]="DXGI_FORMAT_B8G8R8X8_UNORM",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM=89]="DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_B8G8R8A8_TYPELESS=90]="DXGI_FORMAT_B8G8R8A8_TYPELESS",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_B8G8R8A8_UNORM_SRGB=91]="DXGI_FORMAT_B8G8R8A8_UNORM_SRGB",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_B8G8R8X8_TYPELESS=92]="DXGI_FORMAT_B8G8R8X8_TYPELESS",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_B8G8R8X8_UNORM_SRGB=93]="DXGI_FORMAT_B8G8R8X8_UNORM_SRGB",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_BC6H_TYPELESS=94]="DXGI_FORMAT_BC6H_TYPELESS",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_BC6H_UF16=95]="DXGI_FORMAT_BC6H_UF16",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_BC6H_SF16=96]="DXGI_FORMAT_BC6H_SF16",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_BC7_TYPELESS=97]="DXGI_FORMAT_BC7_TYPELESS",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_BC7_UNORM=98]="DXGI_FORMAT_BC7_UNORM",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_BC7_UNORM_SRGB=99]="DXGI_FORMAT_BC7_UNORM_SRGB",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_AYUV=100]="DXGI_FORMAT_AYUV",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_Y410=101]="DXGI_FORMAT_Y410",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_Y416=102]="DXGI_FORMAT_Y416",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_NV12=103]="DXGI_FORMAT_NV12",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_P010=104]="DXGI_FORMAT_P010",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_P016=105]="DXGI_FORMAT_P016",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_420_OPAQUE=106]="DXGI_FORMAT_420_OPAQUE",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_YUY2=107]="DXGI_FORMAT_YUY2",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_Y210=108]="DXGI_FORMAT_Y210",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_Y216=109]="DXGI_FORMAT_Y216",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_NV11=110]="DXGI_FORMAT_NV11",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_AI44=111]="DXGI_FORMAT_AI44",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_IA44=112]="DXGI_FORMAT_IA44",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_P8=113]="DXGI_FORMAT_P8",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_A8P8=114]="DXGI_FORMAT_A8P8",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_B4G4R4A4_UNORM=115]="DXGI_FORMAT_B4G4R4A4_UNORM",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_P208=116]="DXGI_FORMAT_P208",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_V208=117]="DXGI_FORMAT_V208",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_V408=118]="DXGI_FORMAT_V408",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE=119]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE=120]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE",DXGI_FORMAT2[DXGI_FORMAT2.DXGI_FORMAT_FORCE_UINT=121]="DXGI_FORMAT_FORCE_UINT",D3D10_RESOURCE_DIMENSION2=D3D10_RESOURCE_DIMENSION||(D3D10_RESOURCE_DIMENSION={}),D3D10_RESOURCE_DIMENSION2[D3D10_RESOURCE_DIMENSION2.DDS_DIMENSION_TEXTURE1D=2]="DDS_DIMENSION_TEXTURE1D",D3D10_RESOURCE_DIMENSION2[D3D10_RESOURCE_DIMENSION2.DDS_DIMENSION_TEXTURE2D=3]="DDS_DIMENSION_TEXTURE2D",D3D10_RESOURCE_DIMENSION2[D3D10_RESOURCE_DIMENSION2.DDS_DIMENSION_TEXTURE3D=6]="DDS_DIMENSION_TEXTURE3D";var PF_FLAGS=1,DDPF_ALPHA=2,DDPF_FOURCC=4,DDPF_RGB=64,DDPF_YUV=512,DDPF_LUMINANCE=131072,FOURCC_DXT1=827611204,FOURCC_DXT3=861165636,FOURCC_DXT5=894720068,FOURCC_DX10=808540228,DDS_RESOURCE_MISC_TEXTURECUBE=4,FOURCC_TO_FORMAT=(_a$1={},_a$1[FOURCC_DXT1]=INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT,_a$1[FOURCC_DXT3]=INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT,_a$1[FOURCC_DXT5]=INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT,_a$1),DXGI_TO_FORMAT=(_b={},_b[DXGI_FORMAT.DXGI_FORMAT_BC1_TYPELESS]=INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT,_b[DXGI_FORMAT.DXGI_FORMAT_BC1_UNORM]=INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT,_b[DXGI_FORMAT.DXGI_FORMAT_BC2_TYPELESS]=INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT,_b[DXGI_FORMAT.DXGI_FORMAT_BC2_UNORM]=INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT,_b[DXGI_FORMAT.DXGI_FORMAT_BC3_TYPELESS]=INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT,_b[DXGI_FORMAT.DXGI_FORMAT_BC3_UNORM]=INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT,_b[DXGI_FORMAT.DXGI_FORMAT_BC1_UNORM_SRGB]=INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,_b[DXGI_FORMAT.DXGI_FORMAT_BC2_UNORM_SRGB]=INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,_b[DXGI_FORMAT.DXGI_FORMAT_BC3_UNORM_SRGB]=INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,_b),DDSLoader=function(){function e(){}return e.use=function(t,r){if("dds"===t.extension&&t.data)try{Object.assign(t,registerCompressedTextures(t.name||t.url,e.parse(t.data),t.metadata))}catch(e){return void r(e)}r()},e.parse=function(e){var t=new Uint32Array(e);if(t[0]!==DDS_MAGIC)throw new Error("Invalid DDS file magic word");var r=new Uint32Array(e,0,DDS_HEADER_SIZE/Uint32Array.BYTES_PER_ELEMENT),n=r[DDS_FIELDS.HEIGHT],i=r[DDS_FIELDS.WIDTH],s=r[DDS_FIELDS.MIPMAP_COUNT],o=new Uint32Array(e,DDS_FIELDS.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,DDS_HEADER_PF_SIZE/Uint32Array.BYTES_PER_ELEMENT),a=o[PF_FLAGS];if(a&DDPF_FOURCC){var l=o[DDS_PF_FIELDS.FOURCC];if(l!==FOURCC_DX10){var h=FOURCC_TO_FORMAT[l],u=new Uint8Array(e,DDS_MAGIC_SIZE+DDS_HEADER_SIZE);return[new CompressedTextureResource(u,{format:h,width:i,height:n,levels:s})]}var c=DDS_MAGIC_SIZE+DDS_HEADER_SIZE,d=new Uint32Array(t.buffer,c,DDS_HEADER_DX10_SIZE/Uint32Array.BYTES_PER_ELEMENT),f=d[DDS_DX10_FIELDS.DXGI_FORMAT],p=d[DDS_DX10_FIELDS.RESOURCE_DIMENSION],m=d[DDS_DX10_FIELDS.MISC_FLAG],_=d[DDS_DX10_FIELDS.ARRAY_SIZE],g=DXGI_TO_FORMAT[f];if(void 0===g)throw new Error("DDSLoader cannot parse texture data with DXGI format "+f);if(m===DDS_RESOURCE_MISC_TEXTURECUBE)throw new Error("DDSLoader does not support cubemap textures");if(p===D3D10_RESOURCE_DIMENSION.DDS_DIMENSION_TEXTURE3D)throw new Error("DDSLoader does not supported 3D texture data");var v=new Array,y=DDS_MAGIC_SIZE+DDS_HEADER_SIZE+DDS_HEADER_DX10_SIZE;if(1===_)v.push(new Uint8Array(e,y));else{for(var b=INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[g],x=0,S=i,T=n,E=0;E<s;E++)x+=Math.max(1,S+3&-4)*Math.max(1,T+3&-4)*b,S>>>=1,T>>>=1;var A=y;for(E=0;E<_;E++)v.push(new Uint8Array(e,A,x)),A+=x}return v.map((function(e){return new CompressedTextureResource(e,{format:g,width:i,height:n,levels:s})}))}throw a&DDPF_RGB?new Error("DDSLoader does not support uncompressed texture data."):a&DDPF_YUV?new Error("DDSLoader does not supported YUV uncompressed texture data."):a&DDPF_LUMINANCE?new Error("DDSLoader does not support single-channel (lumninance) texture data!"):a&DDPF_ALPHA?new Error("DDSLoader does not support single-channel (alpha) texture data!"):new Error("DDSLoader failed to load a texture file due to an unknown reason!")},e}(),_a$2,_b$1,_c;LoaderResource.setExtensionXhrType("ktx",LoaderResource.XHR_RESPONSE_TYPE.BUFFER);var FILE_IDENTIFIER=[171,75,84,88,32,49,49,187,13,10,26,10],ENDIANNESS=67305985,KTX_FIELDS={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},FILE_HEADER_SIZE=64,TYPES_TO_BYTES_PER_COMPONENT=(_a$2={},_a$2[TYPES2.UNSIGNED_BYTE]=1,_a$2[TYPES2.UNSIGNED_SHORT]=2,_a$2[TYPES2.FLOAT]=4,_a$2[TYPES2.HALF_FLOAT]=8,_a$2),FORMATS_TO_COMPONENTS=(_b$1={},_b$1[FORMATS2.RGBA]=4,_b$1[FORMATS2.RGB]=3,_b$1[FORMATS2.LUMINANCE]=1,_b$1[FORMATS2.LUMINANCE_ALPHA]=2,_b$1[FORMATS2.ALPHA]=1,_b$1),TYPES_TO_BYTES_PER_PIXEL=(_c={},_c[TYPES2.UNSIGNED_SHORT_4_4_4_4]=2,_c[TYPES2.UNSIGNED_SHORT_5_5_5_1]=2,_c[TYPES2.UNSIGNED_SHORT_5_6_5]=2,_c),KTXLoader=function(){function e(){}return e.use=function(t,r){if("ktx"===t.extension&&t.data)try{var n=t.name||t.url;Object.assign(t,registerCompressedTextures(n,e.parse(n,t.data),t.metadata))}catch(e){return void r(e)}r()},e.parse=function(t,r){var n=new DataView(r);if(!e.validate(t,n))return null;var i=n.getUint32(KTX_FIELDS.ENDIANNESS,!0)===ENDIANNESS,s=n.getUint32(KTX_FIELDS.GL_TYPE,i),o=n.getUint32(KTX_FIELDS.GL_FORMAT,i),a=n.getUint32(KTX_FIELDS.GL_INTERNAL_FORMAT,i),l=n.getUint32(KTX_FIELDS.PIXEL_WIDTH,i),h=n.getUint32(KTX_FIELDS.PIXEL_HEIGHT,i)||1,u=n.getUint32(KTX_FIELDS.PIXEL_DEPTH,i)||1,c=n.getUint32(KTX_FIELDS.NUMBER_OF_ARRAY_ELEMENTS,i)||1,d=n.getUint32(KTX_FIELDS.NUMBER_OF_FACES,i),f=n.getUint32(KTX_FIELDS.NUMBER_OF_MIPMAP_LEVELS,i),p=n.getUint32(KTX_FIELDS.BYTES_OF_KEY_VALUE_DATA,i);if(0===h||1!==u)throw new Error("Only 2D textures are supported");if(1!==d)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(1!==c)throw new Error("WebGL does not support array textures");var m,_=l+3&-4,g=h+3&-4,v=new Array(c),y=l*h;if(0===s&&(y=_*g),void 0===(m=0!==s?TYPES_TO_BYTES_PER_COMPONENT[s]?TYPES_TO_BYTES_PER_COMPONENT[s]*FORMATS_TO_COMPONENTS[o]:TYPES_TO_BYTES_PER_PIXEL[s]:INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[a]))throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");for(var b=y*m,x=l,S=h,T=_,E=g,A=FILE_HEADER_SIZE+p,w=0;w<f;w++){for(var C=n.getUint32(A,i),O=A+4,R=0;R<c;R++){var D=v[R];D||(D=v[R]=new Array(f)),D[w]={levelID:w,levelWidth:f>1?x:T,levelHeight:f>1?S:E,levelBuffer:new Uint8Array(r,O,b)},O+=b}A=(A+=C+4)%4!=0?A+4-A%4:A,b=(T=(x=x>>1||1)+4-1&-4)*(E=(S=S>>1||1)+4-1&-4)*m}if(0!==s)throw new Error("TODO: Uncompressed");return v.map((function(e){return new CompressedTextureResource(null,{format:a,width:l,height:h,levels:f,levelBuffers:e})}))},e.validate=function(e,t){for(var r=0;r<FILE_IDENTIFIER.length;r++)if(t.getUint8(r)!==FILE_IDENTIFIER[r])return console.error(e+" is not a valid *.ktx file!"),!1;return!0},e}(),extendStatics6=function(e,t){return extendStatics6=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},extendStatics6(e,t)};function __extends6(e,t){function r(){this.constructor=e}extendStatics6(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var ParticleContainer=function(e){function t(t,r,n,i){void 0===t&&(t=1500),void 0===n&&(n=16384),void 0===i&&(i=!1);var s=e.call(this)||this;return n>16384&&(n=16384),s._properties=[!1,!0,!1,!1,!1],s._maxSize=t,s._batchSize=n,s._buffers=null,s._bufferUpdateIDs=[],s._updateID=0,s.interactiveChildren=!1,s.blendMode=BLEND_MODES2.NORMAL,s.autoResize=i,s.roundPixels=!0,s.baseTexture=null,s.setProperties(r),s._tint=0,s.tintRgb=new Float32Array(4),s.tint=16777215,s}return __extends6(t,e),t.prototype.setProperties=function(e){e&&(this._properties[0]="vertices"in e||"scale"in e?!!e.vertices||!!e.scale:this._properties[0],this._properties[1]="position"in e?!!e.position:this._properties[1],this._properties[2]="rotation"in e?!!e.rotation:this._properties[2],this._properties[3]="uvs"in e?!!e.uvs:this._properties[3],this._properties[4]="tint"in e||"alpha"in e?!!e.tint||!!e.alpha:this._properties[4])},t.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},Object.defineProperty(t.prototype,"tint",{get:function(){return this._tint},set:function(e){this._tint=e,hex2rgb(e,this.tintRgb)},enumerable:!1,configurable:!0}),t.prototype.render=function(e){var t=this;!this.visible||this.worldAlpha<=0||!this.children.length||!this.renderable||(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",(function(){return t.onChildrenChange(0)}))),e.batch.setObjectRenderer(e.plugins.particle),e.plugins.particle.render(this))},t.prototype.onChildrenChange=function(e){for(var t=Math.floor(e/this._batchSize);this._bufferUpdateIDs.length<t;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[t]=++this._updateID},t.prototype.dispose=function(){if(this._buffers){for(var e=0;e<this._buffers.length;++e)this._buffers[e].destroy();this._buffers=null}},t.prototype.destroy=function(t){e.prototype.destroy.call(this,t),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null},t}(Container),ParticleBuffer=function(){function e(e,t,r){this.geometry=new Geometry,this.indexBuffer=null,this.size=r,this.dynamicProperties=[],this.staticProperties=[];for(var n=0;n<e.length;++n){var i=e[n];i={attributeName:i.attributeName,size:i.size,uploadFunction:i.uploadFunction,type:i.type||TYPES2.FLOAT,offset:i.offset},t[n]?this.dynamicProperties.push(i):this.staticProperties.push(i)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}return e.prototype.initBuffers=function(){var e=this.geometry,t=0;this.indexBuffer=new Buffer2(createIndicesForQuads(this.size),!0,!0),e.addIndex(this.indexBuffer),this.dynamicStride=0;for(var r=0;r<this.dynamicProperties.length;++r)(o=this.dynamicProperties[r]).offset=t,t+=o.size,this.dynamicStride+=o.size;var n=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(n),this.dynamicDataUint32=new Uint32Array(n),this.dynamicBuffer=new Buffer2(this.dynamicData,!1,!1);var i=0;for(this.staticStride=0,r=0;r<this.staticProperties.length;++r)(o=this.staticProperties[r]).offset=i,i+=o.size,this.staticStride+=o.size;var s=new ArrayBuffer(this.size*this.staticStride*4*4);for(this.staticData=new Float32Array(s),this.staticDataUint32=new Uint32Array(s),this.staticBuffer=new Buffer2(this.staticData,!0,!1),r=0;r<this.dynamicProperties.length;++r){var o=this.dynamicProperties[r];e.addAttribute(o.attributeName,this.dynamicBuffer,0,o.type===TYPES2.UNSIGNED_BYTE,o.type,4*this.dynamicStride,4*o.offset)}for(r=0;r<this.staticProperties.length;++r)o=this.staticProperties[r],e.addAttribute(o.attributeName,this.staticBuffer,0,o.type===TYPES2.UNSIGNED_BYTE,o.type,4*this.staticStride,4*o.offset)},e.prototype.uploadDynamic=function(e,t,r){for(var n=0;n<this.dynamicProperties.length;n++){var i=this.dynamicProperties[n];i.uploadFunction(e,t,r,i.type===TYPES2.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,i.offset)}this.dynamicBuffer._updateID++},e.prototype.uploadStatic=function(e,t,r){for(var n=0;n<this.staticProperties.length;n++){var i=this.staticProperties[n];i.uploadFunction(e,t,r,i.type===TYPES2.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,i.offset)}this.staticBuffer._updateID++},e.prototype.destroy=function(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()},e}(),fragment2="varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}",vertex2="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n",ParticleRenderer=function(e){function t(t){var r=e.call(this,t)||this;return r.shader=null,r.properties=null,r.tempMatrix=new Matrix,r.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:r.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:r.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:r.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:r.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:TYPES2.UNSIGNED_BYTE,uploadFunction:r.uploadTint,offset:0}],r.shader=Shader.from(vertex2,fragment2,{}),r.state=State.for2d(),r}return __extends6(t,e),t.prototype.render=function(e){var t=e.children,r=e._maxSize,n=e._batchSize,i=this.renderer,s=t.length;if(0!==s){s>r&&!e.autoResize&&(s=r);var o=e._buffers;o||(o=e._buffers=this.generateBuffers(e));var a=t[0]._texture.baseTexture;this.state.blendMode=correctBlendMode(e.blendMode,a.alphaMode),i.state.set(this.state);var l=i.gl,h=e.worldTransform.copyTo(this.tempMatrix);h.prepend(i.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=h.toArray(!0),this.shader.uniforms.uColor=premultiplyRgba(e.tintRgb,e.worldAlpha,this.shader.uniforms.uColor,a.alphaMode),this.shader.uniforms.uSampler=a,this.renderer.shader.bind(this.shader);for(var u=!1,c=0,d=0;c<s;c+=n,d+=1){var f=s-c;f>n&&(f=n),d>=o.length&&o.push(this._generateOneMoreBuffer(e));var p=o[d];p.uploadDynamic(t,c,f);var m=e._bufferUpdateIDs[d]||0;(u=u||p._updateID<m)&&(p._updateID=e._updateID,p.uploadStatic(t,c,f)),i.geometry.bind(p.geometry),l.drawElements(l.TRIANGLES,6*f,l.UNSIGNED_SHORT,0)}}},t.prototype.generateBuffers=function(e){for(var t=[],r=e._maxSize,n=e._batchSize,i=e._properties,s=0;s<r;s+=n)t.push(new ParticleBuffer(this.properties,i,n));return t},t.prototype._generateOneMoreBuffer=function(e){var t=e._batchSize,r=e._properties;return new ParticleBuffer(this.properties,r,t)},t.prototype.uploadVertices=function(e,t,r,n,i,s){for(var o=0,a=0,l=0,h=0,u=0;u<r;++u){var c=e[t+u],d=c._texture,f=c.scale.x,p=c.scale.y,m=d.trim,_=d.orig;m?(o=(a=m.x-c.anchor.x*_.width)+m.width,l=(h=m.y-c.anchor.y*_.height)+m.height):(o=_.width*(1-c.anchor.x),a=_.width*-c.anchor.x,l=_.height*(1-c.anchor.y),h=_.height*-c.anchor.y),n[s]=a*f,n[s+1]=h*p,n[s+i]=o*f,n[s+i+1]=h*p,n[s+2*i]=o*f,n[s+2*i+1]=l*p,n[s+3*i]=a*f,n[s+3*i+1]=l*p,s+=4*i}},t.prototype.uploadPosition=function(e,t,r,n,i,s){for(var o=0;o<r;o++){var a=e[t+o].position;n[s]=a.x,n[s+1]=a.y,n[s+i]=a.x,n[s+i+1]=a.y,n[s+2*i]=a.x,n[s+2*i+1]=a.y,n[s+3*i]=a.x,n[s+3*i+1]=a.y,s+=4*i}},t.prototype.uploadRotation=function(e,t,r,n,i,s){for(var o=0;o<r;o++){var a=e[t+o].rotation;n[s]=a,n[s+i]=a,n[s+2*i]=a,n[s+3*i]=a,s+=4*i}},t.prototype.uploadUvs=function(e,t,r,n,i,s){for(var o=0;o<r;++o){var a=e[t+o]._texture._uvs;a?(n[s]=a.x0,n[s+1]=a.y0,n[s+i]=a.x1,n[s+i+1]=a.y1,n[s+2*i]=a.x2,n[s+2*i+1]=a.y2,n[s+3*i]=a.x3,n[s+3*i+1]=a.y3,s+=4*i):(n[s]=0,n[s+1]=0,n[s+i]=0,n[s+i+1]=0,n[s+2*i]=0,n[s+2*i+1]=0,n[s+3*i]=0,n[s+3*i+1]=0,s+=4*i)}},t.prototype.uploadTint=function(e,t,r,n,i,s){for(var o=0;o<r;++o){var a=e[t+o],l=a._texture.baseTexture.alphaMode>0,h=a.alpha,u=h<1&&l?premultiplyTint(a._tintRGB,h):a._tintRGB+(255*h<<24);n[s]=u,n[s+i]=u,n[s+2*i]=u,n[s+3*i]=u,s+=4*i}},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null},t}(ObjectRenderer),LINE_JOIN,LINE_JOIN2,LINE_CAP,LINE_CAP2;LINE_JOIN2=LINE_JOIN||(LINE_JOIN={}),LINE_JOIN2.MITER="miter",LINE_JOIN2.BEVEL="bevel",LINE_JOIN2.ROUND="round",LINE_CAP2=LINE_CAP||(LINE_CAP={}),LINE_CAP2.BUTT="butt",LINE_CAP2.ROUND="round",LINE_CAP2.SQUARE="square";var GRAPHICS_CURVES={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount:function(e,t){if(void 0===t&&(t=20),!this.adaptive||!e||isNaN(e))return t;var r=Math.ceil(e/this.maxLength);return r<this.minSegments?r=this.minSegments:r>this.maxSegments&&(r=this.maxSegments),r}},FillStyle=function(){function e(){this.color=16777215,this.alpha=1,this.texture=Texture.WHITE,this.matrix=null,this.visible=!1,this.reset()}return e.prototype.clone=function(){var t=new e;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t},e.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=Texture.WHITE,this.matrix=null,this.visible=!1},e.prototype.destroy=function(){this.texture=null,this.matrix=null},e}(),extendStatics7=function(e,t){return extendStatics7=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},extendStatics7(e,t)};function __extends7(e,t){function r(){this.constructor=e}extendStatics7(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var buildPoly={build:function(e){e.points=e.shape.points.slice()},triangulate:function(e,t){var r=e.points,n=e.holes,i=t.points,s=t.indices;if(r.length>=6){for(var o=[],a=0;a<n.length;a++){var l=n[a];o.push(r.length/2),r=r.concat(l.points)}var h=(0,import_earcut.default)(r,o,2);if(!h)return;var u=i.length/2;for(a=0;a<h.length;a+=3)s.push(h[a]+u),s.push(h[a+1]+u),s.push(h[a+2]+u);for(a=0;a<r.length;a++)i.push(r[a])}}},buildCircle={build:function(e){var t,r,n=e.shape,i=e.points,s=n.x,o=n.y;if(i.length=0,e.type===SHAPES.CIRC)t=n.radius,r=n.radius;else{var a=e.shape;t=a.width,r=a.height}if(0!==t&&0!==r){var l=Math.floor(30*Math.sqrt(n.radius))||Math.floor(15*Math.sqrt(t+r));l/=2.3;for(var h=2*Math.PI/l,u=0;u<l-.5;u++)i.push(s+Math.sin(-h*u)*t,o+Math.cos(-h*u)*r);i.push(i[0],i[1])}},triangulate:function(e,t){var r=e.points,n=t.points,i=t.indices,s=n.length/2,o=s,a=e.shape,l=e.matrix,h=a.x,u=a.y;n.push(e.matrix?l.a*h+l.c*u+l.tx:h,e.matrix?l.b*h+l.d*u+l.ty:u);for(var c=0;c<r.length;c+=2)n.push(r[c],r[c+1]),i.push(s++,o,s)}},buildRectangle={build:function(e){var t=e.shape,r=t.x,n=t.y,i=t.width,s=t.height,o=e.points;o.length=0,o.push(r,n,r+i,n,r+i,n+s,r,n+s)},triangulate:function(e,t){var r=e.points,n=t.points,i=n.length/2;n.push(r[0],r[1],r[2],r[3],r[6],r[7],r[4],r[5]),t.indices.push(i,i+1,i+2,i+1,i+2,i+3)}};function getPt(e,t,r){return e+(t-e)*r}function quadraticBezierCurve(e,t,r,n,i,s,o){void 0===o&&(o=[]);for(var a=o,l=0,h=0,u=0,c=0,d=0,f=0,p=0,m=0;p<=20;++p)l=getPt(e,r,m=p/20),h=getPt(t,n,m),u=getPt(r,i,m),c=getPt(n,s,m),d=getPt(l,u,m),f=getPt(h,c,m),a.push(d,f);return a}var buildRoundedRectangle={build:function(e){var t=e.shape,r=e.points,n=t.x,i=t.y,s=t.width,o=t.height,a=Math.max(0,Math.min(t.radius,Math.min(s,o)/2));r.length=0,a?(quadraticBezierCurve(n,i+a,n,i,n+a,i,r),quadraticBezierCurve(n+s-a,i,n+s,i,n+s,i+a,r),quadraticBezierCurve(n+s,i+o-a,n+s,i+o,n+s-a,i+o,r),quadraticBezierCurve(n+a,i+o,n,i+o,n,i+o-a,r)):r.push(n,i,n+s,i,n+s,i+o,n,i+o)},triangulate:function(e,t){for(var r=e.points,n=t.points,i=t.indices,s=n.length/2,o=(0,import_earcut.default)(r,null,2),a=0,l=o.length;a<l;a+=3)i.push(o[a]+s),i.push(o[a+1]+s),i.push(o[a+2]+s);for(a=0,l=r.length;a<l;a++)n.push(r[a],r[++a])}};function square(e,t,r,n,i,s,o,a){var l,h;o?(l=n,h=-r):(l=-n,h=r);var u=e-r*i+l,c=t-n*i+h,d=e+r*s+l,f=t+n*s+h;return a.push(u,c),a.push(d,f),2}function round2(e,t,r,n,i,s,o,a){var l=r-e,h=n-t,u=Math.atan2(l,h),c=Math.atan2(i-e,s-t);a&&u<c?u+=2*Math.PI:!a&&u>c&&(c+=2*Math.PI);var d=u,f=c-u,p=Math.abs(f),m=Math.sqrt(l*l+h*h),_=1+(15*p*Math.sqrt(m)/Math.PI>>0),g=f/_;if(d+=g,a){o.push(e,t),o.push(r,n);for(var v=1,y=d;v<_;v++,y+=g)o.push(e,t),o.push(e+Math.sin(y)*m,t+Math.cos(y)*m);o.push(e,t),o.push(i,s)}else{for(o.push(r,n),o.push(e,t),v=1,y=d;v<_;v++,y+=g)o.push(e+Math.sin(y)*m,t+Math.cos(y)*m),o.push(e,t);o.push(i,s),o.push(e,t)}return 2*_}function buildNonNativeLine(e,t){var r=e.shape,n=e.points||r.points.slice(),i=t.closePointEps;if(0!==n.length){var s=e.lineStyle,o=new Point(n[0],n[1]),a=new Point(n[n.length-2],n[n.length-1]),l=r.type!==SHAPES.POLY||r.closeStroke,h=Math.abs(o.x-a.x)<i&&Math.abs(o.y-a.y)<i;if(l){n=n.slice(),h&&(n.pop(),n.pop(),a.set(n[n.length-2],n[n.length-1]));var u=.5*(o.x+a.x),c=.5*(a.y+o.y);n.unshift(u,c),n.push(u,c)}var d=t.points,f=n.length/2,p=n.length,m=d.length/2,_=s.width/2,g=_*_,v=s.miterLimit*s.miterLimit,y=n[0],b=n[1],x=n[2],S=n[3],T=0,E=0,A=-(b-S),w=y-x,C=0,O=0,R=Math.sqrt(A*A+w*w);A/=R,w/=R,A*=_,w*=_;var D=s.alignment,I=2*(1-D),M=2*D;l||(s.cap===LINE_CAP.ROUND?p+=round2(y-A*(I-M)*.5,b-w*(I-M)*.5,y-A*I,b-w*I,y+A*M,b+w*M,d,!0)+2:s.cap===LINE_CAP.SQUARE&&(p+=square(y,b,A,w,I,M,!0,d))),d.push(y-A*I,b-w*I),d.push(y+A*M,b+w*M);for(var N=1;N<f-1;++N){y=n[2*(N-1)],b=n[2*(N-1)+1],x=n[2*N],S=n[2*N+1],T=n[2*(N+1)],E=n[2*(N+1)+1],A=-(b-S),w=y-x,A/=R=Math.sqrt(A*A+w*w),w/=R,A*=_,w*=_,C=-(S-E),O=x-T,C/=R=Math.sqrt(C*C+O*O),O/=R,C*=_,O*=_;var P=x-y,k=b-S,F=x-T,L=E-S,B=k*F-L*P,U=B<0;if(Math.abs(B)<.1)d.push(x-A*I,S-w*I),d.push(x+A*M,S+w*M);else{var G=(-A+y)*(-w+S)-(-A+x)*(-w+b),j=(-C+T)*(-O+S)-(-C+x)*(-O+E),V=(P*j-F*G)/B,z=(L*G-k*j)/B,H=(V-x)*(V-x)+(z-S)*(z-S),X=x+(V-x)*I,W=S+(z-S)*I,q=x-(V-x)*M,Y=S-(z-S)*M,J=U?I:M;H<=Math.min(P*P+k*k,F*F+L*L)+J*J*g?s.join===LINE_JOIN.BEVEL||H/g>v?(U?(d.push(X,W),d.push(x+A*M,S+w*M),d.push(X,W),d.push(x+C*M,S+O*M)):(d.push(x-A*I,S-w*I),d.push(q,Y),d.push(x-C*I,S-O*I),d.push(q,Y)),p+=2):s.join===LINE_JOIN.ROUND?U?(d.push(X,W),d.push(x+A*M,S+w*M),p+=round2(x,S,x+A*M,S+w*M,x+C*M,S+O*M,d,!0)+4,d.push(X,W),d.push(x+C*M,S+O*M)):(d.push(x-A*I,S-w*I),d.push(q,Y),p+=round2(x,S,x-A*I,S-w*I,x-C*I,S-O*I,d,!1)+4,d.push(x-C*I,S-O*I),d.push(q,Y)):(d.push(X,W),d.push(q,Y)):(d.push(x-A*I,S-w*I),d.push(x+A*M,S+w*M),s.join===LINE_JOIN.BEVEL||H/g>v||(s.join===LINE_JOIN.ROUND?p+=U?round2(x,S,x+A*M,S+w*M,x+C*M,S+O*M,d,!0)+2:round2(x,S,x-A*I,S-w*I,x-C*I,S-O*I,d,!1)+2:(U?(d.push(q,Y),d.push(q,Y)):(d.push(X,W),d.push(X,W)),p+=2)),d.push(x-C*I,S-O*I),d.push(x+C*M,S+O*M),p+=2)}}y=n[2*(f-2)],b=n[2*(f-2)+1],x=n[2*(f-1)],A=-(b-(S=n[2*(f-1)+1])),w=y-x,A/=R=Math.sqrt(A*A+w*w),w/=R,A*=_,w*=_,d.push(x-A*I,S-w*I),d.push(x+A*M,S+w*M),l||(s.cap===LINE_CAP.ROUND?p+=round2(x-A*(I-M)*.5,S-w*(I-M)*.5,x-A*I,S-w*I,x+A*M,S+w*M,d,!1)+2:s.cap===LINE_CAP.SQUARE&&(p+=square(x,S,A,w,I,M,!1,d)));var K=t.indices,$=GRAPHICS_CURVES.epsilon*GRAPHICS_CURVES.epsilon;for(N=m;N<p+m-2;++N)y=d[2*N],b=d[2*N+1],x=d[2*(N+1)],S=d[2*(N+1)+1],T=d[2*(N+2)],E=d[2*(N+2)+1],!(Math.abs(y*(S-E)+x*(E-b)+T*(b-S))<$)&&K.push(N,N+1,N+2)}}function buildNativeLine(e,t){var r=0,n=e.shape,i=e.points||n.points,s=n.type!==SHAPES.POLY||n.closeStroke;if(0!==i.length){var o=t.points,a=t.indices,l=i.length/2,h=o.length/2,u=h;for(o.push(i[0],i[1]),r=1;r<l;r++)o.push(i[2*r],i[2*r+1]),a.push(u,u+1),u++;s&&a.push(u,h)}}function buildLine(e,t){e.lineStyle.native?buildNativeLine(e,t):buildNonNativeLine(e,t)}var ArcUtils=function(){function e(){}return e.curveTo=function(e,t,r,n,i,s){var o=s[s.length-2],a=s[s.length-1]-t,l=o-e,h=n-t,u=r-e,c=Math.abs(a*u-l*h);if(c<1e-8||0===i)return(s[s.length-2]!==e||s[s.length-1]!==t)&&s.push(e,t),null;var d=a*a+l*l,f=h*h+u*u,p=a*h+l*u,m=i*Math.sqrt(d)/c,_=i*Math.sqrt(f)/c,g=m*p/d,v=_*p/f,y=m*u+_*l,b=m*h+_*a,x=l*(_+g),S=a*(_+g),T=u*(m+v),E=h*(m+v);return{cx:y+e,cy:b+t,radius:i,startAngle:Math.atan2(S-b,x-y),endAngle:Math.atan2(E-b,T-y),anticlockwise:l*h>u*a}},e.arc=function(e,t,r,n,i,s,o,a,l){for(var h=o-s,u=GRAPHICS_CURVES._segmentsCount(Math.abs(h)*i,40*Math.ceil(Math.abs(h)/PI_2)),c=h/(2*u),d=2*c,f=Math.cos(c),p=Math.sin(c),m=u-1,_=m%1/m,g=0;g<=m;++g){var v=c+s+d*(g+_*g),y=Math.cos(v),b=-Math.sin(v);l.push((f*y+p*b)*i+r,(f*-b+p*y)*i+n)}},e}(),BezierUtils=function(){function e(){}return e.curveLength=function(e,t,r,n,i,s,o,a){for(var l=0,h=0,u=0,c=0,d=0,f=0,p=0,m=0,_=0,g=0,v=0,y=e,b=t,x=1;x<=10;++x)g=y-(m=(p=(f=(d=1-(h=x/10))*d)*d)*e+3*f*h*r+3*d*(u=h*h)*i+(c=u*h)*o),v=b-(_=p*t+3*f*h*n+3*d*u*s+c*a),y=m,b=_,l+=Math.sqrt(g*g+v*v);return l},e.curveTo=function(t,r,n,i,s,o,a){var l=a[a.length-2],h=a[a.length-1];a.length-=2;var u=GRAPHICS_CURVES._segmentsCount(e.curveLength(l,h,t,r,n,i,s,o)),c=0,d=0,f=0,p=0,m=0;a.push(l,h);for(var _=1,g=0;_<=u;++_)f=(d=(c=1-(g=_/u))*c)*c,m=(p=g*g)*g,a.push(f*l+3*d*g*t+3*c*p*n+m*s,f*h+3*d*g*r+3*c*p*i+m*o)},e}(),QuadraticUtils=function(){function e(){}return e.curveLength=function(e,t,r,n,i,s){var o=e-2*r+i,a=t-2*n+s,l=2*r-2*e,h=2*n-2*t,u=4*(o*o+a*a),c=4*(o*l+a*h),d=l*l+h*h,f=2*Math.sqrt(u+c+d),p=Math.sqrt(u),m=2*u*p,_=2*Math.sqrt(d),g=c/p;return(m*f+p*c*(f-_)+(4*d*u-c*c)*Math.log((2*p+g+f)/(g+_)))/(4*m)},e.curveTo=function(t,r,n,i,s){for(var o=s[s.length-2],a=s[s.length-1],l=GRAPHICS_CURVES._segmentsCount(e.curveLength(o,a,t,r,n,i)),h=0,u=0,c=1;c<=l;++c){var d=c/l;h=o+(t-o)*d,u=a+(r-a)*d,s.push(h+(t+(n-t)*d-h)*d,u+(r+(i-r)*d-u)*d)}},e}(),BatchPart=function(){function e(){this.reset()}return e.prototype.begin=function(e,t,r){this.reset(),this.style=e,this.start=t,this.attribStart=r},e.prototype.end=function(e,t){this.attribSize=t-this.attribStart,this.size=e-this.start},e.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0},e}(),_a2,FILL_COMMANDS=(_a2={},_a2[SHAPES.POLY]=buildPoly,_a2[SHAPES.CIRC]=buildCircle,_a2[SHAPES.ELIP]=buildCircle,_a2[SHAPES.RECT]=buildRectangle,_a2[SHAPES.RREC]=buildRoundedRectangle,_a2),BATCH_POOL=[],DRAW_CALL_POOL=[],GraphicsData=function(){function e(e,t,r,n){void 0===t&&(t=null),void 0===r&&(r=null),void 0===n&&(n=null),this.shape=e,this.lineStyle=r,this.fillStyle=t,this.matrix=n,this.type=e.type,this.points=[],this.holes=[]}return e.prototype.clone=function(){return new e(this.shape,this.fillStyle,this.lineStyle,this.matrix)},e.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null},e}(),tmpPoint=new Point,tmpBounds=new Bounds,GraphicsGeometry=function(e){function t(){var t=e.call(this)||this;return t.uvsFloat32=null,t.indicesUint16=null,t.points=[],t.colors=[],t.uvs=[],t.indices=[],t.textureIds=[],t.graphicsData=[],t.dirty=0,t.batchDirty=-1,t.cacheDirty=-1,t.clearDirty=0,t.drawCalls=[],t.batches=[],t.shapeIndex=0,t._bounds=new Bounds,t.boundsDirty=-1,t.boundsPadding=0,t.batchable=!1,t.indicesUint16=null,t.uvsFloat32=null,t.closePointEps=1e-4,t}return __extends7(t,e),Object.defineProperty(t.prototype,"bounds",{get:function(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},enumerable:!1,configurable:!0}),t.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),DRAW_CALL_POOL.push(this.drawCalls[e]);for(this.drawCalls.length=0,e=0;e<this.batches.length;e++){var t=this.batches[e];t.reset(),BATCH_POOL.push(t)}this.batches.length=0},t.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},t.prototype.drawShape=function(e,t,r,n){void 0===t&&(t=null),void 0===r&&(r=null),void 0===n&&(n=null);var i=new GraphicsData(e,t,r,n);return this.graphicsData.push(i),this.dirty++,this},t.prototype.drawHole=function(e,t){if(void 0===t&&(t=null),!this.graphicsData.length)return null;var r=new GraphicsData(e,null,null,t),n=this.graphicsData[this.graphicsData.length-1];return r.lineStyle=n.lineStyle,n.holes.push(r),this.dirty++,this},t.prototype.destroy=function(){e.prototype.destroy.call(this);for(var t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},t.prototype.containsPoint=function(e){for(var t=this.graphicsData,r=0;r<t.length;++r){var n=t[r];if(n.fillStyle.visible&&n.shape&&(n.matrix?n.matrix.applyInverse(e,tmpPoint):tmpPoint.copyFrom(e),n.shape.contains(tmpPoint.x,tmpPoint.y))){var i=!1;if(n.holes)for(var s=0;s<n.holes.length;s++)if(n.holes[s].shape.contains(tmpPoint.x,tmpPoint.y)){i=!0;break}if(!i)return!0}}return!1},t.prototype.updateBatches=function(e){if(this.graphicsData.length){if(this.validateBatching()){this.cacheDirty=this.dirty;var t=this.uvs,r=this.graphicsData,n=null,i=null;this.batches.length>0&&(i=(n=this.batches[this.batches.length-1]).style);for(var s=this.shapeIndex;s<r.length;s++){this.shapeIndex++;var o=r[s],a=o.fillStyle,l=o.lineStyle;FILL_COMMANDS[o.type].build(o),o.matrix&&this.transformPoints(o.points,o.matrix);for(var h=0;h<2;h++){var u=0===h?a:l;if(u.visible){var c=u.texture.baseTexture,d=this.indices.length,f=this.points.length/2;c.wrapMode=WRAP_MODES2.REPEAT,0===h?this.processFill(o):this.processLine(o);var p=this.points.length/2-f;0!==p&&(n&&!this._compareStyles(i,u)&&(n.end(d,f),n=null),n||((n=BATCH_POOL.pop()||new BatchPart).begin(u,d,f),this.batches.push(n),i=u),this.addUvs(this.points,t,u.texture,f,p,u.matrix))}}}var m=this.indices.length,_=this.points.length/2;if(n&&n.end(m,_),0===this.batches.length)return void(this.batchable=!0);if(this.indicesUint16&&this.indices.length===this.indicesUint16.length)this.indicesUint16.set(this.indices);else{var g=_>65535&&e;this.indicesUint16=g?new Uint32Array(this.indices):new Uint16Array(this.indices)}this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}}else this.batchable=!0},t.prototype._compareStyles=function(e,t){return!(!e||!t||e.texture.baseTexture!==t.texture.baseTexture||e.color+e.alpha!==t.color+t.alpha||!!e.native!=!!t.native)},t.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var e=0,t=this.graphicsData.length;e<t;e++){var r=this.graphicsData[e],n=r.fillStyle,i=r.lineStyle;if(n&&!n.texture.baseTexture.valid||i&&!i.texture.baseTexture.valid)return!1}return!0},t.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var e=this.batches,t=0,r=e.length;t<r;t++)for(var n=e[t],i=0;i<n.size;i++){var s=n.start+i;this.indicesUint16[s]=this.indicesUint16[s]-n.attribStart}},t.prototype.isBatchable=function(){if(this.points.length>131070)return!1;for(var e=this.batches,r=0;r<e.length;r++)if(e[r].style.native)return!1;return this.points.length<2*t.BATCHABLE_SIZE},t.prototype.buildDrawCalls=function(){for(var e=++BaseTexture._globalBatch,t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),DRAW_CALL_POOL.push(this.drawCalls[t]);this.drawCalls.length=0;var r=this.colors,n=this.textureIds,i=DRAW_CALL_POOL.pop();i||((i=new BatchDrawCall).texArray=new BatchTextureArray),i.texArray.count=0,i.start=0,i.size=0,i.type=DRAW_MODES2.TRIANGLES;var s=0,o=null,a=0,l=!1,h=DRAW_MODES2.TRIANGLES,u=0;for(this.drawCalls.push(i),t=0;t<this.batches.length;t++){var c=this.batches[t],d=c.style,f=d.texture.baseTexture;l!==!!d.native&&(h=(l=!!d.native)?DRAW_MODES2.LINES:DRAW_MODES2.TRIANGLES,o=null,s=8,e++),o!==f&&(o=f,f._batchEnabled!==e&&(8===s&&(e++,s=0,i.size>0&&((i=DRAW_CALL_POOL.pop())||((i=new BatchDrawCall).texArray=new BatchTextureArray),this.drawCalls.push(i)),i.start=u,i.size=0,i.texArray.count=0,i.type=h),f.touched=1,f._batchEnabled=e,f._batchLocation=s,f.wrapMode=WRAP_MODES2.REPEAT,i.texArray.elements[i.texArray.count++]=f,s++)),i.size+=c.size,u+=c.size,a=f._batchLocation,this.addColors(r,d.color,d.alpha,c.attribSize),this.addTextureIds(n,a,c.attribSize)}BaseTexture._globalBatch=e,this.packAttributes()},t.prototype.packAttributes=function(){for(var e=this.points,t=this.uvs,r=this.colors,n=this.textureIds,i=new ArrayBuffer(3*e.length*4),s=new Float32Array(i),o=new Uint32Array(i),a=0,l=0;l<e.length/2;l++)s[a++]=e[2*l],s[a++]=e[2*l+1],s[a++]=t[2*l],s[a++]=t[2*l+1],o[a++]=r[l],s[a++]=n[l];this._buffer.update(i),this._indexBuffer.update(this.indicesUint16)},t.prototype.processFill=function(e){e.holes.length?(this.processHoles(e.holes),buildPoly.triangulate(e,this)):FILL_COMMANDS[e.type].triangulate(e,this)},t.prototype.processLine=function(e){buildLine(e,this);for(var t=0;t<e.holes.length;t++)buildLine(e.holes[t],this)},t.prototype.processHoles=function(e){for(var t=0;t<e.length;t++){var r=e[t];FILL_COMMANDS[r.type].build(r),r.matrix&&this.transformPoints(r.points,r.matrix)}},t.prototype.calculateBounds=function(){var e=this._bounds,t=tmpBounds,r=Matrix.IDENTITY;this._bounds.clear(),t.clear();for(var n=0;n<this.graphicsData.length;n++){var i=this.graphicsData[n],s=i.shape,o=i.type,a=i.lineStyle,l=i.matrix||Matrix.IDENTITY,h=0;if(a&&a.visible){var u=a.alignment;h=a.width,o===SHAPES.POLY?h*=.5+Math.abs(.5-u):h*=Math.max(0,u)}if(r!==l&&(t.isEmpty()||(e.addBoundsMatrix(t,r),t.clear()),r=l),o===SHAPES.RECT||o===SHAPES.RREC){var c=s;t.addFramePad(c.x,c.y,c.x+c.width,c.y+c.height,h,h)}else if(o===SHAPES.CIRC){var d=s;t.addFramePad(d.x,d.y,d.x,d.y,d.radius+h,d.radius+h)}else if(o===SHAPES.ELIP){var f=s;t.addFramePad(f.x,f.y,f.x,f.y,f.width+h,f.height+h)}else{var p=s;e.addVerticesMatrix(r,p.points,0,p.points.length,h,h)}}t.isEmpty()||e.addBoundsMatrix(t,r),e.pad(this.boundsPadding,this.boundsPadding)},t.prototype.transformPoints=function(e,t){for(var r=0;r<e.length/2;r++){var n=e[2*r],i=e[2*r+1];e[2*r]=t.a*n+t.c*i+t.tx,e[2*r+1]=t.b*n+t.d*i+t.ty}},t.prototype.addColors=function(e,t,r,n){for(var i=premultiplyTint((t>>16)+(65280&t)+((255&t)<<16),r);n-- >0;)e.push(i)},t.prototype.addTextureIds=function(e,t,r){for(;r-- >0;)e.push(t)},t.prototype.addUvs=function(e,t,r,n,i,s){void 0===s&&(s=null);for(var o=0,a=t.length,l=r.frame;o<i;){var h=e[2*(n+o)],u=e[2*(n+o)+1];if(s){var c=s.a*h+s.c*u+s.tx;u=s.b*h+s.d*u+s.ty,h=c}o++,t.push(h/l.width,u/l.height)}var d=r.baseTexture;(l.width<d.width||l.height<d.height)&&this.adjustUvs(t,r,a,i)},t.prototype.adjustUvs=function(e,t,r,n){for(var i=t.baseTexture,s=1e-6,o=r+2*n,a=t.frame,l=a.width/i.width,h=a.height/i.height,u=a.x/a.width,c=a.y/a.height,d=Math.floor(e[r]+s),f=Math.floor(e[r+1]+s),p=r+2;p<o;p+=2)d=Math.min(d,Math.floor(e[p]+s)),f=Math.min(f,Math.floor(e[p+1]+s));for(u-=d,c-=f,p=r;p<o;p+=2)e[p]=(e[p]+u)*l,e[p+1]=(e[p+1]+c)*h},t.BATCHABLE_SIZE=100,t}(BatchGeometry),LineStyle=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.width=0,t.alignment=.5,t.native=!1,t.cap=LINE_CAP.BUTT,t.join=LINE_JOIN.MITER,t.miterLimit=10,t}return __extends7(t,e),t.prototype.clone=function(){var e=new t;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.native=this.native,e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e},t.prototype.reset=function(){e.prototype.reset.call(this),this.color=0,this.alignment=.5,this.width=0,this.native=!1},t}(FillStyle),temp=new Float32Array(3),DEFAULT_SHADERS={},Graphics=function(e){function t(t){void 0===t&&(t=null);var r=e.call(this)||this;return r._geometry=t||new GraphicsGeometry,r._geometry.refCount++,r.shader=null,r.state=State.for2d(),r._fillStyle=new FillStyle,r._lineStyle=new LineStyle,r._matrix=null,r._holeMode=!1,r.currentPath=null,r.batches=[],r.batchTint=-1,r.batchDirty=-1,r.vertexData=null,r.pluginName="batch",r._transformID=-1,r.tint=16777215,r.blendMode=BLEND_MODES2.NORMAL,r}return __extends7(t,e),Object.defineProperty(t.prototype,"geometry",{get:function(){return this._geometry},enumerable:!1,configurable:!0}),t.prototype.clone=function(){return this.finishPoly(),new t(this._geometry)},Object.defineProperty(t.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(e){this.state.blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tint",{get:function(){return this._tint},set:function(e){this._tint=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fill",{get:function(){return this._fillStyle},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"line",{get:function(){return this._lineStyle},enumerable:!1,configurable:!0}),t.prototype.lineStyle=function(e,t,r,n,i){return void 0===e&&(e=null),void 0===t&&(t=0),void 0===r&&(r=1),void 0===n&&(n=.5),void 0===i&&(i=!1),"number"==typeof e&&(e={width:e,color:t,alpha:r,alignment:n,native:i}),this.lineTextureStyle(e)},t.prototype.lineTextureStyle=function(e){e=Object.assign({width:0,texture:Texture.WHITE,color:e&&e.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:LINE_CAP.BUTT,join:LINE_JOIN.MITER,miterLimit:10},e),this.currentPath&&this.startPoly();var t=e.width>0&&e.alpha>0;return t?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:t},e)):this._lineStyle.reset(),this},t.prototype.startPoly=function(){if(this.currentPath){var e=this.currentPath.points,t=this.currentPath.points.length;t>2&&(this.drawShape(this.currentPath),this.currentPath=new Polygon,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[t-2],e[t-1]))}else this.currentPath=new Polygon,this.currentPath.closeStroke=!1},t.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},t.prototype.moveTo=function(e,t){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=t,this},t.prototype.lineTo=function(e,t){this.currentPath||this.moveTo(0,0);var r=this.currentPath.points,n=r[r.length-2],i=r[r.length-1];return(n!==e||i!==t)&&r.push(e,t),this},t.prototype._initCurve=function(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[e,t]):this.moveTo(e,t)},t.prototype.quadraticCurveTo=function(e,t,r,n){this._initCurve();var i=this.currentPath.points;return 0===i.length&&this.moveTo(0,0),QuadraticUtils.curveTo(e,t,r,n,i),this},t.prototype.bezierCurveTo=function(e,t,r,n,i,s){return this._initCurve(),BezierUtils.curveTo(e,t,r,n,i,s,this.currentPath.points),this},t.prototype.arcTo=function(e,t,r,n,i){this._initCurve(e,t);var s=this.currentPath.points,o=ArcUtils.curveTo(e,t,r,n,i,s);if(o){var a=o.cx,l=o.cy,h=o.radius,u=o.startAngle,c=o.endAngle,d=o.anticlockwise;this.arc(a,l,h,u,c,d)}return this},t.prototype.arc=function(e,t,r,n,i,s){if(void 0===s&&(s=!1),n===i)return this;if(!s&&i<=n?i+=PI_2:s&&n<=i&&(n+=PI_2),0==i-n)return this;var o=e+Math.cos(n)*r,a=t+Math.sin(n)*r,l=this._geometry.closePointEps,h=this.currentPath?this.currentPath.points:null;if(h){var u=Math.abs(h[h.length-2]-o),c=Math.abs(h[h.length-1]-a);u<l&&c<l||h.push(o,a)}else this.moveTo(o,a),h=this.currentPath.points;return ArcUtils.arc(o,a,e,t,r,n,i,s,h),this},t.prototype.beginFill=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=1),this.beginTextureFill({texture:Texture.WHITE,color:e,alpha:t})},t.prototype.beginTextureFill=function(e){e=Object.assign({texture:Texture.WHITE,color:16777215,alpha:1,matrix:null},e),this.currentPath&&this.startPoly();var t=e.alpha>0;return t?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:t},e)):this._fillStyle.reset(),this},t.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},t.prototype.drawRect=function(e,t,r,n){return this.drawShape(new Rectangle(e,t,r,n))},t.prototype.drawRoundedRect=function(e,t,r,n,i){return this.drawShape(new RoundedRectangle(e,t,r,n,i))},t.prototype.drawCircle=function(e,t,r){return this.drawShape(new Circle(e,t,r))},t.prototype.drawEllipse=function(e,t,r,n){return this.drawShape(new Ellipse(e,t,r,n))},t.prototype.drawPolygon=function(){for(var e=arguments,t=[],r=0;r<arguments.length;r++)t[r]=e[r];var n,i=!0,s=t[0];s.points?(i=s.closeStroke,n=s.points):n=Array.isArray(t[0])?t[0]:t;var o=new Polygon(n);return o.closeStroke=i,this.drawShape(o),this},t.prototype.drawShape=function(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},t.prototype.clear=function(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this},t.prototype.isFastRect=function(){var e=this._geometry.graphicsData;return!(1!==e.length||e[0].shape.type!==SHAPES.RECT||e[0].holes.length||e[0].lineStyle.visible&&e[0].lineStyle.width)},t.prototype._render=function(e){this.finishPoly();var t=this._geometry,r=e.context.supports.uint32Indices;t.updateBatches(r),t.batchable?(this.batchDirty!==t.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))},t.prototype._populateBatches=function(){var e=this._geometry,t=this.blendMode,r=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=r,this.vertexData=new Float32Array(e.points);for(var n=0;n<r;n++){var i=e.batches[n],s=i.style.color,o=new Float32Array(this.vertexData.buffer,4*i.attribStart*2,2*i.attribSize),a=new Float32Array(e.uvsFloat32.buffer,4*i.attribStart*2,2*i.attribSize),l={vertexData:o,blendMode:t,indices:new Uint16Array(e.indicesUint16.buffer,2*i.start,i.size),uvs:a,_batchRGB:hex2rgb(s),_tintRGB:s,_texture:i.style.texture,alpha:i.style.alpha,worldAlpha:1};this.batches[n]=l}},t.prototype._renderBatched=function(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var t=0,r=this.batches.length;t<r;t++){var n=this.batches[t];n.worldAlpha=this.worldAlpha*n.alpha,e.plugins[this.pluginName].render(n)}}},t.prototype._renderDirect=function(e){var t=this._resolveDirectShader(e),r=this._geometry,n=this.tint,i=this.worldAlpha,s=t.uniforms,o=r.drawCalls;s.translationMatrix=this.transform.worldTransform,s.tint[0]=(n>>16&255)/255*i,s.tint[1]=(n>>8&255)/255*i,s.tint[2]=(255&n)/255*i,s.tint[3]=i,e.shader.bind(t),e.geometry.bind(r,t),e.state.set(this.state);for(var a=0,l=o.length;a<l;a++)this._renderDrawCallDirect(e,r.drawCalls[a])},t.prototype._renderDrawCallDirect=function(e,t){for(var r=t.texArray,n=t.type,i=t.size,s=t.start,o=r.count,a=0;a<o;a++)e.texture.bind(r.elements[a],a);e.geometry.draw(n,i,s)},t.prototype._resolveDirectShader=function(e){var t=this.shader,r=this.pluginName;if(!t){if(!DEFAULT_SHADERS[r]){for(var n=e.plugins.batch.MAX_TEXTURES,i=new Int32Array(n),s=0;s<n;s++)i[s]=s;var o={tint:new Float32Array([1,1,1,1]),translationMatrix:new Matrix,default:UniformGroup.from({uSamplers:i},!0)},a=e.plugins[r]._shader.program;DEFAULT_SHADERS[r]=new Shader(a,o)}t=DEFAULT_SHADERS[r]}return t},t.prototype._calculateBounds=function(){this.finishPoly();var e=this._geometry;if(e.graphicsData.length){var t=e.bounds,r=t.minX,n=t.minY,i=t.maxX,s=t.maxY;this._bounds.addFrame(this.transform,r,n,i,s)}},t.prototype.containsPoint=function(e){return this.worldTransform.applyInverse(e,t._TEMP_POINT),this._geometry.containsPoint(t._TEMP_POINT)},t.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var e=hex2rgb(this.tint,temp),t=0;t<this.batches.length;t++){var r=this.batches[t],n=r._batchRGB,i=(e[0]*n[0]*255<<16)+(e[1]*n[1]*255<<8)+(0|e[2]*n[2]*255);r._tintRGB=(i>>16)+(65280&i)+((255&i)<<16)}}},t.prototype.calculateVertices=function(){var e=this.transform._worldID;if(this._transformID!==e){this._transformID=e;for(var t=this.transform.worldTransform,r=t.a,n=t.b,i=t.c,s=t.d,o=t.tx,a=t.ty,l=this._geometry.points,h=this.vertexData,u=0,c=0;c<l.length;c+=2){var d=l[c],f=l[c+1];h[u++]=r*d+i*f+o,h[u++]=s*f+n*d+a}}},t.prototype.closePath=function(){var e=this.currentPath;return e&&(e.closeStroke=!0),this},t.prototype.setMatrix=function(e){return this._matrix=e,this},t.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},t.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},t.prototype.destroy=function(t){this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,e.prototype.destroy.call(this,t)},t._TEMP_POINT=new Point,t}(Container),extendStatics8=function(e,t){return extendStatics8=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},extendStatics8(e,t)};function __extends8(e,t){function r(){this.constructor=e}extendStatics8(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var tempPoint=new Point,indices=new Uint16Array([0,1,2,0,2,3]),Sprite=function(e){function t(t){var r=e.call(this)||this;return r._anchor=new ObservablePoint(r._onAnchorUpdate,r,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),r._texture=null,r._width=0,r._height=0,r._tint=null,r._tintRGB=null,r.tint=16777215,r.blendMode=BLEND_MODES2.NORMAL,r._cachedTint=16777215,r.uvs=null,r.texture=t||Texture.EMPTY,r.vertexData=new Float32Array(8),r.vertexTrimmedData=null,r._transformID=-1,r._textureID=-1,r._transformTrimmedID=-1,r._textureTrimmedID=-1,r.indices=indices,r.pluginName="batch",r.isSprite=!0,r._roundPixels=settings.ROUND_PIXELS,r}return __extends8(t,e),t.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=sign(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=sign(this.scale.y)*this._height/this._texture.orig.height)},t.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},t.prototype.calculateVertices=function(){var e=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==e._updateID){this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;var t=this.transform.worldTransform,r=t.a,n=t.b,i=t.c,s=t.d,o=t.tx,a=t.ty,l=this.vertexData,h=e.trim,u=e.orig,c=this._anchor,d=0,f=0,p=0,m=0;if(h?(d=(f=h.x-c._x*u.width)+h.width,p=(m=h.y-c._y*u.height)+h.height):(d=(f=-c._x*u.width)+u.width,p=(m=-c._y*u.height)+u.height),l[0]=r*f+i*m+o,l[1]=s*m+n*f+a,l[2]=r*d+i*m+o,l[3]=s*m+n*d+a,l[4]=r*d+i*p+o,l[5]=s*p+n*d+a,l[6]=r*f+i*p+o,l[7]=s*p+n*f+a,this._roundPixels)for(var _=settings.RESOLUTION,g=0;g<l.length;++g)l[g]=Math.round((l[g]*_|0)/_)}},t.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var e=this._texture,t=this.vertexTrimmedData,r=e.orig,n=this._anchor,i=this.transform.worldTransform,s=i.a,o=i.b,a=i.c,l=i.d,h=i.tx,u=i.ty,c=-n._x*r.width,d=c+r.width,f=-n._y*r.height,p=f+r.height;t[0]=s*c+a*f+h,t[1]=l*f+o*c+u,t[2]=s*d+a*f+h,t[3]=l*f+o*d+u,t[4]=s*d+a*p+h,t[5]=l*p+o*d+u,t[6]=s*c+a*p+h,t[7]=l*p+o*c+u},t.prototype._render=function(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)},t.prototype._calculateBounds=function(){var e=this._texture.trim,t=this._texture.orig;!e||e.width===t.width&&e.height===t.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},t.prototype.getLocalBounds=function(t){return 0===this.children.length?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new Rectangle),t=this._localBoundsRect),this._bounds.getRectangle(t)):e.prototype.getLocalBounds.call(this,t)},t.prototype.containsPoint=function(e){this.worldTransform.applyInverse(e,tempPoint);var t=this._texture.orig.width,r=this._texture.orig.height,n=-t*this.anchor.x,i=0;return!!(tempPoint.x>=n&&tempPoint.x<n+t&&(i=-r*this.anchor.y,tempPoint.y>=i&&tempPoint.y<i+r))},t.prototype.destroy=function(t){if(e.prototype.destroy.call(this,t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof t?t:t&&t.texture){var r="boolean"==typeof t?t:t&&t.baseTexture;this._texture.destroy(!!r)}this._texture=null},t.from=function(e,r){return new t(e instanceof Texture?e:Texture.from(e,r))},Object.defineProperty(t.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(e){var t=sign(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(e){var t=sign(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"anchor",{get:function(){return this._anchor},set:function(e){this._anchor.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tint",{get:function(){return this._tint},set:function(e){this._tint=e,this._tintRGB=(e>>16)+(65280&e)+((255&e)<<16)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"texture",{get:function(){return this._texture},set:function(e){this._texture!==e&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=e||Texture.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))},enumerable:!1,configurable:!0}),t}(Container),extendStatics9=function(e,t){return extendStatics9=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},extendStatics9(e,t)},TEXT_GRADIENT,TEXT_GRADIENT2;function __extends9(e,t){function r(){this.constructor=e}extendStatics9(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}TEXT_GRADIENT2=TEXT_GRADIENT||(TEXT_GRADIENT={}),TEXT_GRADIENT2[TEXT_GRADIENT2.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",TEXT_GRADIENT2[TEXT_GRADIENT2.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL";var defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:TEXT_GRADIENT.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},genericFontFamilies=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],TextStyle=function(){function e(e){this.styleID=0,this.reset(),deepCopyProperties(this,e,e)}return e.prototype.clone=function(){var t={};return deepCopyProperties(t,this,defaultStyle),new e(t)},e.prototype.reset=function(){deepCopyProperties(this,defaultStyle,defaultStyle)},Object.defineProperty(e.prototype,"align",{get:function(){return this._align},set:function(e){this._align!==e&&(this._align=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"breakWords",{get:function(){return this._breakWords},set:function(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dropShadow",{get:function(){return this._dropShadow},set:function(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dropShadowAlpha",{get:function(){return this._dropShadowAlpha},set:function(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dropShadowAngle",{get:function(){return this._dropShadowAngle},set:function(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dropShadowBlur",{get:function(){return this._dropShadowBlur},set:function(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dropShadowColor",{get:function(){return this._dropShadowColor},set:function(e){var t=getColor(e);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dropShadowDistance",{get:function(){return this._dropShadowDistance},set:function(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fill",{get:function(){return this._fill},set:function(e){var t=getColor(e);this._fill!==t&&(this._fill=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fillGradientType",{get:function(){return this._fillGradientType},set:function(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fillGradientStops",{get:function(){return this._fillGradientStops},set:function(e){areArraysEqual(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return this._fontSize},set:function(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontVariant",{get:function(){return this._fontVariant},set:function(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineHeight",{get:function(){return this._lineHeight},set:function(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"leading",{get:function(){return this._leading},set:function(e){this._leading!==e&&(this._leading=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineJoin",{get:function(){return this._lineJoin},set:function(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"miterLimit",{get:function(){return this._miterLimit},set:function(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"padding",{get:function(){return this._padding},set:function(e){this._padding!==e&&(this._padding=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stroke",{get:function(){return this._stroke},set:function(e){var t=getColor(e);this._stroke!==t&&(this._stroke=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"strokeThickness",{get:function(){return this._strokeThickness},set:function(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textBaseline",{get:function(){return this._textBaseline},set:function(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"trim",{get:function(){return this._trim},set:function(e){this._trim!==e&&(this._trim=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"whiteSpace",{get:function(){return this._whiteSpace},set:function(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wordWrap",{get:function(){return this._wordWrap},set:function(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wordWrapWidth",{get:function(){return this._wordWrapWidth},set:function(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)},enumerable:!1,configurable:!0}),e.prototype.toFontString=function(){var e="number"==typeof this.fontSize?this.fontSize+"px":this.fontSize,t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(","));for(var r=t.length-1;r>=0;r--){var n=t[r].trim();!/([\"\'])[^\'\"]+\1/.test(n)&&genericFontFamilies.indexOf(n)<0&&(n='"'+n+'"'),t[r]=n}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+e+" "+t.join(",")},e}();function getSingleColor(e){return"number"==typeof e?hex2string(e):("string"==typeof e&&0===e.indexOf("0x")&&(e=e.replace("0x","#")),e)}function getColor(e){if(Array.isArray(e)){for(var t=0;t<e.length;++t)e[t]=getSingleColor(e[t]);return e}return getSingleColor(e)}function areArraysEqual(e,t){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;for(var r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}function deepCopyProperties(e,t,r){for(var n in r)Array.isArray(t[n])?e[n]=t[n].slice():e[n]=t[n]}var TextMetrics=function(){function e(e,t,r,n,i,s,o,a,l){this.text=e,this.style=t,this.width=r,this.height=n,this.lines=i,this.lineWidths=s,this.lineHeight=o,this.maxLineWidth=a,this.fontProperties=l}return e.measureText=function(t,r,n,i){void 0===i&&(i=e._canvas),n=null==n?r.wordWrap:n;var s=r.toFontString(),o=e.measureFont(s);0===o.fontSize&&(o.fontSize=r.fontSize,o.ascent=r.fontSize);var a=i.getContext("2d");a.font=s;for(var l=(n?e.wordWrap(t,r,i):t).split(/(?:\r\n|\r|\n)/),h=new Array(l.length),u=0,c=0;c<l.length;c++){var d=a.measureText(l[c]).width+(l[c].length-1)*r.letterSpacing;h[c]=d,u=Math.max(u,d)}var f=u+r.strokeThickness;r.dropShadow&&(f+=r.dropShadowDistance);var p=r.lineHeight||o.fontSize+r.strokeThickness,m=Math.max(p,o.fontSize+r.strokeThickness)+(l.length-1)*(p+r.leading);return r.dropShadow&&(m+=r.dropShadowDistance),new e(t,r,f,m,l,h,p+r.leading,u,o)},e.wordWrap=function(t,r,n){void 0===n&&(n=e._canvas);for(var i=n.getContext("2d"),s=0,o="",a="",l=Object.create(null),h=r.letterSpacing,u=r.whiteSpace,c=e.collapseSpaces(u),d=e.collapseNewlines(u),f=!c,p=r.wordWrapWidth+h,m=e.tokenize(t),_=0;_<m.length;_++){var g=m[_];if(e.isNewline(g)){if(!d){a+=e.addLine(o),f=!c,o="",s=0;continue}g=" "}if(c){var v=e.isBreakingSpace(g),y=e.isBreakingSpace(o[o.length-1]);if(v&&y)continue}var b=e.getFromCache(g,h,l,i);if(b>p)if(""!==o&&(a+=e.addLine(o),o="",s=0),e.canBreakWords(g,r.breakWords))for(var x=e.wordWrapSplit(g),S=0;S<x.length;S++){for(var T=x[S],E=1;x[S+E];){var A=x[S+E],w=T[T.length-1];if(e.canBreakChars(w,A,g,S,r.breakWords))break;T+=A,E++}S+=T.length-1;var C=e.getFromCache(T,h,l,i);C+s>p&&(a+=e.addLine(o),f=!1,o="",s=0),o+=T,s+=C}else{o.length>0&&(a+=e.addLine(o),o="",s=0);var O=_===m.length-1;a+=e.addLine(g,!O),f=!1,o="",s=0}else b+s>p&&(f=!1,a+=e.addLine(o),o="",s=0),(o.length>0||!e.isBreakingSpace(g)||f)&&(o+=g,s+=b)}return a+e.addLine(o,!1)},e.addLine=function(t,r){return void 0===r&&(r=!0),t=e.trimRight(t),r?t+"\n":t},e.getFromCache=function(e,t,r,n){var i=r[e];if("number"!=typeof i){var s=e.length*t;i=n.measureText(e).width+s,r[e]=i}return i},e.collapseSpaces=function(e){return"normal"===e||"pre-line"===e},e.collapseNewlines=function(e){return"normal"===e},e.trimRight=function(t){if("string"!=typeof t)return"";for(var r=t.length-1;r>=0;r--){var n=t[r];if(!e.isBreakingSpace(n))break;t=t.slice(0,-1)}return t},e.isNewline=function(t){return"string"==typeof t&&e._newlines.indexOf(t.charCodeAt(0))>=0},e.isBreakingSpace=function(t,r){return"string"==typeof t&&e._breakingSpaces.indexOf(t.charCodeAt(0))>=0},e.tokenize=function(t){var r=[],n="";if("string"!=typeof t)return r;for(var i=0;i<t.length;i++){var s=t[i],o=t[i+1];e.isBreakingSpace(s,o)||e.isNewline(s)?(""!==n&&(r.push(n),n=""),r.push(s)):n+=s}return""!==n&&r.push(n),r},e.canBreakWords=function(e,t){return t},e.canBreakChars=function(e,t,r,n,i){return!0},e.wordWrapSplit=function(e){return e.split("")},e.measureFont=function(t){if(e._fonts[t])return e._fonts[t];var r={ascent:0,descent:0,fontSize:0},n=e._canvas,i=e._context;i.font=t;var s=e.METRICS_STRING+e.BASELINE_SYMBOL,o=Math.ceil(i.measureText(s).width),a=Math.ceil(i.measureText(e.BASELINE_SYMBOL).width),l=Math.ceil(e.HEIGHT_MULTIPLIER*a);a=a*e.BASELINE_MULTIPLIER|0,n.width=o,n.height=l,i.fillStyle="#f00",i.fillRect(0,0,o,l),i.font=t,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(s,0,a);var h=i.getImageData(0,0,o,l).data,u=h.length,c=4*o,d=0,f=0,p=!1;for(d=0;d<a;++d){for(var m=0;m<c;m+=4)if(255!==h[f+m]){p=!0;break}if(p)break;f+=c}for(r.ascent=a-d,f=u-c,p=!1,d=l;d>a;--d){for(m=0;m<c;m+=4)if(255!==h[f+m]){p=!0;break}if(p)break;f-=c}return r.descent=d-a,r.fontSize=r.ascent+r.descent,e._fonts[t]=r,r},e.clearMetrics=function(t){void 0===t&&(t=""),t?delete e._fonts[t]:e._fonts={}},e}(),canvas=function(){try{var e=new OffscreenCanvas(0,0),t=e.getContext("2d");return t&&t.measureText?e:document.createElement("canvas")}catch(e){return document.createElement("canvas")}}();canvas.width=canvas.height=10,TextMetrics._canvas=canvas,TextMetrics._context=canvas.getContext("2d"),TextMetrics._fonts={},TextMetrics.METRICS_STRING="|q",TextMetrics.BASELINE_SYMBOL="M",TextMetrics.BASELINE_MULTIPLIER=1.4,TextMetrics.HEIGHT_MULTIPLIER=2,TextMetrics._newlines=[10,13],TextMetrics._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},Text=function(e){function t(t,r,n){var i=this,s=!1;n||(n=document.createElement("canvas"),s=!0),n.width=3,n.height=3;var o=Texture.from(n);return o.orig=new Rectangle,o.trim=new Rectangle,(i=e.call(this,o)||this)._ownCanvas=s,i.canvas=n,i.context=i.canvas.getContext("2d"),i._resolution=settings.RESOLUTION,i._autoResolution=!0,i._text=null,i._style=null,i._styleListener=null,i._font="",i.text=t,i.style=r,i.localStyleID=-1,i}return __extends9(t,e),t.prototype.updateText=function(e){var r=this._style;if(this.localStyleID!==r.styleID&&(this.dirty=!0,this.localStyleID=r.styleID),this.dirty||!e){this._font=this._style.toFontString();var n=this.context,i=TextMetrics.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),s=i.width,o=i.height,a=i.lines,l=i.lineHeight,h=i.lineWidths,u=i.maxLineWidth,c=i.fontProperties;this.canvas.width=Math.ceil((Math.max(1,s)+2*r.padding)*this._resolution),this.canvas.height=Math.ceil((Math.max(1,o)+2*r.padding)*this._resolution),n.scale(this._resolution,this._resolution),n.clearRect(0,0,this.canvas.width,this.canvas.height),n.font=this._font,n.lineWidth=r.strokeThickness,n.textBaseline=r.textBaseline,n.lineJoin=r.lineJoin,n.miterLimit=r.miterLimit;for(var d,f,p=r.dropShadow?2:1,m=0;m<p;++m){var _=r.dropShadow&&0===m,g=_?Math.ceil(Math.max(1,o)+2*r.padding):0,v=g*this._resolution;if(_){n.fillStyle="black",n.strokeStyle="black";var y=r.dropShadowColor,b=hex2rgb("number"==typeof y?y:string2hex(y));n.shadowColor="rgba("+255*b[0]+","+255*b[1]+","+255*b[2]+","+r.dropShadowAlpha+")",n.shadowBlur=r.dropShadowBlur,n.shadowOffsetX=Math.cos(r.dropShadowAngle)*r.dropShadowDistance,n.shadowOffsetY=Math.sin(r.dropShadowAngle)*r.dropShadowDistance+v}else n.fillStyle=this._generateFillStyle(r,a,i),n.strokeStyle=r.stroke,n.shadowColor="black",n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0;var x=(l-c.fontSize)/2;(!t.nextLineHeightBehavior||l-c.fontSize<0)&&(x=0);for(var S=0;S<a.length;S++)d=r.strokeThickness/2,f=r.strokeThickness/2+S*l+c.ascent+x,"right"===r.align?d+=u-h[S]:"center"===r.align&&(d+=(u-h[S])/2),r.stroke&&r.strokeThickness&&this.drawLetterSpacing(a[S],d+r.padding,f+r.padding-g,!0),r.fill&&this.drawLetterSpacing(a[S],d+r.padding,f+r.padding-g)}this.updateTexture()}},t.prototype.drawLetterSpacing=function(e,t,r,n){void 0===n&&(n=!1);var i=this._style.letterSpacing;if(0!==i)for(var s=t,o=Array.from?Array.from(e):e.split(""),a=this.context.measureText(e).width,l=0,h=0;h<o.length;++h){var u=o[h];n?this.context.strokeText(u,s,r):this.context.fillText(u,s,r),s+=a-(l=this.context.measureText(e.substring(h+1)).width)+i,a=l}else n?this.context.strokeText(e,t,r):this.context.fillText(e,t,r)},t.prototype.updateTexture=function(){var e=this.canvas;if(this._style.trim){var t=trimCanvas(e);t.data&&(e.width=t.width,e.height=t.height,this.context.putImageData(t.data,0,0))}var r=this._texture,n=this._style,i=n.trim?0:n.padding,s=r.baseTexture;r.trim.width=r._frame.width=Math.ceil(e.width/this._resolution),r.trim.height=r._frame.height=Math.ceil(e.height/this._resolution),r.trim.x=-i,r.trim.y=-i,r.orig.width=r._frame.width-2*i,r.orig.height=r._frame.height-2*i,this._onTextureUpdate(),s.setRealSize(e.width,e.height,this._resolution),this._recursivePostUpdateTransform(),this.dirty=!1},t.prototype._render=function(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),e.prototype._render.call(this,t)},t.prototype.getLocalBounds=function(t){return this.updateText(!0),e.prototype.getLocalBounds.call(this,t)},t.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},t.prototype._generateFillStyle=function(e,t,r){var n=e.fill;if(!Array.isArray(n))return n;if(1===n.length)return n[0];var i,s=e.dropShadow?e.dropShadowDistance:0,o=e.padding||0,a=Math.ceil(this.canvas.width/this._resolution)-s-2*o,l=Math.ceil(this.canvas.height/this._resolution)-s-2*o,h=n.slice(),u=e.fillGradientStops.slice();if(!u.length)for(var c=h.length+1,d=1;d<c;++d)u.push(d/c);if(h.unshift(n[0]),u.unshift(0),h.push(n[n.length-1]),u.push(1),e.fillGradientType===TEXT_GRADIENT.LINEAR_VERTICAL){i=this.context.createLinearGradient(a/2,o,a/2,l+o);var f=(r.fontProperties.fontSize+e.strokeThickness)/l;for(d=0;d<t.length;d++)for(var p=r.lineHeight*d,m=0;m<h.length;m++){var _;_="number"==typeof u[m]?u[m]:m/h.length;var g=Math.min(1,Math.max(0,p/l+_*f));g=Number(g.toFixed(5)),i.addColorStop(g,h[m])}}else{i=this.context.createLinearGradient(o,l/2,a+o,l/2);var v=h.length+1,y=1;for(d=0;d<h.length;d++){var b;b="number"==typeof u[d]?u[d]:y/v,i.addColorStop(b,h[d]),y++}}return i},t.prototype.destroy=function(t){"boolean"==typeof t&&(t={children:t}),t=Object.assign({},defaultDestroyOptions,t),e.prototype.destroy.call(this,t),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null},Object.defineProperty(t.prototype,"width",{get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(e){this.updateText(!0);var t=sign(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(e){this.updateText(!0);var t=sign(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return this._style},set:function(e){e=e||{},this._style=e instanceof TextStyle?e:new TextStyle(e),this.localStyleID=-1,this.dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){e=String(null==e?"":e),this._text!==e&&(this._text=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resolution",{get:function(){return this._resolution},set:function(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)},enumerable:!1,configurable:!0}),t.nextLineHeightBehavior=!1,t}(Sprite);settings.UPLOADS_PER_FRAME=4;var extendStatics10=function(e,t){return extendStatics10=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},extendStatics10(e,t)};function __extends10(e,t){function r(){this.constructor=e}extendStatics10(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var CountLimiter=function(){function e(e){this.maxItemsPerFrame=e,this.itemsLeft=0}return e.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},e.prototype.allowedToUpload=function(){return this.itemsLeft-- >0},e}();function findMultipleBaseTextures(e,t){var r=!1;if(e&&e._textures&&e._textures.length)for(var n=0;n<e._textures.length;n++)if(e._textures[n]instanceof Texture){var i=e._textures[n].baseTexture;-1===t.indexOf(i)&&(t.push(i),r=!0)}return r}function findBaseTexture(e,t){if(e.baseTexture instanceof BaseTexture){var r=e.baseTexture;return-1===t.indexOf(r)&&t.push(r),!0}return!1}function findTexture(e,t){if(e._texture&&e._texture instanceof Texture){var r=e._texture.baseTexture;return-1===t.indexOf(r)&&t.push(r),!0}return!1}function drawText(e,t){return t instanceof Text&&(t.updateText(!0),!0)}function calculateTextStyle(e,t){if(t instanceof TextStyle){var r=t.toFontString();return TextMetrics.measureFont(r),!0}return!1}function findText(e,t){if(e instanceof Text){-1===t.indexOf(e.style)&&t.push(e.style),-1===t.indexOf(e)&&t.push(e);var r=e._texture.baseTexture;return-1===t.indexOf(r)&&t.push(r),!0}return!1}function findTextStyle(e,t){return e instanceof TextStyle&&(-1===t.indexOf(e)&&t.push(e),!0)}var BasePrepare=function(){function e(e){var t=this;this.limiter=new CountLimiter(settings.UPLOADS_PER_FRAME),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){!t.queue||t.prepareItems()},this.registerFindHook(findText),this.registerFindHook(findTextStyle),this.registerFindHook(findMultipleBaseTextures),this.registerFindHook(findBaseTexture),this.registerFindHook(findTexture),this.registerUploadHook(drawText),this.registerUploadHook(calculateTextStyle)}return e.prototype.upload=function(e,t){"function"==typeof e&&(t=e,e=null),e&&this.add(e),this.queue.length?(t&&this.completes.push(t),this.ticking||(this.ticking=!0,Ticker.system.addOnce(this.tick,this,UPDATE_PRIORITY.UTILITY))):t&&t()},e.prototype.tick=function(){setTimeout(this.delayedTick,0)},e.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var e=this.queue[0],t=!1;if(e&&!e._destroyed)for(var r=0,n=this.uploadHooks.length;r<n;r++)if(this.uploadHooks[r](this.uploadHookHelper,e)){this.queue.shift(),t=!0;break}t||this.queue.shift()}if(this.queue.length)Ticker.system.addOnce(this.tick,this,UPDATE_PRIORITY.UTILITY);else{this.ticking=!1;var i=this.completes.slice(0);for(this.completes.length=0,r=0,n=i.length;r<n;r++)i[r]()}},e.prototype.registerFindHook=function(e){return e&&this.addHooks.push(e),this},e.prototype.registerUploadHook=function(e){return e&&this.uploadHooks.push(e),this},e.prototype.add=function(e){for(var t=0,r=this.addHooks.length;t<r&&!this.addHooks[t](e,this.queue);t++);if(e instanceof Container)for(t=e.children.length-1;t>=0;t--)this.add(e.children[t]);return this},e.prototype.destroy=function(){this.ticking&&Ticker.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},e}();function uploadBaseTextures(e,t){return t instanceof BaseTexture&&(t._glTextures[e.CONTEXT_UID]||e.texture.bind(t),!0)}function uploadGraphics(e,t){if(!(t instanceof Graphics))return!1;var r=t.geometry;t.finishPoly(),r.updateBatches();for(var n=r.batches,i=0;i<n.length;i++){var s=n[i].style.texture;s&&uploadBaseTextures(e,s.baseTexture)}return r.batchable||e.geometry.bind(r,t._resolveDirectShader(e)),!0}function findGraphics(e,t){return e instanceof Graphics&&(t.push(e),!0)}var Prepare=function(e){function t(t){var r=e.call(this,t)||this;return r.uploadHookHelper=r.renderer,r.registerFindHook(findGraphics),r.registerUploadHook(uploadBaseTextures),r.registerUploadHook(uploadGraphics),r}return __extends10(t,e),t}(BasePrepare),TimeLimiter=function(){function e(e){this.maxMilliseconds=e,this.frameStart=0}return e.prototype.beginFrame=function(){this.frameStart=Date.now()},e.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds},e}(),Spritesheet=function(){function e(e,t,r){void 0===r&&(r=null),this._texture=e instanceof Texture?e:null,this.baseTexture=e instanceof BaseTexture?e:this._texture.baseTexture,this.textures={},this.animations={},this.data=t;var n=this.baseTexture.resource;this.resolution=this._updateResolution(r||(n?n.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return e.prototype._updateResolution=function(e){void 0===e&&(e=null);var t=this.data.meta.scale,r=getResolutionOfUrl(e,null);return null===r&&(r=void 0!==t?parseFloat(t):1),1!==r&&this.baseTexture.setResolution(r),r},e.prototype.parse=function(t){this._batchIndex=0,this._callback=t,this._frameKeys.length<=e.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()},e.prototype._processFrames=function(t){for(var r=t,n=e.BATCH_SIZE;r-t<n&&r<this._frameKeys.length;){var i=this._frameKeys[r],s=this._frames[i],o=s.frame;if(o){var a,l=null,h=!1!==s.trimmed&&s.sourceSize?s.sourceSize:s.frame,u=new Rectangle(0,0,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution);a=s.rotated?new Rectangle(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):new Rectangle(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),!1!==s.trimmed&&s.spriteSourceSize&&(l=new Rectangle(Math.floor(s.spriteSourceSize.x)/this.resolution,Math.floor(s.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[i]=new Texture(this.baseTexture,a,u,l,s.rotated?2:0,s.anchor),Texture.addToCache(this.textures[i],i)}r++}},e.prototype._processAnimations=function(){var e=this.data.animations||{};for(var t in e){this.animations[t]=[];for(var r=0;r<e[t].length;r++){var n=e[t][r];this.animations[t].push(this.textures[n])}}},e.prototype._parseComplete=function(){var e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)},e.prototype._nextBatch=function(){var t=this;this._processFrames(this._batchIndex*e.BATCH_SIZE),this._batchIndex++,setTimeout((function(){t._batchIndex*e.BATCH_SIZE<t._frameKeys.length?t._nextBatch():(t._processAnimations(),t._parseComplete())}),0)},e.prototype.destroy=function(e){var t;for(var r in void 0===e&&(e=!1),this.textures)this.textures[r].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&(null===(t=this._texture)||void 0===t||t.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null},e.BATCH_SIZE=1e3,e}(),SpritesheetLoader=function(){function e(){}return e.use=function(t,r){var n,i,s=this,o=t.name+"_image";if(t.data&&t.type===LoaderResource.TYPE.JSON&&t.data.frames&&!s.resources[o]){var a=null===(i=null===(n=t.data)||void 0===n?void 0:n.meta)||void 0===i?void 0:i.related_multi_packs;if(Array.isArray(a))for(var l=function(e){if("string"!=typeof e)return"continue";var r=e.replace(".json",""),n=url.resolve(t.url.replace(s.baseUrl,""),e);if(s.resources[r]||Object.values(s.resources).some((function(e){return url.format(url.parse(e.url))===n})))return"continue";var i={crossOrigin:t.crossOrigin,loadType:LoaderResource.LOAD_TYPE.XHR,xhrType:LoaderResource.XHR_RESPONSE_TYPE.JSON,parentResource:t};s.add(r,n,i)},h=0,u=a;h<u.length;h++)l(u[h]);var c={crossOrigin:t.crossOrigin,metadata:t.metadata.imageMetadata,parentResource:t},d=e.getResourcePath(t,s.baseUrl);s.add(o,d,c,(function(e){if(e.error)r(e.error);else{var n=new Spritesheet(e.texture,t.data,t.url);n.parse((function(){t.spritesheet=n,t.textures=n.textures,r()}))}}))}else r()},e.getResourcePath=function(e,t){return e.isDataUrl?e.data.meta.image:url.resolve(e.url.replace(t,""),e.data.meta.image)},e}(),extendStatics11=function(e,t){return extendStatics11=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},extendStatics11(e,t)};function __extends11(e,t){function r(){this.constructor=e}extendStatics11(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var tempPoint2=new Point,TilingSprite=function(e){function t(t,r,n){void 0===r&&(r=100),void 0===n&&(n=100);var i=e.call(this,t)||this;return i.tileTransform=new Transform,i._width=r,i._height=n,i.uvMatrix=i.texture.uvMatrix||new TextureMatrix(t),i.pluginName="tilingSprite",i.uvRespectAnchor=!1,i}return __extends11(t,e),Object.defineProperty(t.prototype,"clampMargin",{get:function(){return this.uvMatrix.clampMargin},set:function(e){this.uvMatrix.clampMargin=e,this.uvMatrix.update(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tileScale",{get:function(){return this.tileTransform.scale},set:function(e){this.tileTransform.scale.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tilePosition",{get:function(){return this.tileTransform.position},set:function(e){this.tileTransform.position.copyFrom(e)},enumerable:!1,configurable:!0}),t.prototype._onTextureUpdate=function(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215},t.prototype._render=function(e){var t=this._texture;!t||!t.valid||(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this))},t.prototype._calculateBounds=function(){var e=this._width*-this._anchor._x,t=this._height*-this._anchor._y,r=this._width*(1-this._anchor._x),n=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,e,t,r,n)},t.prototype.getLocalBounds=function(t){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new Rectangle),t=this._localBoundsRect),this._bounds.getRectangle(t)):e.prototype.getLocalBounds.call(this,t)},t.prototype.containsPoint=function(e){this.worldTransform.applyInverse(e,tempPoint2);var t=this._width,r=this._height,n=-t*this.anchor._x;if(tempPoint2.x>=n&&tempPoint2.x<n+t){var i=-r*this.anchor._y;if(tempPoint2.y>=i&&tempPoint2.y<i+r)return!0}return!1},t.prototype.destroy=function(t){e.prototype.destroy.call(this,t),this.tileTransform=null,this.uvMatrix=null},t.from=function(e,r){return new t(e instanceof Texture?e:Texture.from(e,r),r.width,r.height)},Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e},enumerable:!1,configurable:!0}),t}(Sprite),vertex3="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n",fragment3="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 texSample = texture2D(uSampler, coord);\n    gl_FragColor = texSample * uColor;\n}\n",fragmentSimple="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 sample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = sample * uColor;\n}\n",tempMat2=new Matrix,TilingSpriteRenderer=function(e){function t(t){var r=e.call(this,t)||this,n={globals:r.renderer.globalUniforms};return r.shader=Shader.from(vertex3,fragment3,n),r.simpleShader=Shader.from(vertex3,fragmentSimple,n),r.quad=new QuadUv,r.state=State.for2d(),r}return __extends11(t,e),t.prototype.render=function(e){var t=this.renderer,r=this.quad,n=r.vertices;n[0]=n[6]=e._width*-e.anchor.x,n[1]=n[3]=e._height*-e.anchor.y,n[2]=n[4]=e._width*(1-e.anchor.x),n[5]=n[7]=e._height*(1-e.anchor.y);var i=e.uvRespectAnchor?e.anchor.x:0,s=e.uvRespectAnchor?e.anchor.y:0;(n=r.uvs)[0]=n[6]=-i,n[1]=n[3]=-s,n[2]=n[4]=1-i,n[5]=n[7]=1-s,r.invalidate();var o=e._texture,a=o.baseTexture,l=e.tileTransform.localTransform,h=e.uvMatrix,u=a.isPowerOfTwo&&o.frame.width===a.width&&o.frame.height===a.height;u&&(a._glTextures[t.CONTEXT_UID]?u=a.wrapMode!==WRAP_MODES2.CLAMP:a.wrapMode===WRAP_MODES2.CLAMP&&(a.wrapMode=WRAP_MODES2.REPEAT));var c=u?this.simpleShader:this.shader,d=o.width,f=o.height,p=e._width,m=e._height;tempMat2.set(l.a*d/p,l.b*d/m,l.c*f/p,l.d*f/m,l.tx/p,l.ty/m),tempMat2.invert(),u?tempMat2.prepend(h.mapCoord):(c.uniforms.uMapCoord=h.mapCoord.toArray(!0),c.uniforms.uClampFrame=h.uClampFrame,c.uniforms.uClampOffset=h.uClampOffset),c.uniforms.uTransform=tempMat2.toArray(!0),c.uniforms.uColor=premultiplyTintToRgba(e.tint,e.worldAlpha,c.uniforms.uColor,a.alphaMode),c.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),c.uniforms.uSampler=o,t.shader.bind(c),t.geometry.bind(r),this.state.blendMode=correctBlendMode(e.blendMode,a.alphaMode),t.state.set(this.state),t.geometry.draw(this.renderer.gl.TRIANGLES,6,0)},t}(ObjectRenderer),extendStatics12=function(e,t){return extendStatics12=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},extendStatics12(e,t)};function __extends12(e,t){function r(){this.constructor=e}extendStatics12(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var MeshBatchUvs=function(){function e(e,t){this.uvBuffer=e,this.uvMatrix=t,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}return e.prototype.update=function(e){if(e||this._bufferUpdateId!==this.uvBuffer._updateID||this._textureUpdateId!==this.uvMatrix._updateID){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var t=this.uvBuffer.data;(!this.data||this.data.length!==t.length)&&(this.data=new Float32Array(t.length)),this.uvMatrix.multiplyUvs(t,this.data),this._updateID++}},e}(),tempPoint3=new Point,tempPolygon=new Polygon,Mesh=function(e){function t(t,r,n,i){void 0===i&&(i=DRAW_MODES2.TRIANGLES);var s=e.call(this)||this;return s.geometry=t,t.refCount++,s.shader=r,s.state=n||State.for2d(),s.drawMode=i,s.start=0,s.size=0,s.uvs=null,s.indices=null,s.vertexData=new Float32Array(1),s.vertexDirty=-1,s._transformID=-1,s._roundPixels=settings.ROUND_PIXELS,s.batchUvs=null,s}return __extends12(t,e),Object.defineProperty(t.prototype,"uvBuffer",{get:function(){return this.geometry.buffers[1]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticesBuffer",{get:function(){return this.geometry.buffers[0]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"material",{get:function(){return this.shader},set:function(e){this.shader=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(e){this.state.blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tint",{get:function(){return"tint"in this.shader?this.shader.tint:null},set:function(e){this.shader.tint=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"texture",{get:function(){return"texture"in this.shader?this.shader.texture:null},set:function(e){this.shader.texture=e},enumerable:!1,configurable:!0}),t.prototype._render=function(e){var r=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===DRAW_MODES2.TRIANGLES&&r.length<2*t.BATCHABLE_SIZE?this._renderToBatch(e):this._renderDefault(e)},t.prototype._renderDefault=function(e){var t=this.shader;t.alpha=this.worldAlpha,t.update&&t.update(),e.batch.flush(),t.program.uniformData.translationMatrix&&(t.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0)),e.shader.bind(t),e.state.set(this.state),e.geometry.bind(this.geometry,t),e.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},t.prototype._renderToBatch=function(e){var t=this.geometry,r=this.shader;r.uvMatrix&&(r.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=t.indexBuffer.data,this._tintRGB=r._tintRGB,this._texture=r.texture;var n=this.material.pluginName;e.batch.setObjectRenderer(e.plugins[n]),e.plugins[n].render(this)},t.prototype.calculateVertices=function(){var e=this.geometry.buffers[0],t=e.data,r=e._updateID;if(r!==this.vertexDirty||this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID,this.vertexData.length!==t.length&&(this.vertexData=new Float32Array(t.length));for(var n=this.transform.worldTransform,i=n.a,s=n.b,o=n.c,a=n.d,l=n.tx,h=n.ty,u=this.vertexData,c=0;c<u.length/2;c++){var d=t[2*c],f=t[2*c+1];u[2*c]=i*d+o*f+l,u[2*c+1]=s*d+a*f+h}if(this._roundPixels){var p=settings.RESOLUTION;for(c=0;c<u.length;++c)u[c]=Math.round((u[c]*p|0)/p)}this.vertexDirty=r}},t.prototype.calculateUvs=function(){var e=this.geometry.buffers[1],t=this.shader;t.uvMatrix.isSimple?this.uvs=e.data:(this.batchUvs||(this.batchUvs=new MeshBatchUvs(e,t.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)},t.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)},t.prototype.containsPoint=function(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,tempPoint3);for(var t=this.geometry.getBuffer("aVertexPosition").data,r=tempPolygon.points,n=this.geometry.getIndex().data,i=n.length,s=4===this.drawMode?3:1,o=0;o+2<i;o+=s){var a=2*n[o],l=2*n[o+1],h=2*n[o+2];if(r[0]=t[a],r[1]=t[a+1],r[2]=t[l],r[3]=t[l+1],r[4]=t[h],r[5]=t[h+1],tempPolygon.contains(tempPoint3.x,tempPoint3.y))return!0}return!1},t.prototype.destroy=function(t){e.prototype.destroy.call(this,t),this.geometry.refCount--,0===this.geometry.refCount&&this.geometry.dispose(),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null},t.BATCHABLE_SIZE=100,t}(Container),fragment4="varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n",vertex4="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n",MeshMaterial=function(e){function t(t,r){var n=this,i={uSampler:t,alpha:1,uTextureMatrix:Matrix.IDENTITY,uColor:new Float32Array([1,1,1,1])};return(r=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},r)).uniforms&&Object.assign(i,r.uniforms),(n=e.call(this,r.program||Program.from(vertex4,fragment4),i)||this)._colorDirty=!1,n.uvMatrix=new TextureMatrix(t),n.batchable=void 0===r.program,n.pluginName=r.pluginName,n.tint=r.tint,n.alpha=r.alpha,n}return __extends12(t,e),Object.defineProperty(t.prototype,"texture",{get:function(){return this.uniforms.uSampler},set:function(e){this.uniforms.uSampler!==e&&(this.uniforms.uSampler=e,this.uvMatrix.texture=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(e){e!==this._alpha&&(this._alpha=e,this._colorDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tint",{get:function(){return this._tint},set:function(e){e!==this._tint&&(this._tint=e,this._tintRGB=(e>>16)+(65280&e)+((255&e)<<16),this._colorDirty=!0)},enumerable:!1,configurable:!0}),t.prototype.update=function(){if(this._colorDirty){this._colorDirty=!1;var e=this.texture.baseTexture;premultiplyTintToRgba(this._tint,this._alpha,this.uniforms.uColor,e.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)},t}(Shader),MeshGeometry=function(e){function t(t,r,n){var i=e.call(this)||this,s=new Buffer2(t),o=new Buffer2(r,!0),a=new Buffer2(n,!0,!0);return i.addAttribute("aVertexPosition",s,2,!1,TYPES2.FLOAT).addAttribute("aTextureCoord",o,2,!1,TYPES2.FLOAT).addIndex(a),i._updateId=-1,i}return __extends12(t,e),Object.defineProperty(t.prototype,"vertexDirtyId",{get:function(){return this.buffers[0]._updateID},enumerable:!1,configurable:!0}),t}(Geometry),extendStatics13=function(e,t){return extendStatics13=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},extendStatics13(e,t)};function __extends13(e,t){function r(){this.constructor=e}extendStatics13(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var BitmapFontData=function(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[]},TextFormat=function(){function e(){}return e.test=function(e){return"string"==typeof e&&0===e.indexOf("info face=")},e.parse=function(e){var t=e.match(/^[a-z]+\s+.+$/gm),r={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[]};for(var n in t){var i=t[n].match(/^[a-z]+/gm)[0],s=t[n].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),o={};for(var a in s){var l=s[a].split("="),h=l[0],u=l[1].replace(/"/gm,""),c=parseFloat(u),d=isNaN(c)?u:c;o[h]=d}r[i].push(o)}var f=new BitmapFontData;return r.info.forEach((function(e){return f.info.push({face:e.face,size:parseInt(e.size,10)})})),r.common.forEach((function(e){return f.common.push({lineHeight:parseInt(e.lineHeight,10)})})),r.page.forEach((function(e){return f.page.push({id:parseInt(e.id,10),file:e.file})})),r.char.forEach((function(e){return f.char.push({id:parseInt(e.id,10),page:parseInt(e.page,10),x:parseInt(e.x,10),y:parseInt(e.y,10),width:parseInt(e.width,10),height:parseInt(e.height,10),xoffset:parseInt(e.xoffset,10),yoffset:parseInt(e.yoffset,10),xadvance:parseInt(e.xadvance,10)})})),r.kerning.forEach((function(e){return f.kerning.push({first:parseInt(e.first,10),second:parseInt(e.second,10),amount:parseInt(e.amount,10)})})),f},e}(),XMLFormat=function(){function e(){}return e.test=function(e){return e instanceof XMLDocument&&e.getElementsByTagName("page").length&&null!==e.getElementsByTagName("info")[0].getAttribute("face")},e.parse=function(e){for(var t=new BitmapFontData,r=e.getElementsByTagName("info"),n=e.getElementsByTagName("common"),i=e.getElementsByTagName("page"),s=e.getElementsByTagName("char"),o=e.getElementsByTagName("kerning"),a=0;a<r.length;a++)t.info.push({face:r[a].getAttribute("face"),size:parseInt(r[a].getAttribute("size"),10)});for(a=0;a<n.length;a++)t.common.push({lineHeight:parseInt(n[a].getAttribute("lineHeight"),10)});for(a=0;a<i.length;a++)t.page.push({id:parseInt(i[a].getAttribute("id"),10)||0,file:i[a].getAttribute("file")});for(a=0;a<s.length;a++){var l=s[a];t.char.push({id:parseInt(l.getAttribute("id"),10),page:parseInt(l.getAttribute("page"),10)||0,x:parseInt(l.getAttribute("x"),10),y:parseInt(l.getAttribute("y"),10),width:parseInt(l.getAttribute("width"),10),height:parseInt(l.getAttribute("height"),10),xoffset:parseInt(l.getAttribute("xoffset"),10),yoffset:parseInt(l.getAttribute("yoffset"),10),xadvance:parseInt(l.getAttribute("xadvance"),10)})}for(a=0;a<o.length;a++)t.kerning.push({first:parseInt(o[a].getAttribute("first"),10),second:parseInt(o[a].getAttribute("second"),10),amount:parseInt(o[a].getAttribute("amount"),10)});return t},e}(),XMLStringFormat=function(){function e(){}return e.test=function(e){if("string"==typeof e&&e.indexOf("<font>")>-1){var t=(new self.DOMParser).parseFromString(e,"text/xml");return XMLFormat.test(t)}return!1},e.parse=function(e){var t=(new self.DOMParser).parseFromString(e,"text/xml");return XMLFormat.parse(t)},e}(),formats=[TextFormat,XMLFormat,XMLStringFormat];function autoDetectFormat(e){for(var t=0;t<formats.length;t++)if(formats[t].test(e))return formats[t];return null}function generateFillStyle(e,t,r,n,i,s){var o=r.fill;if(!Array.isArray(o))return o;if(1===o.length)return o[0];var a,l=r.dropShadow?r.dropShadowDistance:0,h=r.padding||0,u=Math.ceil(e.width/n)-l-2*h,c=Math.ceil(e.height/n)-l-2*h,d=o.slice(),f=r.fillGradientStops.slice();if(!f.length)for(var p=d.length+1,m=1;m<p;++m)f.push(m/p);if(d.unshift(o[0]),f.unshift(0),d.push(o[o.length-1]),f.push(1),r.fillGradientType===TEXT_GRADIENT.LINEAR_VERTICAL){a=t.createLinearGradient(u/2,h,u/2,c+h);var _=0,g=(s.fontProperties.fontSize+r.strokeThickness)/c;for(m=0;m<i.length;m++)for(var v=s.lineHeight*m,y=0;y<d.length;y++){var b=v/c+("number"==typeof f[y]?f[y]:y/d.length)*g,x=Math.max(_,b);x=Math.min(x,1),a.addColorStop(x,d[y]),_=x}}else{a=t.createLinearGradient(h,c/2,u+h,c/2);var S=d.length+1,T=1;for(m=0;m<d.length;m++){var E;E="number"==typeof f[m]?f[m]:T/S,a.addColorStop(E,d[m]),T++}}return a}function drawGlyph(e,t,r,n,i,s,o){var a=r.text,l=r.fontProperties;t.translate(n,i),t.scale(s,s);var h=o.strokeThickness/2,u=-o.strokeThickness/2;t.font=o.toFontString(),t.lineWidth=o.strokeThickness,t.textBaseline=o.textBaseline,t.lineJoin=o.lineJoin,t.miterLimit=o.miterLimit,t.fillStyle=generateFillStyle(e,t,o,s,[a],r),t.strokeStyle=o.stroke,t.font=o.toFontString(),t.lineWidth=o.strokeThickness,t.textBaseline=o.textBaseline,t.lineJoin=o.lineJoin,t.miterLimit=o.miterLimit,t.fillStyle=generateFillStyle(e,t,o,s,[a],r),t.strokeStyle=o.stroke;var c=o.dropShadowColor,d=hex2rgb("number"==typeof c?c:string2hex(c));o.dropShadow?(t.shadowColor="rgba("+255*d[0]+","+255*d[1]+","+255*d[2]+","+o.dropShadowAlpha+")",t.shadowBlur=o.dropShadowBlur,t.shadowOffsetX=Math.cos(o.dropShadowAngle)*o.dropShadowDistance,t.shadowOffsetY=Math.sin(o.dropShadowAngle)*o.dropShadowDistance):(t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0),o.stroke&&o.strokeThickness&&t.strokeText(a,h,u+r.lineHeight-l.descent),o.fill&&t.fillText(a,h,u+r.lineHeight-l.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function resolveCharacters(e){"string"==typeof e&&(e=[e]);for(var t=[],r=0,n=e.length;r<n;r++){var i=e[r];if(Array.isArray(i)){if(2!==i.length)throw new Error("[BitmapFont]: Invalid character range length, expecting 2 got "+i.length+".");var s=i[0].charCodeAt(0),o=i[1].charCodeAt(0);if(o<s)throw new Error("[BitmapFont]: Invalid character range.");for(var a=s,l=o;a<=l;a++)t.push(String.fromCharCode(a))}else t.push.apply(t,i.split(""))}if(0===t.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}var BitmapFont=function(){function e(e,t,r){var n=e.info[0],i=e.common[0],s=getResolutionOfUrl(e.page[0].file),o={};this._ownsTextures=r,this.font=n.face,this.size=n.size,this.lineHeight=i.lineHeight/s,this.chars={},this.pageTextures=o;for(var a=0;a<e.page.length;a++){var l=e.page[a],h=l.id,u=l.file;o[h]=t instanceof Array?t[a]:t[u]}for(a=0;a<e.char.length;a++){var c=e.char[a],d=(h=c.id,c.page),f=e.char[a],p=f.x,m=f.y,_=f.width,g=f.height,v=f.xoffset,y=f.yoffset,b=f.xadvance;m/=s,_/=s,g/=s,v/=s,y/=s,b/=s;var x=new Rectangle((p/=s)+o[d].frame.x/s,m+o[d].frame.y/s,_,g);this.chars[h]={xOffset:v,yOffset:y,xAdvance:b,kerning:{},texture:new Texture(o[d].baseTexture,x),page:d}}for(a=0;a<e.kerning.length;a++){var S=e.kerning[a],T=S.first,E=S.second,A=S.amount;T/=s,E/=s,A/=s,this.chars[E]&&(this.chars[E].kerning[T]=A)}}return e.prototype.destroy=function(){for(var e in this.chars)this.chars[e].texture.destroy(),this.chars[e].texture=null;for(var e in this.pageTextures)this._ownsTextures&&this.pageTextures[e].destroy(!0),this.pageTextures[e]=null;this.chars=null,this.pageTextures=null},e.install=function(t,r,n){var i;if(t instanceof BitmapFontData)i=t;else{var s=autoDetectFormat(t);if(!s)throw new Error("Unrecognized data format for font.");i=s.parse(t)}r instanceof Texture&&(r=[r]);var o=new e(i,r,n);return e.available[o.font]=o,o},e.uninstall=function(t){var r=e.available[t];if(!r)throw new Error("No font found named '"+t+"'");r.destroy(),delete e.available[t]},e.from=function(t,r,n){if(!t)throw new Error("[BitmapFont] Property `name` is required.");var i=Object.assign({},e.defaultOptions,n),s=i.chars,o=i.padding,a=i.resolution,l=i.textureWidth,h=i.textureHeight,u=resolveCharacters(s),c=r instanceof TextStyle?r:new TextStyle(r),d=l,f=new BitmapFontData;f.info[0]={face:c.fontFamily,size:c.fontSize},f.common[0]={lineHeight:c.fontSize};for(var p,m,_,g=0,v=0,y=0,b=[],x=0;x<u.length;x++){p||((p=document.createElement("canvas")).width=l,p.height=h,m=p.getContext("2d"),_=new BaseTexture(p,{resolution:a}),b.push(new Texture(_)),f.page.push({id:b.length-1,file:""}));var S=TextMetrics.measureText(u[x],c,!1,p),T=S.width,E=Math.ceil(S.height),A=Math.ceil(("italic"===c.fontStyle?2:1)*T);if(v>=h-E*a){if(0===v)throw new Error("[BitmapFont] textureHeight "+h+"px is too small for "+c.fontSize+"px fonts");--x,p=null,m=null,_=null,v=0,g=0,y=0}else if(y=Math.max(E+S.fontProperties.descent,y),A*a+g>=d)--x,v+=y*a,v=Math.ceil(v),g=0,y=0;else{drawGlyph(p,m,S,g,v,a,c);var w=S.text.charCodeAt(0);f.char.push({id:w,page:b.length-1,x:g/a,y:v/a,width:A,height:E,xoffset:0,yoffset:0,xadvance:Math.ceil(T-(c.dropShadow?c.dropShadowDistance:0)-(c.stroke?c.strokeThickness:0))}),g+=(A+2*o)*a,g=Math.ceil(g)}}x=0;for(var C=u.length;x<C;x++)for(var O=u[x],R=0;R<C;R++){var D=u[R],I=m.measureText(O).width,M=m.measureText(D).width,N=m.measureText(O+D).width-(I+M);N&&f.kerning.push({first:O.charCodeAt(0),second:D.charCodeAt(0),amount:N})}var P=new e(f,b,!0);return void 0!==e.available[t]&&e.uninstall(t),e.available[t]=P,P},e.ALPHA=[["a","z"],["A","Z"]," "],e.NUMERIC=[["0","9"]],e.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],e.ASCII=[[" ","~"]],e.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:e.ALPHANUMERIC},e.available={},e}(),pageMeshDataPool=[],charRenderDataPool=[],BitmapText=function(e){function t(r,n){void 0===n&&(n={});var i=e.call(this)||this;i._tint=16777215;var s=Object.assign({},t.styleDefaults,n),o=s.align,a=s.tint,l=s.maxWidth,h=s.letterSpacing,u=s.fontName,c=s.fontSize;if(!BitmapFont.available[u])throw new Error('Missing BitmapFont "'+u+'"');return i._activePagesMeshData=[],i._textWidth=0,i._textHeight=0,i._align=o,i._tint=a,i._fontName=u,i._fontSize=c||BitmapFont.available[u].size,i._text=r,i._maxWidth=l,i._maxLineHeight=0,i._letterSpacing=h,i._anchor=new ObservablePoint((function(){i.dirty=!0}),i,0,0),i._roundPixels=settings.ROUND_PIXELS,i.dirty=!0,i._textureCache={},i}return __extends13(t,e),t.prototype.updateText=function(){for(var e,t=BitmapFont.available[this._fontName],r=this._fontSize/t.size,n=new Point,i=[],s=[],o=[],a=this._text.replace(/(?:\r\n|\r)/g,"\n")||" ",l=a.length,h=this._maxWidth*t.size/this._fontSize,u=null,c=0,d=0,f=0,p=-1,m=0,_=0,g=0,v=0,y=0;y<l;y++){var b=a.charCodeAt(y),x=a.charAt(y);if(/(?:\s)/.test(x)&&(p=y,m=c,v++),"\r"!==x&&"\n"!==x){var S=t.chars[b];if(S){u&&S.kerning[u]&&(n.x+=S.kerning[u]);var T=charRenderDataPool.pop()||{texture:Texture.EMPTY,line:0,charCode:0,prevSpaces:0,position:new Point};T.texture=S.texture,T.line=f,T.charCode=b,T.position.x=n.x+S.xOffset+this._letterSpacing/2,T.position.y=n.y+S.yOffset,T.prevSpaces=v,i.push(T),n.x+=S.xAdvance+this._letterSpacing,c=n.x,g=Math.max(g,S.yOffset+S.texture.height),u=b,-1!==p&&h>0&&n.x>h&&(removeItems(i,1+p-++_,1+y-p),y=p,p=-1,s.push(m),o.push(i.length>0?i[i.length-1].prevSpaces:0),d=Math.max(d,m),f++,n.x=0,n.y+=t.lineHeight,u=null,v=0)}}else s.push(c),o.push(-1),d=Math.max(d,c),++f,++_,n.x=0,n.y+=t.lineHeight,u=null,v=0}var E=a.charAt(a.length-1);"\r"!==E&&"\n"!==E&&(/(?:\s)/.test(E)&&(c=m),s.push(c),d=Math.max(d,c),o.push(-1));var A=[];for(y=0;y<=f;y++){var w=0;"right"===this._align?w=d-s[y]:"center"===this._align?w=(d-s[y])/2:"justify"===this._align&&(w=o[y]<0?0:(d-s[y])/o[y]),A.push(w)}var C=i.length,O={},R=[],D=this._activePagesMeshData;for(y=0;y<D.length;y++)pageMeshDataPool.push(D[y]);for(y=0;y<C;y++){var I=(G=i[y].texture).baseTexture.uid;if(!O[I]){if(!(q=pageMeshDataPool.pop())){var M=new MeshGeometry,N=new MeshMaterial(Texture.EMPTY);q={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:new Mesh(M,N),vertices:null,uvs:null,indices:null}}q.index=0,q.indexCount=0,q.vertexCount=0,q.uvsCount=0,q.total=0;var P=this._textureCache;P[I]=P[I]||new Texture(G.baseTexture),q.mesh.texture=P[I],q.mesh.tint=this._tint,R.push(q),O[I]=q}O[I].total++}for(y=0;y<D.length;y++)-1===R.indexOf(D[y])&&this.removeChild(D[y].mesh);for(y=0;y<R.length;y++)R[y].mesh.parent!==this&&this.addChild(R[y].mesh);for(var y in this._activePagesMeshData=R,O){var k=(q=O[y]).total;if(!((null===(e=q.indices)||void 0===e?void 0:e.length)>6*k)||q.vertices.length<2*Mesh.BATCHABLE_SIZE)q.vertices=new Float32Array(8*k),q.uvs=new Float32Array(8*k),q.indices=new Uint16Array(6*k);else for(var F=q.total,L=q.vertices,B=4*F*2;B<L.length;B++)L[B]=0;q.mesh.size=6*k}for(y=0;y<C;y++){var U=(x=i[y]).position.x+A[x.line]*("justify"===this._align?x.prevSpaces:1);this._roundPixels&&(U=Math.round(U));var G,j=U*r,V=x.position.y*r,z=O[(G=x.texture).baseTexture.uid],H=G.frame,X=G._uvs,W=z.index++;z.indices[6*W+0]=0+4*W,z.indices[6*W+1]=1+4*W,z.indices[6*W+2]=2+4*W,z.indices[6*W+3]=0+4*W,z.indices[6*W+4]=2+4*W,z.indices[6*W+5]=3+4*W,z.vertices[8*W+0]=j,z.vertices[8*W+1]=V,z.vertices[8*W+2]=j+H.width*r,z.vertices[8*W+3]=V,z.vertices[8*W+4]=j+H.width*r,z.vertices[8*W+5]=V+H.height*r,z.vertices[8*W+6]=j,z.vertices[8*W+7]=V+H.height*r,z.uvs[8*W+0]=X.x0,z.uvs[8*W+1]=X.y0,z.uvs[8*W+2]=X.x1,z.uvs[8*W+3]=X.y1,z.uvs[8*W+4]=X.x2,z.uvs[8*W+5]=X.y2,z.uvs[8*W+6]=X.x3,z.uvs[8*W+7]=X.y3}for(var y in this._textWidth=d*r,this._textHeight=(n.y+t.lineHeight)*r,O){var q=O[y];if(0!==this.anchor.x||0!==this.anchor.y)for(var Y=0,J=this._textWidth*this.anchor.x,K=this._textHeight*this.anchor.y,$=0;$<q.total;$++)q.vertices[Y++]-=J,q.vertices[Y++]-=K,q.vertices[Y++]-=J,q.vertices[Y++]-=K,q.vertices[Y++]-=J,q.vertices[Y++]-=K,q.vertices[Y++]-=J,q.vertices[Y++]-=K;this._maxLineHeight=g*r;var Q=q.mesh.geometry.getBuffer("aVertexPosition"),Z=q.mesh.geometry.getBuffer("aTextureCoord"),ee=q.mesh.geometry.getIndex();Q.data=q.vertices,Z.data=q.uvs,ee.data=q.indices,Q.update(),Z.update(),ee.update()}for(y=0;y<i.length;y++)charRenderDataPool.push(i[y])},t.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},t.prototype.getLocalBounds=function(){return this.validate(),e.prototype.getLocalBounds.call(this)},t.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},Object.defineProperty(t.prototype,"tint",{get:function(){return this._tint},set:function(e){if(this._tint!==e){this._tint=e;for(var t=0;t<this._activePagesMeshData.length;t++)this._activePagesMeshData[t].mesh.tint=e}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"align",{get:function(){return this._align},set:function(e){this._align!==e&&(this._align=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontName",{get:function(){return this._fontName},set:function(e){if(!BitmapFont.available[e])throw new Error('Missing BitmapFont "'+e+'"');this._fontName!==e&&(this._fontName=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{get:function(){return this._fontSize},set:function(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"anchor",{get:function(){return this._anchor},set:function(e){"number"==typeof e?this._anchor.set(e):this._anchor.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){e=String(null==e?"":e),this._text!==e&&(this._text=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxLineHeight",{get:function(){return this.validate(),this._maxLineHeight},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textWidth",{get:function(){return this.validate(),this._textWidth},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textHeight",{get:function(){return this.validate(),this._textHeight},enumerable:!1,configurable:!0}),t.prototype.destroy=function(t){var r=this._textureCache;for(var n in r)r[n].destroy(),delete r[n];this._textureCache=null,e.prototype.destroy.call(this,t)},t.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0},t}(Container),BitmapFontLoader=function(){function e(){}return e.add=function(){LoaderResource.setExtensionXhrType("fnt",LoaderResource.XHR_RESPONSE_TYPE.TEXT)},e.use=function(t,r){var n=autoDetectFormat(t.data);if(n)for(var i=e.getBaseUrl(this,t),s=n.parse(t.data),o={},a=function(e){o[e.metadata.pageFile]=e.texture,Object.keys(o).length===s.page.length&&(t.bitmapFont=BitmapFont.install(s,o,!0),r())},l=0;l<s.page.length;++l){var h=s.page[l].file,u=i+h,c=!1;for(var d in this.resources){var f=this.resources[d];if(f.url===u){f.metadata.pageFile=h,f.texture?a(f):f.onAfterMiddleware.add(a),c=!0;break}}if(!c){var p={crossOrigin:t.crossOrigin,loadType:LoaderResource.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:h},t.metadata.imageMetadata),parentResource:t};this.add(u,p,a)}}else r()},e.getBaseUrl=function(t,r){var n=r.isDataUrl?"":e.dirname(r.url);return r.isDataUrl&&("."===n&&(n=""),t.baseUrl&&n&&"/"===t.baseUrl.charAt(t.baseUrl.length-1)&&(n+="/")),(n=n.replace(t.baseUrl,""))&&"/"!==n.charAt(n.length-1)&&(n+="/"),n},e.dirname=function(e){var t=e.replace(/\\/g,"/").replace(/\/$/,"").replace(/\/[^\/]*$/,"");return t===e?".":""===t?"/":t},e}(),extendStatics14=function(e,t){return extendStatics14=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},extendStatics14(e,t)};function __extends14(e,t){function r(){this.constructor=e}extendStatics14(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var fragment5="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n",AlphaFilter=function(e){function t(t){void 0===t&&(t=1);var r=e.call(this,defaultVertex$2,fragment5,{uAlpha:1})||this;return r.alpha=t,r}return __extends14(t,e),Object.defineProperty(t.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(e){this.uniforms.uAlpha=e},enumerable:!1,configurable:!0}),t}(Filter),extendStatics15=function(e,t){return extendStatics15=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},extendStatics15(e,t)};function __extends15(e,t){function r(){this.constructor=e}extendStatics15(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var vertTemplate="\n    attribute vec2 aVertexPosition;\n\n    uniform mat3 projectionMatrix;\n\n    uniform float strength;\n\n    varying vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 inputSize;\n    uniform vec4 outputFrame;\n\n    vec4 filterVertexPosition( void )\n    {\n        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n    }\n\n    vec2 filterTextureCoord( void )\n    {\n        return aVertexPosition * (outputFrame.zw * inputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }";function generateBlurVertSource(e,t){var r,n=Math.ceil(e/2),i=vertTemplate,s="";r=t?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(var o=0;o<e;o++){var a=r.replace("%index%",o.toString());s+=a=a.replace("%sampleIndex%",o-(n-1)+".0"),s+="\n"}return(i=i.replace("%blur%",s)).replace("%size%",e.toString())}var GAUSSIAN_VALUES={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},fragTemplate2=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n"),ENV3,RENDERER_TYPE3,BUFFER_BITS3,BLEND_MODES3,DRAW_MODES3,FORMATS3,TARGETS3,TYPES3,SAMPLER_TYPES3,SCALE_MODES3,WRAP_MODES3,MIPMAP_MODES3,ALPHA_MODES3,CLEAR_MODES3,GC_MODES3,PRECISION3,MASK_TYPES3,MSAA_QUALITY3;function generateBlurFragSource(e){for(var t,r=GAUSSIAN_VALUES[e],n=r.length,i=fragTemplate2,s="",o=0;o<e;o++){var a="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",o.toString());t=o,o>=n&&(t=e-o-1),s+=a=a.replace("%value%",r[t].toString()),s+="\n"}return(i=i.replace("%blur%",s)).replace("%size%",e.toString())}!function(e){e[e.WEBGL_LEGACY=0]="WEBGL_LEGACY",e[e.WEBGL=1]="WEBGL",e[e.WEBGL2=2]="WEBGL2"}(ENV3||(ENV3={})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.WEBGL=1]="WEBGL",e[e.CANVAS=2]="CANVAS"}(RENDERER_TYPE3||(RENDERER_TYPE3={})),function(e){e[e.COLOR=16384]="COLOR",e[e.DEPTH=256]="DEPTH",e[e.STENCIL=1024]="STENCIL"}(BUFFER_BITS3||(BUFFER_BITS3={})),function(e){e[e.NORMAL=0]="NORMAL",e[e.ADD=1]="ADD",e[e.MULTIPLY=2]="MULTIPLY",e[e.SCREEN=3]="SCREEN",e[e.OVERLAY=4]="OVERLAY",e[e.DARKEN=5]="DARKEN",e[e.LIGHTEN=6]="LIGHTEN",e[e.COLOR_DODGE=7]="COLOR_DODGE",e[e.COLOR_BURN=8]="COLOR_BURN",e[e.HARD_LIGHT=9]="HARD_LIGHT",e[e.SOFT_LIGHT=10]="SOFT_LIGHT",e[e.DIFFERENCE=11]="DIFFERENCE",e[e.EXCLUSION=12]="EXCLUSION",e[e.HUE=13]="HUE",e[e.SATURATION=14]="SATURATION",e[e.COLOR=15]="COLOR",e[e.LUMINOSITY=16]="LUMINOSITY",e[e.NORMAL_NPM=17]="NORMAL_NPM",e[e.ADD_NPM=18]="ADD_NPM",e[e.SCREEN_NPM=19]="SCREEN_NPM",e[e.NONE=20]="NONE",e[e.SRC_OVER=0]="SRC_OVER",e[e.SRC_IN=21]="SRC_IN",e[e.SRC_OUT=22]="SRC_OUT",e[e.SRC_ATOP=23]="SRC_ATOP",e[e.DST_OVER=24]="DST_OVER",e[e.DST_IN=25]="DST_IN",e[e.DST_OUT=26]="DST_OUT",e[e.DST_ATOP=27]="DST_ATOP",e[e.ERASE=26]="ERASE",e[e.SUBTRACT=28]="SUBTRACT",e[e.XOR=29]="XOR"}(BLEND_MODES3||(BLEND_MODES3={})),function(e){e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(DRAW_MODES3||(DRAW_MODES3={})),function(e){e[e.RGBA=6408]="RGBA",e[e.RGB=6407]="RGB",e[e.ALPHA=6406]="ALPHA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(FORMATS3||(FORMATS3={})),function(e){e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(TARGETS3||(TARGETS3={})),function(e){e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.FLOAT=5126]="FLOAT",e[e.HALF_FLOAT=36193]="HALF_FLOAT"}(TYPES3||(TYPES3={})),function(e){e[e.FLOAT=0]="FLOAT",e[e.INT=1]="INT",e[e.UINT=2]="UINT"}(SAMPLER_TYPES3||(SAMPLER_TYPES3={})),function(e){e[e.NEAREST=0]="NEAREST",e[e.LINEAR=1]="LINEAR"}(SCALE_MODES3||(SCALE_MODES3={})),function(e){e[e.CLAMP=33071]="CLAMP",e[e.REPEAT=10497]="REPEAT",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(WRAP_MODES3||(WRAP_MODES3={})),function(e){e[e.OFF=0]="OFF",e[e.POW2=1]="POW2",e[e.ON=2]="ON",e[e.ON_MANUAL=3]="ON_MANUAL"}(MIPMAP_MODES3||(MIPMAP_MODES3={})),function(e){e[e.NPM=0]="NPM",e[e.UNPACK=1]="UNPACK",e[e.PMA=2]="PMA",e[e.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",e[e.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",e[e.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(ALPHA_MODES3||(ALPHA_MODES3={})),function(e){e[e.NO=0]="NO",e[e.YES=1]="YES",e[e.AUTO=2]="AUTO",e[e.BLEND=0]="BLEND",e[e.CLEAR=1]="CLEAR",e[e.BLIT=2]="BLIT"}(CLEAR_MODES3||(CLEAR_MODES3={})),function(e){e[e.AUTO=0]="AUTO",e[e.MANUAL=1]="MANUAL"}(GC_MODES3||(GC_MODES3={})),function(e){e.LOW="lowp",e.MEDIUM="mediump",e.HIGH="highp"}(PRECISION3||(PRECISION3={})),function(e){e[e.NONE=0]="NONE",e[e.SCISSOR=1]="SCISSOR",e[e.STENCIL=2]="STENCIL",e[e.SPRITE=3]="SPRITE"}(MASK_TYPES3||(MASK_TYPES3={})),function(e){e[e.NONE=0]="NONE",e[e.LOW=2]="LOW",e[e.MEDIUM=4]="MEDIUM",e[e.HIGH=8]="HIGH"}(MSAA_QUALITY3||(MSAA_QUALITY3={}));var BlurFilterPass=function(e){function t(t,r,n,i,s){void 0===r&&(r=8),void 0===n&&(n=4),void 0===i&&(i=settings.FILTER_RESOLUTION),void 0===s&&(s=5);var o=this,a=generateBlurVertSource(s,t),l=generateBlurFragSource(s);return(o=e.call(this,a,l)||this).horizontal=t,o.resolution=i,o._quality=0,o.quality=n,o.blur=r,o}return __extends15(t,e),t.prototype.apply=function(e,t,r,n){if(r?this.horizontal?this.uniforms.strength=1/r.width*(r.width/t.width):this.uniforms.strength=1/r.height*(r.height/t.height):this.horizontal?this.uniforms.strength=1/e.renderer.width*(e.renderer.width/t.width):this.uniforms.strength=1/e.renderer.height*(e.renderer.height/t.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)e.applyFilter(this,t,r,n);else{var i=e.getFilterTexture(),s=e.renderer,o=t,a=i;this.state.blend=!1,e.applyFilter(this,o,a,CLEAR_MODES3.CLEAR);for(var l=1;l<this.passes-1;l++){e.bindAndClear(o,CLEAR_MODES3.BLIT),this.uniforms.uSampler=a;var h=a;a=o,o=h,s.shader.bind(this),s.geometry.draw(5)}this.state.blend=!0,e.applyFilter(this,a,r,n),e.returnFilterTexture(i)}},Object.defineProperty(t.prototype,"blur",{get:function(){return this.strength},set:function(e){this.padding=1+2*Math.abs(e),this.strength=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"quality",{get:function(){return this._quality},set:function(e){this._quality=e,this.passes=e},enumerable:!1,configurable:!0}),t}(Filter),BlurFilter=function(e){function t(t,r,n,i){void 0===t&&(t=8),void 0===r&&(r=4),void 0===n&&(n=settings.FILTER_RESOLUTION),void 0===i&&(i=5);var s=e.call(this)||this;return s.blurXFilter=new BlurFilterPass(!0,t,r,n,i),s.blurYFilter=new BlurFilterPass(!1,t,r,n,i),s.resolution=n,s.quality=r,s.blur=t,s.repeatEdgePixels=!1,s}return __extends15(t,e),t.prototype.apply=function(e,t,r,n){var i=Math.abs(this.blurXFilter.strength),s=Math.abs(this.blurYFilter.strength);if(i&&s){var o=e.getFilterTexture();this.blurXFilter.apply(e,t,o,CLEAR_MODES3.CLEAR),this.blurYFilter.apply(e,o,r,n),e.returnFilterTexture(o)}else s?this.blurYFilter.apply(e,t,r,n):this.blurXFilter.apply(e,t,r,n)},t.prototype.updatePadding=function(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))},Object.defineProperty(t.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"quality",{get:function(){return this.blurXFilter.quality},set:function(e){this.blurXFilter.quality=this.blurYFilter.quality=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(e){this.blurXFilter.blur=e,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(e){this.blurYFilter.blur=e,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blendMode",{get:function(){return this.blurYFilter.blendMode},set:function(e){this.blurYFilter.blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"repeatEdgePixels",{get:function(){return this._repeatEdgePixels},set:function(e){this._repeatEdgePixels=e,this.updatePadding()},enumerable:!1,configurable:!0}),t}(Filter),extendStatics16=function(e,t){return extendStatics16=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},extendStatics16(e,t)};function __extends16(e,t){function r(){this.constructor=e}extendStatics16(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var fragment6="varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n",ColorMatrixFilter=function(e){function t(){var t=this,r={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};return(t=e.call(this,defaultFilterVertex,fragment6,r)||this).alpha=1,t}return __extends16(t,e),t.prototype._loadMatrix=function(e,t){void 0===t&&(t=!1);var r=e;t&&(this._multiply(r,this.uniforms.m,e),r=this._colorMatrix(r)),this.uniforms.m=r},t.prototype._multiply=function(e,t,r){return e[0]=t[0]*r[0]+t[1]*r[5]+t[2]*r[10]+t[3]*r[15],e[1]=t[0]*r[1]+t[1]*r[6]+t[2]*r[11]+t[3]*r[16],e[2]=t[0]*r[2]+t[1]*r[7]+t[2]*r[12]+t[3]*r[17],e[3]=t[0]*r[3]+t[1]*r[8]+t[2]*r[13]+t[3]*r[18],e[4]=t[0]*r[4]+t[1]*r[9]+t[2]*r[14]+t[3]*r[19]+t[4],e[5]=t[5]*r[0]+t[6]*r[5]+t[7]*r[10]+t[8]*r[15],e[6]=t[5]*r[1]+t[6]*r[6]+t[7]*r[11]+t[8]*r[16],e[7]=t[5]*r[2]+t[6]*r[7]+t[7]*r[12]+t[8]*r[17],e[8]=t[5]*r[3]+t[6]*r[8]+t[7]*r[13]+t[8]*r[18],e[9]=t[5]*r[4]+t[6]*r[9]+t[7]*r[14]+t[8]*r[19]+t[9],e[10]=t[10]*r[0]+t[11]*r[5]+t[12]*r[10]+t[13]*r[15],e[11]=t[10]*r[1]+t[11]*r[6]+t[12]*r[11]+t[13]*r[16],e[12]=t[10]*r[2]+t[11]*r[7]+t[12]*r[12]+t[13]*r[17],e[13]=t[10]*r[3]+t[11]*r[8]+t[12]*r[13]+t[13]*r[18],e[14]=t[10]*r[4]+t[11]*r[9]+t[12]*r[14]+t[13]*r[19]+t[14],e[15]=t[15]*r[0]+t[16]*r[5]+t[17]*r[10]+t[18]*r[15],e[16]=t[15]*r[1]+t[16]*r[6]+t[17]*r[11]+t[18]*r[16],e[17]=t[15]*r[2]+t[16]*r[7]+t[17]*r[12]+t[18]*r[17],e[18]=t[15]*r[3]+t[16]*r[8]+t[17]*r[13]+t[18]*r[18],e[19]=t[15]*r[4]+t[16]*r[9]+t[17]*r[14]+t[18]*r[19]+t[19],e},t.prototype._colorMatrix=function(e){var t=new Float32Array(e);return t[4]/=255,t[9]/=255,t[14]/=255,t[19]/=255,t},t.prototype.brightness=function(e,t){var r=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(r,t)},t.prototype.greyscale=function(e,t){var r=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(r,t)},t.prototype.blackAndWhite=function(e){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],e)},t.prototype.hue=function(e,t){e=(e||0)/180*Math.PI;var r=Math.cos(e),n=Math.sin(e),i=1/3,s=(0,Math.sqrt)(i),o=[r+(1-r)*i,i*(1-r)-s*n,i*(1-r)+s*n,0,0,i*(1-r)+s*n,r+i*(1-r),i*(1-r)-s*n,0,0,i*(1-r)-s*n,i*(1-r)+s*n,r+i*(1-r),0,0,0,0,0,1,0];this._loadMatrix(o,t)},t.prototype.contrast=function(e,t){var r=(e||0)+1,n=-.5*(r-1),i=[r,0,0,0,n,0,r,0,0,n,0,0,r,0,n,0,0,0,1,0];this._loadMatrix(i,t)},t.prototype.saturate=function(e,t){void 0===e&&(e=0);var r=2*e/3+1,n=-.5*(r-1),i=[r,n,n,0,0,n,r,n,0,0,n,n,r,0,0,0,0,0,1,0];this._loadMatrix(i,t)},t.prototype.desaturate=function(){this.saturate(-1)},t.prototype.negative=function(e){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],e)},t.prototype.sepia=function(e){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],e)},t.prototype.technicolor=function(e){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],e)},t.prototype.polaroid=function(e){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],e)},t.prototype.toBGR=function(e){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],e)},t.prototype.kodachrome=function(e){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],e)},t.prototype.browni=function(e){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],e)},t.prototype.vintage=function(e){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],e)},t.prototype.colorTone=function(e,t,r,n,i){var s=((r=r||16770432)>>16&255)/255,o=(r>>8&255)/255,a=(255&r)/255,l=((n=n||3375104)>>16&255)/255,h=(n>>8&255)/255,u=(255&n)/255,c=[.3,.59,.11,0,0,s,o,a,e=e||.2,0,l,h,u,t=t||.15,0,s-l,o-h,a-u,0,0];this._loadMatrix(c,i)},t.prototype.night=function(e,t){var r=[-2*(e=e||.1),-e,0,0,0,-e,0,e,0,0,0,e,2*e,0,0,0,0,0,1,0];this._loadMatrix(r,t)},t.prototype.predator=function(e,t){var r=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(r,t)},t.prototype.lsd=function(e){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],e)},t.prototype.reset=function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)},Object.defineProperty(t.prototype,"matrix",{get:function(){return this.uniforms.m},set:function(e){this.uniforms.m=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(e){this.uniforms.uAlpha=e},enumerable:!1,configurable:!0}),t}(Filter);ColorMatrixFilter.prototype.grayscale=ColorMatrixFilter.prototype.greyscale;var extendStatics17=function(e,t){return extendStatics17=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},extendStatics17(e,t)};function __extends17(e,t){function r(){this.constructor=e}extendStatics17(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var fragment7="varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\nuniform mat2 rotation;\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform highp vec4 inputSize;\nuniform vec4 inputClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy = scale * inputSize.zw * (rotation * map.xy);\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));\n}\n",vertex5="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n\tgl_Position = filterVertexPosition();\n\tvTextureCoord = filterTextureCoord();\n\tvFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;\n}\n",DisplacementFilter=function(e){function t(t,r){var n=this,i=new Matrix;return t.renderable=!1,(n=e.call(this,vertex5,fragment7,{mapSampler:t._texture,filterMatrix:i,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])})||this).maskSprite=t,n.maskMatrix=i,null==r&&(r=20),n.scale=new Point(r,r),n}return __extends17(t,e),t.prototype.apply=function(e,t,r,n){this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;var i=this.maskSprite.worldTransform,s=Math.sqrt(i.a*i.a+i.b*i.b),o=Math.sqrt(i.c*i.c+i.d*i.d);0!==s&&0!==o&&(this.uniforms.rotation[0]=i.a/s,this.uniforms.rotation[1]=i.b/s,this.uniforms.rotation[2]=i.c/o,this.uniforms.rotation[3]=i.d/o),e.applyFilter(this,t,r,n)},Object.defineProperty(t.prototype,"map",{get:function(){return this.uniforms.mapSampler},set:function(e){this.uniforms.mapSampler=e},enumerable:!1,configurable:!0}),t}(Filter),extendStatics18=function(e,t){return extendStatics18=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},extendStatics18(e,t)};function __extends18(e,t){function r(){this.constructor=e}extendStatics18(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var vertex6="\nattribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvoid texcoords(vec2 fragCoord, vec2 inverseVP,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = filterVertexPosition();\n\n   vFragCoord = aVertexPosition * outputFrame.zw;\n\n   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",fragment8='varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\nuniform sampler2D uSampler;\nuniform highp vec4 inputSize;\n\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n\n --\n\n From:\n https://github.com/mitsuhiko/webgl-meincraft\n\n Copyright (c) 2011 by Armin Ronacher.\n\n Some rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n\n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n\n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n\n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n\n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec4 color;\n\n      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n',FXAAFilter=function(e){function t(){return e.call(this,vertex6,fragment8)||this}return __extends18(t,e),t}(Filter),extendStatics19=function(e,t){return extendStatics19=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},extendStatics19(e,t)};function __extends19(e,t){function r(){this.constructor=e}extendStatics19(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var fragment9="precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n",NoiseFilter=function(e){function t(t,r){void 0===t&&(t=.5),void 0===r&&(r=Math.random());var n=e.call(this,defaultFilterVertex,fragment9,{uNoise:0,uSeed:0})||this;return n.noise=t,n.seed=r,n}return __extends19(t,e),Object.defineProperty(t.prototype,"noise",{get:function(){return this.uniforms.uNoise},set:function(e){this.uniforms.uNoise=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"seed",{get:function(){return this.uniforms.uSeed},set:function(e){this.uniforms.uSeed=e},enumerable:!1,configurable:!0}),t}(Filter),_tempMatrix=new Matrix;DisplayObject.prototype._cacheAsBitmap=!1,DisplayObject.prototype._cacheData=null,DisplayObject.prototype._cacheAsBitmapResolution=null;var CacheData=function(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null};Object.defineProperties(DisplayObject.prototype,{cacheAsBitmapResolution:{get:function(){return this._cacheAsBitmapResolution},set:function(e){e!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=e,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(e){var t;this._cacheAsBitmap!==e&&(this._cacheAsBitmap=e,e?(this._cacheData||(this._cacheData=new CacheData),(t=this._cacheData).originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((t=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea))}}}),DisplayObject.prototype._renderCached=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(e),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(e))},DisplayObject.prototype._initCachedDisplayObject=function(e){if(!this._cacheData||!this._cacheData.sprite){var t=this.alpha;this.alpha=1,e.batch.flush();var r=this.getLocalBounds(null,!0).clone();if(this.filters){var n=this.filters[0].padding;r.pad(n)}r.ceil(settings.RESOLUTION);var i=e.renderTexture.current,s=e.renderTexture.sourceFrame.clone(),o=e.renderTexture.destinationFrame.clone(),a=e.projection.transform,l=RenderTexture.create({width:r.width,height:r.height,resolution:this.cacheAsBitmapResolution||e.resolution}),h="cacheAsBitmap_"+uid();this._cacheData.textureCacheId=h,BaseTexture.addToCache(l.baseTexture,h),Texture.addToCache(l,h);var u=this.transform.localTransform.copyTo(_tempMatrix).invert().translate(-r.x,-r.y);this.render=this._cacheData.originalRender,e.render(this,{renderTexture:l,clear:!0,transform:u,skipUpdateTransform:!1}),e.projection.transform=a,e.renderTexture.bind(i,s,o),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=t;var c=new Sprite(l);c.transform.worldTransform=this.transform.worldTransform,c.anchor.x=-r.x/r.width,c.anchor.y=-r.y/r.height,c.alpha=t,c._bounds=this._bounds,this._cacheData.sprite=c,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=c.containsPoint.bind(c)}},DisplayObject.prototype._renderCachedCanvas=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(e),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(e))},DisplayObject.prototype._initCachedDisplayObjectCanvas=function(e){if(!this._cacheData||!this._cacheData.sprite){var t=this.getLocalBounds(null,!0),r=this.alpha;this.alpha=1;var n=e.context,i=e._projTransform;t.ceil(settings.RESOLUTION);var s=RenderTexture.create({width:t.width,height:t.height}),o="cacheAsBitmap_"+uid();this._cacheData.textureCacheId=o,BaseTexture.addToCache(s.baseTexture,o),Texture.addToCache(s,o);var a=_tempMatrix;this.transform.localTransform.copyTo(a),a.invert(),a.tx-=t.x,a.ty-=t.y,this.renderCanvas=this._cacheData.originalRenderCanvas,e.render(this,{renderTexture:s,clear:!0,transform:a,skipUpdateTransform:!1}),e.context=n,e._projTransform=i,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=r;var l=new Sprite(s);l.transform.worldTransform=this.transform.worldTransform,l.anchor.x=-t.x/t.width,l.anchor.y=-t.y/t.height,l.alpha=r,l._bounds=this._bounds,this._cacheData.sprite=l,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=e._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=l.containsPoint.bind(l)}},DisplayObject.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},DisplayObject.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},DisplayObject.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,BaseTexture.removeFromCache(this._cacheData.textureCacheId),Texture.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},DisplayObject.prototype._cacheAsBitmapDestroy=function(e){this.cacheAsBitmap=!1,this.destroy(e)},DisplayObject.prototype.name=null,Container.prototype.getChildByName=function(e,t){for(var r=0,n=this.children.length;r<n;r++)if(this.children[r].name===e)return this.children[r];if(t)for(r=0,n=this.children.length;r<n;r++)if(this.children[r].getChildByName){var i=this.children[r].getChildByName(e,!0);if(i)return i}return null},DisplayObject.prototype.getGlobalPosition=function(e,t){return void 0===e&&(e=new Point),void 0===t&&(t=!1),this.parent?this.parent.toGlobal(this.position,e,t):(e.x=this.position.x,e.y=this.position.y),e};var extendStatics20=function(e,t){return extendStatics20=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},extendStatics20(e,t)};function __extends20(e,t){function r(){this.constructor=e}extendStatics20(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var PlaneGeometry=function(e){function t(t,r,n,i){void 0===t&&(t=100),void 0===r&&(r=100),void 0===n&&(n=10),void 0===i&&(i=10);var s=e.call(this)||this;return s.segWidth=n,s.segHeight=i,s.width=t,s.height=r,s.build(),s}return __extends20(t,e),t.prototype.build=function(){for(var e=this.segWidth*this.segHeight,t=[],r=[],n=[],i=this.segWidth-1,s=this.segHeight-1,o=this.width/i,a=this.height/s,l=0;l<e;l++){var h=l%this.segWidth,u=l/this.segWidth|0;t.push(h*o,u*a),r.push(h/i,u/s)}var c=i*s;for(l=0;l<c;l++){var d=l%i,f=l/i|0,p=f*this.segWidth+d,m=f*this.segWidth+d+1,_=(f+1)*this.segWidth+d,g=(f+1)*this.segWidth+d+1;n.push(p,m,_,m,g,_)}this.buffers[0].data=new Float32Array(t),this.buffers[1].data=new Float32Array(r),this.indexBuffer.data=new Uint16Array(n),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()},t}(MeshGeometry),RopeGeometry=function(e){function t(t,r,n){void 0===t&&(t=200),void 0===n&&(n=0);var i=e.call(this,new Float32Array(4*r.length),new Float32Array(4*r.length),new Uint16Array(6*(r.length-1)))||this;return i.points=r,i._width=t,i.textureScale=n,i.build(),i}return __extends20(t,e),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),t.prototype.build=function(){var e=this.points;if(e){var t=this.getBuffer("aVertexPosition"),r=this.getBuffer("aTextureCoord"),n=this.getIndex();if(!(e.length<1)){t.data.length/4!==e.length&&(t.data=new Float32Array(4*e.length),r.data=new Float32Array(4*e.length),n.data=new Uint16Array(6*(e.length-1)));var i=r.data,s=n.data;i[0]=0,i[1]=0,i[2]=0,i[3]=1;for(var o=0,a=e[0],l=this._width*this.textureScale,h=e.length,u=0;u<h;u++){var c=4*u;if(this.textureScale>0){var d=a.x-e[u].x,f=a.y-e[u].y,p=Math.sqrt(d*d+f*f);a=e[u],o+=p/l}else o=u/(h-1);i[c]=o,i[c+1]=0,i[c+2]=o,i[c+3]=1}var m=0;for(u=0;u<h-1;u++)c=2*u,s[m++]=c,s[m++]=c+1,s[m++]=c+2,s[m++]=c+2,s[m++]=c+1,s[m++]=c+3;r.update(),n.update(),this.updateVertices()}}},t.prototype.updateVertices=function(){var e=this.points;if(!(e.length<1)){for(var t,r=e[0],n=0,i=0,s=this.buffers[0].data,o=e.length,a=0;a<o;a++){var l=e[a],h=4*a;i=-((t=a<e.length-1?e[a+1]:l).x-r.x),n=t.y-r.y;var u=Math.sqrt(n*n+i*i),c=this.textureScale>0?this.textureScale*this._width/2:this._width/2;n/=u,i/=u,n*=c,i*=c,s[h]=l.x+n,s[h+1]=l.y+i,s[h+2]=l.x-n,s[h+3]=l.y-i,r=l}this.buffers[0].update()}},t.prototype.update=function(){this.textureScale>0?this.build():this.updateVertices()},t}(MeshGeometry),SimpleRope=function(e){function t(t,r,n){void 0===n&&(n=0);var i=this,s=new RopeGeometry(t.height,r,n),o=new MeshMaterial(t);return n>0&&(t.baseTexture.wrapMode=WRAP_MODES2.REPEAT),(i=e.call(this,s,o)||this).autoUpdate=!0,i}return __extends20(t,e),t.prototype._render=function(t){var r=this.geometry;(this.autoUpdate||r._width!==this.shader.texture.height)&&(r._width=this.shader.texture.height,r.update()),e.prototype._render.call(this,t)},t}(Mesh),SimplePlane=function(e){function t(t,r,n){var i=this,s=new PlaneGeometry(t.width,t.height,r,n),o=new MeshMaterial(Texture.WHITE);return(i=e.call(this,s,o)||this).texture=t,i}return __extends20(t,e),t.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID;var e=this.geometry;e.width=this.shader.texture.width,e.height=this.shader.texture.height,e.build()},Object.defineProperty(t.prototype,"texture",{get:function(){return this.shader.texture},set:function(e){this.shader.texture!==e&&(this.shader.texture=e,this._textureID=-1,e.baseTexture.valid?this.textureUpdated():e.once("update",this.textureUpdated,this))},enumerable:!1,configurable:!0}),t.prototype._render=function(t){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),e.prototype._render.call(this,t)},t.prototype.destroy=function(t){this.shader.texture.off("update",this.textureUpdated,this),e.prototype.destroy.call(this,t)},t}(Mesh),SimpleMesh=function(e){function t(t,r,n,i,s){void 0===t&&(t=Texture.EMPTY);var o=this,a=new MeshGeometry(r,n,i);a.getBuffer("aVertexPosition").static=!1;var l=new MeshMaterial(t);return(o=e.call(this,a,l,null,s)||this).autoUpdate=!0,o}return __extends20(t,e),Object.defineProperty(t.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(e){this.geometry.getBuffer("aVertexPosition").data=e},enumerable:!1,configurable:!0}),t.prototype._render=function(t){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),e.prototype._render.call(this,t)},t}(Mesh),DEFAULT_BORDER_SIZE=10,NineSlicePlane=function(e){function t(t,r,n,i,s){void 0===r&&(r=DEFAULT_BORDER_SIZE),void 0===n&&(n=DEFAULT_BORDER_SIZE),void 0===i&&(i=DEFAULT_BORDER_SIZE),void 0===s&&(s=DEFAULT_BORDER_SIZE);var o=e.call(this,Texture.WHITE,4,4)||this;return o._origWidth=t.orig.width,o._origHeight=t.orig.height,o._width=o._origWidth,o._height=o._origHeight,o._leftWidth=r,o._rightWidth=i,o._topHeight=n,o._bottomHeight=s,o.texture=t,o}return __extends20(t,e),t.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID,this._refresh()},Object.defineProperty(t.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(e){this.geometry.getBuffer("aVertexPosition").data=e},enumerable:!1,configurable:!0}),t.prototype.updateHorizontalVertices=function(){var e=this.vertices,t=this._getMinScale();e[9]=e[11]=e[13]=e[15]=this._topHeight*t,e[17]=e[19]=e[21]=e[23]=this._height-this._bottomHeight*t,e[25]=e[27]=e[29]=e[31]=this._height},t.prototype.updateVerticalVertices=function(){var e=this.vertices,t=this._getMinScale();e[2]=e[10]=e[18]=e[26]=this._leftWidth*t,e[4]=e[12]=e[20]=e[28]=this._width-this._rightWidth*t,e[6]=e[14]=e[22]=e[30]=this._width},t.prototype._getMinScale=function(){var e=this._leftWidth+this._rightWidth,t=this._width>e?1:this._width/e,r=this._topHeight+this._bottomHeight,n=this._height>r?1:this._height/r;return Math.min(t,n)},Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leftWidth",{get:function(){return this._leftWidth},set:function(e){this._leftWidth=e,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rightWidth",{get:function(){return this._rightWidth},set:function(e){this._rightWidth=e,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"topHeight",{get:function(){return this._topHeight},set:function(e){this._topHeight=e,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottomHeight",{get:function(){return this._bottomHeight},set:function(e){this._bottomHeight=e,this._refresh()},enumerable:!1,configurable:!0}),t.prototype._refresh=function(){var e=this.texture,t=this.geometry.buffers[1].data;this._origWidth=e.orig.width,this._origHeight=e.orig.height;var r=1/this._origWidth,n=1/this._origHeight;t[0]=t[8]=t[16]=t[24]=0,t[1]=t[3]=t[5]=t[7]=0,t[6]=t[14]=t[22]=t[30]=1,t[25]=t[27]=t[29]=t[31]=1,t[2]=t[10]=t[18]=t[26]=r*this._leftWidth,t[4]=t[12]=t[20]=t[28]=1-r*this._rightWidth,t[9]=t[11]=t[13]=t[15]=n*this._topHeight,t[17]=t[19]=t[21]=t[23]=1-n*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()},t}(SimplePlane),extendStatics21=function(e,t){return extendStatics21=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},extendStatics21(e,t)};function __extends21(e,t){function r(){this.constructor=e}extendStatics21(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var AnimatedSprite=function(e){function t(t,r){void 0===r&&(r=!0);var n=e.call(this,t[0]instanceof Texture?t[0]:t[0].texture)||this;return n._textures=null,n._durations=null,n._autoUpdate=r,n._isConnectedToTicker=!1,n.animationSpeed=1,n.loop=!0,n.updateAnchor=!1,n.onComplete=null,n.onFrameChange=null,n.onLoop=null,n._currentTime=0,n._playing=!1,n._previousFrame=null,n.textures=t,n}return __extends21(t,e),t.prototype.stop=function(){!this._playing||(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1))},t.prototype.play=function(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(Ticker.shared.add(this.update,this,UPDATE_PRIORITY.HIGH),this._isConnectedToTicker=!0))},t.prototype.gotoAndStop=function(e){this.stop();var t=this.currentFrame;this._currentTime=e,t!==this.currentFrame&&this.updateTexture()},t.prototype.gotoAndPlay=function(e){var t=this.currentFrame;this._currentTime=e,t!==this.currentFrame&&this.updateTexture(),this.play()},t.prototype.update=function(e){if(this._playing){var t=this.animationSpeed*e,r=this.currentFrame;if(null!==this._durations){var n=this._currentTime%1*this._durations[this.currentFrame];for(n+=t/60*1e3;n<0;)this._currentTime--,n+=this._durations[this.currentFrame];var i=Math.sign(this.animationSpeed*e);for(this._currentTime=Math.floor(this._currentTime);n>=this._durations[this.currentFrame];)n-=this._durations[this.currentFrame]*i,this._currentTime+=i;this._currentTime+=n/this._durations[this.currentFrame]}else this._currentTime+=t;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):r!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<r||this.animationSpeed<0&&this.currentFrame>r)&&this.onLoop(),this.updateTexture())}},t.prototype.updateTexture=function(){var e=this.currentFrame;this._previousFrame!==e&&(this._previousFrame=e,this._texture=this._textures[e],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))},t.prototype.destroy=function(t){this.stop(),e.prototype.destroy.call(this,t),this.onComplete=null,this.onFrameChange=null,this.onLoop=null},t.fromFrames=function(e){for(var r=[],n=0;n<e.length;++n)r.push(Texture.from(e[n]));return new t(r)},t.fromImages=function(e){for(var r=[],n=0;n<e.length;++n)r.push(Texture.from(e[n]));return new t(r)},Object.defineProperty(t.prototype,"totalFrames",{get:function(){return this._textures.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textures",{get:function(){return this._textures},set:function(e){if(e[0]instanceof Texture)this._textures=e,this._durations=null;else{this._textures=[],this._durations=[];for(var t=0;t<e.length;t++)this._textures.push(e[t].texture),this._durations.push(e[t].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentFrame",{get:function(){var e=Math.floor(this._currentTime)%this._textures.length;return e<0&&(e+=this._textures.length),e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playing",{get:function(){return this._playing},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(Ticker.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),t}(Sprite);Renderer.registerPlugin("accessibility",AccessibilityManager),Renderer.registerPlugin("extract",Extract),Renderer.registerPlugin("interaction",InteractionManager),Renderer.registerPlugin("particle",ParticleRenderer),Renderer.registerPlugin("prepare",Prepare),Renderer.registerPlugin("batch",BatchRenderer),Renderer.registerPlugin("tilingSprite",TilingSpriteRenderer),Loader2.registerPlugin(BitmapFontLoader),Loader2.registerPlugin(CompressedTextureLoader),Loader2.registerPlugin(DDSLoader),Loader2.registerPlugin(KTXLoader),Loader2.registerPlugin(SpritesheetLoader),Application.registerPlugin(TickerPlugin),Application.registerPlugin(AppLoaderPlugin);var extendStatics22=function(e,t){return extendStatics22=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},extendStatics22(e,t)};function __extends22(e,t){function r(){this.constructor=e}extendStatics22(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var CanvasMaskManager=function(){function e(e){this.renderer=e,this._foundShapes=[]}return e.prototype.pushMask=function(e){var t=this.renderer,r=e.maskObject||e;t.context.save();var n=this._foundShapes;if(this.recursiveFindShapes(r,n),n.length>0){var i=t.context;i.beginPath();for(var s=0;s<n.length;s++){var o=n[s],a=o.transform.worldTransform;this.renderer.setContextTransform(a),this.renderGraphicsShape(o)}n.length=0,i.clip()}},e.prototype.recursiveFindShapes=function(e,t){e.geometry&&e.geometry.graphicsData&&t.push(e);var r=e.children;if(r)for(var n=0;n<r.length;n++)this.recursiveFindShapes(r[n],t)},e.prototype.renderGraphicsShape=function(e){e.finishPoly();var t=this.renderer.context,r=e.geometry.graphicsData,n=r.length;if(0!==n)for(var i=0;i<n;i++){var s=r[i].shape;if(s.type===SHAPES.POLY){var o=s.points;t.moveTo(o[0],o[1]);for(var a=1;a<o.length/2;a++)t.lineTo(o[2*a],o[2*a+1]);o[0]===o[o.length-2]&&o[1]===o[o.length-1]&&t.closePath()}else if(s.type===SHAPES.RECT)t.rect(s.x,s.y,s.width,s.height),t.closePath();else if(s.type===SHAPES.CIRC)t.arc(s.x,s.y,s.radius,0,2*Math.PI),t.closePath();else if(s.type===SHAPES.ELIP){var l=2*s.width,h=2*s.height,u=s.x-l/2,c=s.y-h/2,d=.5522848,f=l/2*d,p=h/2*d,m=u+l,_=c+h,g=u+l/2,v=c+h/2;t.moveTo(u,v),t.bezierCurveTo(u,v-p,g-f,c,g,c),t.bezierCurveTo(g+f,c,m,v-p,m,v),t.bezierCurveTo(m,v+p,g+f,_,g,_),t.bezierCurveTo(g-f,_,u,v+p,u,v),t.closePath()}else if(s.type===SHAPES.RREC){var y=s.x,b=s.y,x=s.width,S=s.height,T=s.radius,E=Math.min(x,S)/2|0;T=T>E?E:T,t.moveTo(y,b+T),t.lineTo(y,b+S-T),t.quadraticCurveTo(y,b+S,y+T,b+S),t.lineTo(y+x-T,b+S),t.quadraticCurveTo(y+x,b+S,y+x,b+S-T),t.lineTo(y+x,b+T),t.quadraticCurveTo(y+x,b,y+x-T,b),t.lineTo(y+T,b),t.quadraticCurveTo(y,b,y,b+T),t.closePath()}}},e.prototype.popMask=function(e){e.context.restore(),e.invalidateBlendMode()},e.prototype.destroy=function(){},e}();function createColoredCanvas(e){var t=document.createElement("canvas");t.width=6,t.height=1;var r=t.getContext("2d");return r.fillStyle=e,r.fillRect(0,0,6,1),t}function canUseNewCanvasBlendModes(){if("undefined"==typeof document)return!1;var e=createColoredCanvas("#ff00ff"),t=createColoredCanvas("#ffff00"),r=document.createElement("canvas");r.width=6,r.height=1;var n=r.getContext("2d");n.globalCompositeOperation="multiply",n.drawImage(e,0,0),n.drawImage(t,2,0);var i=n.getImageData(2,0,1,1);if(!i)return!1;var s=i.data;return 255===s[0]&&0===s[1]&&0===s[2]}function mapCanvasBlendModesToPixi(e){return void 0===e&&(e=[]),canUseNewCanvasBlendModes()?(e[BLEND_MODES2.NORMAL]="source-over",e[BLEND_MODES2.ADD]="lighter",e[BLEND_MODES2.MULTIPLY]="multiply",e[BLEND_MODES2.SCREEN]="screen",e[BLEND_MODES2.OVERLAY]="overlay",e[BLEND_MODES2.DARKEN]="darken",e[BLEND_MODES2.LIGHTEN]="lighten",e[BLEND_MODES2.COLOR_DODGE]="color-dodge",e[BLEND_MODES2.COLOR_BURN]="color-burn",e[BLEND_MODES2.HARD_LIGHT]="hard-light",e[BLEND_MODES2.SOFT_LIGHT]="soft-light",e[BLEND_MODES2.DIFFERENCE]="difference",e[BLEND_MODES2.EXCLUSION]="exclusion",e[BLEND_MODES2.HUE]="hue",e[BLEND_MODES2.SATURATION]="saturate",e[BLEND_MODES2.COLOR]="color",e[BLEND_MODES2.LUMINOSITY]="luminosity"):(e[BLEND_MODES2.NORMAL]="source-over",e[BLEND_MODES2.ADD]="lighter",e[BLEND_MODES2.MULTIPLY]="source-over",e[BLEND_MODES2.SCREEN]="source-over",e[BLEND_MODES2.OVERLAY]="source-over",e[BLEND_MODES2.DARKEN]="source-over",e[BLEND_MODES2.LIGHTEN]="source-over",e[BLEND_MODES2.COLOR_DODGE]="source-over",e[BLEND_MODES2.COLOR_BURN]="source-over",e[BLEND_MODES2.HARD_LIGHT]="source-over",e[BLEND_MODES2.SOFT_LIGHT]="source-over",e[BLEND_MODES2.DIFFERENCE]="source-over",e[BLEND_MODES2.EXCLUSION]="source-over",e[BLEND_MODES2.HUE]="source-over",e[BLEND_MODES2.SATURATION]="source-over",e[BLEND_MODES2.COLOR]="source-over",e[BLEND_MODES2.LUMINOSITY]="source-over"),e[BLEND_MODES2.NORMAL_NPM]=e[BLEND_MODES2.NORMAL],e[BLEND_MODES2.ADD_NPM]=e[BLEND_MODES2.ADD],e[BLEND_MODES2.SCREEN_NPM]=e[BLEND_MODES2.SCREEN],e[BLEND_MODES2.SRC_IN]="source-in",e[BLEND_MODES2.SRC_OUT]="source-out",e[BLEND_MODES2.SRC_ATOP]="source-atop",e[BLEND_MODES2.DST_OVER]="destination-over",e[BLEND_MODES2.DST_IN]="destination-in",e[BLEND_MODES2.DST_OUT]="destination-out",e[BLEND_MODES2.DST_ATOP]="destination-atop",e[BLEND_MODES2.XOR]="xor",e[BLEND_MODES2.SUBTRACT]="source-over",e}var tempMatrix2=new Matrix,CanvasRenderer=function(e){function t(r){var n=e.call(this,RENDERER_TYPE2.CANVAS,r)||this;if(n.rootContext=n.view.getContext("2d",{alpha:n.useContextAlpha}),n.context=n.rootContext,n.refresh=!0,n.maskManager=new CanvasMaskManager(n),n.smoothProperty="imageSmoothingEnabled",!n.rootContext.imageSmoothingEnabled){var i=n.rootContext;i.webkitImageSmoothingEnabled?n.smoothProperty="webkitImageSmoothingEnabled":i.mozImageSmoothingEnabled?n.smoothProperty="mozImageSmoothingEnabled":i.oImageSmoothingEnabled?n.smoothProperty="oImageSmoothingEnabled":i.msImageSmoothingEnabled&&(n.smoothProperty="msImageSmoothingEnabled")}return n.initPlugins(t.__plugins),n.blendModes=mapCanvasBlendModesToPixi(),n._activeBlendMode=null,n._outerBlend=!1,n._projTransform=null,n.renderingToScreen=!1,sayHello("Canvas"),n.resize(n.options.width,n.options.height),n}return __extends22(t,e),t.prototype.render=function(e,t){if(this.view){var r,n,i,s;t&&(t instanceof RenderTexture||t instanceof BaseRenderTexture?(deprecation("6.0.0","CanvasRenderer#render arguments changed, use options instead."),r=t,n=arguments[2],i=arguments[3],s=arguments[4]):(r=t.renderTexture,n=t.clear,i=t.transform,s=t.skipUpdateTransform)),this.renderingToScreen=!r,this.emit("prerender");var o=this.resolution;r?((r=r.castToBaseTexture())._canvasRenderTarget||(r._canvasRenderTarget=new CanvasRenderTarget(r.width,r.height,r.resolution),r.resource=new CanvasResource(r._canvasRenderTarget.canvas),r.valid=!0),this.context=r._canvasRenderTarget.context,this.resolution=r._canvasRenderTarget.resolution):this.context=this.rootContext;var a=this.context;if(this._projTransform=i||null,r||(this._lastObjectRendered=e),!s){var l=e.enableTempParent();e.updateTransform(),e.disableTempParent(l)}if(a.save(),a.setTransform(1,0,0,1,0,0),a.globalAlpha=1,this._activeBlendMode=BLEND_MODES2.NORMAL,this._outerBlend=!1,a.globalCompositeOperation=this.blendModes[BLEND_MODES2.NORMAL],void 0!==n?n:this.clearBeforeRender)if(this.renderingToScreen)a.clearRect(0,0,this.width,this.height),this.backgroundAlpha>0&&(a.globalAlpha=this.useContextAlpha?this.backgroundAlpha:1,a.fillStyle=this._backgroundColorString,a.fillRect(0,0,this.width,this.height),a.globalAlpha=1);else{(r=r)._canvasRenderTarget.clear();var h=r.clearColor;h[3]>0&&(a.globalAlpha=this.useContextAlpha?h[3]:1,a.fillStyle=hex2string(rgb2hex(h)),a.fillRect(0,0,r.realWidth,r.realHeight),a.globalAlpha=1)}var u=this.context;this.context=a,e.renderCanvas(this),this.context=u,a.restore(),this.resolution=o,this._projTransform=null,this.emit("postrender")}},t.prototype.setContextTransform=function(e,t,r){var n=e,i=this._projTransform,s=this.resolution;r=r||s,i&&((n=tempMatrix2).copyFrom(e),n.prepend(i)),t?this.context.setTransform(n.a*r,n.b*r,n.c*r,n.d*r,n.tx*s|0,n.ty*s|0):this.context.setTransform(n.a*r,n.b*r,n.c*r,n.d*r,n.tx*s,n.ty*s)},t.prototype.clear=function(e,t){void 0===e&&(e=this._backgroundColorString),void 0===t&&(t=this.backgroundAlpha);var r=this.context;r.clearRect(0,0,this.width,this.height),e&&(r.globalAlpha=this.useContextAlpha?t:1,r.fillStyle=e,r.fillRect(0,0,this.width,this.height),r.globalAlpha=1)},t.prototype.setBlendMode=function(e,t){var r=e===BLEND_MODES2.SRC_IN||e===BLEND_MODES2.SRC_OUT||e===BLEND_MODES2.DST_IN||e===BLEND_MODES2.DST_ATOP;!t&&r&&(e=BLEND_MODES2.NORMAL),this._activeBlendMode!==e&&(this._activeBlendMode=e,this._outerBlend=r,this.context.globalCompositeOperation=this.blendModes[e])},t.prototype.destroy=function(t){e.prototype.destroy.call(this,t),this.context=null,this.refresh=!0,this.maskManager.destroy(),this.maskManager=null,this.smoothProperty=null},t.prototype.resize=function(t,r){e.prototype.resize.call(this,t,r),this.smoothProperty&&(this.rootContext[this.smoothProperty]=settings.SCALE_MODE===SCALE_MODES2.LINEAR)},t.prototype.invalidateBlendMode=function(){this._activeBlendMode=this.blendModes.indexOf(this.context.globalCompositeOperation)},t.registerPlugin=function(e,r){t.__plugins=t.__plugins||{},t.__plugins[e]=r},t}(AbstractRenderer),canvasUtils={canvas:null,getTintedCanvas:function(e,t){var r=e.texture,n="#"+("00000"+(0|(t=canvasUtils.roundColor(t))).toString(16)).substr(-6);r.tintCache=r.tintCache||{};var i,s=r.tintCache[n];if(s){if(s.tintId===r._updateID)return r.tintCache[n];i=r.tintCache[n]}else i=document.createElement("canvas");if(canvasUtils.tintMethod(r,t,i),i.tintId=r._updateID,canvasUtils.convertTintToImage){var o=new Image;o.src=i.toDataURL(),r.tintCache[n]=o}else r.tintCache[n]=i;return i},getTintedPattern:function(e,t){var r="#"+("00000"+(0|(t=canvasUtils.roundColor(t))).toString(16)).substr(-6);e.patternCache=e.patternCache||{};var n=e.patternCache[r];return n&&n.tintId===e._updateID||(canvasUtils.canvas||(canvasUtils.canvas=document.createElement("canvas")),canvasUtils.tintMethod(e,t,canvasUtils.canvas),(n=canvasUtils.canvas.getContext("2d").createPattern(canvasUtils.canvas,"repeat")).tintId=e._updateID,e.patternCache[r]=n),n},tintWithMultiply:function(e,t,r){var n=r.getContext("2d"),i=e._frame.clone(),s=e.baseTexture.resolution;i.x*=s,i.y*=s,i.width*=s,i.height*=s,r.width=Math.ceil(i.width),r.height=Math.ceil(i.height),n.save(),n.fillStyle="#"+("00000"+(0|t).toString(16)).substr(-6),n.fillRect(0,0,i.width,i.height),n.globalCompositeOperation="multiply";var o=e.baseTexture.getDrawableSource();n.drawImage(o,i.x,i.y,i.width,i.height,0,0,i.width,i.height),n.globalCompositeOperation="destination-atop",n.drawImage(o,i.x,i.y,i.width,i.height,0,0,i.width,i.height),n.restore()},tintWithOverlay:function(e,t,r){var n=r.getContext("2d"),i=e._frame.clone(),s=e.baseTexture.resolution;i.x*=s,i.y*=s,i.width*=s,i.height*=s,r.width=Math.ceil(i.width),r.height=Math.ceil(i.height),n.save(),n.globalCompositeOperation="copy",n.fillStyle="#"+("00000"+(0|t).toString(16)).substr(-6),n.fillRect(0,0,i.width,i.height),n.globalCompositeOperation="destination-atop",n.drawImage(e.baseTexture.getDrawableSource(),i.x,i.y,i.width,i.height,0,0,i.width,i.height),n.restore()},tintWithPerPixel:function(e,t,r){var n=r.getContext("2d"),i=e._frame.clone(),s=e.baseTexture.resolution;i.x*=s,i.y*=s,i.width*=s,i.height*=s,r.width=Math.ceil(i.width),r.height=Math.ceil(i.height),n.save(),n.globalCompositeOperation="copy",n.drawImage(e.baseTexture.getDrawableSource(),i.x,i.y,i.width,i.height,0,0,i.width,i.height),n.restore();for(var o=hex2rgb(t),a=o[0],l=o[1],h=o[2],u=n.getImageData(0,0,i.width,i.height),c=u.data,d=0;d<c.length;d+=4)c[d+0]*=a,c[d+1]*=l,c[d+2]*=h;n.putImageData(u,0,0)},roundColor:function(e){var t=canvasUtils.cacheStepsPerColorChannel,r=hex2rgb(e);return r[0]=Math.min(255,r[0]/t*t),r[1]=Math.min(255,r[1]/t*t),r[2]=Math.min(255,r[2]/t*t),rgb2hex(r)},cacheStepsPerColorChannel:8,convertTintToImage:!1,canUseMultiply:canUseNewCanvasBlendModes(),tintMethod:null};canvasUtils.tintMethod=canvasUtils.canUseMultiply?canvasUtils.tintWithMultiply:canvasUtils.tintWithPerPixel;var parentCreate=Renderer.create;Renderer.create=function(e){if(!e||!e.forceCanvas)try{return parentCreate(e)}catch(e){}return new CanvasRenderer(e)},BaseTexture.prototype.getDrawableSource=function(){var e=this.resource;return e?e.bitmap||e.source:null},BaseRenderTexture.prototype._canvasRenderTarget=null,Texture.prototype.patternCache=null,Texture.prototype.tintCache=null;var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function createCommonjsModule(e,t,r){return e(r={path:t,exports:{},require:function(e,t){return commonjsRequire(e,null==t?r.path:t)}},r.exports),r.exports}function commonjsRequire(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var eventemitter3=createCommonjsModule((function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function s(e,t,n,s,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new i(n,s||e,o),l=r?r+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],a]:e._events[l].push(a):(e._events[l]=a,e._eventsCount++),e}function o(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function a(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),a.prototype.eventNames=function(){var e,n,i=[];if(0===this._eventsCount)return i;for(n in e=this._events)t.call(e,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},a.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,s=n.length,o=new Array(s);i<s;i++)o[i]=n[i].fn;return o},a.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},a.prototype.emit=function(e,t,n,i,s,o){var a=arguments,l=r?r+e:e;if(!this._events[l])return!1;var h,u,c=this._events[l],d=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,n),!0;case 4:return c.fn.call(c.context,t,n,i),!0;case 5:return c.fn.call(c.context,t,n,i,s),!0;case 6:return c.fn.call(c.context,t,n,i,s,o),!0}for(u=1,h=new Array(d-1);u<d;u++)h[u-1]=a[u];c.fn.apply(c.context,h)}else{var f,p=c.length;for(u=0;u<p;u++)switch(c[u].once&&this.removeListener(e,c[u].fn,void 0,!0),d){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,t);break;case 3:c[u].fn.call(c[u].context,t,n);break;case 4:c[u].fn.call(c[u].context,t,n,i);break;default:if(!h)for(f=1,h=new Array(d-1);f<d;f++)h[f-1]=a[f];c[u].fn.apply(c[u].context,h)}}return!0},a.prototype.on=function(e,t,r){return s(this,e,t,r,!1)},a.prototype.once=function(e,t,r){return s(this,e,t,r,!0)},a.prototype.removeListener=function(e,t,n,i){var s=r?r+e:e;if(!this._events[s])return this;if(!t)return o(this,s),this;var a=this._events[s];if(a.fn)a.fn===t&&(!i||a.once)&&(!n||a.context===n)&&o(this,s);else{for(var l=0,h=[],u=a.length;l<u;l++)(a[l].fn!==t||i&&!a[l].once||n&&a[l].context!==n)&&h.push(a[l]);h.length?this._events[s]=1===h.length?h[0]:h:o(this,s)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&o(this,t)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,e.exports=a})),punycode=createCommonjsModule((function(e,t){!function(r){var n=t&&!t.nodeType&&t,i=e&&!e.nodeType&&e,s="object"==typeof commonjsGlobal&&commonjsGlobal;(s.global===s||s.window===s||s.self===s)&&(r=s);var o,a,l=2147483647,h=36,u=/^xn--/,c=/[^\x20-\x7E]/,d=/[\x2E\u3002\uFF0E\uFF61]/g,f={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},p=Math.floor,m=String.fromCharCode;function _(e){throw RangeError(f[e])}function g(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function v(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),n+g((e=e.replace(d,".")).split("."),t).join(".")}function y(e){for(var t,r,n=[],i=0,s=e.length;i<s;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<s?56320==(64512&(r=e.charCodeAt(i++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),i--):n.push(t);return n}function b(e){return g(e,(function(e){var t="";return e>65535&&(t+=m((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+m(e)})).join("")}function x(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function S(e,t,r){var n=0;for(e=r?p(e/700):e>>1,e+=p(e/t);e>455;n+=h)e=p(e/35);return p(n+36*e/(e+38))}function T(e){var t,r,n,i,s,o,a,u,c,d,f,m=[],g=e.length,v=0,y=128,x=72;for((r=e.lastIndexOf("-"))<0&&(r=0),n=0;n<r;++n)e.charCodeAt(n)>=128&&_("not-basic"),m.push(e.charCodeAt(n));for(i=r>0?r+1:0;i<g;){for(s=v,o=1,a=h;i>=g&&_("invalid-input"),((u=(f=e.charCodeAt(i++))-48<10?f-22:f-65<26?f-65:f-97<26?f-97:h)>=h||u>p((l-v)/o))&&_("overflow"),v+=u*o,!(u<(c=a<=x?1:a>=x+26?26:a-x));a+=h)o>p(l/(d=h-c))&&_("overflow"),o*=d;x=S(v-s,t=m.length+1,0==s),p(v/t)>l-y&&_("overflow"),y+=p(v/t),v%=t,m.splice(v++,0,y)}return b(m)}function E(e){var t,r,n,i,s,o,a,u,c,d,f,g,v,b,T,E=[];for(g=(e=y(e)).length,t=128,r=0,s=72,o=0;o<g;++o)(f=e[o])<128&&E.push(m(f));for(n=i=E.length,i&&E.push("-");n<g;){for(a=l,o=0;o<g;++o)(f=e[o])>=t&&f<a&&(a=f);for(a-t>p((l-r)/(v=n+1))&&_("overflow"),r+=(a-t)*v,t=a,o=0;o<g;++o)if((f=e[o])<t&&++r>l&&_("overflow"),f==t){for(u=r,c=h;!(u<(d=c<=s?1:c>=s+26?26:c-s));c+=h)T=u-d,b=h-d,E.push(m(x(d+T%b,0))),u=p(T/b);E.push(m(x(u,0))),s=S(r,v,n==i),r=0,++n}++r,++t}return E.join("")}if(o={version:"1.3.2",ucs2:{decode:y,encode:b},decode:T,encode:E,toASCII:function(e){return v(e,(function(e){return c.test(e)?"xn--"+E(e):e}))},toUnicode:function(e){return v(e,(function(e){return u.test(e)?T(e.slice(4).toLowerCase()):e}))}},n&&i)if(e.exports==n)i.exports=o;else for(a in o)o.hasOwnProperty(a)&&(n[a]=o[a]);else r.punycode=o}(commonjsGlobal)})),util2={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}};function hasOwnProperty(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var decode=function(e,t,r,n){t=t||"&",r=r||"=";var i={};if("string"!=typeof e||0===e.length)return i;var s=/\+/g;e=e.split(t);var o=1e3;n&&"number"==typeof n.maxKeys&&(o=n.maxKeys);var a=e.length;o>0&&a>o&&(a=o);for(var l=0;l<a;++l){var h,u,c,d,f=e[l].replace(s,"%20"),p=f.indexOf(r);p>=0?(h=f.substr(0,p),u=f.substr(p+1)):(h=f,u=""),c=decodeURIComponent(h),d=decodeURIComponent(u),hasOwnProperty(i,c)?Array.isArray(i[c])?i[c].push(d):i[c]=[i[c],d]:i[c]=d}return i},stringifyPrimitive=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}},encode=function(e,t,r,n){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map((function(n){var i=encodeURIComponent(stringifyPrimitive(n))+r;return Array.isArray(e[n])?e[n].map((function(e){return i+encodeURIComponent(stringifyPrimitive(e))})).join(t):i+encodeURIComponent(stringifyPrimitive(e[n]))})).join(t):n?encodeURIComponent(stringifyPrimitive(n))+r+encodeURIComponent(stringifyPrimitive(e)):""},querystring=createCommonjsModule((function(e,t){t.decode=t.parse=decode,t.encode=t.stringify=encode})),parse2=urlParse,resolve3=urlResolve,format2=urlFormat;function Url2(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var protocolPattern=/^([a-z0-9.+-]+:)/i,portPattern=/:[0-9]*$/,simplePathPattern=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,delims=["<",">",'"',"`"," ","\r","\n","\t"],unwise=["{","}","|","\\","^","`"].concat(delims),autoEscape=["'"].concat(unwise),nonHostChars=["%","/","?",";","#"].concat(autoEscape),hostEndingChars=["/","?","#"],hostnameMaxLen=255,hostnamePartPattern=/^[+a-z0-9A-Z_-]{0,63}$/,hostnamePartStart=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,unsafeProtocol={javascript:!0,"javascript:":!0},hostlessProtocol={javascript:!0,"javascript:":!0},slashedProtocol={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function urlParse(e,t,r){if(e&&util2.isObject(e)&&e instanceof Url2)return e;var n=new Url2;return n.parse(e,t,r),n}function urlFormat(e){return util2.isString(e)&&(e=urlParse(e)),e instanceof Url2?e.format():Url2.prototype.format.call(e)}function urlResolve(e,t){return urlParse(e,!1,!0).resolve(t)}Url2.prototype.parse=function(e,t,r){if(!util2.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var n=e.indexOf("?"),i=-1!==n&&n<e.indexOf("#")?"?":"#",s=e.split(i);s[0]=s[0].replace(/\\/g,"/");var o=e=s.join(i);if(o=o.trim(),!r&&1===e.split("#").length){var a=simplePathPattern.exec(o);if(a)return this.path=o,this.href=o,this.pathname=a[1],a[2]?(this.search=a[2],this.query=t?querystring.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var l=protocolPattern.exec(o);if(l){var h=(l=l[0]).toLowerCase();this.protocol=h,o=o.substr(l.length)}if(r||l||o.match(/^\/\/[^@\/]+@[^@\/]+/)){var u="//"===o.substr(0,2);u&&(!l||!hostlessProtocol[l])&&(o=o.substr(2),this.slashes=!0)}if(!hostlessProtocol[l]&&(u||l&&!slashedProtocol[l])){for(var c=-1,d=0;d<hostEndingChars.length;d++)-1!==(m=o.indexOf(hostEndingChars[d]))&&(-1===c||m<c)&&(c=m);var f,p;for(-1!==(p=-1===c?o.lastIndexOf("@"):o.lastIndexOf("@",c))&&(f=o.slice(0,p),o=o.slice(p+1),this.auth=decodeURIComponent(f)),c=-1,d=0;d<nonHostChars.length;d++){var m;-1!==(m=o.indexOf(nonHostChars[d]))&&(-1===c||m<c)&&(c=m)}-1===c&&(c=o.length),this.host=o.slice(0,c),o=o.slice(c),this.parseHost(),this.hostname=this.hostname||"";var _="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!_)for(var g=this.hostname.split(/\./),v=(d=0,g.length);d<v;d++){var y=g[d];if(y&&!y.match(hostnamePartPattern)){for(var b="",x=0,S=y.length;x<S;x++)y.charCodeAt(x)>127?b+="x":b+=y[x];if(!b.match(hostnamePartPattern)){var T=g.slice(0,d),E=g.slice(d+1),A=y.match(hostnamePartStart);A&&(T.push(A[1]),E.unshift(A[2])),E.length&&(o="/"+E.join(".")+o),this.hostname=T.join(".");break}}}this.hostname.length>hostnameMaxLen?this.hostname="":this.hostname=this.hostname.toLowerCase(),_||(this.hostname=punycode.toASCII(this.hostname));var w=this.port?":"+this.port:"",C=this.hostname||"";this.host=C+w,this.href+=this.host,_&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==o[0]&&(o="/"+o))}if(!unsafeProtocol[h])for(d=0,v=autoEscape.length;d<v;d++){var O=autoEscape[d];if(-1!==o.indexOf(O)){var R=encodeURIComponent(O);R===O&&(R=escape(O)),o=o.split(O).join(R)}}var D=o.indexOf("#");-1!==D&&(this.hash=o.substr(D),o=o.slice(0,D));var I=o.indexOf("?");if(-1!==I?(this.search=o.substr(I),this.query=o.substr(I+1),t&&(this.query=querystring.parse(this.query)),o=o.slice(0,I)):t&&(this.search="",this.query={}),o&&(this.pathname=o),slashedProtocol[h]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){w=this.pathname||"";var M=this.search||"";this.path=w+M}return this.href=this.format(),this},Url2.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",i=!1,s="";this.host?i=e+this.host:this.hostname&&(i=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&util2.isObject(this.query)&&Object.keys(this.query).length&&(s=querystring.stringify(this.query));var o=this.search||s&&"?"+s||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||slashedProtocol[t])&&!1!==i?(i="//"+(i||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):i||(i=""),n&&"#"!==n.charAt(0)&&(n="#"+n),o&&"?"!==o.charAt(0)&&(o="?"+o),t+i+(r=r.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(o=o.replace("#","%23"))+n},Url2.prototype.resolve=function(e){return this.resolveObject(urlParse(e,!1,!0)).format()},Url2.prototype.resolveObject=function(e){if(util2.isString(e)){var t=new Url2;t.parse(e,!1,!0),e=t}for(var r=new Url2,n=Object.keys(this),i=0;i<n.length;i++){var s=n[i];r[s]=this[s]}if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var o=Object.keys(e),a=0;a<o.length;a++){var l=o[a];"protocol"!==l&&(r[l]=e[l])}return slashedProtocol[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!slashedProtocol[e.protocol]){for(var h=Object.keys(e),u=0;u<h.length;u++){var c=h[u];r[c]=e[c]}return r.href=r.format(),r}if(r.protocol=e.protocol,e.host||hostlessProtocol[e.protocol])r.pathname=e.pathname;else{for(var d=(e.pathname||"").split("/");d.length&&!(e.host=d.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),r.pathname=d.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var f=r.pathname||"",p=r.search||"";r.path=f+p}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var m=r.pathname&&"/"===r.pathname.charAt(0),_=e.host||e.pathname&&"/"===e.pathname.charAt(0),g=_||m||r.host&&e.pathname,v=g,y=r.pathname&&r.pathname.split("/")||[],b=(d=e.pathname&&e.pathname.split("/")||[],r.protocol&&!slashedProtocol[r.protocol]);if(b&&(r.hostname="",r.port=null,r.host&&(""===y[0]?y[0]=r.host:y.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===d[0]?d[0]=e.host:d.unshift(e.host)),e.host=null),g=g&&(""===d[0]||""===y[0])),_)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,y=d;else if(d.length)y||(y=[]),y.pop(),y=y.concat(d),r.search=e.search,r.query=e.query;else if(!util2.isNullOrUndefined(e.search))return b&&(r.hostname=r.host=y.shift(),(A=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=A.shift(),r.host=r.hostname=A.shift())),r.search=e.search,r.query=e.query,(!util2.isNull(r.pathname)||!util2.isNull(r.search))&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r;if(!y.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var x=y.slice(-1)[0],S=(r.host||e.host||y.length>1)&&("."===x||".."===x)||""===x,T=0,E=y.length;E>=0;E--)"."===(x=y[E])?y.splice(E,1):".."===x?(y.splice(E,1),T++):T&&(y.splice(E,1),T--);if(!g&&!v)for(;T--;T)y.unshift("..");g&&""!==y[0]&&(!y[0]||"/"!==y[0].charAt(0))&&y.unshift(""),S&&"/"!==y.join("/").substr(-1)&&y.push("");var A,w=""===y[0]||y[0]&&"/"===y[0].charAt(0);return b&&(r.hostname=r.host=w?"":y.length?y.shift():"",(A=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=A.shift(),r.host=r.hostname=A.shift())),(g=g||r.host&&y.length)&&!w&&y.unshift(""),y.length?r.pathname=y.join("/"):(r.pathname=null,r.path=null),(!util2.isNull(r.pathname)||!util2.isNull(r.search))&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},Url2.prototype.parseHost=function(){var e=this.host,t=portPattern.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)};var url2={parse:parse2,format:format2,resolve:resolve3};settings.RETINA_PREFIX=/@([0-9\.]+)x/,settings.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var saidHello2=!1,VERSION2="6.0.4",supported2;function sayHello2(e){var t;if(!saidHello2){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var r=["\n %c %c %c PixiJS "+VERSION2+" -  "+e+"   %c  %c  http://www.pixijs.com/  %c %c %c%c \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(t=self.console).log.apply(t,r)}else self.console&&self.console.log("PixiJS "+VERSION2+" - "+e+" - http://www.pixijs.com/");saidHello2=!0}}function isWebGLSupported2(){return void 0===supported2&&(supported2=function(){var e={stencil:!0,failIfMajorPerformanceCaveat:settings.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!self.WebGLRenderingContext)return!1;var t=document.createElement("canvas"),r=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),n=!(!r||!r.getContextAttributes().stencil);if(r){var i=r.getExtension("WEBGL_lose_context");i&&i.loseContext()}return r=null,n}catch(e){return!1}}()),supported2}function hex2rgb2(e,t){return void 0===t&&(t=[]),t[0]=(e>>16&255)/255,t[1]=(e>>8&255)/255,t[2]=(255&e)/255,t}function hex2string2(e){var t=e.toString(16);return"#"+("000000".substr(0,6-t.length)+t)}function mapPremultipliedBlendModes2(){for(var e=[],t=[],r=0;r<32;r++)e[r]=r,t[r]=r;e[BLEND_MODES2.NORMAL_NPM]=BLEND_MODES2.NORMAL,e[BLEND_MODES2.ADD_NPM]=BLEND_MODES2.ADD,e[BLEND_MODES2.SCREEN_NPM]=BLEND_MODES2.SCREEN,t[BLEND_MODES2.NORMAL]=BLEND_MODES2.NORMAL_NPM,t[BLEND_MODES2.ADD]=BLEND_MODES2.ADD_NPM,t[BLEND_MODES2.SCREEN]=BLEND_MODES2.SCREEN_NPM;var n=[];return n.push(t),n.push(e),n}var premultiplyBlendMode2=mapPremultipliedBlendModes2();function premultiplyTint2(e,t){if(1===t)return(255*t<<24)+e;if(0===t)return 0;var r=e>>16&255,n=e>>8&255,i=255&e;return(255*t<<24)+((r=r*t+.5|0)<<16)+((n=n*t+.5|0)<<8)+(i*t+.5|0)}function nextPow22(e){return e+=0===e?1:0,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,1+(e|=e>>>16)}function isPow22(e){return!(e&e-1||!e)}function log22(e){var t=(e>65535?1:0)<<4,r=((e>>>=t)>255?1:0)<<3;return t|=r,t|=r=((e>>>=r)>15?1:0)<<2,(t|=r=((e>>>=r)>3?1:0)<<1)|(e>>>=r)>>1}function removeItems2(e,t,r){var n,i=e.length;if(!(t>=i||0===r)){var s=i-(r=t+r>i?i-t:r);for(n=t;n<s;++n)e[n]=e[n+r];e.length=s}}var nextUid2=0;function uid2(){return++nextUid2}var warnings2={};function deprecation2(e,t,r){if(void 0===r&&(r=3),!warnings2[t]){var n=(new Error).stack;void 0===n?console.warn("PixiJS Deprecation Warning: ",t+"\nDeprecated since v"+e):(n=n.split("\n").splice(r).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",t+"\nDeprecated since v"+e),console.warn(n),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",t+"\nDeprecated since v"+e),console.warn(n))),warnings2[t]=!0}}var ProgramCache2={},TextureCache2=Object.create(null),BaseTextureCache2=Object.create(null),CanvasRenderTarget2=function(){function e(e,t,r){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=r||settings.RESOLUTION,this.resize(e,t)}return e.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},e.prototype.resize=function(e,t){this.canvas.width=e*this.resolution,this.canvas.height=t*this.resolution},e.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(e.prototype,"width",{get:function(){return this.canvas.width},set:function(e){this.canvas.width=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.canvas.height},set:function(e){this.canvas.height=e},enumerable:!1,configurable:!0}),e}(),tempAnchor3;function determineCrossOrigin2(e,t){if(void 0===t&&(t=self.location),0===e.indexOf("data:"))return"";t=t||self.location,tempAnchor3||(tempAnchor3=document.createElement("a")),tempAnchor3.href=e;var r=url2.parse(tempAnchor3.href),n=!r.port&&""===t.port||r.port===t.port;return r.hostname===t.hostname&&n&&r.protocol===t.protocol?"":"anonymous"}function getResolutionOfUrl2(e,t){var r=settings.RETINA_PREFIX.exec(e);return r?parseFloat(r[1]):void 0!==t?t:1}var Runner2=function(){function e(e){this.items=[],this._name=e,this._aliasCount=0}return e.prototype.emit=function(e,t,r,n,i,s,o,a){if(arguments.length>8)throw new Error("max arguments reached");var l=this,h=l.name,u=l.items;this._aliasCount++;for(var c=0,d=u.length;c<d;c++)u[c][h](e,t,r,n,i,s,o,a);return u===this.items&&this._aliasCount--,this},e.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},e.prototype.add=function(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this},e.prototype.remove=function(e){var t=this.items.indexOf(e);return-1!==t&&(this.ensureNonAliasedItems(),this.items.splice(t,1)),this},e.prototype.contains=function(e){return-1!==this.items.indexOf(e)},e.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},e.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(e.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),e}(),UPDATE_PRIORITY2;Object.defineProperties(Runner2.prototype,{dispatch:{value:Runner2.prototype.emit},run:{value:Runner2.prototype.emit}}),settings.TARGET_FPMS=.06,function(e){e[e.INTERACTION=50]="INTERACTION",e[e.HIGH=25]="HIGH",e[e.NORMAL=0]="NORMAL",e[e.LOW=-25]="LOW",e[e.UTILITY=-50]="UTILITY"}(UPDATE_PRIORITY2||(UPDATE_PRIORITY2={}));var TickerListener2=function(){function e(e,t,r,n){void 0===t&&(t=null),void 0===r&&(r=0),void 0===n&&(n=!1),this.next=null,this.previous=null,this._destroyed=!1,this.fn=e,this.context=t,this.priority=r,this.once=n}return e.prototype.match=function(e,t){return void 0===t&&(t=null),this.fn===e&&this.context===t},e.prototype.emit=function(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));var t=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),t},e.prototype.connect=function(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this},e.prototype.destroy=function(e){void 0===e&&(e=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var t=this.next;return this.next=e?null:t,this.previous=null,t},e}(),Ticker2=function(){function e(){var e=this;this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new TickerListener2(null,null,1/0),this.deltaMS=1/settings.TARGET_FPMS,this.elapsedMS=1/settings.TARGET_FPMS,this._tick=function(t){e._requestId=null,e.started&&(e.update(t),e.started&&null===e._requestId&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}return e.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},e.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},e.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},e.prototype.add=function(e,t,r){return void 0===r&&(r=UPDATE_PRIORITY2.NORMAL),this._addListener(new TickerListener2(e,t,r))},e.prototype.addOnce=function(e,t,r){return void 0===r&&(r=UPDATE_PRIORITY2.NORMAL),this._addListener(new TickerListener2(e,t,r,!0))},e.prototype._addListener=function(e){var t=this._head.next,r=this._head;if(t){for(;t;){if(e.priority>t.priority){e.connect(r);break}r=t,t=t.next}e.previous||e.connect(r)}else e.connect(r);return this._startIfPossible(),this},e.prototype.remove=function(e,t){for(var r=this._head.next;r;)r=r.match(e,t)?r.destroy():r.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(e.prototype,"count",{get:function(){if(!this._head)return 0;for(var e=0,t=this._head;t=t.next;)e++;return e},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},e.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},e.prototype.destroy=function(){if(!this._protected){this.stop();for(var e=this._head.next;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}},e.prototype.update=function(e){var t;if(void 0===e&&(e=performance.now()),e>this.lastTime){if((t=this.elapsedMS=e-this.lastTime)>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){var r=e-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=e-r%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*settings.TARGET_FPMS;for(var n=this._head,i=n.next;i;)i=i.emit(this.deltaTime);n.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e},Object.defineProperty(e.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(e){var t=Math.min(this.maxFPS,e),r=Math.min(Math.max(0,t)/1e3,settings.TARGET_FPMS);this._maxElapsedMS=1/r},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(e){if(0===e)this._minElapsedMS=0;else{var t=Math.max(this.minFPS,e);this._minElapsedMS=1/(t/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(e,"shared",{get:function(){if(!e._shared){var t=e._shared=new e;t.autoStart=!0,t._protected=!0}return e._shared},enumerable:!1,configurable:!0}),Object.defineProperty(e,"system",{get:function(){if(!e._system){var t=e._system=new e;t.autoStart=!0,t._protected=!0}return e._system},enumerable:!1,configurable:!0}),e}(),PI_22=2*Math.PI,SHAPES2;!function(e){e[e.POLY=0]="POLY",e[e.RECT=1]="RECT",e[e.CIRC=2]="CIRC",e[e.ELIP=3]="ELIP",e[e.RREC=4]="RREC"}(SHAPES2||(SHAPES2={}));var Rectangle2=function(){function e(e,t,r,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),void 0===n&&(n=0),this.x=Number(e),this.y=Number(t),this.width=Number(r),this.height=Number(n),this.type=SHAPES2.RECT}return Object.defineProperty(e.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(e,"EMPTY",{get:function(){return new e(0,0,0,0)},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e.prototype.copyFrom=function(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this},e.prototype.copyTo=function(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e},e.prototype.contains=function(e,t){return!(this.width<=0||this.height<=0)&&e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height},e.prototype.pad=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=e),this.x-=e,this.y-=t,this.width+=2*e,this.height+=2*t,this},e.prototype.fit=function(e){var t=Math.max(this.x,e.x),r=Math.min(this.x+this.width,e.x+e.width),n=Math.max(this.y,e.y),i=Math.min(this.y+this.height,e.y+e.height);return this.x=t,this.width=Math.max(r-t,0),this.y=n,this.height=Math.max(i-n,0),this},e.prototype.ceil=function(e,t){void 0===e&&(e=1),void 0===t&&(t=.001);var r=Math.ceil((this.x+this.width-t)*e)/e,n=Math.ceil((this.y+this.height-t)*e)/e;return this.x=Math.floor((this.x+t)*e)/e,this.y=Math.floor((this.y+t)*e)/e,this.width=r-this.x,this.height=n-this.y,this},e.prototype.enlarge=function(e){var t=Math.min(this.x,e.x),r=Math.max(this.x+this.width,e.x+e.width),n=Math.min(this.y,e.y),i=Math.max(this.y+this.height,e.y+e.height);return this.x=t,this.width=r-t,this.y=n,this.height=i-n,this},e.prototype.toString=function(){return"[@pixi/math:Rectangle x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},e}(),Point2=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.x=0,this.y=0,this.x=e,this.y=t}return e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.copyFrom=function(e){return this.set(e.x,e.y),this},e.prototype.copyTo=function(e){return e.set(this.x,this.y),e},e.prototype.equals=function(e){return e.x===this.x&&e.y===this.y},e.prototype.set=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=e),this.x=e,this.y=t,this},e.prototype.toString=function(){return"[@pixi/math:Point x="+this.x+" y="+this.y+"]"},e}(),ObservablePoint2=function(){function e(e,t,r,n){void 0===r&&(r=0),void 0===n&&(n=0),this._x=r,this._y=n,this.cb=e,this.scope=t}return e.prototype.clone=function(t,r){return void 0===t&&(t=this.cb),void 0===r&&(r=this.scope),new e(t,r,this._x,this._y)},e.prototype.set=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=e),(this._x!==e||this._y!==t)&&(this._x=e,this._y=t,this.cb.call(this.scope)),this},e.prototype.copyFrom=function(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this},e.prototype.copyTo=function(e){return e.set(this._x,this._y),e},e.prototype.equals=function(e){return e.x===this._x&&e.y===this._y},e.prototype.toString=function(){return"[@pixi/math:ObservablePoint x=0 y=0 scope="+this.scope+"]"},Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),e}(),Matrix2=function(){function e(e,t,r,n,i,s){void 0===e&&(e=1),void 0===t&&(t=0),void 0===r&&(r=0),void 0===n&&(n=1),void 0===i&&(i=0),void 0===s&&(s=0),this.array=null,this.a=e,this.b=t,this.c=r,this.d=n,this.tx=i,this.ty=s}return e.prototype.fromArray=function(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]},e.prototype.set=function(e,t,r,n,i,s){return this.a=e,this.b=t,this.c=r,this.d=n,this.tx=i,this.ty=s,this},e.prototype.toArray=function(e,t){this.array||(this.array=new Float32Array(9));var r=t||this.array;return e?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r},e.prototype.apply=function(e,t){t=t||new Point2;var r=e.x,n=e.y;return t.x=this.a*r+this.c*n+this.tx,t.y=this.b*r+this.d*n+this.ty,t},e.prototype.applyInverse=function(e,t){t=t||new Point2;var r=1/(this.a*this.d+this.c*-this.b),n=e.x,i=e.y;return t.x=this.d*r*n+-this.c*r*i+(this.ty*this.c-this.tx*this.d)*r,t.y=this.a*r*i+-this.b*r*n+(-this.ty*this.a+this.tx*this.b)*r,t},e.prototype.translate=function(e,t){return this.tx+=e,this.ty+=t,this},e.prototype.scale=function(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this},e.prototype.rotate=function(e){var t=Math.cos(e),r=Math.sin(e),n=this.a,i=this.c,s=this.tx;return this.a=n*t-this.b*r,this.b=n*r+this.b*t,this.c=i*t-this.d*r,this.d=i*r+this.d*t,this.tx=s*t-this.ty*r,this.ty=s*r+this.ty*t,this},e.prototype.append=function(e){var t=this.a,r=this.b,n=this.c,i=this.d;return this.a=e.a*t+e.b*n,this.b=e.a*r+e.b*i,this.c=e.c*t+e.d*n,this.d=e.c*r+e.d*i,this.tx=e.tx*t+e.ty*n+this.tx,this.ty=e.tx*r+e.ty*i+this.ty,this},e.prototype.setTransform=function(e,t,r,n,i,s,o,a,l){return this.a=Math.cos(o+l)*i,this.b=Math.sin(o+l)*i,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=e-(r*this.a+n*this.c),this.ty=t-(r*this.b+n*this.d),this},e.prototype.prepend=function(e){var t=this.tx;if(1!==e.a||0!==e.b||0!==e.c||1!==e.d){var r=this.a,n=this.c;this.a=r*e.a+this.b*e.c,this.b=r*e.b+this.b*e.d,this.c=n*e.a+this.d*e.c,this.d=n*e.b+this.d*e.d}return this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty,this},e.prototype.decompose=function(e){var t=this.a,r=this.b,n=this.c,i=this.d,s=e.pivot,o=-Math.atan2(-n,i),a=Math.atan2(r,t),l=Math.abs(o+a);return l<1e-5||Math.abs(PI_22-l)<1e-5?(e.rotation=a,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=o,e.skew.y=a),e.scale.x=Math.sqrt(t*t+r*r),e.scale.y=Math.sqrt(n*n+i*i),e.position.x=this.tx+(s.x*t+s.y*n),e.position.y=this.ty+(s.x*r+s.y*i),e},e.prototype.invert=function(){var e=this.a,t=this.b,r=this.c,n=this.d,i=this.tx,s=e*n-t*r;return this.a=n/s,this.b=-t/s,this.c=-r/s,this.d=e/s,this.tx=(r*this.ty-n*i)/s,this.ty=-(e*this.ty-t*i)/s,this},e.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},e.prototype.clone=function(){var t=new e;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},e.prototype.copyTo=function(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},e.prototype.copyFrom=function(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this},e.prototype.toString=function(){return"[@pixi/math:Matrix a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+"]"},Object.defineProperty(e,"IDENTITY",{get:function(){return new e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"TEMP_MATRIX",{get:function(){return new e},enumerable:!1,configurable:!0}),e}(),ux2=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],uy2=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],vx2=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],vy2=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],rotationCayley2=[],rotationMatrices2=[],signum2=Math.sign;function init2(){for(var e=0;e<16;e++){var t=[];rotationCayley2.push(t);for(var r=0;r<16;r++)for(var n=signum2(ux2[e]*ux2[r]+vx2[e]*uy2[r]),i=signum2(uy2[e]*ux2[r]+vy2[e]*uy2[r]),s=signum2(ux2[e]*vx2[r]+vx2[e]*vy2[r]),o=signum2(uy2[e]*vx2[r]+vy2[e]*vy2[r]),a=0;a<16;a++)if(ux2[a]===n&&uy2[a]===i&&vx2[a]===s&&vy2[a]===o){t.push(a);break}}for(e=0;e<16;e++){var l=new Matrix2;l.set(ux2[e],uy2[e],vx2[e],vy2[e],0,0),rotationMatrices2.push(l)}}init2();var groupD82={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(e){return ux2[e]},uY:function(e){return uy2[e]},vX:function(e){return vx2[e]},vY:function(e){return vy2[e]},inv:function(e){return 8&e?15&e:7&-e},add:function(e,t){return rotationCayley2[e][t]},sub:function(e,t){return rotationCayley2[e][groupD82.inv(t)]},rotate180:function(e){return 4^e},isVertical:function(e){return 2==(3&e)},byDirection:function(e,t){return 2*Math.abs(e)<=Math.abs(t)?t>=0?groupD82.S:groupD82.N:2*Math.abs(t)<=Math.abs(e)?e>0?groupD82.E:groupD82.W:t>0?e>0?groupD82.SE:groupD82.SW:e>0?groupD82.NE:groupD82.NW},matrixAppendRotationInv:function(e,t,r,n){void 0===r&&(r=0),void 0===n&&(n=0);var i=rotationMatrices2[groupD82.inv(t)];i.tx=r,i.ty=n,e.append(i)}},Transform2=function(){function e(){this.worldTransform=new Matrix2,this.localTransform=new Matrix2,this.position=new ObservablePoint2(this.onChange,this,0,0),this.scale=new ObservablePoint2(this.onChange,this,1,1),this.pivot=new ObservablePoint2(this.onChange,this,0,0),this.skew=new ObservablePoint2(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return e.prototype.onChange=function(){this._localID++},e.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},e.prototype.toString=function(){return"[@pixi/math:Transform position=("+this.position.x+", "+this.position.y+") rotation="+this.rotation+" scale=("+this.scale.x+", "+this.scale.y+") skew=("+this.skew.x+", "+this.skew.y+") ]"},e.prototype.updateLocalTransform=function(){var e=this.localTransform;this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1)},e.prototype.updateTransform=function(e){var t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==e._worldID){var r=e.worldTransform,n=this.worldTransform;n.a=t.a*r.a+t.b*r.c,n.b=t.a*r.b+t.b*r.d,n.c=t.c*r.a+t.d*r.c,n.d=t.c*r.b+t.d*r.d,n.tx=t.tx*r.a+t.ty*r.c+r.tx,n.ty=t.tx*r.b+t.ty*r.d+r.ty,this._parentID=e._worldID,this._worldID++}},e.prototype.setFromMatrix=function(e){e.decompose(this),this._localID++},Object.defineProperty(e.prototype,"rotation",{get:function(){return this._rotation},set:function(e){this._rotation!==e&&(this._rotation=e,this.updateSkew())},enumerable:!1,configurable:!0}),e.IDENTITY=new e,e}();settings.PREFER_ENV=isMobile2.any?ENV2.WEBGL:ENV2.WEBGL2,settings.STRICT_TEXTURE_CACHE=!1;var INSTALLED2=[];function autoDetectResource2(e,t){if(!e)return null;var r="";if("string"==typeof e){var n=/\.(\w{3,4})(?:$|\?|#)/i.exec(e);n&&(r=n[1].toLowerCase())}for(var i=INSTALLED2.length-1;i>=0;--i){var s=INSTALLED2[i];if(s.test&&s.test(e,r))return new s(e,t)}throw new Error("Unrecognized source type to auto-detect Resource")}var extendStatics23=function(e,t){return extendStatics23=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},extendStatics23(e,t)};function __extends23(e,t){function r(){this.constructor=e}extendStatics23(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var Resource3=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this._width=e,this._height=t,this.destroyed=!1,this.internal=!1,this.onResize=new Runner2("setRealSize"),this.onUpdate=new Runner2("update"),this.onError=new Runner2("onError")}return e.prototype.bind=function(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},e.prototype.unbind=function(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)},e.prototype.resize=function(e,t){(e!==this._width||t!==this._height)&&(this._width=e,this._height=t,this.onResize.emit(e,t))},Object.defineProperty(e.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),e.prototype.update=function(){this.destroyed||this.onUpdate.emit()},e.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),e.prototype.style=function(e,t,r){return!1},e.prototype.dispose=function(){},e.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},e.test=function(e,t){return!1},e}(),BufferResource2=function(e){function t(t,r){var n=this,i=r||{},s=i.width,o=i.height;if(!s||!o)throw new Error("BufferResource width or height invalid");return(n=e.call(this,s,o)||this).data=t,n}return __extends23(t,e),t.prototype.upload=function(e,t,r){var n=e.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===ALPHA_MODES2.UNPACK);var i=t.realWidth,s=t.realHeight;return r.width===i&&r.height===s?n.texSubImage2D(t.target,0,0,0,i,s,t.format,t.type,this.data):(r.width=i,r.height=s,n.texImage2D(t.target,0,r.internalFormat,i,s,0,t.format,r.type,this.data)),!0},t.prototype.dispose=function(){this.data=null},t.test=function(e){return e instanceof Float32Array||e instanceof Uint8Array||e instanceof Uint32Array},t}(Resource3),defaultBufferOptions2={scaleMode:SCALE_MODES2.NEAREST,format:FORMATS2.RGBA,alphaMode:ALPHA_MODES2.NPM},BaseTexture2=function(e){function t(t,r){void 0===t&&(t=null),void 0===r&&(r=null);var n=e.call(this)||this,i=(r=r||{}).alphaMode,s=r.mipmap,o=r.anisotropicLevel,a=r.scaleMode,l=r.width,h=r.height,u=r.wrapMode,c=r.format,d=r.type,f=r.target,p=r.resolution,m=r.resourceOptions;return t&&!(t instanceof Resource3)&&((t=autoDetectResource2(t,m)).internal=!0),n.width=l||0,n.height=h||0,n.resolution=p||settings.RESOLUTION,n.mipmap=void 0!==s?s:settings.MIPMAP_TEXTURES,n.anisotropicLevel=void 0!==o?o:settings.ANISOTROPIC_LEVEL,n.wrapMode=u||settings.WRAP_MODE,n.scaleMode=void 0!==a?a:settings.SCALE_MODE,n.format=c||FORMATS2.RGBA,n.type=d||TYPES2.UNSIGNED_BYTE,n.target=f||TARGETS2.TEXTURE_2D,n.alphaMode=void 0!==i?i:ALPHA_MODES2.UNPACK,n.uid=uid2(),n.touched=0,n.isPowerOfTwo=!1,n._refreshPOT(),n._glTextures={},n.dirtyId=0,n.dirtyStyleId=0,n.cacheId=null,n.valid=l>0&&h>0,n.textureCacheIds=[],n.destroyed=!1,n.resource=null,n._batchEnabled=0,n._batchLocation=0,n.parentTextureArray=null,n.setResource(t),n}return __extends23(t,e),Object.defineProperty(t.prototype,"realWidth",{get:function(){return Math.ceil(this.width*this.resolution-1e-4)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"realHeight",{get:function(){return Math.ceil(this.height*this.resolution-1e-4)},enumerable:!1,configurable:!0}),t.prototype.setStyle=function(e,t){var r;return void 0!==e&&e!==this.scaleMode&&(this.scaleMode=e,r=!0),void 0!==t&&t!==this.mipmap&&(this.mipmap=t,r=!0),r&&this.dirtyStyleId++,this},t.prototype.setSize=function(e,t,r){return this.resolution=r||this.resolution,this.width=e,this.height=t,this._refreshPOT(),this.update(),this},t.prototype.setRealSize=function(e,t,r){return this.resolution=r||this.resolution,this.width=e/this.resolution,this.height=t/this.resolution,this._refreshPOT(),this.update(),this},t.prototype._refreshPOT=function(){this.isPowerOfTwo=isPow22(this.realWidth)&&isPow22(this.realHeight)},t.prototype.setResolution=function(e){var t=this.resolution;return t===e||(this.resolution=e,this.valid&&(this.width=this.width*t/e,this.height=this.height*t/e,this.emit("update",this)),this._refreshPOT()),this},t.prototype.setResource=function(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this},t.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},t.prototype.onError=function(e){this.emit("error",this,e)},t.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete BaseTextureCache2[this.cacheId],delete TextureCache2[this.cacheId],this.cacheId=null),this.dispose(),t.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},t.prototype.dispose=function(){this.emit("dispose",this)},t.prototype.castToBaseTexture=function(){return this},t.from=function(e,r,n){void 0===n&&(n=settings.STRICT_TEXTURE_CACHE);var i="string"==typeof e,s=null;if(i)s=e;else{if(!e._pixiId){var o=r&&r.pixiIdPrefix||"pixiid";e._pixiId=o+"_"+uid2()}s=e._pixiId}var a=BaseTextureCache2[s];if(i&&n&&!a)throw new Error('The cacheId "'+s+'" does not exist in BaseTextureCache.');return a||((a=new t(e,r)).cacheId=s,t.addToCache(a,s)),a},t.fromBuffer=function(e,r,n,i){e=e||new Float32Array(r*n*4);var s=new BufferResource2(e,{width:r,height:n}),o=e instanceof Float32Array?TYPES2.FLOAT:TYPES2.UNSIGNED_BYTE;return new t(s,Object.assign(defaultBufferOptions2,i||{width:r,height:n,type:o}))},t.addToCache=function(e,t){t&&(-1===e.textureCacheIds.indexOf(t)&&e.textureCacheIds.push(t),BaseTextureCache2[t]&&console.warn("BaseTexture added to the cache with an id ["+t+"] that already had an entry"),BaseTextureCache2[t]=e)},t.removeFromCache=function(e){if("string"==typeof e){var t=BaseTextureCache2[e];if(t){var r=t.textureCacheIds.indexOf(e);return r>-1&&t.textureCacheIds.splice(r,1),delete BaseTextureCache2[e],t}}else if(e&&e.textureCacheIds){for(var n=0;n<e.textureCacheIds.length;++n)delete BaseTextureCache2[e.textureCacheIds[n]];return e.textureCacheIds.length=0,e}return null},t._globalBatch=0,t}(eventemitter3),AbstractMultiResource2=function(e){function t(t,r){var n=this,i=r||{},s=i.width,o=i.height;(n=e.call(this,s,o)||this).items=[],n.itemDirtyIds=[];for(var a=0;a<t;a++){var l=new BaseTexture2;n.items.push(l),n.itemDirtyIds.push(-2)}return n.length=t,n._load=null,n.baseTexture=null,n}return __extends23(t,e),t.prototype.initFromArray=function(e,t){for(var r=0;r<this.length;r++)!e[r]||(e[r].castToBaseTexture?this.addBaseTextureAt(e[r].castToBaseTexture(),r):e[r]instanceof Resource3?this.addResourceAt(e[r],r):this.addResourceAt(autoDetectResource2(e[r],t),r))},t.prototype.dispose=function(){for(var e=0,t=this.length;e<t;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},t.prototype.addResourceAt=function(e,t){if(!this.items[t])throw new Error("Index "+t+" is out of bounds");return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[t].setResource(e),this},t.prototype.bind=function(t){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");e.prototype.bind.call(this,t);for(var r=0;r<this.length;r++)this.items[r].parentTextureArray=t,this.items[r].on("update",t.update,t)},t.prototype.unbind=function(t){e.prototype.unbind.call(this,t);for(var r=0;r<this.length;r++)this.items[r].parentTextureArray=null,this.items[r].off("update",t.update,t)},t.prototype.load=function(){var e=this;if(this._load)return this._load;var t=this.items.map((function(e){return e.resource})).filter((function(e){return e})).map((function(e){return e.load()}));return this._load=Promise.all(t).then((function(){var t=e.items[0],r=t.realWidth,n=t.realHeight;return e.resize(r,n),Promise.resolve(e)})),this._load},t}(Resource3),ArrayResource2=function(e){function t(t,r){var n,i,s=this,o=r||{},a=o.width,l=o.height;return Array.isArray(t)?(n=t,i=t.length):i=t,s=e.call(this,i,{width:a,height:l})||this,n&&s.initFromArray(n,r),s}return __extends23(t,e),t.prototype.addBaseTextureAt=function(e,t){if(!e.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(e.resource,t),this},t.prototype.bind=function(t){e.prototype.bind.call(this,t),t.target=TARGETS2.TEXTURE_2D_ARRAY},t.prototype.upload=function(e,t,r){var n=this,i=n.length,s=n.itemDirtyIds,o=n.items,a=e.gl;r.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,t.format,this._width,this._height,i,0,t.format,t.type,null);for(var l=0;l<i;l++){var h=o[l];s[l]<h.dirtyId&&(s[l]=h.dirtyId,h.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,l,h.resource.width,h.resource.height,1,t.format,t.type,h.resource.source))}return!0},t}(AbstractMultiResource2),BaseImageResource2=function(e){function t(t){var r=this,n=t,i=n.naturalWidth||n.videoWidth||n.width,s=n.naturalHeight||n.videoHeight||n.height;return(r=e.call(this,i,s)||this).source=t,r.noSubImage=!1,r}return __extends23(t,e),t.crossOrigin=function(e,t,r){void 0===r&&0!==t.indexOf("data:")?e.crossOrigin=determineCrossOrigin2(t):!1!==r&&(e.crossOrigin="string"==typeof r?r:"anonymous")},t.prototype.upload=function(e,t,r,n){var i=e.gl,s=t.realWidth,o=t.realHeight;return n=n||this.source,i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===ALPHA_MODES2.UNPACK),this.noSubImage||t.target!==i.TEXTURE_2D||r.width!==s||r.height!==o?(r.width=s,r.height=o,i.texImage2D(t.target,0,t.format,t.format,t.type,n)):i.texSubImage2D(i.TEXTURE_2D,0,0,0,t.format,t.type,n),!0},t.prototype.update=function(){if(!this.destroyed){var t=this.source,r=t.naturalWidth||t.videoWidth||t.width,n=t.naturalHeight||t.videoHeight||t.height;this.resize(r,n),e.prototype.update.call(this)}},t.prototype.dispose=function(){this.source=null},t}(Resource3),CanvasResource2=function(e){function t(t){return e.call(this,t)||this}return __extends23(t,e),t.test=function(e){var t=self.OffscreenCanvas;return!!(t&&e instanceof t)||self.HTMLCanvasElement&&e instanceof HTMLCanvasElement},t}(BaseImageResource2),CubeResource2=function(e){function t(r,n){var i=this,s=n||{},o=s.width,a=s.height,l=s.autoLoad,h=s.linkBaseTexture;if(r&&r.length!==t.SIDES)throw new Error("Invalid length. Got "+r.length+", expected 6");i=e.call(this,6,{width:o,height:a})||this;for(var u=0;u<t.SIDES;u++)i.items[u].target=TARGETS2.TEXTURE_CUBE_MAP_POSITIVE_X+u;return i.linkBaseTexture=!1!==h,r&&i.initFromArray(r,n),!1!==l&&i.load(),i}return __extends23(t,e),t.prototype.bind=function(t){e.prototype.bind.call(this,t),t.target=TARGETS2.TEXTURE_CUBE_MAP},t.prototype.addBaseTextureAt=function(e,t,r){if(void 0===r&&(r=this.linkBaseTexture),!this.items[t])throw new Error("Index "+t+" is out of bounds");if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0){if(!e.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(e.resource,t)}else e.target=TARGETS2.TEXTURE_CUBE_MAP_POSITIVE_X+t,e.parentTextureArray=this.baseTexture,this.items[t]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[t]=e,this},t.prototype.upload=function(e,r,n){for(var i=this.itemDirtyIds,s=0;s<t.SIDES;s++){var o=this.items[s];i[s]<o.dirtyId&&(o.valid&&o.resource?(o.resource.upload(e,o,n),i[s]=o.dirtyId):i[s]<-1&&(e.gl.texImage2D(o.target,0,n.internalFormat,r.realWidth,r.realHeight,0,r.format,n.type,null),i[s]=-1))}return!0},t.test=function(e){return Array.isArray(e)&&e.length===t.SIDES},t.SIDES=6,t}(AbstractMultiResource2),ImageResource2=function(e){function t(t,r){var n=this;if(r=r||{},!(t instanceof HTMLImageElement)){var i=new Image;BaseImageResource2.crossOrigin(i,t,r.crossorigin),i.src=t,t=i}return n=e.call(this,t)||this,!t.complete&&!!n._width&&!!n._height&&(n._width=0,n._height=0),n.url=t.src,n._process=null,n.preserveBitmap=!1,n.createBitmap=(void 0!==r.createBitmap?r.createBitmap:settings.CREATE_IMAGE_BITMAP)&&!!self.createImageBitmap,n.alphaMode="number"==typeof r.alphaMode?r.alphaMode:null,n.bitmap=null,n._load=null,!1!==r.autoLoad&&n.load(),n}return __extends23(t,e),t.prototype.load=function(e){var t=this;return this._load||(void 0!==e&&(this.createBitmap=e),this._load=new Promise((function(e,r){var n=t.source;t.url=n.src;var i=function(){t.destroyed||(n.onload=null,n.onerror=null,t.resize(n.width,n.height),t._load=null,t.createBitmap?e(t.process()):e(t))};n.complete&&n.src?i():(n.onload=i,n.onerror=function(e){r(e),t.onError.emit(e)})}))),this._load},t.prototype.process=function(){var e=this,t=this.source;return null!==this._process?this._process:null===this.bitmap&&self.createImageBitmap?(this._process=self.createImageBitmap(t,0,0,t.width,t.height,{premultiplyAlpha:this.alphaMode===ALPHA_MODES2.UNPACK?"premultiply":"none"}).then((function(t){return e.destroyed?Promise.reject():(e.bitmap=t,e.update(),e._process=null,Promise.resolve(e))})),this._process):Promise.resolve(this)},t.prototype.upload=function(t,r,n){if("number"==typeof this.alphaMode&&(r.alphaMode=this.alphaMode),!this.createBitmap)return e.prototype.upload.call(this,t,r,n);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(e.prototype.upload.call(this,t,r,n,this.bitmap),!this.preserveBitmap){var i=!0,s=r._glTextures;for(var o in s){var a=s[o];if(a!==n&&a.dirtyId!==r.dirtyId){i=!1;break}}i&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},t.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,e.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},t.test=function(e){return"string"==typeof e||e instanceof HTMLImageElement},t}(BaseImageResource2),SVGResource2=function(e){function t(t,r){var n=this;return r=r||{},(n=e.call(this,document.createElement("canvas"))||this)._width=0,n._height=0,n.svg=t,n.scale=r.scale||1,n._overrideWidth=r.width,n._overrideHeight=r.height,n._resolve=null,n._crossorigin=r.crossorigin,n._load=null,!1!==r.autoLoad&&n.load(),n}return __extends23(t,e),t.prototype.load=function(){var e=this;return this._load||(this._load=new Promise((function(t){if(e._resolve=function(){e.resize(e.source.width,e.source.height),t(e)},/^\<svg/.test(e.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");e.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.svg)))}e._loadSvg()}))),this._load},t.prototype._loadSvg=function(){var e=this,t=new Image;BaseImageResource2.crossOrigin(t,this.svg,this._crossorigin),t.src=this.svg,t.onerror=function(r){!e._resolve||(t.onerror=null,e.onError.emit(r))},t.onload=function(){if(e._resolve){var r=t.width,n=t.height;if(!r||!n)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var i=r*e.scale,s=n*e.scale;(e._overrideWidth||e._overrideHeight)&&(i=e._overrideWidth||e._overrideHeight/n*r,s=e._overrideHeight||e._overrideWidth/r*n),i=Math.round(i),s=Math.round(s);var o=e.source;o.width=i,o.height=s,o._pixiId="canvas_"+uid2(),o.getContext("2d").drawImage(t,0,0,r,n,0,0,i,s),e._resolve(),e._resolve=null}}},t.getSize=function(e){var r=t.SVG_SIZE.exec(e),n={};return r&&(n[r[1]]=Math.round(parseFloat(r[3])),n[r[5]]=Math.round(parseFloat(r[7]))),n},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},t.test=function(e,t){return"svg"===t||"string"==typeof e&&/^data:image\/svg\+xml(;(charset=utf8|utf8))?;base64/.test(e)||"string"==typeof e&&0===e.indexOf("<svg")},t.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,t}(BaseImageResource2),VideoResource2=function(e){function t(r,n){var i=this;if(n=n||{},!(r instanceof HTMLVideoElement)){var s=document.createElement("video");s.setAttribute("preload","auto"),s.setAttribute("webkit-playsinline",""),s.setAttribute("playsinline",""),"string"==typeof r&&(r=[r]);var o=r[0].src||r[0];BaseImageResource2.crossOrigin(s,o,n.crossorigin);for(var a=0;a<r.length;++a){var l=document.createElement("source"),h=r[a],u=h.src,c=h.mime,d=(u=u||r[a]).split("?").shift().toLowerCase(),f=d.substr(d.lastIndexOf(".")+1);c=c||t.MIME_TYPES[f]||"video/"+f,l.src=u,l.type=c,s.appendChild(l)}r=s}return(i=e.call(this,r)||this).noSubImage=!0,i._autoUpdate=!0,i._isConnectedToTicker=!1,i._updateFPS=n.updateFPS||0,i._msToNextUpdate=0,i.autoPlay=!1!==n.autoPlay,i._load=null,i._resolve=null,i._onCanPlay=i._onCanPlay.bind(i),i._onError=i._onError.bind(i),!1!==n.autoLoad&&i.load(),i}return __extends23(t,e),t.prototype.update=function(t){if(!this.destroyed){var r=Ticker2.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-r),(!this._updateFPS||this._msToNextUpdate<=0)&&(e.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},t.prototype.load=function(){var e=this;if(this._load)return this._load;var t=this.source;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart.bind(this)),t.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlay),t.addEventListener("error",this._onError,!0)),this._load=new Promise((function(r){e.valid?r(e):(e._resolve=r,t.load())})),this._load},t.prototype._onError=function(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e)},t.prototype._isSourcePlaying=function(){var e=this.source;return e.currentTime>0&&!1===e.paused&&!1===e.ended&&e.readyState>2},t.prototype._isSourceReady=function(){var e=this.source;return 3===e.readyState||4===e.readyState},t.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Ticker2.shared.add(this.update,this),this._isConnectedToTicker=!0)},t.prototype._onPlayStop=function(){this._isConnectedToTicker&&(Ticker2.shared.remove(this.update,this),this._isConnectedToTicker=!1)},t.prototype._onCanPlay=function(){var e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);var t=this.valid;this.resize(e.videoWidth,e.videoHeight),!t&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()},t.prototype.dispose=function(){this._isConnectedToTicker&&Ticker2.shared.remove(this.update,this);var t=this.source;t&&(t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),e.prototype.dispose.call(this)},Object.defineProperty(t.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(Ticker2.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Ticker2.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(e){e!==this._updateFPS&&(this._updateFPS=e)},enumerable:!1,configurable:!0}),t.test=function(e,r){return self.HTMLVideoElement&&e instanceof HTMLVideoElement||t.TYPES.indexOf(r)>-1},t.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],t.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},t}(BaseImageResource2),ImageBitmapResource2=function(e){function t(t){return e.call(this,t)||this}return __extends23(t,e),t.test=function(e){return!!self.createImageBitmap&&e instanceof ImageBitmap},t}(BaseImageResource2);INSTALLED2.push(ImageResource2,ImageBitmapResource2,CanvasResource2,VideoResource2,SVGResource2,BufferResource2,CubeResource2,ArrayResource2);var _resources2={__proto__:null,Resource:Resource3,BaseImageResource:BaseImageResource2,INSTALLED:INSTALLED2,autoDetectResource:autoDetectResource2,AbstractMultiResource:AbstractMultiResource2,ArrayResource:ArrayResource2,BufferResource:BufferResource2,CanvasResource:CanvasResource2,CubeResource:CubeResource2,ImageResource:ImageResource2,SVGResource:SVGResource2,VideoResource:VideoResource2,ImageBitmapResource:ImageBitmapResource2},System2=function(){function e(e){this.renderer=e}return e.prototype.destroy=function(){this.renderer=null},e}(),DepthResource2=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends23(t,e),t.prototype.upload=function(e,t,r){var n=e.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===ALPHA_MODES2.UNPACK);var i=t.realWidth,s=t.realHeight;return r.width===i&&r.height===s?n.texSubImage2D(t.target,0,0,0,i,s,t.format,t.type,this.data):(r.width=i,r.height=s,n.texImage2D(t.target,0,1===e.context.webGLVersion?n.DEPTH_COMPONENT:n.DEPTH_COMPONENT16,i,s,0,t.format,t.type,this.data)),!0},t}(BufferResource2),Framebuffer2=function(){function e(e,t){this.width=Math.ceil(e||100),this.height=Math.ceil(t||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Runner2("disposeFramebuffer"),this.multisample=MSAA_QUALITY2.NONE}return Object.defineProperty(e.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),e.prototype.addColorTexture=function(e,t){return void 0===e&&(e=0),this.colorTextures[e]=t||new BaseTexture2(null,{scaleMode:SCALE_MODES2.NEAREST,resolution:1,mipmap:MIPMAP_MODES2.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},e.prototype.addDepthTexture=function(e){return this.depthTexture=e||new BaseTexture2(new DepthResource2(null,{width:this.width,height:this.height}),{scaleMode:SCALE_MODES2.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:MIPMAP_MODES2.OFF,format:FORMATS2.DEPTH_COMPONENT,type:TYPES2.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},e.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},e.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},e.prototype.resize=function(e,t){if(e=Math.ceil(e),t=Math.ceil(t),e!==this.width||t!==this.height){this.width=e,this.height=t,this.dirtyId++,this.dirtySize++;for(var r=0;r<this.colorTextures.length;r++){var n=this.colorTextures[r],i=n.resolution;n.setSize(e/i,t/i)}this.depthTexture&&(i=this.depthTexture.resolution,this.depthTexture.setSize(e/i,t/i))}},e.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},e.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},e}(),BaseRenderTexture2=function(e){function t(t){var r=this;if("number"==typeof t){var n=arguments[0],i=arguments[1],s=arguments[2],o=arguments[3];t={width:n,height:i,scaleMode:s,resolution:o}}r=e.call(this,null,t)||this;var a=t||{},l=a.width,h=a.height;return r.mipmap=MIPMAP_MODES2.OFF,r.width=Math.ceil(l)||100,r.height=Math.ceil(h)||100,r.valid=!0,r.clearColor=[0,0,0,0],r.framebuffer=new Framebuffer2(r.width*r.resolution,r.height*r.resolution).addColorTexture(0,r),r.maskStack=[],r.filterStack=[{}],r}return __extends23(t,e),t.prototype.resize=function(e,t){e=Math.ceil(e),t=Math.ceil(t),this.framebuffer.resize(e*this.resolution,t*this.resolution)},t.prototype.dispose=function(){this.framebuffer.dispose(),e.prototype.dispose.call(this)},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},t}(BaseTexture2),TextureUvs2=function(){function e(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return e.prototype.set=function(e,t,r){var n=t.width,i=t.height;if(r){var s=e.width/2/n,o=e.height/2/i,a=e.x/n+s,l=e.y/i+o;r=groupD82.add(r,groupD82.NW),this.x0=a+s*groupD82.uX(r),this.y0=l+o*groupD82.uY(r),r=groupD82.add(r,2),this.x1=a+s*groupD82.uX(r),this.y1=l+o*groupD82.uY(r),r=groupD82.add(r,2),this.x2=a+s*groupD82.uX(r),this.y2=l+o*groupD82.uY(r),r=groupD82.add(r,2),this.x3=a+s*groupD82.uX(r),this.y3=l+o*groupD82.uY(r)}else this.x0=e.x/n,this.y0=e.y/i,this.x1=(e.x+e.width)/n,this.y1=e.y/i,this.x2=(e.x+e.width)/n,this.y2=(e.y+e.height)/i,this.x3=e.x/n,this.y3=(e.y+e.height)/i;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},e.prototype.toString=function(){return"[@pixi/core:TextureUvs x0="+this.x0+" y0="+this.y0+" x1="+this.x1+" y1="+this.y1+" x2="+this.x2+" y2="+this.y2+" x3="+this.x3+" y3="+this.y3+"]"},e}(),DEFAULT_UVS2=new TextureUvs2,Texture2=function(e){function t(r,n,i,s,o,a){var l=e.call(this)||this;if(l.noFrame=!1,n||(l.noFrame=!0,n=new Rectangle2(0,0,1,1)),r instanceof t&&(r=r.baseTexture),l.baseTexture=r,l._frame=n,l.trim=s,l.valid=!1,l._uvs=DEFAULT_UVS2,l.uvMatrix=null,l.orig=i||n,l._rotate=Number(o||0),!0===o)l._rotate=2;else if(l._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return l.defaultAnchor=a?new Point2(a.x,a.y):new Point2(0,0),l._updateID=0,l.textureCacheIds=[],r.valid?l.noFrame?r.valid&&l.onBaseTextureUpdated(r):l.frame=n:r.once("loaded",l.onBaseTextureUpdated,l),l.noFrame&&r.on("update",l.onBaseTextureUpdated,l),l}return __extends23(t,e),t.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},t.prototype.onBaseTextureUpdated=function(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},t.prototype.destroy=function(e){if(this.baseTexture){if(e){var r=this.baseTexture.resource;r&&r.url&&TextureCache2[r.url]&&t.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,t.removeFromCache(this),this.textureCacheIds=null},t.prototype.clone=function(){var e=this._frame.clone(),r=this._frame===this.orig?e:this.orig.clone(),n=new t(this.baseTexture,!this.noFrame&&e,r,this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(n._frame=e),n},t.prototype.updateUvs=function(){this._uvs===DEFAULT_UVS2&&(this._uvs=new TextureUvs2),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},t.from=function(e,r,n){void 0===r&&(r={}),void 0===n&&(n=settings.STRICT_TEXTURE_CACHE);var i="string"==typeof e,s=null;if(i)s=e;else{if(!e._pixiId){var o=r&&r.pixiIdPrefix||"pixiid";e._pixiId=o+"_"+uid2()}s=e._pixiId}var a=TextureCache2[s];if(i&&n&&!a)throw new Error('The cacheId "'+s+'" does not exist in TextureCache.');return a||(r.resolution||(r.resolution=getResolutionOfUrl2(e)),(a=new t(new BaseTexture2(e,r))).baseTexture.cacheId=s,BaseTexture2.addToCache(a.baseTexture,s),t.addToCache(a,s)),a},t.fromURL=function(e,r){var n=Object.assign({autoLoad:!1},null==r?void 0:r.resourceOptions),i=t.from(e,Object.assign({resourceOptions:n},r),!1),s=i.baseTexture.resource;return i.baseTexture.valid?Promise.resolve(i):s.load().then((function(){return Promise.resolve(i)}))},t.fromBuffer=function(e,r,n,i){return new t(BaseTexture2.fromBuffer(e,r,n,i))},t.fromLoader=function(e,r,n,i){var s=new BaseTexture2(e,Object.assign({scaleMode:settings.SCALE_MODE,resolution:getResolutionOfUrl2(r)},i)),o=s.resource;o instanceof ImageResource2&&(o.url=r);var a=new t(s);return n||(n=r),BaseTexture2.addToCache(a.baseTexture,n),t.addToCache(a,n),n!==r&&(BaseTexture2.addToCache(a.baseTexture,r),t.addToCache(a,r)),a.baseTexture.valid?Promise.resolve(a):new Promise((function(e){a.baseTexture.once("loaded",(function(){return e(a)}))}))},t.addToCache=function(e,t){t&&(-1===e.textureCacheIds.indexOf(t)&&e.textureCacheIds.push(t),TextureCache2[t]&&console.warn("Texture added to the cache with an id ["+t+"] that already had an entry"),TextureCache2[t]=e)},t.removeFromCache=function(e){if("string"==typeof e){var t=TextureCache2[e];if(t){var r=t.textureCacheIds.indexOf(e);return r>-1&&t.textureCacheIds.splice(r,1),delete TextureCache2[e],t}}else if(e&&e.textureCacheIds){for(var n=0;n<e.textureCacheIds.length;++n)TextureCache2[e.textureCacheIds[n]]===e&&delete TextureCache2[e.textureCacheIds[n]];return e.textureCacheIds.length=0,e}return null},Object.defineProperty(t.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"frame",{get:function(){return this._frame},set:function(e){this._frame=e,this.noFrame=!1;var t=e.x,r=e.y,n=e.width,i=e.height,s=t+n>this.baseTexture.width,o=r+i>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",l="X: "+t+" + "+n+" = "+(t+n)+" > "+this.baseTexture.width,h="Y: "+r+" + "+i+" = "+(r+i)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+l+" "+a+" "+h)}this.valid=n&&i&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=e),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rotate",{get:function(){return this._rotate},set:function(e){this._rotate=e,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),t.prototype.castToBaseTexture=function(){return this.baseTexture},t}(eventemitter3);function createWhiteTexture2(){var e=document.createElement("canvas");e.width=16,e.height=16;var t=e.getContext("2d");return t.fillStyle="white",t.fillRect(0,0,16,16),new Texture2(new BaseTexture2(new CanvasResource2(e)))}function removeAllHandlers2(e){e.destroy=function(){},e.on=function(){},e.once=function(){},e.emit=function(){}}Texture2.EMPTY=new Texture2(new BaseTexture2),removeAllHandlers2(Texture2.EMPTY),removeAllHandlers2(Texture2.EMPTY.baseTexture),Texture2.WHITE=createWhiteTexture2(),removeAllHandlers2(Texture2.WHITE),removeAllHandlers2(Texture2.WHITE.baseTexture);var RenderTexture2=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.valid=!0,n.filterFrame=null,n.filterPoolKey=null,n.updateUvs(),n}return __extends23(t,e),Object.defineProperty(t.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),t.prototype.resize=function(e,t,r){void 0===r&&(r=!0),e=Math.ceil(e),t=Math.ceil(t),this.valid=e>0&&t>0,this._frame.width=this.orig.width=e,this._frame.height=this.orig.height=t,r&&this.baseTexture.resize(e,t),this.updateUvs()},t.prototype.setResolution=function(e){var t=this.baseTexture;t.resolution!==e&&(t.setResolution(e),this.resize(t.width,t.height,!1))},t.create=function(e){for(var r=arguments,n=[],i=1;i<arguments.length;i++)n[i-1]=r[i];return"number"==typeof e&&(deprecation2("6.0.0","Arguments (width, height, scaleMode, resolution) have been deprecated."),e={width:e,height:n[0],scaleMode:n[1],resolution:n[2]}),new t(new BaseRenderTexture2(e))},t}(Texture2),RenderTexturePool2=function(){function e(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return e.prototype.createTexture=function(e,t){var r=new BaseRenderTexture2(Object.assign({width:e,height:t,resolution:1},this.textureOptions));return new RenderTexture2(r)},e.prototype.getOptimalTexture=function(t,r,n){void 0===n&&(n=1);var i=e.SCREEN_KEY;t*=n,r*=n,(!this.enableFullScreen||t!==this._pixelsWidth||r!==this._pixelsHeight)&&(i=(65535&(t=nextPow22(t)))<<16|65535&(r=nextPow22(r))),this.texturePool[i]||(this.texturePool[i]=[]);var s=this.texturePool[i].pop();return s||(s=this.createTexture(t,r)),s.filterPoolKey=i,s.setResolution(n),s},e.prototype.getFilterTexture=function(e,t){var r=this.getOptimalTexture(e.width,e.height,t||e.resolution);return r.filterFrame=e.filterFrame,r},e.prototype.returnTexture=function(e){var t=e.filterPoolKey;e.filterFrame=null,this.texturePool[t].push(e)},e.prototype.returnFilterTexture=function(e){this.returnTexture(e)},e.prototype.clear=function(e){if(e=!1!==e)for(var t in this.texturePool){var r=this.texturePool[t];if(r)for(var n=0;n<r.length;n++)r[n].destroy(!0)}this.texturePool={}},e.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var r=e.SCREEN_KEY,n=this.texturePool[r];if(this.enableFullScreen=t.width>0&&t.height>0,n)for(var i=0;i<n.length;i++)n[i].destroy(!0);this.texturePool[r]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},e.SCREEN_KEY="screen",e}(),Attribute2=function(){function e(e,t,r,n,i,s,o){void 0===t&&(t=0),void 0===r&&(r=!1),void 0===n&&(n=TYPES2.FLOAT),this.buffer=e,this.size=t,this.normalized=r,this.type=n,this.stride=i,this.start=s,this.instance=o}return e.prototype.destroy=function(){this.buffer=null},e.from=function(t,r,n,i,s){return new e(t,r,n,i,s)},e}(),UID2=0,Buffer3=function(){function e(e,t,r){void 0===t&&(t=!0),void 0===r&&(r=!1),this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=t,this.id=UID2++,this.disposeRunner=new Runner2("disposeBuffer")}return e.prototype.update=function(e){this.data=e||this.data,this._updateID++},e.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},e.prototype.destroy=function(){this.dispose(),this.data=null},e.from=function(t){return t instanceof Array&&(t=new Float32Array(t)),new e(t)},e}();function getBufferType2(e){if(4===e.BYTES_PER_ELEMENT)return e instanceof Float32Array?"Float32Array":e instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===e.BYTES_PER_ELEMENT){if(e instanceof Uint16Array)return"Uint16Array"}else if(1===e.BYTES_PER_ELEMENT&&e instanceof Uint8Array)return"Uint8Array";return null}var map2={Float32Array,Uint32Array,Int32Array,Uint8Array};function interleaveTypedArrays2(e,t){for(var r=0,n=0,i={},s=0;s<e.length;s++)n+=t[s],r+=e[s].length;var o=new ArrayBuffer(4*r),a=null,l=0;for(s=0;s<e.length;s++){var h=t[s],u=e[s],c=getBufferType2(u);i[c]||(i[c]=new map2[c](o)),a=i[c];for(var d=0;d<u.length;d++)a[(d/h|0)*n+l+d%h]=u[d];l+=h}return new Float32Array(o)}var byteSizeMap2={5126:4,5123:2,5121:1},UID$12=0,map$12={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array},Geometry2=function(){function e(e,t){void 0===e&&(e=[]),void 0===t&&(t={}),this.buffers=e,this.indexBuffer=null,this.attributes=t,this.glVertexArrayObjects={},this.id=UID$12++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Runner2("disposeGeometry"),this.refCount=0}return e.prototype.addAttribute=function(e,t,r,n,i,s,o,a){if(void 0===r&&(r=0),void 0===n&&(n=!1),void 0===a&&(a=!1),!t)throw new Error("You must pass a buffer when creating an attribute");t instanceof Buffer3||(t instanceof Array&&(t=new Float32Array(t)),t=new Buffer3(t));var l=e.split("|");if(l.length>1){for(var h=0;h<l.length;h++)this.addAttribute(l[h],t,r,n,i);return this}var u=this.buffers.indexOf(t);return-1===u&&(this.buffers.push(t),u=this.buffers.length-1),this.attributes[e]=new Attribute2(u,r,n,i,s,o,a),this.instanced=this.instanced||a,this},e.prototype.getAttribute=function(e){return this.attributes[e]},e.prototype.getBuffer=function(e){return this.buffers[this.getAttribute(e).buffer]},e.prototype.addIndex=function(e){return e instanceof Buffer3||(e instanceof Array&&(e=new Uint16Array(e)),e=new Buffer3(e)),e.index=!0,this.indexBuffer=e,-1===this.buffers.indexOf(e)&&this.buffers.push(e),this},e.prototype.getIndex=function(){return this.indexBuffer},e.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var e,t=[],r=[],n=new Buffer3;for(e in this.attributes){var i=this.attributes[e],s=this.buffers[i.buffer];t.push(s.data),r.push(i.size*byteSizeMap2[i.type]/4),i.buffer=0}for(n.data=interleaveTypedArrays2(t,r),e=0;e<this.buffers.length;e++)this.buffers[e]!==this.indexBuffer&&this.buffers[e].destroy();return this.buffers=[n],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},e.prototype.getSize=function(){for(var e in this.attributes){var t=this.attributes[e];return this.buffers[t.buffer].data.length/(t.stride/4||t.size)}return 0},e.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},e.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},e.prototype.clone=function(){for(var t=new e,r=0;r<this.buffers.length;r++)t.buffers[r]=new Buffer3(this.buffers[r].data.slice(0));for(var r in this.attributes){var n=this.attributes[r];t.attributes[r]=new Attribute2(n.buffer,n.size,n.normalized,n.type,n.stride,n.start,n.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.index=!0),t},e.merge=function(t){for(var r,n=new e,i=[],s=[],o=[],a=0;a<t.length;a++){r=t[a];for(var l=0;l<r.buffers.length;l++)s[l]=s[l]||0,s[l]+=r.buffers[l].data.length,o[l]=0}for(a=0;a<r.buffers.length;a++)i[a]=new(map$12[getBufferType2(r.buffers[a].data)])(s[a]),n.buffers[a]=new Buffer3(i[a]);for(a=0;a<t.length;a++)for(r=t[a],l=0;l<r.buffers.length;l++)i[l].set(r.buffers[l].data,o[l]),o[l]+=r.buffers[l].data.length;if(n.attributes=r.attributes,r.indexBuffer){n.indexBuffer=n.buffers[r.buffers.indexOf(r.indexBuffer)],n.indexBuffer.index=!0;var h=0,u=0,c=0,d=0;for(a=0;a<r.buffers.length;a++)if(r.buffers[a]!==r.indexBuffer){d=a;break}for(var a in r.attributes){var f=r.attributes[a];(0|f.buffer)===d&&(u+=f.size*byteSizeMap2[f.type]/4)}for(a=0;a<t.length;a++){var p=t[a].indexBuffer.data;for(l=0;l<p.length;l++)n.indexBuffer.data[l+c]+=h;h+=r.buffers[d].data.length/u,c+=p.length}}return n},e}(),Quad2=function(e){function t(){var t=e.call(this)||this;return t.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),t}return __extends23(t,e),t}(Geometry2),QuadUv2=function(e){function t(){var t=e.call(this)||this;return t.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),t.uvs=new Float32Array([0,0,1,0,1,1,0,1]),t.vertexBuffer=new Buffer3(t.vertices),t.uvBuffer=new Buffer3(t.uvs),t.addAttribute("aVertexPosition",t.vertexBuffer).addAttribute("aTextureCoord",t.uvBuffer).addIndex([0,1,2,0,2,3]),t}return __extends23(t,e),t.prototype.map=function(e,t){var r=0,n=0;return this.uvs[0]=r,this.uvs[1]=n,this.uvs[2]=r+t.width/e.width,this.uvs[3]=n,this.uvs[4]=r+t.width/e.width,this.uvs[5]=n+t.height/e.height,this.uvs[6]=r,this.uvs[7]=n+t.height/e.height,r=t.x,n=t.y,this.vertices[0]=r,this.vertices[1]=n,this.vertices[2]=r+t.width,this.vertices[3]=n,this.vertices[4]=r+t.width,this.vertices[5]=n+t.height,this.vertices[6]=r,this.vertices[7]=n+t.height,this.invalidate(),this},t.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},t}(Geometry2),UID$22=0,UniformGroup2=function(){function e(e,t){this.uniforms=e,this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=UID$22++,this.static=!!t}return e.prototype.update=function(){this.dirtyId++},e.prototype.add=function(t,r,n){this.uniforms[t]=new e(r,n)},e.from=function(t,r){return new e(t,r)},e}(),FilterState2=function(){function e(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.sourceFrame=new Rectangle2,this.destinationFrame=new Rectangle2,this.bindingSourceFrame=new Rectangle2,this.bindingDestinationFrame=new Rectangle2,this.filters=[],this.transform=null}return e.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},e}(),tempPoints2=[new Point2,new Point2,new Point2,new Point2],tempMatrix3=new Matrix2,FilterSystem2=function(e){function t(t){var r=e.call(this,t)||this;return r.defaultFilterStack=[{}],r.texturePool=new RenderTexturePool2,r.texturePool.setScreenSize(t.view),r.statePool=[],r.quad=new Quad2,r.quadUv=new QuadUv2,r.tempRect=new Rectangle2,r.activeState={},r.globalUniforms=new UniformGroup2({outputFrame:new Rectangle2,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),r.forceClear=!1,r.useMaxPadding=!1,r}return __extends23(t,e),t.prototype.push=function(e,t){for(var r=this.renderer,n=this.defaultFilterStack,i=this.statePool.pop()||new FilterState2,s=this.renderer.renderTexture,o=t[0].resolution,a=t[0].padding,l=t[0].autoFit,h=t[0].legacy,u=1;u<t.length;u++){var c=t[u];o=Math.min(o,c.resolution),a=this.useMaxPadding?Math.max(a,c.padding):a+c.padding,l=l&&c.autoFit,h=h||c.legacy}if(1===n.length&&(this.defaultFilterStack[0].renderTexture=s.current),n.push(i),i.resolution=o,i.legacy=h,i.target=e,i.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),i.sourceFrame.pad(a),l){var d=this.tempRect.copyFrom(s.sourceFrame);r.projection.transform&&this.transformAABB(tempMatrix3.copyFrom(r.projection.transform).invert(),d),i.sourceFrame.fit(d)}this.roundFrame(i.sourceFrame,s.current?s.current.resolution:r.resolution,s.sourceFrame,s.destinationFrame,r.projection.transform),i.renderTexture=this.getOptimalFilterTexture(i.sourceFrame.width,i.sourceFrame.height,o),i.filters=t,i.destinationFrame.width=i.renderTexture.width,i.destinationFrame.height=i.renderTexture.height;var f=this.tempRect;f.x=0,f.y=0,f.width=i.sourceFrame.width,f.height=i.sourceFrame.height,i.renderTexture.filterFrame=i.sourceFrame,i.bindingSourceFrame.copyFrom(s.sourceFrame),i.bindingDestinationFrame.copyFrom(s.destinationFrame),i.transform=r.projection.transform,r.projection.transform=null,s.bind(i.renderTexture,i.sourceFrame,f),r.framebuffer.clear(0,0,0,0)},t.prototype.pop=function(){var e=this.defaultFilterStack,t=e.pop(),r=t.filters;this.activeState=t;var n=this.globalUniforms.uniforms;n.outputFrame=t.sourceFrame,n.resolution=t.resolution;var i=n.inputSize,s=n.inputPixel,o=n.inputClamp;if(i[0]=t.destinationFrame.width,i[1]=t.destinationFrame.height,i[2]=1/i[0],i[3]=1/i[1],s[0]=i[0]*t.resolution,s[1]=i[1]*t.resolution,s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=t.sourceFrame.width*i[2]-.5*s[2],o[3]=t.sourceFrame.height*i[3]-.5*s[3],t.legacy){var a=n.filterArea;a[0]=t.destinationFrame.width,a[1]=t.destinationFrame.height,a[2]=t.sourceFrame.x,a[3]=t.sourceFrame.y,n.filterClamp=n.inputClamp}this.globalUniforms.update();var l=e[e.length-1];if(t.renderTexture.framebuffer.multisample>1&&this.renderer.framebuffer.blit(),1===r.length)r[0].apply(this,t.renderTexture,l.renderTexture,CLEAR_MODES2.BLEND,t),this.returnFilterTexture(t.renderTexture);else{var h=t.renderTexture,u=this.getOptimalFilterTexture(h.width,h.height,t.resolution);u.filterFrame=h.filterFrame;var c=0;for(c=0;c<r.length-1;++c){r[c].apply(this,h,u,CLEAR_MODES2.CLEAR,t);var d=h;h=u,u=d}r[c].apply(this,h,l.renderTexture,CLEAR_MODES2.BLEND,t),this.returnFilterTexture(h),this.returnFilterTexture(u)}t.clear(),this.statePool.push(t)},t.prototype.bindAndClear=function(e,t){void 0===t&&(t=CLEAR_MODES2.CLEAR);var r=this.renderer,n=r.renderTexture,i=r.state;if(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,e&&e.filterFrame){var s=this.tempRect;s.x=0,s.y=0,s.width=e.filterFrame.width,s.height=e.filterFrame.height,n.bind(e,e.filterFrame,s)}else e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?n.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);var o=1&i.stateId||this.forceClear;(t===CLEAR_MODES2.CLEAR||t===CLEAR_MODES2.BLIT&&o)&&this.renderer.framebuffer.clear(0,0,0,0)},t.prototype.applyFilter=function(e,t,r,n){var i=this.renderer;i.state.set(e.state),this.bindAndClear(r,n),e.uniforms.uSampler=t,e.uniforms.filterGlobals=this.globalUniforms,i.shader.bind(e),e.legacy?(this.quadUv.map(t._frame,t.filterFrame),i.geometry.bind(this.quadUv),i.geometry.draw(DRAW_MODES2.TRIANGLES)):(i.geometry.bind(this.quad),i.geometry.draw(DRAW_MODES2.TRIANGLE_STRIP))},t.prototype.calculateSpriteMatrix=function(e,t){var r=this.activeState,n=r.sourceFrame,i=r.destinationFrame,s=t._texture.orig,o=e.set(i.width,0,0,i.height,n.x,n.y),a=t.worldTransform.copyTo(Matrix2.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(t.anchor.x,t.anchor.y),o},t.prototype.destroy=function(){this.texturePool.clear(!1)},t.prototype.getOptimalFilterTexture=function(e,t,r){return void 0===r&&(r=1),this.texturePool.getOptimalTexture(e,t,r)},t.prototype.getFilterTexture=function(e,t){if("number"==typeof e){var r=e;e=t,t=r}e=e||this.activeState.renderTexture;var n=this.texturePool.getOptimalTexture(e.width,e.height,t||e.resolution);return n.filterFrame=e.filterFrame,n},t.prototype.returnFilterTexture=function(e){this.texturePool.returnTexture(e)},t.prototype.emptyPool=function(){this.texturePool.clear(!0)},t.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},t.prototype.transformAABB=function(e,t){var r=tempPoints2[0],n=tempPoints2[1],i=tempPoints2[2],s=tempPoints2[3];r.set(t.left,t.top),n.set(t.left,t.bottom),i.set(t.right,t.top),s.set(t.right,t.bottom),e.apply(r,r),e.apply(n,n),e.apply(i,i),e.apply(s,s);var o=Math.min(r.x,n.x,i.x,s.x),a=Math.min(r.y,n.y,i.y,s.y),l=Math.max(r.x,n.x,i.x,s.x),h=Math.max(r.y,n.y,i.y,s.y);t.x=o,t.y=a,t.width=l-o,t.height=h-a},t.prototype.roundFrame=function(e,t,r,n,i){if(i){var s=i.a,o=i.b,a=i.c,l=i.d;if(!(0===o&&0===a||0===s&&0===l))return}(i=i?tempMatrix3.copyFrom(i):tempMatrix3.identity()).translate(-r.x,-r.y).scale(n.width/r.width,n.height/r.height).translate(n.x,n.y),this.transformAABB(i,e),e.ceil(t),this.transformAABB(i.invert(),e)},t}(System2),ObjectRenderer2=function(){function e(e){this.renderer=e}return e.prototype.flush=function(){},e.prototype.destroy=function(){this.renderer=null},e.prototype.start=function(){},e.prototype.stop=function(){this.flush()},e.prototype.render=function(e){},e}(),BatchSystem2=function(e){function t(t){var r=e.call(this,t)||this;return r.emptyRenderer=new ObjectRenderer2(t),r.currentRenderer=r.emptyRenderer,r}return __extends23(t,e),t.prototype.setObjectRenderer=function(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.copyBoundTextures=function(e,t){for(var r=this.renderer.texture.boundTextures,n=t-1;n>=0;--n)e[n]=r[n]||null,e[n]&&(e[n]._batchLocation=n)},t.prototype.boundArray=function(e,t,r,n){for(var i=e.elements,s=e.ids,o=e.count,a=0,l=0;l<o;l++){var h=i[l],u=h._batchLocation;if(u>=0&&u<n&&t[u]===h)s[l]=u;else for(;a<n;){var c=t[a];if(!c||c._batchEnabled!==r||c._batchLocation!==a){s[l]=a,h._batchLocation=a,t[a]=h;break}a++}}},t}(System2),CONTEXT_UID_COUNTER2=0,ContextSystem2=function(e){function t(t){var r=e.call(this,t)||this;return r.webGLVersion=1,r.extensions={},r.supports={uint32Indices:!1},r.handleContextLost=r.handleContextLost.bind(r),r.handleContextRestored=r.handleContextRestored.bind(r),t.view.addEventListener("webglcontextlost",r.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",r.handleContextRestored,!1),r}return __extends23(t,e),Object.defineProperty(t.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),t.prototype.contextChange=function(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=CONTEXT_UID_COUNTER2++,e.isContextLost()&&e.getExtension("WEBGL_lose_context")&&e.getExtension("WEBGL_lose_context").restoreContext()},t.prototype.initFromContext=function(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=CONTEXT_UID_COUNTER2++,this.renderer.runners.contextChange.emit(e)},t.prototype.initFromOptions=function(e){var t=this.createContext(this.renderer.view,e);this.initFromContext(t)},t.prototype.createContext=function(e,t){var r;if(settings.PREFER_ENV>=ENV2.WEBGL2&&(r=e.getContext("webgl2",t)),r)this.webGLVersion=2;else if(this.webGLVersion=1,!(r=e.getContext("webgl",t)||e.getContext("experimental-webgl",t)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=r,this.getExtensions(),this.gl},t.prototype.getExtensions=function(){var e=this.gl,t={anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc")};1===this.webGLVersion?Object.assign(this.extensions,t,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),loseContext:e.getExtension("WEBGL_lose_context"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,t,{colorBufferFloat:e.getExtension("EXT_color_buffer_float")})},t.prototype.handleContextLost=function(e){e.preventDefault()},t.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},t.prototype.destroy=function(){var e=this.renderer.view;e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},t.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},t.prototype.validateContext=function(e){var t=e.getContextAttributes(),r="WebGL2RenderingContext"in self&&e instanceof self.WebGL2RenderingContext;r&&(this.webGLVersion=2),t.stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var n=r||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=n,n||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},t}(System2),GLFramebuffer2=function(e){this.framebuffer=e,this.stencil=null,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.multisample=MSAA_QUALITY2.NONE,this.msaaBuffer=null,this.blitFramebuffer=null},tempRectangle2=new Rectangle2,FramebufferSystem2=function(e){function t(t){var r=e.call(this,t)||this;return r.managedFramebuffers=[],r.unknownFramebuffer=new Framebuffer2(10,10),r.msaaSamples=null,r}return __extends23(t,e),t.prototype.contextChange=function(){var e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Rectangle2,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var t=this.renderer.context.extensions.drawBuffers,r=this.renderer.context.extensions.depthTexture;settings.PREFER_ENV===ENV2.WEBGL_LEGACY&&(t=null,r=null),t?e.drawBuffers=function(e){return t.drawBuffersWEBGL(e)}:(this.hasMRT=!1,e.drawBuffers=function(){}),r||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)},t.prototype.bind=function(e,t){var r=this.gl;if(e){var n=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,r.bindFramebuffer(r.FRAMEBUFFER,n.framebuffer)),n.dirtyId!==e.dirtyId&&(n.dirtyId=e.dirtyId,n.dirtyFormat!==e.dirtyFormat?(n.dirtyFormat=e.dirtyFormat,this.updateFramebuffer(e)):n.dirtySize!==e.dirtySize&&(n.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(var i=0;i<e.colorTextures.length;i++){var s=e.colorTextures[i];this.renderer.texture.unbind(s.parentTextureArray||s)}e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),t?this.setViewport(t.x,t.y,t.width,t.height):this.setViewport(0,0,e.width,e.height)}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),t?this.setViewport(t.x,t.y,t.width,t.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},t.prototype.setViewport=function(e,t,r,n){var i=this.viewport;(i.width!==r||i.height!==n||i.x!==e||i.y!==t)&&(i.x=e,i.y=t,i.width=r,i.height=n,this.gl.viewport(e,t,r,n))},Object.defineProperty(t.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),t.prototype.clear=function(e,t,r,n,i){void 0===i&&(i=BUFFER_BITS2.COLOR|BUFFER_BITS2.DEPTH);var s=this.gl;s.clearColor(e,t,r,n),s.clear(i)},t.prototype.initFramebuffer=function(e){var t=this.gl,r=new GLFramebuffer2(t.createFramebuffer());return r.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=r,this.managedFramebuffers.push(e),e.disposeRunner.add(this),r},t.prototype.resizeFramebuffer=function(e){var t=this.gl,r=e.glFramebuffers[this.CONTEXT_UID];r.stencil&&(t.bindRenderbuffer(t.RENDERBUFFER,r.stencil),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,e.width,e.height));for(var n=e.colorTextures,i=0;i<n.length;i++)this.renderer.texture.bind(n[i],0);e.depthTexture&&this.renderer.texture.bind(e.depthTexture,0)},t.prototype.updateFramebuffer=function(e){var t=this.gl,r=e.glFramebuffers[this.CONTEXT_UID],n=e.colorTextures.length;t.drawBuffers||(n=Math.min(n,1)),r.multisample>1&&(r.msaaBuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,r.msaaBuffer),t.renderbufferStorageMultisample(t.RENDERBUFFER,r.multisample,t.RGBA8,e.width,e.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,r.msaaBuffer));for(var i=[],s=0;s<n;s++)if(!(0===s&&r.multisample>1)){var o=e.colorTextures[s],a=o.parentTextureArray||o;this.renderer.texture.bind(a,0),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+s,o.target,a._glTextures[this.CONTEXT_UID].texture,0),i.push(t.COLOR_ATTACHMENT0+s)}if(i.length>1&&t.drawBuffers(i),e.depthTexture&&this.writeDepthTexture){var l=e.depthTexture;this.renderer.texture.bind(l,0),t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,l._glTextures[this.CONTEXT_UID].texture,0)}!r.stencil&&(e.stencil||e.depth)&&(r.stencil=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,r.stencil),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,e.width,e.height),e.depthTexture||t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,r.stencil))},t.prototype.detectSamples=function(e){var t=this.msaaSamples,r=MSAA_QUALITY2.NONE;if(e<=1||null===t)return r;for(var n=0;n<t.length;n++)if(t[n]<=e){r=t[n];break}return 1===r&&(r=MSAA_QUALITY2.NONE),r},t.prototype.blit=function(e,t,r){var n=this,i=n.current,s=n.renderer,o=n.gl,a=n.CONTEXT_UID;if(2===s.context.webGLVersion&&i){var l=i.glFramebuffers[a];if(l){if(!e){if(l.multisample<=1)return;l.blitFramebuffer||(l.blitFramebuffer=new Framebuffer2(i.width,i.height),l.blitFramebuffer.addColorTexture(0,i.colorTextures[0])),(e=l.blitFramebuffer).width=i.width,e.height=i.height}t||((t=tempRectangle2).width=i.width,t.height=i.height),r||(r=t);var h=t.width===r.width&&t.height===r.height;this.bind(e),o.bindFramebuffer(o.READ_FRAMEBUFFER,l.framebuffer),o.blitFramebuffer(t.x,t.y,t.width,t.height,r.x,r.y,r.width,r.height,o.COLOR_BUFFER_BIT,h?o.NEAREST:o.LINEAR)}}},t.prototype.disposeFramebuffer=function(e,t){var r=e.glFramebuffers[this.CONTEXT_UID],n=this.gl;if(r){delete e.glFramebuffers[this.CONTEXT_UID];var i=this.managedFramebuffers.indexOf(e);i>=0&&this.managedFramebuffers.splice(i,1),e.disposeRunner.remove(this),t||(n.deleteFramebuffer(r.framebuffer),r.stencil&&n.deleteRenderbuffer(r.stencil))}},t.prototype.disposeAll=function(e){var t=this.managedFramebuffers;this.managedFramebuffers=[];for(var r=0;r<t.length;r++)this.disposeFramebuffer(t[r],e)},t.prototype.forceStencil=function(){var e=this.current;if(e){var t=e.glFramebuffers[this.CONTEXT_UID];if(t&&!t.stencil){e.enableStencil();var r=e.width,n=e.height,i=this.gl,s=i.createRenderbuffer();i.bindRenderbuffer(i.RENDERBUFFER,s),i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,r,n),t.stencil=s,i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,s)}}},t.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new Rectangle2},t}(System2),GLBuffer2=function(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0},byteSizeMap$12={5126:4,5123:2,5121:1},GeometrySystem2=function(e){function t(t){var r=e.call(this,t)||this;return r._activeGeometry=null,r._activeVao=null,r.hasVao=!0,r.hasInstance=!0,r.canUseUInt32ElementIndex=!1,r.managedGeometries={},r.managedBuffers={},r}return __extends23(t,e),t.prototype.contextChange=function(){this.disposeAll(!0);var e=this.gl=this.renderer.gl,t=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==t.webGLVersion){var r=this.renderer.context.extensions.vertexArrayObject;settings.PREFER_ENV===ENV2.WEBGL_LEGACY&&(r=null),r?(e.createVertexArray=function(){return r.createVertexArrayOES()},e.bindVertexArray=function(e){return r.bindVertexArrayOES(e)},e.deleteVertexArray=function(e){return r.deleteVertexArrayOES(e)}):(this.hasVao=!1,e.createVertexArray=function(){return null},e.bindVertexArray=function(){return null},e.deleteVertexArray=function(){return null})}if(2!==t.webGLVersion){var n=e.getExtension("ANGLE_instanced_arrays");n?(e.vertexAttribDivisor=function(e,t){return n.vertexAttribDivisorANGLE(e,t)},e.drawElementsInstanced=function(e,t,r,i,s){return n.drawElementsInstancedANGLE(e,t,r,i,s)},e.drawArraysInstanced=function(e,t,r,i){return n.drawArraysInstancedANGLE(e,t,r,i)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===t.webGLVersion||!!t.extensions.uint32ElementIndex},t.prototype.bind=function(e,t){t=t||this.renderer.shader.shader;var r=this.gl,n=e.glVertexArrayObjects[this.CONTEXT_UID],i=!1;n||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=n={},i=!0);var s=n[t.program.id]||this.initGeometryVao(e,t.program,i);this._activeGeometry=e,this._activeVao!==s&&(this._activeVao=s,this.hasVao?r.bindVertexArray(s):this.activateVao(e,t.program)),this.updateBuffers()},t.prototype.reset=function(){this.unbind()},t.prototype.updateBuffers=function(){for(var e=this._activeGeometry,t=this.gl,r=0;r<e.buffers.length;r++){var n=e.buffers[r],i=n._glBuffers[this.CONTEXT_UID];if(n._updateID!==i.updateID){i.updateID=n._updateID;var s=n.index?t.ELEMENT_ARRAY_BUFFER:t.ARRAY_BUFFER;if(t.bindBuffer(s,i.buffer),this._boundBuffer=i,i.byteLength>=n.data.byteLength)t.bufferSubData(s,0,n.data);else{var o=n.static?t.STATIC_DRAW:t.DYNAMIC_DRAW;i.byteLength=n.data.byteLength,t.bufferData(s,n.data,o)}}}},t.prototype.checkCompatibility=function(e,t){var r=e.attributes,n=t.attributeData;for(var i in n)if(!r[i])throw new Error('shader and geometry incompatible, geometry missing the "'+i+'" attribute')},t.prototype.getSignature=function(e,t){var r=e.attributes,n=t.attributeData,i=["g",e.id];for(var s in r)n[s]&&i.push(s);return i.join("-")},t.prototype.initGeometryVao=function(e,t,r){void 0===r&&(r=!0),this.checkCompatibility(e,t);var n=this.gl,i=this.CONTEXT_UID,s=this.getSignature(e,t),o=e.glVertexArrayObjects[this.CONTEXT_UID],a=o[s];if(a)return o[t.id]=a,a;var l=e.buffers,h=e.attributes,u={},c={};for(var d in l)u[d]=0,c[d]=0;for(var d in h)!h[d].size&&t.attributeData[d]?h[d].size=t.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[h[d].buffer]+=h[d].size*byteSizeMap$12[h[d].type];for(var d in h){var f=h[d],p=f.size;void 0===f.stride&&(u[f.buffer]===p*byteSizeMap$12[f.type]?f.stride=0:f.stride=u[f.buffer]),void 0===f.start&&(f.start=c[f.buffer],c[f.buffer]+=p*byteSizeMap$12[f.type])}a=n.createVertexArray(),n.bindVertexArray(a);for(var m=0;m<l.length;m++){var _=l[m];_._glBuffers[i]||(_._glBuffers[i]=new GLBuffer2(n.createBuffer()),this.managedBuffers[_.id]=_,_.disposeRunner.add(this)),r&&_._glBuffers[i].refCount++}return this.activateVao(e,t),this._activeVao=a,o[t.id]=a,o[s]=a,a},t.prototype.disposeBuffer=function(e,t){if(this.managedBuffers[e.id]){delete this.managedBuffers[e.id];var r=e._glBuffers[this.CONTEXT_UID],n=this.gl;e.disposeRunner.remove(this),r&&(t||n.deleteBuffer(r.buffer),delete e._glBuffers[this.CONTEXT_UID])}},t.prototype.disposeGeometry=function(e,t){if(this.managedGeometries[e.id]){delete this.managedGeometries[e.id];var r=e.glVertexArrayObjects[this.CONTEXT_UID],n=this.gl,i=e.buffers;if(e.disposeRunner.remove(this),r){for(var s=0;s<i.length;s++){var o=i[s]._glBuffers[this.CONTEXT_UID];o.refCount--,0===o.refCount&&!t&&this.disposeBuffer(i[s],t)}if(!t)for(var a in r)if("g"===a[0]){var l=r[a];this._activeVao===l&&this.unbind(),n.deleteVertexArray(l)}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}},t.prototype.disposeAll=function(e){for(var t=Object.keys(this.managedGeometries),r=0;r<t.length;r++)this.disposeGeometry(this.managedGeometries[t[r]],e);for(t=Object.keys(this.managedBuffers),r=0;r<t.length;r++)this.disposeBuffer(this.managedBuffers[t[r]],e)},t.prototype.activateVao=function(e,t){var r=this.gl,n=this.CONTEXT_UID,i=e.buffers,s=e.attributes;e.indexBuffer&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e.indexBuffer._glBuffers[n].buffer);var o=null;for(var a in s){var l=s[a],h=i[l.buffer]._glBuffers[n];if(t.attributeData[a]){o!==h&&(r.bindBuffer(r.ARRAY_BUFFER,h.buffer),o=h);var u=t.attributeData[a].location;if(r.enableVertexAttribArray(u),r.vertexAttribPointer(u,l.size,l.type||r.FLOAT,l.normalized,l.stride,l.start),l.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");r.vertexAttribDivisor(u,1)}}}},t.prototype.draw=function(e,t,r,n){var i=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,a=2===o?i.UNSIGNED_SHORT:i.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?i.drawElementsInstanced(e,t||s.indexBuffer.data.length,a,(r||0)*o,n||1):i.drawElements(e,t||s.indexBuffer.data.length,a,(r||0)*o):console.warn("unsupported index buffer type: uint32")}else s.instanced?i.drawArraysInstanced(e,r,t||s.getSize(),n||1):i.drawArrays(e,r,t||s.getSize());return this},t.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},t}(System2),MaskData2=function(){function e(e){void 0===e&&(e=null),this.type=MASK_TYPES2.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._target=null}return e.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=MASK_TYPES2.NONE,this.autoDetect=!0),this._target=null},e.prototype.copyCountersOrReset=function(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},e}();function compileShader2(e,t,r){var n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),n}function compileProgram2(e,t,r,n){var i=compileShader2(e,e.VERTEX_SHADER,t),s=compileShader2(e,e.FRAGMENT_SHADER,r),o=e.createProgram();if(e.attachShader(o,i),e.attachShader(o,s),n)for(var a in n)e.bindAttribLocation(o,n[a],a);return e.linkProgram(o),e.getProgramParameter(o,e.LINK_STATUS)||(e.getShaderParameter(i,e.COMPILE_STATUS)||(console.warn(t),console.error(e.getShaderInfoLog(i))),e.getShaderParameter(s,e.COMPILE_STATUS)||(console.warn(r),console.error(e.getShaderInfoLog(s))),console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",e.getProgramParameter(o,e.VALIDATE_STATUS)),console.error("gl.getError()",e.getError()),""!==e.getProgramInfoLog(o)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",e.getProgramInfoLog(o)),e.deleteProgram(o),o=null),e.deleteShader(i),e.deleteShader(s),o}function booleanArray2(e){for(var t=new Array(e),r=0;r<t.length;r++)t[r]=!1;return t}function defaultValue2(e,t){switch(e){case"float":case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return booleanArray2(2*t);case"bvec3":return booleanArray2(3*t);case"bvec4":return booleanArray2(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var unknownContext2={},context2=unknownContext2,maxFragmentPrecision2;function getTestContext2(){if(context2===unknownContext2||context2&&context2.isContextLost()){var e=document.createElement("canvas"),t=void 0;settings.PREFER_ENV>=ENV2.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),context2=t}return context2}function getMaxFragmentPrecision2(){if(!maxFragmentPrecision2){maxFragmentPrecision2=PRECISION2.MEDIUM;var e=getTestContext2();if(e&&e.getShaderPrecisionFormat){var t=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT);maxFragmentPrecision2=t.precision?PRECISION2.HIGH:PRECISION2.MEDIUM}}return maxFragmentPrecision2}function setPrecision2(e,t,r){if("precision"!==e.substring(0,9)){var n=t;return t===PRECISION2.HIGH&&r!==PRECISION2.HIGH&&(n=PRECISION2.MEDIUM),"precision "+n+" float;\n"+e}return r!==PRECISION2.HIGH&&"precision highp"===e.substring(0,15)?e.replace("precision highp","precision mediump"):e}var GLSL_TO_SIZE2={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function mapSize2(e){return GLSL_TO_SIZE2[e]}var GL_TABLE2=null,GL_TO_GLSL_TYPES2={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function mapType2(e,t){if(!GL_TABLE2){var r=Object.keys(GL_TO_GLSL_TYPES2);GL_TABLE2={};for(var n=0;n<r.length;++n){var i=r[n];GL_TABLE2[e[i]]=GL_TO_GLSL_TYPES2[i]}}return GL_TABLE2[t]}var uniformParsers2=[{test:function(e){return"float"===e.type&&1===e.size},code:function(e){return'\n            if(uv["'+e+'"] !== ud["'+e+'"].value)\n            {\n                ud["'+e+'"].value = uv["'+e+'"]\n                gl.uniform1f(ud["'+e+'"].location, uv["'+e+'"])\n            }\n            '}},{test:function(e){return("sampler2D"===e.type||"samplerCube"===e.type||"sampler2DArray"===e.type)&&1===e.size&&!e.isArray},code:function(e){return't = syncData.textureCount++;\n\n            renderer.texture.bind(uv["'+e+'"], t);\n\n            if(ud["'+e+'"].value !== t)\n            {\n                ud["'+e+'"].value = t;\n                gl.uniform1i(ud["'+e+'"].location, t);\n; // eslint-disable-line max-len\n            }'}},{test:function(e,t){return"mat3"===e.type&&1===e.size&&void 0!==t.a},code:function(e){return'\n            gl.uniformMatrix3fv(ud["'+e+'"].location, false, uv["'+e+'"].toArray(true));\n            '}},{test:function(e,t){return"vec2"===e.type&&1===e.size&&void 0!==t.x},code:function(e){return'\n                cv = ud["'+e+'"].value;\n                v = uv["'+e+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["'+e+'"].location, v.x, v.y);\n                }'}},{test:function(e){return"vec2"===e.type&&1===e.size},code:function(e){return'\n                cv = ud["'+e+'"].value;\n                v = uv["'+e+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["'+e+'"].location, v[0], v[1]);\n                }\n            '}},{test:function(e,t){return"vec4"===e.type&&1===e.size&&void 0!==t.width},code:function(e){return'\n                cv = ud["'+e+'"].value;\n                v = uv["'+e+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["'+e+'"].location, v.x, v.y, v.width, v.height)\n                }'}},{test:function(e){return"vec4"===e.type&&1===e.size},code:function(e){return'\n                cv = ud["'+e+'"].value;\n                v = uv["'+e+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["'+e+'"].location, v[0], v[1], v[2], v[3])\n                }'}}],GLSL_TO_SINGLE_SETTERS_CACHED2={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",uint:"gl.uniform1ui(location, v)",uvec2:"gl.uniform2ui(location, v[0], v[1])",uvec3:"gl.uniform3ui(location, v[0], v[1], v[2])",uvec4:"gl.uniform4ui(location, v[0], v[1], v[2], v[3])",bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},GLSL_TO_ARRAY_SETTERS2={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function generateUniformsSync2(e,t){var r=["\n        var v = null;\n        var cv = null\n        var t = 0;\n        var gl = renderer.gl\n    "];for(var n in e.uniforms){var i=t[n];if(i){for(var s=e.uniforms[n],o=!1,a=0;a<uniformParsers2.length;a++)if(uniformParsers2[a].test(i,s)){r.push(uniformParsers2[a].code(n,s)),o=!0;break}if(!o){var l=(1===i.size?GLSL_TO_SINGLE_SETTERS_CACHED2:GLSL_TO_ARRAY_SETTERS2)[i.type].replace("location",'ud["'+n+'"].location');r.push('\n            cv = ud["'+n+'"].value;\n            v = uv["'+n+'"];\n            '+l+";")}}else e.uniforms[n].group&&r.push('\n                    renderer.shader.syncUniformGroup(uv["'+n+'"], syncData);\n                ')}return new Function("ud","uv","renderer","syncData",r.join("\n"))}var fragTemplate3=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n"),unsafeEval2;function generateIfTestSrc2(e){for(var t="",r=0;r<e;++r)r>0&&(t+="\nelse "),r<e-1&&(t+="if(test == "+r+".0){}");return t}function checkMaxIfStatementsInShader2(e,t){if(0===e)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var r=t.createShader(t.FRAGMENT_SHADER);;){var n=fragTemplate3.replace(/%forloop%/gi,generateIfTestSrc2(e));if(t.shaderSource(r,n),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS))break;e=e/2|0}return e}function unsafeEvalSupported2(){if("boolean"==typeof unsafeEval2)return unsafeEval2;try{var e=new Function("param1","param2","param3","return param1[param2] === param3;");unsafeEval2=!0===e({a:"b"},"a","b")}catch(e){unsafeEval2=!1}return unsafeEval2}var defaultFragment2="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}",defaultVertex2="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n",UID$32=0,nameCache2={},Program2=function(){function e(t,r,n){void 0===n&&(n="pixi-shader"),this.id=UID$32++,this.vertexSrc=t||e.defaultVertexSrc,this.fragmentSrc=r||e.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(n=n.replace(/\s+/g,"-"),nameCache2[n]?(nameCache2[n]++,n+="-"+nameCache2[n]):nameCache2[n]=1,this.vertexSrc="#define SHADER_NAME "+n+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+n+"\n"+this.fragmentSrc,this.vertexSrc=setPrecision2(this.vertexSrc,settings.PRECISION_VERTEX,PRECISION2.HIGH),this.fragmentSrc=setPrecision2(this.fragmentSrc,settings.PRECISION_FRAGMENT,getMaxFragmentPrecision2())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},this.syncUniforms=null}return e.prototype.extractData=function(e,t){var r=getTestContext2();if(r){var n=compileProgram2(r,e,t);this.attributeData=this.getAttributeData(n,r),this.uniformData=this.getUniformData(n,r),r.deleteProgram(n)}else this.uniformData={},this.attributeData={}},e.prototype.getAttributeData=function(e,t){for(var r={},n=[],i=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),s=0;s<i;s++){var o=t.getActiveAttrib(e,s),a=mapType2(t,o.type),l={type:a,name:o.name,size:mapSize2(a),location:0};r[o.name]=l,n.push(l)}for(n.sort((function(e,t){return e.name>t.name?1:-1})),s=0;s<n.length;s++)n[s].location=s;return r},e.prototype.getUniformData=function(e,t){for(var r={},n=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),i=0;i<n;i++){var s=t.getActiveUniform(e,i),o=s.name.replace(/\[.*?\]$/,""),a=s.name.match(/\[.*?\]$/),l=mapType2(t,s.type);r[o]={type:l,size:s.size,isArray:a,value:defaultValue2(l,s.size)}}return r},Object.defineProperty(e,"defaultVertexSrc",{get:function(){return defaultVertex2},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultFragmentSrc",{get:function(){return defaultFragment2},enumerable:!1,configurable:!0}),e.from=function(t,r,n){var i=t+r,s=ProgramCache2[i];return s||(ProgramCache2[i]=s=new e(t,r,n)),s},e}(),Shader2=function(){function e(e,t){for(var r in this.program=e,this.uniformGroup=t?t instanceof UniformGroup2?t:new UniformGroup2(t):new UniformGroup2({}),e.uniformData)this.uniformGroup.uniforms[r]instanceof Array&&(this.uniformGroup.uniforms[r]=new Float32Array(this.uniformGroup.uniforms[r]))}return e.prototype.checkUniformExists=function(e,t){if(t.uniforms[e])return!0;for(var r in t.uniforms){var n=t.uniforms[r];if(n.group&&this.checkUniformExists(e,n))return!0}return!1},e.prototype.destroy=function(){this.uniformGroup=null},Object.defineProperty(e.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),e.from=function(t,r,n){return new e(Program2.from(t,r),n)},e}(),BLEND2=0,OFFSET2=1,CULLING2=2,DEPTH_TEST2=3,WINDING2=4,DEPTH_MASK2=5,State2=function(){function e(){this.data=0,this.blendMode=BLEND_MODES2.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}return Object.defineProperty(e.prototype,"blend",{get:function(){return!!(this.data&1<<BLEND2)},set:function(e){!!(this.data&1<<BLEND2)!==e&&(this.data^=1<<BLEND2)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"offsets",{get:function(){return!!(this.data&1<<OFFSET2)},set:function(e){!!(this.data&1<<OFFSET2)!==e&&(this.data^=1<<OFFSET2)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"culling",{get:function(){return!!(this.data&1<<CULLING2)},set:function(e){!!(this.data&1<<CULLING2)!==e&&(this.data^=1<<CULLING2)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"depthTest",{get:function(){return!!(this.data&1<<DEPTH_TEST2)},set:function(e){!!(this.data&1<<DEPTH_TEST2)!==e&&(this.data^=1<<DEPTH_TEST2)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"depthMask",{get:function(){return!!(this.data&1<<DEPTH_MASK2)},set:function(e){!!(this.data&1<<DEPTH_MASK2)!==e&&(this.data^=1<<DEPTH_MASK2)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clockwiseFrontFace",{get:function(){return!!(this.data&1<<WINDING2)},set:function(e){!!(this.data&1<<WINDING2)!==e&&(this.data^=1<<WINDING2)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this._blendMode},set:function(e){this.blend=e!==BLEND_MODES2.NONE,this._blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(e){this.offsets=!!e,this._polygonOffset=e},enumerable:!1,configurable:!0}),e.prototype.toString=function(){return"[@pixi/core:State blendMode="+this.blendMode+" clockwiseFrontFace="+this.clockwiseFrontFace+" culling="+this.culling+" depthMask="+this.depthMask+" polygonOffset="+this.polygonOffset+"]"},e.for2d=function(){var t=new e;return t.depthTest=!1,t.blend=!0,t},e}(),defaultVertex$12="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n",defaultFragment$12="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n",Filter2=function(e){function t(r,n,i){var s=this,o=Program2.from(r||t.defaultVertexSrc,n||t.defaultFragmentSrc);return(s=e.call(this,o,i)||this).padding=0,s.resolution=settings.FILTER_RESOLUTION,s.enabled=!0,s.autoFit=!0,s.legacy=!!s.program.attributeData.aTextureCoord,s.state=new State2,s}return __extends23(t,e),t.prototype.apply=function(e,t,r,n,i){e.applyFilter(this,t,r,n)},Object.defineProperty(t.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(e){this.state.blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultVertexSrc",{get:function(){return defaultVertex$12},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultFragmentSrc",{get:function(){return defaultFragment$12},enumerable:!1,configurable:!0}),t}(Shader2),vertex7="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n",fragment10="varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n",tempMat3=new Matrix2,TextureMatrix2=function(){function e(e,t){this._texture=e,this.mapCoord=new Matrix2,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=void 0===t?.5:t,this.isSimple=!1}return Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(e){this._texture=e,this._textureID=-1},enumerable:!1,configurable:!0}),e.prototype.multiplyUvs=function(e,t){void 0===t&&(t=e);for(var r=this.mapCoord,n=0;n<e.length;n+=2){var i=e[n],s=e[n+1];t[n]=i*r.a+s*r.c+r.tx,t[n+1]=i*r.b+s*r.d+r.ty}return t},e.prototype.update=function(e){var t=this._texture;if(!t||!t.valid||!e&&this._textureID===t._updateID)return!1;this._textureID=t._updateID,this._updateID++;var r=t._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);var n=t.orig,i=t.trim;i&&(tempMat3.set(n.width/i.width,0,0,n.height/i.height,-i.x/i.width,-i.y/i.height),this.mapCoord.append(tempMat3));var s=t.baseTexture,o=this.uClampFrame,a=this.clampMargin/s.resolution,l=this.clampOffset;return o[0]=(t._frame.x+a+l)/s.width,o[1]=(t._frame.y+a+l)/s.height,o[2]=(t._frame.x+t._frame.width-a+l)/s.width,o[3]=(t._frame.y+t._frame.height-a+l)/s.height,this.uClampOffset[0]=l/s.realWidth,this.uClampOffset[1]=l/s.realHeight,this.isSimple=t._frame.width===s.width&&t._frame.height===s.height&&0===t.rotate,!0},e}(),SpriteMaskFilter2=function(e){function t(t){var r=this,n=new Matrix2;return r=e.call(this,vertex7,fragment10)||this,t.renderable=!1,r.maskSprite=t,r.maskMatrix=n,r}return __extends23(t,e),t.prototype.apply=function(e,t,r,n){var i=this.maskSprite,s=i._texture;!s.valid||(s.uvMatrix||(s.uvMatrix=new TextureMatrix2(s,0)),s.uvMatrix.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,i).prepend(s.uvMatrix.mapCoord),this.uniforms.alpha=i.worldAlpha,this.uniforms.maskClamp=s.uvMatrix.uClampFrame,e.applyFilter(this,t,r,n))},t}(Filter2),MaskSystem2=function(e){function t(t){var r=e.call(this,t)||this;return r.enableScissor=!0,r.alphaMaskPool=[],r.maskDataPool=[],r.maskStack=[],r.alphaMaskIndex=0,r}return __extends23(t,e),t.prototype.setMaskStack=function(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)},t.prototype.push=function(e,t){var r=t;if(!r.isMaskData){var n=this.maskDataPool.pop()||new MaskData2;n.pooled=!0,n.maskObject=t,r=n}switch(r.autoDetect&&this.detect(r),r.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),r._target=e,r.type){case MASK_TYPES2.SCISSOR:this.maskStack.push(r),this.renderer.scissor.push(r);break;case MASK_TYPES2.STENCIL:this.maskStack.push(r),this.renderer.stencil.push(r);break;case MASK_TYPES2.SPRITE:r.copyCountersOrReset(null),this.pushSpriteMask(r),this.maskStack.push(r)}},t.prototype.pop=function(e){var t=this.maskStack.pop();if(t&&t._target===e){switch(t.type){case MASK_TYPES2.SCISSOR:this.renderer.scissor.pop();break;case MASK_TYPES2.STENCIL:this.renderer.stencil.pop(t.maskObject);break;case MASK_TYPES2.SPRITE:this.popSpriteMask()}t.reset(),t.pooled&&this.maskDataPool.push(t)}},t.prototype.detect=function(e){var t=e.maskObject;if(t.isSprite)e.type=MASK_TYPES2.SPRITE;else if(e.type=MASK_TYPES2.STENCIL,this.enableScissor&&t.isFastRect&&t.isFastRect()){var r=t.worldTransform,n=Math.atan2(r.b,r.a),i=Math.atan2(r.d,r.c);n=Math.round(n*(180/Math.PI)*100),i=((i=Math.round(i*(180/Math.PI)*100)-n)%18e3+18e3)%18e3,0==(n=(n%9e3+9e3)%9e3)&&9e3===i&&(e.type=MASK_TYPES2.SCISSOR)}},t.prototype.pushSpriteMask=function(e){var t=e.maskObject,r=e._target,n=this.alphaMaskPool[this.alphaMaskIndex];n||(n=this.alphaMaskPool[this.alphaMaskIndex]=[new SpriteMaskFilter2(t)]),n[0].resolution=this.renderer.resolution,n[0].maskSprite=t;var i=r.filterArea;r.filterArea=t.getBounds(!0),this.renderer.filter.push(r,n),r.filterArea=i,this.alphaMaskIndex++},t.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},t}(System2),AbstractMaskSystem2=function(e){function t(t){var r=e.call(this,t)||this;return r.maskStack=[],r.glConst=0,r}return __extends23(t,e),t.prototype.getStackLength=function(){return this.maskStack.length},t.prototype.setMaskStack=function(e){var t=this.renderer.gl,r=this.getStackLength();this.maskStack=e;var n=this.getStackLength();n!==r&&(0===n?t.disable(this.glConst):(t.enable(this.glConst),this._useCurrent()))},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.maskStack=null},t}(System2),ScissorSystem2=function(e){function t(t){var r=e.call(this,t)||this;return r.glConst=WebGLRenderingContext.SCISSOR_TEST,r}return __extends23(t,e),t.prototype.getStackLength=function(){var e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0},t.prototype.push=function(e){var t=e.maskObject;t.renderable=!0;var r=e._scissorRect,n=t.getBounds(!0),i=this.renderer.gl;t.renderable=!1,r?n.fit(r):i.enable(i.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=n,this._useCurrent()},t.prototype.pop=function(){var e=this.renderer.gl;this.getStackLength()>0?this._useCurrent():e.disable(e.SCISSOR_TEST)},t.prototype._useCurrent=function(){var e=this.maskStack[this.maskStack.length-1]._scissorRect,t=this.renderer.renderTexture.current,r=this.renderer.projection,n=r.transform,i=r.sourceFrame,s=r.destinationFrame,o=t?t.resolution:this.renderer.resolution,a=s.width/i.width,l=s.height/i.height,h=((e.x-i.x)*a+s.x)*o,u=((e.y-i.y)*l+s.y)*o,c=e.width*a*o,d=e.height*l*o;n&&(h+=n.tx*o,u+=n.ty*o),t||(u=this.renderer.height-d-u),this.renderer.gl.scissor(h,u,c,d)},t}(AbstractMaskSystem2),StencilSystem2=function(e){function t(t){var r=e.call(this,t)||this;return r.glConst=WebGLRenderingContext.STENCIL_TEST,r}return __extends23(t,e),t.prototype.getStackLength=function(){var e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0},t.prototype.push=function(e){var t=e.maskObject,r=this.renderer.gl,n=e._stencilCounter;0===n&&(this.renderer.framebuffer.forceStencil(),r.enable(r.STENCIL_TEST)),e._stencilCounter++,r.colorMask(!1,!1,!1,!1),r.stencilFunc(r.EQUAL,n,this._getBitwiseMask()),r.stencilOp(r.KEEP,r.KEEP,r.INCR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),this.renderer.framebuffer.blit(),t.renderable=!1,this._useCurrent()},t.prototype.pop=function(e){var t=this.renderer.gl;0===this.getStackLength()?(t.disable(t.STENCIL_TEST),t.clear(t.STENCIL_BUFFER_BIT),t.clearStencil(0)):(t.colorMask(!1,!1,!1,!1),t.stencilOp(t.KEEP,t.KEEP,t.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent())},t.prototype._useCurrent=function(){var e=this.renderer.gl;e.colorMask(!0,!0,!0,!0),e.stencilFunc(e.EQUAL,this.getStackLength(),this._getBitwiseMask()),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)},t.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},t}(AbstractMaskSystem2),ProjectionSystem2=function(e){function t(t){var r=e.call(this,t)||this;return r.destinationFrame=null,r.sourceFrame=null,r.defaultFrame=null,r.projectionMatrix=new Matrix2,r.transform=null,r}return __extends23(t,e),t.prototype.update=function(e,t,r,n){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=t||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,r,n),this.transform&&this.projectionMatrix.append(this.transform);var i=this.renderer;i.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,i.globalUniforms.update(),i.shader.shader&&i.shader.syncUniformGroup(i.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(e,t,r,n){var i=this.projectionMatrix,s=n?-1:1;i.identity(),i.a=1/t.width*2,i.d=s*(1/t.height*2),i.tx=-1-t.x*i.a,i.ty=-s-t.y*i.d},t.prototype.setTransform=function(e){},t}(System2),tempRect3=new Rectangle2,tempRect22=new Rectangle2,RenderTextureSystem2=function(e){function t(t){var r=e.call(this,t)||this;return r.clearColor=t._backgroundColorRgba,r.defaultMaskStack=[],r.current=null,r.sourceFrame=new Rectangle2,r.destinationFrame=new Rectangle2,r.viewportFrame=new Rectangle2,r}return __extends23(t,e),t.prototype.bind=function(e,t,r){void 0===e&&(e=null);var n,i,s,o=this.renderer;this.current=e,e?(s=(n=e.baseTexture).resolution,t||(tempRect3.width=e.frame.width,tempRect3.height=e.frame.height,t=tempRect3),r||(tempRect22.x=e.frame.x,tempRect22.y=e.frame.y,tempRect22.width=t.width,tempRect22.height=t.height,r=tempRect22),i=n.framebuffer):(s=o.resolution,t||(tempRect3.width=o.screen.width,tempRect3.height=o.screen.height,t=tempRect3),r||((r=tempRect3).width=t.width,r.height=t.height));var a=this.viewportFrame;a.x=r.x*s,a.y=r.y*s,a.width=r.width*s,a.height=r.height*s,e||(a.y=o.view.height-(a.y+a.height)),this.renderer.framebuffer.bind(i,a),this.renderer.projection.update(r,t,s,!i),e?this.renderer.mask.setMaskStack(n.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(t),this.destinationFrame.copyFrom(r)},t.prototype.clear=function(e,t){e=this.current?e||this.current.baseTexture.clearColor:e||this.clearColor;var r=this.destinationFrame,n=this.current?this.current.baseTexture:this.renderer.screen,i=r.width!==n.width||r.height!==n.height;if(i){var s=this.viewportFrame,o=s.x,a=s.y,l=s.width,h=s.height;this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(o,a,l,h)}this.renderer.framebuffer.clear(e[0],e[1],e[2],e[3],t),i&&this.renderer.scissor.pop()},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t}(System2),GLProgram2=function(){function e(e,t){this.program=e,this.uniformData=t,this.uniformGroups={}}return e.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null},e}(),UID$42=0,defaultSyncData2={textureCount:0},ShaderSystem2=function(e){function t(t){var r=e.call(this,t)||this;return r.destroyed=!1,r.systemCheck(),r.gl=null,r.shader=null,r.program=null,r.cache={},r.id=UID$42++,r}return __extends23(t,e),t.prototype.systemCheck=function(){if(!unsafeEvalSupported2())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},t.prototype.contextChange=function(e){this.gl=e,this.reset()},t.prototype.bind=function(e,t){e.uniforms.globals=this.renderer.globalUniforms;var r=e.program,n=r.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(e);return this.shader=e,this.program!==r&&(this.program=r,this.gl.useProgram(n.program)),t||(defaultSyncData2.textureCount=0,this.syncUniformGroup(e.uniformGroup,defaultSyncData2)),n},t.prototype.setUniforms=function(e){var t=this.shader.program,r=t.glPrograms[this.renderer.CONTEXT_UID];t.syncUniforms(r.uniformData,e,this.renderer)},t.prototype.syncUniformGroup=function(e,t){var r=this.getglProgram();(!e.static||e.dirtyId!==r.uniformGroups[e.id])&&(r.uniformGroups[e.id]=e.dirtyId,this.syncUniforms(e,r,t))},t.prototype.syncUniforms=function(e,t,r){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(t.uniformData,e.uniforms,this.renderer,r)},t.prototype.createSyncGroups=function(e){var t=this.getSignature(e,this.shader.program.uniformData);return this.cache[t]||(this.cache[t]=generateUniformsSync2(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[t],e.syncUniforms[this.shader.program.id]},t.prototype.getSignature=function(e,t){var r=e.uniforms,n=[];for(var i in r)n.push(i),t[i]&&n.push(t[i].type);return n.join("-")},t.prototype.getglProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},t.prototype.generateShader=function(e){var t=this.gl,r=e.program,n={};for(var i in r.attributeData)n[i]=r.attributeData[i].location;var s=compileProgram2(t,r.vertexSrc,r.fragmentSrc,n),o={};for(var i in r.uniformData){var a=r.uniformData[i];o[i]={location:t.getUniformLocation(s,i),value:defaultValue2(a.type,a.size)}}var l=new GLProgram2(s,o);return r.glPrograms[this.renderer.CONTEXT_UID]=l,l},t.prototype.reset=function(){this.program=null,this.shader=null},t.prototype.destroy=function(){this.destroyed=!0},t}(System2);function mapWebGLBlendModesToPixi2(e,t){return void 0===t&&(t=[]),t[BLEND_MODES2.NORMAL]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.ADD]=[e.ONE,e.ONE],t[BLEND_MODES2.MULTIPLY]=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.SCREEN]=[e.ONE,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.OVERLAY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.DARKEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.LIGHTEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.COLOR_DODGE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.COLOR_BURN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.HARD_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.SOFT_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.DIFFERENCE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.EXCLUSION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.HUE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.SATURATION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.COLOR]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.LUMINOSITY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.NONE]=[0,0],t[BLEND_MODES2.NORMAL_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.ADD_NPM]=[e.SRC_ALPHA,e.ONE,e.ONE,e.ONE],t[BLEND_MODES2.SCREEN_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.SRC_IN]=[e.DST_ALPHA,e.ZERO],t[BLEND_MODES2.SRC_OUT]=[e.ONE_MINUS_DST_ALPHA,e.ZERO],t[BLEND_MODES2.SRC_ATOP]=[e.DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.DST_OVER]=[e.ONE_MINUS_DST_ALPHA,e.ONE],t[BLEND_MODES2.DST_IN]=[e.ZERO,e.SRC_ALPHA],t[BLEND_MODES2.DST_OUT]=[e.ZERO,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.DST_ATOP]=[e.ONE_MINUS_DST_ALPHA,e.SRC_ALPHA],t[BLEND_MODES2.XOR]=[e.ONE_MINUS_DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES2.SUBTRACT]=[e.ONE,e.ONE,e.ONE,e.ONE,e.FUNC_REVERSE_SUBTRACT,e.FUNC_ADD],t}var BLEND$12=0,OFFSET$12=1,CULLING$12=2,DEPTH_TEST$12=3,WINDING$12=4,DEPTH_MASK$12=5,StateSystem2=function(e){function t(t){var r=e.call(this,t)||this;return r.gl=null,r.stateId=0,r.polygonOffset=0,r.blendMode=BLEND_MODES2.NONE,r._blendEq=!1,r.map=[],r.map[BLEND$12]=r.setBlend,r.map[OFFSET$12]=r.setOffset,r.map[CULLING$12]=r.setCullFace,r.map[DEPTH_TEST$12]=r.setDepthTest,r.map[WINDING$12]=r.setFrontFace,r.map[DEPTH_MASK$12]=r.setDepthMask,r.checks=[],r.defaultState=new State2,r.defaultState.blend=!0,r}return __extends23(t,e),t.prototype.contextChange=function(e){this.gl=e,this.blendModes=mapWebGLBlendModesToPixi2(e),this.set(this.defaultState),this.reset()},t.prototype.set=function(e){if(e=e||this.defaultState,this.stateId!==e.data){for(var t=this.stateId^e.data,r=0;t;)1&t&&this.map[r].call(this,!!(e.data&1<<r)),t>>=1,r++;this.stateId=e.data}for(r=0;r<this.checks.length;r++)this.checks[r](this,e)},t.prototype.forceState=function(e){e=e||this.defaultState;for(var t=0;t<this.map.length;t++)this.map[t].call(this,!!(e.data&1<<t));for(t=0;t<this.checks.length;t++)this.checks[t](this,e);this.stateId=e.data},t.prototype.setBlend=function(e){this.updateCheck(t.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)},t.prototype.setOffset=function(e){this.updateCheck(t.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},t.prototype.setDepthTest=function(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)},t.prototype.setDepthMask=function(e){this.gl.depthMask(e)},t.prototype.setCullFace=function(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)},t.prototype.setFrontFace=function(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])},t.prototype.setBlendMode=function(e){if(e!==this.blendMode){this.blendMode=e;var t=this.blendModes[e],r=this.gl;2===t.length?r.blendFunc(t[0],t[1]):r.blendFuncSeparate(t[0],t[1],t[2],t[3]),6===t.length?(this._blendEq=!0,r.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}},t.prototype.setPolygonOffset=function(e,t){this.gl.polygonOffset(e,t)},t.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},t.prototype.updateCheck=function(e,t){var r=this.checks.indexOf(e);t&&-1===r?this.checks.push(e):!t&&-1!==r&&this.checks.splice(r,1)},t.checkBlendMode=function(e,t){e.setBlendMode(t.blendMode)},t.checkPolygonOffset=function(e,t){e.setPolygonOffset(1,t.polygonOffset)},t}(System2),TextureGCSystem2=function(e){function t(t){var r=e.call(this,t)||this;return r.count=0,r.checkCount=0,r.maxIdle=settings.GC_MAX_IDLE,r.checkCountMax=settings.GC_MAX_CHECK_COUNT,r.mode=settings.GC_MODE,r}return __extends23(t,e),t.prototype.postrender=function(){!this.renderer.renderingToScreen||(this.count++,this.mode!==GC_MODES2.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},t.prototype.run=function(){for(var e=this.renderer.texture,t=e.managedTextures,r=!1,n=0;n<t.length;n++){var i=t[n];!i.framebuffer&&this.count-i.touched>this.maxIdle&&(e.destroyTexture(i,!0),t[n]=null,r=!0)}if(r){var s=0;for(n=0;n<t.length;n++)null!==t[n]&&(t[s++]=t[n]);t.length=s}},t.prototype.unload=function(e){var t=this.renderer.texture,r=e._texture;r&&!r.framebuffer&&t.destroyTexture(r);for(var n=e.children.length-1;n>=0;n--)this.unload(e.children[n])},t}(System2),GLTexture2=function(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121,this.samplerType=0},TextureSystem2=function(e){function t(t){var r=e.call(this,t)||this;return r.boundTextures=[],r.currentLocation=-1,r.managedTextures=[],r._unknownBoundTextures=!1,r.unknownTexture=new BaseTexture2,r.hasIntegerTextures=!1,r}return __extends23(t,e),t.prototype.contextChange=function(){var e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var t=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=t;for(var r=0;r<t;r++)this.boundTextures[r]=null;this.emptyTextures={};var n=new GLTexture2(e.createTexture());for(e.bindTexture(e.TEXTURE_2D,n.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=n,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new GLTexture2(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture),r=0;r<6;r++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);for(e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR),r=0;r<this.boundTextures.length;r++)this.bind(null,r)},t.prototype.bind=function(e,t){void 0===t&&(t=0);var r=this.gl;if(e){if((e=e.castToBaseTexture()).parentTextureArray)return;if(e.valid){e.touched=this.renderer.textureGC.count;var n=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[t]!==e&&(this.currentLocation!==t&&(this.currentLocation=t,r.activeTexture(r.TEXTURE0+t)),r.bindTexture(e.target,n.texture)),n.dirtyId!==e.dirtyId&&(this.currentLocation!==t&&(this.currentLocation=t,r.activeTexture(r.TEXTURE0+t)),this.updateTexture(e)),this.boundTextures[t]=e}}else this.currentLocation!==t&&(this.currentLocation=t,r.activeTexture(r.TEXTURE0+t)),r.bindTexture(r.TEXTURE_2D,this.emptyTextures[r.TEXTURE_2D].texture),this.boundTextures[t]=null},t.prototype.reset=function(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(var e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture},t.prototype.unbind=function(e){var t=this.gl,r=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var n=0;n<r.length;n++)r[n]===this.unknownTexture&&this.bind(null,n)}for(n=0;n<r.length;n++)r[n]===e&&(this.currentLocation!==n&&(t.activeTexture(t.TEXTURE0+n),this.currentLocation=n),t.bindTexture(e.target,this.emptyTextures[e.target].texture),r[n]=null)},t.prototype.ensureSamplerType=function(e){var t=this,r=t.boundTextures,n=t.hasIntegerTextures,i=t.CONTEXT_UID;if(n)for(var s=e-1;s>=0;--s){var o=r[s];o&&o._glTextures[i].samplerType!==SAMPLER_TYPES2.FLOAT&&this.renderer.texture.unbind(o)}},t.prototype.initTexture=function(e){var t=new GLTexture2(this.gl.createTexture());return t.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=t,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),t},t.prototype.initTextureType=function(e,t){if(t.internalFormat=e.format,t.type=e.type,2===this.webGLVersion){var r=this.renderer.gl;e.type===r.FLOAT&&e.format===r.RGBA&&(t.internalFormat=r.RGBA32F),e.type===TYPES2.HALF_FLOAT&&(t.type=r.HALF_FLOAT),t.type===r.HALF_FLOAT&&e.format===r.RGBA&&(t.internalFormat=r.RGBA16F)}},t.prototype.updateTexture=function(e){var t=e._glTextures[this.CONTEXT_UID];if(t){var r=this.renderer;if(this.initTextureType(e,t),e.resource&&e.resource.upload(r,e,t))t.samplerType!==SAMPLER_TYPES2.FLOAT&&(this.hasIntegerTextures=!0);else{var n=e.realWidth,i=e.realHeight,s=r.gl;(t.width!==n||t.height!==i||t.dirtyId<0)&&(t.width=n,t.height=i,s.texImage2D(e.target,0,t.internalFormat,n,i,0,e.format,t.type,null))}e.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(e),t.dirtyId=e.dirtyId}},t.prototype.destroyTexture=function(e,t){var r=this.gl;if((e=e.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(e),r.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!t)){var n=this.managedTextures.indexOf(e);-1!==n&&removeItems2(this.managedTextures,n,1)}},t.prototype.updateTextureStyle=function(e){var t=e._glTextures[this.CONTEXT_UID];!t||(e.mipmap!==MIPMAP_MODES2.POW2&&2===this.webGLVersion||e.isPowerOfTwo?t.mipmap=e.mipmap>=1:t.mipmap=!1,2===this.webGLVersion||e.isPowerOfTwo?t.wrapMode=e.wrapMode:t.wrapMode=WRAP_MODES2.CLAMP,e.resource&&e.resource.style(this.renderer,e,t)||this.setStyle(e,t),t.dirtyStyleId=e.dirtyStyleId)},t.prototype.setStyle=function(e,t){var r=this.gl;if(t.mipmap&&e.mipmap!==MIPMAP_MODES2.ON_MANUAL&&r.generateMipmap(e.target),r.texParameteri(e.target,r.TEXTURE_WRAP_S,t.wrapMode),r.texParameteri(e.target,r.TEXTURE_WRAP_T,t.wrapMode),t.mipmap){r.texParameteri(e.target,r.TEXTURE_MIN_FILTER,e.scaleMode===SCALE_MODES2.LINEAR?r.LINEAR_MIPMAP_LINEAR:r.NEAREST_MIPMAP_NEAREST);var n=this.renderer.context.extensions.anisotropicFiltering;if(n&&e.anisotropicLevel>0&&e.scaleMode===SCALE_MODES2.LINEAR){var i=Math.min(e.anisotropicLevel,r.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT));r.texParameterf(e.target,n.TEXTURE_MAX_ANISOTROPY_EXT,i)}}else r.texParameteri(e.target,r.TEXTURE_MIN_FILTER,e.scaleMode===SCALE_MODES2.LINEAR?r.LINEAR:r.NEAREST);r.texParameteri(e.target,r.TEXTURE_MAG_FILTER,e.scaleMode===SCALE_MODES2.LINEAR?r.LINEAR:r.NEAREST)},t}(System2),_systems2={__proto__:null,FilterSystem:FilterSystem2,BatchSystem:BatchSystem2,ContextSystem:ContextSystem2,FramebufferSystem:FramebufferSystem2,GeometrySystem:GeometrySystem2,MaskSystem:MaskSystem2,ScissorSystem:ScissorSystem2,StencilSystem:StencilSystem2,ProjectionSystem:ProjectionSystem2,RenderTextureSystem:RenderTextureSystem2,ShaderSystem:ShaderSystem2,StateSystem:StateSystem2,TextureGCSystem:TextureGCSystem2,TextureSystem:TextureSystem2},tempMatrix$12=new Matrix2,AbstractRenderer2=function(e){function t(t,r){void 0===t&&(t=RENDERER_TYPE2.UNKNOWN);var n=e.call(this)||this;return r=Object.assign({},settings.RENDER_OPTIONS,r),n.options=r,n.type=t,n.screen=new Rectangle2(0,0,r.width,r.height),n.view=r.view||document.createElement("canvas"),n.resolution=r.resolution||settings.RESOLUTION,n.useContextAlpha=r.useContextAlpha,n.autoDensity=!!r.autoDensity,n.preserveDrawingBuffer=r.preserveDrawingBuffer,n.clearBeforeRender=r.clearBeforeRender,n._backgroundColor=0,n._backgroundColorRgba=[0,0,0,1],n._backgroundColorString="#000000",n.backgroundColor=r.backgroundColor||n._backgroundColor,n.backgroundAlpha=r.backgroundAlpha,void 0!==r.transparent&&(deprecation2("6.0.0","Option transparent is deprecated, please use backgroundAlpha instead."),n.useContextAlpha=r.transparent,n.backgroundAlpha=r.transparent?0:1),n._lastObjectRendered=null,n.plugins={},n}return __extends23(t,e),t.prototype.initPlugins=function(e){for(var t in e)this.plugins[t]=new e[t](this)},Object.defineProperty(t.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),t.prototype.resize=function(e,t){this.screen.width=e,this.screen.height=t,this.view.width=e*this.resolution,this.view.height=t*this.resolution,this.autoDensity&&(this.view.style.width=e+"px",this.view.style.height=t+"px"),this.emit("resize",e,t)},t.prototype.generateTexture=function(e,t,r,n){0===(n=n||e.getLocalBounds(null,!0)).width&&(n.width=1),0===n.height&&(n.height=1);var i=RenderTexture2.create({width:0|n.width,height:0|n.height,scaleMode:t,resolution:r});return tempMatrix$12.tx=-n.x,tempMatrix$12.ty=-n.y,this.render(e,{renderTexture:i,clear:!1,transform:tempMatrix$12,skipUpdateTransform:!!e.parent}),i},t.prototype.destroy=function(e){for(var t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null;e&&this.view.parentNode&&this.view.parentNode.removeChild(this.view);var r=this;r.plugins=null,r.type=RENDERER_TYPE2.UNKNOWN,r.view=null,r.screen=null,r._tempDisplayObjectParent=null,r.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(t.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(e){this._backgroundColor=e,this._backgroundColorString=hex2string2(e),hex2rgb2(e,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"backgroundAlpha",{get:function(){return this._backgroundColorRgba[3]},set:function(e){this._backgroundColorRgba[3]=e},enumerable:!1,configurable:!0}),t}(eventemitter3),Renderer2=function(e){function t(r){var n=e.call(this,RENDERER_TYPE2.WEBGL,r)||this;return r=n.options,n.gl=null,n.CONTEXT_UID=0,n.runners={destroy:new Runner2("destroy"),contextChange:new Runner2("contextChange"),reset:new Runner2("reset"),update:new Runner2("update"),postrender:new Runner2("postrender"),prerender:new Runner2("prerender"),resize:new Runner2("resize")},n.globalUniforms=new UniformGroup2({projectionMatrix:new Matrix2},!0),n.addSystem(MaskSystem2,"mask").addSystem(ContextSystem2,"context").addSystem(StateSystem2,"state").addSystem(ShaderSystem2,"shader").addSystem(TextureSystem2,"texture").addSystem(GeometrySystem2,"geometry").addSystem(FramebufferSystem2,"framebuffer").addSystem(ScissorSystem2,"scissor").addSystem(StencilSystem2,"stencil").addSystem(ProjectionSystem2,"projection").addSystem(TextureGCSystem2,"textureGC").addSystem(FilterSystem2,"filter").addSystem(RenderTextureSystem2,"renderTexture").addSystem(BatchSystem2,"batch"),n.initPlugins(t.__plugins),r.context?n.context.initFromContext(r.context):n.context.initFromOptions({alpha:!!n.useContextAlpha,antialias:r.antialias,premultipliedAlpha:n.useContextAlpha&&"notMultiplied"!==n.useContextAlpha,stencil:!0,preserveDrawingBuffer:r.preserveDrawingBuffer,powerPreference:n.options.powerPreference}),n.renderingToScreen=!0,sayHello2(2===n.context.webGLVersion?"WebGL 2":"WebGL 1"),n.resize(n.options.width,n.options.height),n}return __extends23(t,e),t.create=function(e){if(isWebGLSupported2())return new t(e);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},t.prototype.addSystem=function(e,t){t||(t=e.name);var r=new e(this);if(this[t])throw new Error('Whoops! The name "'+t+'" is already in use');for(var n in this[t]=r,this.runners)this.runners[n].add(r);return this},t.prototype.render=function(e,t){var r,n,i,s;if(t&&(t instanceof RenderTexture2?(deprecation2("6.0.0","Renderer#render arguments changed, use options instead."),r=t,n=arguments[2],i=arguments[3],s=arguments[4]):(r=t.renderTexture,n=t.clear,i=t.transform,s=t.skipUpdateTransform)),this.renderingToScreen=!r,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=i,!this.context.isLost){if(r||(this._lastObjectRendered=e),!s){var o=e.enableTempParent();e.updateTransform(),e.disableTempParent(o)}this.renderTexture.bind(r),this.batch.currentRenderer.start(),(void 0!==n?n:this.clearBeforeRender)&&this.renderTexture.clear(),e.render(this),this.batch.currentRenderer.flush(),r&&r.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},t.prototype.resize=function(t,r){e.prototype.resize.call(this,t,r),this.runners.resize.emit(t,r)},t.prototype.reset=function(){return this.runners.reset.emit(),this},t.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},t.prototype.destroy=function(t){for(var r in this.runners.destroy.emit(),this.runners)this.runners[r].destroy();e.prototype.destroy.call(this,t),this.gl=null},Object.defineProperty(t.prototype,"extract",{get:function(){return deprecation2("6.0.0","Renderer#extract has been deprecated, please use Renderer#plugins.extract instead."),this.plugins.extract},enumerable:!1,configurable:!0}),t.registerPlugin=function(e,r){t.__plugins=t.__plugins||{},t.__plugins[e]=r},t}(AbstractRenderer2),BatchDrawCall2=function(){this.texArray=null,this.blend=0,this.type=DRAW_MODES2.TRIANGLES,this.start=0,this.size=0,this.data=null},BatchTextureArray2=function(){function e(){this.elements=[],this.ids=[],this.count=0}return e.prototype.clear=function(){for(var e=0;e<this.count;e++)this.elements[e]=null;this.count=0},e}(),ViewableBuffer2=function(){function e(e){"number"==typeof e?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(e.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),e.prototype.view=function(e){return this[e+"View"]},e.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},e.sizeOf=function(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(e+" isn't a valid view type")}},e}(),AbstractBatchRenderer2=function(e){function t(t){var r=e.call(this,t)||this;return r.shaderGenerator=null,r.geometryClass=null,r.vertexSize=null,r.state=State2.for2d(),r.size=4*settings.SPRITE_BATCH_SIZE,r._vertexCount=0,r._indexCount=0,r._bufferedElements=[],r._bufferedTextures=[],r._bufferSize=0,r._shader=null,r._packedGeometries=[],r._packedGeometryPoolSize=2,r._flushId=0,r._aBuffers={},r._iBuffers={},r.MAX_TEXTURES=1,r.renderer.on("prerender",r.onPrerender,r),t.runners.contextChange.add(r),r._dcIndex=0,r._aIndex=0,r._iIndex=0,r._attributeBuffer=null,r._indexBuffer=null,r._tempBoundTextures=[],r}return __extends23(t,e),t.prototype.contextChange=function(){var e=this.renderer.gl;settings.PREFER_ENV===ENV2.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),settings.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=checkMaxIfStatementsInShader2(this.MAX_TEXTURES,e)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]=new this.geometryClass;this.initFlushBuffers()},t.prototype.initFlushBuffers=function(){for(var e=t._drawCallPool,r=t._textureArrayPool,n=this.size/4,i=Math.floor(n/this.MAX_TEXTURES)+1;e.length<n;)e.push(new BatchDrawCall2);for(;r.length<i;)r.push(new BatchTextureArray2);for(var s=0;s<this.MAX_TEXTURES;s++)this._tempBoundTextures[s]=null},t.prototype.onPrerender=function(){this._flushId=0},t.prototype.render=function(e){!e._texture.valid||(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)},t.prototype.buildTexturesAndDrawCalls=function(){var e=this._bufferedTextures,r=this.MAX_TEXTURES,n=t._textureArrayPool,i=this.renderer.batch,s=this._tempBoundTextures,o=this.renderer.textureGC.count,a=++BaseTexture2._globalBatch,l=0,h=n[0],u=0;i.copyBoundTextures(s,r);for(var c=0;c<this._bufferSize;++c){var d=e[c];e[c]=null,d._batchEnabled!==a&&(h.count>=r&&(i.boundArray(h,s,a,r),this.buildDrawCalls(h,u,c),u=c,h=n[++l],++a),d._batchEnabled=a,d.touched=o,h.elements[h.count++]=d)}for(h.count>0&&(i.boundArray(h,s,a,r),this.buildDrawCalls(h,u,this._bufferSize),++l,++a),c=0;c<s.length;c++)s[c]=null;BaseTexture2._globalBatch=a},t.prototype.buildDrawCalls=function(e,r,n){var i=this,s=i._bufferedElements,o=i._attributeBuffer,a=i._indexBuffer,l=i.vertexSize,h=t._drawCallPool,u=this._dcIndex,c=this._aIndex,d=this._iIndex,f=h[u];f.start=this._iIndex,f.texArray=e;for(var p=r;p<n;++p){var m=s[p],_=m._texture.baseTexture,g=premultiplyBlendMode2[_.alphaMode?1:0][m.blendMode];s[p]=null,r<p&&f.blend!==g&&(f.size=d-f.start,r=p,(f=h[++u]).texArray=e,f.start=d),this.packInterleavedGeometry(m,o,a,c,d),c+=m.vertexData.length/2*l,d+=m.indices.length,f.blend=g}r<n&&(f.size=d-f.start,++u),this._dcIndex=u,this._aIndex=c,this._iIndex=d},t.prototype.bindAndClearTexArray=function(e){for(var t=this.renderer.texture,r=0;r<e.count;r++)t.bind(e.elements[r],e.ids[r]),e.elements[r]=null;e.count=0},t.prototype.updateGeometry=function(){var e=this,t=e._packedGeometries,r=e._attributeBuffer,n=e._indexBuffer;settings.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(r.rawBinaryData),t[this._flushId]._indexBuffer.update(n),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(r.rawBinaryData),t[this._flushId]._indexBuffer.update(n),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},t.prototype.drawBatches=function(){for(var e=this._dcIndex,r=this.renderer,n=r.gl,i=r.state,s=t._drawCallPool,o=null,a=0;a<e;a++){var l=s[a],h=l.texArray,u=l.type,c=l.size,d=l.start,f=l.blend;o!==h&&(o=h,this.bindAndClearTexArray(h)),this.state.blendMode=f,i.set(this.state),n.drawElements(u,c,n.UNSIGNED_SHORT,2*d)}},t.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},t.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.MAX_TEXTURES),this.renderer.shader.bind(this._shader),settings.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},t.prototype.stop=function(){this.flush()},t.prototype.destroy=function(){for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),e.prototype.destroy.call(this)},t.prototype.getAttributeBuffer=function(e){var t=nextPow22(Math.ceil(e/8)),r=log22(t),n=8*t;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);var i=this._aBuffers[n];return i||(this._aBuffers[n]=i=new ViewableBuffer2(n*this.vertexSize*4)),i},t.prototype.getIndexBuffer=function(e){var t=nextPow22(Math.ceil(e/12)),r=log22(t),n=12*t;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);var i=this._iBuffers[r];return i||(this._iBuffers[r]=i=new Uint16Array(n)),i},t.prototype.packInterleavedGeometry=function(e,t,r,n,i){for(var s=t.uint32View,o=t.float32View,a=n/this.vertexSize,l=e.uvs,h=e.indices,u=e.vertexData,c=e._texture.baseTexture._batchLocation,d=Math.min(e.worldAlpha,1),f=d<1&&e._texture.baseTexture.alphaMode?premultiplyTint2(e._tintRGB,d):e._tintRGB+(255*d<<24),p=0;p<u.length;p+=2)o[n++]=u[p],o[n++]=u[p+1],o[n++]=l[p],o[n++]=l[p+1],s[n++]=f,o[n++]=c;for(p=0;p<h.length;p++)r[i++]=a+h[p]},t._drawCallPool=[],t._textureArrayPool=[],t}(ObjectRenderer2),BatchShaderGenerator2=function(){function e(e,t){if(this.vertexSrc=e,this.fragTemplate=t,this.programCache={},this.defaultGroupCache={},t.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(t.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}return e.prototype.generateShader=function(e){if(!this.programCache[e]){for(var t=new Int32Array(e),r=0;r<e;r++)t[r]=r;this.defaultGroupCache[e]=UniformGroup2.from({uSamplers:t},!0);var n=this.fragTemplate;n=(n=n.replace(/%count%/gi,""+e)).replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new Program2(this.vertexSrc,n)}var i={tint:new Float32Array([1,1,1,1]),translationMatrix:new Matrix2,default:this.defaultGroupCache[e]};return new Shader2(this.programCache[e],i)},e.prototype.generateSampleSrc=function(e){var t="";t+="\n",t+="\n";for(var r=0;r<e;r++)r>0&&(t+="\nelse "),r<e-1&&(t+="if(vTextureId < "+r+".5)"),t+="\n{",t+="\n\tcolor = texture2D(uSamplers["+r+"], vTextureCoord);",t+="\n}";return(t+="\n")+"\n"},e}(),BatchGeometry2=function(e){function t(t){void 0===t&&(t=!1);var r=e.call(this)||this;return r._buffer=new Buffer3(null,t,!1),r._indexBuffer=new Buffer3(null,t,!0),r.addAttribute("aVertexPosition",r._buffer,2,!1,TYPES2.FLOAT).addAttribute("aTextureCoord",r._buffer,2,!1,TYPES2.FLOAT).addAttribute("aColor",r._buffer,4,!0,TYPES2.UNSIGNED_BYTE).addAttribute("aTextureId",r._buffer,1,!0,TYPES2.FLOAT).addIndex(r._indexBuffer),r}return __extends23(t,e),t}(Geometry2),defaultVertex$32="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",defaultFragment$22="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",BatchPluginFactory2=function(){function e(){}return e.create=function(e){var t=Object.assign({vertex:defaultVertex$32,fragment:defaultFragment$22,geometryClass:BatchGeometry2,vertexSize:6},e),r=t.vertex,n=t.fragment,i=t.vertexSize,s=t.geometryClass;return function(e){function t(t){var o=e.call(this,t)||this;return o.shaderGenerator=new BatchShaderGenerator2(r,n),o.geometryClass=s,o.vertexSize=i,o}return __extends23(t,e),t}(AbstractBatchRenderer2)},Object.defineProperty(e,"defaultVertexSrc",{get:function(){return defaultVertex$32},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultFragmentTemplate",{get:function(){return defaultFragment$22},enumerable:!1,configurable:!0}),e}(),BatchRenderer2=BatchPluginFactory2.create(),resources2={},_loop_12=function(e){Object.defineProperty(resources2,e,{get:function(){return deprecation2("6.0.0","PIXI.systems."+e+" has moved to PIXI."+e),_resources2[e]}})};for(var name in _resources2)_loop_12(name);var systems2={},_loop_22=function(e){Object.defineProperty(systems2,e,{get:function(){return deprecation2("6.0.0","PIXI.resources."+e+" has moved to PIXI."+e),_systems2[e]}})};for(var name in _systems2)_loop_22(name);var CanvasMeshRenderer=function(){function e(e){this.renderer=e}return e.prototype.render=function(e){var t=this.renderer,r=e.worldTransform;t.context.globalAlpha=e.worldAlpha,t.setBlendMode(e.blendMode),t.setContextTransform(r,e.roundPixels),e.drawMode!==DRAW_MODES2.TRIANGLES?this._renderTriangleMesh(e):this._renderTriangles(e)},e.prototype._renderTriangleMesh=function(e){for(var t=e.geometry.buffers[0].data.length,r=0;r<t-2;r++){var n=2*r;this._renderDrawTriangle(e,n,n+2,n+4)}},e.prototype._renderTriangles=function(e){for(var t=e.geometry.getIndex().data,r=t.length,n=0;n<r;n+=3){var i=2*t[n],s=2*t[n+1],o=2*t[n+2];this._renderDrawTriangle(e,i,s,o)}},e.prototype._renderDrawTriangle=function(e,t,r,n){var i=this.renderer.context,s=e.geometry.buffers[0].data,o=e.uvs,a=e.texture;if(a.valid){var l=16777215!==e.tint,h=a.baseTexture,u=h.width,c=h.height;l&&e._cachedTint!==e.tint&&(e._cachedTint=e.tint,e._cachedTexture=e._cachedTexture||new Texture2(h),e._tintedCanvas=canvasUtils.getTintedCanvas({texture:e._cachedTexture},e.tint));var d=l?e._tintedCanvas:h.getDrawableSource(),f=o[t]*h.width,p=o[r]*h.width,m=o[n]*h.width,_=o[t+1]*h.height,g=o[r+1]*h.height,v=o[n+1]*h.height,y=s[t],b=s[r],x=s[n],S=s[t+1],T=s[r+1],E=s[n+1],A=e.canvasPadding/this.renderer.resolution;if(A>0){var w=e.worldTransform,C=w.a,O=w.b,R=w.c,D=w.d,I=(y+b+x)/3,M=(S+T+E)/3,N=y-I,P=S-M,k=C*N+R*P,F=O*N+D*P,L=Math.sqrt(k*k+F*F),B=1+A/L;y=I+N*B,S=M+P*B,k=C*(N=b-I)+R*(P=T-M),F=O*N+D*P,b=I+N*(B=1+A/(L=Math.sqrt(k*k+F*F))),T=M+P*B,k=C*(N=x-I)+R*(P=E-M),F=O*N+D*P,x=I+N*(B=1+A/(L=Math.sqrt(k*k+F*F))),E=M+P*B}i.save(),i.beginPath(),i.moveTo(y,S),i.lineTo(b,T),i.lineTo(x,E),i.closePath(),i.clip();var U=f*g+_*m+p*v-g*m-_*p-f*v,G=y*g+_*x+b*v-g*x-_*b-y*v,j=f*b+y*m+p*x-b*m-y*p-f*x,V=f*g*x+_*b*m+y*p*v-y*g*m-_*p*x-f*b*v,z=S*g+_*E+T*v-g*E-_*T-S*v,H=f*T+S*m+p*E-T*m-S*p-f*E,X=f*g*E+_*T*m+S*p*v-S*g*m-_*p*E-f*T*v;i.transform(G/U,z/U,j/U,H/U,V/U,X/U),i.drawImage(d,0,0,u*h.resolution,c*h.resolution,0,0,u,c),i.restore(),this.renderer.invalidateBlendMode()}},e.prototype.renderMeshFlat=function(e){var t=this.renderer.context,r=e.geometry.getBuffer("aVertexPosition").data,n=r.length/2;t.beginPath();for(var i=1;i<n-2;++i){var s=2*i,o=r[s],a=r[s+1],l=r[s+2],h=r[s+3],u=r[s+4],c=r[s+5];t.moveTo(o,a),t.lineTo(l,h),t.lineTo(u,c)}t.fillStyle="#FF0000",t.fill(),t.closePath()},e.prototype.destroy=function(){this.renderer=null},e}();settings.MESH_CANVAS_PADDING=0,MeshMaterial.prototype._renderCanvas=function(e,t){e.plugins.mesh.render(t)},NineSlicePlane.prototype._cachedTint=16777215,NineSlicePlane.prototype._tintedCanvas=null,NineSlicePlane.prototype._canvasUvs=null,NineSlicePlane.prototype._renderCanvas=function(e){var t=e.context,r=this.worldTransform,n=16777215!==this.tint,i=this.texture;if(i.valid){n&&this._cachedTint!==this.tint&&(this._cachedTint=this.tint,this._tintedCanvas=canvasUtils.getTintedCanvas(this,this.tint));var s=n?this._tintedCanvas:i.baseTexture.getDrawableSource();this._canvasUvs||(this._canvasUvs=[0,0,0,0,0,0,0,0]);var o=this.vertices,a=this._canvasUvs,l=n?0:i.frame.x,h=n?0:i.frame.y,u=l+i.frame.width,c=h+i.frame.height;a[0]=l,a[1]=l+this._leftWidth,a[2]=u-this._rightWidth,a[3]=u,a[4]=h,a[5]=h+this._topHeight,a[6]=c-this._bottomHeight,a[7]=c;for(var d=0;d<8;d++)a[d]*=i.baseTexture.resolution;t.globalAlpha=this.worldAlpha,e.setBlendMode(this.blendMode),e.setContextTransform(r,this.roundPixels);for(var f=0;f<3;f++)for(var p=0;p<3;p++){var m=2*p+8*f,_=Math.max(1,a[p+1]-a[p]),g=Math.max(1,a[f+5]-a[f+4]),v=Math.max(1,o[m+10]-o[m]),y=Math.max(1,o[m+11]-o[m+1]);t.drawImage(s,a[p],a[f+4],_,g,o[m],o[m+1],v,y)}}};var warned=!1;Mesh.prototype._cachedTint=16777215,Mesh.prototype._tintedCanvas=null,Mesh.prototype._cachedTexture=null,Mesh.prototype._renderCanvas=function(e){this.shader.uvMatrix&&(this.shader.uvMatrix.update(),this.calculateUvs()),this.material._renderCanvas?this.material._renderCanvas(e,this):warned||(warned=!0,self.console&&console.warn("Mesh with custom shaders are not supported in CanvasRenderer."))},Mesh.prototype._canvasPadding=null,Object.defineProperty(Mesh.prototype,"canvasPadding",{get:function(){return null!==this._canvasPadding?this._canvasPadding:settings.MESH_CANVAS_PADDING},set:function(e){this._canvasPadding=e}}),SimpleMesh.prototype._renderCanvas=function(e){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),this.shader.update&&this.shader.update(),this.calculateUvs(),this.material._renderCanvas(e,this)},SimpleRope.prototype._renderCanvas=function(e){(this.autoUpdate||this.geometry._width!==this.shader.texture.height)&&(this.geometry._width=this.shader.texture.height,this.geometry.update()),this.shader.update&&this.shader.update(),this.calculateUvs(),this.material._renderCanvas(e,this)};var CanvasGraphicsRenderer=function(){function e(e){this.renderer=e,this._svgMatrix=null,this._tempMatrix=new Matrix}return e.prototype._calcCanvasStyle=function(e,t){var r;return e.texture&&e.texture.baseTexture!==Texture.WHITE.baseTexture?e.texture.valid?(r=canvasUtils.getTintedPattern(e.texture,t),this.setPatternTransform(r,e.matrix||Matrix.IDENTITY)):r="#808080":r="#"+("00000"+(0|t).toString(16)).substr(-6),r},e.prototype.render=function(e){var t=this.renderer,r=t.context,n=e.worldAlpha,i=e.transform.worldTransform;t.setContextTransform(i),t.setBlendMode(e.blendMode);for(var s,o,a=e.geometry.graphicsData,l=(e.tint>>16&255)/255,h=(e.tint>>8&255)/255,u=(255&e.tint)/255,c=0;c<a.length;c++){var d=a[c],f=d.shape,p=d.fillStyle,m=d.lineStyle,_=0|d.fillStyle.color,g=0|d.lineStyle.color;if(d.matrix&&t.setContextTransform(i.copyTo(this._tempMatrix).append(d.matrix)),p.visible){var v=((_>>16&255)/255*l*255<<16)+((_>>8&255)/255*h*255<<8)+(255&_)/255*u*255;s=this._calcCanvasStyle(p,v)}if(m.visible){var y=((g>>16&255)/255*l*255<<16)+((g>>8&255)/255*h*255<<8)+(255&g)/255*u*255;o=this._calcCanvasStyle(m,y)}if(r.lineWidth=m.width,r.lineCap=m.cap,r.lineJoin=m.join,r.miterLimit=m.miterLimit,d.type===SHAPES.POLY){r.beginPath();var b=(O=f).points,x=d.holes,S=void 0,T=void 0,E=void 0,A=void 0;r.moveTo(b[0],b[1]);for(var w=2;w<b.length;w+=2)r.lineTo(b[w],b[w+1]);if(O.closeStroke&&r.closePath(),x.length>0){for(S=0,E=b[0],A=b[1],w=2;w+2<b.length;w+=2)S+=(b[w]-E)*(b[w+3]-A)-(b[w+2]-E)*(b[w+1]-A);for(var C=0;C<x.length;C++)if(b=x[C].shape.points){for(T=0,E=b[0],A=b[1],w=2;w+2<b.length;w+=2)T+=(b[w]-E)*(b[w+3]-A)-(b[w+2]-E)*(b[w+1]-A);if(T*S<0)for(r.moveTo(b[0],b[1]),w=2;w<b.length;w+=2)r.lineTo(b[w],b[w+1]);else for(r.moveTo(b[b.length-2],b[b.length-1]),w=b.length-4;w>=0;w-=2)r.lineTo(b[w],b[w+1]);x[C].shape.closeStroke&&r.closePath()}}p.visible&&(r.globalAlpha=p.alpha*n,r.fillStyle=s,r.fill()),m.visible&&(r.globalAlpha=m.alpha*n,r.strokeStyle=o,r.stroke())}else if(d.type===SHAPES.RECT){var O=f;p.visible&&(r.globalAlpha=p.alpha*n,r.fillStyle=s,r.fillRect(O.x,O.y,O.width,O.height)),m.visible&&(r.globalAlpha=m.alpha*n,r.strokeStyle=o,r.strokeRect(O.x,O.y,O.width,O.height))}else if(d.type===SHAPES.CIRC)O=f,r.beginPath(),r.arc(O.x,O.y,O.radius,0,2*Math.PI),r.closePath(),p.visible&&(r.globalAlpha=p.alpha*n,r.fillStyle=s,r.fill()),m.visible&&(r.globalAlpha=m.alpha*n,r.strokeStyle=o,r.stroke());else if(d.type===SHAPES.ELIP){var R=2*(O=f).width,D=2*O.height,I=O.x-R/2,M=O.y-D/2;r.beginPath();var N=.5522848,P=R/2*N,k=D/2*N,F=I+R,L=M+D,B=I+R/2,U=M+D/2;r.moveTo(I,U),r.bezierCurveTo(I,U-k,B-P,M,B,M),r.bezierCurveTo(B+P,M,F,U-k,F,U),r.bezierCurveTo(F,U+k,B+P,L,B,L),r.bezierCurveTo(B-P,L,I,U+k,I,U),r.closePath(),p.visible&&(r.globalAlpha=p.alpha*n,r.fillStyle=s,r.fill()),m.visible&&(r.globalAlpha=m.alpha*n,r.strokeStyle=o,r.stroke())}else if(d.type===SHAPES.RREC){var G=(O=f).x,j=O.y,V=O.width,z=O.height,H=O.radius,X=Math.min(V,z)/2|0;H=H>X?X:H,r.beginPath(),r.moveTo(G,j+H),r.lineTo(G,j+z-H),r.quadraticCurveTo(G,j+z,G+H,j+z),r.lineTo(G+V-H,j+z),r.quadraticCurveTo(G+V,j+z,G+V,j+z-H),r.lineTo(G+V,j+H),r.quadraticCurveTo(G+V,j,G+V-H,j),r.lineTo(G+H,j),r.quadraticCurveTo(G,j,G,j+H),r.closePath(),p.visible&&(r.globalAlpha=p.alpha*n,r.fillStyle=s,r.fill()),m.visible&&(r.globalAlpha=m.alpha*n,r.strokeStyle=o,r.stroke())}}},e.prototype.setPatternTransform=function(e,t){if(!1!==this._svgMatrix){if(!this._svgMatrix){var r=document.createElementNS("http://www.w3.org/2000/svg","svg");if(r&&r.createSVGMatrix&&(this._svgMatrix=r.createSVGMatrix()),!this._svgMatrix||!e.setTransform)return void(this._svgMatrix=!1)}this._svgMatrix.a=t.a,this._svgMatrix.b=t.b,this._svgMatrix.c=t.c,this._svgMatrix.d=t.d,this._svgMatrix.e=t.tx,this._svgMatrix.f=t.ty,e.setTransform(this._svgMatrix.inverse())}},e.prototype.destroy=function(){this.renderer=null,this._svgMatrix=null,this._tempMatrix=null},e}(),canvasRenderer,tempMatrix4=new Matrix;Graphics.prototype.generateCanvasTexture=function(e,t){void 0===t&&(t=1);var r=this.getLocalBounds(),n=RenderTexture.create({width:r.width,height:r.height,scaleMode:e,resolution:t});canvasRenderer||(canvasRenderer=new CanvasRenderer),this.transform.updateLocalTransform(),this.transform.localTransform.copyTo(tempMatrix4),tempMatrix4.invert(),tempMatrix4.tx-=r.x,tempMatrix4.ty-=r.y,canvasRenderer.render(this,{renderTexture:n,clear:!0,transform:tempMatrix4});var i=Texture.from(n.baseTexture._canvasRenderTarget.canvas,{scaleMode:e});return i.baseTexture.setResolution(t),i},Graphics.prototype.cachedGraphicsData=[],Graphics.prototype._renderCanvas=function(e){!0!==this.isMask&&(this.finishPoly(),e.plugins.graphics.render(this))};var canvasRenderWorldTransform=new Matrix,CanvasSpriteRenderer=function(){function e(e){this.renderer=e}return e.prototype.render=function(e){var t=e._texture,r=this.renderer,n=r.context,i=t._frame.width,s=t._frame.height,o=e.transform.worldTransform,a=0,l=0,h=t.baseTexture.getDrawableSource();if(!(t.orig.width<=0||t.orig.height<=0)&&t.valid&&h&&t.valid){r.setBlendMode(e.blendMode,!0),r.context.globalAlpha=e.worldAlpha;var u=t.baseTexture.scaleMode===SCALE_MODES2.LINEAR;r.smoothProperty&&r.context[r.smoothProperty]!==u&&(n[r.smoothProperty]=u),t.trim?(a=t.trim.width/2+t.trim.x-e.anchor.x*t.orig.width,l=t.trim.height/2+t.trim.y-e.anchor.y*t.orig.height):(a=(.5-e.anchor.x)*t.orig.width,l=(.5-e.anchor.y)*t.orig.height),t.rotate&&(o.copyTo(canvasRenderWorldTransform),o=canvasRenderWorldTransform,groupD8.matrixAppendRotationInv(o,t.rotate,a,l),a=0,l=0),a-=i/2,l-=s/2,r.setContextTransform(o,e.roundPixels,1),e.roundPixels&&(a|=0,l|=0);var c=t.baseTexture.resolution,d=r._outerBlend;d&&(n.save(),n.beginPath(),n.rect(a*r.resolution,l*r.resolution,i*r.resolution,s*r.resolution),n.clip()),16777215!==e.tint?((e._cachedTint!==e.tint||e._tintedCanvas.tintId!==e._texture._updateID)&&(e._cachedTint=e.tint,e._tintedCanvas=canvasUtils.getTintedCanvas(e,e.tint)),n.drawImage(e._tintedCanvas,0,0,Math.floor(i*c),Math.floor(s*c),Math.floor(a*r.resolution),Math.floor(l*r.resolution),Math.floor(i*r.resolution),Math.floor(s*r.resolution))):n.drawImage(h,t._frame.x*c,t._frame.y*c,Math.floor(i*c),Math.floor(s*c),Math.floor(a*r.resolution),Math.floor(l*r.resolution),Math.floor(i*r.resolution),Math.floor(s*r.resolution)),d&&n.restore(),r.setBlendMode(BLEND_MODES2.NORMAL)}},e.prototype.destroy=function(){this.renderer=null},e}();Sprite.prototype._tintedCanvas=null,Sprite.prototype._renderCanvas=function(e){e.plugins.sprite.render(this)};var TEMP_RECT2=new Rectangle,CanvasExtract=function(){function e(e){this.renderer=e}return e.prototype.image=function(e,t,r){var n=new Image;return n.src=this.base64(e,t,r),n},e.prototype.base64=function(e,t,r){return this.canvas(e).toDataURL(t,r)},e.prototype.canvas=function(e){var t,r,n,i,s=this.renderer;e&&(i=e instanceof RenderTexture?e:s.generateTexture(e)),i?(t=i.baseTexture._canvasRenderTarget.context,r=i.baseTexture._canvasRenderTarget.resolution,n=i.frame):(t=s.rootContext,r=s.resolution,(n=TEMP_RECT2).width=this.renderer.width,n.height=this.renderer.height);var o=Math.floor(n.width*r+1e-4),a=Math.floor(n.height*r+1e-4),l=new CanvasRenderTarget(o,a,1),h=t.getImageData(n.x*r,n.y*r,o,a);return l.context.putImageData(h,0,0),l.canvas},e.prototype.pixels=function(e){var t,r,n,i,s=this.renderer;e&&(i=e instanceof RenderTexture?e:s.generateTexture(e)),i?(t=i.baseTexture._canvasRenderTarget.context,r=i.baseTexture._canvasRenderTarget.resolution,n=i.frame):(t=s.rootContext,(n=TEMP_RECT2).width=s.width,n.height=s.height);var o=n.x*r,a=n.y*r,l=n.width*r,h=n.height*r;return t.getImageData(o,a,l,h).data},e.prototype.destroy=function(){this.renderer=null},e}(),extendStatics24=function(e,t){return extendStatics24=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},extendStatics24(e,t)};function __extends24(e,t){function r(){this.constructor=e}extendStatics24(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var CANVAS_START_SIZE=16;function uploadBaseTextures2(e,t){var r=e;if(t instanceof BaseTexture){var n=t.source,i=0===n.width?r.canvas.width:Math.min(r.canvas.width,n.width),s=0===n.height?r.canvas.height:Math.min(r.canvas.height,n.height);return r.ctx.drawImage(n,0,0,i,s,0,0,r.canvas.width,r.canvas.height),!0}return!1}var CanvasPrepare=function(e){function t(t){var r=e.call(this,t)||this;return r.uploadHookHelper=r,r.canvas=document.createElement("canvas"),r.canvas.width=CANVAS_START_SIZE,r.canvas.height=CANVAS_START_SIZE,r.ctx=r.canvas.getContext("2d"),r.registerUploadHook(uploadBaseTextures2),r}return __extends24(t,e),t.prototype.destroy=function(){e.prototype.destroy.call(this),this.ctx=null,this.canvas=null},t}(BasePrepare),worldMatrix=new Matrix,patternMatrix=new Matrix,patternRect=[new Point,new Point,new Point,new Point];function to_pixiPoint(e,t,r,n=!1){let i=to_px(e,t,r);return n?new Point(Math.round(i[0]),Math.round(i[1])):new Point(i[0],i[1])}TilingSprite.prototype._renderCanvas=function(e){var t=this._texture;if(t.baseTexture.valid){var r=e.context,n=this.worldTransform,i=t.baseTexture,s=i.getDrawableSource(),o=i.resolution;if(this._textureID!==this._texture._updateID||this._cachedTint!==this.tint){this._textureID=this._texture._updateID;var a=new CanvasRenderTarget(t._frame.width,t._frame.height,o);16777215!==this.tint?(this._tintedCanvas=canvasUtils.getTintedCanvas(this,this.tint),a.context.drawImage(this._tintedCanvas,0,0)):a.context.drawImage(s,-t._frame.x*o,-t._frame.y*o),this._cachedTint=this.tint,this._canvasPattern=a.context.createPattern(a.canvas,"repeat")}r.globalAlpha=this.worldAlpha,e.setBlendMode(this.blendMode),this.tileTransform.updateLocalTransform();var l=this.tileTransform.localTransform,h=this._width,u=this._height;worldMatrix.identity(),patternMatrix.copyFrom(l),this.uvRespectAnchor||patternMatrix.translate(-this.anchor.x*h,-this.anchor.y*u),worldMatrix.prepend(patternMatrix),worldMatrix.prepend(n),e.setContextTransform(worldMatrix),r.fillStyle=this._canvasPattern;var c=this.anchor.x*-h,d=this.anchor.y*-u;patternRect[0].set(c,d),patternRect[1].set(c+h,d),patternRect[2].set(c+h,d+u),patternRect[3].set(c,d+u);for(var f=0;f<4;f++)patternMatrix.applyInverse(patternRect[f],patternRect[f]);for(r.beginPath(),r.moveTo(patternRect[0].x,patternRect[0].y),f=1;f<4;f++)r.lineTo(patternRect[f].x,patternRect[f].y);r.closePath(),r.fill()}},ParticleContainer.prototype.renderCanvas=function(e){if(this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable){var t=e.context,r=this.worldTransform,n=!0,i=0,s=0,o=0,a=0;e.setBlendMode(this.blendMode),t.globalAlpha=this.worldAlpha,this.displayObjectUpdateTransform();for(var l=0;l<this.children.length;++l){var h=this.children[l];if(h.visible&&h._texture.valid){var u=h._texture.frame;if(t.globalAlpha=this.worldAlpha*h.alpha,h.rotation%(2*Math.PI)==0)n&&(e.setContextTransform(r,!1,1),n=!1),i=h.anchor.x*(-u.width*h.scale.x)+h.position.x+.5,s=h.anchor.y*(-u.height*h.scale.y)+h.position.y+.5,o=u.width*h.scale.x,a=u.height*h.scale.y;else{n||(n=!0),h.displayObjectUpdateTransform();var c=h.worldTransform;e.setContextTransform(c,this.roundPixels,1),i=h.anchor.x*-u.width+.5,s=h.anchor.y*-u.height+.5,o=u.width,a=u.height}var d=h._texture.baseTexture.resolution;t.drawImage(h._texture.baseTexture.getDrawableSource(),u.x*d,u.y*d,u.width*d,u.height*d,i*e.resolution,s*e.resolution,o*e.resolution,a*e.resolution)}}}},Container.prototype._renderCanvas=function(e){},Container.prototype.renderCanvas=function(e){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable){this._mask&&e.maskManager.pushMask(this._mask),this._renderCanvas(e);for(var t=0,r=this.children.length;t<r;++t)this.children[t].renderCanvas(e);this._mask&&e.maskManager.popMask(e)}},DisplayObject.prototype.renderCanvas=function(e){},Text.prototype._renderCanvas=function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),Sprite.prototype._renderCanvas.call(this,e)},CanvasRenderer.registerPlugin("accessibility",AccessibilityManager),CanvasRenderer.registerPlugin("extract",CanvasExtract),CanvasRenderer.registerPlugin("graphics",CanvasGraphicsRenderer),CanvasRenderer.registerPlugin("interaction",InteractionManager),CanvasRenderer.registerPlugin("mesh",CanvasMeshRenderer),CanvasRenderer.registerPlugin("prepare",CanvasPrepare),CanvasRenderer.registerPlugin("sprite",CanvasSpriteRenderer);var PsychObject=class extends EventEmitter{constructor(e,t){super(),this._psychoJS=e,this._userAttributes=new Set,void 0===t&&(t=this.constructor.name),this._addAttribute("name",t)}get psychoJS(){return this._psychoJS}set psychoJS(e){this._psychoJS=e}toString(){let e=this.constructor.name+"( ",t=!1;for(let r of this._userAttributes){t&&(e+=", "),t=!0;let n=toString(this["_"+r]),i=n.length;i>50&&(n=")"===n[i-1]?n.substring(0,50)+"~)":n.substring(0,50)+"~"),e+=r+"="+n}return e+=" )",e}_setAttribute(e,t,r=!1,n,i=!1){let s={origin:"PsychObject.setAttribute",context:"when setting the attribute of an object"};if(void 0===e)throw Object.assign(s,{error:"the attribute name cannot be undefined"});if(void 0===t&&this._psychoJS.logger.warn("setting the value of attribute: "+e+" in PsychObject: "+this._name+" as: undefined"),void 0!==n&&this.hasOwnProperty("_"+e)){let r=this["_"+e];if("number"!=typeof t&&(!Array.isArray(t)||0!==t.length&&"number"!=typeof t[0]))throw Object.assign(s,{error:"operation: "+n+" is invalid for old value: "+JSON.stringify(r)+" and new value: "+JSON.stringify(t)});if(Array.isArray(t))if(Array.isArray(r)){if(t.length!==r.length)throw Object.assign(s,{error:"old and new value should have the same size when they are both arrays"});switch(n){case"":break;case"+":t=t.map(((e,t)=>r[t]+e));break;case"*":t=t.map(((e,t)=>r[t]*e));break;case"-":t=t.map(((e,t)=>r[t]-e));break;case"/":t=t.map(((e,t)=>r[t]/e));break;case"**":t=t.map(((e,t)=>r[t]**e));break;case"%":t=t.map(((e,t)=>r[t]%e));break;default:throw Object.assign(s,{error:"unsupported operation: "+n+" when setting: "+e+" in: "+this.name})}}else switch(n){case"":break;case"+":t=t.map((e=>r+e));break;case"*":t=t.map((e=>r*e));break;case"-":t=t.map((e=>r-e));break;case"/":t=t.map((e=>r/e));break;case"**":t=t.map((e=>r**e));break;case"%":t=t.map((e=>r%e));break;default:throw Object.assign(s,{error:"unsupported value: "+JSON.stringify(t)+" for operation: "+n+" when setting: "+e+" in: "+this.name})}else if(Array.isArray(r))switch(n){case"":t=r.map((e=>t));break;case"+":t=r.map((e=>e+t));break;case"*":t=r.map((e=>e*t));break;case"-":t=r.map((e=>e-t));break;case"/":t=r.map((e=>e/t));break;case"**":t=r.map((e=>e**t));break;case"%":t=r.map((e=>e%t));break;default:throw Object.assign(s,{error:"unsupported operation: "+n+" when setting: "+e+" in: "+this.name})}else switch(n){case"":break;case"+":t=r+t;break;case"*":t*=r;break;case"-":t=r-t;break;case"/":t=r/t;break;case"**":t=r**t;break;case"%":t=r%t;break;default:throw Object.assign(s,{error:"unsupported value: "+JSON.stringify(t)+" for operation: "+n+" when setting: "+e+" in: "+this.name})}}if(!i&&(r||this._autoLog)&&void 0!==this.win){let r=this.name+": "+e+" = "+toString(t);this.win.logOnFlip({msg:r})}let o=this["_"+e];if(this["_"+e]=t,void 0===o)return!1;let a=toString(o),l=toString(t);return"Object (circular)"===a||"Object (circular)"===l||a!==l}_addAttribute(e,t,r,n=(()=>{})){let i="get"+e[0].toUpperCase()+e.substr(1);void 0===this[i]&&(this[i]=()=>this["_"+e]);let s="set"+e[0].toUpperCase()+e.substr(1);void 0===this[s]?this[s]=(t,i=!1)=>{null==t&&(t=r),this._setAttribute(e,t,i)&&n()}:null==t&&(t=r),Object.defineProperty(this,e,{configurable:!0,get(){return this[i]()},set(e){this[s](e)}}),this[e]=t,this._userAttributes.add(e)}},Scheduler=class{constructor(e){this._psychoJS=e,this._taskList=[],this._currentTask=void 0,this._argsList=[],this._currentArgs=void 0,this._stopAtNextUpdate=!1,this._stopAtNextTask=!1,this._status=Scheduler.Status.STOPPED}get status(){return this._status}add(e,...t){this._taskList.push(e),this._argsList.push(t)}addConditional(e,t,r){let n=this;this.add((function(){return e()?n.add(t):n.add(r),Scheduler.Event.NEXT}))}async start(){let e=this,t=async r=>{if(e._stopAtNextUpdate)return void(e._status=Scheduler.Status.STOPPED);if(await e._runNextTasks()===Scheduler.Event.QUIT)return void(e._status=Scheduler.Status.STOPPED);let n=void 0===e._lastTimestamp?r:e._lastTimestamp;e._lastDelta=r-n,e._lastTimestamp=r,e._psychoJS.window.render(),requestAnimationFrame(t)};requestAnimationFrame(t)}stop(){this._status=Scheduler.Status.STOPPED,this._stopAtNextTask=!0,this._stopAtNextUpdate=!0}async _runNextTasks(){this._status=Scheduler.Status.RUNNING;let e=Scheduler.Event.NEXT;for(;e===Scheduler.Event.NEXT;){if(this._stopAtNextTask)return Scheduler.Event.QUIT;if(void 0===this._currentTask){if(!(this._taskList.length>0))return this._currentTask=void 0,this._currentArgs=void 0,Scheduler.Event.QUIT;this._currentTask=this._taskList.shift(),this._currentArgs=this._argsList.shift()}this._currentTask instanceof Function?e=await this._currentTask(...this._currentArgs):(e=await this._currentTask._runNextTasks(),e===Scheduler.Event.QUIT&&(this._psychoJS.experiment.experimentEnded||(e=Scheduler.Event.NEXT))),e!==Scheduler.Event.FLIP_REPEAT&&(this._currentTask=void 0,this._currentArgs=void 0)}return e}};Scheduler.Event={NEXT:Symbol.for("NEXT"),FLIP_REPEAT:Symbol.for("FLIP_REPEAT"),FLIP_NEXT:Symbol.for("FLIP_NEXT"),QUIT:Symbol.for("QUIT")},Scheduler.Status={RUNNING:Symbol.for("RUNNING"),STOPPED:Symbol.for("STOPPED")};var core_exports={};__export(core_exports,{BuilderKeyResponse:()=>BuilderKeyResponse,EventManager:()=>EventManager,GUI:()=>GUI,KeyPress:()=>KeyPress,Keyboard:()=>Keyboard,Logger:()=>Logger,MinimalStim:()=>MinimalStim,Mouse:()=>Mouse,PsychoJS:()=>PsychoJS,ServerManager:()=>ServerManager,Window:()=>Window,WindowMixin:()=>WindowMixin});var import_log4javascript2=__toModule(require_log4javascript()),XLSX=__toModule(require_xlsx()),ExperimentHandler=class extends PsychObject{get experimentEnded(){return this._experimentEnded}set experimentEnded(e){this._experimentEnded=e}get _thisEntry(){return this._currentTrialData}get _entries(){return this._trialsData}constructor({psychoJS:e,name:t,extraInfo:r}={}){super(e,t),this._addAttribute("extraInfo",r),this._loops=[],this._unfinishedLoops=[],this._trialsKeys=[],this._trialsData=[],this._currentTrialData={},this._experimentEnded=!1}isEntryEmpty(){return Object.keys(this._currentTrialData).length>0}addLoop(e){this._loops.push(e),this._unfinishedLoops.push(e),e.experimentHandler=this}removeLoop(e){let t=this._unfinishedLoops.indexOf(e);-1!==t&&this._unfinishedLoops.splice(t,1)}addData(e,t){-1===this._trialsKeys.indexOf(e)&&this._trialsKeys.push(e),Array.isArray(t)&&(t=JSON.stringify(t)),this._currentTrialData[e]=t}nextEntry(e){if(void 0!==e){Array.isArray(e)||(e=[e]);for(let t of e){let e=ExperimentHandler._getLoopAttributes(t);for(let t in e)e.hasOwnProperty(t)&&(this._currentTrialData[t]=e[t])}}else for(let e of this._unfinishedLoops){let t=ExperimentHandler._getLoopAttributes(e);for(let e in t)t.hasOwnProperty(e)&&(this._currentTrialData[e]=t[e])}for(let e in this.extraInfo)this.extraInfo.hasOwnProperty(e)&&(this._currentTrialData[e]=this.extraInfo[e]);this._trialsData.push(this._currentTrialData),this._currentTrialData={}}async save({attributes:e=[],sync:t=!1,tag:r="",clear:n=!1}={}){if(this._psychoJS.logger.info("[PsychoJS] Save experiment results."),0===e.length){e=this._trialsKeys.slice();for(let t=0;t<this._loops.length;t++){let r=this._loops[t],n=ExperimentHandler._getLoopAttributes(r);for(let t in n)n.hasOwnProperty(t)&&e.push(t)}for(let t in this.extraInfo)this.extraInfo.hasOwnProperty(t)&&e.push(t)}let i=this.extraInfo,s=void 0!==i.expName?i.expName:this.psychoJS.config.experiment.name,o="string"==typeof i.participant&&i.participant.length>0?i.participant:"PARTICIPANT",a="string"==typeof i.session&&i.session.length>0?i.session:"SESSION",l=void 0!==i.date?i.date:MonotonicClock.getDateStr(),h=this._psychoJS.config.gitlab,u=void 0!==h&&void 0!==h.projectId?h.projectId:void 0,c=this._trialsData;if(n&&(c=this._trialsData.slice(),this._trialsData=[]),this._psychoJS.config.experiment.saveFormat===ExperimentHandler.SaveFormat.CSV){let e=XLSX.utils.json_to_sheet(c),n="\ufeff"+XLSX.utils.sheet_to_csv(e),i=`${o}_${s}_${l}${r}.csv`;if(this._psychoJS.getEnvironment()===ExperimentHandler.Environment.SERVER&&"RUNNING"===this._psychoJS.config.experiment.status&&!this._psychoJS._serverMsg.has("__pilotToken"))return this._psychoJS.serverManager.uploadData(i,n,t);offerDataForDownload(i,n,"text/csv")}else if(this._psychoJS.config.experiment.saveFormat===ExperimentHandler.SaveFormat.DATABASE){let r=[];for(let t=0;t<c.length;t++){let n={__projectId:u,__experimentName:s,__participant:o,__session:a,__datetime:l};for(let r=0;r<e.length;r++)n[e[r]]=c[t][e[r]];r.push(n)}if(this._psychoJS.getEnvironment()===ExperimentHandler.Environment.SERVER&&"RUNNING"===this._psychoJS.config.experiment.status&&!this._psychoJS._serverMsg.has("__pilotToken")){let e="results";return this._psychoJS.serverManager.uploadData(e,JSON.stringify(r),t)}offerDataForDownload("results.json",JSON.stringify(r),"application/json")}}static _getLoopAttributes(e){let t=["thisRepN","thisTrialN","thisN","thisIndex","stepSizeCurrent","ran","order"],r={},n=e.name;for(let i in e)t.includes(i)&&(r["stepSizeCurrent"===i?n+".stepSize":n+"."+i]=e[i]);if("function"==typeof e.getCurrentTrial){let t=e.getCurrentTrial();for(let e in t)r[e]=t[e]}return r}};ExperimentHandler.SaveFormat={CSV:Symbol.for("CSV"),DATABASE:Symbol.for("DATABASE")},ExperimentHandler.Environment={SERVER:Symbol.for("SERVER"),LOCAL:Symbol.for("LOCAL")};var esm_exports={};__export(esm_exports,{AMOscillator:()=>AMOscillator,AMSynth:()=>AMSynth,Abs:()=>Abs,Add:()=>Add,AmplitudeEnvelope:()=>AmplitudeEnvelope,Analyser:()=>Analyser,AudioToGain:()=>AudioToGain,AutoFilter:()=>AutoFilter,AutoPanner:()=>AutoPanner,AutoWah:()=>AutoWah,BaseContext:()=>BaseContext,BiquadFilter:()=>BiquadFilter,BitCrusher:()=>BitCrusher,Buffer:()=>Buffer4,BufferSource:()=>BufferSource,Buffers:()=>Buffers,Channel:()=>Channel,Chebyshev:()=>Chebyshev,Chorus:()=>Chorus,Clock:()=>Clock2,Compressor:()=>Compressor,Context:()=>Context,Convolver:()=>Convolver,CrossFade:()=>CrossFade,DCMeter:()=>DCMeter,Delay:()=>Delay,Destination:()=>Destination2,Distortion:()=>Distortion,Draw:()=>Draw2,DuoSynth:()=>DuoSynth,EQ3:()=>EQ3,Emitter:()=>Emitter,Envelope:()=>Envelope,FFT:()=>FFT,FMOscillator:()=>FMOscillator,FMSynth:()=>FMSynth,FatOscillator:()=>FatOscillator,FeedbackCombFilter:()=>FeedbackCombFilter,FeedbackDelay:()=>FeedbackDelay,Filter:()=>Filter3,Follower:()=>Follower,Freeverb:()=>Freeverb,Frequency:()=>Frequency,FrequencyClass:()=>FrequencyClass,FrequencyEnvelope:()=>FrequencyEnvelope,FrequencyShifter:()=>FrequencyShifter,Gain:()=>Gain,GainToAudio:()=>GainToAudio,Gate:()=>Gate,GrainPlayer:()=>GrainPlayer,GreaterThan:()=>GreaterThan,GreaterThanZero:()=>GreaterThanZero,IntervalTimeline:()=>IntervalTimeline,JCReverb:()=>JCReverb,LFO:()=>LFO,Limiter:()=>Limiter,Listener:()=>Listener2,Loop:()=>Loop,LowpassCombFilter:()=>LowpassCombFilter,Master:()=>Master,MembraneSynth:()=>MembraneSynth,Merge:()=>Merge,MetalSynth:()=>MetalSynth,Meter:()=>Meter,MidSideCompressor:()=>MidSideCompressor,MidSideMerge:()=>MidSideMerge,MidSideSplit:()=>MidSideSplit,Midi:()=>Midi,MidiClass:()=>MidiClass,Mono:()=>Mono,MonoSynth:()=>MonoSynth,MultibandCompressor:()=>MultibandCompressor,MultibandSplit:()=>MultibandSplit,Multiply:()=>Multiply,Negate:()=>Negate,Noise:()=>Noise,NoiseSynth:()=>NoiseSynth,Offline:()=>Offline,OfflineContext:()=>OfflineContext,OmniOscillator:()=>OmniOscillator,OnePoleFilter:()=>OnePoleFilter,Oscillator:()=>Oscillator,PWMOscillator:()=>PWMOscillator,PanVol:()=>PanVol,Panner:()=>Panner,Panner3D:()=>Panner3D,Param:()=>Param,Part:()=>Part,Pattern:()=>Pattern,Phaser:()=>Phaser,PingPongDelay:()=>PingPongDelay,PitchShift:()=>PitchShift,Player:()=>Player,Players:()=>Players,PluckSynth:()=>PluckSynth,PolySynth:()=>PolySynth,Pow:()=>Pow,PulseOscillator:()=>PulseOscillator,Recorder:()=>Recorder,Reverb:()=>Reverb,Sampler:()=>Sampler,Scale:()=>Scale,ScaleExp:()=>ScaleExp,Sequence:()=>Sequence,Signal:()=>Signal2,Solo:()=>Solo,Split:()=>Split,StateTimeline:()=>StateTimeline,StereoWidener:()=>StereoWidener,Subtract:()=>Subtract,SyncedSignal:()=>SyncedSignal,Synth:()=>Synth,Ticks:()=>Ticks,TicksClass:()=>TicksClass,Time:()=>Time,TimeClass:()=>TimeClass,Timeline:()=>Timeline,ToneAudioBuffer:()=>ToneAudioBuffer,ToneAudioBuffers:()=>ToneAudioBuffers,ToneAudioNode:()=>ToneAudioNode,ToneBufferSource:()=>ToneBufferSource,ToneEvent:()=>ToneEvent,ToneOscillatorNode:()=>ToneOscillatorNode,Transport:()=>Transport2,TransportTime:()=>TransportTime,TransportTimeClass:()=>TransportTimeClass,Tremolo:()=>Tremolo,Unit:()=>Units_exports,UserMedia:()=>UserMedia,Vibrato:()=>Vibrato,Volume:()=>Volume,WaveShaper:()=>WaveShaper,Waveform:()=>Waveform,Zero:()=>Zero,connect:()=>connect,connectSeries:()=>connectSeries,connectSignal:()=>connectSignal,context:()=>context3,dbToGain:()=>dbToGain,debug:()=>Debug_exports,defaultArg:()=>defaultArg,disconnect:()=>disconnect,ftom:()=>ftom,gainToDb:()=>gainToDb,getContext:()=>getContext,getDestination:()=>getDestination,getDraw:()=>getDraw,getListener:()=>getListener,getTransport:()=>getTransport,immediate:()=>immediate,intervalToFrequencyRatio:()=>intervalToFrequencyRatio,isArray:()=>isArray2,isBoolean:()=>isBoolean,isDefined:()=>isDefined,isFunction:()=>isFunction,isNote:()=>isNote,isNumber:()=>isNumber,isObject:()=>isObject,isString:()=>isString,isUndef:()=>isUndef,loaded:()=>loaded,mtof:()=>mtof,now:()=>now,optionsFromArguments:()=>optionsFromArguments,setContext:()=>setContext,start:()=>start,supported:()=>isSupported,version:()=>version});var version="14.7.77",import_automation_events2=__toModule(require_bundle()),createAbortError=()=>new DOMException("","AbortError"),createAddActiveInputConnectionToAudioNode=e=>(t,r,[n,i,s],o)=>{e(t[i],[r,n,s],(e=>e[0]===r&&e[1]===n),o)},createAddAudioNodeConnections=e=>(t,r,n)=>{let i=[];for(let e=0;e<n.numberOfInputs;e+=1)i.push(new Set);e.set(t,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:r})},createAddAudioParamConnections=e=>(t,r)=>{e.set(t,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:r})},ACTIVE_AUDIO_NODE_STORE=new WeakSet,AUDIO_NODE_CONNECTIONS_STORE=new WeakMap,AUDIO_NODE_STORE=new WeakMap,AUDIO_PARAM_CONNECTIONS_STORE=new WeakMap,AUDIO_PARAM_STORE=new WeakMap,CONTEXT_STORE=new WeakMap,EVENT_LISTENERS=new WeakMap,CYCLE_COUNTERS=new WeakMap,NODE_NAME_TO_PROCESSOR_CONSTRUCTOR_MAPS=new WeakMap,NODE_TO_PROCESSOR_MAPS=new WeakMap,handler={construct:()=>handler},isConstructible=e=>{try{new new Proxy(e,handler)}catch(e){return!1}return!0},IMPORT_STATEMENT_REGEX=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,splitImportStatements=(e,t)=>{let r=[],n=e.replace(/^[\s]+/,""),i=n.match(IMPORT_STATEMENT_REGEX);for(;null!==i;){let e=i[1].slice(1,-1),s=i[0].replace(/([\s]+)?;?$/,"").replace(e,new URL(e,t).toString());r.push(s),n=n.slice(i[0].length).replace(/^[\s]+/,""),i=n.match(IMPORT_STATEMENT_REGEX)}return[r.join(";"),n]},verifyParameterDescriptors=e=>{if(void 0!==e&&!Array.isArray(e))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},verifyProcessorCtor=e=>{if(!isConstructible(e))throw new TypeError("The given value for processorCtor should be a constructor.");if(null===e.prototype||"object"!=typeof e.prototype)throw new TypeError("The given value for processorCtor should have a prototype.")},createAddAudioWorkletModule=(e,t,r,n,i,s,o,a,l,h,u,c)=>(d,f,p={credentials:"omit"})=>{let m=s(d);if(void 0!==m.audioWorklet)return Promise.all([i(f),Promise.resolve(e(u,u))]).then((([[e,t],r])=>{let[n,i]=splitImportStatements(e,t),s=new Blob([`${n};((AudioWorkletProcessor,registerProcessor)=>{${i}\n})(${r?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${r?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${r?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac',class extends AudioWorkletProcessor{process(){return !1}})`],{type:"application/javascript; charset=utf-8"}),l=URL.createObjectURL(s);return m.audioWorklet.addModule(l,p).then((()=>{if(a(m))return m;let e=o(m);return e.audioWorklet.addModule(l,p).then((()=>e))})).then((e=>{try{new AudioWorkletNode(e,"__sac")}catch(e){throw new SyntaxError}})).finally((()=>URL.revokeObjectURL(l)))}));let _=h.get(d);if(void 0!==_&&_.has(f))return Promise.resolve();let g=l.get(d);if(void 0!==g){let e=g.get(f);if(void 0!==e)return e}let v=i(f).then((([e,t])=>{let[n,i]=splitImportStatements(e,t);return r(`${n};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${i}\n})})(window,'_AWGS')`)})).then((()=>{let e=c._AWGS.pop();if(void 0===e)throw new SyntaxError;n(m.currentTime,m.sampleRate,(()=>e(class{},void 0,((e,r)=>{if(""===e.trim())throw t();let n=NODE_NAME_TO_PROCESSOR_CONSTRUCTOR_MAPS.get(m);if(void 0!==n){if(n.has(e))throw t();verifyProcessorCtor(r),verifyParameterDescriptors(r.parameterDescriptors),n.set(e,r)}else verifyProcessorCtor(r),verifyParameterDescriptors(r.parameterDescriptors),NODE_NAME_TO_PROCESSOR_CONSTRUCTOR_MAPS.set(m,new Map([[e,r]]))}),m.sampleRate,void 0,void 0)))}));return void 0===g?l.set(d,new Map([[f,v]])):g.set(f,v),v.then((()=>{let e=h.get(d);void 0===e?h.set(d,new Set([f])):e.add(f)})).finally((()=>{let e=l.get(d);void 0!==e&&e.delete(f)})),v},getValueForKey=(e,t)=>{let r=e.get(t);if(void 0===r)throw new Error("A value with the given key could not be found.");return r},pickElementFromSet=(e,t)=>{let r=Array.from(e).filter(t);if(r.length>1)throw Error("More than one element was found.");if(0===r.length)throw Error("No element was found.");let[n]=r;return e.delete(n),n},deletePassiveInputConnectionToAudioNode=(e,t,r,n)=>{let i=getValueForKey(e,t),s=pickElementFromSet(i,(e=>e[0]===r&&e[1]===n));return 0===i.size&&e.delete(t),s},getEventListenersOfAudioNode=e=>getValueForKey(EVENT_LISTENERS,e),setInternalStateToActive=e=>{if(ACTIVE_AUDIO_NODE_STORE.has(e))throw new Error("The AudioNode is already stored.");ACTIVE_AUDIO_NODE_STORE.add(e),getEventListenersOfAudioNode(e).forEach((e=>e(!0)))},isAudioWorkletNode=e=>"port"in e,setInternalStateToPassive=e=>{if(!ACTIVE_AUDIO_NODE_STORE.has(e))throw new Error("The AudioNode is not stored.");ACTIVE_AUDIO_NODE_STORE.delete(e),getEventListenersOfAudioNode(e).forEach((e=>e(!1)))},setInternalStateToPassiveWhenNecessary=(e,t)=>{!isAudioWorkletNode(e)&&t.every((e=>0===e.size))&&setInternalStateToPassive(e)},createAddConnectionToAudioNode=(e,t,r,n,i,s,o,a,l,h,u,c,d)=>{let f=new WeakMap;return(p,m,_,g,v)=>{let{activeInputs:y,passiveInputs:b}=s(m),{outputs:x}=s(p),S=a(p),T=s=>{let a=l(m),h=l(p);if(s){let t=deletePassiveInputConnectionToAudioNode(b,p,_,g);e(y,p,t,!1),!v&&!c(p)&&r(h,a,_,g),d(m)&&setInternalStateToActive(m)}else{let e=n(y,p,_,g);t(b,g,e,!1),!v&&!c(p)&&i(h,a,_,g);let r=o(m);if(0===r)u(m)&&setInternalStateToPassiveWhenNecessary(m,y);else{let e=f.get(m);void 0!==e&&clearTimeout(e),f.set(m,setTimeout((()=>{u(m)&&setInternalStateToPassiveWhenNecessary(m,y)}),1e3*r))}}};return!!h(x,[m,_,g],(e=>e[0]===m&&e[1]===_&&e[2]===g),!0)&&(S.add(T),u(p)?e(y,p,[_,g,T],!0):t(b,g,[p,_,T],!0),!0)}},createAddPassiveInputConnectionToAudioNode=e=>(t,r,[n,i,s],o)=>{let a=t.get(n);void 0===a?t.set(n,new Set([[i,r,s]])):e(a,[i,r,s],(e=>e[0]===i&&e[1]===r),o)},createAddSilentConnection=e=>(t,r)=>{let n=e(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});r.connect(n).connect(t.destination);let i=()=>{r.removeEventListener("ended",i),r.disconnect(n),n.disconnect()};r.addEventListener("ended",i)},createAddUnrenderedAudioWorkletNode=e=>(t,r)=>{e(t).add(r)},DEFAULT_OPTIONS={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},createAnalyserNodeConstructor=(e,t,r,n,i,s)=>class extends e{constructor(e,r){let o=i(e),a=__spreadValues(__spreadValues({},DEFAULT_OPTIONS),r),l=n(o,a);super(e,!1,l,s(o)?t():null),this._nativeAnalyserNode=l}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(e){this._nativeAnalyserNode.fftSize=e}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(e){let t=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=e,!(e>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=t,r()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(e){let t=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=e,!(this._nativeAnalyserNode.maxDecibels>e))throw this._nativeAnalyserNode.minDecibels=t,r()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(e){this._nativeAnalyserNode.smoothingTimeConstant=e}getByteFrequencyData(e){this._nativeAnalyserNode.getByteFrequencyData(e)}getByteTimeDomainData(e){this._nativeAnalyserNode.getByteTimeDomainData(e)}getFloatFrequencyData(e){this._nativeAnalyserNode.getFloatFrequencyData(e)}getFloatTimeDomainData(e){this._nativeAnalyserNode.getFloatTimeDomainData(e)}},isOwnedByContext=(e,t)=>e.context===t,createAnalyserNodeRendererFactory=(e,t,r)=>()=>{let n=new WeakMap;return{render(i,s,o){let a=n.get(s);return void 0!==a?Promise.resolve(a):(async(i,s,o)=>{let a=t(i);if(!isOwnedByContext(a,s)){let t={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,fftSize:a.fftSize,maxDecibels:a.maxDecibels,minDecibels:a.minDecibels,smoothingTimeConstant:a.smoothingTimeConstant};a=e(s,t)}return n.set(s,a),await r(i,s,a,o),a})(i,s,o)}}},testAudioBufferCopyChannelMethodsOutOfBoundsSupport=e=>{try{e.copyToChannel(new Float32Array(1),0,-1)}catch(e){return!1}return!0},createIndexSizeError=()=>new DOMException("","IndexSizeError"),wrapAudioBufferGetChannelDataMethod=e=>{var t;e.getChannelData=(t=e.getChannelData,r=>{try{return t.call(e,r)}catch(e){throw 12===e.code?createIndexSizeError():e}})},DEFAULT_OPTIONS2={numberOfChannels:1},createAudioBufferConstructor=(e,t,r,n,i,s,o,a)=>{let l=null;return class h{constructor(h){if(null===i)throw new Error("Missing the native OfflineAudioContext constructor.");let{length:u,numberOfChannels:c,sampleRate:d}=__spreadValues(__spreadValues({},DEFAULT_OPTIONS2),h);null===l&&(l=new i(1,1,44100));let f=null!==n&&t(s,s)?new n({length:u,numberOfChannels:c,sampleRate:d}):l.createBuffer(c,u,d);if(0===f.numberOfChannels)throw r();return"function"!=typeof f.copyFromChannel?(o(f),wrapAudioBufferGetChannelDataMethod(f)):t(testAudioBufferCopyChannelMethodsOutOfBoundsSupport,(()=>testAudioBufferCopyChannelMethodsOutOfBoundsSupport(f)))||a(f),e.add(f),f}static[Symbol.hasInstance](t){return null!==t&&"object"==typeof t&&Object.getPrototypeOf(t)===h.prototype||e.has(t)}}},MOST_NEGATIVE_SINGLE_FLOAT=-34028234663852886e22,MOST_POSITIVE_SINGLE_FLOAT=-MOST_NEGATIVE_SINGLE_FLOAT,isActiveAudioNode=e=>ACTIVE_AUDIO_NODE_STORE.has(e),DEFAULT_OPTIONS3={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},createAudioBufferSourceNodeConstructor=(e,t,r,n,i,s,o,a)=>class extends e{constructor(e,n){let a=s(e),l=__spreadValues(__spreadValues({},DEFAULT_OPTIONS3),n),h=i(a,l),u=o(a),c=u?t():null;super(e,!1,h,c),this._audioBufferSourceNodeRenderer=c,this._isBufferNullified=!1,this._isBufferSet=null!==l.buffer,this._nativeAudioBufferSourceNode=h,this._onended=null,this._playbackRate=r(this,u,h.playbackRate,MOST_POSITIVE_SINGLE_FLOAT,MOST_NEGATIVE_SINGLE_FLOAT)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(e){if(this._nativeAudioBufferSourceNode.buffer=e,null!==e){if(this._isBufferSet)throw n();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(e){this._nativeAudioBufferSourceNode.loop=e}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(e){this._nativeAudioBufferSourceNode.loopEnd=e}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(e){this._nativeAudioBufferSourceNode.loopStart=e}get onended(){return this._onended}set onended(e){let t="function"==typeof e?a(this,e):null;this._nativeAudioBufferSourceNode.onended=t;let r=this._nativeAudioBufferSourceNode.onended;this._onended=null!==r&&r===t?e:r}get playbackRate(){return this._playbackRate}start(e=0,t=0,r){if(this._nativeAudioBufferSourceNode.start(e,t,r),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.start=void 0===r?[e,t]:[e,t,r]),"closed"!==this.context.state){setInternalStateToActive(this);let e=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",e),isActiveAudioNode(this)&&setInternalStateToPassive(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",e)}}stop(e=0){this._nativeAudioBufferSourceNode.stop(e),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.stop=e)}},createAudioBufferSourceNodeRendererFactory=(e,t,r,n,i)=>()=>{let s=new WeakMap,o=null,a=null;return{set start(e){o=e},set stop(e){a=e},render(l,h,u){let c=s.get(h);return void 0!==c?Promise.resolve(c):(async(l,h,u)=>{let c=r(l),d=isOwnedByContext(c,h);if(!d){let e={buffer:c.buffer,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,loop:c.loop,loopEnd:c.loopEnd,loopStart:c.loopStart,playbackRate:c.playbackRate.value};c=t(h,e),null!==o&&c.start(...o),null!==a&&c.stop(a)}return s.set(h,c),d?await e(h,l.playbackRate,c.playbackRate,u):await n(h,l.playbackRate,c.playbackRate,u),await i(l,h,c,u),c})(l,h,u)}}},isAudioBufferSourceNode=e=>"playbackRate"in e,isBiquadFilterNode=e=>"frequency"in e&&"gain"in e,isConstantSourceNode=e=>"offset"in e,isGainNode=e=>!("frequency"in e)&&"gain"in e,isOscillatorNode=e=>"detune"in e&&"frequency"in e,isStereoPannerNode=e=>"pan"in e,getAudioNodeConnections=e=>getValueForKey(AUDIO_NODE_CONNECTIONS_STORE,e),getAudioParamConnections=e=>getValueForKey(AUDIO_PARAM_CONNECTIONS_STORE,e),deactivateActiveAudioNodeInputConnections=(e,t)=>{let{activeInputs:r}=getAudioNodeConnections(e);r.forEach((r=>r.forEach((([r])=>{t.includes(e)||deactivateActiveAudioNodeInputConnections(r,[...t,e])}))));let n=isAudioBufferSourceNode(e)?[e.playbackRate]:isAudioWorkletNode(e)?Array.from(e.parameters.values()):isBiquadFilterNode(e)?[e.Q,e.detune,e.frequency,e.gain]:isConstantSourceNode(e)?[e.offset]:isGainNode(e)?[e.gain]:isOscillatorNode(e)?[e.detune,e.frequency]:isStereoPannerNode(e)?[e.pan]:[];for(let e of n){let r=getAudioParamConnections(e);void 0!==r&&r.activeInputs.forEach((([e])=>deactivateActiveAudioNodeInputConnections(e,t)))}isActiveAudioNode(e)&&setInternalStateToPassive(e)},deactivateAudioGraph=e=>{deactivateActiveAudioNodeInputConnections(e.destination,[])},isValidLatencyHint=e=>void 0===e||"number"==typeof e||"string"==typeof e&&("balanced"===e||"interactive"===e||"playback"===e),createAudioContextConstructor=(e,t,r,n,i,s,o,a,l)=>class extends e{constructor(e={}){if(null===l)throw new Error("Missing the native AudioContext constructor.");let t;try{t=new l(e)}catch(e){throw 12===e.code&&"sampleRate is not in range"===e.message?r():e}if(null===t)throw n();if(!isValidLatencyHint(e.latencyHint))throw new TypeError(`The provided value '${e.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(void 0!==e.sampleRate&&t.sampleRate!==e.sampleRate)throw r();super(t,2);let{latencyHint:i}=e,{sampleRate:s}=t;if(this._baseLatency="number"==typeof t.baseLatency?t.baseLatency:"balanced"===i?512/s:"interactive"===i||void 0===i?256/s:"playback"===i?1024/s:128*Math.max(2,Math.min(128,Math.round(i*s/128)))/s,this._nativeAudioContext=t,"webkitAudioContext"===l.name?(this._nativeGainNode=t.createGain(),this._nativeOscillatorNode=t.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(t.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,"running"===t.state){this._state="suspended";let e=()=>{"suspended"===this._state&&(this._state=null),t.removeEventListener("statechange",e)};t.addEventListener("statechange",e)}}get baseLatency(){return this._baseLatency}get state(){return null!==this._state?this._state:this._nativeAudioContext.state}close(){return"closed"===this.state?this._nativeAudioContext.close().then((()=>{throw t()})):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then((()=>{null!==this._nativeGainNode&&null!==this._nativeOscillatorNode&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),deactivateAudioGraph(this)})))}createMediaElementSource(e){return new i(this,{mediaElement:e})}createMediaStreamDestination(){return new s(this)}createMediaStreamSource(e){return new o(this,{mediaStream:e})}createMediaStreamTrackSource(e){return new a(this,{mediaStreamTrack:e})}resume(){return"suspended"===this._state?new Promise(((e,t)=>{let r=()=>{this._nativeAudioContext.removeEventListener("statechange",r),"running"===this._nativeAudioContext.state?e():this.resume().then(e,t)};this._nativeAudioContext.addEventListener("statechange",r)})):this._nativeAudioContext.resume().catch((e=>{throw void 0===e||15===e.code?t():e}))}suspend(){return this._nativeAudioContext.suspend().catch((e=>{throw void 0===e?t():e}))}},createAudioDestinationNodeConstructor=(e,t,r,n,i,s,o,a)=>class extends e{constructor(e,r){let n=s(e),l=o(n),h=i(n,r,l);super(e,!1,h,l?t(a):null),this._isNodeOfNativeOfflineAudioContext=l,this._nativeAudioDestinationNode=h}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(e){if(this._isNodeOfNativeOfflineAudioContext)throw n();if(e>this._nativeAudioDestinationNode.maxChannelCount)throw r();this._nativeAudioDestinationNode.channelCount=e}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(e){if(this._isNodeOfNativeOfflineAudioContext)throw n();this._nativeAudioDestinationNode.channelCountMode=e}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},createAudioDestinationNodeRenderer=e=>{let t=null;return{render:(r,n,i)=>(null===t&&(t=(async(t,r,n)=>{let i=r.destination;return await e(t,r,i,n),i})(r,n,i)),t)}},createAudioListenerFactory=(e,t,r,n,i)=>(s,o)=>{let a=o.listener,{forwardX:l,forwardY:h,forwardZ:u,positionX:c,positionY:d,positionZ:f,upX:p,upY:m,upZ:_}=void 0===a.forwardX?(()=>{let l=t(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),h=i(o),u=n(o,256,9,0),c=(t,n)=>{let i=r(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:n});return i.connect(l,0,t),i.start(),Object.defineProperty(i.offset,"defaultValue",{get:()=>n}),e({context:s},h,i.offset,MOST_POSITIVE_SINGLE_FLOAT,MOST_NEGATIVE_SINGLE_FLOAT)},d=[0,0,-1,0,1,0],f=[0,0,0];return u.onaudioprocess=({inputBuffer:e})=>{let t=[e.getChannelData(0)[0],e.getChannelData(1)[0],e.getChannelData(2)[0],e.getChannelData(3)[0],e.getChannelData(4)[0],e.getChannelData(5)[0]];t.some(((e,t)=>e!==d[t]))&&(a.setOrientation(...t),d=t);let r=[e.getChannelData(6)[0],e.getChannelData(7)[0],e.getChannelData(8)[0]];r.some(((e,t)=>e!==f[t]))&&(a.setPosition(...r),f=r)},l.connect(u),{forwardX:c(0,0),forwardY:c(1,0),forwardZ:c(2,-1),positionX:c(6,0),positionY:c(7,0),positionZ:c(8,0),upX:c(3,0),upY:c(4,1),upZ:c(5,0)}})():a;return{get forwardX(){return l},get forwardY(){return h},get forwardZ(){return u},get positionX(){return c},get positionY(){return d},get positionZ(){return f},get upX(){return p},get upY(){return m},get upZ(){return _}}},isAudioNode=e=>"context"in e,isAudioNodeOutputConnection=e=>isAudioNode(e[0]),insertElementInSet=(e,t,r,n)=>{for(let t of e)if(r(t)){if(n)return!1;throw Error("The set contains at least one similar element.")}return e.add(t),!0},addActiveInputConnectionToAudioParam=(e,t,[r,n],i)=>{insertElementInSet(e,[t,r,n],(e=>e[0]===t&&e[1]===r),i)},addPassiveInputConnectionToAudioParam=(e,[t,r,n],i)=>{let s=e.get(t);void 0===s?e.set(t,new Set([[r,n]])):insertElementInSet(s,[r,n],(e=>e[0]===r),i)},isNativeAudioNodeFaker=e=>"inputs"in e,connectNativeAudioNodeToNativeAudioNode=(e,t,r,n)=>{if(isNativeAudioNodeFaker(t)){let i=t.inputs[n];return e.connect(i,r,0),[i,r,0]}return e.connect(t,r,n),[t,r,n]},deleteActiveInputConnection=(e,t,r)=>{for(let n of e)if(n[0]===t&&n[1]===r)return e.delete(n),n;return null},deleteActiveInputConnectionToAudioParam=(e,t,r)=>pickElementFromSet(e,(e=>e[0]===t&&e[1]===r)),deleteEventListenerOfAudioNode=(e,t)=>{if(!getEventListenersOfAudioNode(e).delete(t))throw new Error("Missing the expected event listener.")},deletePassiveInputConnectionToAudioParam=(e,t,r)=>{let n=getValueForKey(e,t),i=pickElementFromSet(n,(e=>e[0]===r));return 0===n.size&&e.delete(t),i},disconnectNativeAudioNodeFromNativeAudioNode=(e,t,r,n)=>{isNativeAudioNodeFaker(t)?e.disconnect(t.inputs[n],r,0):e.disconnect(t,r,n)},getNativeAudioNode=e=>getValueForKey(AUDIO_NODE_STORE,e),getNativeAudioParam=e=>getValueForKey(AUDIO_PARAM_STORE,e),isPartOfACycle=e=>CYCLE_COUNTERS.has(e),isPassiveAudioNode=e=>!ACTIVE_AUDIO_NODE_STORE.has(e),testAudioNodeDisconnectMethodSupport=e=>new Promise((t=>{let r=e.createScriptProcessor(256,1,1),n=e.createGain(),i=e.createBuffer(1,2,44100),s=i.getChannelData(0);s[0]=1,s[1]=1;let o=e.createBufferSource();o.buffer=i,o.loop=!0,o.connect(r).connect(e.destination),o.connect(n),o.disconnect(n),r.onaudioprocess=n=>{let i=n.inputBuffer.getChannelData(0);Array.prototype.some.call(i,(e=>1===e))?t(!0):t(!1),o.stop(),r.onaudioprocess=null,o.disconnect(r),r.disconnect(e.destination)},o.start()})),visitEachAudioNodeOnce=(e,t)=>{let r=new Map;for(let t of e)for(let e of t){let t=r.get(e);r.set(e,void 0===t?1:t+1)}r.forEach(((e,r)=>t(r,e)))},isNativeAudioNode=e=>"context"in e,wrapAudioNodeDisconnectMethod=e=>{let t=new Map;var r,n;e.connect=(n=e.connect.bind(e),(e,r=0,i=0)=>{let s=isNativeAudioNode(e)?n(e,r,i):n(e,r),o=t.get(e);return void 0===o?t.set(e,[{input:i,output:r}]):o.every((e=>e.input!==i||e.output!==r))&&o.push({input:i,output:r}),s}),e.disconnect=(r=e.disconnect,(n,i,s)=>{if(r.apply(e),void 0===n)t.clear();else if("number"==typeof n)for(let[e,r]of t){let i=r.filter((e=>e.output!==n));0===i.length?t.delete(e):t.set(e,i)}else if(t.has(n))if(void 0===i)t.delete(n);else{let e=t.get(n);if(void 0!==e){let r=e.filter((e=>e.output!==i&&(e.input!==s||void 0===s)));0===r.length?t.delete(n):t.set(n,r)}}for(let[r,n]of t)n.forEach((t=>{isNativeAudioNode(r)?e.connect(r,t.output,t.input):e.connect(r,t.output)}))})},addConnectionToAudioParamOfAudioContext=(e,t,r,n)=>{let{activeInputs:i,passiveInputs:s}=getAudioParamConnections(t),{outputs:o}=getAudioNodeConnections(e),a=getEventListenersOfAudioNode(e),l=o=>{let a=getNativeAudioNode(e),l=getNativeAudioParam(t);if(o){let t=deletePassiveInputConnectionToAudioParam(s,e,r);addActiveInputConnectionToAudioParam(i,e,t,!1),!n&&!isPartOfACycle(e)&&a.connect(l,r)}else{let t=deleteActiveInputConnectionToAudioParam(i,e,r);addPassiveInputConnectionToAudioParam(s,t,!1),!n&&!isPartOfACycle(e)&&a.disconnect(l,r)}};return!!insertElementInSet(o,[t,r],(e=>e[0]===t&&e[1]===r),!0)&&(a.add(l),isActiveAudioNode(e)?addActiveInputConnectionToAudioParam(i,e,[r,l],!0):addPassiveInputConnectionToAudioParam(s,[e,r,l],!0),!0)},deleteInputConnectionOfAudioNode=(e,t,r,n)=>{let{activeInputs:i,passiveInputs:s}=getAudioNodeConnections(t),o=deleteActiveInputConnection(i[n],e,r);return null===o?[deletePassiveInputConnectionToAudioNode(s,e,r,n)[2],!1]:[o[2],!0]},deleteInputConnectionOfAudioParam=(e,t,r)=>{let{activeInputs:n,passiveInputs:i}=getAudioParamConnections(t),s=deleteActiveInputConnection(n,e,r);return null===s?[deletePassiveInputConnectionToAudioParam(i,e,r)[1],!1]:[s[2],!0]},deleteInputsOfAudioNode=(e,t,r,n,i)=>{let[s,o]=deleteInputConnectionOfAudioNode(e,r,n,i);if(null!==s&&(deleteEventListenerOfAudioNode(e,s),o&&!t&&!isPartOfACycle(e)&&disconnectNativeAudioNodeFromNativeAudioNode(getNativeAudioNode(e),getNativeAudioNode(r),n,i)),isActiveAudioNode(r)){let{activeInputs:e}=getAudioNodeConnections(r);setInternalStateToPassiveWhenNecessary(r,e)}},deleteInputsOfAudioParam=(e,t,r,n)=>{let[i,s]=deleteInputConnectionOfAudioParam(e,r,n);null!==i&&(deleteEventListenerOfAudioNode(e,i),s&&!t&&!isPartOfACycle(e)&&getNativeAudioNode(e).disconnect(getNativeAudioParam(r),n))},deleteAnyConnection=(e,t)=>{let r=getAudioNodeConnections(e),n=[];for(let i of r.outputs)isAudioNodeOutputConnection(i)?deleteInputsOfAudioNode(e,t,...i):deleteInputsOfAudioParam(e,t,...i),n.push(i[0]);return r.outputs.clear(),n},deleteConnectionAtOutput=(e,t,r)=>{let n=getAudioNodeConnections(e),i=[];for(let s of n.outputs)s[1]===r&&(isAudioNodeOutputConnection(s)?deleteInputsOfAudioNode(e,t,...s):deleteInputsOfAudioParam(e,t,...s),i.push(s[0]),n.outputs.delete(s));return i},deleteConnectionToDestination=(e,t,r,n,i)=>{let s=getAudioNodeConnections(e);return Array.from(s.outputs).filter((e=>!(e[0]!==r||void 0!==n&&e[1]!==n||void 0!==i&&e[2]!==i))).map((r=>(isAudioNodeOutputConnection(r)?deleteInputsOfAudioNode(e,t,...r):deleteInputsOfAudioParam(e,t,...r),s.outputs.delete(r),r[0])))},createAudioNodeConstructor=(e,t,r,n,i,s,o,a,l,h,u,c,d,f,p)=>class extends h{constructor(t,n,i,s){super(i),this._context=t,this._nativeAudioNode=i;let o=u(t);c(o)&&!0!==r(testAudioNodeDisconnectMethodSupport,(()=>testAudioNodeDisconnectMethodSupport(o)))&&wrapAudioNodeDisconnectMethod(i),AUDIO_NODE_STORE.set(this,i),EVENT_LISTENERS.set(this,new Set),"closed"!==t.state&&n&&setInternalStateToActive(this),e(this,s,i)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(e){this._nativeAudioNode.channelCount=e}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(e){this._nativeAudioNode.channelCountMode=e}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(e){this._nativeAudioNode.channelInterpretation=e}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(e,r=0,a=0){if(r<0||r>=this._nativeAudioNode.numberOfOutputs)throw i();let h=u(this._context),c=p(h);if(d(e)||f(e))throw s();if(isAudioNode(e)){let i=getNativeAudioNode(e);try{let t=connectNativeAudioNodeToNativeAudioNode(this._nativeAudioNode,i,r,a),n=isPassiveAudioNode(this);(c||n)&&this._nativeAudioNode.disconnect(...t),"closed"!==this.context.state&&!n&&isPassiveAudioNode(e)&&setInternalStateToActive(e)}catch(e){throw 12===e.code?s():e}if(t(this,e,r,a,c)){let t=l([this],e);visitEachAudioNodeOnce(t,n(c))}return e}let m=getNativeAudioParam(e);if("playbackRate"===m.name&&1024===m.maxValue)throw o();try{this._nativeAudioNode.connect(m,r),(c||isPassiveAudioNode(this))&&this._nativeAudioNode.disconnect(m,r)}catch(e){throw 12===e.code?s():e}if(addConnectionToAudioParamOfAudioContext(this,e,r,c)){let t=l([this],e);visitEachAudioNodeOnce(t,n(c))}}disconnect(e,t,r){let n,o=u(this._context),h=p(o);if(void 0===e)n=deleteAnyConnection(this,h);else if("number"==typeof e){if(e<0||e>=this.numberOfOutputs)throw i();n=deleteConnectionAtOutput(this,h,e)}else{if(void 0!==t&&(t<0||t>=this.numberOfOutputs)||isAudioNode(e)&&void 0!==r&&(r<0||r>=e.numberOfInputs))throw i();if(n=deleteConnectionToDestination(this,h,e,t,r),0===n.length)throw s()}for(let e of n){let t=l([this],e);visitEachAudioNodeOnce(t,a)}}},import_automation_events=__toModule(require_bundle()),createAudioParamFactory=(e,t,r,n,i,s,o,a,l,h,u,c,d)=>(f,p,m,_=null,g=null)=>{let v=new import_automation_events.AutomationEventList(m.defaultValue),y=p?n(v):null,b={get defaultValue(){return m.defaultValue},get maxValue(){return null===_?m.maxValue:_},get minValue(){return null===g?m.minValue:g},get value(){return m.value},set value(e){m.value=e,b.setValueAtTime(e,f.context.currentTime)},cancelAndHoldAtTime(e){if("function"==typeof m.cancelAndHoldAtTime)null===y&&v.flush(f.context.currentTime),v.add(i(e)),m.cancelAndHoldAtTime(e);else{let t=Array.from(v).pop();null===y&&v.flush(f.context.currentTime),v.add(i(e));let r=Array.from(v).pop();m.cancelScheduledValues(e),t!==r&&void 0!==r&&("exponentialRampToValue"===r.type?m.exponentialRampToValueAtTime(r.value,r.endTime):"linearRampToValue"===r.type?m.linearRampToValueAtTime(r.value,r.endTime):"setValue"===r.type?m.setValueAtTime(r.value,r.startTime):"setValueCurve"===r.type&&m.setValueCurveAtTime(r.values,r.startTime,r.duration))}return b},cancelScheduledValues:e=>(null===y&&v.flush(f.context.currentTime),v.add(s(e)),m.cancelScheduledValues(e),b),exponentialRampToValueAtTime(e,t){if(0===e)throw new RangeError;if(!Number.isFinite(t)||t<0)throw new RangeError;return null===y&&v.flush(f.context.currentTime),v.add(o(e,t)),m.exponentialRampToValueAtTime(e,t),b},linearRampToValueAtTime:(e,t)=>(null===y&&v.flush(f.context.currentTime),v.add(a(e,t)),m.linearRampToValueAtTime(e,t),b),setTargetAtTime:(e,t,r)=>(null===y&&v.flush(f.context.currentTime),v.add(l(e,t,r)),m.setTargetAtTime(e,t,r),b),setValueAtTime:(e,t)=>(null===y&&v.flush(f.context.currentTime),v.add(h(e,t)),m.setValueAtTime(e,t),b),setValueCurveAtTime(e,t,r){let n=e instanceof Float32Array?e:new Float32Array(e);if(null!==c&&"webkitAudioContext"===c.name){let e=t+r,i=f.context.sampleRate,s=Math.ceil(t*i),o=Math.floor(e*i),a=o-s,l=new Float32Array(a);for(let e=0;e<a;e+=1){let o=(n.length-1)/r*((s+e)/i-t),a=Math.floor(o),h=Math.ceil(o);l[e]=a===h?n[a]:(1-(o-a))*n[a]+(1-(h-o))*n[h]}null===y&&v.flush(f.context.currentTime),v.add(u(l,t,r)),m.setValueCurveAtTime(l,t,r);let h=o/i;h<e&&d(b,l[l.length-1],h),d(b,n[n.length-1],e)}else null===y&&v.flush(f.context.currentTime),v.add(u(n,t,r)),m.setValueCurveAtTime(n,t,r);return b}};return r.set(b,m),t.set(b,f),e(b,y),b},createAudioParamRenderer=e=>({replay(t){for(let r of e)if("exponentialRampToValue"===r.type){let{endTime:e,value:n}=r;t.exponentialRampToValueAtTime(n,e)}else if("linearRampToValue"===r.type){let{endTime:e,value:n}=r;t.linearRampToValueAtTime(n,e)}else if("setTarget"===r.type){let{startTime:e,target:n,timeConstant:i}=r;t.setTargetAtTime(n,e,i)}else if("setValue"===r.type){let{startTime:e,value:n}=r;t.setValueAtTime(n,e)}else{if("setValueCurve"!==r.type)throw new Error("Can't apply an unknown automation.");{let{duration:e,startTime:n,values:i}=r;t.setValueCurveAtTime(i,n,e)}}}}),ReadOnlyMap=class{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,t=null){return this._map.forEach(((r,n)=>e.call(t,r,n,this)))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}},DEFAULT_OPTIONS4={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},createAudioWorkletNodeConstructor=(e,t,r,n,i,s,o,a,l,h,u,c,d,f)=>class extends t{constructor(t,f,p){var m;let _=a(t),g=l(_),v=u(__spreadValues(__spreadValues({},DEFAULT_OPTIONS4),p));d(v);let y=NODE_NAME_TO_PROCESSOR_CONSTRUCTOR_MAPS.get(_),b=null==y?void 0:y.get(f),x=g||"closed"!==_.state?_:null!==(m=o(_))&&void 0!==m?m:_,S=i(x,g?null:t.baseLatency,h,f,b,v);super(t,!0,S,g?n(f,v,b):null);let T=[];S.parameters.forEach(((e,t)=>{let n=r(this,g,e);T.push([t,n])})),this._nativeAudioWorkletNode=S,this._onprocessorerror=null,this._parameters=new ReadOnlyMap(T),g&&e(_,this);let{activeInputs:E}=s(this);c(S,E)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(e){let t="function"==typeof e?f(this,e):null;this._nativeAudioWorkletNode.onprocessorerror=t;let r=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=null!==r&&r===t?e:r}get parameters(){return null===this._parameters?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function copyFromChannel(e,t,r,n,i){if("function"==typeof e.copyFromChannel)0===t[r].byteLength&&(t[r]=new Float32Array(128)),e.copyFromChannel(t[r],n,i);else{let s=e.getChannelData(n);if(0===t[r].byteLength)t[r]=s.slice(i,i+128);else{let e=new Float32Array(s.buffer,i*Float32Array.BYTES_PER_ELEMENT,128);t[r].set(e)}}}var copyToChannel=(e,t,r,n,i)=>{"function"==typeof e.copyToChannel?0!==t[r].byteLength&&e.copyToChannel(t[r],n,i):0!==t[r].byteLength&&e.getChannelData(n).set(t[r],i)},createNestedArrays=(e,t)=>{let r=[];for(let n=0;n<e;n+=1){let e=[],i="number"==typeof t?t:t[n];for(let t=0;t<i;t+=1)e.push(new Float32Array(128));r.push(e)}return r},getAudioWorkletProcessor=(e,t)=>{let r=getValueForKey(NODE_TO_PROCESSOR_MAPS,e),n=getNativeAudioNode(t);return getValueForKey(r,n)},processBuffer=async(e,t,r,n,i,s,o)=>{let a=null===t?128*Math.ceil(e.context.length/128):t.length,l=n.channelCount*n.numberOfInputs,h=i.reduce(((e,t)=>e+t),0),u=0===h?null:r.createBuffer(h,a,r.sampleRate);if(void 0===s)throw new Error("Missing the processor constructor.");let c=getAudioNodeConnections(e),d=await getAudioWorkletProcessor(r,e),f=createNestedArrays(n.numberOfInputs,n.channelCount),p=createNestedArrays(n.numberOfOutputs,i),m=Array.from(e.parameters.keys()).reduce(((e,t)=>__spreadProps(__spreadValues({},e),{[t]:new Float32Array(128)})),{});for(let h=0;h<a;h+=128){if(n.numberOfInputs>0&&null!==t)for(let e=0;e<n.numberOfInputs;e+=1)for(let r=0;r<n.channelCount;r+=1)copyFromChannel(t,f[e],r,r,h);void 0!==s.parameterDescriptors&&null!==t&&s.parameterDescriptors.forEach((({name:e},r)=>{copyFromChannel(t,m,e,l+r,h)}));for(let e=0;e<n.numberOfInputs;e+=1)for(let t=0;t<i[e];t+=1)0===p[e][t].byteLength&&(p[e][t]=new Float32Array(128));try{let e=f.map(((e,t)=>0===c.activeInputs[t].size?[]:e)),t=o(h/r.sampleRate,r.sampleRate,(()=>d.process(e,p,m)));if(null!==u)for(let e=0,t=0;e<n.numberOfOutputs;e+=1){for(let r=0;r<i[e];r+=1)copyToChannel(u,p[e],r,t+r,h);t+=i[e]}if(!t)break}catch(t){e.dispatchEvent(new ErrorEvent("processorerror",{colno:t.colno,filename:t.filename,lineno:t.lineno,message:t.message}));break}}return u},createAudioWorkletNodeRendererFactory=(e,t,r,n,i,s,o,a,l,h,u,c,d,f,p,m)=>(_,g,v)=>{let y=new WeakMap,b=null;return{render(x,S,T){a(S,x);let E=y.get(S);return void 0!==E?Promise.resolve(E):(async(a,x,S)=>{let T=u(a),E=null,A=isOwnedByContext(T,x),w=Array.isArray(g.outputChannelCount)?g.outputChannelCount:Array.from(g.outputChannelCount);if(null===c){let e=w.reduce(((e,t)=>e+t),0),r=i(x,{channelCount:Math.max(1,e),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,e)}),s=[];for(let e=0;e<a.numberOfOutputs;e+=1)s.push(n(x,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:w[e]}));let h=o(x,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1});h.connect=t.bind(null,s),h.disconnect=l.bind(null,s),E=[r,s,h]}else A||(T=new c(x,_));if(y.set(x,null===E?T:E[2]),null!==E){if(null===b){if(void 0===v)throw new Error("Missing the processor constructor.");if(null===d)throw new Error("Missing the native OfflineAudioContext constructor.");let e=a.channelCount*a.numberOfInputs,t=void 0===v.parameterDescriptors?0:v.parameterDescriptors.length,r=e+t;b=processBuffer(a,0===r?null:await(async()=>{let l=new d(r,128*Math.ceil(a.context.length/128),x.sampleRate),h=[],u=[];for(let e=0;e<g.numberOfInputs;e+=1)h.push(o(l,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})),u.push(i(l,{channelCount:g.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:g.channelCount}));let c=await Promise.all(Array.from(a.parameters.values()).map((async e=>{let t=s(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:e.value});return await f(l,e,t.offset,S),t}))),_=n(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,e+t)});for(let e=0;e<g.numberOfInputs;e+=1){h[e].connect(u[e]);for(let t=0;t<g.channelCount;t+=1)u[e].connect(_,t,e*g.channelCount+t)}for(let[t,r]of c.entries())r.connect(_,0,e+t),r.start(0);return _.connect(l.destination),await Promise.all(h.map((e=>p(a,l,e,S)))),m(l)})(),x,g,w,v,h)}let e=await b,t=r(x,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[l,u,c]=E;null!==e&&(t.buffer=e,t.start(0)),t.connect(l);for(let e=0,t=0;e<a.numberOfOutputs;e+=1){let r=u[e];for(let n=0;n<w[e];n+=1)l.connect(r,t+n,n);t+=w[e]}return c}if(A)for(let[t,r]of a.parameters.entries())await e(x,r,T.parameters.get(t),S);else for(let[e,t]of a.parameters.entries())await f(x,t,T.parameters.get(e),S);return await p(a,x,T,S),T})(x,S,T)}}},createBaseAudioContextConstructor=(e,t,r,n,i,s,o,a,l,h,u,c,d,f,p,m,_,g,v,y)=>class extends p{constructor(t,r){super(t,r),this._nativeContext=t,this._audioWorklet=void 0===e?void 0:{addModule:(t,r)=>e(this,t,r)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new t(this)}createBiquadFilter(){return new i(this)}createBuffer(e,t,n){return new r({length:t,numberOfChannels:e,sampleRate:n})}createBufferSource(){return new n(this)}createChannelMerger(e=6){return new s(this,{numberOfInputs:e})}createChannelSplitter(e=6){return new o(this,{numberOfOutputs:e})}createConstantSource(){return new a(this)}createConvolver(){return new l(this)}createDelay(e=1){return new u(this,{maxDelayTime:e})}createDynamicsCompressor(){return new c(this)}createGain(){return new d(this)}createIIRFilter(e,t){return new f(this,{feedback:t,feedforward:e})}createOscillator(){return new m(this)}createPanner(){return new _(this)}createPeriodicWave(e,t,r={disableNormalization:!1}){return new g(this,__spreadProps(__spreadValues({},r),{imag:t,real:e}))}createStereoPanner(){return new v(this)}createWaveShaper(){return new y(this)}decodeAudioData(e,t,r){return h(this._nativeContext,e).then((e=>("function"==typeof t&&t(e),e)),(e=>{throw"function"==typeof r&&r(e),e}))}},DEFAULT_OPTIONS5={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},createBiquadFilterNodeConstructor=(e,t,r,n,i,s,o,a)=>class extends e{constructor(e,n){let l=s(e),h=__spreadValues(__spreadValues({},DEFAULT_OPTIONS5),n),u=i(l,h),c=o(l);super(e,!1,u,c?r():null),this._Q=t(this,c,u.Q,MOST_POSITIVE_SINGLE_FLOAT,MOST_NEGATIVE_SINGLE_FLOAT),this._detune=t(this,c,u.detune,1200*Math.log2(MOST_POSITIVE_SINGLE_FLOAT),-1200*Math.log2(MOST_POSITIVE_SINGLE_FLOAT)),this._frequency=t(this,c,u.frequency,e.sampleRate/2,0),this._gain=t(this,c,u.gain,40*Math.log10(MOST_POSITIVE_SINGLE_FLOAT),MOST_NEGATIVE_SINGLE_FLOAT),this._nativeBiquadFilterNode=u,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(e){this._nativeBiquadFilterNode.type=e}getFrequencyResponse(e,t,r){try{this._nativeBiquadFilterNode.getFrequencyResponse(e,t,r)}catch(e){throw 11===e.code?n():e}if(e.length!==t.length||t.length!==r.length)throw n()}},createBiquadFilterNodeRendererFactory=(e,t,r,n,i)=>()=>{let s=new WeakMap;return{render(o,a,l){let h=s.get(a);return void 0!==h?Promise.resolve(h):(async(o,a,l)=>{let h=r(o),u=isOwnedByContext(h,a);if(!u){let e={Q:h.Q.value,channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,detune:h.detune.value,frequency:h.frequency.value,gain:h.gain.value,type:h.type};h=t(a,e)}return s.set(a,h),u?(await e(a,o.Q,h.Q,l),await e(a,o.detune,h.detune,l),await e(a,o.frequency,h.frequency,l),await e(a,o.gain,h.gain,l)):(await n(a,o.Q,h.Q,l),await n(a,o.detune,h.detune,l),await n(a,o.frequency,h.frequency,l),await n(a,o.gain,h.gain,l)),await i(o,a,h,l),h})(o,a,l)}}},createCacheTestResult=(e,t)=>(r,n)=>{let i=t.get(r);if(void 0!==i)return i;let s=e.get(r);if(void 0!==s)return s;try{let i=n();return i instanceof Promise?(e.set(r,i),i.catch((()=>!1)).then((n=>(e.delete(r),t.set(r,n),n)))):(t.set(r,i),i)}catch(e){return t.set(r,!1),!1}},DEFAULT_OPTIONS6={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},createChannelMergerNodeConstructor=(e,t,r,n,i)=>class extends e{constructor(e,s){let o=n(e),a=__spreadValues(__spreadValues({},DEFAULT_OPTIONS6),s);super(e,!1,r(o,a),i(o)?t():null)}},createChannelMergerNodeRendererFactory=(e,t,r)=>()=>{let n=new WeakMap;return{render(i,s,o){let a=n.get(s);return void 0!==a?Promise.resolve(a):(async(i,s,o)=>{let a=t(i);if(!isOwnedByContext(a,s)){let t={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=e(s,t)}return n.set(s,a),await r(i,s,a,o),a})(i,s,o)}}},DEFAULT_OPTIONS7={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},createChannelSplitterNodeConstructor=(e,t,r,n,i,s)=>class extends e{constructor(e,o){let a=n(e),l=s(__spreadValues(__spreadValues({},DEFAULT_OPTIONS7),o));super(e,!1,r(a,l),i(a)?t():null)}},createChannelSplitterNodeRendererFactory=(e,t,r)=>()=>{let n=new WeakMap;return{render(i,s,o){let a=n.get(s);return void 0!==a?Promise.resolve(a):(async(i,s,o)=>{let a=t(i);if(!isOwnedByContext(a,s)){let t={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=e(s,t)}return n.set(s,a),await r(i,s,a,o),a})(i,s,o)}}},createConnectAudioParam=e=>(t,r,n,i)=>e(r,t,n,i),createConnectMultipleOutputs=e=>(t,r,n=0,i=0)=>{let s=t[n];if(void 0===s)throw e();return isNativeAudioNode(r)?s.connect(r,0,i):s.connect(r,0)},createConnectedNativeAudioBufferSourceNodeFactory=e=>(t,r)=>{let n=e(t,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=t.createBuffer(1,2,44100);return n.buffer=i,n.loop=!0,n.connect(r),n.start(),()=>{n.stop(),n.disconnect(r)}},DEFAULT_OPTIONS8={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},createConstantSourceNodeConstructor=(e,t,r,n,i,s,o)=>class extends e{constructor(e,o){let a=i(e),l=__spreadValues(__spreadValues({},DEFAULT_OPTIONS8),o),h=n(a,l),u=s(a),c=u?r():null;super(e,!1,h,c),this._constantSourceNodeRenderer=c,this._nativeConstantSourceNode=h,this._offset=t(this,u,h.offset,MOST_POSITIVE_SINGLE_FLOAT,MOST_NEGATIVE_SINGLE_FLOAT),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(e){let t="function"==typeof e?o(this,e):null;this._nativeConstantSourceNode.onended=t;let r=this._nativeConstantSourceNode.onended;this._onended=null!==r&&r===t?e:r}start(e=0){if(this._nativeConstantSourceNode.start(e),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.start=e),"closed"!==this.context.state){setInternalStateToActive(this);let e=()=>{this._nativeConstantSourceNode.removeEventListener("ended",e),isActiveAudioNode(this)&&setInternalStateToPassive(this)};this._nativeConstantSourceNode.addEventListener("ended",e)}}stop(e=0){this._nativeConstantSourceNode.stop(e),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.stop=e)}},createConstantSourceNodeRendererFactory=(e,t,r,n,i)=>()=>{let s=new WeakMap,o=null,a=null;return{set start(e){o=e},set stop(e){a=e},render(l,h,u){let c=s.get(h);return void 0!==c?Promise.resolve(c):(async(l,h,u)=>{let c=r(l),d=isOwnedByContext(c,h);if(!d){let e={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,offset:c.offset.value};c=t(h,e),null!==o&&c.start(o),null!==a&&c.stop(a)}return s.set(h,c),d?await e(h,l.offset,c.offset,u):await n(h,l.offset,c.offset,u),await i(l,h,c,u),c})(l,h,u)}}},createConvertNumberToUnsignedLong=e=>t=>(e[0]=t,e[0]),DEFAULT_OPTIONS9={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},createConvolverNodeConstructor=(e,t,r,n,i,s)=>class extends e{constructor(e,o){let a=n(e),l=__spreadValues(__spreadValues({},DEFAULT_OPTIONS9),o),h=r(a,l);super(e,!1,h,i(a)?t():null),this._isBufferNullified=!1,this._nativeConvolverNode=h,null!==l.buffer&&s(this,l.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(e){if(this._nativeConvolverNode.buffer=e,null===e&&null!==this._nativeConvolverNode.buffer){let e=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=e.createBuffer(1,1,44100),this._isBufferNullified=!0,s(this,0)}else this._isBufferNullified=!1,s(this,null===this._nativeConvolverNode.buffer?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(e){this._nativeConvolverNode.normalize=e}},createConvolverNodeRendererFactory=(e,t,r)=>()=>{let n=new WeakMap;return{render(i,s,o){let a=n.get(s);return void 0!==a?Promise.resolve(a):(async(i,s,o)=>{let a=t(i);if(!isOwnedByContext(a,s)){let t={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=e(s,t)}return n.set(s,a),isNativeAudioNodeFaker(a)?await r(i,s,a.inputs[0],o):await r(i,s,a,o),a})(i,s,o)}}},createCreateNativeOfflineAudioContext=(e,t)=>(r,n,i)=>{if(null===t)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new t(r,n,i)}catch(t){throw"SyntaxError"===t.name?e():t}},createDataCloneError=()=>new DOMException("","DataCloneError"),detachArrayBuffer=e=>{let{port1:t,port2:r}=new MessageChannel;return new Promise((n=>{r.onmessage=()=>{t.close(),r.close(),n()},t.postMessage(e,[e])}))},createDecodeAudioData=(e,t,r,n,i,s,o,a,l,h,u)=>(c,d)=>{let f=o(c)?c:s(c);if(i.has(d)){let e=r();return Promise.reject(e)}try{i.add(d)}catch(e){}return t(l,(()=>l(f)))?f.decodeAudioData(d).then((r=>(detachArrayBuffer(d).catch((()=>{})),t(a,(()=>a(r)))||u(r),e.add(r),r))):new Promise(((t,r)=>{let i=async()=>{try{await detachArrayBuffer(d)}catch(e){}},s=e=>{r(e),i()};try{f.decodeAudioData(d,(r=>{"function"!=typeof r.copyFromChannel&&(h(r),wrapAudioBufferGetChannelDataMethod(r)),e.add(r),i().then((()=>t(r)))}),(e=>{s(null===e?n():e)}))}catch(e){s(e)}}))},createDecrementCycleCounter=(e,t,r,n,i,s,o,a)=>(l,h)=>{let u=t.get(l);if(void 0===u)throw new Error("Missing the expected cycle count.");let c=s(l.context),d=a(c);if(u===h){if(t.delete(l),!d&&o(l)){let t=n(l),{outputs:s}=r(l);for(let r of s)if(isAudioNodeOutputConnection(r)){let i=n(r[0]);e(t,i,r[1],r[2])}else{let e=i(r[0]);t.connect(e,r[1])}}}else t.set(l,u-h)},DEFAULT_OPTIONS10={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},createDelayNodeConstructor=(e,t,r,n,i,s,o)=>class extends e{constructor(e,a){let l=i(e),h=__spreadValues(__spreadValues({},DEFAULT_OPTIONS10),a),u=n(l,h),c=s(l);super(e,!1,u,c?r(h.maxDelayTime):null),this._delayTime=t(this,c,u.delayTime),o(this,h.maxDelayTime)}get delayTime(){return this._delayTime}},createDelayNodeRendererFactory=(e,t,r,n,i)=>s=>{let o=new WeakMap;return{render(a,l,h){let u=o.get(l);return void 0!==u?Promise.resolve(u):(async(a,l,h)=>{let u=r(a),c=isOwnedByContext(u,l);if(!c){let e={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,delayTime:u.delayTime.value,maxDelayTime:s};u=t(l,e)}return o.set(l,u),c?await e(l,a.delayTime,u.delayTime,h):await n(l,a.delayTime,u.delayTime,h),await i(a,l,u,h),u})(a,l,h)}}},createDeleteActiveInputConnectionToAudioNode=e=>(t,r,n,i)=>e(t[i],(e=>e[0]===r&&e[1]===n)),createDeleteUnrenderedAudioWorkletNode=e=>(t,r)=>{e(t).delete(r)},isDelayNode=e=>"delayTime"in e,createDetectCycles=(e,t,r)=>function n(i,s){let o=isAudioNode(s)?s:r(e,s);if(isDelayNode(o))return[];if(i[0]===o)return[i];if(i.includes(o))return[];let{outputs:a}=t(o);return Array.from(a).map((e=>n([...i,o],e[0]))).reduce(((e,t)=>e.concat(t)),[])},getOutputAudioNodeAtIndex=(e,t,r)=>{let n=t[r];if(void 0===n)throw e();return n},createDisconnectMultipleOutputs=e=>(t,r,n,i=0)=>void 0===r?t.forEach((e=>e.disconnect())):"number"==typeof r?getOutputAudioNodeAtIndex(e,t,r).disconnect():isNativeAudioNode(r)?void 0===n?t.forEach((e=>e.disconnect(r))):void 0===i?getOutputAudioNodeAtIndex(e,t,n).disconnect(r,0):getOutputAudioNodeAtIndex(e,t,n).disconnect(r,0,i):void 0===n?t.forEach((e=>e.disconnect(r))):getOutputAudioNodeAtIndex(e,t,n).disconnect(r,0),DEFAULT_OPTIONS11={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},createDynamicsCompressorNodeConstructor=(e,t,r,n,i,s,o,a)=>class extends e{constructor(e,i){let l=s(e),h=__spreadValues(__spreadValues({},DEFAULT_OPTIONS11),i),u=n(l,h),c=o(l);super(e,!1,u,c?r():null),this._attack=t(this,c,u.attack),this._knee=t(this,c,u.knee),this._nativeDynamicsCompressorNode=u,this._ratio=t(this,c,u.ratio),this._release=t(this,c,u.release),this._threshold=t(this,c,u.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(e){let t=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=e,e>2)throw this._nativeDynamicsCompressorNode.channelCount=t,i()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(e){let t=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=e,"max"===e)throw this._nativeDynamicsCompressorNode.channelCountMode=t,i()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return"number"==typeof this._nativeDynamicsCompressorNode.reduction.value?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},createDynamicsCompressorNodeRendererFactory=(e,t,r,n,i)=>()=>{let s=new WeakMap;return{render(o,a,l){let h=s.get(a);return void 0!==h?Promise.resolve(h):(async(o,a,l)=>{let h=r(o),u=isOwnedByContext(h,a);if(!u){let e={attack:h.attack.value,channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,knee:h.knee.value,ratio:h.ratio.value,release:h.release.value,threshold:h.threshold.value};h=t(a,e)}return s.set(a,h),u?(await e(a,o.attack,h.attack,l),await e(a,o.knee,h.knee,l),await e(a,o.ratio,h.ratio,l),await e(a,o.release,h.release,l),await e(a,o.threshold,h.threshold,l)):(await n(a,o.attack,h.attack,l),await n(a,o.knee,h.knee,l),await n(a,o.ratio,h.ratio,l),await n(a,o.release,h.release,l),await n(a,o.threshold,h.threshold,l)),await i(o,a,h,l),h})(o,a,l)}}},createEncodingError=()=>new DOMException("","EncodingError"),createEvaluateSource=e=>t=>new Promise(((r,n)=>{if(null===e)return void n(new SyntaxError);let i=e.document.head;if(null===i)n(new SyntaxError);else{let s=e.document.createElement("script"),o=new Blob([t],{type:"application/javascript"}),a=URL.createObjectURL(o),l=e.onerror,h=()=>{e.onerror=l,URL.revokeObjectURL(a)};e.onerror=(t,r,i,s,o)=>r===a||r===e.location.href&&1===i&&1===s?(h(),n(o),!1):null!==l?l(t,r,i,s,o):void 0,s.onerror=()=>{h(),n(new SyntaxError)},s.onload=()=>{h(),r()},s.src=a,s.type="module",i.appendChild(s)}})),createEventTargetConstructor=e=>class{constructor(e){this._nativeEventTarget=e,this._listeners=new WeakMap}addEventListener(t,r,n){if(null!==r){let i=this._listeners.get(r);void 0===i&&(i=e(this,r),"function"==typeof r&&this._listeners.set(r,i)),this._nativeEventTarget.addEventListener(t,i,n)}}dispatchEvent(e){return this._nativeEventTarget.dispatchEvent(e)}removeEventListener(e,t,r){let n=null===t?void 0:this._listeners.get(t);this._nativeEventTarget.removeEventListener(e,void 0===n?null:n,r)}},createExposeCurrentFrameAndCurrentTime=e=>(t,r,n)=>{Object.defineProperties(e,{currentFrame:{configurable:!0,get:()=>Math.round(t*r)},currentTime:{configurable:!0,get:()=>t}});try{return n()}finally{null!==e&&(delete e.currentFrame,delete e.currentTime)}},createFetchSource=e=>async t=>{try{let e=await fetch(t);if(e.ok)return[await e.text(),e.url]}catch(e){}throw e()},DEFAULT_OPTIONS12={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},createGainNodeConstructor=(e,t,r,n,i,s)=>class extends e{constructor(e,o){let a=i(e),l=__spreadValues(__spreadValues({},DEFAULT_OPTIONS12),o),h=n(a,l),u=s(a);super(e,!1,h,u?r():null),this._gain=t(this,u,h.gain,MOST_POSITIVE_SINGLE_FLOAT,MOST_NEGATIVE_SINGLE_FLOAT)}get gain(){return this._gain}},createGainNodeRendererFactory=(e,t,r,n,i)=>()=>{let s=new WeakMap;return{render(o,a,l){let h=s.get(a);return void 0!==h?Promise.resolve(h):(async(o,a,l)=>{let h=r(o),u=isOwnedByContext(h,a);if(!u){let e={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,gain:h.gain.value};h=t(a,e)}return s.set(a,h),u?await e(a,o.gain,h.gain,l):await n(a,o.gain,h.gain,l),await i(o,a,h,l),h})(o,a,l)}}},createGetActiveAudioWorkletNodeInputs=(e,t)=>r=>t(e,r),createGetAudioNodeRenderer=e=>t=>{let r=e(t);if(null===r.renderer)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return r.renderer},createGetAudioNodeTailTime=e=>t=>{var r;return null!==(r=e.get(t))&&void 0!==r?r:0},createGetAudioParamRenderer=e=>t=>{let r=e(t);if(null===r.renderer)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return r.renderer},createGetBackupOfflineAudioContext=e=>t=>e.get(t),createInvalidStateError=()=>new DOMException("","InvalidStateError"),createGetNativeContext=e=>t=>{let r=e.get(t);if(void 0===r)throw createInvalidStateError();return r},createGetOrCreateBackupOfflineAudioContext=(e,t)=>r=>{let n=e.get(r);if(void 0!==n)return n;if(null===t)throw new Error("Missing the native OfflineAudioContext constructor.");return n=new t(1,1,44100),e.set(r,n),n},createGetUnrenderedAudioWorkletNodes=e=>t=>{let r=e.get(t);if(void 0===r)throw new Error("The context has no set of AudioWorkletNodes.");return r},createInvalidAccessError=()=>new DOMException("","InvalidAccessError"),wrapIIRFilterNodeGetFrequencyResponseMethod=e=>{var t;e.getFrequencyResponse=(t=e.getFrequencyResponse,(r,n,i)=>{if(r.length!==n.length||n.length!==i.length)throw createInvalidAccessError();return t.call(e,r,n,i)})},DEFAULT_OPTIONS13={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},createIIRFilterNodeConstructor=(e,t,r,n,i,s)=>class extends e{constructor(e,o){let a=n(e),l=i(a),h=__spreadValues(__spreadValues({},DEFAULT_OPTIONS13),o),u=t(a,l?null:e.baseLatency,h);super(e,!1,u,l?r(h.feedback,h.feedforward):null),wrapIIRFilterNodeGetFrequencyResponseMethod(u),this._nativeIIRFilterNode=u,s(this,1)}getFrequencyResponse(e,t,r){return this._nativeIIRFilterNode.getFrequencyResponse(e,t,r)}},filterBuffer=(e,t,r,n,i,s,o,a,l,h,u)=>{let c=h.length,d=a;for(let a=0;a<c;a+=1){let c=r[0]*h[a];for(let t=1;t<i;t+=1){let n=d-t&l-1;c+=r[t]*s[n],c-=e[t]*o[n]}for(let e=i;e<n;e+=1)c+=r[e]*s[d-e&l-1];for(let r=i;r<t;r+=1)c-=e[r]*o[d-r&l-1];s[d]=h[a],o[d]=c,d=d+1&l-1,u[a]=c}return d},filterFullBuffer=(e,t,r,n)=>{let i=r instanceof Float64Array?r:new Float64Array(r),s=n instanceof Float64Array?n:new Float64Array(n),o=i.length,a=s.length,l=Math.min(o,a);if(1!==i[0]){for(let e=0;e<o;e+=1)s[e]/=i[0];for(let e=1;e<a;e+=1)i[e]/=i[0]}let h=new Float32Array(32),u=new Float32Array(32),c=t.createBuffer(e.numberOfChannels,e.length,e.sampleRate),d=e.numberOfChannels;for(let t=0;t<d;t+=1){let r=e.getChannelData(t),n=c.getChannelData(t);h.fill(0),u.fill(0),filterBuffer(i,o,s,a,l,h,u,0,32,r,n)}return c},createIIRFilterNodeRendererFactory=(e,t,r,n,i)=>(s,o)=>{let a=new WeakMap,l=null;return{render(h,u,c){let d=a.get(u);return void 0!==d?Promise.resolve(d):(async(h,u,c)=>{let d=null,f=t(h),p=isOwnedByContext(f,u);if(void 0===u.createIIRFilter?d=e(u,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):p||(f=u.createIIRFilter(o,s)),a.set(u,null===d?f:d),null!==d){if(null===l){if(null===r)throw new Error("Missing the native OfflineAudioContext constructor.");let e=new r(h.context.destination.channelCount,h.context.length,u.sampleRate);l=(async()=>{await n(h,e,e.destination,c);let t=await i(e);return filterFullBuffer(t,u,s,o)})()}let e=await l;return d.buffer=e,d.start(0),d}return await n(h,u,f,c),f})(h,u,c)}}},createIncrementCycleCounterFactory=(e,t,r,n,i,s)=>o=>(a,l)=>{let h=e.get(a);if(void 0===h){if(!o&&s(a)){let e=n(a),{outputs:s}=r(a);for(let r of s)if(isAudioNodeOutputConnection(r)){let i=n(r[0]);t(e,i,r[1],r[2])}else{let t=i(r[0]);e.disconnect(t,r[1])}}e.set(a,l)}else e.set(a,h+l)},createIsAnyAudioContext=(e,t)=>r=>{let n=e.get(r);return t(n)||t(r)},createIsAnyAudioNode=(e,t)=>r=>e.has(r)||t(r),createIsAnyAudioParam=(e,t)=>r=>e.has(r)||t(r),createIsAnyOfflineAudioContext=(e,t)=>r=>{let n=e.get(r);return t(n)||t(r)},createIsNativeAudioContext=e=>t=>null!==e&&t instanceof e,createIsNativeAudioNode=e=>t=>null!==e&&"function"==typeof e.AudioNode&&t instanceof e.AudioNode,createIsNativeAudioParam=e=>t=>null!==e&&"function"==typeof e.AudioParam&&t instanceof e.AudioParam,createIsNativeContext=(e,t)=>r=>e(r)||t(r),createIsNativeOfflineAudioContext=e=>t=>null!==e&&t instanceof e,createIsSecureContext=e=>null!==e&&e.isSecureContext,createIsSupportedPromise=async(e,t,r,n,i,s,o,a,l,h,u,c,d,f,p,m)=>!!(e(t,t)&&e(r,r)&&e(i,i)&&e(s,s)&&e(a,a)&&e(l,l)&&e(h,h)&&e(u,u)&&e(c,c)&&e(d,d)&&e(f,f))&&(await Promise.all([e(n,n),e(o,o),e(p,p),e(m,m)])).every((e=>e)),createMediaElementAudioSourceNodeConstructor=(e,t,r,n)=>class extends e{constructor(e,i){let s=r(e),o=t(s,i);if(n(s))throw TypeError();super(e,!0,o,null),this._nativeMediaElementAudioSourceNode=o}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},DEFAULT_OPTIONS14={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},createMediaStreamAudioDestinationNodeConstructor=(e,t,r,n)=>class extends e{constructor(e,i){let s=r(e);if(n(s))throw new TypeError;let o=__spreadValues(__spreadValues({},DEFAULT_OPTIONS14),i),a=t(s,o);super(e,!1,a,null),this._nativeMediaStreamAudioDestinationNode=a}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},createMediaStreamAudioSourceNodeConstructor=(e,t,r,n)=>class extends e{constructor(e,i){let s=r(e),o=t(s,i);if(n(s))throw new TypeError;super(e,!0,o,null),this._nativeMediaStreamAudioSourceNode=o}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},createMediaStreamTrackAudioSourceNodeConstructor=(e,t,r)=>class extends e{constructor(e,n){let i=r(e);super(e,!0,t(i,n),null)}},createMinimalAudioContextConstructor=(e,t,r,n,i)=>class extends n{constructor(e={}){if(null===i)throw new Error("Missing the native AudioContext constructor.");let n;try{n=new i(e)}catch(e){throw 12===e.code&&"sampleRate is not in range"===e.message?t():e}if(null===n)throw r();if(!isValidLatencyHint(e.latencyHint))throw new TypeError(`The provided value '${e.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(void 0!==e.sampleRate&&n.sampleRate!==e.sampleRate)throw t();super(n,2);let{latencyHint:s}=e,{sampleRate:o}=n;if(this._baseLatency="number"==typeof n.baseLatency?n.baseLatency:"balanced"===s?512/o:"interactive"===s||void 0===s?256/o:"playback"===s?1024/o:128*Math.max(2,Math.min(128,Math.round(s*o/128)))/o,this._nativeAudioContext=n,"webkitAudioContext"===i.name?(this._nativeGainNode=n.createGain(),this._nativeOscillatorNode=n.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(n.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,"running"===n.state){this._state="suspended";let e=()=>{"suspended"===this._state&&(this._state=null),n.removeEventListener("statechange",e)};n.addEventListener("statechange",e)}}get baseLatency(){return this._baseLatency}get state(){return null!==this._state?this._state:this._nativeAudioContext.state}close(){return"closed"===this.state?this._nativeAudioContext.close().then((()=>{throw e()})):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then((()=>{null!==this._nativeGainNode&&null!==this._nativeOscillatorNode&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),deactivateAudioGraph(this)})))}resume(){return"suspended"===this._state?new Promise(((e,t)=>{let r=()=>{this._nativeAudioContext.removeEventListener("statechange",r),"running"===this._nativeAudioContext.state?e():this.resume().then(e,t)};this._nativeAudioContext.addEventListener("statechange",r)})):this._nativeAudioContext.resume().catch((t=>{throw void 0===t||15===t.code?e():t}))}suspend(){return this._nativeAudioContext.suspend().catch((t=>{throw void 0===t?e():t}))}},createMinimalBaseAudioContextConstructor=(e,t,r,n,i,s)=>class extends r{constructor(r,s){super(r),this._nativeContext=r,CONTEXT_STORE.set(this,r),n(r)&&i.set(r,new Set),this._destination=new e(this,s),this._listener=t(this,r),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(e){let t="function"==typeof e?s(this,e):null;this._nativeContext.onstatechange=t;let r=this._nativeContext.onstatechange;this._onstatechange=null!==r&&r===t?e:r}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},testPromiseSupport=e=>{let t=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{let r=e.decodeAudioData(t.buffer,(()=>{}));return void 0!==r&&(r.catch((()=>{})),!0)}catch(e){}return!1},DEFAULT_OPTIONS15={numberOfChannels:1},createMinimalOfflineAudioContextConstructor=(e,t,r,n,i)=>class extends n{constructor(t){let{length:n,numberOfChannels:i,sampleRate:s}=__spreadValues(__spreadValues({},DEFAULT_OPTIONS15),t),o=r(i,n,s);e(testPromiseSupport,(()=>testPromiseSupport(o)))||o.addEventListener("statechange",(()=>{let e=0,t=r=>{"running"===this._state&&(e>0?(o.removeEventListener("statechange",t),r.stopImmediatePropagation(),this._waitForThePromiseToSettle(r)):e+=1)};return t})()),super(o,i),this._length=n,this._nativeOfflineAudioContext=o,this._state=null}get length(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}get state(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}startRendering(){return"running"===this._state?Promise.reject(t()):(this._state="running",i(this.destination,this._nativeOfflineAudioContext).finally((()=>{this._state=null,deactivateAudioGraph(this)})))}_waitForThePromiseToSettle(e){null===this._state?this._nativeOfflineAudioContext.dispatchEvent(e):setTimeout((()=>this._waitForThePromiseToSettle(e)))}},createMonitorConnections=(e,t)=>(r,n,i)=>{let s=new Set;return r.connect=(a=r.connect,(i,o=0,l=0)=>{let h=0===s.size;if(t(i))return a.call(r,i,o,l),e(s,[i,o,l],(e=>e[0]===i&&e[1]===o&&e[2]===l),!0),h&&n(),i;a.call(r,i,o),e(s,[i,o],(e=>e[0]===i&&e[1]===o),!0),h&&n()}),r.disconnect=(o=r.disconnect,(e,n,a)=>{let l=s.size>0;if(void 0===e)o.apply(r),s.clear();else if("number"==typeof e){o.call(r,e);for(let t of s)t[1]===e&&s.delete(t)}else{t(e)?o.call(r,e,n,a):o.call(r,e,n);for(let t of s)t[0]===e&&(void 0===n||t[1]===n)&&(void 0===a||t[2]===a)&&s.delete(t)}let h=0===s.size;l&&h&&i()}),r;var o,a},assignNativeAudioNodeOption=(e,t,r)=>{let n=t[r];void 0!==n&&n!==e[r]&&(e[r]=n)},assignNativeAudioNodeOptions=(e,t)=>{assignNativeAudioNodeOption(e,t,"channelCount"),assignNativeAudioNodeOption(e,t,"channelCountMode"),assignNativeAudioNodeOption(e,t,"channelInterpretation")},testAnalyserNodeGetFloatTimeDomainDataMethodSupport=e=>"function"==typeof e.getFloatTimeDomainData,wrapAnalyserNodeGetFloatTimeDomainDataMethod=e=>{e.getFloatTimeDomainData=t=>{let r=new Uint8Array(t.length);e.getByteTimeDomainData(r);let n=Math.max(r.length,e.fftSize);for(let e=0;e<n;e+=1)t[e]=.0078125*(r[e]-128);return t}},createNativeAnalyserNodeFactory=(e,t)=>(r,n)=>{let i=r.createAnalyser();if(assignNativeAudioNodeOptions(i,n),!(n.maxDecibels>n.minDecibels))throw t();return assignNativeAudioNodeOption(i,n,"fftSize"),assignNativeAudioNodeOption(i,n,"maxDecibels"),assignNativeAudioNodeOption(i,n,"minDecibels"),assignNativeAudioNodeOption(i,n,"smoothingTimeConstant"),e(testAnalyserNodeGetFloatTimeDomainDataMethodSupport,(()=>testAnalyserNodeGetFloatTimeDomainDataMethodSupport(i)))||wrapAnalyserNodeGetFloatTimeDomainDataMethod(i),i},createNativeAudioBufferConstructor=e=>null===e?null:e.hasOwnProperty("AudioBuffer")?e.AudioBuffer:null,assignNativeAudioNodeAudioParamValue=(e,t,r)=>{let n=t[r];void 0!==n&&n!==e[r].value&&(e[r].value=n)},wrapAudioBufferSourceNodeStartMethodConsecutiveCalls=e=>{e.start=(t=>{let r=!1;return(n=0,i=0,s)=>{if(r)throw createInvalidStateError();t.call(e,n,i,s),r=!0}})(e.start)},wrapAudioScheduledSourceNodeStartMethodNegativeParameters=e=>{var t;e.start=(t=e.start,(r=0,n=0,i)=>{if("number"==typeof i&&i<0||n<0||r<0)throw new RangeError("The parameters can't be negative.");t.call(e,r,n,i)})},wrapAudioScheduledSourceNodeStopMethodNegativeParameters=e=>{var t;e.stop=(t=e.stop,(r=0)=>{if(r<0)throw new RangeError("The parameter can't be negative.");t.call(e,r)})},createNativeAudioBufferSourceNodeFactory=(e,t,r,n,i,s,o,a,l,h,u)=>(c,d)=>{let f=c.createBufferSource();return assignNativeAudioNodeOptions(f,d),assignNativeAudioNodeAudioParamValue(f,d,"playbackRate"),assignNativeAudioNodeOption(f,d,"buffer"),assignNativeAudioNodeOption(f,d,"loop"),assignNativeAudioNodeOption(f,d,"loopEnd"),assignNativeAudioNodeOption(f,d,"loopStart"),t(r,(()=>r(c)))||wrapAudioBufferSourceNodeStartMethodConsecutiveCalls(f),t(n,(()=>n(c)))||l(f),t(i,(()=>i(c)))||h(f,c),t(s,(()=>s(c)))||wrapAudioScheduledSourceNodeStartMethodNegativeParameters(f),t(o,(()=>o(c)))||u(f,c),t(a,(()=>a(c)))||wrapAudioScheduledSourceNodeStopMethodNegativeParameters(f),e(c,f),f},createNativeAudioContextConstructor=e=>null===e?null:e.hasOwnProperty("AudioContext")?e.AudioContext:e.hasOwnProperty("webkitAudioContext")?e.webkitAudioContext:null,createNativeAudioDestinationNodeFactory=(e,t)=>(r,n,i)=>{let s=r.destination;if(s.channelCount!==n)try{s.channelCount=n}catch(e){}i&&"explicit"!==s.channelCountMode&&(s.channelCountMode="explicit"),0===s.maxChannelCount&&Object.defineProperty(s,"maxChannelCount",{value:n});let o=e(r,{channelCount:n,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,gain:1});return t(o,"channelCount",(e=>()=>e.call(o)),(e=>t=>{e.call(o,t);try{s.channelCount=t}catch(e){if(t>s.maxChannelCount)throw e}})),t(o,"channelCountMode",(e=>()=>e.call(o)),(e=>t=>{e.call(o,t),s.channelCountMode=t})),t(o,"channelInterpretation",(e=>()=>e.call(o)),(e=>t=>{e.call(o,t),s.channelInterpretation=t})),Object.defineProperty(o,"maxChannelCount",{get:()=>s.maxChannelCount}),o.connect(s),o},createNativeAudioWorkletNodeConstructor=e=>null===e?null:e.hasOwnProperty("AudioWorkletNode")?e.AudioWorkletNode:null,testClonabilityOfAudioWorkletNodeOptions=e=>{let{port1:t}=new MessageChannel;try{t.postMessage(e)}finally{t.close()}},createNativeAudioWorkletNodeFactory=(e,t,r,n,i)=>(s,o,a,l,h,u)=>{if(null!==a)try{let t=new a(s,l,u),n=new Map,o=null;if(Object.defineProperties(t,{channelCount:{get:()=>u.channelCount,set:()=>{throw e()}},channelCountMode:{get:()=>"explicit",set:()=>{throw e()}},onprocessorerror:{get:()=>o,set:e=>{"function"==typeof o&&t.removeEventListener("processorerror",o),o="function"==typeof e?e:null,"function"==typeof o&&t.addEventListener("processorerror",o)}}}),t.addEventListener=(d=t.addEventListener,(...e)=>{if("processorerror"===e[0]){let t="function"==typeof e[1]?e[1]:"object"==typeof e[1]&&null!==e[1]&&"function"==typeof e[1].handleEvent?e[1].handleEvent:null;if(null!==t){let r=n.get(e[1]);void 0!==r?e[1]=r:(e[1]=r=>{"error"===r.type?(Object.defineProperties(r,{type:{value:"processorerror"}}),t(r)):t(new ErrorEvent(e[0],__spreadValues({},r)))},n.set(t,e[1]))}}return d.call(t,"error",e[1],e[2]),d.call(t,...e)}),t.removeEventListener=(c=t.removeEventListener,(...e)=>{if("processorerror"===e[0]){let t=n.get(e[1]);void 0!==t&&(n.delete(e[1]),e[1]=t)}return c.call(t,"error",e[1],e[2]),c.call(t,e[0],e[1],e[2])}),0!==u.numberOfOutputs){let e=r(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return t.connect(e).connect(s.destination),i(t,(()=>e.disconnect()),(()=>e.connect(s.destination)))}return t}catch(e){throw 11===e.code?n():e}var c,d;if(void 0===h)throw n();return testClonabilityOfAudioWorkletNodeOptions(u),t(s,o,h,u)},computeBufferSize=(e,t)=>null===e?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(e*t))))),cloneAudioWorkletNodeOptions=e=>new Promise(((t,r)=>{let{port1:n,port2:i}=new MessageChannel;n.onmessage=({data:e})=>{n.close(),i.close(),t(e)},n.onmessageerror=({data:e})=>{n.close(),i.close(),r(e)},i.postMessage(e)})),createAudioWorkletProcessorPromise=async(e,t)=>new e(await cloneAudioWorkletNodeOptions(t)),createAudioWorkletProcessor=(e,t,r,n)=>{let i=NODE_TO_PROCESSOR_MAPS.get(e);void 0===i&&(i=new WeakMap,NODE_TO_PROCESSOR_MAPS.set(e,i));let s=createAudioWorkletProcessorPromise(r,n);return i.set(t,s),s},createNativeAudioWorkletNodeFakerFactory=(e,t,r,n,i,s,o,a,l,h,u,c,d)=>(f,p,m,_)=>{if(0===_.numberOfInputs&&0===_.numberOfOutputs)throw l();let g=Array.isArray(_.outputChannelCount)?_.outputChannelCount:Array.from(_.outputChannelCount);if(g.some((e=>e<1)))throw l();if(g.length!==_.numberOfOutputs)throw t();if("explicit"!==_.channelCountMode)throw l();let v=_.channelCount*_.numberOfInputs,y=g.reduce(((e,t)=>e+t),0),b=void 0===m.parameterDescriptors?0:m.parameterDescriptors.length;if(v+b>6||y>6)throw l();let x=new MessageChannel,S=[],T=[];for(let e=0;e<_.numberOfInputs;e+=1)S.push(o(f,{channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation,gain:1})),T.push(i(f,{channelCount:_.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:_.channelCount}));let E=[];if(void 0!==m.parameterDescriptors)for(let{defaultValue:e,maxValue:t,minValue:r,name:n}of m.parameterDescriptors){let i=s(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:void 0!==_.parameterData[n]?_.parameterData[n]:void 0===e?0:e});Object.defineProperties(i.offset,{defaultValue:{get:()=>void 0===e?0:e},maxValue:{get:()=>void 0===t?MOST_POSITIVE_SINGLE_FLOAT:t},minValue:{get:()=>void 0===r?MOST_NEGATIVE_SINGLE_FLOAT:r}}),E.push(i)}let A=n(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,v+b)}),w=computeBufferSize(p,f.sampleRate),C=a(f,w,v+b,Math.max(1,y)),O=i(f,{channelCount:Math.max(1,y),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,y)}),R=[];for(let e=0;e<_.numberOfOutputs;e+=1)R.push(n(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:g[e]}));for(let e=0;e<_.numberOfInputs;e+=1){S[e].connect(T[e]);for(let t=0;t<_.channelCount;t+=1)T[e].connect(A,t,e*_.channelCount+t)}let D=new ReadOnlyMap(void 0===m.parameterDescriptors?[]:m.parameterDescriptors.map((({name:e},t)=>{let r=E[t];return r.connect(A,0,v+t),r.start(0),[e,r.offset]})));A.connect(C);let I=_.channelInterpretation,M=null,N=0===_.numberOfOutputs?[C]:R,P={get bufferSize(){return w},get channelCount(){return _.channelCount},set channelCount(e){throw r()},get channelCountMode(){return _.channelCountMode},set channelCountMode(e){throw r()},get channelInterpretation(){return I},set channelInterpretation(e){for(let t of S)t.channelInterpretation=e;I=e},get context(){return C.context},get inputs(){return S},get numberOfInputs(){return _.numberOfInputs},get numberOfOutputs(){return _.numberOfOutputs},get onprocessorerror(){return M},set onprocessorerror(e){"function"==typeof M&&P.removeEventListener("processorerror",M),M="function"==typeof e?e:null,"function"==typeof M&&P.addEventListener("processorerror",M)},get parameters(){return D},get port(){return x.port2},addEventListener:(...e)=>C.addEventListener(e[0],e[1],e[2]),connect:e.bind(null,N),disconnect:h.bind(null,N),dispatchEvent:(...e)=>C.dispatchEvent(e[0]),removeEventListener:(...e)=>C.removeEventListener(e[0],e[1],e[2])},k=new Map;var F,L;x.port1.addEventListener=(L=x.port1.addEventListener,(...e)=>{if("message"===e[0]){let t="function"==typeof e[1]?e[1]:"object"==typeof e[1]&&null!==e[1]&&"function"==typeof e[1].handleEvent?e[1].handleEvent:null;if(null!==t){let r=k.get(e[1]);void 0!==r?e[1]=r:(e[1]=e=>{u(f.currentTime,f.sampleRate,(()=>t(e)))},k.set(t,e[1]))}}return L.call(x.port1,e[0],e[1],e[2])}),x.port1.removeEventListener=(F=x.port1.removeEventListener,(...e)=>{if("message"===e[0]){let t=k.get(e[1]);void 0!==t&&(k.delete(e[1]),e[1]=t)}return F.call(x.port1,e[0],e[1],e[2])});let B=null;Object.defineProperty(x.port1,"onmessage",{get:()=>B,set:e=>{"function"==typeof B&&x.port1.removeEventListener("message",B),B="function"==typeof e?e:null,"function"==typeof B&&(x.port1.addEventListener("message",B),x.port1.start())}}),m.prototype.port=x.port1;let U=null;createAudioWorkletProcessor(f,P,m,_).then((e=>U=e));let G=createNestedArrays(_.numberOfInputs,_.channelCount),j=createNestedArrays(_.numberOfOutputs,g),V=void 0===m.parameterDescriptors?[]:m.parameterDescriptors.reduce(((e,{name:t})=>__spreadProps(__spreadValues({},e),{[t]:new Float32Array(128)})),{}),z=!0,H=()=>{_.numberOfOutputs>0&&C.disconnect(O);for(let e=0,t=0;e<_.numberOfOutputs;e+=1){let r=R[e];for(let n=0;n<g[e];n+=1)O.disconnect(r,t+n,n);t+=g[e]}},X=new Map;C.onaudioprocess=({inputBuffer:e,outputBuffer:t})=>{if(null!==U){let r=c(P);for(let n=0;n<w;n+=128){for(let t=0;t<_.numberOfInputs;t+=1)for(let r=0;r<_.channelCount;r+=1)copyFromChannel(e,G[t],r,r,n);void 0!==m.parameterDescriptors&&m.parameterDescriptors.forEach((({name:t},r)=>{copyFromChannel(e,V,t,v+r,n)}));for(let e=0;e<_.numberOfInputs;e+=1)for(let t=0;t<g[e];t+=1)0===j[e][t].byteLength&&(j[e][t]=new Float32Array(128));try{let e=G.map(((e,t)=>{if(r[t].size>0)return X.set(t,w/128),e;let n=X.get(t);return void 0===n?[]:(e.every((e=>e.every((e=>0===e))))&&(1===n?X.delete(t):X.set(t,n-1)),e)}));z=u(f.currentTime+n/f.sampleRate,f.sampleRate,(()=>U.process(e,j,V)));for(let e=0,r=0;e<_.numberOfOutputs;e+=1){for(let i=0;i<g[e];i+=1)copyToChannel(t,j[e],i,r+i,n);r+=g[e]}}catch(e){z=!1,P.dispatchEvent(new ErrorEvent("processorerror",{colno:e.colno,filename:e.filename,lineno:e.lineno,message:e.message}))}if(!z){for(let e=0;e<_.numberOfInputs;e+=1){S[e].disconnect(T[e]);for(let t=0;t<_.channelCount;t+=1)T[n].disconnect(A,t,e*_.channelCount+t)}if(void 0!==m.parameterDescriptors){let e=m.parameterDescriptors.length;for(let t=0;t<e;t+=1){let e=E[t];e.disconnect(A,0,v+t),e.stop()}}A.disconnect(C),C.onaudioprocess=null,W?H():J();break}}}};let W=!1,q=o(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),Y=()=>C.connect(q).connect(f.destination),J=()=>{C.disconnect(q),q.disconnect()};return Y(),d(P,(()=>{if(z){J(),_.numberOfOutputs>0&&C.connect(O);for(let e=0,t=0;e<_.numberOfOutputs;e+=1){let r=R[e];for(let n=0;n<g[e];n+=1)O.connect(r,t+n,n);t+=g[e]}}W=!0}),(()=>{z&&(Y(),H()),W=!1}))},createNativeBiquadFilterNode=(e,t)=>{let r=e.createBiquadFilter();return assignNativeAudioNodeOptions(r,t),assignNativeAudioNodeAudioParamValue(r,t,"Q"),assignNativeAudioNodeAudioParamValue(r,t,"detune"),assignNativeAudioNodeAudioParamValue(r,t,"frequency"),assignNativeAudioNodeAudioParamValue(r,t,"gain"),assignNativeAudioNodeOption(r,t,"type"),r},createNativeChannelMergerNodeFactory=(e,t)=>(r,n)=>{let i=r.createChannelMerger(n.numberOfInputs);return null!==e&&"webkitAudioContext"===e.name&&t(r,i),assignNativeAudioNodeOptions(i,n),i},wrapChannelSplitterNode=e=>{let t=e.numberOfOutputs;Object.defineProperty(e,"channelCount",{get:()=>t,set:e=>{if(e!==t)throw createInvalidStateError()}}),Object.defineProperty(e,"channelCountMode",{get:()=>"explicit",set:e=>{if("explicit"!==e)throw createInvalidStateError()}}),Object.defineProperty(e,"channelInterpretation",{get:()=>"discrete",set:e=>{if("discrete"!==e)throw createInvalidStateError()}})},createNativeChannelSplitterNode=(e,t)=>{let r=e.createChannelSplitter(t.numberOfOutputs);return assignNativeAudioNodeOptions(r,t),wrapChannelSplitterNode(r),r},createNativeConstantSourceNodeFactory=(e,t,r,n,i)=>(s,o)=>{if(void 0===s.createConstantSource)return r(s,o);let a=s.createConstantSource();return assignNativeAudioNodeOptions(a,o),assignNativeAudioNodeAudioParamValue(a,o,"offset"),t(n,(()=>n(s)))||wrapAudioScheduledSourceNodeStartMethodNegativeParameters(a),t(i,(()=>i(s)))||wrapAudioScheduledSourceNodeStopMethodNegativeParameters(a),e(s,a),a},interceptConnections=(e,t)=>(e.connect=t.connect.bind(t),e.disconnect=t.disconnect.bind(t),e),createNativeConstantSourceNodeFakerFactory=(e,t,r,n)=>(i,s)=>{var o=s,{offset:a}=o,l=__objRest(o,["offset"]);let h=i.createBuffer(1,2,44100),u=t(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),c=r(i,__spreadProps(__spreadValues({},l),{gain:a})),d=h.getChannelData(0);d[0]=1,d[1]=1,u.buffer=h,u.loop=!0;let f={get bufferSize(){},get channelCount(){return c.channelCount},set channelCount(e){c.channelCount=e},get channelCountMode(){return c.channelCountMode},set channelCountMode(e){c.channelCountMode=e},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(e){c.channelInterpretation=e},get context(){return c.context},get inputs(){return[]},get numberOfInputs(){return u.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get offset(){return c.gain},get onended(){return u.onended},set onended(e){u.onended=e},addEventListener:(...e)=>u.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>u.dispatchEvent(e[0]),removeEventListener:(...e)=>u.removeEventListener(e[0],e[1],e[2]),start(e=0){u.start.call(u,e)},stop(e=0){u.stop.call(u,e)}};return e(i,u),n(interceptConnections(f,c),(()=>u.connect(c)),(()=>u.disconnect(c)))},createNativeConvolverNodeFactory=(e,t)=>(r,n)=>{let i=r.createConvolver();if(assignNativeAudioNodeOptions(i,n),n.disableNormalization===i.normalize&&(i.normalize=!n.disableNormalization),assignNativeAudioNodeOption(i,n,"buffer"),n.channelCount>2||(t(i,"channelCount",(e=>()=>e.call(i)),(t=>r=>{if(r>2)throw e();return t.call(i,r)})),"max"===n.channelCountMode))throw e();return t(i,"channelCountMode",(e=>()=>e.call(i)),(t=>r=>{if("max"===r)throw e();return t.call(i,r)})),i},createNativeDelayNode=(e,t)=>{let r=e.createDelay(t.maxDelayTime);return assignNativeAudioNodeOptions(r,t),assignNativeAudioNodeAudioParamValue(r,t,"delayTime"),r},createNativeDynamicsCompressorNodeFactory=e=>(t,r)=>{let n=t.createDynamicsCompressor();if(assignNativeAudioNodeOptions(n,r),r.channelCount>2||"max"===r.channelCountMode)throw e();return assignNativeAudioNodeAudioParamValue(n,r,"attack"),assignNativeAudioNodeAudioParamValue(n,r,"knee"),assignNativeAudioNodeAudioParamValue(n,r,"ratio"),assignNativeAudioNodeAudioParamValue(n,r,"release"),assignNativeAudioNodeAudioParamValue(n,r,"threshold"),n},createNativeGainNode=(e,t)=>{let r=e.createGain();return assignNativeAudioNodeOptions(r,t),assignNativeAudioNodeAudioParamValue(r,t,"gain"),r},createNativeIIRFilterNodeFactory=e=>(t,r,n)=>{if(void 0===t.createIIRFilter)return e(t,r,n);let i=t.createIIRFilter(n.feedforward,n.feedback);return assignNativeAudioNodeOptions(i,n),i};function divide(e,t){let r=t[0]*t[0]+t[1]*t[1];return[(e[0]*t[0]+e[1]*t[1])/r,(e[1]*t[0]-e[0]*t[1])/r]}function multiply(e,t){return[e[0]*t[0]-e[1]*t[1],e[0]*t[1]+e[1]*t[0]]}function evaluatePolynomial(e,t){let r=[0,0];for(let n=e.length-1;n>=0;n-=1)r=multiply(r,t),r[0]+=e[n];return r}var createNativeIIRFilterNodeFakerFactory=(e,t,r,n)=>(i,s,{channelCount:o,channelCountMode:a,channelInterpretation:l,feedback:h,feedforward:u})=>{let c=computeBufferSize(s,i.sampleRate),d=h instanceof Float64Array?h:new Float64Array(h),f=u instanceof Float64Array?u:new Float64Array(u),p=d.length,m=f.length,_=Math.min(p,m);if(0===p||p>20)throw n();if(0===d[0])throw t();if(0===m||m>20)throw n();if(0===f[0])throw t();if(1!==d[0]){for(let e=0;e<m;e+=1)f[e]/=d[0];for(let e=1;e<p;e+=1)d[e]/=d[0]}let g=r(i,c,o,o);g.channelCount=o,g.channelCountMode=a,g.channelInterpretation=l;let v=[],y=[],b=[];for(let e=0;e<o;e+=1){v.push(0);let e=new Float32Array(32),t=new Float32Array(32);e.fill(0),t.fill(0),y.push(e),b.push(t)}g.onaudioprocess=e=>{let t=e.inputBuffer,r=e.outputBuffer,n=t.numberOfChannels;for(let e=0;e<n;e+=1){let n=t.getChannelData(e),i=r.getChannelData(e);v[e]=filterBuffer(d,p,f,m,_,y[e],b[e],v[e],32,n,i)}};let x=i.sampleRate/2;return interceptConnections({get bufferSize(){return c},get channelCount(){return g.channelCount},set channelCount(e){g.channelCount=e},get channelCountMode(){return g.channelCountMode},set channelCountMode(e){g.channelCountMode=e},get channelInterpretation(){return g.channelInterpretation},set channelInterpretation(e){g.channelInterpretation=e},get context(){return g.context},get inputs(){return[g]},get numberOfInputs(){return g.numberOfInputs},get numberOfOutputs(){return g.numberOfOutputs},addEventListener:(...e)=>g.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>g.dispatchEvent(e[0]),getFrequencyResponse(t,r,n){if(t.length!==r.length||r.length!==n.length)throw e();let i=t.length;for(let e=0;e<i;e+=1){let i=-Math.PI*(t[e]/x),s=[Math.cos(i),Math.sin(i)],o=divide(evaluatePolynomial(f,s),evaluatePolynomial(d,s));r[e]=Math.sqrt(o[0]*o[0]+o[1]*o[1]),n[e]=Math.atan2(o[1],o[0])}},removeEventListener:(...e)=>g.removeEventListener(e[0],e[1],e[2])},g)},createNativeMediaElementAudioSourceNode=(e,t)=>e.createMediaElementSource(t.mediaElement),createNativeMediaStreamAudioDestinationNode=(e,t)=>{let r=e.createMediaStreamDestination();return assignNativeAudioNodeOptions(r,t),1===r.numberOfOutputs&&Object.defineProperty(r,"numberOfOutputs",{get:()=>0}),r},createNativeMediaStreamAudioSourceNode=(e,{mediaStream:t})=>{let r=t.getAudioTracks();r.sort(((e,t)=>e.id<t.id?-1:e.id>t.id?1:0));let n=r.slice(0,1),i=e.createMediaStreamSource(new MediaStream(n));return Object.defineProperty(i,"mediaStream",{value:t}),i},createNativeMediaStreamTrackAudioSourceNodeFactory=(e,t)=>(r,{mediaStreamTrack:n})=>{if("function"==typeof r.createMediaStreamTrackSource)return r.createMediaStreamTrackSource(n);let i=new MediaStream([n]),s=r.createMediaStreamSource(i);if("audio"!==n.kind)throw e();if(t(r))throw new TypeError;return s},createNativeOfflineAudioContextConstructor=e=>null===e?null:e.hasOwnProperty("OfflineAudioContext")?e.OfflineAudioContext:e.hasOwnProperty("webkitOfflineAudioContext")?e.webkitOfflineAudioContext:null,createNativeOscillatorNodeFactory=(e,t,r,n,i,s)=>(o,a)=>{let l=o.createOscillator();return assignNativeAudioNodeOptions(l,a),assignNativeAudioNodeAudioParamValue(l,a,"detune"),assignNativeAudioNodeAudioParamValue(l,a,"frequency"),void 0!==a.periodicWave?l.setPeriodicWave(a.periodicWave):assignNativeAudioNodeOption(l,a,"type"),t(r,(()=>r(o)))||wrapAudioScheduledSourceNodeStartMethodNegativeParameters(l),t(n,(()=>n(o)))||s(l,o),t(i,(()=>i(o)))||wrapAudioScheduledSourceNodeStopMethodNegativeParameters(l),e(o,l),l},createNativePannerNodeFactory=e=>(t,r)=>{let n=t.createPanner();return void 0===n.orientationX?e(t,r):(assignNativeAudioNodeOptions(n,r),assignNativeAudioNodeAudioParamValue(n,r,"orientationX"),assignNativeAudioNodeAudioParamValue(n,r,"orientationY"),assignNativeAudioNodeAudioParamValue(n,r,"orientationZ"),assignNativeAudioNodeAudioParamValue(n,r,"positionX"),assignNativeAudioNodeAudioParamValue(n,r,"positionY"),assignNativeAudioNodeAudioParamValue(n,r,"positionZ"),assignNativeAudioNodeOption(n,r,"coneInnerAngle"),assignNativeAudioNodeOption(n,r,"coneOuterAngle"),assignNativeAudioNodeOption(n,r,"coneOuterGain"),assignNativeAudioNodeOption(n,r,"distanceModel"),assignNativeAudioNodeOption(n,r,"maxDistance"),assignNativeAudioNodeOption(n,r,"panningModel"),assignNativeAudioNodeOption(n,r,"refDistance"),assignNativeAudioNodeOption(n,r,"rolloffFactor"),n)},createNativePannerNodeFakerFactory=(e,t,r,n,i,s,o,a,l)=>(h,u)=>{var c=u,{coneInnerAngle:d,coneOuterAngle:f,coneOuterGain:p,distanceModel:m,maxDistance:_,orientationX:g,orientationY:v,orientationZ:y,panningModel:b,positionX:x,positionY:S,positionZ:T,refDistance:E,rolloffFactor:A}=c,w=__objRest(c,["coneInnerAngle","coneOuterAngle","coneOuterGain","distanceModel","maxDistance","orientationX","orientationY","orientationZ","panningModel","positionX","positionY","positionZ","refDistance","rolloffFactor"]);let C=h.createPanner();if(w.channelCount>2||"max"===w.channelCountMode)throw o();assignNativeAudioNodeOptions(C,w);let O={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},R=r(h,__spreadProps(__spreadValues({},O),{channelInterpretation:"speakers",numberOfInputs:6})),D=n(h,__spreadProps(__spreadValues({},w),{gain:1})),I=n(h,__spreadProps(__spreadValues({},O),{gain:1})),M=n(h,__spreadProps(__spreadValues({},O),{gain:0})),N=n(h,__spreadProps(__spreadValues({},O),{gain:0})),P=n(h,__spreadProps(__spreadValues({},O),{gain:0})),k=n(h,__spreadProps(__spreadValues({},O),{gain:0})),F=n(h,__spreadProps(__spreadValues({},O),{gain:0})),L=i(h,256,6,1),B=s(h,__spreadProps(__spreadValues({},O),{curve:new Float32Array([1,1]),oversample:"none"})),U=[g,v,y],G=[x,S,T];L.onaudioprocess=({inputBuffer:e})=>{let t=[e.getChannelData(0)[0],e.getChannelData(1)[0],e.getChannelData(2)[0]];t.some(((e,t)=>e!==U[t]))&&(C.setOrientation(...t),U=t);let r=[e.getChannelData(3)[0],e.getChannelData(4)[0],e.getChannelData(5)[0]];r.some(((e,t)=>e!==G[t]))&&(C.setPosition(...r),G=r)},Object.defineProperty(M.gain,"defaultValue",{get:()=>0}),Object.defineProperty(N.gain,"defaultValue",{get:()=>0}),Object.defineProperty(P.gain,"defaultValue",{get:()=>0}),Object.defineProperty(k.gain,"defaultValue",{get:()=>0}),Object.defineProperty(F.gain,"defaultValue",{get:()=>0});let j={get bufferSize(){},get channelCount(){return C.channelCount},set channelCount(e){if(e>2)throw o();D.channelCount=e,C.channelCount=e},get channelCountMode(){return C.channelCountMode},set channelCountMode(e){if("max"===e)throw o();D.channelCountMode=e,C.channelCountMode=e},get channelInterpretation(){return C.channelInterpretation},set channelInterpretation(e){D.channelInterpretation=e,C.channelInterpretation=e},get coneInnerAngle(){return C.coneInnerAngle},set coneInnerAngle(e){C.coneInnerAngle=e},get coneOuterAngle(){return C.coneOuterAngle},set coneOuterAngle(e){C.coneOuterAngle=e},get coneOuterGain(){return C.coneOuterGain},set coneOuterGain(e){if(e<0||e>1)throw t();C.coneOuterGain=e},get context(){return C.context},get distanceModel(){return C.distanceModel},set distanceModel(e){C.distanceModel=e},get inputs(){return[D]},get maxDistance(){return C.maxDistance},set maxDistance(e){if(e<0)throw new RangeError;C.maxDistance=e},get numberOfInputs(){return C.numberOfInputs},get numberOfOutputs(){return C.numberOfOutputs},get orientationX(){return I.gain},get orientationY(){return M.gain},get orientationZ(){return N.gain},get panningModel(){return C.panningModel},set panningModel(e){C.panningModel=e},get positionX(){return P.gain},get positionY(){return k.gain},get positionZ(){return F.gain},get refDistance(){return C.refDistance},set refDistance(e){if(e<0)throw new RangeError;C.refDistance=e},get rolloffFactor(){return C.rolloffFactor},set rolloffFactor(e){if(e<0)throw new RangeError;C.rolloffFactor=e},addEventListener:(...e)=>D.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>D.dispatchEvent(e[0]),removeEventListener:(...e)=>D.removeEventListener(e[0],e[1],e[2])};return d!==j.coneInnerAngle&&(j.coneInnerAngle=d),f!==j.coneOuterAngle&&(j.coneOuterAngle=f),p!==j.coneOuterGain&&(j.coneOuterGain=p),m!==j.distanceModel&&(j.distanceModel=m),_!==j.maxDistance&&(j.maxDistance=_),g!==j.orientationX.value&&(j.orientationX.value=g),v!==j.orientationY.value&&(j.orientationY.value=v),y!==j.orientationZ.value&&(j.orientationZ.value=y),b!==j.panningModel&&(j.panningModel=b),x!==j.positionX.value&&(j.positionX.value=x),S!==j.positionY.value&&(j.positionY.value=S),T!==j.positionZ.value&&(j.positionZ.value=T),E!==j.refDistance&&(j.refDistance=E),A!==j.rolloffFactor&&(j.rolloffFactor=A),(1!==U[0]||0!==U[1]||0!==U[2])&&C.setOrientation(...U),(0!==G[0]||0!==G[1]||0!==G[2])&&C.setPosition(...G),l(interceptConnections(j,C),(()=>{D.connect(C),e(D,B,0,0),B.connect(I).connect(R,0,0),B.connect(M).connect(R,0,1),B.connect(N).connect(R,0,2),B.connect(P).connect(R,0,3),B.connect(k).connect(R,0,4),B.connect(F).connect(R,0,5),R.connect(L).connect(h.destination)}),(()=>{D.disconnect(C),a(D,B,0,0),B.disconnect(I),I.disconnect(R),B.disconnect(M),M.disconnect(R),B.disconnect(N),N.disconnect(R),B.disconnect(P),P.disconnect(R),B.disconnect(k),k.disconnect(R),B.disconnect(F),F.disconnect(R),R.disconnect(L),L.disconnect(h.destination)}))},createNativePeriodicWaveFactory=e=>(t,{disableNormalization:r,imag:n,real:i})=>{let s=n instanceof Float32Array?n:new Float32Array(n),o=i instanceof Float32Array?i:new Float32Array(i),a=t.createPeriodicWave(o,s,{disableNormalization:r});if(Array.from(n).length<2)throw e();return a},createNativeScriptProcessorNode=(e,t,r,n)=>e.createScriptProcessor(t,r,n),createNativeStereoPannerNodeFactory=(e,t)=>(r,n)=>{let i=n.channelCountMode;if("clamped-max"===i)throw t();if(void 0===r.createStereoPanner)return e(r,n);let s=r.createStereoPanner();return assignNativeAudioNodeOptions(s,n),assignNativeAudioNodeAudioParamValue(s,n,"pan"),Object.defineProperty(s,"channelCountMode",{get:()=>i,set:e=>{if(e!==i)throw t()}}),s},createNativeStereoPannerNodeFakerFactory=(e,t,r,n,i,s)=>{let o=16385,a=new Float32Array([1,1]),l=Math.PI/2,h={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u=__spreadProps(__spreadValues({},h),{oversample:"none"}),c=(e,s,c,d,f)=>{if(1===s)return((e,t,i,s)=>{let c=new Float32Array(o),d=new Float32Array(o);for(let e=0;e<o;e+=1){let t=e/16384*l;c[e]=Math.cos(t),d[e]=Math.sin(t)}let f=r(e,__spreadProps(__spreadValues({},h),{gain:0})),p=n(e,__spreadProps(__spreadValues({},u),{curve:c})),m=n(e,__spreadProps(__spreadValues({},u),{curve:a})),_=r(e,__spreadProps(__spreadValues({},h),{gain:0})),g=n(e,__spreadProps(__spreadValues({},u),{curve:d}));return{connectGraph(){t.connect(f),t.connect(void 0===m.inputs?m:m.inputs[0]),t.connect(_),m.connect(i),i.connect(void 0===p.inputs?p:p.inputs[0]),i.connect(void 0===g.inputs?g:g.inputs[0]),p.connect(f.gain),g.connect(_.gain),f.connect(s,0,0),_.connect(s,0,1)},disconnectGraph(){t.disconnect(f),t.disconnect(void 0===m.inputs?m:m.inputs[0]),t.disconnect(_),m.disconnect(i),i.disconnect(void 0===p.inputs?p:p.inputs[0]),i.disconnect(void 0===g.inputs?g:g.inputs[0]),p.disconnect(f.gain),g.disconnect(_.gain),f.disconnect(s,0,0),_.disconnect(s,0,1)}}})(e,c,d,f);if(2===s)return((e,i,s,c)=>{let d=new Float32Array(o),f=new Float32Array(o),p=new Float32Array(o),m=new Float32Array(o),_=Math.floor(8192.5);for(let e=0;e<o;e+=1)if(e>_){let t=(e-_)/(16384-_)*l;d[e]=Math.cos(t),f[e]=Math.sin(t),p[e]=0,m[e]=1}else{let t=e/(16384-_)*l;d[e]=1,f[e]=0,p[e]=Math.cos(t),m[e]=Math.sin(t)}let g=t(e,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),v=r(e,__spreadProps(__spreadValues({},h),{gain:0})),y=n(e,__spreadProps(__spreadValues({},u),{curve:d})),b=r(e,__spreadProps(__spreadValues({},h),{gain:0})),x=n(e,__spreadProps(__spreadValues({},u),{curve:f})),S=n(e,__spreadProps(__spreadValues({},u),{curve:a})),T=r(e,__spreadProps(__spreadValues({},h),{gain:0})),E=n(e,__spreadProps(__spreadValues({},u),{curve:p})),A=r(e,__spreadProps(__spreadValues({},h),{gain:0})),w=n(e,__spreadProps(__spreadValues({},u),{curve:m}));return{connectGraph(){i.connect(g),i.connect(void 0===S.inputs?S:S.inputs[0]),g.connect(v,0),g.connect(b,0),g.connect(T,1),g.connect(A,1),S.connect(s),s.connect(void 0===y.inputs?y:y.inputs[0]),s.connect(void 0===x.inputs?x:x.inputs[0]),s.connect(void 0===E.inputs?E:E.inputs[0]),s.connect(void 0===w.inputs?w:w.inputs[0]),y.connect(v.gain),x.connect(b.gain),E.connect(T.gain),w.connect(A.gain),v.connect(c,0,0),T.connect(c,0,0),b.connect(c,0,1),A.connect(c,0,1)},disconnectGraph(){i.disconnect(g),i.disconnect(void 0===S.inputs?S:S.inputs[0]),g.disconnect(v,0),g.disconnect(b,0),g.disconnect(T,1),g.disconnect(A,1),S.disconnect(s),s.disconnect(void 0===y.inputs?y:y.inputs[0]),s.disconnect(void 0===x.inputs?x:x.inputs[0]),s.disconnect(void 0===E.inputs?E:E.inputs[0]),s.disconnect(void 0===w.inputs?w:w.inputs[0]),y.disconnect(v.gain),x.disconnect(b.gain),E.disconnect(T.gain),w.disconnect(A.gain),v.disconnect(c,0,0),T.disconnect(c,0,0),b.disconnect(c,0,1),A.disconnect(c,0,1)}}})(e,c,d,f);throw i()};return(t,n)=>{var o=n,{channelCount:a,channelCountMode:l,pan:h}=o,u=__objRest(o,["channelCount","channelCountMode","pan"]);if("max"===l)throw i();let d=e(t,__spreadProps(__spreadValues({},u),{channelCount:1,channelCountMode:l,numberOfInputs:2})),f=r(t,__spreadProps(__spreadValues({},u),{channelCount:a,channelCountMode:l,gain:1})),p=r(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:h}),{connectGraph:m,disconnectGraph:_}=c(t,a,f,p,d);Object.defineProperty(p.gain,"defaultValue",{get:()=>0}),Object.defineProperty(p.gain,"maxValue",{get:()=>1}),Object.defineProperty(p.gain,"minValue",{get:()=>-1});let g={get bufferSize(){},get channelCount(){return f.channelCount},set channelCount(e){f.channelCount!==e&&(v&&_(),({connectGraph:m,disconnectGraph:_}=c(t,e,f,p,d)),v&&m()),f.channelCount=e},get channelCountMode(){return f.channelCountMode},set channelCountMode(e){if("clamped-max"===e||"max"===e)throw i();f.channelCountMode=e},get channelInterpretation(){return f.channelInterpretation},set channelInterpretation(e){f.channelInterpretation=e},get context(){return f.context},get inputs(){return[f]},get numberOfInputs(){return f.numberOfInputs},get numberOfOutputs(){return f.numberOfOutputs},get pan(){return p.gain},addEventListener:(...e)=>f.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>f.dispatchEvent(e[0]),removeEventListener:(...e)=>f.removeEventListener(e[0],e[1],e[2])},v=!1;return s(interceptConnections(g,d),(()=>{m(),v=!0}),(()=>{_(),v=!1}))}},createNativeWaveShaperNodeFactory=(e,t,r,n,i,s,o)=>(a,l)=>{let h=a.createWaveShaper();if(null!==s&&"webkitAudioContext"===s.name&&void 0===a.createGain().gain.automationRate)return r(a,l);assignNativeAudioNodeOptions(h,l);let u=null===l.curve||l.curve instanceof Float32Array?l.curve:new Float32Array(l.curve);if(null!==u&&u.length<2)throw t();assignNativeAudioNodeOption(h,{curve:u},"curve"),assignNativeAudioNodeOption(h,l,"oversample");let c=null,d=!1;return o(h,"curve",(e=>()=>e.call(h)),(t=>r=>(t.call(h,r),d&&(n(r)&&null===c?c=e(a,h):!n(r)&&null!==c&&(c(),c=null)),r))),i(h,(()=>{d=!0,n(h.curve)&&(c=e(a,h))}),(()=>{d=!1,null!==c&&(c(),c=null)}))},createNativeWaveShaperNodeFakerFactory=(e,t,r,n,i)=>(s,o)=>{var a=o,{curve:l,oversample:h}=a,u=__objRest(a,["curve","oversample"]);let c=s.createWaveShaper(),d=s.createWaveShaper();assignNativeAudioNodeOptions(c,u),assignNativeAudioNodeOptions(d,u);let f=r(s,__spreadProps(__spreadValues({},u),{gain:1})),p=r(s,__spreadProps(__spreadValues({},u),{gain:-1})),m=r(s,__spreadProps(__spreadValues({},u),{gain:1})),_=r(s,__spreadProps(__spreadValues({},u),{gain:-1})),g=null,v=!1,y=null,b={get bufferSize(){},get channelCount(){return c.channelCount},set channelCount(e){f.channelCount=e,p.channelCount=e,c.channelCount=e,m.channelCount=e,d.channelCount=e,_.channelCount=e},get channelCountMode(){return c.channelCountMode},set channelCountMode(e){f.channelCountMode=e,p.channelCountMode=e,c.channelCountMode=e,m.channelCountMode=e,d.channelCountMode=e,_.channelCountMode=e},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(e){f.channelInterpretation=e,p.channelInterpretation=e,c.channelInterpretation=e,m.channelInterpretation=e,d.channelInterpretation=e,_.channelInterpretation=e},get context(){return c.context},get curve(){return y},set curve(r){if(null!==r&&r.length<2)throw t();if(null===r)c.curve=r,d.curve=r;else{let e=r.length,t=new Float32Array(e+2-e%2),n=new Float32Array(e+2-e%2);t[0]=r[0],n[0]=-r[e-1];let i=Math.ceil((e+1)/2),s=(e+1)/2-1;for(let o=1;o<i;o+=1){let a=o/i*s,l=Math.floor(a),h=Math.ceil(a);t[o]=l===h?r[l]:(1-(a-l))*r[l]+(1-(h-a))*r[h],n[o]=l===h?-r[e-1-l]:-(1-(a-l))*r[e-1-l]-(1-(h-a))*r[e-1-h]}t[i]=e%2==1?r[i-1]:(r[i-2]+r[i-1])/2,c.curve=t,d.curve=n}y=r,v&&(n(y)&&null===g?g=e(s,f):null!==g&&(g(),g=null))},get inputs(){return[f]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get oversample(){return c.oversample},set oversample(e){c.oversample=e,d.oversample=e},addEventListener:(...e)=>f.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>f.dispatchEvent(e[0]),removeEventListener:(...e)=>f.removeEventListener(e[0],e[1],e[2])};return null!==l&&(b.curve=l instanceof Float32Array?l:new Float32Array(l)),h!==b.oversample&&(b.oversample=h),i(interceptConnections(b,m),(()=>{f.connect(c).connect(m),f.connect(p).connect(d).connect(_).connect(m),v=!0,n(y)&&(g=e(s,f))}),(()=>{f.disconnect(c),c.disconnect(m),f.disconnect(p),p.disconnect(d),d.disconnect(_),_.disconnect(m),v=!1,null!==g&&(g(),g=null)}))},createNotSupportedError=()=>new DOMException("","NotSupportedError"),DEFAULT_OPTIONS16={numberOfChannels:1},createOfflineAudioContextConstructor=(e,t,r,n,i)=>class extends e{constructor(e,r,i){let s;if("number"==typeof e&&void 0!==r&&void 0!==i)s={length:r,numberOfChannels:e,sampleRate:i};else{if("object"!=typeof e)throw new Error("The given parameters are not valid.");s=e}let{length:o,numberOfChannels:a,sampleRate:l}=__spreadValues(__spreadValues({},DEFAULT_OPTIONS16),s),h=n(a,o,l);t(testPromiseSupport,(()=>testPromiseSupport(h)))||h.addEventListener("statechange",(()=>{let e=0,t=r=>{"running"===this._state&&(e>0?(h.removeEventListener("statechange",t),r.stopImmediatePropagation(),this._waitForThePromiseToSettle(r)):e+=1)};return t})()),super(h,a),this._length=o,this._nativeOfflineAudioContext=h,this._state=null}get length(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}get state(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}startRendering(){return"running"===this._state?Promise.reject(r()):(this._state="running",i(this.destination,this._nativeOfflineAudioContext).finally((()=>{this._state=null,deactivateAudioGraph(this)})))}_waitForThePromiseToSettle(e){null===this._state?this._nativeOfflineAudioContext.dispatchEvent(e):setTimeout((()=>this._waitForThePromiseToSettle(e)))}},DEFAULT_OPTIONS17={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},createOscillatorNodeConstructor=(e,t,r,n,i,s,o)=>class extends e{constructor(e,o){let a=i(e),l=__spreadValues(__spreadValues({},DEFAULT_OPTIONS17),o),h=r(a,l),u=s(a),c=u?n():null,d=e.sampleRate/2;super(e,!1,h,c),this._detune=t(this,u,h.detune,153600,-153600),this._frequency=t(this,u,h.frequency,d,-d),this._nativeOscillatorNode=h,this._onended=null,this._oscillatorNodeRenderer=c,null!==this._oscillatorNodeRenderer&&void 0!==l.periodicWave&&(this._oscillatorNodeRenderer.periodicWave=l.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(e){let t="function"==typeof e?o(this,e):null;this._nativeOscillatorNode.onended=t;let r=this._nativeOscillatorNode.onended;this._onended=null!==r&&r===t?e:r}get type(){return this._nativeOscillatorNode.type}set type(e){this._nativeOscillatorNode.type=e,null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(e){this._nativeOscillatorNode.setPeriodicWave(e),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=e)}start(e=0){if(this._nativeOscillatorNode.start(e),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.start=e),"closed"!==this.context.state){setInternalStateToActive(this);let e=()=>{this._nativeOscillatorNode.removeEventListener("ended",e),isActiveAudioNode(this)&&setInternalStateToPassive(this)};this._nativeOscillatorNode.addEventListener("ended",e)}}stop(e=0){this._nativeOscillatorNode.stop(e),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.stop=e)}},createOscillatorNodeRendererFactory=(e,t,r,n,i)=>()=>{let s=new WeakMap,o=null,a=null,l=null;return{set periodicWave(e){o=e},set start(e){a=e},set stop(e){l=e},render(h,u,c){let d=s.get(u);return void 0!==d?Promise.resolve(d):(async(h,u,c)=>{let d=r(h),f=isOwnedByContext(d,u);if(!f){let e={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,detune:d.detune.value,frequency:d.frequency.value,periodicWave:null===o?void 0:o,type:d.type};d=t(u,e),null!==a&&d.start(a),null!==l&&d.stop(l)}return s.set(u,d),f?(await e(u,h.detune,d.detune,c),await e(u,h.frequency,d.frequency,c)):(await n(u,h.detune,d.detune,c),await n(u,h.frequency,d.frequency,c)),await i(h,u,d,c),d})(h,u,c)}}},DEFAULT_OPTIONS18={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},createPannerNodeConstructor=(e,t,r,n,i,s,o)=>class extends e{constructor(e,a){let l=i(e),h=__spreadValues(__spreadValues({},DEFAULT_OPTIONS18),a),u=r(l,h),c=s(l);super(e,!1,u,c?n():null),this._nativePannerNode=u,this._orientationX=t(this,c,u.orientationX,MOST_POSITIVE_SINGLE_FLOAT,MOST_NEGATIVE_SINGLE_FLOAT),this._orientationY=t(this,c,u.orientationY,MOST_POSITIVE_SINGLE_FLOAT,MOST_NEGATIVE_SINGLE_FLOAT),this._orientationZ=t(this,c,u.orientationZ,MOST_POSITIVE_SINGLE_FLOAT,MOST_NEGATIVE_SINGLE_FLOAT),this._positionX=t(this,c,u.positionX,MOST_POSITIVE_SINGLE_FLOAT,MOST_NEGATIVE_SINGLE_FLOAT),this._positionY=t(this,c,u.positionY,MOST_POSITIVE_SINGLE_FLOAT,MOST_NEGATIVE_SINGLE_FLOAT),this._positionZ=t(this,c,u.positionZ,MOST_POSITIVE_SINGLE_FLOAT,MOST_NEGATIVE_SINGLE_FLOAT),o(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(e){this._nativePannerNode.coneInnerAngle=e}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(e){this._nativePannerNode.coneOuterAngle=e}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(e){this._nativePannerNode.coneOuterGain=e}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(e){this._nativePannerNode.distanceModel=e}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(e){this._nativePannerNode.maxDistance=e}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(e){this._nativePannerNode.panningModel=e}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(e){this._nativePannerNode.refDistance=e}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(e){this._nativePannerNode.rolloffFactor=e}},createPannerNodeRendererFactory=(e,t,r,n,i,s,o,a,l,h)=>()=>{let u=new WeakMap,c=null;return{render(d,f,p){let m=u.get(f);return void 0!==m?Promise.resolve(m):(async(d,f,p)=>{let m=null,_=s(d),g={channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation},v=__spreadProps(__spreadValues({},g),{coneInnerAngle:_.coneInnerAngle,coneOuterAngle:_.coneOuterAngle,coneOuterGain:_.coneOuterGain,distanceModel:_.distanceModel,maxDistance:_.maxDistance,panningModel:_.panningModel,refDistance:_.refDistance,rolloffFactor:_.rolloffFactor}),y=isOwnedByContext(_,f);if("bufferSize"in _)m=n(f,__spreadProps(__spreadValues({},g),{gain:1}));else if(!y){let e=__spreadProps(__spreadValues({},v),{orientationX:_.orientationX.value,orientationY:_.orientationY.value,orientationZ:_.orientationZ.value,positionX:_.positionX.value,positionY:_.positionY.value,positionZ:_.positionZ.value});_=i(f,e)}if(u.set(f,null===m?_:m),null!==m){if(null===c){if(null===o)throw new Error("Missing the native OfflineAudioContext constructor.");let e=new o(6,d.context.length,f.sampleRate),n=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});n.connect(e.destination),c=(async()=>{let t=await Promise.all([d.orientationX,d.orientationY,d.orientationZ,d.positionX,d.positionY,d.positionZ].map((async(t,n)=>{let i=r(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:0===n?1:0});return await a(e,t,i.offset,p),i})));for(let e=0;e<6;e+=1)t[e].connect(n,0,e),t[e].start(0);return h(e)})()}let e=await c,s=n(f,__spreadProps(__spreadValues({},g),{gain:1}));await l(d,f,s,p);let u=[];for(let t=0;t<e.numberOfChannels;t+=1)u.push(e.getChannelData(t));let _=[u[0][0],u[1][0],u[2][0]],y=[u[3][0],u[4][0],u[5][0]],b=n(f,__spreadProps(__spreadValues({},g),{gain:1})),x=i(f,__spreadProps(__spreadValues({},v),{orientationX:_[0],orientationY:_[1],orientationZ:_[2],positionX:y[0],positionY:y[1],positionZ:y[2]}));s.connect(b).connect(x.inputs[0]),x.connect(m);for(let t=128;t<e.length;t+=128){let e=[u[0][t],u[1][t],u[2][t]],r=[u[3][t],u[4][t],u[5][t]];if(e.some(((e,t)=>e!==_[t]))||r.some(((e,t)=>e!==y[t]))){_=e,y=r;let o=t/f.sampleRate;b.gain.setValueAtTime(0,o),b=n(f,__spreadProps(__spreadValues({},g),{gain:0})),x=i(f,__spreadProps(__spreadValues({},v),{orientationX:_[0],orientationY:_[1],orientationZ:_[2],positionX:y[0],positionY:y[1],positionZ:y[2]})),b.gain.setValueAtTime(1,o),s.connect(b).connect(x.inputs[0]),x.connect(m)}}return m}return y?(await e(f,d.orientationX,_.orientationX,p),await e(f,d.orientationY,_.orientationY,p),await e(f,d.orientationZ,_.orientationZ,p),await e(f,d.positionX,_.positionX,p),await e(f,d.positionY,_.positionY,p),await e(f,d.positionZ,_.positionZ,p)):(await a(f,d.orientationX,_.orientationX,p),await a(f,d.orientationY,_.orientationY,p),await a(f,d.orientationZ,_.orientationZ,p),await a(f,d.positionX,_.positionX,p),await a(f,d.positionY,_.positionY,p),await a(f,d.positionZ,_.positionZ,p)),isNativeAudioNodeFaker(_)?await l(d,f,_.inputs[0],p):await l(d,f,_,p),_})(d,f,p)}}},DEFAULT_OPTIONS19={disableNormalization:!1},createPeriodicWaveConstructor=(e,t,r,n)=>class i{constructor(i,s){let o=t(i),a=n(__spreadValues(__spreadValues({},DEFAULT_OPTIONS19),s)),l=e(o,a);return r.add(l),l}static[Symbol.hasInstance](e){return null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===i.prototype||r.has(e)}},createRenderAutomation=(e,t)=>(r,n,i,s)=>(e(n).replay(i),t(n,r,i,s)),createRenderInputsOfAudioNode=(e,t,r)=>async(n,i,s,o)=>{let a=e(n),l=[...o,n];await Promise.all(a.activeInputs.map(((e,o)=>Array.from(e).filter((([e])=>!l.includes(e))).map((async([e,a])=>{let h=await t(e).render(e,i,l),u=n.context.destination;!r(e)&&(n!==u||!r(n))&&h.connect(s,a,o)})))).reduce(((e,t)=>[...e,...t]),[]))},createRenderInputsOfAudioParam=(e,t,r)=>async(n,i,s,o)=>{let a=t(n);await Promise.all(Array.from(a.activeInputs).map((async([t,n])=>{let a=await e(t).render(t,i,o);r(t)||a.connect(s,n)})))},createRenderNativeOfflineAudioContext=(e,t,r,n)=>i=>e(testPromiseSupport,(()=>testPromiseSupport(i)))?Promise.resolve(e(n,n)).then((e=>{if(!e){let e=r(i,512,0,1);i.oncomplete=()=>{e.onaudioprocess=null,e.disconnect()},e.onaudioprocess=()=>i.currentTime,e.connect(i.destination)}return i.startRendering()})):new Promise((e=>{let r=t(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.oncomplete=t=>{r.disconnect(),e(t.renderedBuffer)},r.connect(i.destination),i.startRendering()})),createSetActiveAudioWorkletNodeInputs=e=>(t,r)=>{e.set(t,r)},createSetAudioNodeTailTime=e=>(t,r)=>e.set(t,r),createStartRendering=(e,t,r,n,i,s,o,a)=>{let l=[];return(h,u)=>r(h).render(h,u,l).then((()=>Promise.all(Array.from(n(u)).map((e=>r(e).render(e,u,l)))))).then((()=>i(u))).then((r=>("function"!=typeof r.copyFromChannel?(o(r),wrapAudioBufferGetChannelDataMethod(r)):t(s,(()=>s(r)))||a(r),e.add(r),r)))},DEFAULT_OPTIONS20={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},createStereoPannerNodeConstructor=(e,t,r,n,i,s)=>class extends e{constructor(e,o){let a=i(e),l=__spreadValues(__spreadValues({},DEFAULT_OPTIONS20),o),h=r(a,l),u=s(a);super(e,!1,h,u?n():null),this._pan=t(this,u,h.pan)}get pan(){return this._pan}},createStereoPannerNodeRendererFactory=(e,t,r,n,i)=>()=>{let s=new WeakMap;return{render(o,a,l){let h=s.get(a);return void 0!==h?Promise.resolve(h):(async(o,a,l)=>{let h=r(o),u=isOwnedByContext(h,a);if(!u){let e={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,pan:h.pan.value};h=t(a,e)}return s.set(a,h),u?await e(a,o.pan,h.pan,l):await n(a,o.pan,h.pan,l),isNativeAudioNodeFaker(h)?await i(o,a,h.inputs[0],l):await i(o,a,h,l),h})(o,a,l)}}},createTestAudioBufferConstructorSupport=e=>()=>{if(null===e)return!1;try{new e({length:1,sampleRate:44100})}catch(e){return!1}return!0},createTestAudioBufferCopyChannelMethodsSubarraySupport=e=>()=>{if(null===e)return!1;let t=new e(1,1,44100).createBuffer(1,1,44100);if(void 0===t.copyToChannel)return!0;let r=new Float32Array(2);try{t.copyFromChannel(r,0,0)}catch(e){return!1}return!0},createTestAudioContextCloseMethodSupport=e=>()=>{if(null===e)return!1;if(void 0!==e.prototype&&void 0!==e.prototype.close)return!0;let t=new e,r=void 0!==t.close;try{t.close()}catch(e){}return r},createTestAudioContextDecodeAudioDataMethodTypeErrorSupport=e=>()=>{if(null===e)return Promise.resolve(!1);let t=new e(1,1,44100);return new Promise((e=>{let r,n=!0,i=r=>{n&&(n=!1,t.startRendering(),e(r instanceof TypeError))};try{r=t.decodeAudioData(null,(()=>{}),i)}catch(e){i(e)}void 0!==r&&r.catch(i)}))},createTestAudioContextOptionsSupport=e=>()=>{if(null===e)return!1;let t;try{t=new e({latencyHint:"balanced"})}catch(e){return!1}return t.close(),!0},createTestAudioNodeConnectMethodSupport=e=>()=>{if(null===e)return!1;let t=new e(1,1,44100).createGain(),r=t.connect(t)===t;return t.disconnect(t),r},createTestAudioWorkletProcessorNoOutputsSupport=(e,t)=>async()=>{if(null===e)return!0;if(null===t)return!1;let r=new Blob(['let c,p;class A extends AudioWorkletProcessor{constructor(){super();this.port.onmessage=(e)=>{p=e.data;p.onmessage=()=>{p.postMessage(c);p.close()};this.port.postMessage(0)}}process(){c=1}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),n=new MessageChannel,i=new t(1,128,44100),s=URL.createObjectURL(r),o=!1;try{await i.audioWorklet.addModule(s);let t=new e(i,"a",{numberOfOutputs:0}),r=i.createOscillator();await new Promise((e=>{t.port.onmessage=()=>e(),t.port.postMessage(n.port2,[n.port2])})),t.port.onmessage=()=>o=!0,r.connect(t),r.start(0),await i.startRendering(),o=await new Promise((e=>{n.port1.onmessage=({data:t})=>e(1===t),n.port1.postMessage(0)}))}catch(e){}finally{n.port1.close(),URL.revokeObjectURL(s)}return o},createTestAudioWorkletProcessorPostMessageSupport=(e,t)=>async()=>{if(null===e)return!0;if(null===t)return!1;let r=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),n=new t(1,128,44100),i=URL.createObjectURL(r),s=!1,o=!1;try{await n.audioWorklet.addModule(i);let t=new e(n,"a",{numberOfOutputs:0}),r=n.createOscillator();t.port.onmessage=()=>s=!0,t.onprocessorerror=()=>o=!0,r.connect(t),r.start(0),await n.startRendering()}catch(e){}finally{URL.revokeObjectURL(i)}return s&&!o},createTestChannelMergerNodeChannelCountSupport=e=>()=>{if(null===e)return!1;let t=new e(1,1,44100).createChannelMerger();if("max"===t.channelCountMode)return!0;try{t.channelCount=2}catch(e){return!0}return!1},createTestConstantSourceNodeAccurateSchedulingSupport=e=>()=>{if(null===e)return!1;let t=new e(1,1,44100);return void 0===t.createConstantSource||t.createConstantSource().offset.maxValue!==Number.POSITIVE_INFINITY},createTestConvolverNodeBufferReassignabilitySupport=e=>()=>{if(null===e)return!1;let t=new e(1,1,44100),r=t.createConvolver();r.buffer=t.createBuffer(1,1,t.sampleRate);try{r.buffer=t.createBuffer(1,1,t.sampleRate)}catch(e){return!1}return!0},createTestConvolverNodeChannelCountSupport=e=>()=>{if(null===e)return!1;let t=new e(1,1,44100).createConvolver();try{t.channelCount=1}catch(e){return!1}return!0},createTestIsSecureContextSupport=e=>()=>null!==e&&e.hasOwnProperty("isSecureContext"),createTestMediaStreamAudioSourceNodeMediaStreamWithoutAudioTrackSupport=e=>()=>{if(null===e)return!1;let t=new e;try{return t.createMediaStreamSource(new MediaStream),!1}catch(e){return!0}},createTestOfflineAudioContextCurrentTimeSupport=(e,t)=>()=>{if(null===t)return Promise.resolve(!1);let r=new t(1,1,44100),n=e(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise((e=>{r.oncomplete=()=>{n.disconnect(),e(0!==r.currentTime)},r.startRendering()}))},createTestStereoPannerNodeDefaultValueSupport=e=>()=>{if(null===e)return Promise.resolve(!1);let t=new e(1,1,44100);if(void 0===t.createStereoPanner||void 0===t.createConstantSource)return Promise.resolve(!0);let r=t.createConstantSource(),n=t.createStereoPanner();return r.channelCount=1,r.offset.value=1,n.channelCount=1,r.start(),r.connect(n).connect(t.destination),t.startRendering().then((e=>1!==e.getChannelData(0)[0]))},createUnknownError=()=>new DOMException("","UnknownError"),DEFAULT_OPTIONS21={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},createWaveShaperNodeConstructor=(e,t,r,n,i,s,o)=>class extends e{constructor(e,t){let a=i(e),l=__spreadValues(__spreadValues({},DEFAULT_OPTIONS21),t),h=r(a,l);super(e,!0,h,s(a)?n():null),this._isCurveNullified=!1,this._nativeWaveShaperNode=h,o(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(e){if(null===e)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(e.length<2)throw t();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=e}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(e){this._nativeWaveShaperNode.oversample=e}},createWaveShaperNodeRendererFactory=(e,t,r)=>()=>{let n=new WeakMap;return{render(i,s,o){let a=n.get(s);return void 0!==a?Promise.resolve(a):(async(i,s,o)=>{let a=t(i);if(!isOwnedByContext(a,s)){let t={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=e(s,t)}return n.set(s,a),isNativeAudioNodeFaker(a)?await r(i,s,a.inputs[0],o):await r(i,s,a,o),a})(i,s,o)}}},createWindow=()=>"undefined"==typeof window?null:window,createWrapAudioBufferCopyChannelMethods=(e,t)=>r=>{r.copyFromChannel=(n,i,s=0)=>{let o=e(s),a=e(i);if(a>=r.numberOfChannels)throw t();let l=r.length,h=r.getChannelData(a),u=n.length;for(let e=o<0?-o:0;e+o<l&&e<u;e+=1)n[e]=h[e+o]},r.copyToChannel=(n,i,s=0)=>{let o=e(s),a=e(i);if(a>=r.numberOfChannels)throw t();let l=r.length,h=r.getChannelData(a),u=n.length;for(let e=o<0?-o:0;e+o<l&&e<u;e+=1)h[e+o]=n[e]}},createWrapAudioBufferCopyChannelMethodsOutOfBounds=e=>t=>{var r,n;t.copyFromChannel=(n=t.copyFromChannel,(r,i,s=0)=>{let o=e(s),a=e(i);if(o<t.length)return n.call(t,r,a,o)}),t.copyToChannel=(r=t.copyToChannel,(n,i,s=0)=>{let o=e(s),a=e(i);if(o<t.length)return r.call(t,n,a,o)})},createWrapAudioBufferSourceNodeStopMethodNullifiedBuffer=e=>(t,r)=>{let n=r.createBuffer(1,1,44100);null===t.buffer&&(t.buffer=n),e(t,"buffer",(e=>()=>{let r=e.call(t);return r===n?null:r}),(e=>r=>e.call(t,null===r?n:r)))},createWrapChannelMergerNode=(e,t)=>(r,n)=>{n.channelCount=1,n.channelCountMode="explicit",Object.defineProperty(n,"channelCount",{get:()=>1,set:()=>{throw e()}}),Object.defineProperty(n,"channelCountMode",{get:()=>"explicit",set:()=>{throw e()}});let i=r.createBufferSource();t(n,(()=>{let e=n.numberOfInputs;for(let t=0;t<e;t+=1)i.connect(n,0,t)}),(()=>i.disconnect(n)))},isDCCurve=e=>{if(null===e)return!1;let t=e.length;return t%2!=0?0!==e[Math.floor(t/2)]:e[t/2-1]+e[t/2]!==0},overwriteAccessors=(e,t,r,n)=>{let i=Object.getPrototypeOf(e);for(;!i.hasOwnProperty(t);)i=Object.getPrototypeOf(i);let{get:s,set:o}=Object.getOwnPropertyDescriptor(i,t);Object.defineProperty(e,t,{get:r(s),set:n(o)})},sanitizeAudioWorkletNodeOptions=e=>__spreadProps(__spreadValues({},e),{outputChannelCount:void 0!==e.outputChannelCount?e.outputChannelCount:1===e.numberOfInputs&&1===e.numberOfOutputs?[e.channelCount]:Array.from({length:e.numberOfOutputs},(()=>1))}),sanitizeChannelSplitterOptions=e=>__spreadProps(__spreadValues({},e),{channelCount:e.numberOfOutputs}),sanitizePeriodicWaveOptions=e=>{let{imag:t,real:r}=e;return __spreadProps(__spreadValues({},e),void 0===t?void 0===r?{imag:[0,0],real:[0,0]}:{imag:Array.from(r,(()=>0)),real:r}:void 0===r?{imag:t,real:Array.from(t,(()=>0))}:{imag:t,real:r})},setValueAtTimeUntilPossible=(e,t,r)=>{try{e.setValueAtTime(t,r)}catch(n){if(9!==n.code)throw n;setValueAtTimeUntilPossible(e,t,r+1e-7)}},testAudioBufferSourceNodeStartMethodConsecutiveCallsSupport=e=>{let t=e.createBufferSource();t.start();try{t.start()}catch(e){return!0}return!1},testAudioBufferSourceNodeStartMethodOffsetClampingSupport=e=>{let t=e.createBufferSource(),r=e.createBuffer(1,1,44100);t.buffer=r;try{t.start(0,1)}catch(e){return!1}return!0},testAudioBufferSourceNodeStopMethodNullifiedBufferSupport=e=>{let t=e.createBufferSource();t.start();try{t.stop()}catch(e){return!1}return!0},testAudioScheduledSourceNodeStartMethodNegativeParametersSupport=e=>{let t=e.createOscillator();try{t.start(-1)}catch(e){return e instanceof RangeError}return!1},testAudioScheduledSourceNodeStopMethodConsecutiveCallsSupport=e=>{let t=e.createBuffer(1,1,44100),r=e.createBufferSource();r.buffer=t,r.start(),r.stop();try{return r.stop(),!0}catch(e){return!1}},testAudioScheduledSourceNodeStopMethodNegativeParametersSupport=e=>{let t=e.createOscillator();try{t.stop(-1)}catch(e){return e instanceof RangeError}return!1},testAudioWorkletNodeOptionsClonability=e=>{let{port1:t,port2:r}=new MessageChannel;try{t.postMessage(e)}finally{t.close(),r.close()}},testDomExceptionConstructorSupport=()=>{try{new DOMException}catch(e){return!1}return!0},testTransferablesSupport=()=>new Promise((e=>{let t=new ArrayBuffer(0),{port1:r,port2:n}=new MessageChannel;r.onmessage=({data:t})=>e(null!==t),n.postMessage(t,[t])})),wrapAudioBufferSourceNodeStartMethodOffsetClamping=e=>{var t;e.start=(t=e.start,(r=0,n=0,i)=>{let s=e.buffer,o=null===s?n:Math.min(s.duration,n);null!==s&&o>s.duration-.5/e.context.sampleRate?t.call(e,r,0,0):t.call(e,r,o,i)})},wrapAudioScheduledSourceNodeStopMethodConsecutiveCalls=(e,t)=>{let r=t.createGain();e.connect(r);let n=(i=e.disconnect,()=>{i.call(e,r),e.removeEventListener("ended",n)});var i;e.addEventListener("ended",n),interceptConnections(e,r),e.stop=(t=>{let n=!1;return(i=0)=>{if(n)try{t.call(e,i)}catch(e){r.gain.setValueAtTime(0,i)}else t.call(e,i),n=!0}})(e.stop)},wrapEventListener=(e,t)=>r=>{let n={value:e};return Object.defineProperties(r,{currentTarget:n,target:n}),"function"==typeof t?t.call(e,r):t.handleEvent.call(e,r)},addActiveInputConnectionToAudioNode=createAddActiveInputConnectionToAudioNode(insertElementInSet),addPassiveInputConnectionToAudioNode=createAddPassiveInputConnectionToAudioNode(insertElementInSet),deleteActiveInputConnectionToAudioNode=createDeleteActiveInputConnectionToAudioNode(pickElementFromSet),audioNodeTailTimeStore=new WeakMap,getAudioNodeTailTime=createGetAudioNodeTailTime(audioNodeTailTimeStore),cacheTestResult=createCacheTestResult(new Map,new WeakMap),window2=createWindow(),createNativeAnalyserNode=createNativeAnalyserNodeFactory(cacheTestResult,createIndexSizeError),getAudioNodeRenderer=createGetAudioNodeRenderer(getAudioNodeConnections),renderInputsOfAudioNode=createRenderInputsOfAudioNode(getAudioNodeConnections,getAudioNodeRenderer,isPartOfACycle),createAnalyserNodeRenderer=createAnalyserNodeRendererFactory(createNativeAnalyserNode,getNativeAudioNode,renderInputsOfAudioNode),getNativeContext=createGetNativeContext(CONTEXT_STORE),nativeOfflineAudioContextConstructor=createNativeOfflineAudioContextConstructor(window2),isNativeOfflineAudioContext=createIsNativeOfflineAudioContext(nativeOfflineAudioContextConstructor),audioParamAudioNodeStore=new WeakMap,eventTargetConstructor=createEventTargetConstructor(wrapEventListener),nativeAudioContextConstructor=createNativeAudioContextConstructor(window2),isNativeAudioContext=createIsNativeAudioContext(nativeAudioContextConstructor),isNativeAudioNode2=createIsNativeAudioNode(window2),isNativeAudioParam=createIsNativeAudioParam(window2),audioNodeConstructor=createAudioNodeConstructor(createAddAudioNodeConnections(AUDIO_NODE_CONNECTIONS_STORE),createAddConnectionToAudioNode(addActiveInputConnectionToAudioNode,addPassiveInputConnectionToAudioNode,connectNativeAudioNodeToNativeAudioNode,deleteActiveInputConnectionToAudioNode,disconnectNativeAudioNodeFromNativeAudioNode,getAudioNodeConnections,getAudioNodeTailTime,getEventListenersOfAudioNode,getNativeAudioNode,insertElementInSet,isActiveAudioNode,isPartOfACycle,isPassiveAudioNode),cacheTestResult,createIncrementCycleCounterFactory(CYCLE_COUNTERS,disconnectNativeAudioNodeFromNativeAudioNode,getAudioNodeConnections,getNativeAudioNode,getNativeAudioParam,isActiveAudioNode),createIndexSizeError,createInvalidAccessError,createNotSupportedError,createDecrementCycleCounter(connectNativeAudioNodeToNativeAudioNode,CYCLE_COUNTERS,getAudioNodeConnections,getNativeAudioNode,getNativeAudioParam,getNativeContext,isActiveAudioNode,isNativeOfflineAudioContext),createDetectCycles(audioParamAudioNodeStore,getAudioNodeConnections,getValueForKey),eventTargetConstructor,getNativeContext,isNativeAudioContext,isNativeAudioNode2,isNativeAudioParam,isNativeOfflineAudioContext),analyserNodeConstructor=createAnalyserNodeConstructor(audioNodeConstructor,createAnalyserNodeRenderer,createIndexSizeError,createNativeAnalyserNode,getNativeContext,isNativeOfflineAudioContext),audioBufferStore=new WeakSet,nativeAudioBufferConstructor=createNativeAudioBufferConstructor(window2),convertNumberToUnsignedLong=createConvertNumberToUnsignedLong(new Uint32Array(1)),wrapAudioBufferCopyChannelMethods=createWrapAudioBufferCopyChannelMethods(convertNumberToUnsignedLong,createIndexSizeError),wrapAudioBufferCopyChannelMethodsOutOfBounds=createWrapAudioBufferCopyChannelMethodsOutOfBounds(convertNumberToUnsignedLong),audioBufferConstructor=createAudioBufferConstructor(audioBufferStore,cacheTestResult,createNotSupportedError,nativeAudioBufferConstructor,nativeOfflineAudioContextConstructor,createTestAudioBufferConstructorSupport(nativeAudioBufferConstructor),wrapAudioBufferCopyChannelMethods,wrapAudioBufferCopyChannelMethodsOutOfBounds),addSilentConnection=createAddSilentConnection(createNativeGainNode),renderInputsOfAudioParam=createRenderInputsOfAudioParam(getAudioNodeRenderer,getAudioParamConnections,isPartOfACycle),connectAudioParam=createConnectAudioParam(renderInputsOfAudioParam),createNativeAudioBufferSourceNode=createNativeAudioBufferSourceNodeFactory(addSilentConnection,cacheTestResult,testAudioBufferSourceNodeStartMethodConsecutiveCallsSupport,testAudioBufferSourceNodeStartMethodOffsetClampingSupport,testAudioBufferSourceNodeStopMethodNullifiedBufferSupport,testAudioScheduledSourceNodeStartMethodNegativeParametersSupport,testAudioScheduledSourceNodeStopMethodConsecutiveCallsSupport,testAudioScheduledSourceNodeStopMethodNegativeParametersSupport,wrapAudioBufferSourceNodeStartMethodOffsetClamping,createWrapAudioBufferSourceNodeStopMethodNullifiedBuffer(overwriteAccessors),wrapAudioScheduledSourceNodeStopMethodConsecutiveCalls),renderAutomation=createRenderAutomation(createGetAudioParamRenderer(getAudioParamConnections),renderInputsOfAudioParam),createAudioBufferSourceNodeRenderer=createAudioBufferSourceNodeRendererFactory(connectAudioParam,createNativeAudioBufferSourceNode,getNativeAudioNode,renderAutomation,renderInputsOfAudioNode),createAudioParam=createAudioParamFactory(createAddAudioParamConnections(AUDIO_PARAM_CONNECTIONS_STORE),audioParamAudioNodeStore,AUDIO_PARAM_STORE,createAudioParamRenderer,import_automation_events2.createCancelAndHoldAutomationEvent,import_automation_events2.createCancelScheduledValuesAutomationEvent,import_automation_events2.createExponentialRampToValueAutomationEvent,import_automation_events2.createLinearRampToValueAutomationEvent,import_automation_events2.createSetTargetAutomationEvent,import_automation_events2.createSetValueAutomationEvent,import_automation_events2.createSetValueCurveAutomationEvent,nativeAudioContextConstructor,setValueAtTimeUntilPossible),audioBufferSourceNodeConstructor=createAudioBufferSourceNodeConstructor(audioNodeConstructor,createAudioBufferSourceNodeRenderer,createAudioParam,createInvalidStateError,createNativeAudioBufferSourceNode,getNativeContext,isNativeOfflineAudioContext,wrapEventListener),audioDestinationNodeConstructor=createAudioDestinationNodeConstructor(audioNodeConstructor,createAudioDestinationNodeRenderer,createIndexSizeError,createInvalidStateError,createNativeAudioDestinationNodeFactory(createNativeGainNode,overwriteAccessors),getNativeContext,isNativeOfflineAudioContext,renderInputsOfAudioNode),createBiquadFilterNodeRenderer=createBiquadFilterNodeRendererFactory(connectAudioParam,createNativeBiquadFilterNode,getNativeAudioNode,renderAutomation,renderInputsOfAudioNode),setAudioNodeTailTime=createSetAudioNodeTailTime(audioNodeTailTimeStore),biquadFilterNodeConstructor=createBiquadFilterNodeConstructor(audioNodeConstructor,createAudioParam,createBiquadFilterNodeRenderer,createInvalidAccessError,createNativeBiquadFilterNode,getNativeContext,isNativeOfflineAudioContext,setAudioNodeTailTime),monitorConnections=createMonitorConnections(insertElementInSet,isNativeAudioNode2),wrapChannelMergerNode=createWrapChannelMergerNode(createInvalidStateError,monitorConnections),createNativeChannelMergerNode=createNativeChannelMergerNodeFactory(nativeAudioContextConstructor,wrapChannelMergerNode),createChannelMergerNodeRenderer=createChannelMergerNodeRendererFactory(createNativeChannelMergerNode,getNativeAudioNode,renderInputsOfAudioNode),channelMergerNodeConstructor=createChannelMergerNodeConstructor(audioNodeConstructor,createChannelMergerNodeRenderer,createNativeChannelMergerNode,getNativeContext,isNativeOfflineAudioContext),createChannelSplitterNodeRenderer=createChannelSplitterNodeRendererFactory(createNativeChannelSplitterNode,getNativeAudioNode,renderInputsOfAudioNode),channelSplitterNodeConstructor=createChannelSplitterNodeConstructor(audioNodeConstructor,createChannelSplitterNodeRenderer,createNativeChannelSplitterNode,getNativeContext,isNativeOfflineAudioContext,sanitizeChannelSplitterOptions),createNativeConstantSourceNodeFaker=createNativeConstantSourceNodeFakerFactory(addSilentConnection,createNativeAudioBufferSourceNode,createNativeGainNode,monitorConnections),createNativeConstantSourceNode=createNativeConstantSourceNodeFactory(addSilentConnection,cacheTestResult,createNativeConstantSourceNodeFaker,testAudioScheduledSourceNodeStartMethodNegativeParametersSupport,testAudioScheduledSourceNodeStopMethodNegativeParametersSupport),createConstantSourceNodeRenderer=createConstantSourceNodeRendererFactory(connectAudioParam,createNativeConstantSourceNode,getNativeAudioNode,renderAutomation,renderInputsOfAudioNode),constantSourceNodeConstructor=createConstantSourceNodeConstructor(audioNodeConstructor,createAudioParam,createConstantSourceNodeRenderer,createNativeConstantSourceNode,getNativeContext,isNativeOfflineAudioContext,wrapEventListener),createNativeConvolverNode=createNativeConvolverNodeFactory(createNotSupportedError,overwriteAccessors),createConvolverNodeRenderer=createConvolverNodeRendererFactory(createNativeConvolverNode,getNativeAudioNode,renderInputsOfAudioNode),convolverNodeConstructor=createConvolverNodeConstructor(audioNodeConstructor,createConvolverNodeRenderer,createNativeConvolverNode,getNativeContext,isNativeOfflineAudioContext,setAudioNodeTailTime),createDelayNodeRenderer=createDelayNodeRendererFactory(connectAudioParam,createNativeDelayNode,getNativeAudioNode,renderAutomation,renderInputsOfAudioNode),delayNodeConstructor=createDelayNodeConstructor(audioNodeConstructor,createAudioParam,createDelayNodeRenderer,createNativeDelayNode,getNativeContext,isNativeOfflineAudioContext,setAudioNodeTailTime),createNativeDynamicsCompressorNode=createNativeDynamicsCompressorNodeFactory(createNotSupportedError),createDynamicsCompressorNodeRenderer=createDynamicsCompressorNodeRendererFactory(connectAudioParam,createNativeDynamicsCompressorNode,getNativeAudioNode,renderAutomation,renderInputsOfAudioNode),dynamicsCompressorNodeConstructor=createDynamicsCompressorNodeConstructor(audioNodeConstructor,createAudioParam,createDynamicsCompressorNodeRenderer,createNativeDynamicsCompressorNode,createNotSupportedError,getNativeContext,isNativeOfflineAudioContext,setAudioNodeTailTime),createGainNodeRenderer=createGainNodeRendererFactory(connectAudioParam,createNativeGainNode,getNativeAudioNode,renderAutomation,renderInputsOfAudioNode),gainNodeConstructor=createGainNodeConstructor(audioNodeConstructor,createAudioParam,createGainNodeRenderer,createNativeGainNode,getNativeContext,isNativeOfflineAudioContext),createNativeIIRFilterNodeFaker=createNativeIIRFilterNodeFakerFactory(createInvalidAccessError,createInvalidStateError,createNativeScriptProcessorNode,createNotSupportedError),renderNativeOfflineAudioContext=createRenderNativeOfflineAudioContext(cacheTestResult,createNativeGainNode,createNativeScriptProcessorNode,createTestOfflineAudioContextCurrentTimeSupport(createNativeGainNode,nativeOfflineAudioContextConstructor)),createIIRFilterNodeRenderer=createIIRFilterNodeRendererFactory(createNativeAudioBufferSourceNode,getNativeAudioNode,nativeOfflineAudioContextConstructor,renderInputsOfAudioNode,renderNativeOfflineAudioContext),createNativeIIRFilterNode=createNativeIIRFilterNodeFactory(createNativeIIRFilterNodeFaker),iIRFilterNodeConstructor=createIIRFilterNodeConstructor(audioNodeConstructor,createNativeIIRFilterNode,createIIRFilterNodeRenderer,getNativeContext,isNativeOfflineAudioContext,setAudioNodeTailTime),createAudioListener=createAudioListenerFactory(createAudioParam,createNativeChannelMergerNode,createNativeConstantSourceNode,createNativeScriptProcessorNode,isNativeOfflineAudioContext),unrenderedAudioWorkletNodeStore=new WeakMap,minimalBaseAudioContextConstructor=createMinimalBaseAudioContextConstructor(audioDestinationNodeConstructor,createAudioListener,eventTargetConstructor,isNativeOfflineAudioContext,unrenderedAudioWorkletNodeStore,wrapEventListener),createNativeOscillatorNode=createNativeOscillatorNodeFactory(addSilentConnection,cacheTestResult,testAudioScheduledSourceNodeStartMethodNegativeParametersSupport,testAudioScheduledSourceNodeStopMethodConsecutiveCallsSupport,testAudioScheduledSourceNodeStopMethodNegativeParametersSupport,wrapAudioScheduledSourceNodeStopMethodConsecutiveCalls),createOscillatorNodeRenderer=createOscillatorNodeRendererFactory(connectAudioParam,createNativeOscillatorNode,getNativeAudioNode,renderAutomation,renderInputsOfAudioNode),oscillatorNodeConstructor=createOscillatorNodeConstructor(audioNodeConstructor,createAudioParam,createNativeOscillatorNode,createOscillatorNodeRenderer,getNativeContext,isNativeOfflineAudioContext,wrapEventListener),createConnectedNativeAudioBufferSourceNode=createConnectedNativeAudioBufferSourceNodeFactory(createNativeAudioBufferSourceNode),createNativeWaveShaperNodeFaker=createNativeWaveShaperNodeFakerFactory(createConnectedNativeAudioBufferSourceNode,createInvalidStateError,createNativeGainNode,isDCCurve,monitorConnections),createNativeWaveShaperNode=createNativeWaveShaperNodeFactory(createConnectedNativeAudioBufferSourceNode,createInvalidStateError,createNativeWaveShaperNodeFaker,isDCCurve,monitorConnections,nativeAudioContextConstructor,overwriteAccessors),createNativePannerNodeFaker=createNativePannerNodeFakerFactory(connectNativeAudioNodeToNativeAudioNode,createInvalidStateError,createNativeChannelMergerNode,createNativeGainNode,createNativeScriptProcessorNode,createNativeWaveShaperNode,createNotSupportedError,disconnectNativeAudioNodeFromNativeAudioNode,monitorConnections),createNativePannerNode=createNativePannerNodeFactory(createNativePannerNodeFaker),createPannerNodeRenderer=createPannerNodeRendererFactory(connectAudioParam,createNativeChannelMergerNode,createNativeConstantSourceNode,createNativeGainNode,createNativePannerNode,getNativeAudioNode,nativeOfflineAudioContextConstructor,renderAutomation,renderInputsOfAudioNode,renderNativeOfflineAudioContext),pannerNodeConstructor=createPannerNodeConstructor(audioNodeConstructor,createAudioParam,createNativePannerNode,createPannerNodeRenderer,getNativeContext,isNativeOfflineAudioContext,setAudioNodeTailTime),createNativePeriodicWave=createNativePeriodicWaveFactory(createIndexSizeError),periodicWaveConstructor=createPeriodicWaveConstructor(createNativePeriodicWave,getNativeContext,new WeakSet,sanitizePeriodicWaveOptions),nativeStereoPannerNodeFakerFactory=createNativeStereoPannerNodeFakerFactory(createNativeChannelMergerNode,createNativeChannelSplitterNode,createNativeGainNode,createNativeWaveShaperNode,createNotSupportedError,monitorConnections),createNativeStereoPannerNode=createNativeStereoPannerNodeFactory(nativeStereoPannerNodeFakerFactory,createNotSupportedError),createStereoPannerNodeRenderer=createStereoPannerNodeRendererFactory(connectAudioParam,createNativeStereoPannerNode,getNativeAudioNode,renderAutomation,renderInputsOfAudioNode),stereoPannerNodeConstructor=createStereoPannerNodeConstructor(audioNodeConstructor,createAudioParam,createNativeStereoPannerNode,createStereoPannerNodeRenderer,getNativeContext,isNativeOfflineAudioContext),createWaveShaperNodeRenderer=createWaveShaperNodeRendererFactory(createNativeWaveShaperNode,getNativeAudioNode,renderInputsOfAudioNode),waveShaperNodeConstructor=createWaveShaperNodeConstructor(audioNodeConstructor,createInvalidStateError,createNativeWaveShaperNode,createWaveShaperNodeRenderer,getNativeContext,isNativeOfflineAudioContext,setAudioNodeTailTime),isSecureContext=createIsSecureContext(window2),exposeCurrentFrameAndCurrentTime=createExposeCurrentFrameAndCurrentTime(window2),backupOfflineAudioContextStore=new WeakMap,getOrCreateBackupOfflineAudioContext=createGetOrCreateBackupOfflineAudioContext(backupOfflineAudioContextStore,nativeOfflineAudioContextConstructor),nativeAudioWorkletNodeConstructor=createNativeAudioWorkletNodeConstructor(window2),addAudioWorkletModule=isSecureContext?createAddAudioWorkletModule(cacheTestResult,createNotSupportedError,createEvaluateSource(window2),exposeCurrentFrameAndCurrentTime,createFetchSource(createAbortError),getNativeContext,getOrCreateBackupOfflineAudioContext,isNativeOfflineAudioContext,new WeakMap,new WeakMap,createTestAudioWorkletProcessorPostMessageSupport(nativeAudioWorkletNodeConstructor,nativeOfflineAudioContextConstructor),window2):void 0,isNativeContext=createIsNativeContext(isNativeAudioContext,isNativeOfflineAudioContext),decodeAudioData=createDecodeAudioData(audioBufferStore,cacheTestResult,createDataCloneError,createEncodingError,new WeakSet,getNativeContext,isNativeContext,testAudioBufferCopyChannelMethodsOutOfBoundsSupport,testPromiseSupport,wrapAudioBufferCopyChannelMethods,wrapAudioBufferCopyChannelMethodsOutOfBounds),baseAudioContextConstructor=createBaseAudioContextConstructor(addAudioWorkletModule,analyserNodeConstructor,audioBufferConstructor,audioBufferSourceNodeConstructor,biquadFilterNodeConstructor,channelMergerNodeConstructor,channelSplitterNodeConstructor,constantSourceNodeConstructor,convolverNodeConstructor,decodeAudioData,delayNodeConstructor,dynamicsCompressorNodeConstructor,gainNodeConstructor,iIRFilterNodeConstructor,minimalBaseAudioContextConstructor,oscillatorNodeConstructor,pannerNodeConstructor,periodicWaveConstructor,stereoPannerNodeConstructor,waveShaperNodeConstructor),mediaElementAudioSourceNodeConstructor=createMediaElementAudioSourceNodeConstructor(audioNodeConstructor,createNativeMediaElementAudioSourceNode,getNativeContext,isNativeOfflineAudioContext),mediaStreamAudioDestinationNodeConstructor=createMediaStreamAudioDestinationNodeConstructor(audioNodeConstructor,createNativeMediaStreamAudioDestinationNode,getNativeContext,isNativeOfflineAudioContext),mediaStreamAudioSourceNodeConstructor=createMediaStreamAudioSourceNodeConstructor(audioNodeConstructor,createNativeMediaStreamAudioSourceNode,getNativeContext,isNativeOfflineAudioContext),createNativeMediaStreamTrackAudioSourceNode=createNativeMediaStreamTrackAudioSourceNodeFactory(createInvalidStateError,isNativeOfflineAudioContext),mediaStreamTrackAudioSourceNodeConstructor=createMediaStreamTrackAudioSourceNodeConstructor(audioNodeConstructor,createNativeMediaStreamTrackAudioSourceNode,getNativeContext),audioContextConstructor=createAudioContextConstructor(baseAudioContextConstructor,createInvalidStateError,createNotSupportedError,createUnknownError,mediaElementAudioSourceNodeConstructor,mediaStreamAudioDestinationNodeConstructor,mediaStreamAudioSourceNodeConstructor,mediaStreamTrackAudioSourceNodeConstructor,nativeAudioContextConstructor),getUnrenderedAudioWorkletNodes=createGetUnrenderedAudioWorkletNodes(unrenderedAudioWorkletNodeStore),addUnrenderedAudioWorkletNode=createAddUnrenderedAudioWorkletNode(getUnrenderedAudioWorkletNodes),connectMultipleOutputs=createConnectMultipleOutputs(createIndexSizeError),deleteUnrenderedAudioWorkletNode=createDeleteUnrenderedAudioWorkletNode(getUnrenderedAudioWorkletNodes),disconnectMultipleOutputs=createDisconnectMultipleOutputs(createIndexSizeError),activeAudioWorkletNodeInputsStore=new WeakMap,getActiveAudioWorkletNodeInputs=createGetActiveAudioWorkletNodeInputs(activeAudioWorkletNodeInputsStore,getValueForKey),createNativeAudioWorkletNodeFaker=createNativeAudioWorkletNodeFakerFactory(connectMultipleOutputs,createIndexSizeError,createInvalidStateError,createNativeChannelMergerNode,createNativeChannelSplitterNode,createNativeConstantSourceNode,createNativeGainNode,createNativeScriptProcessorNode,createNotSupportedError,disconnectMultipleOutputs,exposeCurrentFrameAndCurrentTime,getActiveAudioWorkletNodeInputs,monitorConnections),createNativeAudioWorkletNode=createNativeAudioWorkletNodeFactory(createInvalidStateError,createNativeAudioWorkletNodeFaker,createNativeGainNode,createNotSupportedError,monitorConnections),createAudioWorkletNodeRenderer=createAudioWorkletNodeRendererFactory(connectAudioParam,connectMultipleOutputs,createNativeAudioBufferSourceNode,createNativeChannelMergerNode,createNativeChannelSplitterNode,createNativeConstantSourceNode,createNativeGainNode,deleteUnrenderedAudioWorkletNode,disconnectMultipleOutputs,exposeCurrentFrameAndCurrentTime,getNativeAudioNode,nativeAudioWorkletNodeConstructor,nativeOfflineAudioContextConstructor,renderAutomation,renderInputsOfAudioNode,renderNativeOfflineAudioContext),getBackupOfflineAudioContext=createGetBackupOfflineAudioContext(backupOfflineAudioContextStore),setActiveAudioWorkletNodeInputs=createSetActiveAudioWorkletNodeInputs(activeAudioWorkletNodeInputsStore),audioWorkletNodeConstructor=isSecureContext?createAudioWorkletNodeConstructor(addUnrenderedAudioWorkletNode,audioNodeConstructor,createAudioParam,createAudioWorkletNodeRenderer,createNativeAudioWorkletNode,getAudioNodeConnections,getBackupOfflineAudioContext,getNativeContext,isNativeOfflineAudioContext,nativeAudioWorkletNodeConstructor,sanitizeAudioWorkletNodeOptions,setActiveAudioWorkletNodeInputs,testAudioWorkletNodeOptionsClonability,wrapEventListener):void 0,minimalAudioContextConstructor=createMinimalAudioContextConstructor(createInvalidStateError,createNotSupportedError,createUnknownError,minimalBaseAudioContextConstructor,nativeAudioContextConstructor),createNativeOfflineAudioContext=createCreateNativeOfflineAudioContext(createNotSupportedError,nativeOfflineAudioContextConstructor),startRendering=createStartRendering(audioBufferStore,cacheTestResult,getAudioNodeRenderer,getUnrenderedAudioWorkletNodes,renderNativeOfflineAudioContext,testAudioBufferCopyChannelMethodsOutOfBoundsSupport,wrapAudioBufferCopyChannelMethods,wrapAudioBufferCopyChannelMethodsOutOfBounds),minimalOfflineAudioContextConstructor=createMinimalOfflineAudioContextConstructor(cacheTestResult,createInvalidStateError,createNativeOfflineAudioContext,minimalBaseAudioContextConstructor,startRendering),offlineAudioContextConstructor=createOfflineAudioContextConstructor(baseAudioContextConstructor,cacheTestResult,createInvalidStateError,createNativeOfflineAudioContext,startRendering),isAnyAudioContext=createIsAnyAudioContext(CONTEXT_STORE,isNativeAudioContext),isAnyAudioNode=createIsAnyAudioNode(AUDIO_NODE_STORE,isNativeAudioNode2),isAnyAudioParam=createIsAnyAudioParam(AUDIO_PARAM_STORE,isNativeAudioParam),isAnyOfflineAudioContext=createIsAnyOfflineAudioContext(CONTEXT_STORE,isNativeOfflineAudioContext),isSupported=()=>createIsSupportedPromise(cacheTestResult,createTestAudioBufferCopyChannelMethodsSubarraySupport(nativeOfflineAudioContextConstructor),createTestAudioContextCloseMethodSupport(nativeAudioContextConstructor),createTestAudioContextDecodeAudioDataMethodTypeErrorSupport(nativeOfflineAudioContextConstructor),createTestAudioContextOptionsSupport(nativeAudioContextConstructor),createTestAudioNodeConnectMethodSupport(nativeOfflineAudioContextConstructor),createTestAudioWorkletProcessorNoOutputsSupport(nativeAudioWorkletNodeConstructor,nativeOfflineAudioContextConstructor),createTestChannelMergerNodeChannelCountSupport(nativeOfflineAudioContextConstructor),createTestConstantSourceNodeAccurateSchedulingSupport(nativeOfflineAudioContextConstructor),createTestConvolverNodeBufferReassignabilitySupport(nativeOfflineAudioContextConstructor),createTestConvolverNodeChannelCountSupport(nativeOfflineAudioContextConstructor),testDomExceptionConstructorSupport,createTestIsSecureContextSupport(window2),createTestMediaStreamAudioSourceNodeMediaStreamWithoutAudioTrackSupport(nativeAudioContextConstructor),createTestStereoPannerNodeDefaultValueSupport(nativeOfflineAudioContextConstructor),testTransferablesSupport),Debug_exports={};function assert(e,t){if(!e)throw new Error(t)}function assertRange(e,t,r=1/0){if(!(t<=e&&e<=r))throw new RangeError(`Value must be within [${t}, ${r}], got: ${e}`)}function assertContextRunning(e){!e.isOffline&&"running"!==e.state&&warn('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}__export(Debug_exports,{assert:()=>assert,assertContextRunning:()=>assertContextRunning,assertRange:()=>assertRange,log:()=>log,setLogger:()=>setLogger,warn:()=>warn});var defaultLogger=console;function setLogger(e){defaultLogger=e}function log(...e){defaultLogger.log(...e)}function warn(...e){defaultLogger.warn(...e)}function isUndef(e){return void 0===e}function isDefined(e){return!isUndef(e)}function isFunction(e){return"function"==typeof e}function isNumber(e){return"number"==typeof e}function isObject(e){return"[object Object]"===Object.prototype.toString.call(e)&&e.constructor===Object}function isBoolean(e){return"boolean"==typeof e}function isArray2(e){return Array.isArray(e)}function isString(e){return"string"==typeof e}function isNote(e){return isString(e)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(e)}function createAudioContext(e){return new audioContextConstructor(e)}function createOfflineAudioContext(e,t,r){return new offlineAudioContextConstructor(e,t,r)}var theWindow="object"==typeof self?self:null,hasAudioContext=theWindow&&(theWindow.hasOwnProperty("AudioContext")||theWindow.hasOwnProperty("webkitAudioContext"));function createAudioWorkletNode(e,t,r){return assert(isDefined(audioWorkletNodeConstructor),"This node only works in a secure context (https or localhost)"),new audioWorkletNodeConstructor(e,t,r)}var import_tslib=__toModule(require_tslib()),{__extends:__extends25,__assign,__rest,__decorate,__param,__metadata,__awaiter:__awaiter2,__generator:__generator2,__exportStar,__createBinding,__values,__read,__spread,__spreadArrays,__spreadArray,__await,__asyncGenerator,__asyncDelegator,__asyncValues,__makeTemplateObject,__importStar,__importDefault,__classPrivateFieldGet,__classPrivateFieldSet}=import_tslib.default,Ticker3=class{constructor(e,t,r){this._callback=e,this._type=t,this._updateInterval=r,this._createClock()}_createWorker(){let e=new Blob([`\n\t\t\t// the initial timeout time\n\t\t\tlet timeoutTime =  ${(1e3*this._updateInterval).toFixed(1)};\n\t\t\t// onmessage callback\n\t\t\tself.onmessage = function(msg){\n\t\t\t\ttimeoutTime = parseInt(msg.data);\n\t\t\t};\n\t\t\t// the tick function which posts a message\n\t\t\t// and schedules a new tick\n\t\t\tfunction tick(){\n\t\t\t\tsetTimeout(tick, timeoutTime);\n\t\t\t\tself.postMessage('tick');\n\t\t\t}\n\t\t\t// call tick initially\n\t\t\ttick();\n\t\t\t`],{type:"text/javascript"}),t=URL.createObjectURL(e),r=new Worker(t);r.onmessage=this._callback.bind(this),this._worker=r}_createTimeout(){this._timeout=setTimeout((()=>{this._createTimeout(),this._callback()}),1e3*this._updateInterval)}_createClock(){if("worker"===this._type)try{this._createWorker()}catch(e){this._type="timeout",this._createClock()}else"timeout"===this._type&&this._createTimeout()}_disposeClock(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(e){this._updateInterval=Math.max(e,128/44100),"worker"===this._type&&this._worker.postMessage(Math.max(1e3*e,1))}get type(){return this._type}set type(e){this._disposeClock(),this._type=e,this._createClock()}dispose(){this._disposeClock()}};function isAudioParam(e){return isAnyAudioParam(e)}function isAudioNode2(e){return isAnyAudioNode(e)}function isOfflineAudioContext(e){return isAnyOfflineAudioContext(e)}function isAudioContext(e){return isAnyAudioContext(e)}function isAudioBuffer(e){return e instanceof AudioBuffer}function noCopy(e,t){return"value"===e||isAudioParam(t)||isAudioNode2(t)||isAudioBuffer(t)}function deepMerge(e,...t){if(!t.length)return e;let r=t.shift();if(isObject(e)&&isObject(r))for(let t in r)noCopy(t,r[t])?e[t]=r[t]:isObject(r[t])?(e[t]||Object.assign(e,{[t]:{}}),deepMerge(e[t],r[t])):Object.assign(e,{[t]:r[t]});return deepMerge(e,...t)}function deepEquals(e,t){return e.length===t.length&&e.every(((e,r)=>t[r]===e))}function optionsFromArguments(e,t,r=[],n){let i={},s=Array.from(t);if(isObject(s[0])&&n&&!Reflect.has(s[0],n)&&(Object.keys(s[0]).some((t=>Reflect.has(e,t)))||(deepMerge(i,{[n]:s[0]}),r.splice(r.indexOf(n),1),s.shift())),1===s.length&&isObject(s[0]))deepMerge(i,s[0]);else for(let e=0;e<r.length;e++)isDefined(s[e])&&(i[r[e]]=s[e]);return deepMerge(e,i)}function getDefaultsFromInstance(e){return e.constructor.getDefaults()}function defaultArg(e,t){return isUndef(e)?t:e}function omitFromObject(e,t){return t.forEach((t=>{Reflect.has(e,t)&&delete e[t]})),e}var Tone=class{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...e){(this.debug||theWindow&&this.toString()===theWindow.TONE_DEBUG_CLASS)&&log(this,...e)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}};Tone.version=version;var EPSILON=1e-6;function GT(e,t){return e>t+EPSILON}function GTE(e,t){return GT(e,t)||EQ(e,t)}function LT(e,t){return e+EPSILON<t}function EQ(e,t){return Math.abs(e-t)<EPSILON}function clamp(e,t,r){return Math.max(Math.min(e,r),t)}var Timeline=class extends Tone{constructor(){super(),this.name="Timeline",this._timeline=[];let e=optionsFromArguments(Timeline.getDefaults(),arguments,["memory"]);this.memory=e.memory,this.increasing=e.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(e){if(assert(Reflect.has(e,"time"),"Timeline: events must have a time attribute"),e.time=e.time.valueOf(),this.increasing&&this.length){let t=this._timeline[this.length-1];assert(GTE(e.time,t.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(e)}else{let t=this._search(e.time);this._timeline.splice(t+1,0,e)}if(this.length>this.memory){let e=this.length-this.memory;this._timeline.splice(0,e)}return this}remove(e){let t=this._timeline.indexOf(e);return-1!==t&&this._timeline.splice(t,1),this}get(e,t="time"){let r=this._search(e,t);return-1!==r?this._timeline[r]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(e,t="time"){let r=this._search(e,t);return r+1<this._timeline.length?this._timeline[r+1]:null}getBefore(e){let t=this._timeline.length;if(t>0&&this._timeline[t-1].time<e)return this._timeline[t-1];let r=this._search(e);return r-1>=0?this._timeline[r-1]:null}cancel(e){if(this._timeline.length>1){let t=this._search(e);if(t>=0)if(EQ(this._timeline[t].time,e)){for(let r=t;r>=0&&EQ(this._timeline[r].time,e);r--)t=r;this._timeline=this._timeline.slice(0,t)}else this._timeline=this._timeline.slice(0,t+1);else this._timeline=[]}else 1===this._timeline.length&&GTE(this._timeline[0].time,e)&&(this._timeline=[]);return this}cancelBefore(e){let t=this._search(e);return t>=0&&(this._timeline=this._timeline.slice(t+1)),this}previousEvent(e){let t=this._timeline.indexOf(e);return t>0?this._timeline[t-1]:null}_search(e,t="time"){if(0===this._timeline.length)return-1;let r=0,n=this._timeline.length,i=n;if(n>0&&this._timeline[n-1][t]<=e)return n-1;for(;r<i;){let n=Math.floor(r+(i-r)/2),s=this._timeline[n],o=this._timeline[n+1];if(EQ(s[t],e)){for(let r=n;r<this._timeline.length&&EQ(this._timeline[r][t],e);r++)n=r;return n}if(LT(s[t],e)&&GT(o[t],e))return n;GT(s[t],e)?i=n:r=n+1}return-1}_iterate(e,t=0,r=this._timeline.length-1){this._timeline.slice(t,r+1).forEach(e)}forEach(e){return this._iterate(e),this}forEachBefore(e,t){let r=this._search(e);return-1!==r&&this._iterate(t,0,r),this}forEachAfter(e,t){let r=this._search(e);return this._iterate(t,r+1),this}forEachBetween(e,t,r){let n=this._search(e),i=this._search(t);return-1!==n&&-1!==i?(this._timeline[n].time!==e&&(n+=1),this._timeline[i].time===t&&(i-=1),this._iterate(r,n,i)):-1===n&&this._iterate(r,0,i),this}forEachFrom(e,t){let r=this._search(e);for(;r>=0&&this._timeline[r].time>=e;)r--;return this._iterate(t,r+1),this}forEachAtTime(e,t){let r=this._search(e);if(-1!==r&&EQ(this._timeline[r].time,e)){let n=r;for(let t=r;t>=0&&EQ(this._timeline[t].time,e);t--)n=t;this._iterate((e=>{t(e)}),n,r)}return this}dispose(){return super.dispose(),this._timeline=[],this}},notifyNewContext=[];function onContextInit(e){notifyNewContext.push(e)}function initializeContext(e){notifyNewContext.forEach((t=>t(e)))}var notifyCloseContext=[];function onContextClose(e){notifyCloseContext.push(e)}function closeContext(e){notifyCloseContext.forEach((t=>t(e)))}var Emitter=class extends Tone{constructor(){super(...arguments),this.name="Emitter"}on(e,t){return e.split(/\W+/).forEach((e=>{isUndef(this._events)&&(this._events={}),this._events.hasOwnProperty(e)||(this._events[e]=[]),this._events[e].push(t)})),this}once(e,t){let r=(...n)=>{t(...n),this.off(e,r)};return this.on(e,r),this}off(e,t){return e.split(/\W+/).forEach((r=>{if(isUndef(this._events)&&(this._events={}),this._events.hasOwnProperty(e))if(isUndef(t))this._events[e]=[];else{let r=this._events[e];for(let e=r.length-1;e>=0;e--)r[e]===t&&r.splice(e,1)}})),this}emit(e,...t){if(this._events&&this._events.hasOwnProperty(e)){let r=this._events[e].slice(0);for(let e=0,n=r.length;e<n;e++)r[e].apply(this,t)}return this}static mixin(e){["on","once","off","emit"].forEach((t=>{let r=Object.getOwnPropertyDescriptor(Emitter.prototype,t);Object.defineProperty(e.prototype,t,r)}))}dispose(){return super.dispose(),this._events=void 0,this}},BaseContext=class extends Emitter{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}},Context=class extends BaseContext{constructor(){super(),this.name="Context",this._constants=new Map,this._timeouts=new Timeline,this._timeoutIds=0,this._initialized=!1,this.isOffline=!1,this._workletModules=new Map;let e=optionsFromArguments(Context.getDefaults(),arguments,["context"]);e.context?this._context=e.context:this._context=createAudioContext({latencyHint:e.latencyHint}),this._ticker=new Ticker3(this.emit.bind(this,"tick"),e.clockSource,e.updateInterval),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this._setLatencyHint(e.latencyHint),this.lookAhead=e.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){return this._initialized||(initializeContext(this),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(e,t,r){return this._context.createBuffer(e,t,r)}createChannelMerger(e){return this._context.createChannelMerger(e)}createChannelSplitter(e){return this._context.createChannelSplitter(e)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(e){return this._context.createDelay(e)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(e,t){return this._context.createIIRFilter(e,t)}createPanner(){return this._context.createPanner()}createPeriodicWave(e,t,r){return this._context.createPeriodicWave(e,t,r)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(e){return assert(isAudioContext(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(e)}createMediaElementSource(e){return assert(isAudioContext(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(e)}createMediaStreamDestination(){return assert(isAudioContext(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}decodeAudioData(e){return this._context.decodeAudioData(e)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(e){assert(!this._initialized,"The listener cannot be set after initialization."),this._listener=e}get transport(){return this.initialize(),this._transport}set transport(e){assert(!this._initialized,"The transport cannot be set after initialization."),this._transport=e}get draw(){return this.initialize(),this._draw}set draw(e){assert(!this._initialized,"Draw cannot be set after initialization."),this._draw=e}get destination(){return this.initialize(),this._destination}set destination(e){assert(!this._initialized,"The destination cannot be set after initialization."),this._destination=e}createAudioWorkletNode(e,t){return createAudioWorkletNode(this.rawContext,e,t)}addAudioWorkletModule(e,t){return __awaiter2(this,void 0,void 0,(function*(){assert(isDefined(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletModules.has(t)||this._workletModules.set(t,this.rawContext.audioWorklet.addModule(e)),yield this._workletModules.get(t)}))}workletsAreReady(){return __awaiter2(this,void 0,void 0,(function*(){let e=[];this._workletModules.forEach((t=>e.push(t))),yield Promise.all(e)}))}get updateInterval(){return this._ticker.updateInterval}set updateInterval(e){this._ticker.updateInterval=e}get clockSource(){return this._ticker.type}set clockSource(e){this._ticker.type=e}get latencyHint(){return this._latencyHint}_setLatencyHint(e){let t=0;if(this._latencyHint=e,isString(e))switch(e){case"interactive":t=.1;break;case"playback":t=.5;break;case"balanced":t=.25}this.lookAhead=t,this.updateInterval=t/2}get rawContext(){return this._context}now(){return this._context.currentTime+this.lookAhead}immediate(){return this._context.currentTime}resume(){return isAudioContext(this._context)?this._context.resume():Promise.resolve()}close(){return __awaiter2(this,void 0,void 0,(function*(){isAudioContext(this._context)&&(yield this._context.close()),this._initialized&&closeContext(this)}))}getConstant(e){if(this._constants.has(e))return this._constants.get(e);{let t=this._context.createBuffer(1,128,this._context.sampleRate),r=t.getChannelData(0);for(let t=0;t<r.length;t++)r[t]=e;let n=this._context.createBufferSource();return n.channelCount=1,n.channelCountMode="explicit",n.buffer=t,n.loop=!0,n.start(0),this._constants.set(e,n),n}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map((e=>this._constants[e].disconnect())),this}_timeoutLoop(){let e=this.now(),t=this._timeouts.peek();for(;this._timeouts.length&&t&&t.time<=e;)t.callback(),this._timeouts.shift(),t=this._timeouts.peek()}setTimeout(e,t){this._timeoutIds++;let r=this.now();return this._timeouts.add({callback:e,id:this._timeoutIds,time:r+t}),this._timeoutIds}clearTimeout(e){return this._timeouts.forEach((t=>{t.id===e&&this._timeouts.remove(t)})),this}clearInterval(e){return this.clearTimeout(e)}setInterval(e,t){let r=++this._timeoutIds,n=()=>{let i=this.now();this._timeouts.add({callback:()=>{e(),n()},id:r,time:i+t})};return n(),r}},DummyContext=class extends BaseContext{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(e,t,r){return{}}createChannelMerger(e){return{}}createChannelSplitter(e){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(e){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(e,t){return{}}createPanner(){return{}}createPeriodicWave(e,t,r){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(e){return{}}createMediaElementSource(e){return{}}createMediaStreamDestination(){return{}}decodeAudioData(e){return Promise.resolve({})}createAudioWorkletNode(e,t){return{}}get rawContext(){return{}}addAudioWorkletModule(e,t){return __awaiter2(this,void 0,void 0,(function*(){return Promise.resolve()}))}resume(){return Promise.resolve()}setTimeout(e,t){return 0}clearTimeout(e){return this}setInterval(e,t){return 0}clearInterval(e){return this}getConstant(e){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(e){}get destination(){return{}}set destination(e){}now(){return 0}immediate(){return 0}};function readOnly(e,t){isArray2(t)?t.forEach((t=>readOnly(e,t))):Object.defineProperty(e,t,{enumerable:!0,writable:!1})}function writable(e,t){isArray2(t)?t.forEach((t=>writable(e,t))):Object.defineProperty(e,t,{writable:!0})}var noOp=()=>{},ToneAudioBuffer=class extends Tone{constructor(){super(),this.name="ToneAudioBuffer",this.onload=noOp;let e=optionsFromArguments(ToneAudioBuffer.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=e.reverse,this.onload=e.onload,e.url&&isAudioBuffer(e.url)||e.url instanceof ToneAudioBuffer?this.set(e.url):isString(e.url)&&this.load(e.url).catch(e.onerror)}static getDefaults(){return{onerror:noOp,onload:noOp,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:getContext().sampleRate}set(e){return e instanceof ToneAudioBuffer?e.loaded?this._buffer=e.get():e.onload=()=>{this.set(e),this.onload(this)}:this._buffer=e,this._reversed&&this._reverse(),this}get(){return this._buffer}load(e){return __awaiter2(this,void 0,void 0,(function*(){let t=ToneAudioBuffer.load(e).then((e=>{this.set(e),this.onload(this)}));ToneAudioBuffer.downloads.push(t);try{yield t}finally{let e=ToneAudioBuffer.downloads.indexOf(t);ToneAudioBuffer.downloads.splice(e,1)}return this}))}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(e){let t=isArray2(e)&&e[0].length>0,r=t?e.length:1,n=t?e[0].length:e.length,i=getContext(),s=i.createBuffer(r,n,i.sampleRate),o=t||1!==r?e:[e];for(let e=0;e<r;e++)s.copyToChannel(o[e],e);return this._buffer=s,this}toMono(e){if(isNumber(e))this.fromArray(this.toArray(e));else{let e=new Float32Array(this.length),t=this.numberOfChannels;for(let r=0;r<t;r++){let t=this.toArray(r);for(let r=0;r<t.length;r++)e[r]+=t[r]}e=e.map((e=>e/t)),this.fromArray(e)}return this}toArray(e){if(isNumber(e))return this.getChannelData(e);if(1===this.numberOfChannels)return this.toArray(0);{let e=[];for(let t=0;t<this.numberOfChannels;t++)e[t]=this.getChannelData(t);return e}}getChannelData(e){return this._buffer?this._buffer.getChannelData(e):new Float32Array(0)}slice(e,t=this.duration){let r=Math.floor(e*this.sampleRate),n=Math.floor(t*this.sampleRate);assert(r<n,"The start time must be less than the end time");let i=n-r,s=getContext().createBuffer(this.numberOfChannels,i,this.sampleRate);for(let e=0;e<this.numberOfChannels;e++)s.copyToChannel(this.getChannelData(e).subarray(r,n),e);return new ToneAudioBuffer(s)}_reverse(){if(this.loaded)for(let e=0;e<this.numberOfChannels;e++)this.getChannelData(e).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(e){this._reversed!==e&&(this._reversed=e,this._reverse())}static fromArray(e){return(new ToneAudioBuffer).fromArray(e)}static fromUrl(e){return __awaiter2(this,void 0,void 0,(function*(){return yield(new ToneAudioBuffer).load(e)}))}static load(e){return __awaiter2(this,void 0,void 0,(function*(){let t=e.match(/\[([^\]\[]+\|.+)\]$/);if(t){let r=t[1].split("|"),n=r[0];for(let e of r)if(ToneAudioBuffer.supportsType(e)){n=e;break}e=e.replace(t[0],n)}let r=""===ToneAudioBuffer.baseUrl||ToneAudioBuffer.baseUrl.endsWith("/")?ToneAudioBuffer.baseUrl:ToneAudioBuffer.baseUrl+"/",n=yield fetch(r+e);if(!n.ok)throw new Error(`could not load url: ${e}`);let i=yield n.arrayBuffer();return yield getContext().decodeAudioData(i)}))}static supportsType(e){let t=e.split("."),r=t[t.length-1];return""!==document.createElement("audio").canPlayType("audio/"+r)}static loaded(){return __awaiter2(this,void 0,void 0,(function*(){for(yield Promise.resolve();ToneAudioBuffer.downloads.length;)yield ToneAudioBuffer.downloads[0]}))}};ToneAudioBuffer.baseUrl="",ToneAudioBuffer.downloads=[];var OfflineContext=class extends Context{constructor(){super({clockSource:"offline",context:isOfflineAudioContext(arguments[0])?arguments[0]:createOfflineAudioContext(arguments[0],arguments[1]*arguments[2],arguments[2]),lookAhead:0,updateInterval:isOfflineAudioContext(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=isOfflineAudioContext(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(e){return __awaiter2(this,void 0,void 0,(function*(){let t=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,t++;let r=Math.floor(this.sampleRate/128);e&&t%r==0&&(yield new Promise((e=>setTimeout(e,1))))}}))}render(e=!0){return __awaiter2(this,void 0,void 0,(function*(){yield this.workletsAreReady(),yield this._renderClock(e);let t=yield this._context.startRendering();return new ToneAudioBuffer(t)}))}close(){return Promise.resolve()}},dummyContext=new DummyContext,globalContext=dummyContext;function getContext(){return globalContext===dummyContext&&hasAudioContext&&setContext(new Context),globalContext}function setContext(e){globalContext=isAudioContext(e)?new Context(e):isOfflineAudioContext(e)?new OfflineContext(e):e}function start(){return globalContext.resume()}if(theWindow&&!theWindow.TONE_SILENCE_LOGGING){let e="v";"dev"===version&&(e="");let t=` * Tone.js ${e}${version} * `;console.log(`%c${t}`,"background: #000; color: #fff")}function dbToGain(e){return Math.pow(10,e/20)}function gainToDb(e){return Math.log(e)/Math.LN10*20}function intervalToFrequencyRatio(e){return Math.pow(2,e/12)}var A4=440;function getA4(){return A4}function setA4(e){A4=e}function ftom(e){return Math.round(ftomf(e))}function ftomf(e){return 69+12*Math.log2(e/A4)}function mtof(e){return A4*Math.pow(2,(e-69)/12)}var TimeBaseClass=class extends Tone{constructor(e,t,r){super(),this.defaultUnits="s",this._val=t,this._units=r,this.context=e,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:e=>this._frequencyToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:e=>this._ticksToUnits(parseInt(e,10)),regexp:/^(\d+)i$/i},m:{method:e=>this._beatsToUnits(parseInt(e,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(e,t)=>{let r=parseInt(e,10),n="."===t?1.5:1;return 1===r?this._beatsToUnits(this._getTimeSignature())*n:this._beatsToUnits(4/r)*n},regexp:/^(\d+)n(\.?)$/i},number:{method:e=>this._expressions[this.defaultUnits].method.call(this,e),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:e=>this._secondsToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:e=>parseInt(e,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:e=>{let t=parseInt(e,10);return this._beatsToUnits(8/(3*Math.floor(t)))},regexp:/^(\d+)t$/i},tr:{method:(e,t,r)=>{let n=0;return e&&"0"!==e&&(n+=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&"0"!==t&&(n+=this._beatsToUnits(parseFloat(t))),r&&"0"!==r&&(n+=this._beatsToUnits(parseFloat(r)/4)),n},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof TimeBaseClass&&this.fromType(this._val),isUndef(this._val))return this._noArg();if(isString(this._val)&&isUndef(this._units)){for(let e in this._expressions)if(this._expressions[e].regexp.test(this._val.trim())){this._units=e;break}}else if(isObject(this._val)){let e=0;for(let t in this._val)if(isDefined(this._val[t])){let r=this._val[t];e+=new this.constructor(this.context,t).valueOf()*r}return e}if(isDefined(this._units)){let e=this._expressions[this._units],t=this._val.toString().trim().match(e.regexp);return t?e.method.apply(this,t.slice(1)):e.method.call(this,this._val)}return isString(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(e){return 1/e}_beatsToUnits(e){return 60/this._getBpm()*e}_secondsToUnits(e){return e}_ticksToUnits(e){return e*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(e){switch(this._units=void 0,this.defaultUnits){case"s":this._val=e.toSeconds();break;case"i":this._val=e.toTicks();break;case"hz":this._val=e.toFrequency();break;case"midi":this._val=e.toMidi()}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return 1e3*this.toSeconds()}},TimeClass=class extends TimeBaseClass{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:e=>this._now()+new this.constructor(this.context,e).valueOf(),regexp:/^\+(.+)/},quantize:{method:e=>{let t=new TimeClass(this.context,e).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(t))},regexp:/^@(.+)/}})}quantize(e,t=1){let r=new this.constructor(this.context,e).valueOf(),n=this.valueOf();return n+(Math.round(n/r)*r-n)*t}toNotation(){let e=this.toSeconds(),t=["1m"];for(let e=1;e<9;e++){let r=Math.pow(2,e);t.push(r+"n."),t.push(r+"n"),t.push(r+"t")}t.push("0");let r=t[0],n=new TimeClass(this.context,t[0]).toSeconds();return t.forEach((t=>{let i=new TimeClass(this.context,t).toSeconds();Math.abs(i-e)<Math.abs(n-e)&&(r=t,n=i)})),r}toBarsBeatsSixteenths(){let e=this._beatsToUnits(1),t=this.valueOf()/e;t=parseFloat(t.toFixed(4));let r=Math.floor(t/this._getTimeSignature()),n=t%1*4;t=Math.floor(t)%this._getTimeSignature();let i=n.toString();return i.length>3&&(n=parseFloat(parseFloat(i).toFixed(3))),[r,t,n].join(":")}toTicks(){let e=this._beatsToUnits(1),t=this.valueOf()/e;return Math.round(t*this._getPPQ())}toSeconds(){return this.valueOf()}toMidi(){return ftom(this.toFrequency())}_now(){return this.context.now()}};function Time(e,t){return new TimeClass(getContext(),e,t)}var FrequencyClass=class extends TimeClass{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return getA4()}static set A4(e){setA4(e)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(e){return"midi"===this.defaultUnits?e:FrequencyClass.mtof(e)}},note:{regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method(e,t){let r=noteToScaleIndex[e.toLowerCase()]+12*(parseInt(t,10)+1);return"midi"===this.defaultUnits?r:FrequencyClass.mtof(r)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(e,t,r){let n=1;return e&&"0"!==e&&(n*=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&"0"!==t&&(n*=this._beatsToUnits(parseFloat(t))),r&&"0"!==r&&(n*=this._beatsToUnits(parseFloat(r)/4)),n}}})}transpose(e){return new FrequencyClass(this.context,this.valueOf()*intervalToFrequencyRatio(e))}harmonize(e){return e.map((e=>this.transpose(e)))}toMidi(){return ftom(this.valueOf())}toNote(){let e=this.toFrequency(),t=Math.log2(e/FrequencyClass.A4),r=Math.round(12*t)+57,n=Math.floor(r/12);return n<0&&(r+=-12*n),scaleIndexToNote[r%12]+n.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){let e=this._beatsToUnits(1),t=this.valueOf()/e;return Math.floor(t*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(e){return e}_ticksToUnits(e){return 1/(60*e/(this._getBpm()*this._getPPQ()))}_beatsToUnits(e){return 1/super._beatsToUnits(e)}_secondsToUnits(e){return 1/e}static mtof(e){return mtof(e)}static ftom(e){return ftom(e)}},noteToScaleIndex={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},scaleIndexToNote=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function Frequency(e,t){return new FrequencyClass(getContext(),e,t)}var TransportTimeClass=class extends TimeClass{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}};function TransportTime(e,t){return new TransportTimeClass(getContext(),e,t)}var ToneWithContext=class extends Tone{constructor(){super();let e=optionsFromArguments(ToneWithContext.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=e.context}static getDefaults(){return{context:getContext()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(e){return new TimeClass(this.context,e).toSeconds()}toFrequency(e){return new FrequencyClass(this.context,e).toFrequency()}toTicks(e){return new TransportTimeClass(this.context,e).toTicks()}_getPartialProperties(e){let t=this.get();return Object.keys(t).forEach((r=>{isUndef(e[r])&&delete t[r]})),t}get(){let e=getDefaultsFromInstance(this);return Object.keys(e).forEach((t=>{if(Reflect.has(this,t)){let r=this[t];isDefined(r)&&isDefined(r.value)&&isDefined(r.setValueAtTime)?e[t]=r.value:r instanceof ToneWithContext?e[t]=r._getPartialProperties(e[t]):isArray2(r)||isNumber(r)||isString(r)||isBoolean(r)?e[t]=r:delete e[t]}})),e}set(e){return Object.keys(e).forEach((t=>{Reflect.has(this,t)&&isDefined(this[t])&&(this[t]&&isDefined(this[t].value)&&isDefined(this[t].setValueAtTime)?this[t].value!==e[t]&&(this[t].value=e[t]):this[t]instanceof ToneWithContext?this[t].set(e[t]):this[t]=e[t])})),this}},StateTimeline=class extends Timeline{constructor(e="stopped"){super(),this.name="StateTimeline",this._initial=e,this.setStateAtTime(this._initial,0)}getValueAtTime(e){let t=this.get(e);return null!==t?t.state:this._initial}setStateAtTime(e,t,r){return assertRange(t,0),this.add(Object.assign({},r,{state:e,time:t})),this}getLastState(e,t){for(let r=this._search(t);r>=0;r--){let t=this._timeline[r];if(t.state===e)return t}}getNextState(e,t){let r=this._search(t);if(-1!==r)for(let t=r;t<this._timeline.length;t++){let r=this._timeline[t];if(r.state===e)return r}}},Param=class extends ToneWithContext{constructor(){super(optionsFromArguments(Param.getDefaults(),arguments,["param","units","convert"])),this.name="Param",this.overridden=!1,this._minOutput=1e-7;let e=optionsFromArguments(Param.getDefaults(),arguments,["param","units","convert"]);for(assert(isDefined(e.param)&&(isAudioParam(e.param)||e.param instanceof Param),"param must be an AudioParam");!isAudioParam(e.param);)e.param=e.param._param;this._swappable=!!isDefined(e.swappable)&&e.swappable,this._swappable?(this.input=this.context.createGain(),this._param=e.param,this.input.connect(this._param)):this._param=this.input=e.param,this._events=new Timeline(1e3),this._initialValue=this._param.defaultValue,this.units=e.units,this.convert=e.convert,this._minValue=e.minValue,this._maxValue=e.maxValue,isDefined(e.value)&&e.value!==this._toType(this._initialValue)&&this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(ToneWithContext.getDefaults(),{convert:!0,units:"number"})}get value(){let e=this.now();return this.getValueAtTime(e)}set value(e){this.cancelScheduledValues(this.now()),this.setValueAtTime(e,this.now())}get minValue(){return isDefined(this._minValue)?this._minValue:"time"===this.units||"frequency"===this.units||"normalRange"===this.units||"positive"===this.units||"transportTime"===this.units||"ticks"===this.units||"bpm"===this.units||"hertz"===this.units||"samples"===this.units?0:"audioRange"===this.units?-1:"decibels"===this.units?-1/0:this._param.minValue}get maxValue(){return isDefined(this._maxValue)?this._maxValue:"normalRange"===this.units||"audioRange"===this.units?1:this._param.maxValue}_is(e,t){return this.units===t}_assertRange(e){return isDefined(this.maxValue)&&isDefined(this.minValue)&&assertRange(e,this._fromType(this.minValue),this._fromType(this.maxValue)),e}_fromType(e){return this.convert&&!this.overridden?this._is(e,"time")?this.toSeconds(e):this._is(e,"decibels")?dbToGain(e):this._is(e,"frequency")?this.toFrequency(e):e:this.overridden?0:e}_toType(e){return this.convert&&"decibels"===this.units?gainToDb(e):e}setValueAtTime(e,t){let r=this.toSeconds(t),n=this._fromType(e);return assert(isFinite(n)&&isFinite(r),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._assertRange(n),this.log(this.units,"setValueAtTime",e,r),this._events.add({time:r,type:"setValueAtTime",value:n}),this._param.setValueAtTime(n,r),this}getValueAtTime(e){let t=Math.max(this.toSeconds(e),0),r=this._events.getAfter(t),n=this._events.get(t),i=this._initialValue;if(null===n)i=this._initialValue;else if("setTargetAtTime"!==n.type||null!==r&&"setValueAtTime"!==r.type)if(null===r)i=n.value;else if("linearRampToValueAtTime"===r.type||"exponentialRampToValueAtTime"===r.type){let e=n.value;if("setTargetAtTime"===n.type){let t=this._events.getBefore(n.time);e=null===t?this._initialValue:t.value}i="linearRampToValueAtTime"===r.type?this._linearInterpolate(n.time,e,r.time,r.value,t):this._exponentialInterpolate(n.time,e,r.time,r.value,t)}else i=n.value;else{let e,r=this._events.getBefore(n.time);e=null===r?this._initialValue:r.value,"setTargetAtTime"===n.type&&(i=this._exponentialApproach(n.time,e,n.value,n.constant,t))}return this._toType(i)}setRampPoint(e){e=this.toSeconds(e);let t=this.getValueAtTime(e);return this.cancelAndHoldAtTime(e),0===this._fromType(t)&&(t=this._toType(this._minOutput)),this.setValueAtTime(t,e),this}linearRampToValueAtTime(e,t){let r=this._fromType(e),n=this.toSeconds(t);return assert(isFinite(r)&&isFinite(n),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._assertRange(r),this._events.add({time:n,type:"linearRampToValueAtTime",value:r}),this.log(this.units,"linearRampToValueAtTime",e,n),this._param.linearRampToValueAtTime(r,n),this}exponentialRampToValueAtTime(e,t){let r=this._fromType(e);r=EQ(r,0)?this._minOutput:r,this._assertRange(r);let n=this.toSeconds(t);return assert(isFinite(r)&&isFinite(n),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._events.add({time:n,type:"exponentialRampToValueAtTime",value:r}),this.log(this.units,"exponentialRampToValueAtTime",e,n),this._param.exponentialRampToValueAtTime(r,n),this}exponentialRampTo(e,t,r){return r=this.toSeconds(r),this.setRampPoint(r),this.exponentialRampToValueAtTime(e,r+this.toSeconds(t)),this}linearRampTo(e,t,r){return r=this.toSeconds(r),this.setRampPoint(r),this.linearRampToValueAtTime(e,r+this.toSeconds(t)),this}targetRampTo(e,t,r){return r=this.toSeconds(r),this.setRampPoint(r),this.exponentialApproachValueAtTime(e,r,t),this}exponentialApproachValueAtTime(e,t,r){t=this.toSeconds(t),r=this.toSeconds(r);let n=Math.log(r+1)/Math.log(200);return this.setTargetAtTime(e,t,n),this.cancelAndHoldAtTime(t+.9*r),this.linearRampToValueAtTime(e,t+r),this}setTargetAtTime(e,t,r){let n=this._fromType(e);assert(isFinite(r)&&r>0,"timeConstant must be a number greater than 0");let i=this.toSeconds(t);return this._assertRange(n),assert(isFinite(n)&&isFinite(i),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._events.add({constant:r,time:i,type:"setTargetAtTime",value:n}),this.log(this.units,"setTargetAtTime",e,i,r),this._param.setTargetAtTime(n,i,r),this}setValueCurveAtTime(e,t,r,n=1){r=this.toSeconds(r),t=this.toSeconds(t);let i=this._fromType(e[0])*n;this.setValueAtTime(this._toType(i),t);let s=r/(e.length-1);for(let r=1;r<e.length;r++){let i=this._fromType(e[r])*n;this.linearRampToValueAtTime(this._toType(i),t+r*s)}return this}cancelScheduledValues(e){let t=this.toSeconds(e);return assert(isFinite(t),`Invalid argument to cancelScheduledValues: ${JSON.stringify(e)}`),this._events.cancel(t),this._param.cancelScheduledValues(t),this.log(this.units,"cancelScheduledValues",t),this}cancelAndHoldAtTime(e){let t=this.toSeconds(e),r=this._fromType(this.getValueAtTime(t));assert(isFinite(t),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(e)}`),this.log(this.units,"cancelAndHoldAtTime",t,"value="+r);let n=this._events.get(t),i=this._events.getAfter(t);return n&&EQ(n.time,t)?i?(this._param.cancelScheduledValues(i.time),this._events.cancel(i.time)):(this._param.cancelAndHoldAtTime(t),this._events.cancel(t+this.sampleTime)):i&&(this._param.cancelScheduledValues(i.time),this._events.cancel(i.time),"linearRampToValueAtTime"===i.type?this.linearRampToValueAtTime(this._toType(r),t):"exponentialRampToValueAtTime"===i.type&&this.exponentialRampToValueAtTime(this._toType(r),t)),this._events.add({time:t,type:"setValueAtTime",value:r}),this._param.setValueAtTime(r,t),this}rampTo(e,t=.1,r){return"frequency"===this.units||"bpm"===this.units||"decibels"===this.units?this.exponentialRampTo(e,t,r):this.linearRampTo(e,t,r),this}apply(e){let t=this.context.currentTime;e.setValueAtTime(this.getValueAtTime(t),t);let r=this._events.get(t);if(r&&"setTargetAtTime"===r.type){let n=this._events.getAfter(r.time),i=n?n.time:t+2,s=(i-t)/10;for(let r=t;r<i;r+=s)e.linearRampToValueAtTime(this.getValueAtTime(r),r)}return this._events.forEachAfter(this.context.currentTime,(t=>{"cancelScheduledValues"===t.type?e.cancelScheduledValues(t.time):"setTargetAtTime"===t.type?e.setTargetAtTime(t.value,t.time,t.constant):e[t.type](t.value,t.time)})),this}setParam(e){assert(this._swappable,"The Param must be assigned as 'swappable' in the constructor");let t=this.input;return t.disconnect(this._param),this.apply(e),this._param=e,t.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(e,t,r,n,i){return r+(t-r)*Math.exp(-(i-e)/n)}_linearInterpolate(e,t,r,n,i){return t+(i-e)/(r-e)*(n-t)}_exponentialInterpolate(e,t,r,n,i){return t*Math.pow(n/t,(i-e)/(r-e))}},ToneAudioNode=class extends ToneWithContext{constructor(){super(...arguments),this.name="ToneAudioNode",this._internalChannels=[]}get numberOfInputs(){return isDefined(this.input)?isAudioParam(this.input)||this.input instanceof Param?1:this.input.numberOfInputs:0}get numberOfOutputs(){return isDefined(this.output)?this.output.numberOfOutputs:0}_isAudioNode(e){return isDefined(e)&&(e instanceof ToneAudioNode||isAudioNode2(e))}_getInternalNodes(){let e=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&e.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&e.push(this.output),e}_setChannelProperties(e){this._getInternalNodes().forEach((t=>{t.channelCount=e.channelCount,t.channelCountMode=e.channelCountMode,t.channelInterpretation=e.channelInterpretation}))}_getChannelProperties(){let e=this._getInternalNodes();assert(e.length>0,"ToneAudioNode does not have any internal nodes");let t=e[0];return{channelCount:t.channelCount,channelCountMode:t.channelCountMode,channelInterpretation:t.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(e){let t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCount:e}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(e){let t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCountMode:e}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(e){let t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelInterpretation:e}))}connect(e,t=0,r=0){return connect(this,e,t,r),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return warn("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(e,t=0,r=0){return disconnect(this,e,t,r),this}chain(...e){return connectSeries(this,...e),this}fan(...e){return e.forEach((e=>this.connect(e))),this}dispose(){return super.dispose(),isDefined(this.input)&&(this.input instanceof ToneAudioNode?this.input.dispose():isAudioNode2(this.input)&&this.input.disconnect()),isDefined(this.output)&&(this.output instanceof ToneAudioNode?this.output.dispose():isAudioNode2(this.output)&&this.output.disconnect()),this._internalChannels=[],this}};function connectSeries(...e){let t=e.shift();e.reduce(((e,t)=>(e instanceof ToneAudioNode?e.connect(t):isAudioNode2(e)&&connect(e,t),t)),t)}function connect(e,t,r=0,n=0){for(assert(isDefined(e),"Cannot connect from undefined node"),assert(isDefined(t),"Cannot connect to undefined node"),(t instanceof ToneAudioNode||isAudioNode2(t))&&assert(t.numberOfInputs>0,"Cannot connect to node with no inputs"),assert(e.numberOfOutputs>0,"Cannot connect from node with no outputs");t instanceof ToneAudioNode||t instanceof Param;)isDefined(t.input)&&(t=t.input);for(;e instanceof ToneAudioNode;)isDefined(e.output)&&(e=e.output);isAudioParam(t)?e.connect(t,r):e.connect(t,r,n)}function disconnect(e,t,r=0,n=0){if(isDefined(t))for(;t instanceof ToneAudioNode;)t=t.input;for(;!isAudioNode2(e);)isDefined(e.output)&&(e=e.output);isAudioParam(t)?e.disconnect(t,r):isAudioNode2(t)?e.disconnect(t,r,n):e.disconnect()}var Gain=class extends ToneAudioNode{constructor(){super(optionsFromArguments(Gain.getDefaults(),arguments,["gain","units"])),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;let e=optionsFromArguments(Gain.getDefaults(),arguments,["gain","units"]);this.gain=new Param({context:this.context,convert:e.convert,param:this._gainNode.gain,units:e.units,value:e.gain,minValue:e.minValue,maxValue:e.maxValue}),readOnly(this,"gain")}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}},OneShotSource=class extends ToneAudioNode{constructor(e){super(e),this.onended=noOp,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new Gain({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(e){let t=this.toSeconds(e);return-1!==this._startTime&&t>=this._startTime&&(-1===this._stopTime||t<=this._stopTime)?"started":"stopped"},this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut,this._curve=e.curve,this.onended=e.onended}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:noOp})}_startGain(e,t=1){assert(-1===this._startTime,"Source cannot be started more than once");let r=this.toSeconds(this._fadeIn);return this._startTime=e+r,this._startTime=Math.max(this._startTime,this.context.currentTime),r>0?(this._gainNode.gain.setValueAtTime(0,e),"linear"===this._curve?this._gainNode.gain.linearRampToValueAtTime(t,e+r):this._gainNode.gain.exponentialApproachValueAtTime(t,e,r)):this._gainNode.gain.setValueAtTime(t,e),this}stop(e){return this.log("stop",e),this._stopGain(this.toSeconds(e)),this}_stopGain(e){assert(-1!==this._startTime,"'start' must be called before 'stop'"),this.cancelStop();let t=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(e)+t,this._stopTime=Math.max(this._stopTime,this.context.currentTime),t>0?"linear"===this._curve?this._gainNode.gain.linearRampTo(0,t,e):this._gainNode.gain.targetRampTo(0,t,e):(this._gainNode.gain.cancelAndHoldAtTime(e),this._gainNode.gain.setValueAtTime(0,e)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout((()=>{let e="exponential"===this._curve?2*t:0;this._stopSource(this.now()+e),this._onended()}),this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==noOp&&(this.onended(this),this.onended=noOp,!this.context.isOffline)){let e=()=>this.dispose();void 0!==window.requestIdleCallback?window.requestIdleCallback(e):setTimeout(e,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),assert(-1!==this._startTime,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.disconnect(),this}},ToneConstantSource=class extends OneShotSource{constructor(){super(optionsFromArguments(ToneConstantSource.getDefaults(),arguments,["offset"])),this.name="ToneConstantSource",this._source=this.context.createConstantSource();let e=optionsFromArguments(ToneConstantSource.getDefaults(),arguments,["offset"]);connect(this._source,this._gainNode),this.offset=new Param({context:this.context,convert:e.convert,param:this._source.offset,units:e.units,value:e.offset,minValue:e.minValue,maxValue:e.maxValue})}static getDefaults(){return Object.assign(OneShotSource.getDefaults(),{convert:!0,offset:1,units:"number"})}start(e){let t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._source.start(t),this}_stopSource(e){this._source.stop(e)}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}},Signal2=class extends ToneAudioNode{constructor(){super(optionsFromArguments(Signal2.getDefaults(),arguments,["value","units"])),this.name="Signal",this.override=!0;let e=optionsFromArguments(Signal2.getDefaults(),arguments,["value","units"]);this.output=this._constantSource=new ToneConstantSource({context:this.context,convert:e.convert,offset:e.value,units:e.units,minValue:e.minValue,maxValue:e.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{convert:!0,units:"number",value:0})}connect(e,t=0,r=0){return connectSignal(this,e,t,r),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(e,t){return this._param.setValueAtTime(e,t),this}getValueAtTime(e){return this._param.getValueAtTime(e)}setRampPoint(e){return this._param.setRampPoint(e),this}linearRampToValueAtTime(e,t){return this._param.linearRampToValueAtTime(e,t),this}exponentialRampToValueAtTime(e,t){return this._param.exponentialRampToValueAtTime(e,t),this}exponentialRampTo(e,t,r){return this._param.exponentialRampTo(e,t,r),this}linearRampTo(e,t,r){return this._param.linearRampTo(e,t,r),this}targetRampTo(e,t,r){return this._param.targetRampTo(e,t,r),this}exponentialApproachValueAtTime(e,t,r){return this._param.exponentialApproachValueAtTime(e,t,r),this}setTargetAtTime(e,t,r){return this._param.setTargetAtTime(e,t,r),this}setValueCurveAtTime(e,t,r,n){return this._param.setValueCurveAtTime(e,t,r,n),this}cancelScheduledValues(e){return this._param.cancelScheduledValues(e),this}cancelAndHoldAtTime(e){return this._param.cancelAndHoldAtTime(e),this}rampTo(e,t,r){return this._param.rampTo(e,t,r),this}get value(){return this._param.value}set value(e){this._param.value=e}get convert(){return this._param.convert}set convert(e){this._param.convert=e}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(e){this._param.overridden=e}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(e){return this._param.apply(e),this}};function connectSignal(e,t,r,n){(t instanceof Param||isAudioParam(t)||t instanceof Signal2&&t.override)&&(t.cancelScheduledValues(0),t.setValueAtTime(0,0),t instanceof Signal2&&(t.overridden=!0)),connect(e,t,r,n)}var TickParam=class extends Param{constructor(){super(optionsFromArguments(TickParam.getDefaults(),arguments,["value"])),this.name="TickParam",this._events=new Timeline(1/0),this._multiplier=1;let e=optionsFromArguments(TickParam.getDefaults(),arguments,["value"]);this._multiplier=e.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(e.value)}),this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(Param.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(e,t,r){t=this.toSeconds(t),this.setRampPoint(t);let n=this._fromType(e),i=this._events.get(t),s=Math.round(Math.max(1/r,1));for(let e=0;e<=s;e++){let s=r*e+t,o=this._exponentialApproach(i.time,i.value,n,r,s);this.linearRampToValueAtTime(this._toType(o),s)}return this}setValueAtTime(e,t){let r=this.toSeconds(t);super.setValueAtTime(e,t);let n=this._events.get(r),i=this._events.previousEvent(n),s=this._getTicksUntilEvent(i,r);return n.ticks=Math.max(s,0),this}linearRampToValueAtTime(e,t){let r=this.toSeconds(t);super.linearRampToValueAtTime(e,t);let n=this._events.get(r),i=this._events.previousEvent(n),s=this._getTicksUntilEvent(i,r);return n.ticks=Math.max(s,0),this}exponentialRampToValueAtTime(e,t){t=this.toSeconds(t);let r=this._fromType(e),n=this._events.get(t),i=Math.round(Math.max(10*(t-n.time),1)),s=(t-n.time)/i;for(let e=0;e<=i;e++){let i=s*e+n.time,o=this._exponentialInterpolate(n.time,n.value,t,r,i);this.linearRampToValueAtTime(this._toType(o),i)}return this}_getTicksUntilEvent(e,t){if(null===e)e={ticks:0,time:0,type:"setValueAtTime",value:0};else if(isUndef(e.ticks)){let t=this._events.previousEvent(e);e.ticks=this._getTicksUntilEvent(t,e.time)}let r=this._fromType(this.getValueAtTime(e.time)),n=this._fromType(this.getValueAtTime(t)),i=this._events.get(t);return i&&i.time===t&&"setValueAtTime"===i.type&&(n=this._fromType(this.getValueAtTime(t-this.sampleTime))),.5*(t-e.time)*(r+n)+e.ticks}getTicksAtTime(e){let t=this.toSeconds(e),r=this._events.get(t);return Math.max(this._getTicksUntilEvent(r,t),0)}getDurationOfTicks(e,t){let r=this.toSeconds(t),n=this.getTicksAtTime(t);return this.getTimeOfTick(n+e)-r}getTimeOfTick(e){let t=this._events.get(e,"ticks"),r=this._events.getAfter(e,"ticks");if(t&&t.ticks===e)return t.time;if(t&&r&&"linearRampToValueAtTime"===r.type&&t.value!==r.value){let n=this._fromType(this.getValueAtTime(t.time)),i=(this._fromType(this.getValueAtTime(r.time))-n)/(r.time-t.time),s=Math.sqrt(Math.pow(n,2)-2*i*(t.ticks-e)),o=(-n+s)/i,a=(-n-s)/i;return(o>0?o:a)+t.time}return t?0===t.value?1/0:t.time+(e-t.ticks)/t.value:e/this._initialValue}ticksToTime(e,t){return this.getDurationOfTicks(e,t)}timeToTicks(e,t){let r=this.toSeconds(t),n=this.toSeconds(e),i=this.getTicksAtTime(r);return this.getTicksAtTime(r+n)-i}_fromType(e){return"bpm"===this.units&&this.multiplier?1/(60/e/this.multiplier):super._fromType(e)}_toType(e){return"bpm"===this.units&&this.multiplier?e/this.multiplier*60:super._toType(e)}get multiplier(){return this._multiplier}set multiplier(e){let t=this.value;this._multiplier=e,this.cancelScheduledValues(0),this.setValueAtTime(t,0)}},TickSignal=class extends Signal2{constructor(){super(optionsFromArguments(TickSignal.getDefaults(),arguments,["value"])),this.name="TickSignal";let e=optionsFromArguments(TickSignal.getDefaults(),arguments,["value"]);this.input=this._param=new TickParam({context:this.context,convert:e.convert,multiplier:e.multiplier,param:this._constantSource.offset,units:e.units,value:e.value})}static getDefaults(){return Object.assign(Signal2.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(e,t){return this._param.ticksToTime(e,t)}timeToTicks(e,t){return this._param.timeToTicks(e,t)}getTimeOfTick(e){return this._param.getTimeOfTick(e)}getDurationOfTicks(e,t){return this._param.getDurationOfTicks(e,t)}getTicksAtTime(e){return this._param.getTicksAtTime(e)}get multiplier(){return this._param.multiplier}set multiplier(e){this._param.multiplier=e}dispose(){return super.dispose(),this._param.dispose(),this}},TickSource=class extends ToneWithContext{constructor(){super(optionsFromArguments(TickSource.getDefaults(),arguments,["frequency"])),this.name="TickSource",this._state=new StateTimeline,this._tickOffset=new Timeline;let e=optionsFromArguments(TickSource.getDefaults(),arguments,["frequency"]);this.frequency=new TickSignal({context:this.context,units:e.units,value:e.frequency}),readOnly(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},ToneWithContext.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(e,t){let r=this.toSeconds(e);return"started"!==this._state.getValueAtTime(r)&&(this._state.setStateAtTime("started",r),isDefined(t)&&this.setTicksAtTime(t,r)),this}stop(e){let t=this.toSeconds(e);if("stopped"===this._state.getValueAtTime(t)){let e=this._state.get(t);e&&e.time>0&&(this._tickOffset.cancel(e.time),this._state.cancel(e.time))}return this._state.cancel(t),this._state.setStateAtTime("stopped",t),this.setTicksAtTime(0,t),this}pause(e){let t=this.toSeconds(e);return"started"===this._state.getValueAtTime(t)&&this._state.setStateAtTime("paused",t),this}cancel(e){return e=this.toSeconds(e),this._state.cancel(e),this._tickOffset.cancel(e),this}getTicksAtTime(e){let t=this.toSeconds(e),r=this._state.getLastState("stopped",t),n={state:"paused",time:t};this._state.add(n);let i=r,s=0;return this._state.forEachBetween(r.time,t+this.sampleTime,(e=>{let t=i.time,r=this._tickOffset.get(e.time);r&&r.time>=i.time&&(s=r.ticks,t=r.time),"started"===i.state&&"started"!==e.state&&(s+=this.frequency.getTicksAtTime(e.time)-this.frequency.getTicksAtTime(t)),i=e})),this._state.remove(n),s}get ticks(){return this.getTicksAtTime(this.now())}set ticks(e){this.setTicksAtTime(e,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(e){let t=this.now(),r=this.frequency.timeToTicks(e,t);this.setTicksAtTime(r,t)}getSecondsAtTime(e){e=this.toSeconds(e);let t=this._state.getLastState("stopped",e),r={state:"paused",time:e};this._state.add(r);let n=t,i=0;return this._state.forEachBetween(t.time,e+this.sampleTime,(e=>{let t=n.time,r=this._tickOffset.get(e.time);r&&r.time>=n.time&&(i=r.seconds,t=r.time),"started"===n.state&&"started"!==e.state&&(i+=e.time-t),n=e})),this._state.remove(r),i}setTicksAtTime(e,t){return t=this.toSeconds(t),this._tickOffset.cancel(t),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(e,t),ticks:e,time:t}),this}getStateAtTime(e){return e=this.toSeconds(e),this._state.getValueAtTime(e)}getTimeOfTick(e,t=this.now()){let r=this._tickOffset.get(t),n=this._state.get(t),i=Math.max(r.time,n.time),s=this.frequency.getTicksAtTime(i)+e-r.ticks;return this.frequency.getTimeOfTick(s)}forEachTickBetween(e,t,r){let n=this._state.get(e);this._state.forEachBetween(e,t,(t=>{n&&"started"===n.state&&"started"!==t.state&&this.forEachTickBetween(Math.max(n.time,e),t.time-this.sampleTime,r),n=t}));let i=null;if(n&&"started"===n.state){let s=Math.max(n.time,e),o=this.frequency.getTicksAtTime(s),a=o-this.frequency.getTicksAtTime(n.time),l=Math.ceil(a)-a;l=EQ(l,1)?0:l;let h=this.frequency.getTimeOfTick(o+l);for(;h<t;){try{r(h,Math.round(this.getTicksAtTime(h)))}catch(e){i=e;break}h+=this.frequency.getDurationOfTicks(1,h)}}if(i)throw i;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this.frequency.dispose(),this}},Clock2=class extends ToneWithContext{constructor(){super(optionsFromArguments(Clock2.getDefaults(),arguments,["callback","frequency"])),this.name="Clock",this.callback=noOp,this._lastUpdate=0,this._state=new StateTimeline("stopped"),this._boundLoop=this._loop.bind(this);let e=optionsFromArguments(Clock2.getDefaults(),arguments,["callback","frequency"]);this.callback=e.callback,this._tickSource=new TickSource({context:this.context,frequency:e.frequency,units:e.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,readOnly(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(ToneWithContext.getDefaults(),{callback:noOp,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(e,t){assertContextRunning(this.context);let r=this.toSeconds(e);return this.log("start",r),"started"!==this._state.getValueAtTime(r)&&(this._state.setStateAtTime("started",r),this._tickSource.start(r,t),r<this._lastUpdate&&this.emit("start",r,t)),this}stop(e){let t=this.toSeconds(e);return this.log("stop",t),this._state.cancel(t),this._state.setStateAtTime("stopped",t),this._tickSource.stop(t),t<this._lastUpdate&&this.emit("stop",t),this}pause(e){let t=this.toSeconds(e);return"started"===this._state.getValueAtTime(t)&&(this._state.setStateAtTime("paused",t),this._tickSource.pause(t),t<this._lastUpdate&&this.emit("pause",t)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(e){this._tickSource.ticks=e}get seconds(){return this._tickSource.seconds}set seconds(e){this._tickSource.seconds=e}getSecondsAtTime(e){return this._tickSource.getSecondsAtTime(e)}setTicksAtTime(e,t){return this._tickSource.setTicksAtTime(e,t),this}getTimeOfTick(e,t=this.now()){return this._tickSource.getTimeOfTick(e,t)}getTicksAtTime(e){return this._tickSource.getTicksAtTime(e)}nextTickTime(e,t){let r=this.toSeconds(t),n=this.getTicksAtTime(r);return this._tickSource.getTimeOfTick(n+e,r)}_loop(){let e=this._lastUpdate,t=this.now();this._lastUpdate=t,this.log("loop",e,t),e!==t&&(this._state.forEachBetween(e,t,(e=>{switch(e.state){case"started":let t=this._tickSource.getTicksAtTime(e.time);this.emit("start",e.time,t);break;case"stopped":0!==e.time&&this.emit("stop",e.time);break;case"paused":this.emit("pause",e.time)}})),this._tickSource.forEachTickBetween(e,t,((e,t)=>{this.callback(e,t)})))}getStateAtTime(e){let t=this.toSeconds(e);return this._state.getValueAtTime(t)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}};Emitter.mixin(Clock2);var Delay=class extends ToneAudioNode{constructor(){super(optionsFromArguments(Delay.getDefaults(),arguments,["delayTime","maxDelay"])),this.name="Delay";let e=optionsFromArguments(Delay.getDefaults(),arguments,["delayTime","maxDelay"]),t=this.toSeconds(e.maxDelay);this._maxDelay=Math.max(t,this.toSeconds(e.delayTime)),this._delayNode=this.input=this.output=this.context.createDelay(t),this.delayTime=new Param({context:this.context,param:this._delayNode.delayTime,units:"time",value:e.delayTime,minValue:0,maxValue:this.maxDelay}),readOnly(this,"delayTime")}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{delayTime:0,maxDelay:1})}get maxDelay(){return this._maxDelay}dispose(){return super.dispose(),this._delayNode.disconnect(),this.delayTime.dispose(),this}};function Offline(e,t,r=2,n=getContext().sampleRate){return __awaiter2(this,void 0,void 0,(function*(){let i=getContext(),s=new OfflineContext(r,t,n);setContext(s),yield e(s);let o=s.render();setContext(i);let a=yield o;return new ToneAudioBuffer(a)}))}var ToneAudioBuffers=class extends Tone{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;let e=optionsFromArguments(ToneAudioBuffers.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=e.baseUrl,Object.keys(e.urls).forEach((t=>{this._loadingCount++;let r=e.urls[t];this.add(t,r,this._bufferLoaded.bind(this,e.onload),e.onerror)}))}static getDefaults(){return{baseUrl:"",onerror:noOp,onload:noOp,urls:{}}}has(e){return this._buffers.has(e.toString())}get(e){return assert(this.has(e),`ToneAudioBuffers has no buffer named: ${e}`),this._buffers.get(e.toString())}_bufferLoaded(e){this._loadingCount--,0===this._loadingCount&&e&&e()}get loaded(){return Array.from(this._buffers).every((([e,t])=>t.loaded))}add(e,t,r=noOp,n=noOp){return isString(t)?this._buffers.set(e.toString(),new ToneAudioBuffer(this.baseUrl+t,r,n)):this._buffers.set(e.toString(),new ToneAudioBuffer(t,r,n)),this}dispose(){return super.dispose(),this._buffers.forEach((e=>e.dispose())),this._buffers.clear(),this}},MidiClass=class extends FrequencyClass{constructor(){super(...arguments),this.name="MidiClass",this.defaultUnits="midi"}_frequencyToUnits(e){return ftom(super._frequencyToUnits(e))}_ticksToUnits(e){return ftom(super._ticksToUnits(e))}_beatsToUnits(e){return ftom(super._beatsToUnits(e))}_secondsToUnits(e){return ftom(super._secondsToUnits(e))}toMidi(){return this.valueOf()}toFrequency(){return mtof(this.toMidi())}transpose(e){return new MidiClass(this.context,this.toMidi()+e)}};function Midi(e,t){return new MidiClass(getContext(),e,t)}var TicksClass=class extends TransportTimeClass{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(e){return this._getPPQ()*e}_secondsToUnits(e){return Math.floor(e/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(e){return e}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}};function Ticks(e,t){return new TicksClass(getContext(),e,t)}var Draw=class extends ToneWithContext{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new Timeline,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(e,t){return this._events.add({callback:e,time:this.toSeconds(t)}),1===this._events.length&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(e){return this._events.cancel(this.toSeconds(e)),this}_drawLoop(){let e=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=e;){let t=this._events.shift();t&&e-t.time<=this.expiration&&t.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}};onContextInit((e=>{e.draw=new Draw({context:e})})),onContextClose((e=>{e.draw.dispose()}));var IntervalTimeline=class extends Tone{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(e){assert(isDefined(e.time),"Events must have a time property"),assert(isDefined(e.duration),"Events must have a duration parameter"),e.time=e.time.valueOf();let t=new IntervalNode(e.time,e.time+e.duration,e);for(null===this._root?this._root=t:this._root.insert(t),this._length++;null!==t;)t.updateHeight(),t.updateMax(),this._rebalance(t),t=t.parent;return this}remove(e){if(null!==this._root){let t=[];this._root.search(e.time,t);for(let r of t)if(r.event===e){this._removeNode(r),this._length--;break}}return this}get length(){return this._length}cancel(e){return this.forEachFrom(e,(e=>this.remove(e))),this}_setRoot(e){this._root=e,null!==this._root&&(this._root.parent=null)}_replaceNodeInParent(e,t){null!==e.parent?(e.isLeftChild()?e.parent.left=t:e.parent.right=t,this._rebalance(e.parent)):this._setRoot(t)}_removeNode(e){if(null===e.left&&null===e.right)this._replaceNodeInParent(e,null);else if(null===e.right)this._replaceNodeInParent(e,e.left);else if(null===e.left)this._replaceNodeInParent(e,e.right);else{let t,r=null;if(e.getBalance()>0)if(null===e.left.right)t=e.left,t.right=e.right,r=t;else{for(t=e.left.right;null!==t.right;)t=t.right;t.parent&&(t.parent.right=t.left,r=t.parent,t.left=e.left,t.right=e.right)}else if(null===e.right.left)t=e.right,t.left=e.left,r=t;else{for(t=e.right.left;null!==t.left;)t=t.left;t.parent&&(t.parent.left=t.right,r=t.parent,t.left=e.left,t.right=e.right)}null!==e.parent?e.isLeftChild()?e.parent.left=t:e.parent.right=t:this._setRoot(t),r&&this._rebalance(r)}e.dispose()}_rotateLeft(e){let t=e.parent,r=e.isLeftChild(),n=e.right;n&&(e.right=n.left,n.left=e),null!==t?r?t.left=n:t.right=n:this._setRoot(n)}_rotateRight(e){let t=e.parent,r=e.isLeftChild(),n=e.left;n&&(e.left=n.right,n.right=e),null!==t?r?t.left=n:t.right=n:this._setRoot(n)}_rebalance(e){let t=e.getBalance();t>1&&e.left?e.left.getBalance()<0?this._rotateLeft(e.left):this._rotateRight(e):t<-1&&e.right&&(e.right.getBalance()>0?this._rotateRight(e.right):this._rotateLeft(e))}get(e){if(null!==this._root){let t=[];if(this._root.search(e,t),t.length>0){let e=t[0];for(let r=1;r<t.length;r++)t[r].low>e.low&&(e=t[r]);return e.event}}return null}forEach(e){if(null!==this._root){let t=[];this._root.traverse((e=>t.push(e))),t.forEach((t=>{t.event&&e(t.event)}))}return this}forEachAtTime(e,t){if(null!==this._root){let r=[];this._root.search(e,r),r.forEach((e=>{e.event&&t(e.event)}))}return this}forEachFrom(e,t){if(null!==this._root){let r=[];this._root.searchAfter(e,r),r.forEach((e=>{e.event&&t(e.event)}))}return this}dispose(){return super.dispose(),null!==this._root&&this._root.traverse((e=>e.dispose())),this._root=null,this}},IntervalNode=class{constructor(e,t,r){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=r,this.low=e,this.high=t,this.max=this.high}insert(e){e.low<=this.low?null===this.left?this.left=e:this.left.insert(e):null===this.right?this.right=e:this.right.insert(e)}search(e,t){e>this.max||(null!==this.left&&this.left.search(e,t),this.low<=e&&this.high>e&&t.push(this),!(this.low>e)&&null!==this.right&&this.right.search(e,t))}searchAfter(e,t){this.low>=e&&(t.push(this),null!==this.left&&this.left.searchAfter(e,t)),null!==this.right&&this.right.searchAfter(e,t)}traverse(e){e(this),null!==this.left&&this.left.traverse(e),null!==this.right&&this.right.traverse(e)}updateHeight(){null!==this.left&&null!==this.right?this.height=Math.max(this.left.height,this.right.height)+1:null!==this.right?this.height=this.right.height+1:null!==this.left?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,null!==this.left&&(this.max=Math.max(this.max,this.left.max)),null!==this.right&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let e=0;return null!==this.left&&null!==this.right?e=this.left.height-this.right.height:null!==this.left?e=this.left.height+1:null!==this.right&&(e=-(this.right.height+1)),e}isLeftChild(){return null!==this.parent&&this.parent.left===this}get left(){return this._left}set left(e){this._left=e,null!==e&&(e.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(e){this._right=e,null!==e&&(e.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}},Units_exports={},Volume=class extends ToneAudioNode{constructor(){super(optionsFromArguments(Volume.getDefaults(),arguments,["volume"])),this.name="Volume";let e=optionsFromArguments(Volume.getDefaults(),arguments,["volume"]);this.input=this.output=new Gain({context:this.context,gain:e.volume,units:"decibels"}),this.volume=this.output.gain,readOnly(this,"volume"),this._unmutedVolume=e.volume,this.mute=e.mute}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(e){!this.mute&&e?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!e&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}},Destination=class extends ToneAudioNode{constructor(){super(optionsFromArguments(Destination.getDefaults(),arguments)),this.name="Destination",this.input=new Volume({context:this.context}),this.output=new Gain({context:this.context}),this.volume=this.input.volume;let e=optionsFromArguments(Destination.getDefaults(),arguments);connectSeries(this.input,this.output,this.context.rawContext.destination),this.mute=e.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(e){this.input.mute=e}chain(...e){return this.input.disconnect(),e.unshift(this.input),e.push(this.output),connectSeries(...e),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}};onContextInit((e=>{e.destination=new Destination({context:e})})),onContextClose((e=>{e.destination.dispose()}));var TimelineValue=class extends Tone{constructor(e){super(),this.name="TimelineValue",this._timeline=new Timeline({memory:10}),this._initialValue=e}set(e,t){return this._timeline.add({value:e,time:t}),this}get(e){let t=this._timeline.get(e);return t?t.value:this._initialValue}},TransportEvent=class{constructor(e,t){this.id=TransportEvent._eventId++;let r=Object.assign(TransportEvent.getDefaults(),t);this.transport=e,this.callback=r.callback,this._once=r.once,this.time=r.time}static getDefaults(){return{callback:noOp,once:!1,time:0}}invoke(e){this.callback&&(this.callback(e),this._once&&this.transport.clear(this.id))}dispose(){return this.callback=void 0,this}};TransportEvent._eventId=0;var TransportRepeatEvent=class extends TransportEvent{constructor(e,t){super(e,t),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);let r=Object.assign(TransportRepeatEvent.getDefaults(),t);this.duration=new TicksClass(e.context,r.duration).valueOf(),this._interval=new TicksClass(e.context,r.interval).valueOf(),this._nextTick=r.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},TransportEvent.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(e){this._createEvents(e),super.invoke(e)}_createEvents(e){let t=this.transport.getTicksAtTime(e);t>=this.time&&t>=this._nextTick&&this._nextTick+this._interval<this.time+this.duration&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new TicksClass(this.context,this._nextTick).toSeconds()))}_restart(e){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.time;let t=this.transport.getTicksAtTime(e);t>this.time&&(this._nextTick=this.time+Math.ceil((t-this.time)/this._interval)*this._interval),this._currentId=this.transport.scheduleOnce(this.invoke.bind(this),new TicksClass(this.context,this._nextTick).toSeconds()),this._nextTick+=this._interval,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new TicksClass(this.context,this._nextTick).toSeconds())}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this}},Transport=class extends ToneWithContext{constructor(){super(optionsFromArguments(Transport.getDefaults(),arguments)),this.name="Transport",this._loop=new TimelineValue(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new Timeline,this._repeatedEvents=new IntervalTimeline,this._syncedSignals=[],this._swingAmount=0;let e=optionsFromArguments(Transport.getDefaults(),arguments);this._ppq=e.ppq,this._clock=new Clock2({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=e.ppq,this.bpm.setValueAtTime(e.bpm,0),readOnly(this,"bpm"),this._timeSignature=e.timeSignature,this._swingTicks=e.ppq/2}static getDefaults(){return Object.assign(ToneWithContext.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(e,t){if(this._loop.get(e)&&t>=this._loopEnd&&(this.emit("loopEnd",e),this._clock.setTicksAtTime(this._loopStart,e),t=this._loopStart,this.emit("loopStart",e,this._clock.getSecondsAtTime(e)),this.emit("loop",e)),this._swingAmount>0&&t%this._ppq!=0&&t%(2*this._swingTicks)!=0){let r=t%(2*this._swingTicks)/(2*this._swingTicks),n=Math.sin(r*Math.PI)*this._swingAmount;e+=new TicksClass(this.context,2*this._swingTicks/3).toSeconds()*n}this._timeline.forEachAtTime(t,(t=>t.invoke(e)))}schedule(e,t){let r=new TransportEvent(this,{callback:e,time:new TransportTimeClass(this.context,t).toTicks()});return this._addEvent(r,this._timeline)}scheduleRepeat(e,t,r,n=1/0){let i=new TransportRepeatEvent(this,{callback:e,duration:new TimeClass(this.context,n).toTicks(),interval:new TimeClass(this.context,t).toTicks(),time:new TransportTimeClass(this.context,r).toTicks()});return this._addEvent(i,this._repeatedEvents)}scheduleOnce(e,t){let r=new TransportEvent(this,{callback:e,once:!0,time:new TransportTimeClass(this.context,t).toTicks()});return this._addEvent(r,this._timeline)}clear(e){if(this._scheduledEvents.hasOwnProperty(e)){let t=this._scheduledEvents[e.toString()];t.timeline.remove(t.event),t.event.dispose(),delete this._scheduledEvents[e.toString()]}return this}_addEvent(e,t){return this._scheduledEvents[e.id.toString()]={event:e,timeline:t},t.add(e),e.id}cancel(e=0){let t=this.toTicks(e);return this._timeline.forEachFrom(t,(e=>this.clear(e.id))),this._repeatedEvents.forEachFrom(t,(e=>this.clear(e.id))),this}_bindClockEvents(){this._clock.on("start",((e,t)=>{t=new TicksClass(this.context,t).toSeconds(),this.emit("start",e,t)})),this._clock.on("stop",(e=>{this.emit("stop",e)})),this._clock.on("pause",(e=>{this.emit("pause",e)}))}get state(){return this._clock.getStateAtTime(this.now())}start(e,t){let r;return isDefined(t)&&(r=this.toTicks(t)),this._clock.start(e,r),this}stop(e){return this._clock.stop(e),this}pause(e){return this._clock.pause(e),this}toggle(e){return e=this.toSeconds(e),"started"!==this._clock.getStateAtTime(e)?this.start(e):this.stop(e),this}get timeSignature(){return this._timeSignature}set timeSignature(e){isArray2(e)&&(e=e[0]/e[1]*4),this._timeSignature=e}get loopStart(){return new TimeClass(this.context,this._loopStart,"i").toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e)}get loopEnd(){return new TimeClass(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e)}get loop(){return this._loop.get(this.now())}set loop(e){this._loop.set(e,this.now())}setLoopPoints(e,t){return this.loopStart=e,this.loopEnd=t,this}get swing(){return this._swingAmount}set swing(e){this._swingAmount=e}get swingSubdivision(){return new TicksClass(this.context,this._swingTicks).toNotation()}set swingSubdivision(e){this._swingTicks=this.toTicks(e)}get position(){let e=this.now(),t=this._clock.getTicksAtTime(e);return new TicksClass(this.context,t).toBarsBeatsSixteenths()}set position(e){let t=this.toTicks(e);this.ticks=t}get seconds(){return this._clock.seconds}set seconds(e){let t=this.now(),r=this._clock.frequency.timeToTicks(e,t);this.ticks=r}get progress(){if(this.loop){let e=this.now();return(this._clock.getTicksAtTime(e)-this._loopStart)/(this._loopEnd-this._loopStart)}return 0}get ticks(){return this._clock.ticks}set ticks(e){if(this._clock.ticks!==e){let t=this.now();if("started"===this.state){let r=this._clock.getTicksAtTime(t),n=t+this._clock.frequency.getDurationOfTicks(Math.ceil(r)-r,t);this.emit("stop",n),this._clock.setTicksAtTime(e,n),this.emit("start",n,this._clock.getSecondsAtTime(n))}else this._clock.setTicksAtTime(e,t)}}getTicksAtTime(e){return Math.round(this._clock.getTicksAtTime(e))}getSecondsAtTime(e){return this._clock.getSecondsAtTime(e)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(e){this._clock.frequency.multiplier=e}nextSubdivision(e){if(e=this.toTicks(e),"started"!==this.state)return 0;{let t=this.now(),r=e-this.getTicksAtTime(t)%e;return this._clock.nextTickTime(r,t)}}syncSignal(e,t){if(!t){let r=this.now();if(0!==e.getValueAtTime(r)){let n=1/(60/this.bpm.getValueAtTime(r)/this.PPQ);t=e.getValueAtTime(r)/n}else t=0}let r=new Gain(t);return this.bpm.connect(r),r.connect(e._param),this._syncedSignals.push({initial:e.value,ratio:r,signal:e}),e.value=0,this}unsyncSignal(e){for(let t=this._syncedSignals.length-1;t>=0;t--){let r=this._syncedSignals[t];r.signal===e&&(r.ratio.dispose(),r.signal.value=r.initial,this._syncedSignals.splice(t,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),writable(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}};Emitter.mixin(Transport),onContextInit((e=>{e.transport=new Transport({context:e})})),onContextClose((e=>{e.transport.dispose()}));var Source=class extends ToneAudioNode{constructor(e){super(e),this.input=void 0,this._state=new StateTimeline("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=noOp,this._syncedStop=noOp,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new Volume({context:this.context,mute:e.mute,volume:e.volume}),this.volume=this._volume.volume,readOnly(this,"volume"),this.onstop=e.onstop}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{mute:!1,onstop:noOp,volume:0})}get state(){return this._synced?"started"===this.context.transport.state?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}_clampToCurrentTime(e){return this._synced?e:Math.max(e,this.context.currentTime)}start(e,t,r){let n=isUndef(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(n=this._clampToCurrentTime(n),this._synced||"started"!==this._state.getValueAtTime(n))if(this.log("start",n),this._state.setStateAtTime("started",n),this._synced){let e=this._state.get(n);e&&(e.offset=this.toSeconds(defaultArg(t,0)),e.duration=r?this.toSeconds(r):void 0);let i=this.context.transport.schedule((e=>{this._start(e,t,r)}),n);this._scheduled.push(i),"started"===this.context.transport.state&&this.context.transport.getSecondsAtTime(this.immediate())>n&&this._syncedStart(this.now(),this.context.transport.seconds)}else assertContextRunning(this.context),this._start(n,t,r);else assert(GT(n,this._state.get(n).time),"Start time must be strictly greater than previous start time"),this._state.cancel(n),this._state.setStateAtTime("started",n),this.log("restart",n),this.restart(n,t,r);return this}stop(e){let t=isUndef(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(t=this._clampToCurrentTime(t),"started"===this._state.getValueAtTime(t)||isDefined(this._state.getNextState("started",t))){if(this.log("stop",t),this._synced){let e=this.context.transport.schedule(this._stop.bind(this),t);this._scheduled.push(e)}else this._stop(t);this._state.cancel(t),this._state.setStateAtTime("stopped",t)}return this}restart(e,t,r){return e=this.toSeconds(e),"started"===this._state.getValueAtTime(e)&&(this._state.cancel(e),this._restart(e,t,r)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(e,t)=>{if(t>0){let r=this._state.get(t);if(r&&"started"===r.state&&r.time!==t){let n,i=t-this.toSeconds(r.time);r.duration&&(n=this.toSeconds(r.duration)-i),this._start(e,this.toSeconds(r.offset)+i,n)}}},this._syncedStop=e=>{let t=this.context.transport.getSecondsAtTime(Math.max(e-this.sampleTime,0));"started"===this._state.getValueAtTime(t)&&this._stop(e)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach((e=>this.context.transport.clear(e))),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=noOp,this.unsync(),this._volume.dispose(),this._state.dispose(),this}},ToneBufferSource=class extends OneShotSource{constructor(){super(optionsFromArguments(ToneBufferSource.getDefaults(),arguments,["url","onload"])),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;let e=optionsFromArguments(ToneBufferSource.getDefaults(),arguments,["url","onload"]);connect(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new Param({context:this.context,param:this._source.playbackRate,units:"positive",value:e.playbackRate}),this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this._buffer=new ToneAudioBuffer(e.url,e.onload,e.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(OneShotSource.getDefaults(),{url:new ToneAudioBuffer,loop:!1,loopEnd:0,loopStart:0,onload:noOp,onerror:noOp,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e}get curve(){return this._curve}set curve(e){this._curve=e}start(e,t,r,n=1){assert(this.buffer.loaded,"buffer is either not set or not loaded");let i=this.toSeconds(e);this._startGain(i,n),t=this.loop?defaultArg(t,this.loopStart):defaultArg(t,0);let s=Math.max(this.toSeconds(t),0);if(this.loop){let e=this.toSeconds(this.loopEnd)||this.buffer.duration,t=this.toSeconds(this.loopStart),r=e-t;GTE(s,e)&&(s=(s-t)%r+t),EQ(s,this.buffer.duration)&&(s=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,LT(s,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(i,s)),isDefined(r)){let e=this.toSeconds(r);e=Math.max(e,0),this.stop(i+e)}return this}_stopSource(e){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(e)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(e){this._source.loopStart=this.toSeconds(e)}get loopEnd(){return this._source.loopEnd}set loopEnd(e){this._source.loopEnd=this.toSeconds(e)}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._source.loop}set loop(e){this._source.loop=e,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}},Noise=class extends Source{constructor(){super(optionsFromArguments(Noise.getDefaults(),arguments,["type"])),this.name="Noise",this._source=null;let e=optionsFromArguments(Noise.getDefaults(),arguments,["type"]);this._playbackRate=e.playbackRate,this.type=e.type,this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut}static getDefaults(){return Object.assign(Source.getDefaults(),{fadeIn:0,fadeOut:0,playbackRate:1,type:"white"})}get type(){return this._type}set type(e){if(assert(e in _noiseBuffers,"Noise: invalid type: "+e),this._type!==e&&(this._type=e,"started"===this.state)){let e=this.now();this._stop(e),this._start(e)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this._source&&(this._source.playbackRate.value=e)}_start(e){let t=_noiseBuffers[this._type];this._source=new ToneBufferSource({url:t,context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,loop:!0,onended:()=>this.onstop(this),playbackRate:this._playbackRate}).connect(this.output),this._source.start(this.toSeconds(e),Math.random()*(t.duration-.001))}_stop(e){this._source&&(this._source.stop(this.toSeconds(e)),this._source=null)}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e,this._source&&(this._source.fadeIn=this._fadeIn)}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e,this._source&&(this._source.fadeOut=this._fadeOut)}_restart(e){this._stop(e),this._start(e)}dispose(){return super.dispose(),this._source&&this._source.disconnect(),this}},BUFFER_LENGTH=220500,NUM_CHANNELS=2,_noiseCache={brown:null,pink:null,white:null},_noiseBuffers={get brown(){if(!_noiseCache.brown){let e=[];for(let t=0;t<NUM_CHANNELS;t++){let r=new Float32Array(BUFFER_LENGTH);e[t]=r;let n=0;for(let e=0;e<BUFFER_LENGTH;e++){let t=2*Math.random()-1;r[e]=(n+.02*t)/1.02,n=r[e],r[e]*=3.5}}_noiseCache.brown=(new ToneAudioBuffer).fromArray(e)}return _noiseCache.brown},get pink(){if(!_noiseCache.pink){let e=[];for(let t=0;t<NUM_CHANNELS;t++){let r,n,i,s,o,a,l,h=new Float32Array(BUFFER_LENGTH);e[t]=h,r=n=i=s=o=a=l=0;for(let e=0;e<BUFFER_LENGTH;e++){let t=2*Math.random()-1;r=.99886*r+.0555179*t,n=.99332*n+.0750759*t,i=.969*i+.153852*t,s=.8665*s+.3104856*t,o=.55*o+.5329522*t,a=-.7616*a-.016898*t,h[e]=r+n+i+s+o+a+l+.5362*t,h[e]*=.11,l=.115926*t}}_noiseCache.pink=(new ToneAudioBuffer).fromArray(e)}return _noiseCache.pink},get white(){if(!_noiseCache.white){let e=[];for(let t=0;t<NUM_CHANNELS;t++){let r=new Float32Array(BUFFER_LENGTH);e[t]=r;for(let e=0;e<BUFFER_LENGTH;e++)r[e]=2*Math.random()-1}_noiseCache.white=(new ToneAudioBuffer).fromArray(e)}return _noiseCache.white}},UserMedia=class extends ToneAudioNode{constructor(){super(optionsFromArguments(UserMedia.getDefaults(),arguments,["volume"])),this.name="UserMedia";let e=optionsFromArguments(UserMedia.getDefaults(),arguments,["volume"]);this._volume=this.output=new Volume({context:this.context,volume:e.volume}),this.volume=this._volume.volume,readOnly(this,"volume"),this.mute=e.mute}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{mute:!1,volume:0})}open(e){return __awaiter2(this,void 0,void 0,(function*(){assert(UserMedia.supported,"UserMedia is not supported"),"started"===this.state&&this.close();let t=yield UserMedia.enumerateDevices();isNumber(e)?this._device=t[e]:(this._device=t.find((t=>t.label===e||t.deviceId===e)),!this._device&&t.length>0&&(this._device=t[0]),assert(isDefined(this._device),`No matching device ${e}`));let r={audio:{echoCancellation:!1,sampleRate:this.context.sampleRate,noiseSuppression:!1,mozNoiseSuppression:!1}};this._device&&(r.audio.deviceId=this._device.deviceId);let n=yield navigator.mediaDevices.getUserMedia(r);if(!this._stream){this._stream=n;let e=this.context.createMediaStreamSource(n);connect(e,this.output),this._mediaStream=e}return this}))}close(){return this._stream&&this._mediaStream&&(this._stream.getAudioTracks().forEach((e=>{e.stop()})),this._stream=void 0,this._mediaStream.disconnect(),this._mediaStream=void 0),this._device=void 0,this}static enumerateDevices(){return __awaiter2(this,void 0,void 0,(function*(){return(yield navigator.mediaDevices.enumerateDevices()).filter((e=>"audioinput"===e.kind))}))}get state(){return this._stream&&this._stream.active?"started":"stopped"}get deviceId(){if(this._device)return this._device.deviceId}get groupId(){if(this._device)return this._device.groupId}get label(){if(this._device)return this._device.label}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}dispose(){return super.dispose(),this.close(),this._volume.dispose(),this.volume.dispose(),this}static get supported(){return isDefined(navigator.mediaDevices)&&isDefined(navigator.mediaDevices.getUserMedia)}};function generateWaveform(e,t){return __awaiter2(this,void 0,void 0,(function*(){let r=t/e.context.sampleRate,n=new OfflineContext(1,r,e.context.sampleRate);return new e.constructor(Object.assign(e.get(),{frequency:2/r,detune:0,context:n})).toDestination().start(0),(yield n.render()).getChannelData(0)}))}var ToneOscillatorNode=class extends OneShotSource{constructor(){super(optionsFromArguments(ToneOscillatorNode.getDefaults(),arguments,["frequency","type"])),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];let e=optionsFromArguments(ToneOscillatorNode.getDefaults(),arguments,["frequency","type"]);connect(this._oscillator,this._gainNode),this.type=e.type,this.frequency=new Param({context:this.context,param:this._oscillator.frequency,units:"frequency",value:e.frequency}),this.detune=new Param({context:this.context,param:this._oscillator.detune,units:"cents",value:e.detune}),readOnly(this,["frequency","detune"])}static getDefaults(){return Object.assign(OneShotSource.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(e){let t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._oscillator.start(t),this}_stopSource(e){this._oscillator.stop(e)}setPeriodicWave(e){return this._oscillator.setPeriodicWave(e),this}get type(){return this._oscillator.type}set type(e){this._oscillator.type=e}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}},Oscillator=class extends Source{constructor(){super(optionsFromArguments(Oscillator.getDefaults(),arguments,["frequency","type"])),this.name="Oscillator",this._oscillator=null;let e=optionsFromArguments(Oscillator.getDefaults(),arguments,["frequency","type"]);this.frequency=new Signal2({context:this.context,units:"frequency",value:e.frequency}),readOnly(this,"frequency"),this.detune=new Signal2({context:this.context,units:"cents",value:e.detune}),readOnly(this,"detune"),this._partials=e.partials,this._partialCount=e.partialCount,this._type=e.type,e.partialCount&&"custom"!==e.type&&(this._type=this.baseType+e.partialCount.toString()),this.phase=e.phase}static getDefaults(){return Object.assign(Source.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(e){let t=this.toSeconds(e),r=new ToneOscillatorNode({context:this.context,onended:()=>this.onstop(this)});this._oscillator=r,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(t)}_stop(e){let t=this.toSeconds(e);this._oscillator&&this._oscillator.stop(t)}_restart(e){let t=this.toSeconds(e);return this.log("restart",t),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(t),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if("custom"===this._type)return Oscillator._periodicWaveCache.find((e=>e.phase===this._phase&&deepEquals(e.partials,this._partials)));{let e=Oscillator._periodicWaveCache.find((e=>e.type===this._type&&e.phase===this._phase));return this._partialCount=e?e.partialCount:this._partialCount,e}}get type(){return this._type}set type(e){this._type=e;let t=-1!==["sine","square","sawtooth","triangle"].indexOf(e);if(0===this._phase&&t)this._wave=void 0,this._partialCount=0,null!==this._oscillator&&(this._oscillator.type=e);else{let t=this._getCachedPeriodicWave();if(isDefined(t)){let{partials:e,wave:r}=t;this._wave=r,this._partials=e,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave)}else{let[t,r]=this._getRealImaginary(e,this._phase),n=this.context.createPeriodicWave(t,r);this._wave=n,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave),Oscillator._periodicWaveCache.push({imag:r,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:t,type:this._type,wave:this._wave}),Oscillator._periodicWaveCache.length>100&&Oscillator._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(e){this.partialCount&&"custom"!==this._type&&"custom"!==e?this.type=e+this.partialCount:this.type=e}get partialCount(){return this._partialCount}set partialCount(e){assertRange(e,0);let t=this._type,r=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(r&&(t=r[1]),"custom"!==this._type)this.type=0===e?t:t+e.toString();else{let t=new Float32Array(e);this._partials.forEach(((e,r)=>t[r]=e)),this._partials=Array.from(t),this.type=this._type}}_getRealImaginary(e,t){let r=2048,n=new Float32Array(r),i=new Float32Array(r),s=1;if("custom"===e){if(s=this._partials.length+1,this._partialCount=this._partials.length,r=s,0===this._partials.length)return[n,i]}else{let t=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(e);t?(s=parseInt(t[2],10)+1,this._partialCount=parseInt(t[2],10),e=t[1],s=Math.max(s,2),r=s):this._partialCount=0,this._partials=[]}for(let o=1;o<r;++o){let r,a=2/(o*Math.PI);switch(e){case"sine":r=o<=s?1:0,this._partials[o-1]=r;break;case"square":r=1&o?2*a:0,this._partials[o-1]=r;break;case"sawtooth":r=a*(1&o?1:-1),this._partials[o-1]=r;break;case"triangle":r=1&o?a*a*2*(o-1>>1&1?-1:1):0,this._partials[o-1]=r;break;case"custom":r=this._partials[o-1];break;default:throw new TypeError("Oscillator: invalid type: "+e)}0!==r?(n[o]=-r*Math.sin(t*o),i[o]=r*Math.cos(t*o)):(n[o]=0,i[o]=0)}return[n,i]}_inverseFFT(e,t,r){let n=0,i=e.length;for(let s=0;s<i;s++)n+=e[s]*Math.cos(s*r)+t[s]*Math.sin(s*r);return n}getInitialValue(){let[e,t]=this._getRealImaginary(this._type,0),r=0,n=2*Math.PI;for(let i=0;i<32;i++)r=Math.max(this._inverseFFT(e,t,i/32*n),r);return clamp(-this._inverseFFT(e,t,this._phase)/r,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(e){this._phase=e*Math.PI/180,this.type=this._type}asArray(e=1024){return __awaiter2(this,void 0,void 0,(function*(){return generateWaveform(this,e)}))}dispose(){return super.dispose(),null!==this._oscillator&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}};Oscillator._periodicWaveCache=[];var SignalOperator=class extends ToneAudioNode{constructor(){super(Object.assign(optionsFromArguments(SignalOperator.getDefaults(),arguments,["context"])))}connect(e,t=0,r=0){return connectSignal(this,e,t,r),this}},WaveShaper=class extends SignalOperator{constructor(){super(Object.assign(optionsFromArguments(WaveShaper.getDefaults(),arguments,["mapping","length"]))),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;let e=optionsFromArguments(WaveShaper.getDefaults(),arguments,["mapping","length"]);isArray2(e.mapping)||e.mapping instanceof Float32Array?this.curve=Float32Array.from(e.mapping):isFunction(e.mapping)&&this.setMap(e.mapping,e.length)}static getDefaults(){return Object.assign(Signal2.getDefaults(),{length:1024})}setMap(e,t=1024){let r=new Float32Array(t);for(let n=0,i=t;n<i;n++){let t=n/(i-1)*2-1;r[n]=e(t,n)}return this.curve=r,this}get curve(){return this._shaper.curve}set curve(e){this._shaper.curve=e}get oversample(){return this._shaper.oversample}set oversample(e){assert(["none","2x","4x"].some((t=>t.includes(e))),"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=e}dispose(){return super.dispose(),this._shaper.disconnect(),this}},AudioToGain=class extends SignalOperator{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new WaveShaper({context:this.context,mapping:e=>(e+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}},Multiply=class extends Signal2{constructor(){super(Object.assign(optionsFromArguments(Multiply.getDefaults(),arguments,["value"]))),this.name="Multiply",this.override=!1;let e=optionsFromArguments(Multiply.getDefaults(),arguments,["value"]);this._mult=this.input=this.output=new Gain({context:this.context,minValue:e.minValue,maxValue:e.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(Signal2.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}},AMOscillator=class extends Source{constructor(){super(optionsFromArguments(AMOscillator.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="AMOscillator",this._modulationScale=new AudioToGain({context:this.context}),this._modulationNode=new Gain({context:this.context});let e=optionsFromArguments(AMOscillator.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new Oscillator({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new Oscillator({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new Multiply({context:this.context,units:"positive",value:e.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),readOnly(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Oscillator.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){this._modulator.restart(e),this._carrier.restart(e)}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(e=1024){return __awaiter2(this,void 0,void 0,(function*(){return generateWaveform(this,e)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}},FMOscillator=class extends Source{constructor(){super(optionsFromArguments(FMOscillator.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="FMOscillator",this._modulationNode=new Gain({context:this.context,gain:0});let e=optionsFromArguments(FMOscillator.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new Oscillator({context:this.context,detune:e.detune,frequency:0,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.detune=this._carrier.detune,this.frequency=new Signal2({context:this.context,units:"frequency",value:e.frequency}),this._modulator=new Oscillator({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new Multiply({context:this.context,units:"positive",value:e.harmonicity}),this.modulationIndex=new Multiply({context:this.context,units:"positive",value:e.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),readOnly(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Oscillator.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){return this._modulator.restart(e),this._carrier.restart(e),this}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(e=1024){return __awaiter2(this,void 0,void 0,(function*(){return generateWaveform(this,e)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}},PulseOscillator=class extends Source{constructor(){super(optionsFromArguments(PulseOscillator.getDefaults(),arguments,["frequency","width"])),this.name="PulseOscillator",this._widthGate=new Gain({context:this.context,gain:0}),this._thresh=new WaveShaper({context:this.context,mapping:e=>e<=0?-1:1});let e=optionsFromArguments(PulseOscillator.getDefaults(),arguments,["frequency","width"]);this.width=new Signal2({context:this.context,units:"audioRange",value:e.width}),this._triangle=new Oscillator({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),readOnly(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(Source.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(e){e=this.toSeconds(e),this._triangle.start(e),this._widthGate.gain.setValueAtTime(1,e)}_stop(e){e=this.toSeconds(e),this._triangle.stop(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(0,e)}_restart(e){this._triangle.restart(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(1,e)}get phase(){return this._triangle.phase}set phase(e){this._triangle.phase=e}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(e){this._triangle.type=e}asArray(e=1024){return __awaiter2(this,void 0,void 0,(function*(){return generateWaveform(this,e)}))}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}},FatOscillator=class extends Source{constructor(){super(optionsFromArguments(FatOscillator.getDefaults(),arguments,["frequency","type","spread"])),this.name="FatOscillator",this._oscillators=[];let e=optionsFromArguments(FatOscillator.getDefaults(),arguments,["frequency","type","spread"]);this.frequency=new Signal2({context:this.context,units:"frequency",value:e.frequency}),this.detune=new Signal2({context:this.context,units:"cents",value:e.detune}),this._spread=e.spread,this._type=e.type,this._phase=e.phase,this._partials=e.partials,this._partialCount=e.partialCount,this.count=e.count,readOnly(this,["frequency","detune"])}static getDefaults(){return Object.assign(Oscillator.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(e){e=this.toSeconds(e),this._forEach((t=>t.start(e)))}_stop(e){e=this.toSeconds(e),this._forEach((t=>t.stop(e)))}_restart(e){this._forEach((t=>t.restart(e)))}_forEach(e){for(let t=0;t<this._oscillators.length;t++)e(this._oscillators[t],t)}get type(){return this._type}set type(e){this._type=e,this._forEach((t=>t.type=e))}get spread(){return this._spread}set spread(e){if(this._spread=e,this._oscillators.length>1){let t=-e/2,r=e/(this._oscillators.length-1);this._forEach(((e,n)=>e.detune.value=t+r*n))}}get count(){return this._oscillators.length}set count(e){if(assertRange(e,1),this._oscillators.length!==e){this._forEach((e=>e.dispose())),this._oscillators=[];for(let t=0;t<e;t++){let r=new Oscillator({context:this.context,volume:-6-1.1*e,type:this._type,phase:this._phase+t/e*360,partialCount:this._partialCount,onstop:0===t?()=>this.onstop(this):noOp});"custom"===this.type&&(r.partials=this._partials),this.frequency.connect(r.frequency),this.detune.connect(r.detune),r.detune.overridden=!1,r.connect(this.output),this._oscillators[t]=r}this.spread=this._spread,"started"===this.state&&this._forEach((e=>e.start()))}}get phase(){return this._phase}set phase(e){this._phase=e,this._forEach(((e,t)=>e.phase=this._phase+t/this.count*360))}get baseType(){return this._oscillators[0].baseType}set baseType(e){this._forEach((t=>t.baseType=e)),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this._type="custom",this._forEach((t=>t.partials=e)))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(e){this._partialCount=e,this._forEach((t=>t.partialCount=e)),this._type=this._oscillators[0].type}asArray(e=1024){return __awaiter2(this,void 0,void 0,(function*(){return generateWaveform(this,e)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach((e=>e.dispose())),this}},PWMOscillator=class extends Source{constructor(){super(optionsFromArguments(PWMOscillator.getDefaults(),arguments,["frequency","modulationFrequency"])),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new Multiply({context:this.context,value:2});let e=optionsFromArguments(PWMOscillator.getDefaults(),arguments,["frequency","modulationFrequency"]);this._pulse=new PulseOscillator({context:this.context,frequency:e.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new Oscillator({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),readOnly(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(Source.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(e){e=this.toSeconds(e),this._modulator.start(e),this._pulse.start(e)}_stop(e){e=this.toSeconds(e),this._modulator.stop(e),this._pulse.stop(e)}_restart(e){this._modulator.restart(e),this._pulse.restart(e)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(e){this._modulator.phase=e}asArray(e=1024){return __awaiter2(this,void 0,void 0,(function*(){return generateWaveform(this,e)}))}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}},OmniOscillatorSourceMap={am:AMOscillator,fat:FatOscillator,fm:FMOscillator,oscillator:Oscillator,pulse:PulseOscillator,pwm:PWMOscillator},OmniOscillator=class extends Source{constructor(){super(optionsFromArguments(OmniOscillator.getDefaults(),arguments,["frequency","type"])),this.name="OmniOscillator";let e=optionsFromArguments(OmniOscillator.getDefaults(),arguments,["frequency","type"]);this.frequency=new Signal2({context:this.context,units:"frequency",value:e.frequency}),this.detune=new Signal2({context:this.context,units:"cents",value:e.detune}),readOnly(this,["frequency","detune"]),this.set(e)}static getDefaults(){return Object.assign(Oscillator.getDefaults(),FMOscillator.getDefaults(),AMOscillator.getDefaults(),FatOscillator.getDefaults(),PulseOscillator.getDefaults(),PWMOscillator.getDefaults())}_start(e){this._oscillator.start(e)}_stop(e){this._oscillator.stop(e)}_restart(e){return this._oscillator.restart(e),this}get type(){let e="";return["am","fm","fat"].some((e=>this._sourceType===e))&&(e=this._sourceType),e+this._oscillator.type}set type(e){"fm"===e.substr(0,2)?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):"am"===e.substr(0,2)?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):"fat"===e.substr(0,3)?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(3)):"pwm"===e?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):"pulse"===e?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=e)}get partials(){return this._oscillator.partials}set partials(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partials=e)}get partialCount(){return this._oscillator.partialCount}set partialCount(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partialCount=e)}set(e){return Reflect.has(e,"type")&&e.type&&(this.type=e.type),super.set(e),this}_createNewOscillator(e){if(e!==this._sourceType){this._sourceType=e;let t=OmniOscillatorSourceMap[e],r=this.now();if(this._oscillator){let e=this._oscillator;e.stop(r),this.context.setTimeout((()=>e.dispose()),this.blockTime)}this._oscillator=new t({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),"started"===this.state&&this._oscillator.start(r)}}get phase(){return this._oscillator.phase}set phase(e){this._oscillator.phase=e}get sourceType(){return this._sourceType}set sourceType(e){let t="sine";"pwm"!==this._oscillator.type&&"pulse"!==this._oscillator.type&&(t=this._oscillator.type),"fm"===e?this.type="fm"+t:"am"===e?this.type="am"+t:"fat"===e?this.type="fat"+t:"oscillator"===e?this.type=t:"pulse"===e?this.type="pulse":"pwm"===e&&(this.type="pwm")}_getOscType(e,t){return e instanceof OmniOscillatorSourceMap[t]}get baseType(){return this._oscillator.baseType}set baseType(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&"pulse"!==e&&"pwm"!==e&&(this._oscillator.baseType=e)}get width(){if(this._getOscType(this._oscillator,"pulse"))return this._oscillator.width}get count(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.count}set count(e){this._getOscType(this._oscillator,"fat")&&isNumber(e)&&(this._oscillator.count=e)}get spread(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.spread}set spread(e){this._getOscType(this._oscillator,"fat")&&isNumber(e)&&(this._oscillator.spread=e)}get modulationType(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.modulationType}set modulationType(e){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&isString(e)&&(this._oscillator.modulationType=e)}get modulationIndex(){if(this._getOscType(this._oscillator,"fm"))return this._oscillator.modulationIndex}get harmonicity(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.harmonicity}get modulationFrequency(){if(this._getOscType(this._oscillator,"pwm"))return this._oscillator.modulationFrequency}asArray(e=1024){return __awaiter2(this,void 0,void 0,(function*(){return generateWaveform(this,e)}))}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}},Add=class extends Signal2{constructor(){super(Object.assign(optionsFromArguments(Add.getDefaults(),arguments,["value"]))),this.override=!1,this.name="Add",this._sum=new Gain({context:this.context}),this.input=this._sum,this.output=this._sum,this.addend=this._param,connectSeries(this._constantSource,this._sum)}static getDefaults(){return Object.assign(Signal2.getDefaults(),{value:0})}dispose(){return super.dispose(),this._sum.dispose(),this}},Scale=class extends SignalOperator{constructor(){super(Object.assign(optionsFromArguments(Scale.getDefaults(),arguments,["min","max"]))),this.name="Scale";let e=optionsFromArguments(Scale.getDefaults(),arguments,["min","max"]);this._mult=this.input=new Multiply({context:this.context,value:e.max-e.min}),this._add=this.output=new Add({context:this.context,value:e.min}),this._min=e.min,this._max=e.max,this.input.connect(this.output)}static getDefaults(){return Object.assign(SignalOperator.getDefaults(),{max:1,min:0})}get min(){return this._min}set min(e){this._min=e,this._setRange()}get max(){return this._max}set max(e){this._max=e,this._setRange()}_setRange(){this._add.value=this._min,this._mult.value=this._max-this._min}dispose(){return super.dispose(),this._add.dispose(),this._mult.dispose(),this}},Zero=class extends SignalOperator{constructor(){super(Object.assign(optionsFromArguments(Zero.getDefaults(),arguments))),this.name="Zero",this._gain=new Gain({context:this.context}),this.output=this._gain,this.input=void 0,connect(this.context.getConstant(0),this._gain)}dispose(){return super.dispose(),disconnect(this.context.getConstant(0),this._gain),this}},LFO=class extends ToneAudioNode{constructor(){super(optionsFromArguments(LFO.getDefaults(),arguments,["frequency","min","max"])),this.name="LFO",this._stoppedValue=0,this._units="number",this.convert=!0,this._fromType=Param.prototype._fromType,this._toType=Param.prototype._toType,this._is=Param.prototype._is,this._clampValue=Param.prototype._clampValue;let e=optionsFromArguments(LFO.getDefaults(),arguments,["frequency","min","max"]);this._oscillator=new Oscillator(e),this.frequency=this._oscillator.frequency,this._amplitudeGain=new Gain({context:this.context,gain:e.amplitude,units:"normalRange"}),this.amplitude=this._amplitudeGain.gain,this._stoppedSignal=new Signal2({context:this.context,units:"audioRange",value:0}),this._zeros=new Zero({context:this.context}),this._a2g=new AudioToGain({context:this.context}),this._scaler=this.output=new Scale({context:this.context,max:e.max,min:e.min}),this.units=e.units,this.min=e.min,this.max=e.max,this._oscillator.chain(this._amplitudeGain,this._a2g,this._scaler),this._zeros.connect(this._a2g),this._stoppedSignal.connect(this._a2g),readOnly(this,["amplitude","frequency"]),this.phase=e.phase}static getDefaults(){return Object.assign(Oscillator.getDefaults(),{amplitude:1,frequency:"4n",max:1,min:0,type:"sine",units:"number"})}start(e){return e=this.toSeconds(e),this._stoppedSignal.setValueAtTime(0,e),this._oscillator.start(e),this}stop(e){return e=this.toSeconds(e),this._stoppedSignal.setValueAtTime(this._stoppedValue,e),this._oscillator.stop(e),this}sync(){return this._oscillator.sync(),this._oscillator.syncFrequency(),this}unsync(){return this._oscillator.unsync(),this._oscillator.unsyncFrequency(),this}_setStoppedValue(){this._stoppedValue=this._oscillator.getInitialValue(),this._stoppedSignal.value=this._stoppedValue}get min(){return this._toType(this._scaler.min)}set min(e){e=this._fromType(e),this._scaler.min=e}get max(){return this._toType(this._scaler.max)}set max(e){e=this._fromType(e),this._scaler.max=e}get type(){return this._oscillator.type}set type(e){this._oscillator.type=e,this._setStoppedValue()}get partials(){return this._oscillator.partials}set partials(e){this._oscillator.partials=e,this._setStoppedValue()}get phase(){return this._oscillator.phase}set phase(e){this._oscillator.phase=e,this._setStoppedValue()}get units(){return this._units}set units(e){let t=this.min,r=this.max;this._units=e,this.min=t,this.max=r}get state(){return this._oscillator.state}connect(e,t,r){return(e instanceof Param||e instanceof Signal2)&&(this.convert=e.convert,this.units=e.units),connectSignal(this,e,t,r),this}dispose(){return super.dispose(),this._oscillator.dispose(),this._stoppedSignal.dispose(),this._zeros.dispose(),this._scaler.dispose(),this._a2g.dispose(),this._amplitudeGain.dispose(),this.amplitude.dispose(),this}};function range2(e,t=1/0){let r=new WeakMap;return function(n,i){Reflect.defineProperty(n,i,{configurable:!0,enumerable:!0,get:function(){return r.get(this)},set:function(n){assertRange(n,e,t),r.set(this,n)}})}}function timeRange(e,t=1/0){let r=new WeakMap;return function(n,i){Reflect.defineProperty(n,i,{configurable:!0,enumerable:!0,get:function(){return r.get(this)},set:function(n){assertRange(this.toSeconds(n),e,t),r.set(this,n)}})}}var Player=class extends Source{constructor(){super(optionsFromArguments(Player.getDefaults(),arguments,["url","onload"])),this.name="Player",this._activeSources=new Set;let e=optionsFromArguments(Player.getDefaults(),arguments,["url","onload"]);this._buffer=new ToneAudioBuffer({onload:this._onload.bind(this,e.onload),onerror:e.onerror,reverse:e.reverse,url:e.url}),this.autostart=e.autostart,this._loop=e.loop,this._loopStart=e.loopStart,this._loopEnd=e.loopEnd,this._playbackRate=e.playbackRate,this.fadeIn=e.fadeIn,this.fadeOut=e.fadeOut}static getDefaults(){return Object.assign(Source.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:noOp,onerror:noOp,playbackRate:1,reverse:!1})}load(e){return __awaiter2(this,void 0,void 0,(function*(){return yield this._buffer.load(e),this._onload(),this}))}_onload(e=noOp){e(),this.autostart&&this.start()}_onSourceEnd(e){this.onstop(this),this._activeSources.delete(e),0===this._activeSources.size&&!this._synced&&"started"===this._state.getValueAtTime(this.now())&&(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(e,t,r){return super.start(e,t,r),this}_start(e,t,r){t=this._loop?defaultArg(t,this._loopStart):defaultArg(t,0);let n=this.toSeconds(t),i=r;r=defaultArg(r,Math.max(this._buffer.duration-n,0));let s=this.toSeconds(r);s/=this._playbackRate,e=this.toSeconds(e);let o=new ToneBufferSource({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);!this._loop&&!this._synced&&(this._state.cancel(e+s),this._state.setStateAtTime("stopped",e+s,{implicitEnd:!0})),this._activeSources.add(o),this._loop&&isUndef(i)?o.start(e,n):o.start(e,n,s-this.toSeconds(this.fadeOut))}_stop(e){let t=this.toSeconds(e);this._activeSources.forEach((e=>e.stop(t)))}restart(e,t,r){return super.restart(e,t,r),this}_restart(e,t,r){this._stop(e),this._start(e,t,r)}seek(e,t){let r=this.toSeconds(t);if("started"===this._state.getValueAtTime(r)){let t=this.toSeconds(e);this._stop(r),this._start(r,t)}return this}setLoopPoints(e,t){return this.loopStart=e,this.loopEnd=t,this}get loopStart(){return this._loopStart}set loopStart(e){this._loopStart=e,this.buffer.loaded&&assertRange(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach((t=>{t.loopStart=e}))}get loopEnd(){return this._loopEnd}set loopEnd(e){this._loopEnd=e,this.buffer.loaded&&assertRange(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach((t=>{t.loopEnd=e}))}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._loop}set loop(e){if(this._loop!==e&&(this._loop=e,this._activeSources.forEach((t=>{t.loop=e})),e)){let e=this._state.getNextState("stopped",this.now());e&&this._state.cancel(e.time)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e;let t=this.now(),r=this._state.getNextState("stopped",t);r&&r.implicitEnd&&(this._state.cancel(r.time),this._activeSources.forEach((e=>e.cancelStop()))),this._activeSources.forEach((r=>{r.playbackRate.setValueAtTime(e,t)}))}get reverse(){return this._buffer.reverse}set reverse(e){this._buffer.reverse=e}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach((e=>e.dispose())),this._activeSources.clear(),this._buffer.dispose(),this}};__decorate([timeRange(0)],Player.prototype,"fadeIn",void 0),__decorate([timeRange(0)],Player.prototype,"fadeOut",void 0);var Players=class extends ToneAudioNode{constructor(){super(optionsFromArguments(Players.getDefaults(),arguments,["urls","onload"],"urls")),this.name="Players",this.input=void 0,this._players=new Map;let e=optionsFromArguments(Players.getDefaults(),arguments,["urls","onload"],"urls");this._volume=this.output=new Volume({context:this.context,volume:e.volume}),this.volume=this._volume.volume,readOnly(this,"volume"),this._buffers=new ToneAudioBuffers({urls:e.urls,onload:e.onload,baseUrl:e.baseUrl,onerror:e.onerror}),this.mute=e.mute,this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut}static getDefaults(){return Object.assign(Source.getDefaults(),{baseUrl:"",fadeIn:0,fadeOut:0,mute:!1,onload:noOp,onerror:noOp,urls:{},volume:0})}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e,this._players.forEach((t=>{t.fadeIn=e}))}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e,this._players.forEach((t=>{t.fadeOut=e}))}get state(){return Array.from(this._players).some((([e,t])=>"started"===t.state))?"started":"stopped"}has(e){return this._buffers.has(e)}player(e){if(assert(this.has(e),`No Player with the name ${e} exists on this object`),!this._players.has(e)){let t=new Player({context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,url:this._buffers.get(e)}).connect(this.output);this._players.set(e,t)}return this._players.get(e)}get loaded(){return this._buffers.loaded}add(e,t,r){return assert(!this._buffers.has(e),"A buffer with that name already exists on this object"),this._buffers.add(e,t,r),this}stopAll(e){return this._players.forEach((t=>t.stop(e))),this}dispose(){return super.dispose(),this._volume.dispose(),this.volume.dispose(),this._players.forEach((e=>e.dispose())),this._buffers.dispose(),this}},GrainPlayer=class extends Source{constructor(){super(optionsFromArguments(GrainPlayer.getDefaults(),arguments,["url","onload"])),this.name="GrainPlayer",this._loopStart=0,this._loopEnd=0,this._activeSources=[];let e=optionsFromArguments(GrainPlayer.getDefaults(),arguments,["url","onload"]);this.buffer=new ToneAudioBuffer({onload:e.onload,onerror:e.onerror,reverse:e.reverse,url:e.url}),this._clock=new Clock2({context:this.context,callback:this._tick.bind(this),frequency:1/e.grainSize}),this._playbackRate=e.playbackRate,this._grainSize=e.grainSize,this._overlap=e.overlap,this.detune=e.detune,this.overlap=e.overlap,this.loop=e.loop,this.playbackRate=e.playbackRate,this.grainSize=e.grainSize,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.reverse=e.reverse,this._clock.on("stop",this._onstop.bind(this))}static getDefaults(){return Object.assign(Source.getDefaults(),{onload:noOp,onerror:noOp,overlap:.1,grainSize:.2,playbackRate:1,detune:0,loop:!1,loopStart:0,loopEnd:0,reverse:!1})}_start(e,t,r){t=defaultArg(t,0),t=this.toSeconds(t),e=this.toSeconds(e);let n=1/this._clock.frequency.getValueAtTime(e);this._clock.start(e,t/n),r&&this.stop(e+this.toSeconds(r))}restart(e,t,r){return super.restart(e,t,r),this}_restart(e,t,r){this._stop(e),this._start(e,t,r)}_stop(e){this._clock.stop(e)}_onstop(e){this._activeSources.forEach((t=>{t.fadeOut=0,t.stop(e)})),this.onstop(this)}_tick(e){let t=this._clock.getTicksAtTime(e),r=t*this._grainSize;if(this.log("offset",r),!this.loop&&r>this.buffer.duration)return void this.stop(e);let n=r<this._overlap?0:this._overlap,i=new ToneBufferSource({context:this.context,url:this.buffer,fadeIn:n,fadeOut:this._overlap,loop:this.loop,loopStart:this._loopStart,loopEnd:this._loopEnd,playbackRate:intervalToFrequencyRatio(this.detune/100)}).connect(this.output);i.start(e,this._grainSize*t),i.stop(e+this._grainSize/this.playbackRate),this._activeSources.push(i),i.onended=()=>{let e=this._activeSources.indexOf(i);-1!==e&&this._activeSources.splice(e,1)}}get playbackRate(){return this._playbackRate}set playbackRate(e){assertRange(e,.001),this._playbackRate=e,this.grainSize=this._grainSize}get loopStart(){return this._loopStart}set loopStart(e){this.buffer.loaded&&assertRange(this.toSeconds(e),0,this.buffer.duration),this._loopStart=this.toSeconds(e)}get loopEnd(){return this._loopEnd}set loopEnd(e){this.buffer.loaded&&assertRange(this.toSeconds(e),0,this.buffer.duration),this._loopEnd=this.toSeconds(e)}get reverse(){return this.buffer.reverse}set reverse(e){this.buffer.reverse=e}get grainSize(){return this._grainSize}set grainSize(e){this._grainSize=this.toSeconds(e),this._clock.frequency.setValueAtTime(this._playbackRate/this._grainSize,this.now())}get overlap(){return this._overlap}set overlap(e){let t=this.toSeconds(e);assertRange(t,0),this._overlap=t}get loaded(){return this.buffer.loaded}dispose(){return super.dispose(),this.buffer.dispose(),this._clock.dispose(),this._activeSources.forEach((e=>e.dispose())),this}},Abs=class extends SignalOperator{constructor(){super(...arguments),this.name="Abs",this._abs=new WaveShaper({context:this.context,mapping:e=>Math.abs(e)<.001?0:Math.abs(e)}),this.input=this._abs,this.output=this._abs}dispose(){return super.dispose(),this._abs.dispose(),this}},GainToAudio=class extends SignalOperator{constructor(){super(...arguments),this.name="GainToAudio",this._norm=new WaveShaper({context:this.context,mapping:e=>2*Math.abs(e)-1}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}},Negate=class extends SignalOperator{constructor(){super(...arguments),this.name="Negate",this._multiply=new Multiply({context:this.context,value:-1}),this.input=this._multiply,this.output=this._multiply}dispose(){return super.dispose(),this._multiply.dispose(),this}},Subtract=class extends Signal2{constructor(){super(Object.assign(optionsFromArguments(Subtract.getDefaults(),arguments,["value"]))),this.override=!1,this.name="Subtract",this._sum=new Gain({context:this.context}),this.input=this._sum,this.output=this._sum,this._neg=new Negate({context:this.context}),this.subtrahend=this._param,connectSeries(this._constantSource,this._neg,this._sum)}static getDefaults(){return Object.assign(Signal2.getDefaults(),{value:0})}dispose(){return super.dispose(),this._neg.dispose(),this._sum.dispose(),this}},GreaterThanZero=class extends SignalOperator{constructor(){super(Object.assign(optionsFromArguments(GreaterThanZero.getDefaults(),arguments))),this.name="GreaterThanZero",this._thresh=this.output=new WaveShaper({context:this.context,length:127,mapping:e=>e<=0?0:1}),this._scale=this.input=new Multiply({context:this.context,value:1e4}),this._scale.connect(this._thresh)}dispose(){return super.dispose(),this._scale.dispose(),this._thresh.dispose(),this}},GreaterThan=class extends Signal2{constructor(){super(Object.assign(optionsFromArguments(GreaterThan.getDefaults(),arguments,["value"]))),this.name="GreaterThan",this.override=!1;let e=optionsFromArguments(GreaterThan.getDefaults(),arguments,["value"]);this._subtract=this.input=new Subtract({context:this.context,value:e.value}),this._gtz=this.output=new GreaterThanZero({context:this.context}),this.comparator=this._param=this._subtract.subtrahend,readOnly(this,"comparator"),this._subtract.connect(this._gtz)}static getDefaults(){return Object.assign(Signal2.getDefaults(),{value:0})}dispose(){return super.dispose(),this._gtz.dispose(),this._subtract.dispose(),this.comparator.dispose(),this}},Pow=class extends SignalOperator{constructor(){super(Object.assign(optionsFromArguments(Pow.getDefaults(),arguments,["value"]))),this.name="Pow";let e=optionsFromArguments(Pow.getDefaults(),arguments,["value"]);this._exponentScaler=this.input=this.output=new WaveShaper({context:this.context,mapping:this._expFunc(e.value),length:8192}),this._exponent=e.value}static getDefaults(){return Object.assign(SignalOperator.getDefaults(),{value:1})}_expFunc(e){return t=>Math.pow(Math.abs(t),e)}get value(){return this._exponent}set value(e){this._exponent=e,this._exponentScaler.setMap(this._expFunc(this._exponent))}dispose(){return super.dispose(),this._exponentScaler.dispose(),this}},ScaleExp=class extends Scale{constructor(){super(Object.assign(optionsFromArguments(ScaleExp.getDefaults(),arguments,["min","max","exponent"]))),this.name="ScaleExp";let e=optionsFromArguments(ScaleExp.getDefaults(),arguments,["min","max","exponent"]);this.input=this._exp=new Pow({context:this.context,value:e.exponent}),this._exp.connect(this._mult)}static getDefaults(){return Object.assign(Scale.getDefaults(),{exponent:1})}get exponent(){return this._exp.value}set exponent(e){this._exp.value=e}dispose(){return super.dispose(),this._exp.dispose(),this}},SyncedSignal=class extends Signal2{constructor(){super(optionsFromArguments(Signal2.getDefaults(),arguments,["value","units"])),this.name="SyncedSignal",this.override=!1;let e=optionsFromArguments(Signal2.getDefaults(),arguments,["value","units"]);this._lastVal=e.value,this._synced=this.context.transport.scheduleRepeat(this._onTick.bind(this),"1i"),this._syncedCallback=this._anchorValue.bind(this),this.context.transport.on("start",this._syncedCallback),this.context.transport.on("pause",this._syncedCallback),this.context.transport.on("stop",this._syncedCallback),this._constantSource.disconnect(),this._constantSource.stop(0),this._constantSource=this.output=new ToneConstantSource({context:this.context,offset:e.value,units:e.units}).start(0),this.setValueAtTime(e.value,0)}_onTick(e){let t=super.getValueAtTime(this.context.transport.seconds);this._lastVal!==t&&(this._lastVal=t,this._constantSource.offset.setValueAtTime(t,e))}_anchorValue(e){let t=super.getValueAtTime(this.context.transport.seconds);this._lastVal=t,this._constantSource.offset.cancelAndHoldAtTime(e),this._constantSource.offset.setValueAtTime(t,e)}getValueAtTime(e){let t=new TransportTimeClass(this.context,e).toSeconds();return super.getValueAtTime(t)}setValueAtTime(e,t){let r=new TransportTimeClass(this.context,t).toSeconds();return super.setValueAtTime(e,r),this}linearRampToValueAtTime(e,t){let r=new TransportTimeClass(this.context,t).toSeconds();return super.linearRampToValueAtTime(e,r),this}exponentialRampToValueAtTime(e,t){let r=new TransportTimeClass(this.context,t).toSeconds();return super.exponentialRampToValueAtTime(e,r),this}setTargetAtTime(e,t,r){let n=new TransportTimeClass(this.context,t).toSeconds();return super.setTargetAtTime(e,n,r),this}cancelScheduledValues(e){let t=new TransportTimeClass(this.context,e).toSeconds();return super.cancelScheduledValues(t),this}setValueCurveAtTime(e,t,r,n){let i=new TransportTimeClass(this.context,t).toSeconds();return r=this.toSeconds(r),super.setValueCurveAtTime(e,i,r,n),this}cancelAndHoldAtTime(e){let t=new TransportTimeClass(this.context,e).toSeconds();return super.cancelAndHoldAtTime(t),this}setRampPoint(e){let t=new TransportTimeClass(this.context,e).toSeconds();return super.setRampPoint(t),this}exponentialRampTo(e,t,r){let n=new TransportTimeClass(this.context,r).toSeconds();return super.exponentialRampTo(e,t,n),this}linearRampTo(e,t,r){let n=new TransportTimeClass(this.context,r).toSeconds();return super.linearRampTo(e,t,n),this}targetRampTo(e,t,r){let n=new TransportTimeClass(this.context,r).toSeconds();return super.targetRampTo(e,t,n),this}dispose(){return super.dispose(),this.context.transport.clear(this._synced),this.context.transport.off("start",this._syncedCallback),this.context.transport.off("pause",this._syncedCallback),this.context.transport.off("stop",this._syncedCallback),this._constantSource.dispose(),this}},Envelope=class extends ToneAudioNode{constructor(){super(optionsFromArguments(Envelope.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="Envelope",this._sig=new Signal2({context:this.context,value:0}),this.output=this._sig,this.input=void 0;let e=optionsFromArguments(Envelope.getDefaults(),arguments,["attack","decay","sustain","release"]);this.attack=e.attack,this.decay=e.decay,this.sustain=e.sustain,this.release=e.release,this.attackCurve=e.attackCurve,this.releaseCurve=e.releaseCurve,this.decayCurve=e.decayCurve}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(e,t){if(isString(e))return e;{let r;for(r in EnvelopeCurves)if(EnvelopeCurves[r][t]===e)return r;return e}}_setCurve(e,t,r){if(isString(r)&&Reflect.has(EnvelopeCurves,r)){let n=EnvelopeCurves[r];isObject(n)?"_decayCurve"!==e&&(this[e]=n[t]):this[e]=n}else{if(!isArray2(r)||"_decayCurve"===e)throw new Error("Envelope: invalid curve: "+r);this[e]=r}}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(e){this._setCurve("_attackCurve","In",e)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(e){this._setCurve("_releaseCurve","Out",e)}get decayCurve(){return this._decayCurve}set decayCurve(e){assert(["linear","exponential"].some((t=>t===e)),`Invalid envelope curve: ${e}`),this._decayCurve=e}triggerAttack(e,t=1){this.log("triggerAttack",e,t),e=this.toSeconds(e);let r=this.toSeconds(this.attack),n=this.toSeconds(this.decay),i=this.getValueAtTime(e);if(i>0&&(r=(1-i)/(1/r)),r<this.sampleTime)this._sig.cancelScheduledValues(e),this._sig.setValueAtTime(t,e);else if("linear"===this._attackCurve)this._sig.linearRampTo(t,r,e);else if("exponential"===this._attackCurve)this._sig.targetRampTo(t,r,e);else{this._sig.cancelAndHoldAtTime(e);let n=this._attackCurve;for(let e=1;e<n.length;e++)if(n[e-1]<=i&&i<=n[e]){n=this._attackCurve.slice(e),n[0]=i;break}this._sig.setValueCurveAtTime(n,e,r,t)}if(n&&this.sustain<1){let i=t*this.sustain,s=e+r;this.log("decay",s),"linear"===this._decayCurve?this._sig.linearRampToValueAtTime(i,n+s):this._sig.exponentialApproachValueAtTime(i,s,n)}return this}triggerRelease(e){this.log("triggerRelease",e),e=this.toSeconds(e);let t=this.getValueAtTime(e);if(t>0){let r=this.toSeconds(this.release);r<this.sampleTime?this._sig.setValueAtTime(0,e):"linear"===this._releaseCurve?this._sig.linearRampTo(0,r,e):"exponential"===this._releaseCurve?this._sig.targetRampTo(0,r,e):(assert(isArray2(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(e),this._sig.setValueCurveAtTime(this._releaseCurve,e,r,t))}return this}getValueAtTime(e){return this._sig.getValueAtTime(e)}triggerAttackRelease(e,t,r=1){return t=this.toSeconds(t),this.triggerAttack(t,r),this.triggerRelease(t+this.toSeconds(e)),this}cancel(e){return this._sig.cancelScheduledValues(this.toSeconds(e)),this}connect(e,t=0,r=0){return connectSignal(this,e,t,r),this}asArray(e=1024){return __awaiter2(this,void 0,void 0,(function*(){let t=e/this.context.sampleRate,r=new OfflineContext(1,t,this.context.sampleRate),n=this.toSeconds(this.attack)+this.toSeconds(this.decay),i=n+this.toSeconds(this.release),s=.1*i,o=i+s,a=new this.constructor(Object.assign(this.get(),{attack:t*this.toSeconds(this.attack)/o,decay:t*this.toSeconds(this.decay)/o,release:t*this.toSeconds(this.release)/o,context:r}));return a._sig.toDestination(),a.triggerAttackRelease(t*(n+s)/o,0),(yield r.render()).getChannelData(0)}))}dispose(){return super.dispose(),this._sig.dispose(),this}};__decorate([timeRange(0)],Envelope.prototype,"attack",void 0),__decorate([timeRange(0)],Envelope.prototype,"decay",void 0),__decorate([range2(0,1)],Envelope.prototype,"sustain",void 0),__decorate([timeRange(0)],Envelope.prototype,"release",void 0);var EnvelopeCurves=(()=>{let e,t,r=128,n=[];for(e=0;e<r;e++)n[e]=Math.sin(e/127*(Math.PI/2));let i=[];for(e=0;e<127;e++){t=e/127;let r=Math.sin(t*(2*Math.PI)*6.4-Math.PI/2)+1;i[e]=r/10+.83*t}i[127]=1;let s=[];for(e=0;e<r;e++)s[e]=Math.ceil(e/127*5)/5;let o=[];for(e=0;e<r;e++)t=e/127,o[e]=.5*(1-Math.cos(Math.PI*t));let a=[];for(e=0;e<r;e++){t=e/127;let r=4*Math.pow(t,3)+.2,n=Math.cos(r*Math.PI*2*t);a[e]=Math.abs(n*(1-t))}function l(e){let t=new Array(e.length);for(let r=0;r<e.length;r++)t[r]=1-e[r];return t}return{bounce:{In:l(a),Out:a},cosine:{In:n,Out:(h=n,h.slice(0).reverse())},exponential:"exponential",linear:"linear",ripple:{In:i,Out:l(i)},sine:{In:o,Out:l(o)},step:{In:s,Out:l(s)}};var h})(),Instrument=class extends ToneAudioNode{constructor(){super(optionsFromArguments(Instrument.getDefaults(),arguments)),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease;let e=optionsFromArguments(Instrument.getDefaults(),arguments);this._volume=this.output=new Volume({context:this.context,volume:e.volume}),this.volume=this._volume.volume,readOnly(this,"volume")}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0)),this}_syncState(){let e=!1;return this._synced||(this._synced=!0,e=!0),e}_syncMethod(e,t){let r=this["_original_"+e]=this[e];this[e]=(...e)=>{let n=e[t],i=this.context.transport.schedule((n=>{e[t]=n,r.apply(this,e)}),n);this._scheduledEvents.push(i)}}unsync(){return this._scheduledEvents.forEach((e=>this.context.transport.clear(e))),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease),this}triggerAttackRelease(e,t,r,n){let i=this.toSeconds(r),s=this.toSeconds(t);return this.triggerAttack(e,i,n),this.triggerRelease(i+s),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}},Monophonic=class extends Instrument{constructor(){super(optionsFromArguments(Monophonic.getDefaults(),arguments));let e=optionsFromArguments(Monophonic.getDefaults(),arguments);this.portamento=e.portamento,this.onsilence=e.onsilence}static getDefaults(){return Object.assign(Instrument.getDefaults(),{detune:0,onsilence:noOp,portamento:0})}triggerAttack(e,t,r=1){this.log("triggerAttack",e,t,r);let n=this.toSeconds(t);return this._triggerEnvelopeAttack(n,r),this.setNote(e,n),this}triggerRelease(e){this.log("triggerRelease",e);let t=this.toSeconds(e);return this._triggerEnvelopeRelease(t),this}setNote(e,t){let r=this.toSeconds(t),n=e instanceof FrequencyClass?e.toFrequency():e;if(this.portamento>0&&this.getLevelAtTime(r)>.05){let e=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(n,e,r)}else this.frequency.setValueAtTime(n,r);return this}};__decorate([timeRange(0)],Monophonic.prototype,"portamento",void 0);var AmplitudeEnvelope=class extends Envelope{constructor(){super(optionsFromArguments(AmplitudeEnvelope.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new Gain({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}},Synth=class extends Monophonic{constructor(){super(optionsFromArguments(Synth.getDefaults(),arguments)),this.name="Synth";let e=optionsFromArguments(Synth.getDefaults(),arguments);this.oscillator=new OmniOscillator(Object.assign({context:this.context,detune:e.detune,onstop:()=>this.onsilence(this)},e.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new AmplitudeEnvelope(Object.assign({context:this.context},e.envelope)),this.oscillator.chain(this.envelope,this.output),readOnly(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(Monophonic.getDefaults(),{envelope:Object.assign(omitFromObject(Envelope.getDefaults(),Object.keys(ToneAudioNode.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(omitFromObject(OmniOscillator.getDefaults(),[...Object.keys(Source.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(e,t){if(this.envelope.triggerAttack(e,t),this.oscillator.start(e),0===this.envelope.sustain){let t=this.toSeconds(this.envelope.attack),r=this.toSeconds(this.envelope.decay);this.oscillator.stop(e+t+r)}}_triggerEnvelopeRelease(e){this.envelope.triggerRelease(e),this.oscillator.stop(e+this.toSeconds(this.envelope.release))}getLevelAtTime(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}},ModulationSynth=class extends Monophonic{constructor(){super(optionsFromArguments(ModulationSynth.getDefaults(),arguments)),this.name="ModulationSynth";let e=optionsFromArguments(ModulationSynth.getDefaults(),arguments);this._carrier=new Synth({context:this.context,oscillator:e.oscillator,envelope:e.envelope,onsilence:()=>this.onsilence(this),volume:-10}),this._modulator=new Synth({context:this.context,oscillator:e.modulation,envelope:e.modulationEnvelope,volume:-10}),this.oscillator=this._carrier.oscillator,this.envelope=this._carrier.envelope,this.modulation=this._modulator.oscillator,this.modulationEnvelope=this._modulator.envelope,this.frequency=new Signal2({context:this.context,units:"frequency"}),this.detune=new Signal2({context:this.context,value:e.detune,units:"cents"}),this.harmonicity=new Multiply({context:this.context,value:e.harmonicity,minValue:0}),this._modulationNode=new Gain({context:this.context,gain:0}),readOnly(this,["frequency","harmonicity","oscillator","envelope","modulation","modulationEnvelope","detune"])}static getDefaults(){return Object.assign(Monophonic.getDefaults(),{harmonicity:3,oscillator:Object.assign(omitFromObject(OmniOscillator.getDefaults(),[...Object.keys(Source.getDefaults()),"frequency","detune"]),{type:"sine"}),envelope:Object.assign(omitFromObject(Envelope.getDefaults(),Object.keys(ToneAudioNode.getDefaults())),{attack:.01,decay:.01,sustain:1,release:.5}),modulation:Object.assign(omitFromObject(OmniOscillator.getDefaults(),[...Object.keys(Source.getDefaults()),"frequency","detune"]),{type:"square"}),modulationEnvelope:Object.assign(omitFromObject(Envelope.getDefaults(),Object.keys(ToneAudioNode.getDefaults())),{attack:.5,decay:0,sustain:1,release:.5})})}_triggerEnvelopeAttack(e,t){this._carrier._triggerEnvelopeAttack(e,t),this._modulator._triggerEnvelopeAttack(e,t)}_triggerEnvelopeRelease(e){return this._carrier._triggerEnvelopeRelease(e),this._modulator._triggerEnvelopeRelease(e),this}getLevelAtTime(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}dispose(){return super.dispose(),this._carrier.dispose(),this._modulator.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._modulationNode.dispose(),this}},AMSynth=class extends ModulationSynth{constructor(){super(optionsFromArguments(AMSynth.getDefaults(),arguments)),this.name="AMSynth",this._modulationScale=new AudioToGain({context:this.context}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output)}dispose(){return super.dispose(),this._modulationScale.dispose(),this}},BiquadFilter=class extends ToneAudioNode{constructor(){super(optionsFromArguments(BiquadFilter.getDefaults(),arguments,["frequency","type"])),this.name="BiquadFilter";let e=optionsFromArguments(BiquadFilter.getDefaults(),arguments,["frequency","type"]);this._filter=this.context.createBiquadFilter(),this.input=this.output=this._filter,this.Q=new Param({context:this.context,units:"number",value:e.Q,param:this._filter.Q}),this.frequency=new Param({context:this.context,units:"frequency",value:e.frequency,param:this._filter.frequency}),this.detune=new Param({context:this.context,units:"cents",value:e.detune,param:this._filter.detune}),this.gain=new Param({context:this.context,units:"decibels",convert:!1,value:e.gain,param:this._filter.gain}),this.type=e.type}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{Q:1,type:"lowpass",frequency:350,detune:0,gain:0})}get type(){return this._filter.type}set type(e){assert(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(e),`Invalid filter type: ${e}`),this._filter.type=e}getFrequencyResponse(e=128){let t=new Float32Array(e);for(let r=0;r<e;r++){let n=19980*Math.pow(r/e,2)+20;t[r]=n}let r=new Float32Array(e),n=new Float32Array(e),i=this.context.createBiquadFilter();return i.type=this.type,i.Q.value=this.Q.value,i.frequency.value=this.frequency.value,i.gain.value=this.gain.value,i.getFrequencyResponse(t,r,n),r}dispose(){return super.dispose(),this._filter.disconnect(),this.Q.dispose(),this.frequency.dispose(),this.gain.dispose(),this.detune.dispose(),this}},Filter3=class extends ToneAudioNode{constructor(){super(optionsFromArguments(Filter3.getDefaults(),arguments,["frequency","type","rolloff"])),this.name="Filter",this.input=new Gain({context:this.context}),this.output=new Gain({context:this.context}),this._filters=[];let e=optionsFromArguments(Filter3.getDefaults(),arguments,["frequency","type","rolloff"]);this._filters=[],this.Q=new Signal2({context:this.context,units:"positive",value:e.Q}),this.frequency=new Signal2({context:this.context,units:"frequency",value:e.frequency}),this.detune=new Signal2({context:this.context,units:"cents",value:e.detune}),this.gain=new Signal2({context:this.context,units:"decibels",convert:!1,value:e.gain}),this._type=e.type,this.rolloff=e.rolloff,readOnly(this,["detune","frequency","gain","Q"])}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{Q:1,detune:0,frequency:350,gain:0,rolloff:-12,type:"lowpass"})}get type(){return this._type}set type(e){assert(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(e),`Invalid filter type: ${e}`),this._type=e,this._filters.forEach((t=>t.type=e))}get rolloff(){return this._rolloff}set rolloff(e){let t=isNumber(e)?e:parseInt(e,10),r=[-12,-24,-48,-96],n=r.indexOf(t);assert(-1!==n,`rolloff can only be ${r.join(", ")}`),n+=1,this._rolloff=t,this.input.disconnect(),this._filters.forEach((e=>e.disconnect())),this._filters=new Array(n);for(let e=0;e<n;e++){let t=new BiquadFilter({context:this.context});t.type=this._type,this.frequency.connect(t.frequency),this.detune.connect(t.detune),this.Q.connect(t.Q),this.gain.connect(t.gain),this._filters[e]=t}this._internalChannels=this._filters,connectSeries(this.input,...this._internalChannels,this.output)}getFrequencyResponse(e=128){let t=new BiquadFilter({frequency:this.frequency.value,gain:this.gain.value,Q:this.Q.value,type:this._type,detune:this.detune.value}),r=new Float32Array(e).map((()=>1));return this._filters.forEach((()=>{t.getFrequencyResponse(e).forEach(((e,t)=>r[t]*=e))})),t.dispose(),r}dispose(){return super.dispose(),this._filters.forEach((e=>{e.dispose()})),writable(this,["detune","frequency","gain","Q"]),this.frequency.dispose(),this.Q.dispose(),this.detune.dispose(),this.gain.dispose(),this}},FrequencyEnvelope=class extends Envelope{constructor(){super(optionsFromArguments(FrequencyEnvelope.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="FrequencyEnvelope";let e=optionsFromArguments(FrequencyEnvelope.getDefaults(),arguments,["attack","decay","sustain","release"]);this._octaves=e.octaves,this._baseFrequency=this.toFrequency(e.baseFrequency),this._exponent=this.input=new Pow({context:this.context,value:e.exponent}),this._scale=this.output=new Scale({context:this.context,min:this._baseFrequency,max:this._baseFrequency*Math.pow(2,this._octaves)}),this._sig.chain(this._exponent,this._scale)}static getDefaults(){return Object.assign(Envelope.getDefaults(),{baseFrequency:200,exponent:1,octaves:4})}get baseFrequency(){return this._baseFrequency}set baseFrequency(e){let t=this.toFrequency(e);assertRange(t,0),this._baseFrequency=t,this._scale.min=this._baseFrequency,this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(e){this._octaves=e,this._scale.max=this._baseFrequency*Math.pow(2,e)}get exponent(){return this._exponent.value}set exponent(e){this._exponent.value=e}dispose(){return super.dispose(),this._exponent.dispose(),this._scale.dispose(),this}},MonoSynth=class extends Monophonic{constructor(){super(optionsFromArguments(MonoSynth.getDefaults(),arguments)),this.name="MonoSynth";let e=optionsFromArguments(MonoSynth.getDefaults(),arguments);this.oscillator=new OmniOscillator(Object.assign(e.oscillator,{context:this.context,detune:e.detune,onstop:()=>this.onsilence(this)})),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.filter=new Filter3(Object.assign(e.filter,{context:this.context})),this.filterEnvelope=new FrequencyEnvelope(Object.assign(e.filterEnvelope,{context:this.context})),this.envelope=new AmplitudeEnvelope(Object.assign(e.envelope,{context:this.context})),this.oscillator.chain(this.filter,this.envelope,this.output),this.filterEnvelope.connect(this.filter.frequency),readOnly(this,["oscillator","frequency","detune","filter","filterEnvelope","envelope"])}static getDefaults(){return Object.assign(Monophonic.getDefaults(),{envelope:Object.assign(omitFromObject(Envelope.getDefaults(),Object.keys(ToneAudioNode.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.9}),filter:Object.assign(omitFromObject(Filter3.getDefaults(),Object.keys(ToneAudioNode.getDefaults())),{Q:1,rolloff:-12,type:"lowpass"}),filterEnvelope:Object.assign(omitFromObject(FrequencyEnvelope.getDefaults(),Object.keys(ToneAudioNode.getDefaults())),{attack:.6,baseFrequency:200,decay:.2,exponent:2,octaves:3,release:2,sustain:.5}),oscillator:Object.assign(omitFromObject(OmniOscillator.getDefaults(),Object.keys(Source.getDefaults())),{type:"sawtooth"})})}_triggerEnvelopeAttack(e,t=1){if(this.envelope.triggerAttack(e,t),this.filterEnvelope.triggerAttack(e),this.oscillator.start(e),0===this.envelope.sustain){let t=this.toSeconds(this.envelope.attack),r=this.toSeconds(this.envelope.decay);this.oscillator.stop(e+t+r)}}_triggerEnvelopeRelease(e){this.envelope.triggerRelease(e),this.filterEnvelope.triggerRelease(e),this.oscillator.stop(e+this.toSeconds(this.envelope.release))}getLevelAtTime(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this.filterEnvelope.dispose(),this.filter.dispose(),this}},DuoSynth=class extends Monophonic{constructor(){super(optionsFromArguments(DuoSynth.getDefaults(),arguments)),this.name="DuoSynth";let e=optionsFromArguments(DuoSynth.getDefaults(),arguments);this.voice0=new MonoSynth(Object.assign(e.voice0,{context:this.context,onsilence:()=>this.onsilence(this)})),this.voice1=new MonoSynth(Object.assign(e.voice1,{context:this.context})),this.harmonicity=new Multiply({context:this.context,units:"positive",value:e.harmonicity}),this._vibrato=new LFO({frequency:e.vibratoRate,context:this.context,min:-50,max:50}),this._vibrato.start(),this.vibratoRate=this._vibrato.frequency,this._vibratoGain=new Gain({context:this.context,units:"normalRange",gain:e.vibratoAmount}),this.vibratoAmount=this._vibratoGain.gain,this.frequency=new Signal2({context:this.context,units:"frequency",value:440}),this.detune=new Signal2({context:this.context,units:"cents",value:e.detune}),this.frequency.connect(this.voice0.frequency),this.frequency.chain(this.harmonicity,this.voice1.frequency),this._vibrato.connect(this._vibratoGain),this._vibratoGain.fan(this.voice0.detune,this.voice1.detune),this.detune.fan(this.voice0.detune,this.voice1.detune),this.voice0.connect(this.output),this.voice1.connect(this.output),readOnly(this,["voice0","voice1","frequency","vibratoAmount","vibratoRate"])}getLevelAtTime(e){return e=this.toSeconds(e),this.voice0.envelope.getValueAtTime(e)+this.voice1.envelope.getValueAtTime(e)}static getDefaults(){return deepMerge(Monophonic.getDefaults(),{vibratoAmount:.5,vibratoRate:5,harmonicity:1.5,voice0:deepMerge(omitFromObject(MonoSynth.getDefaults(),Object.keys(Monophonic.getDefaults())),{filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}}),voice1:deepMerge(omitFromObject(MonoSynth.getDefaults(),Object.keys(Monophonic.getDefaults())),{filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}})})}_triggerEnvelopeAttack(e,t){this.voice0._triggerEnvelopeAttack(e,t),this.voice1._triggerEnvelopeAttack(e,t)}_triggerEnvelopeRelease(e){return this.voice0._triggerEnvelopeRelease(e),this.voice1._triggerEnvelopeRelease(e),this}dispose(){return super.dispose(),this.voice0.dispose(),this.voice1.dispose(),this.frequency.dispose(),this.detune.dispose(),this._vibrato.dispose(),this.vibratoRate.dispose(),this._vibratoGain.dispose(),this.harmonicity.dispose(),this}},FMSynth=class extends ModulationSynth{constructor(){super(optionsFromArguments(FMSynth.getDefaults(),arguments)),this.name="FMSynth";let e=optionsFromArguments(FMSynth.getDefaults(),arguments);this.modulationIndex=new Multiply({context:this.context,value:e.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output)}static getDefaults(){return Object.assign(ModulationSynth.getDefaults(),{modulationIndex:10})}dispose(){return super.dispose(),this.modulationIndex.dispose(),this}},inharmRatios=[1,1.483,1.932,2.546,2.63,3.897],MetalSynth=class extends Monophonic{constructor(){super(optionsFromArguments(MetalSynth.getDefaults(),arguments)),this.name="MetalSynth",this._oscillators=[],this._freqMultipliers=[];let e=optionsFromArguments(MetalSynth.getDefaults(),arguments);this.detune=new Signal2({context:this.context,units:"cents",value:e.detune}),this.frequency=new Signal2({context:this.context,units:"frequency"}),this._amplitude=new Gain({context:this.context,gain:0}).connect(this.output),this._highpass=new Filter3({Q:0,context:this.context,type:"highpass"}).connect(this._amplitude);for(let t=0;t<inharmRatios.length;t++){let r=new FMOscillator({context:this.context,harmonicity:e.harmonicity,modulationIndex:e.modulationIndex,modulationType:"square",onstop:0===t?()=>this.onsilence(this):noOp,type:"square"});r.connect(this._highpass),this._oscillators[t]=r;let n=new Multiply({context:this.context,value:inharmRatios[t]});this._freqMultipliers[t]=n,this.frequency.chain(n,r.frequency),this.detune.connect(r.detune)}this._filterFreqScaler=new Scale({context:this.context,max:7e3,min:this.toFrequency(e.resonance)}),this.envelope=new Envelope({attack:e.envelope.attack,attackCurve:"linear",context:this.context,decay:e.envelope.decay,release:e.envelope.release,sustain:0}),this.envelope.chain(this._filterFreqScaler,this._highpass.frequency),this.envelope.connect(this._amplitude.gain),this._octaves=e.octaves,this.octaves=e.octaves}static getDefaults(){return deepMerge(Monophonic.getDefaults(),{envelope:Object.assign(omitFromObject(Envelope.getDefaults(),Object.keys(ToneAudioNode.getDefaults())),{attack:.001,decay:1.4,release:.2}),harmonicity:5.1,modulationIndex:32,octaves:1.5,resonance:4e3})}_triggerEnvelopeAttack(e,t=1){return this.envelope.triggerAttack(e,t),this._oscillators.forEach((t=>t.start(e))),0===this.envelope.sustain&&this._oscillators.forEach((t=>{t.stop(e+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay))})),this}_triggerEnvelopeRelease(e){return this.envelope.triggerRelease(e),this._oscillators.forEach((t=>t.stop(e+this.toSeconds(this.envelope.release)))),this}getLevelAtTime(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}get modulationIndex(){return this._oscillators[0].modulationIndex.value}set modulationIndex(e){this._oscillators.forEach((t=>t.modulationIndex.value=e))}get harmonicity(){return this._oscillators[0].harmonicity.value}set harmonicity(e){this._oscillators.forEach((t=>t.harmonicity.value=e))}get resonance(){return this._filterFreqScaler.min}set resonance(e){this._filterFreqScaler.min=this.toFrequency(e),this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(e){this._octaves=e,this._filterFreqScaler.max=this._filterFreqScaler.min*Math.pow(2,e)}dispose(){return super.dispose(),this._oscillators.forEach((e=>e.dispose())),this._freqMultipliers.forEach((e=>e.dispose())),this.frequency.dispose(),this.detune.dispose(),this._filterFreqScaler.dispose(),this._amplitude.dispose(),this.envelope.dispose(),this._highpass.dispose(),this}},MembraneSynth=class extends Synth{constructor(){super(optionsFromArguments(MembraneSynth.getDefaults(),arguments)),this.name="MembraneSynth",this.portamento=0;let e=optionsFromArguments(MembraneSynth.getDefaults(),arguments);this.pitchDecay=e.pitchDecay,this.octaves=e.octaves,readOnly(this,["oscillator","envelope"])}static getDefaults(){return deepMerge(Monophonic.getDefaults(),Synth.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(e,t){let r=this.toSeconds(t),n=this.toFrequency(e instanceof FrequencyClass?e.toFrequency():e),i=n*this.octaves;return this.oscillator.frequency.setValueAtTime(i,r),this.oscillator.frequency.exponentialRampToValueAtTime(n,r+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}};__decorate([range2(0)],MembraneSynth.prototype,"octaves",void 0),__decorate([timeRange(0)],MembraneSynth.prototype,"pitchDecay",void 0);var NoiseSynth=class extends Instrument{constructor(){super(optionsFromArguments(NoiseSynth.getDefaults(),arguments)),this.name="NoiseSynth";let e=optionsFromArguments(NoiseSynth.getDefaults(),arguments);this.noise=new Noise(Object.assign({context:this.context},e.noise)),this.envelope=new AmplitudeEnvelope(Object.assign({context:this.context},e.envelope)),this.noise.chain(this.envelope,this.output)}static getDefaults(){return Object.assign(Instrument.getDefaults(),{envelope:Object.assign(omitFromObject(Envelope.getDefaults(),Object.keys(ToneAudioNode.getDefaults())),{decay:.1,sustain:0}),noise:Object.assign(omitFromObject(Noise.getDefaults(),Object.keys(Source.getDefaults())),{type:"white"})})}triggerAttack(e,t=1){return e=this.toSeconds(e),this.envelope.triggerAttack(e,t),this.noise.start(e),0===this.envelope.sustain&&this.noise.stop(e+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay)),this}triggerRelease(e){return e=this.toSeconds(e),this.envelope.triggerRelease(e),this.noise.stop(e+this.toSeconds(this.envelope.release)),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",0),this._syncMethod("triggerRelease",0)),this}triggerAttackRelease(e,t,r=1){return t=this.toSeconds(t),e=this.toSeconds(e),this.triggerAttack(t,r),this.triggerRelease(t+e),this}dispose(){return super.dispose(),this.noise.dispose(),this.envelope.dispose(),this}},workletContext=new Set;function addToWorklet(e){workletContext.add(e)}function registerProcessor(e,t){let r=`registerProcessor("${e}", ${t})`;workletContext.add(r)}function getWorkletGlobalScope(){return Array.from(workletContext).join("\n")}var ToneAudioWorklet=class extends ToneAudioNode{constructor(e){super(e),this.name="ToneAudioWorklet",this.workletOptions={},this.onprocessorerror=noOp;let t=URL.createObjectURL(new Blob([getWorkletGlobalScope()],{type:"text/javascript"})),r=this._audioWorkletName();this._dummyGain=this.context.createGain(),this._dummyParam=this._dummyGain.gain,this.context.addAudioWorkletModule(t,r).then((()=>{this.disposed||(this._worklet=this.context.createAudioWorkletNode(r,this.workletOptions),this._worklet.onprocessorerror=this.onprocessorerror.bind(this),this.onReady(this._worklet))}))}dispose(){return super.dispose(),this._dummyGain.disconnect(),this._worklet&&(this._worklet.port.postMessage("dispose"),this._worklet.disconnect()),this}},toneAudioWorkletProcessor='\n\t/**\n\t * The base AudioWorkletProcessor for use in Tone.js. Works with the [[ToneAudioWorklet]]. \n\t */\n\tclass ToneAudioWorkletProcessor extends AudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\t\n\t\t\tsuper(options);\n\t\t\t/**\n\t\t\t * If the processor was disposed or not. Keep alive until it\'s disposed.\n\t\t\t */\n\t\t\tthis.disposed = false;\n\t\t   \t/** \n\t\t\t * The number of samples in the processing block\n\t\t\t */\n\t\t\tthis.blockSize = 128;\n\t\t\t/**\n\t\t\t * the sample rate\n\t\t\t */\n\t\t\tthis.sampleRate = sampleRate;\n\n\t\t\tthis.port.onmessage = (event) => {\n\t\t\t\t// when it receives a dispose \n\t\t\t\tif (event.data === "dispose") {\n\t\t\t\t\tthis.disposed = true;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t}\n';addToWorklet(toneAudioWorkletProcessor);var singleIOProcess="\n\t/**\n\t * Abstract class for a single input/output processor. \n\t * has a 'generate' function which processes one sample at a time\n\t */\n\tclass SingleIOProcessor extends ToneAudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(Object.assign(options, {\n\t\t\t\tnumberOfInputs: 1,\n\t\t\t\tnumberOfOutputs: 1\n\t\t\t}));\n\t\t\t/**\n\t\t\t * Holds the name of the parameter and a single value of that\n\t\t\t * parameter at the current sample\n\t\t\t * @type { [name: string]: number }\n\t\t\t */\n\t\t\tthis.params = {}\n\t\t}\n\n\t\t/**\n\t\t * Generate an output sample from the input sample and parameters\n\t\t * @abstract\n\t\t * @param input number\n\t\t * @param channel number\n\t\t * @param parameters { [name: string]: number }\n\t\t * @returns number\n\t\t */\n\t\tgenerate(){}\n\n\t\t/**\n\t\t * Update the private params object with the \n\t\t * values of the parameters at the given index\n\t\t * @param parameters { [name: string]: Float32Array },\n\t\t * @param index number\n\t\t */\n\t\tupdateParams(parameters, index) {\n\t\t\tfor (const paramName in parameters) {\n\t\t\t\tconst param = parameters[paramName];\n\t\t\t\tif (param.length > 1) {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][index];\n\t\t\t\t} else {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][0];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Process a single frame of the audio\n\t\t * @param inputs Float32Array[][]\n\t\t * @param outputs Float32Array[][]\n\t\t */\n\t\tprocess(inputs, outputs, parameters) {\n\t\t\tconst input = inputs[0];\n\t\t\tconst output = outputs[0];\n\t\t\t// get the parameter values\n\t\t\tconst channelCount = Math.max(input && input.length || 0, output.length);\n\t\t\tfor (let sample = 0; sample < this.blockSize; sample++) {\n\t\t\t\tthis.updateParams(parameters, sample);\n\t\t\t\tfor (let channel = 0; channel < channelCount; channel++) {\n\t\t\t\t\tconst inputSample = input && input.length ? input[channel][sample] : 0;\n\t\t\t\t\toutput[channel][sample] = this.generate(inputSample, channel, this.params);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn !this.disposed;\n\t\t}\n\t};\n";addToWorklet(singleIOProcess);var delayLine="\n\t/**\n\t * A multichannel buffer for use within an AudioWorkletProcessor as a delay line\n\t */\n\tclass DelayLine {\n\t\t\n\t\tconstructor(size, channels) {\n\t\t\tthis.buffer = [];\n\t\t\tthis.writeHead = []\n\t\t\tthis.size = size;\n\n\t\t\t// create the empty channels\n\t\t\tfor (let i = 0; i < channels; i++) {\n\t\t\t\tthis.buffer[i] = new Float32Array(this.size);\n\t\t\t\tthis.writeHead[i] = 0;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Push a value onto the end\n\t\t * @param channel number\n\t\t * @param value number\n\t\t */\n\t\tpush(channel, value) {\n\t\t\tthis.writeHead[channel] += 1;\n\t\t\tif (this.writeHead[channel] > this.size) {\n\t\t\t\tthis.writeHead[channel] = 0;\n\t\t\t}\n\t\t\tthis.buffer[channel][this.writeHead[channel]] = value;\n\t\t}\n\n\t\t/**\n\t\t * Get the recorded value of the channel given the delay\n\t\t * @param channel number\n\t\t * @param delay number delay samples\n\t\t */\n\t\tget(channel, delay) {\n\t\t\tlet readHead = this.writeHead[channel] - Math.floor(delay);\n\t\t\tif (readHead < 0) {\n\t\t\t\treadHead += this.size;\n\t\t\t}\n\t\t\treturn this.buffer[channel][readHead];\n\t\t}\n\t}\n";addToWorklet(delayLine);var workletName="feedback-comb-filter",feedbackCombFilter='\n\tclass FeedbackCombFilterWorklet extends SingleIOProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(options);\n\t\t\tthis.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);\n\t\t}\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: "delayTime",\n\t\t\t\tdefaultValue: 0.1,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 1,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}, {\n\t\t\t\tname: "feedback",\n\t\t\t\tdefaultValue: 0.5,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 0.9999,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, channel, parameters) {\n\t\t\tconst delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);\n\t\t\tthis.delayLine.push(channel, input + delayedSample * parameters.feedback);\n\t\t\treturn delayedSample;\n\t\t}\n\t}\n';registerProcessor(workletName,feedbackCombFilter);var FeedbackCombFilter=class extends ToneAudioWorklet{constructor(){super(optionsFromArguments(FeedbackCombFilter.getDefaults(),arguments,["delayTime","resonance"])),this.name="FeedbackCombFilter";let e=optionsFromArguments(FeedbackCombFilter.getDefaults(),arguments,["delayTime","resonance"]);this.input=new Gain({context:this.context}),this.output=new Gain({context:this.context}),this.delayTime=new Param({context:this.context,value:e.delayTime,units:"time",minValue:0,maxValue:1,param:this._dummyParam,swappable:!0}),this.resonance=new Param({context:this.context,value:e.resonance,units:"normalRange",param:this._dummyParam,swappable:!0}),readOnly(this,["resonance","delayTime"])}_audioWorkletName(){return workletName}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{delayTime:.1,resonance:.5})}onReady(e){connectSeries(this.input,e,this.output);let t=e.parameters.get("delayTime");this.delayTime.setParam(t);let r=e.parameters.get("feedback");this.resonance.setParam(r)}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.delayTime.dispose(),this.resonance.dispose(),this}},OnePoleFilter=class extends ToneAudioNode{constructor(){super(optionsFromArguments(OnePoleFilter.getDefaults(),arguments,["frequency","type"])),this.name="OnePoleFilter";let e=optionsFromArguments(OnePoleFilter.getDefaults(),arguments,["frequency","type"]);this._frequency=e.frequency,this._type=e.type,this.input=new Gain({context:this.context}),this.output=new Gain({context:this.context}),this._createFilter()}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{frequency:880,type:"lowpass"})}_createFilter(){let e=this._filter,t=this.toFrequency(this._frequency),r=1/(2*Math.PI*t);if("lowpass"===this._type){let e=1/(r*this.context.sampleRate),t=e-1;this._filter=this.context.createIIRFilter([e,0],[1,t])}else{let e=1/(r*this.context.sampleRate)-1;this._filter=this.context.createIIRFilter([1,-1],[1,e])}this.input.chain(this._filter,this.output),e&&this.context.setTimeout((()=>{this.disposed||(this.input.disconnect(e),e.disconnect())}),this.blockTime)}get frequency(){return this._frequency}set frequency(e){this._frequency=e,this._createFilter()}get type(){return this._type}set type(e){this._type=e,this._createFilter()}getFrequencyResponse(e=128){let t=new Float32Array(e);for(let r=0;r<e;r++){let n=19980*Math.pow(r/e,2)+20;t[r]=n}let r=new Float32Array(e),n=new Float32Array(e);return this._filter.getFrequencyResponse(t,r,n),r}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this._filter.disconnect(),this}},LowpassCombFilter=class extends ToneAudioNode{constructor(){super(optionsFromArguments(LowpassCombFilter.getDefaults(),arguments,["delayTime","resonance","dampening"])),this.name="LowpassCombFilter";let e=optionsFromArguments(LowpassCombFilter.getDefaults(),arguments,["delayTime","resonance","dampening"]);this._combFilter=this.output=new FeedbackCombFilter({context:this.context,delayTime:e.delayTime,resonance:e.resonance}),this.delayTime=this._combFilter.delayTime,this.resonance=this._combFilter.resonance,this._lowpass=this.input=new OnePoleFilter({context:this.context,frequency:e.dampening,type:"lowpass"}),this._lowpass.connect(this._combFilter)}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{dampening:3e3,delayTime:.1,resonance:.5})}get dampening(){return this._lowpass.frequency}set dampening(e){this._lowpass.frequency=e}dispose(){return super.dispose(),this._combFilter.dispose(),this._lowpass.dispose(),this}},PluckSynth=class extends Instrument{constructor(){super(optionsFromArguments(PluckSynth.getDefaults(),arguments)),this.name="PluckSynth";let e=optionsFromArguments(PluckSynth.getDefaults(),arguments);this._noise=new Noise({context:this.context,type:"pink"}),this.attackNoise=e.attackNoise,this._lfcf=new LowpassCombFilter({context:this.context,dampening:e.dampening,resonance:e.resonance}),this.resonance=e.resonance,this.release=e.release,this._noise.connect(this._lfcf),this._lfcf.connect(this.output)}static getDefaults(){return deepMerge(Instrument.getDefaults(),{attackNoise:1,dampening:4e3,resonance:.7,release:1})}get dampening(){return this._lfcf.dampening}set dampening(e){this._lfcf.dampening=e}triggerAttack(e,t){let r=this.toFrequency(e);t=this.toSeconds(t);let n=1/r;return this._lfcf.delayTime.setValueAtTime(n,t),this._noise.start(t),this._noise.stop(t+n*this.attackNoise),this._lfcf.resonance.cancelScheduledValues(t),this._lfcf.resonance.setValueAtTime(this.resonance,t),this}triggerRelease(e){return this._lfcf.resonance.linearRampTo(0,this.release,e),this}dispose(){return super.dispose(),this._noise.dispose(),this._lfcf.dispose(),this}},PolySynth=class extends Instrument{constructor(){super(optionsFromArguments(PolySynth.getDefaults(),arguments,["voice","options"])),this.name="PolySynth",this._availableVoices=[],this._activeVoices=[],this._voices=[],this._gcTimeout=-1,this._averageActiveVoices=0;let e=optionsFromArguments(PolySynth.getDefaults(),arguments,["voice","options"]);assert(!isNumber(e.voice),"DEPRECATED: The polyphony count is no longer the first argument.");let t=e.voice.getDefaults();this.options=Object.assign(t,e.options),this.voice=e.voice,this.maxPolyphony=e.maxPolyphony,this._dummyVoice=this._getNextAvailableVoice();let r=this._voices.indexOf(this._dummyVoice);this._voices.splice(r,1),this._gcTimeout=this.context.setInterval(this._collectGarbage.bind(this),1)}static getDefaults(){return Object.assign(Instrument.getDefaults(),{maxPolyphony:32,options:{},voice:Synth})}get activeVoices(){return this._activeVoices.length}_makeVoiceAvailable(e){this._availableVoices.push(e);let t=this._activeVoices.findIndex((t=>t.voice===e));this._activeVoices.splice(t,1)}_getNextAvailableVoice(){if(this._availableVoices.length)return this._availableVoices.shift();if(this._voices.length<this.maxPolyphony){let e=new this.voice(Object.assign(this.options,{context:this.context,onsilence:this._makeVoiceAvailable.bind(this)}));return e.connect(this.output),this._voices.push(e),e}warn("Max polyphony exceeded. Note dropped.")}_collectGarbage(){if(this._averageActiveVoices=Math.max(.95*this._averageActiveVoices,this.activeVoices),this._availableVoices.length&&this._voices.length>Math.ceil(this._averageActiveVoices+1)){let e=this._availableVoices.shift(),t=this._voices.indexOf(e);this._voices.splice(t,1),this.context.isOffline||e.dispose()}}_triggerAttack(e,t,r){e.forEach((e=>{let n=new MidiClass(this.context,e).toMidi(),i=this._getNextAvailableVoice();i&&(i.triggerAttack(e,t,r),this._activeVoices.push({midi:n,voice:i,released:!1}),this.log("triggerAttack",e,t))}))}_triggerRelease(e,t){e.forEach((e=>{let r=new MidiClass(this.context,e).toMidi(),n=this._activeVoices.find((({midi:e,released:t})=>e===r&&!t));n&&(n.voice.triggerRelease(t),n.released=!0,this.log("triggerRelease",e,t))}))}_scheduleEvent(e,t,r,n){assert(!this.disposed,"Synth was already disposed"),r<=this.now()?"attack"===e?this._triggerAttack(t,r,n):this._triggerRelease(t,r):this.context.setTimeout((()=>{this._scheduleEvent(e,t,r,n)}),r-this.now())}triggerAttack(e,t,r){Array.isArray(e)||(e=[e]);let n=this.toSeconds(t);return this._scheduleEvent("attack",e,n,r),this}triggerRelease(e,t){Array.isArray(e)||(e=[e]);let r=this.toSeconds(t);return this._scheduleEvent("release",e,r),this}triggerAttackRelease(e,t,r,n){let i=this.toSeconds(r);if(this.triggerAttack(e,i,n),isArray2(t)){assert(isArray2(e),"If the duration is an array, the notes must also be an array"),e=e;for(let r=0;r<e.length;r++){let n=t[Math.min(r,t.length-1)],s=this.toSeconds(n);assert(s>0,"The duration must be greater than 0"),this.triggerRelease(e[r],i+s)}}else{let r=this.toSeconds(t);assert(r>0,"The duration must be greater than 0"),this.triggerRelease(e,i+r)}return this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}set(e){let t=omitFromObject(e,["onsilence","context"]);return this.options=deepMerge(this.options,t),this._voices.forEach((e=>e.set(t))),this._dummyVoice.set(t),this}get(){return this._dummyVoice.get()}releaseAll(e){let t=this.toSeconds(e);return this._activeVoices.forEach((({voice:e})=>{e.triggerRelease(t)})),this}dispose(){return super.dispose(),this._dummyVoice.dispose(),this._voices.forEach((e=>e.dispose())),this._activeVoices=[],this._availableVoices=[],this.context.clearInterval(this._gcTimeout),this}},Sampler=class extends Instrument{constructor(){super(optionsFromArguments(Sampler.getDefaults(),arguments,["urls","onload","baseUrl"],"urls")),this.name="Sampler",this._activeSources=new Map;let e=optionsFromArguments(Sampler.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),t={};Object.keys(e.urls).forEach((r=>{let n=parseInt(r,10);if(assert(isNote(r)||isNumber(n)&&isFinite(n),`url key is neither a note or midi pitch: ${r}`),isNote(r)){let n=new FrequencyClass(this.context,r).toMidi();t[n]=e.urls[r]}else isNumber(n)&&isFinite(n)&&(t[n]=e.urls[n])})),this._buffers=new ToneAudioBuffers({urls:t,onload:e.onload,baseUrl:e.baseUrl,onerror:e.onerror}),this.attack=e.attack,this.release=e.release,this.curve=e.curve,this._buffers.loaded&&Promise.resolve().then(e.onload)}static getDefaults(){return Object.assign(Instrument.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:noOp,onerror:noOp,release:.1,urls:{}})}_findClosest(e){let t=0;for(;t<96;){if(this._buffers.has(e+t))return-t;if(this._buffers.has(e-t))return t;t++}throw new Error(`No available buffers for note: ${e}`)}triggerAttack(e,t,r=1){return this.log("triggerAttack",e,t,r),Array.isArray(e)||(e=[e]),e.forEach((e=>{let n=ftomf(new FrequencyClass(this.context,e).toFrequency()),i=Math.round(n),s=n-i,o=this._findClosest(i),a=i-o,l=this._buffers.get(a),h=intervalToFrequencyRatio(o+s),u=new ToneBufferSource({url:l,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:h}).connect(this.output);u.start(t,0,l.duration/h,r),isArray2(this._activeSources.get(i))||this._activeSources.set(i,[]),this._activeSources.get(i).push(u),u.onended=()=>{if(this._activeSources&&this._activeSources.has(i)){let e=this._activeSources.get(i),t=e.indexOf(u);-1!==t&&e.splice(t,1)}}})),this}triggerRelease(e,t){return this.log("triggerRelease",e,t),Array.isArray(e)||(e=[e]),e.forEach((e=>{let r=new FrequencyClass(this.context,e).toMidi();if(this._activeSources.has(r)&&this._activeSources.get(r).length){let e=this._activeSources.get(r);t=this.toSeconds(t),e.forEach((e=>{e.stop(t)})),this._activeSources.set(r,[])}})),this}releaseAll(e){let t=this.toSeconds(e);return this._activeSources.forEach((e=>{for(;e.length;)e.shift().stop(t)})),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(e,t,r,n=1){let i=this.toSeconds(r);return this.triggerAttack(e,i,n),isArray2(t)?(assert(isArray2(e),"notes must be an array when duration is array"),e.forEach(((e,r)=>{let n=t[Math.min(r,t.length-1)];this.triggerRelease(e,i+this.toSeconds(n))}))):this.triggerRelease(e,i+this.toSeconds(t)),this}add(e,t,r){if(assert(isNote(e)||isFinite(e),`note must be a pitch or midi: ${e}`),isNote(e)){let n=new FrequencyClass(this.context,e).toMidi();this._buffers.add(n,t,r)}else this._buffers.add(e,t,r);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach((e=>{e.forEach((e=>e.dispose()))})),this._activeSources.clear(),this}};__decorate([timeRange(0)],Sampler.prototype,"attack",void 0),__decorate([timeRange(0)],Sampler.prototype,"release",void 0);var ToneEvent=class extends ToneWithContext{constructor(){super(optionsFromArguments(ToneEvent.getDefaults(),arguments,["callback","value"])),this.name="ToneEvent",this._state=new StateTimeline("stopped"),this._startOffset=0;let e=optionsFromArguments(ToneEvent.getDefaults(),arguments,["callback","value"]);this._loop=e.loop,this.callback=e.callback,this.value=e.value,this._loopStart=this.toTicks(e.loopStart),this._loopEnd=this.toTicks(e.loopEnd),this._playbackRate=e.playbackRate,this._probability=e.probability,this._humanize=e.humanize,this.mute=e.mute,this._playbackRate=e.playbackRate,this._state.increasing=!0,this._rescheduleEvents()}static getDefaults(){return Object.assign(ToneWithContext.getDefaults(),{callback:noOp,humanize:!1,loop:!1,loopEnd:"1m",loopStart:0,mute:!1,playbackRate:1,probability:1,value:null})}_rescheduleEvents(e=-1){this._state.forEachFrom(e,(e=>{let t;if("started"===e.state){-1!==e.id&&this.context.transport.clear(e.id);let r=e.time+Math.round(this.startOffset/this._playbackRate);if(!0===this._loop||isNumber(this._loop)&&this._loop>1){t=1/0,isNumber(this._loop)&&(t=this._loop*this._getLoopDuration());let n=this._state.getAfter(r);null!==n&&(t=Math.min(t,n.time-r)),t!==1/0&&(this._state.setStateAtTime("stopped",r+t+1,{id:-1}),t=new TicksClass(this.context,t));let i=new TicksClass(this.context,this._getLoopDuration());e.id=this.context.transport.scheduleRepeat(this._tick.bind(this),i,new TicksClass(this.context,r),t)}else e.id=this.context.transport.schedule(this._tick.bind(this),new TicksClass(this.context,r))}}))}get state(){return this._state.getValueAtTime(this.context.transport.ticks)}get startOffset(){return this._startOffset}set startOffset(e){this._startOffset=e}get probability(){return this._probability}set probability(e){this._probability=e}get humanize(){return this._humanize}set humanize(e){this._humanize=e}start(e){let t=this.toTicks(e);return"stopped"===this._state.getValueAtTime(t)&&(this._state.add({id:-1,state:"started",time:t}),this._rescheduleEvents(t)),this}stop(e){this.cancel(e);let t=this.toTicks(e);if("started"===this._state.getValueAtTime(t)){this._state.setStateAtTime("stopped",t,{id:-1});let e=this._state.getBefore(t),r=t;null!==e&&(r=e.time),this._rescheduleEvents(r)}return this}cancel(e){e=defaultArg(e,-1/0);let t=this.toTicks(e);return this._state.forEachFrom(t,(e=>{this.context.transport.clear(e.id)})),this._state.cancel(t),this}_tick(e){let t=this.context.transport.getTicksAtTime(e);if(!this.mute&&"started"===this._state.getValueAtTime(t)){if(this.probability<1&&Math.random()>this.probability)return;if(this.humanize){let t=.02;isBoolean(this.humanize)||(t=this.toSeconds(this.humanize)),e+=(2*Math.random()-1)*t}this.callback(e,this.value)}}_getLoopDuration(){return Math.round((this._loopEnd-this._loopStart)/this._playbackRate)}get loop(){return this._loop}set loop(e){this._loop=e,this._rescheduleEvents()}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this._rescheduleEvents()}get loopEnd(){return new TicksClass(this.context,this._loopEnd).toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e),this._loop&&this._rescheduleEvents()}get loopStart(){return new TicksClass(this.context,this._loopStart).toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e),this._loop&&this._rescheduleEvents()}get progress(){if(this._loop){let e=this.context.transport.ticks,t=this._state.get(e);if(null!==t&&"started"===t.state){let r=this._getLoopDuration();return(e-t.time)%r/r}return 0}return 0}dispose(){return super.dispose(),this.cancel(),this._state.dispose(),this}},Loop=class extends ToneWithContext{constructor(){super(optionsFromArguments(Loop.getDefaults(),arguments,["callback","interval"])),this.name="Loop";let e=optionsFromArguments(Loop.getDefaults(),arguments,["callback","interval"]);this._event=new ToneEvent({context:this.context,callback:this._tick.bind(this),loop:!0,loopEnd:e.interval,playbackRate:e.playbackRate,probability:e.probability}),this.callback=e.callback,this.iterations=e.iterations}static getDefaults(){return Object.assign(ToneWithContext.getDefaults(),{interval:"4n",callback:noOp,playbackRate:1,iterations:1/0,probability:1,mute:!1,humanize:!1})}start(e){return this._event.start(e),this}stop(e){return this._event.stop(e),this}cancel(e){return this._event.cancel(e),this}_tick(e){this.callback(e)}get state(){return this._event.state}get progress(){return this._event.progress}get interval(){return this._event.loopEnd}set interval(e){this._event.loopEnd=e}get playbackRate(){return this._event.playbackRate}set playbackRate(e){this._event.playbackRate=e}get humanize(){return this._event.humanize}set humanize(e){this._event.humanize=e}get probability(){return this._event.probability}set probability(e){this._event.probability=e}get mute(){return this._event.mute}set mute(e){this._event.mute=e}get iterations(){return!0===this._event.loop?1/0:this._event.loop}set iterations(e){this._event.loop=e===1/0||e}dispose(){return super.dispose(),this._event.dispose(),this}},Part=class extends ToneEvent{constructor(){super(optionsFromArguments(Part.getDefaults(),arguments,["callback","events"])),this.name="Part",this._state=new StateTimeline("stopped"),this._events=new Set;let e=optionsFromArguments(Part.getDefaults(),arguments,["callback","events"]);this._state.increasing=!0,e.events.forEach((e=>{isArray2(e)?this.add(e[0],e[1]):this.add(e)}))}static getDefaults(){return Object.assign(ToneEvent.getDefaults(),{events:[]})}start(e,t){let r=this.toTicks(e);if("started"!==this._state.getValueAtTime(r)){t=defaultArg(t,this._loop?this._loopStart:0),t=this._loop?defaultArg(t,this._loopStart):defaultArg(t,0);let e=this.toTicks(t);this._state.add({id:-1,offset:e,state:"started",time:r}),this._forEach((t=>{this._startNote(t,r,e)}))}return this}_startNote(e,t,r){t-=r,this._loop?e.startOffset>=this._loopStart&&e.startOffset<this._loopEnd?(e.startOffset<r&&(t+=this._getLoopDuration()),e.start(new TicksClass(this.context,t))):e.startOffset<this._loopStart&&e.startOffset>=r&&(e.loop=!1,e.start(new TicksClass(this.context,t))):e.startOffset>=r&&e.start(new TicksClass(this.context,t))}get startOffset(){return this._startOffset}set startOffset(e){this._startOffset=e,this._forEach((e=>{e.startOffset+=this._startOffset}))}stop(e){let t=this.toTicks(e);return this._state.cancel(t),this._state.setStateAtTime("stopped",t),this._forEach((t=>{t.stop(e)})),this}at(e,t){let r=new TransportTimeClass(this.context,e).toTicks(),n=new TicksClass(this.context,1).toSeconds(),i=this._events.values(),s=i.next();for(;!s.done;){let e=s.value;if(Math.abs(r-e.startOffset)<n)return isDefined(t)&&(e.value=t),e;s=i.next()}return isDefined(t)?(this.add(e,t),this.at(e)):null}add(e,t){e instanceof Object&&Reflect.has(e,"time")&&(e=(t=e).time);let r,n=this.toTicks(e);return t instanceof ToneEvent?(r=t,r.callback=this._tick.bind(this)):r=new ToneEvent({callback:this._tick.bind(this),context:this.context,value:t}),r.startOffset=n,r.set({humanize:this.humanize,loop:this.loop,loopEnd:this.loopEnd,loopStart:this.loopStart,playbackRate:this.playbackRate,probability:this.probability}),this._events.add(r),this._restartEvent(r),this}_restartEvent(e){this._state.forEach((t=>{"started"===t.state?this._startNote(e,t.time,t.offset):e.stop(new TicksClass(this.context,t.time))}))}remove(e,t){return isObject(e)&&e.hasOwnProperty("time")&&(e=(t=e).time),e=this.toTicks(e),this._events.forEach((r=>{r.startOffset===e&&(isUndef(t)||isDefined(t)&&r.value===t)&&(this._events.delete(r),r.dispose())})),this}clear(){return this._forEach((e=>e.dispose())),this._events.clear(),this}cancel(e){return this._forEach((t=>t.cancel(e))),this._state.cancel(this.toTicks(e)),this}_forEach(e){return this._events&&this._events.forEach((t=>{t instanceof Part?t._forEach(e):e(t)})),this}_setAll(e,t){this._forEach((r=>{r[e]=t}))}_tick(e,t){this.mute||this.callback(e,t)}_testLoopBoundries(e){this._loop&&(e.startOffset<this._loopStart||e.startOffset>=this._loopEnd)?e.cancel(0):"stopped"===e.state&&this._restartEvent(e)}get probability(){return this._probability}set probability(e){this._probability=e,this._setAll("probability",e)}get humanize(){return this._humanize}set humanize(e){this._humanize=e,this._setAll("humanize",e)}get loop(){return this._loop}set loop(e){this._loop=e,this._forEach((t=>{t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.loop=e,this._testLoopBoundries(t)}))}get loopEnd(){return new TicksClass(this.context,this._loopEnd).toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e),this._loop&&this._forEach((t=>{t.loopEnd=e,this._testLoopBoundries(t)}))}get loopStart(){return new TicksClass(this.context,this._loopStart).toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e),this._loop&&this._forEach((e=>{e.loopStart=this.loopStart,this._testLoopBoundries(e)}))}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this._setAll("playbackRate",e)}get length(){return this._events.size}dispose(){return super.dispose(),this.clear(),this}};function*upPatternGen(e){let t=0;for(;t<e.length;)t=clampToArraySize(t,e),yield e[t],t++}function*downPatternGen(e){let t=e.length-1;for(;t>=0;)t=clampToArraySize(t,e),yield e[t],t--}function*infiniteGen(e,t){for(;;)yield*t(e)}function clampToArraySize(e,t){return clamp(e,0,t.length-1)}function*alternatingGenerator(e,t){let r=t?0:e.length-1;for(;;)r=clampToArraySize(r,e),yield e[r],t?(r++,r>=e.length-1&&(t=!1)):(r--,r<=0&&(t=!0))}function*jumpUp(e){let t=0,r=0;for(;t<e.length;)t=clampToArraySize(t,e),yield e[t],r++,t+=r%2?2:-1}function*jumpDown(e){let t=e.length-1,r=0;for(;t>=0;)t=clampToArraySize(t,e),yield e[t],r++,t+=r%2?-2:1}function*randomGen(e){for(;;){let t=Math.floor(Math.random()*e.length);yield e[t]}}function*randomOnce(e){let t=[];for(let r=0;r<e.length;r++)t.push(r);for(;t.length>0;){let r=clampToArraySize(t.splice(Math.floor(t.length*Math.random()),1)[0],e);yield e[r]}}function*randomWalk(e){let t=Math.floor(Math.random()*e.length);for(;;)0===t?t++:t===e.length-1||Math.random()<.5?t--:t++,yield e[t]}function*PatternGenerator(e,t="up",r=0){switch(assert(e.length>0,"The array must have more than one value in it"),t){case"up":yield*infiniteGen(e,upPatternGen);case"down":yield*infiniteGen(e,downPatternGen);case"upDown":yield*alternatingGenerator(e,!0);case"downUp":yield*alternatingGenerator(e,!1);case"alternateUp":yield*infiniteGen(e,jumpUp);case"alternateDown":yield*infiniteGen(e,jumpDown);case"random":yield*randomGen(e);case"randomOnce":yield*infiniteGen(e,randomOnce);case"randomWalk":yield*randomWalk(e)}}var Pattern=class extends Loop{constructor(){super(optionsFromArguments(Pattern.getDefaults(),arguments,["callback","values","pattern"])),this.name="Pattern";let e=optionsFromArguments(Pattern.getDefaults(),arguments,["callback","values","pattern"]);this.callback=e.callback,this._values=e.values,this._pattern=PatternGenerator(e.values,e.pattern),this._type=e.pattern}static getDefaults(){return Object.assign(Loop.getDefaults(),{pattern:"up",values:[],callback:noOp})}_tick(e){let t=this._pattern.next();this._value=t.value,this.callback(e,this._value)}get values(){return this._values}set values(e){this._values=e,this.pattern=this._type}get value(){return this._value}get pattern(){return this._type}set pattern(e){this._type=e,this._pattern=PatternGenerator(this._values,this._type)}},Sequence=class extends ToneEvent{constructor(){super(optionsFromArguments(Sequence.getDefaults(),arguments,["callback","events","subdivision"])),this.name="Sequence",this._part=new Part({callback:this._seqCallback.bind(this),context:this.context}),this._events=[],this._eventsArray=[];let e=optionsFromArguments(Sequence.getDefaults(),arguments,["callback","events","subdivision"]);this._subdivision=this.toTicks(e.subdivision),this.events=e.events,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.playbackRate=e.playbackRate,this.probability=e.probability,this.humanize=e.humanize,this.mute=e.mute,this.playbackRate=e.playbackRate}static getDefaults(){return Object.assign(omitFromObject(ToneEvent.getDefaults(),["value"]),{events:[],loop:!0,loopEnd:0,loopStart:0,subdivision:"8n"})}_seqCallback(e,t){null!==t&&this.callback(e,t)}get events(){return this._events}set events(e){this.clear(),this._eventsArray=e,this._events=this._createSequence(this._eventsArray),this._eventsUpdated()}start(e,t){return this._part.start(e,t&&this._indexTime(t)),this}stop(e){return this._part.stop(e),this}get subdivision(){return new TicksClass(this.context,this._subdivision).toSeconds()}_createSequence(e){return new Proxy(e,{get:(e,t)=>e[t],set:(e,t,r)=>(isString(t)&&isFinite(parseInt(t,10))&&isArray2(r)?e[t]=this._createSequence(r):e[t]=r,this._eventsUpdated(),!0)})}_eventsUpdated(){this._part.clear(),this._rescheduleSequence(this._eventsArray,this._subdivision,this.startOffset),this.loopEnd=this.loopEnd}_rescheduleSequence(e,t,r){e.forEach(((e,n)=>{let i=n*t+r;if(isArray2(e))this._rescheduleSequence(e,t/e.length,i);else{let t=new TicksClass(this.context,i,"i").toSeconds();this._part.add(t,e)}}))}_indexTime(e){return new TicksClass(this.context,e*this._subdivision+this.startOffset).toSeconds()}clear(){return this._part.clear(),this}dispose(){return super.dispose(),this._part.dispose(),this}get loop(){return this._part.loop}set loop(e){this._part.loop=e}get loopStart(){return this._loopStart}set loopStart(e){this._loopStart=e,this._part.loopStart=this._indexTime(e)}get loopEnd(){return this._loopEnd}set loopEnd(e){this._loopEnd=e,this._part.loopEnd=0===e?this._indexTime(this._eventsArray.length):this._indexTime(e)}get startOffset(){return this._part.startOffset}set startOffset(e){this._part.startOffset=e}get playbackRate(){return this._part.playbackRate}set playbackRate(e){this._part.playbackRate=e}get probability(){return this._part.probability}set probability(e){this._part.probability=e}get progress(){return this._part.progress}get humanize(){return this._part.humanize}set humanize(e){this._part.humanize=e}get length(){return this._part.length}},CrossFade=class extends ToneAudioNode{constructor(){super(Object.assign(optionsFromArguments(CrossFade.getDefaults(),arguments,["fade"]))),this.name="CrossFade",this._panner=this.context.createStereoPanner(),this._split=this.context.createChannelSplitter(2),this._g2a=new GainToAudio({context:this.context}),this.a=new Gain({context:this.context,gain:0}),this.b=new Gain({context:this.context,gain:0}),this.output=new Gain({context:this.context}),this._internalChannels=[this.a,this.b];let e=optionsFromArguments(CrossFade.getDefaults(),arguments,["fade"]);this.fade=new Signal2({context:this.context,units:"normalRange",value:e.fade}),readOnly(this,"fade"),this.context.getConstant(1).connect(this._panner),this._panner.connect(this._split),this._panner.channelCount=1,this._panner.channelCountMode="explicit",connect(this._split,this.a.gain,0),connect(this._split,this.b.gain,1),this.fade.chain(this._g2a,this._panner.pan),this.a.connect(this.output),this.b.connect(this.output)}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{fade:.5})}dispose(){return super.dispose(),this.a.dispose(),this.b.dispose(),this.output.dispose(),this.fade.dispose(),this._g2a.dispose(),this._panner.disconnect(),this._split.disconnect(),this}},Effect=class extends ToneAudioNode{constructor(e){super(e),this.name="Effect",this._dryWet=new CrossFade({context:this.context}),this.wet=this._dryWet.fade,this.effectSend=new Gain({context:this.context}),this.effectReturn=new Gain({context:this.context}),this.input=new Gain({context:this.context}),this.output=this._dryWet,this.input.fan(this._dryWet.a,this.effectSend),this.effectReturn.connect(this._dryWet.b),this.wet.setValueAtTime(e.wet,0),this._internalChannels=[this.effectReturn,this.effectSend],readOnly(this,"wet")}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{wet:1})}connectEffect(e){return this._internalChannels.push(e),this.effectSend.chain(e,this.effectReturn),this}dispose(){return super.dispose(),this._dryWet.dispose(),this.effectSend.dispose(),this.effectReturn.dispose(),this.wet.dispose(),this}},LFOEffect=class extends Effect{constructor(e){super(e),this.name="LFOEffect",this._lfo=new LFO({context:this.context,frequency:e.frequency,amplitude:e.depth}),this.depth=this._lfo.amplitude,this.frequency=this._lfo.frequency,this.type=e.type,readOnly(this,["frequency","depth"])}static getDefaults(){return Object.assign(Effect.getDefaults(),{frequency:1,type:"sine",depth:1})}start(e){return this._lfo.start(e),this}stop(e){return this._lfo.stop(e),this}sync(){return this._lfo.sync(),this}unsync(){return this._lfo.unsync(),this}get type(){return this._lfo.type}set type(e){this._lfo.type=e}dispose(){return super.dispose(),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}},AutoFilter=class extends LFOEffect{constructor(){super(optionsFromArguments(AutoFilter.getDefaults(),arguments,["frequency","baseFrequency","octaves"])),this.name="AutoFilter";let e=optionsFromArguments(AutoFilter.getDefaults(),arguments,["frequency","baseFrequency","octaves"]);this.filter=new Filter3(Object.assign(e.filter,{context:this.context})),this.connectEffect(this.filter),this._lfo.connect(this.filter.frequency),this.octaves=e.octaves,this.baseFrequency=e.baseFrequency}static getDefaults(){return Object.assign(LFOEffect.getDefaults(),{baseFrequency:200,octaves:2.6,filter:{type:"lowpass",rolloff:-12,Q:1}})}get baseFrequency(){return this._lfo.min}set baseFrequency(e){this._lfo.min=this.toFrequency(e),this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(e){this._octaves=e,this._lfo.max=this._lfo.min*Math.pow(2,e)}dispose(){return super.dispose(),this.filter.dispose(),this}},Panner=class extends ToneAudioNode{constructor(){super(Object.assign(optionsFromArguments(Panner.getDefaults(),arguments,["pan"]))),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner;let e=optionsFromArguments(Panner.getDefaults(),arguments,["pan"]);this.pan=new Param({context:this.context,param:this._panner.pan,value:e.pan,minValue:-1,maxValue:1}),this._panner.channelCount=e.channelCount,this._panner.channelCountMode="explicit",readOnly(this,"pan")}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}},AutoPanner=class extends LFOEffect{constructor(){super(optionsFromArguments(AutoPanner.getDefaults(),arguments,["frequency"])),this.name="AutoPanner";let e=optionsFromArguments(AutoPanner.getDefaults(),arguments,["frequency"]);this._panner=new Panner({context:this.context,channelCount:e.channelCount}),this.connectEffect(this._panner),this._lfo.connect(this._panner.pan),this._lfo.min=-1,this._lfo.max=1}static getDefaults(){return Object.assign(LFOEffect.getDefaults(),{channelCount:1})}dispose(){return super.dispose(),this._panner.dispose(),this}},Follower=class extends ToneAudioNode{constructor(){super(optionsFromArguments(Follower.getDefaults(),arguments,["smoothing"])),this.name="Follower";let e=optionsFromArguments(Follower.getDefaults(),arguments,["smoothing"]);this._abs=this.input=new Abs({context:this.context}),this._lowpass=this.output=new OnePoleFilter({context:this.context,frequency:1/this.toSeconds(e.smoothing),type:"lowpass"}),this._abs.connect(this._lowpass),this._smoothing=e.smoothing}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{smoothing:.05})}get smoothing(){return this._smoothing}set smoothing(e){this._smoothing=e,this._lowpass.frequency=1/this.toSeconds(this.smoothing)}dispose(){return super.dispose(),this._abs.dispose(),this._lowpass.dispose(),this}},AutoWah=class extends Effect{constructor(){super(optionsFromArguments(AutoWah.getDefaults(),arguments,["baseFrequency","octaves","sensitivity"])),this.name="AutoWah";let e=optionsFromArguments(AutoWah.getDefaults(),arguments,["baseFrequency","octaves","sensitivity"]);this._follower=new Follower({context:this.context,smoothing:e.follower}),this._sweepRange=new ScaleExp({context:this.context,min:0,max:1,exponent:.5}),this._baseFrequency=this.toFrequency(e.baseFrequency),this._octaves=e.octaves,this._inputBoost=new Gain({context:this.context}),this._bandpass=new Filter3({context:this.context,rolloff:-48,frequency:0,Q:e.Q}),this._peaking=new Filter3({context:this.context,type:"peaking"}),this._peaking.gain.value=e.gain,this.gain=this._peaking.gain,this.Q=this._bandpass.Q,this.effectSend.chain(this._inputBoost,this._follower,this._sweepRange),this._sweepRange.connect(this._bandpass.frequency),this._sweepRange.connect(this._peaking.frequency),this.effectSend.chain(this._bandpass,this._peaking,this.effectReturn),this._setSweepRange(),this.sensitivity=e.sensitivity,readOnly(this,["gain","Q"])}static getDefaults(){return Object.assign(Effect.getDefaults(),{baseFrequency:100,octaves:6,sensitivity:0,Q:2,gain:2,follower:.2})}get octaves(){return this._octaves}set octaves(e){this._octaves=e,this._setSweepRange()}get follower(){return this._follower.smoothing}set follower(e){this._follower.smoothing=e}get baseFrequency(){return this._baseFrequency}set baseFrequency(e){this._baseFrequency=this.toFrequency(e),this._setSweepRange()}get sensitivity(){return gainToDb(1/this._inputBoost.gain.value)}set sensitivity(e){this._inputBoost.gain.value=1/dbToGain(e)}_setSweepRange(){this._sweepRange.min=this._baseFrequency,this._sweepRange.max=Math.min(this._baseFrequency*Math.pow(2,this._octaves),this.context.sampleRate/2)}dispose(){return super.dispose(),this._follower.dispose(),this._sweepRange.dispose(),this._bandpass.dispose(),this._peaking.dispose(),this._inputBoost.dispose(),this}},workletName2="bit-crusher",bitCrusherWorklet="\n\tclass BitCrusherWorklet extends SingleIOProcessor {\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: \"bits\",\n\t\t\t\tdefaultValue: 12,\n\t\t\t\tminValue: 1,\n\t\t\t\tmaxValue: 16,\n\t\t\t\tautomationRate: 'k-rate'\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, _channel, parameters) {\n\t\t\tconst step = Math.pow(0.5, parameters.bits - 1);\n\t\t\tconst val = step * Math.floor(input / step + 0.5);\n\t\t\treturn val;\n\t\t}\n\t}\n";registerProcessor(workletName2,bitCrusherWorklet);var BitCrusher=class extends Effect{constructor(){super(optionsFromArguments(BitCrusher.getDefaults(),arguments,["bits"])),this.name="BitCrusher";let e=optionsFromArguments(BitCrusher.getDefaults(),arguments,["bits"]);this._bitCrusherWorklet=new BitCrusherWorklet({context:this.context,bits:e.bits}),this.connectEffect(this._bitCrusherWorklet),this.bits=this._bitCrusherWorklet.bits}static getDefaults(){return Object.assign(Effect.getDefaults(),{bits:4})}dispose(){return super.dispose(),this._bitCrusherWorklet.dispose(),this}},BitCrusherWorklet=class extends ToneAudioWorklet{constructor(){super(optionsFromArguments(BitCrusherWorklet.getDefaults(),arguments)),this.name="BitCrusherWorklet";let e=optionsFromArguments(BitCrusherWorklet.getDefaults(),arguments);this.input=new Gain({context:this.context}),this.output=new Gain({context:this.context}),this.bits=new Param({context:this.context,value:e.bits,units:"positive",minValue:1,maxValue:16,param:this._dummyParam,swappable:!0})}static getDefaults(){return Object.assign(ToneAudioWorklet.getDefaults(),{bits:12})}_audioWorkletName(){return workletName2}onReady(e){connectSeries(this.input,e,this.output);let t=e.parameters.get("bits");this.bits.setParam(t)}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.bits.dispose(),this}},Chebyshev=class extends Effect{constructor(){super(optionsFromArguments(Chebyshev.getDefaults(),arguments,["order"])),this.name="Chebyshev";let e=optionsFromArguments(Chebyshev.getDefaults(),arguments,["order"]);this._shaper=new WaveShaper({context:this.context,length:4096}),this._order=e.order,this.connectEffect(this._shaper),this.order=e.order,this.oversample=e.oversample}static getDefaults(){return Object.assign(Effect.getDefaults(),{order:1,oversample:"none"})}_getCoefficient(e,t,r){return r.has(t)||(0===t?r.set(t,0):1===t?r.set(t,e):r.set(t,2*e*this._getCoefficient(e,t-1,r)-this._getCoefficient(e,t-2,r))),r.get(t)}get order(){return this._order}set order(e){this._order=e,this._shaper.setMap((t=>this._getCoefficient(t,e,new Map)))}get oversample(){return this._shaper.oversample}set oversample(e){this._shaper.oversample=e}dispose(){return super.dispose(),this._shaper.dispose(),this}},Split=class extends ToneAudioNode{constructor(){super(optionsFromArguments(Split.getDefaults(),arguments,["channels"])),this.name="Split";let e=optionsFromArguments(Split.getDefaults(),arguments,["channels"]);this._splitter=this.input=this.output=this.context.createChannelSplitter(e.channels),this._internalChannels=[this._splitter]}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._splitter.disconnect(),this}},Merge=class extends ToneAudioNode{constructor(){super(optionsFromArguments(Merge.getDefaults(),arguments,["channels"])),this.name="Merge";let e=optionsFromArguments(Merge.getDefaults(),arguments,["channels"]);this._merger=this.output=this.input=this.context.createChannelMerger(e.channels)}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._merger.disconnect(),this}},StereoEffect=class extends ToneAudioNode{constructor(e){super(e),this.name="StereoEffect",this.input=new Gain({context:this.context}),this.input.channelCount=2,this.input.channelCountMode="explicit",this._dryWet=this.output=new CrossFade({context:this.context,fade:e.wet}),this.wet=this._dryWet.fade,this._split=new Split({context:this.context,channels:2}),this._merge=new Merge({context:this.context,channels:2}),this.input.connect(this._split),this.input.connect(this._dryWet.a),this._merge.connect(this._dryWet.b),readOnly(this,["wet"])}connectEffectLeft(...e){this._split.connect(e[0],0,0),connectSeries(...e),connect(e[e.length-1],this._merge,0,0)}connectEffectRight(...e){this._split.connect(e[0],1,0),connectSeries(...e),connect(e[e.length-1],this._merge,0,1)}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{wet:1})}dispose(){return super.dispose(),this._dryWet.dispose(),this._split.dispose(),this._merge.dispose(),this}},StereoFeedbackEffect=class extends StereoEffect{constructor(e){super(e),this.feedback=new Signal2({context:this.context,value:e.feedback,units:"normalRange"}),this._feedbackL=new Gain({context:this.context}),this._feedbackR=new Gain({context:this.context}),this._feedbackSplit=new Split({context:this.context,channels:2}),this._feedbackMerge=new Merge({context:this.context,channels:2}),this._merge.connect(this._feedbackSplit),this._feedbackMerge.connect(this._split),this._feedbackSplit.connect(this._feedbackL,0,0),this._feedbackL.connect(this._feedbackMerge,0,0),this._feedbackSplit.connect(this._feedbackR,1,0),this._feedbackR.connect(this._feedbackMerge,0,1),this.feedback.fan(this._feedbackL.gain,this._feedbackR.gain),readOnly(this,["feedback"])}static getDefaults(){return Object.assign(StereoEffect.getDefaults(),{feedback:.5})}dispose(){return super.dispose(),this.feedback.dispose(),this._feedbackL.dispose(),this._feedbackR.dispose(),this._feedbackSplit.dispose(),this._feedbackMerge.dispose(),this}},Chorus=class extends StereoFeedbackEffect{constructor(){super(optionsFromArguments(Chorus.getDefaults(),arguments,["frequency","delayTime","depth"])),this.name="Chorus";let e=optionsFromArguments(Chorus.getDefaults(),arguments,["frequency","delayTime","depth"]);this._depth=e.depth,this._delayTime=e.delayTime/1e3,this._lfoL=new LFO({context:this.context,frequency:e.frequency,min:0,max:1}),this._lfoR=new LFO({context:this.context,frequency:e.frequency,min:0,max:1,phase:180}),this._delayNodeL=new Delay({context:this.context}),this._delayNodeR=new Delay({context:this.context}),this.frequency=this._lfoL.frequency,readOnly(this,["frequency"]),this._lfoL.frequency.connect(this._lfoR.frequency),this.connectEffectLeft(this._delayNodeL),this.connectEffectRight(this._delayNodeR),this._lfoL.connect(this._delayNodeL.delayTime),this._lfoR.connect(this._delayNodeR.delayTime),this.depth=this._depth,this.type=e.type,this.spread=e.spread}static getDefaults(){return Object.assign(StereoFeedbackEffect.getDefaults(),{frequency:1.5,delayTime:3.5,depth:.7,type:"sine",spread:180,feedback:0,wet:.5})}get depth(){return this._depth}set depth(e){this._depth=e;let t=this._delayTime*e;this._lfoL.min=Math.max(this._delayTime-t,0),this._lfoL.max=this._delayTime+t,this._lfoR.min=Math.max(this._delayTime-t,0),this._lfoR.max=this._delayTime+t}get delayTime(){return 1e3*this._delayTime}set delayTime(e){this._delayTime=e/1e3,this.depth=this._depth}get type(){return this._lfoL.type}set type(e){this._lfoL.type=e,this._lfoR.type=e}get spread(){return this._lfoR.phase-this._lfoL.phase}set spread(e){this._lfoL.phase=90-e/2,this._lfoR.phase=e/2+90}start(e){return this._lfoL.start(e),this._lfoR.start(e),this}stop(e){return this._lfoL.stop(e),this._lfoR.stop(e),this}sync(){return this._lfoL.sync(),this._lfoR.sync(),this}unsync(){return this._lfoL.unsync(),this._lfoR.unsync(),this}dispose(){return super.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._delayNodeL.dispose(),this._delayNodeR.dispose(),this.frequency.dispose(),this}},Distortion=class extends Effect{constructor(){super(optionsFromArguments(Distortion.getDefaults(),arguments,["distortion"])),this.name="Distortion";let e=optionsFromArguments(Distortion.getDefaults(),arguments,["distortion"]);this._shaper=new WaveShaper({context:this.context,length:4096}),this._distortion=e.distortion,this.connectEffect(this._shaper),this.distortion=e.distortion,this.oversample=e.oversample}static getDefaults(){return Object.assign(Effect.getDefaults(),{distortion:.4,oversample:"none"})}get distortion(){return this._distortion}set distortion(e){this._distortion=e;let t=100*e,r=Math.PI/180;this._shaper.setMap((e=>Math.abs(e)<.001?0:(3+t)*e*20*r/(Math.PI+t*Math.abs(e))))}get oversample(){return this._shaper.oversample}set oversample(e){this._shaper.oversample=e}dispose(){return super.dispose(),this._shaper.dispose(),this}},FeedbackEffect=class extends Effect{constructor(e){super(e),this.name="FeedbackEffect",this._feedbackGain=new Gain({context:this.context,gain:e.feedback,units:"normalRange"}),this.feedback=this._feedbackGain.gain,readOnly(this,"feedback"),this.effectReturn.chain(this._feedbackGain,this.effectSend)}static getDefaults(){return Object.assign(Effect.getDefaults(),{feedback:.125})}dispose(){return super.dispose(),this._feedbackGain.dispose(),this.feedback.dispose(),this}},FeedbackDelay=class extends FeedbackEffect{constructor(){super(optionsFromArguments(FeedbackDelay.getDefaults(),arguments,["delayTime","feedback"])),this.name="FeedbackDelay";let e=optionsFromArguments(FeedbackDelay.getDefaults(),arguments,["delayTime","feedback"]);this._delayNode=new Delay({context:this.context,delayTime:e.delayTime,maxDelay:e.maxDelay}),this.delayTime=this._delayNode.delayTime,this.connectEffect(this._delayNode),readOnly(this,"delayTime")}static getDefaults(){return Object.assign(FeedbackEffect.getDefaults(),{delayTime:.25,maxDelay:1})}dispose(){return super.dispose(),this._delayNode.dispose(),this.delayTime.dispose(),this}},PhaseShiftAllpass=class extends ToneAudioNode{constructor(e){super(e),this.name="PhaseShiftAllpass",this.input=new Gain({context:this.context}),this.output=new Gain({context:this.context}),this.offset90=new Gain({context:this.context}),this._bank0=this._createAllPassFilterBank([.6923878,.9360654322959,.988229522686,.9987488452737]),this._bank1=this._createAllPassFilterBank([.4021921162426,.856171088242,.9722909545651,.9952884791278]),this._oneSampleDelay=this.context.createIIRFilter([0,1],[1,0]),connectSeries(this.input,...this._bank0,this._oneSampleDelay,this.output),connectSeries(this.input,...this._bank1,this.offset90)}_createAllPassFilterBank(e){return e.map((e=>{let t=[[e*e,0,-1],[1,0,-e*e]];return this.context.createIIRFilter(t[0],t[1])}))}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.offset90.dispose(),this._bank0.forEach((e=>e.disconnect())),this._bank1.forEach((e=>e.disconnect())),this._oneSampleDelay.disconnect(),this}},FrequencyShifter=class extends Effect{constructor(){super(optionsFromArguments(FrequencyShifter.getDefaults(),arguments,["frequency"])),this.name="FrequencyShifter";let e=optionsFromArguments(FrequencyShifter.getDefaults(),arguments,["frequency"]);this.frequency=new Signal2({context:this.context,units:"frequency",value:e.frequency,minValue:-this.context.sampleRate/2,maxValue:this.context.sampleRate/2}),this._sine=new ToneOscillatorNode({context:this.context,type:"sine"}),this._cosine=new Oscillator({context:this.context,phase:-90,type:"sine"}),this._sineMultiply=new Multiply({context:this.context}),this._cosineMultiply=new Multiply({context:this.context}),this._negate=new Negate({context:this.context}),this._add=new Add({context:this.context}),this._phaseShifter=new PhaseShiftAllpass({context:this.context}),this.effectSend.connect(this._phaseShifter),this.frequency.fan(this._sine.frequency,this._cosine.frequency),this._phaseShifter.offset90.connect(this._cosineMultiply),this._cosine.connect(this._cosineMultiply.factor),this._phaseShifter.connect(this._sineMultiply),this._sine.connect(this._sineMultiply.factor),this._sineMultiply.connect(this._negate),this._cosineMultiply.connect(this._add),this._negate.connect(this._add.addend),this._add.connect(this.effectReturn);let t=this.immediate();this._sine.start(t),this._cosine.start(t)}static getDefaults(){return Object.assign(Effect.getDefaults(),{frequency:0})}dispose(){return super.dispose(),this.frequency.dispose(),this._add.dispose(),this._cosine.dispose(),this._cosineMultiply.dispose(),this._negate.dispose(),this._phaseShifter.dispose(),this._sine.dispose(),this._sineMultiply.dispose(),this}},combFilterTunings=[1557/44100,1617/44100,1491/44100,1422/44100,1277/44100,1356/44100,1188/44100,1116/44100],allpassFilterFrequencies=[225,556,441,341],Freeverb=class extends StereoEffect{constructor(){super(optionsFromArguments(Freeverb.getDefaults(),arguments,["roomSize","dampening"])),this.name="Freeverb",this._combFilters=[],this._allpassFiltersL=[],this._allpassFiltersR=[];let e=optionsFromArguments(Freeverb.getDefaults(),arguments,["roomSize","dampening"]);this.roomSize=new Signal2({context:this.context,value:e.roomSize,units:"normalRange"}),this._allpassFiltersL=allpassFilterFrequencies.map((e=>{let t=this.context.createBiquadFilter();return t.type="allpass",t.frequency.value=e,t})),this._allpassFiltersR=allpassFilterFrequencies.map((e=>{let t=this.context.createBiquadFilter();return t.type="allpass",t.frequency.value=e,t})),this._combFilters=combFilterTunings.map(((t,r)=>{let n=new LowpassCombFilter({context:this.context,dampening:e.dampening,delayTime:t});return r<combFilterTunings.length/2?this.connectEffectLeft(n,...this._allpassFiltersL):this.connectEffectRight(n,...this._allpassFiltersR),this.roomSize.connect(n.resonance),n})),readOnly(this,["roomSize"])}static getDefaults(){return Object.assign(StereoEffect.getDefaults(),{roomSize:.7,dampening:3e3})}get dampening(){return this._combFilters[0].dampening}set dampening(e){this._combFilters.forEach((t=>t.dampening=e))}dispose(){return super.dispose(),this._allpassFiltersL.forEach((e=>e.disconnect())),this._allpassFiltersR.forEach((e=>e.disconnect())),this._combFilters.forEach((e=>e.dispose())),this.roomSize.dispose(),this}},combFilterDelayTimes=[.06748,.06404,.08212,.09004],combFilterResonances=[.773,.802,.753,.733],allpassFilterFreqs=[347,113,37],JCReverb=class extends StereoEffect{constructor(){super(optionsFromArguments(JCReverb.getDefaults(),arguments,["roomSize"])),this.name="JCReverb",this._allpassFilters=[],this._feedbackCombFilters=[];let e=optionsFromArguments(JCReverb.getDefaults(),arguments,["roomSize"]);this.roomSize=new Signal2({context:this.context,value:e.roomSize,units:"normalRange"}),this._scaleRoomSize=new Scale({context:this.context,min:-.733,max:.197}),this._allpassFilters=allpassFilterFreqs.map((e=>{let t=this.context.createBiquadFilter();return t.type="allpass",t.frequency.value=e,t})),this._feedbackCombFilters=combFilterDelayTimes.map(((e,t)=>{let r=new FeedbackCombFilter({context:this.context,delayTime:e});return this._scaleRoomSize.connect(r.resonance),r.resonance.value=combFilterResonances[t],t<combFilterDelayTimes.length/2?this.connectEffectLeft(...this._allpassFilters,r):this.connectEffectRight(...this._allpassFilters,r),r})),this.roomSize.connect(this._scaleRoomSize),readOnly(this,["roomSize"])}static getDefaults(){return Object.assign(StereoEffect.getDefaults(),{roomSize:.5})}dispose(){return super.dispose(),this._allpassFilters.forEach((e=>e.disconnect())),this._feedbackCombFilters.forEach((e=>e.dispose())),this.roomSize.dispose(),this._scaleRoomSize.dispose(),this}},StereoXFeedbackEffect=class extends StereoFeedbackEffect{constructor(e){super(e),this._feedbackL.disconnect(),this._feedbackL.connect(this._feedbackMerge,0,1),this._feedbackR.disconnect(),this._feedbackR.connect(this._feedbackMerge,0,0),readOnly(this,["feedback"])}},PingPongDelay=class extends StereoXFeedbackEffect{constructor(){super(optionsFromArguments(PingPongDelay.getDefaults(),arguments,["delayTime","feedback"])),this.name="PingPongDelay";let e=optionsFromArguments(PingPongDelay.getDefaults(),arguments,["delayTime","feedback"]);this._leftDelay=new Delay({context:this.context,maxDelay:e.maxDelay}),this._rightDelay=new Delay({context:this.context,maxDelay:e.maxDelay}),this._rightPreDelay=new Delay({context:this.context,maxDelay:e.maxDelay}),this.delayTime=new Signal2({context:this.context,units:"time",value:e.delayTime}),this.connectEffectLeft(this._leftDelay),this.connectEffectRight(this._rightPreDelay,this._rightDelay),this.delayTime.fan(this._leftDelay.delayTime,this._rightDelay.delayTime,this._rightPreDelay.delayTime),this._feedbackL.disconnect(),this._feedbackL.connect(this._rightDelay),readOnly(this,["delayTime"])}static getDefaults(){return Object.assign(StereoXFeedbackEffect.getDefaults(),{delayTime:.25,maxDelay:1})}dispose(){return super.dispose(),this._leftDelay.dispose(),this._rightDelay.dispose(),this._rightPreDelay.dispose(),this.delayTime.dispose(),this}},PitchShift=class extends FeedbackEffect{constructor(){super(optionsFromArguments(PitchShift.getDefaults(),arguments,["pitch"])),this.name="PitchShift";let e=optionsFromArguments(PitchShift.getDefaults(),arguments,["pitch"]);this._frequency=new Signal2({context:this.context}),this._delayA=new Delay({maxDelay:1,context:this.context}),this._lfoA=new LFO({context:this.context,min:0,max:.1,type:"sawtooth"}).connect(this._delayA.delayTime),this._delayB=new Delay({maxDelay:1,context:this.context}),this._lfoB=new LFO({context:this.context,min:0,max:.1,type:"sawtooth",phase:180}).connect(this._delayB.delayTime),this._crossFade=new CrossFade({context:this.context}),this._crossFadeLFO=new LFO({context:this.context,min:0,max:1,type:"triangle",phase:90}).connect(this._crossFade.fade),this._feedbackDelay=new Delay({delayTime:e.delayTime,context:this.context}),this.delayTime=this._feedbackDelay.delayTime,readOnly(this,"delayTime"),this._pitch=e.pitch,this._windowSize=e.windowSize,this._delayA.connect(this._crossFade.a),this._delayB.connect(this._crossFade.b),this._frequency.fan(this._lfoA.frequency,this._lfoB.frequency,this._crossFadeLFO.frequency),this.effectSend.fan(this._delayA,this._delayB),this._crossFade.chain(this._feedbackDelay,this.effectReturn);let t=this.now();this._lfoA.start(t),this._lfoB.start(t),this._crossFadeLFO.start(t),this.windowSize=this._windowSize}static getDefaults(){return Object.assign(FeedbackEffect.getDefaults(),{pitch:0,windowSize:.1,delayTime:0,feedback:0})}get pitch(){return this._pitch}set pitch(e){this._pitch=e;let t=0;e<0?(this._lfoA.min=0,this._lfoA.max=this._windowSize,this._lfoB.min=0,this._lfoB.max=this._windowSize,t=intervalToFrequencyRatio(e-1)+1):(this._lfoA.min=this._windowSize,this._lfoA.max=0,this._lfoB.min=this._windowSize,this._lfoB.max=0,t=intervalToFrequencyRatio(e)-1),this._frequency.value=t*(1.2/this._windowSize)}get windowSize(){return this._windowSize}set windowSize(e){this._windowSize=this.toSeconds(e),this.pitch=this._pitch}dispose(){return super.dispose(),this._frequency.dispose(),this._delayA.dispose(),this._delayB.dispose(),this._lfoA.dispose(),this._lfoB.dispose(),this._crossFade.dispose(),this._crossFadeLFO.dispose(),this._feedbackDelay.dispose(),this}},Phaser=class extends StereoEffect{constructor(){super(optionsFromArguments(Phaser.getDefaults(),arguments,["frequency","octaves","baseFrequency"])),this.name="Phaser";let e=optionsFromArguments(Phaser.getDefaults(),arguments,["frequency","octaves","baseFrequency"]);this._lfoL=new LFO({context:this.context,frequency:e.frequency,min:0,max:1}),this._lfoR=new LFO({context:this.context,frequency:e.frequency,min:0,max:1,phase:180}),this._baseFrequency=this.toFrequency(e.baseFrequency),this._octaves=e.octaves,this.Q=new Signal2({context:this.context,value:e.Q,units:"positive"}),this._filtersL=this._makeFilters(e.stages,this._lfoL),this._filtersR=this._makeFilters(e.stages,this._lfoR),this.frequency=this._lfoL.frequency,this.frequency.value=e.frequency,this.connectEffectLeft(...this._filtersL),this.connectEffectRight(...this._filtersR),this._lfoL.frequency.connect(this._lfoR.frequency),this.baseFrequency=e.baseFrequency,this.octaves=e.octaves,this._lfoL.start(),this._lfoR.start(),readOnly(this,["frequency","Q"])}static getDefaults(){return Object.assign(StereoEffect.getDefaults(),{frequency:.5,octaves:3,stages:10,Q:10,baseFrequency:350})}_makeFilters(e,t){let r=[];for(let n=0;n<e;n++){let e=this.context.createBiquadFilter();e.type="allpass",this.Q.connect(e.Q),t.connect(e.frequency),r.push(e)}return r}get octaves(){return this._octaves}set octaves(e){this._octaves=e;let t=this._baseFrequency*Math.pow(2,e);this._lfoL.max=t,this._lfoR.max=t}get baseFrequency(){return this._baseFrequency}set baseFrequency(e){this._baseFrequency=this.toFrequency(e),this._lfoL.min=this._baseFrequency,this._lfoR.min=this._baseFrequency,this.octaves=this._octaves}dispose(){return super.dispose(),this.Q.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._filtersL.forEach((e=>e.disconnect())),this._filtersR.forEach((e=>e.disconnect())),this.frequency.dispose(),this}},Reverb=class extends Effect{constructor(){super(optionsFromArguments(Reverb.getDefaults(),arguments,["decay"])),this.name="Reverb",this._convolver=this.context.createConvolver(),this.ready=Promise.resolve();let e=optionsFromArguments(Reverb.getDefaults(),arguments,["decay"]);this._decay=e.decay,this._preDelay=e.preDelay,this.generate(),this.connectEffect(this._convolver)}static getDefaults(){return Object.assign(Effect.getDefaults(),{decay:1.5,preDelay:.01})}get decay(){return this._decay}set decay(e){assertRange(e=this.toSeconds(e),.001),this._decay=e,this.generate()}get preDelay(){return this._preDelay}set preDelay(e){assertRange(e=this.toSeconds(e),0),this._preDelay=e,this.generate()}generate(){return __awaiter2(this,void 0,void 0,(function*(){let e=this.ready,t=new OfflineContext(2,this._decay+this._preDelay,this.context.sampleRate),r=new Noise({context:t}),n=new Noise({context:t}),i=new Merge({context:t});r.connect(i,0,0),n.connect(i,0,1);let s=new Gain({context:t}).toDestination();i.connect(s),r.start(0),n.start(0),s.gain.setValueAtTime(0,0),s.gain.setValueAtTime(1,this._preDelay),s.gain.exponentialApproachValueAtTime(0,this._preDelay,this.decay);let o=t.render();return this.ready=o.then(noOp),yield e,this._convolver.buffer=(yield o).get(),this}))}dispose(){return super.dispose(),this._convolver.disconnect(),this}},MidSideSplit=class extends ToneAudioNode{constructor(){super(optionsFromArguments(MidSideSplit.getDefaults(),arguments)),this.name="MidSideSplit",this._split=this.input=new Split({channels:2,context:this.context}),this._midAdd=new Add({context:this.context}),this.mid=new Multiply({context:this.context,value:Math.SQRT1_2}),this._sideSubtract=new Subtract({context:this.context}),this.side=new Multiply({context:this.context,value:Math.SQRT1_2}),this._split.connect(this._midAdd,0),this._split.connect(this._midAdd.addend,1),this._split.connect(this._sideSubtract,0),this._split.connect(this._sideSubtract.subtrahend,1),this._midAdd.connect(this.mid),this._sideSubtract.connect(this.side)}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._midAdd.dispose(),this._sideSubtract.dispose(),this._split.dispose(),this}},MidSideMerge=class extends ToneAudioNode{constructor(){super(optionsFromArguments(MidSideMerge.getDefaults(),arguments)),this.name="MidSideMerge",this.mid=new Gain({context:this.context}),this.side=new Gain({context:this.context}),this._left=new Add({context:this.context}),this._leftMult=new Multiply({context:this.context,value:Math.SQRT1_2}),this._right=new Subtract({context:this.context}),this._rightMult=new Multiply({context:this.context,value:Math.SQRT1_2}),this._merge=this.output=new Merge({context:this.context}),this.mid.fan(this._left),this.side.connect(this._left.addend),this.mid.connect(this._right),this.side.connect(this._right.subtrahend),this._left.connect(this._leftMult),this._right.connect(this._rightMult),this._leftMult.connect(this._merge,0,0),this._rightMult.connect(this._merge,0,1)}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._leftMult.dispose(),this._rightMult.dispose(),this._left.dispose(),this._right.dispose(),this}},MidSideEffect=class extends Effect{constructor(e){super(e),this.name="MidSideEffect",this._midSideMerge=new MidSideMerge({context:this.context}),this._midSideSplit=new MidSideSplit({context:this.context}),this._midSend=this._midSideSplit.mid,this._sideSend=this._midSideSplit.side,this._midReturn=this._midSideMerge.mid,this._sideReturn=this._midSideMerge.side,this.effectSend.connect(this._midSideSplit),this._midSideMerge.connect(this.effectReturn)}connectEffectMid(...e){this._midSend.chain(...e,this._midReturn)}connectEffectSide(...e){this._sideSend.chain(...e,this._sideReturn)}dispose(){return super.dispose(),this._midSideSplit.dispose(),this._midSideMerge.dispose(),this._midSend.dispose(),this._sideSend.dispose(),this._midReturn.dispose(),this._sideReturn.dispose(),this}},StereoWidener=class extends MidSideEffect{constructor(){super(optionsFromArguments(StereoWidener.getDefaults(),arguments,["width"])),this.name="StereoWidener";let e=optionsFromArguments(StereoWidener.getDefaults(),arguments,["width"]);this.width=new Signal2({context:this.context,value:e.width,units:"normalRange"}),readOnly(this,["width"]),this._twoTimesWidthMid=new Multiply({context:this.context,value:2}),this._twoTimesWidthSide=new Multiply({context:this.context,value:2}),this._midMult=new Multiply({context:this.context}),this._twoTimesWidthMid.connect(this._midMult.factor),this.connectEffectMid(this._midMult),this._oneMinusWidth=new Subtract({context:this.context}),this._oneMinusWidth.connect(this._twoTimesWidthMid),connect(this.context.getConstant(1),this._oneMinusWidth),this.width.connect(this._oneMinusWidth.subtrahend),this._sideMult=new Multiply({context:this.context}),this.width.connect(this._twoTimesWidthSide),this._twoTimesWidthSide.connect(this._sideMult.factor),this.connectEffectSide(this._sideMult)}static getDefaults(){return Object.assign(MidSideEffect.getDefaults(),{width:.5})}dispose(){return super.dispose(),this.width.dispose(),this._midMult.dispose(),this._sideMult.dispose(),this._twoTimesWidthMid.dispose(),this._twoTimesWidthSide.dispose(),this._oneMinusWidth.dispose(),this}},Tremolo=class extends StereoEffect{constructor(){super(optionsFromArguments(Tremolo.getDefaults(),arguments,["frequency","depth"])),this.name="Tremolo";let e=optionsFromArguments(Tremolo.getDefaults(),arguments,["frequency","depth"]);this._lfoL=new LFO({context:this.context,type:e.type,min:1,max:0}),this._lfoR=new LFO({context:this.context,type:e.type,min:1,max:0}),this._amplitudeL=new Gain({context:this.context}),this._amplitudeR=new Gain({context:this.context}),this.frequency=new Signal2({context:this.context,value:e.frequency,units:"frequency"}),this.depth=new Signal2({context:this.context,value:e.depth,units:"normalRange"}),readOnly(this,["frequency","depth"]),this.connectEffectLeft(this._amplitudeL),this.connectEffectRight(this._amplitudeR),this._lfoL.connect(this._amplitudeL.gain),this._lfoR.connect(this._amplitudeR.gain),this.frequency.fan(this._lfoL.frequency,this._lfoR.frequency),this.depth.fan(this._lfoR.amplitude,this._lfoL.amplitude),this.spread=e.spread}static getDefaults(){return Object.assign(StereoEffect.getDefaults(),{frequency:10,type:"sine",depth:.5,spread:180})}start(e){return this._lfoL.start(e),this._lfoR.start(e),this}stop(e){return this._lfoL.stop(e),this._lfoR.stop(e),this}sync(){return this._lfoL.sync(),this._lfoR.sync(),this.context.transport.syncSignal(this.frequency),this}unsync(){return this._lfoL.unsync(),this._lfoR.unsync(),this.context.transport.unsyncSignal(this.frequency),this}get type(){return this._lfoL.type}set type(e){this._lfoL.type=e,this._lfoR.type=e}get spread(){return this._lfoR.phase-this._lfoL.phase}set spread(e){this._lfoL.phase=90-e/2,this._lfoR.phase=e/2+90}dispose(){return super.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._amplitudeL.dispose(),this._amplitudeR.dispose(),this.frequency.dispose(),this.depth.dispose(),this}},Vibrato=class extends Effect{constructor(){super(optionsFromArguments(Vibrato.getDefaults(),arguments,["frequency","depth"])),this.name="Vibrato";let e=optionsFromArguments(Vibrato.getDefaults(),arguments,["frequency","depth"]);this._delayNode=new Delay({context:this.context,delayTime:0,maxDelay:e.maxDelay}),this._lfo=new LFO({context:this.context,type:e.type,min:0,max:e.maxDelay,frequency:e.frequency,phase:-90}).start().connect(this._delayNode.delayTime),this.frequency=this._lfo.frequency,this.depth=this._lfo.amplitude,this.depth.value=e.depth,readOnly(this,["frequency","depth"]),this.effectSend.chain(this._delayNode,this.effectReturn)}static getDefaults(){return Object.assign(Effect.getDefaults(),{maxDelay:.005,frequency:5,depth:.1,type:"sine"})}get type(){return this._lfo.type}set type(e){this._lfo.type=e}dispose(){return super.dispose(),this._delayNode.dispose(),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}},Analyser=class extends ToneAudioNode{constructor(){super(optionsFromArguments(Analyser.getDefaults(),arguments,["type","size"])),this.name="Analyser",this._analysers=[],this._buffers=[];let e=optionsFromArguments(Analyser.getDefaults(),arguments,["type","size"]);this.input=this.output=this._gain=new Gain({context:this.context}),this._split=new Split({context:this.context,channels:e.channels}),this.input.connect(this._split),assertRange(e.channels,1);for(let t=0;t<e.channels;t++)this._analysers[t]=this.context.createAnalyser(),this._split.connect(this._analysers[t],t,0);this.size=e.size,this.type=e.type}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{size:1024,smoothing:.8,type:"fft",channels:1})}getValue(){return this._analysers.forEach(((e,t)=>{let r=this._buffers[t];"fft"===this._type?e.getFloatFrequencyData(r):"waveform"===this._type&&e.getFloatTimeDomainData(r)})),1===this.channels?this._buffers[0]:this._buffers}get size(){return this._analysers[0].frequencyBinCount}set size(e){this._analysers.forEach(((t,r)=>{t.fftSize=2*e,this._buffers[r]=new Float32Array(e)}))}get channels(){return this._analysers.length}get type(){return this._type}set type(e){assert("waveform"===e||"fft"===e,`Analyser: invalid type: ${e}`),this._type=e}get smoothing(){return this._analysers[0].smoothingTimeConstant}set smoothing(e){this._analysers.forEach((t=>t.smoothingTimeConstant=e))}dispose(){return super.dispose(),this._analysers.forEach((e=>e.disconnect())),this._split.dispose(),this._gain.dispose(),this}},MeterBase=class extends ToneAudioNode{constructor(){super(optionsFromArguments(MeterBase.getDefaults(),arguments)),this.name="MeterBase",this.input=this.output=this._analyser=new Analyser({context:this.context,size:256,type:"waveform"})}dispose(){return super.dispose(),this._analyser.dispose(),this}},Meter=class extends MeterBase{constructor(){super(optionsFromArguments(Meter.getDefaults(),arguments,["smoothing"])),this.name="Meter",this._rms=0;let e=optionsFromArguments(Meter.getDefaults(),arguments,["smoothing"]);this.input=this.output=this._analyser=new Analyser({context:this.context,size:256,type:"waveform",channels:e.channels}),this.smoothing=e.smoothing,this.normalRange=e.normalRange}static getDefaults(){return Object.assign(MeterBase.getDefaults(),{smoothing:.8,normalRange:!1,channels:1})}getLevel(){return warn("'getLevel' has been changed to 'getValue'"),this.getValue()}getValue(){let e=this._analyser.getValue(),t=(1===this.channels?[e]:e).map((e=>{let t=e.reduce(((e,t)=>e+t*t),0),r=Math.sqrt(t/e.length);return this._rms=Math.max(r,this._rms*this.smoothing),this.normalRange?this._rms:gainToDb(this._rms)}));return 1===this.channels?t[0]:t}get channels(){return this._analyser.channels}dispose(){return super.dispose(),this._analyser.dispose(),this}},FFT=class extends MeterBase{constructor(){super(optionsFromArguments(FFT.getDefaults(),arguments,["size"])),this.name="FFT";let e=optionsFromArguments(FFT.getDefaults(),arguments,["size"]);this.normalRange=e.normalRange,this._analyser.type="fft",this.size=e.size}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{normalRange:!1,size:1024,smoothing:.8})}getValue(){return this._analyser.getValue().map((e=>this.normalRange?dbToGain(e):e))}get size(){return this._analyser.size}set size(e){this._analyser.size=e}get smoothing(){return this._analyser.smoothing}set smoothing(e){this._analyser.smoothing=e}getFrequencyOfIndex(e){return assert(0<=e&&e<this.size,`index must be greater than or equal to 0 and less than ${this.size}`),e*this.context.sampleRate/(2*this.size)}},DCMeter=class extends MeterBase{constructor(){super(optionsFromArguments(DCMeter.getDefaults(),arguments)),this.name="DCMeter",this._analyser.type="waveform",this._analyser.size=256}getValue(){return this._analyser.getValue()[0]}},Waveform=class extends MeterBase{constructor(){super(optionsFromArguments(Waveform.getDefaults(),arguments,["size"])),this.name="Waveform";let e=optionsFromArguments(Waveform.getDefaults(),arguments,["size"]);this._analyser.type="waveform",this.size=e.size}static getDefaults(){return Object.assign(MeterBase.getDefaults(),{size:1024})}getValue(){return this._analyser.getValue()}get size(){return this._analyser.size}set size(e){this._analyser.size=e}},Solo=class extends ToneAudioNode{constructor(){super(optionsFromArguments(Solo.getDefaults(),arguments,["solo"])),this.name="Solo";let e=optionsFromArguments(Solo.getDefaults(),arguments,["solo"]);this.input=this.output=new Gain({context:this.context}),Solo._allSolos.has(this.context)||Solo._allSolos.set(this.context,new Set),Solo._allSolos.get(this.context).add(this),this.solo=e.solo}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(e){e?this._addSolo():this._removeSolo(),Solo._allSolos.get(this.context).forEach((e=>e._updateSolo()))}get muted(){return 0===this.input.gain.value}_addSolo(){Solo._soloed.has(this.context)||Solo._soloed.set(this.context,new Set),Solo._soloed.get(this.context).add(this)}_removeSolo(){Solo._soloed.has(this.context)&&Solo._soloed.get(this.context).delete(this)}_isSoloed(){return Solo._soloed.has(this.context)&&Solo._soloed.get(this.context).has(this)}_noSolos(){return!Solo._soloed.has(this.context)||Solo._soloed.has(this.context)&&0===Solo._soloed.get(this.context).size}_updateSolo(){this._isSoloed()||this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),Solo._allSolos.get(this.context).delete(this),this._removeSolo(),this}};Solo._allSolos=new Map,Solo._soloed=new Map;var PanVol=class extends ToneAudioNode{constructor(){super(optionsFromArguments(PanVol.getDefaults(),arguments,["pan","volume"])),this.name="PanVol";let e=optionsFromArguments(PanVol.getDefaults(),arguments,["pan","volume"]);this._panner=this.input=new Panner({context:this.context,pan:e.pan,channelCount:e.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new Volume({context:this.context,volume:e.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=e.mute,readOnly(this,["pan","volume"])}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}},Channel=class extends ToneAudioNode{constructor(){super(optionsFromArguments(Channel.getDefaults(),arguments,["volume","pan"])),this.name="Channel";let e=optionsFromArguments(Channel.getDefaults(),arguments,["volume","pan"]);this._solo=this.input=new Solo({solo:e.solo,context:this.context}),this._panVol=this.output=new PanVol({context:this.context,pan:e.pan,volume:e.volume,mute:e.mute,channelCount:e.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),readOnly(this,["pan","volume"])}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(e){this._solo.solo=e}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(e){this._panVol.mute=e}_getBus(e){return Channel.buses.has(e)||Channel.buses.set(e,new Gain({context:this.context})),Channel.buses.get(e)}send(e,t=0){let r=this._getBus(e),n=new Gain({context:this.context,units:"decibels",gain:t});return this.connect(n),n.connect(r),n}receive(e){return this._getBus(e).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}};Channel.buses=new Map;var Mono=class extends ToneAudioNode{constructor(){super(optionsFromArguments(Mono.getDefaults(),arguments)),this.name="Mono",this.input=new Gain({context:this.context}),this._merge=this.output=new Merge({channels:2,context:this.context}),this.input.connect(this._merge,0,0),this.input.connect(this._merge,0,1)}dispose(){return super.dispose(),this._merge.dispose(),this.input.dispose(),this}},MultibandSplit=class extends ToneAudioNode{constructor(){super(optionsFromArguments(MultibandSplit.getDefaults(),arguments,["lowFrequency","highFrequency"])),this.name="MultibandSplit",this.input=new Gain({context:this.context}),this.output=void 0,this.low=new Filter3({context:this.context,frequency:0,type:"lowpass"}),this._lowMidFilter=new Filter3({context:this.context,frequency:0,type:"highpass"}),this.mid=new Filter3({context:this.context,frequency:0,type:"lowpass"}),this.high=new Filter3({context:this.context,frequency:0,type:"highpass"}),this._internalChannels=[this.low,this.mid,this.high];let e=optionsFromArguments(MultibandSplit.getDefaults(),arguments,["lowFrequency","highFrequency"]);this.lowFrequency=new Signal2({context:this.context,units:"frequency",value:e.lowFrequency}),this.highFrequency=new Signal2({context:this.context,units:"frequency",value:e.highFrequency}),this.Q=new Signal2({context:this.context,units:"positive",value:e.Q}),this.input.fan(this.low,this.high),this.input.chain(this._lowMidFilter,this.mid),this.lowFrequency.fan(this.low.frequency,this._lowMidFilter.frequency),this.highFrequency.fan(this.mid.frequency,this.high.frequency),this.Q.connect(this.low.Q),this.Q.connect(this._lowMidFilter.Q),this.Q.connect(this.mid.Q),this.Q.connect(this.high.Q),readOnly(this,["high","mid","low","highFrequency","lowFrequency"])}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{Q:1,highFrequency:2500,lowFrequency:400})}dispose(){return super.dispose(),writable(this,["high","mid","low","highFrequency","lowFrequency"]),this.low.dispose(),this._lowMidFilter.dispose(),this.mid.dispose(),this.high.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this.Q.dispose(),this}},Listener=class extends ToneAudioNode{constructor(){super(...arguments),this.name="Listener",this.positionX=new Param({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new Param({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new Param({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new Param({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new Param({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new Param({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new Param({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new Param({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new Param({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}};onContextInit((e=>{e.listener=new Listener({context:e})})),onContextClose((e=>{e.listener.dispose()}));var Panner3D=class extends ToneAudioNode{constructor(){super(optionsFromArguments(Panner3D.getDefaults(),arguments,["positionX","positionY","positionZ"])),this.name="Panner3D";let e=optionsFromArguments(Panner3D.getDefaults(),arguments,["positionX","positionY","positionZ"]);this._panner=this.input=this.output=this.context.createPanner(),this.panningModel=e.panningModel,this.maxDistance=e.maxDistance,this.distanceModel=e.distanceModel,this.coneOuterGain=e.coneOuterGain,this.coneOuterAngle=e.coneOuterAngle,this.coneInnerAngle=e.coneInnerAngle,this.refDistance=e.refDistance,this.rolloffFactor=e.rolloffFactor,this.positionX=new Param({context:this.context,param:this._panner.positionX,value:e.positionX}),this.positionY=new Param({context:this.context,param:this._panner.positionY,value:e.positionY}),this.positionZ=new Param({context:this.context,param:this._panner.positionZ,value:e.positionZ}),this.orientationX=new Param({context:this.context,param:this._panner.orientationX,value:e.orientationX}),this.orientationY=new Param({context:this.context,param:this._panner.orientationY,value:e.orientationY}),this.orientationZ=new Param({context:this.context,param:this._panner.orientationZ,value:e.orientationZ})}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:0,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1})}setPosition(e,t,r){return this.positionX.value=e,this.positionY.value=t,this.positionZ.value=r,this}setOrientation(e,t,r){return this.orientationX.value=e,this.orientationY.value=t,this.orientationZ.value=r,this}get panningModel(){return this._panner.panningModel}set panningModel(e){this._panner.panningModel=e}get refDistance(){return this._panner.refDistance}set refDistance(e){this._panner.refDistance=e}get rolloffFactor(){return this._panner.rolloffFactor}set rolloffFactor(e){this._panner.rolloffFactor=e}get distanceModel(){return this._panner.distanceModel}set distanceModel(e){this._panner.distanceModel=e}get coneInnerAngle(){return this._panner.coneInnerAngle}set coneInnerAngle(e){this._panner.coneInnerAngle=e}get coneOuterAngle(){return this._panner.coneOuterAngle}set coneOuterAngle(e){this._panner.coneOuterAngle=e}get coneOuterGain(){return this._panner.coneOuterGain}set coneOuterGain(e){this._panner.coneOuterGain=e}get maxDistance(){return this._panner.maxDistance}set maxDistance(e){this._panner.maxDistance=e}dispose(){return super.dispose(),this._panner.disconnect(),this.orientationX.dispose(),this.orientationY.dispose(),this.orientationZ.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this}},Recorder=class extends ToneAudioNode{constructor(){super(optionsFromArguments(Recorder.getDefaults(),arguments)),this.name="Recorder";let e=optionsFromArguments(Recorder.getDefaults(),arguments);this.input=new Gain({context:this.context}),assert(Recorder.supported,"Media Recorder API is not available"),this._stream=this.context.createMediaStreamDestination(),this.input.connect(this._stream),this._recorder=new MediaRecorder(this._stream.stream,{mimeType:e.mimeType})}static getDefaults(){return ToneAudioNode.getDefaults()}get mimeType(){return this._recorder.mimeType}static get supported(){return null!==theWindow&&Reflect.has(theWindow,"MediaRecorder")}get state(){return"inactive"===this._recorder.state?"stopped":"paused"===this._recorder.state?"paused":"started"}start(){return __awaiter2(this,void 0,void 0,(function*(){assert("started"!==this.state,"Recorder is already started");let e=new Promise((e=>{let t=()=>{this._recorder.removeEventListener("start",t,!1),e()};this._recorder.addEventListener("start",t,!1)}));return this._recorder.start(),yield e}))}stop(){return __awaiter2(this,void 0,void 0,(function*(){assert("stopped"!==this.state,"Recorder is not started");let e=new Promise((e=>{let t=r=>{this._recorder.removeEventListener("dataavailable",t,!1),e(r.data)};this._recorder.addEventListener("dataavailable",t,!1)}));return this._recorder.stop(),yield e}))}pause(){return assert("started"===this.state,"Recorder must be started"),this._recorder.pause(),this}dispose(){return super.dispose(),this.input.dispose(),this._stream.disconnect(),this}},Compressor=class extends ToneAudioNode{constructor(){super(optionsFromArguments(Compressor.getDefaults(),arguments,["threshold","ratio"])),this.name="Compressor",this._compressor=this.context.createDynamicsCompressor(),this.input=this._compressor,this.output=this._compressor;let e=optionsFromArguments(Compressor.getDefaults(),arguments,["threshold","ratio"]);this.threshold=new Param({minValue:this._compressor.threshold.minValue,maxValue:this._compressor.threshold.maxValue,context:this.context,convert:!1,param:this._compressor.threshold,units:"decibels",value:e.threshold}),this.attack=new Param({minValue:this._compressor.attack.minValue,maxValue:this._compressor.attack.maxValue,context:this.context,param:this._compressor.attack,units:"time",value:e.attack}),this.release=new Param({minValue:this._compressor.release.minValue,maxValue:this._compressor.release.maxValue,context:this.context,param:this._compressor.release,units:"time",value:e.release}),this.knee=new Param({minValue:this._compressor.knee.minValue,maxValue:this._compressor.knee.maxValue,context:this.context,convert:!1,param:this._compressor.knee,units:"decibels",value:e.knee}),this.ratio=new Param({minValue:this._compressor.ratio.minValue,maxValue:this._compressor.ratio.maxValue,context:this.context,convert:!1,param:this._compressor.ratio,units:"positive",value:e.ratio}),readOnly(this,["knee","release","attack","ratio","threshold"])}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{attack:.003,knee:30,ratio:12,release:.25,threshold:-24})}get reduction(){return this._compressor.reduction}dispose(){return super.dispose(),this._compressor.disconnect(),this.attack.dispose(),this.release.dispose(),this.threshold.dispose(),this.ratio.dispose(),this.knee.dispose(),this}},Gate=class extends ToneAudioNode{constructor(){super(Object.assign(optionsFromArguments(Gate.getDefaults(),arguments,["threshold","smoothing"]))),this.name="Gate";let e=optionsFromArguments(Gate.getDefaults(),arguments,["threshold","smoothing"]);this._follower=new Follower({context:this.context,smoothing:e.smoothing}),this._gt=new GreaterThan({context:this.context,value:dbToGain(e.threshold)}),this.input=new Gain({context:this.context}),this._gate=this.output=new Gain({context:this.context}),this.input.connect(this._gate),this.input.chain(this._follower,this._gt,this._gate.gain)}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{smoothing:.1,threshold:-40})}get threshold(){return gainToDb(this._gt.value)}set threshold(e){this._gt.value=dbToGain(e)}get smoothing(){return this._follower.smoothing}set smoothing(e){this._follower.smoothing=e}dispose(){return super.dispose(),this.input.dispose(),this._follower.dispose(),this._gt.dispose(),this._gate.dispose(),this}},Limiter=class extends ToneAudioNode{constructor(){super(Object.assign(optionsFromArguments(Limiter.getDefaults(),arguments,["threshold"]))),this.name="Limiter";let e=optionsFromArguments(Limiter.getDefaults(),arguments,["threshold"]);this._compressor=this.input=this.output=new Compressor({context:this.context,ratio:20,attack:.003,release:.01,threshold:e.threshold}),this.threshold=this._compressor.threshold,readOnly(this,"threshold")}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{threshold:-12})}get reduction(){return this._compressor.reduction}dispose(){return super.dispose(),this._compressor.dispose(),this.threshold.dispose(),this}},MidSideCompressor=class extends ToneAudioNode{constructor(){super(Object.assign(optionsFromArguments(MidSideCompressor.getDefaults(),arguments))),this.name="MidSideCompressor";let e=optionsFromArguments(MidSideCompressor.getDefaults(),arguments);this._midSideSplit=this.input=new MidSideSplit({context:this.context}),this._midSideMerge=this.output=new MidSideMerge({context:this.context}),this.mid=new Compressor(Object.assign(e.mid,{context:this.context})),this.side=new Compressor(Object.assign(e.side,{context:this.context})),this._midSideSplit.mid.chain(this.mid,this._midSideMerge.mid),this._midSideSplit.side.chain(this.side,this._midSideMerge.side),readOnly(this,["mid","side"])}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},side:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10}})}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._midSideSplit.dispose(),this._midSideMerge.dispose(),this}},MultibandCompressor=class extends ToneAudioNode{constructor(){super(Object.assign(optionsFromArguments(MultibandCompressor.getDefaults(),arguments))),this.name="MultibandCompressor";let e=optionsFromArguments(MultibandCompressor.getDefaults(),arguments);this._splitter=this.input=new MultibandSplit({context:this.context,lowFrequency:e.lowFrequency,highFrequency:e.highFrequency}),this.lowFrequency=this._splitter.lowFrequency,this.highFrequency=this._splitter.highFrequency,this.output=new Gain({context:this.context}),this.low=new Compressor(Object.assign(e.low,{context:this.context})),this.mid=new Compressor(Object.assign(e.mid,{context:this.context})),this.high=new Compressor(Object.assign(e.high,{context:this.context})),this._splitter.low.chain(this.low,this.output),this._splitter.mid.chain(this.mid,this.output),this._splitter.high.chain(this.high,this.output),readOnly(this,["high","mid","low","highFrequency","lowFrequency"])}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{lowFrequency:250,highFrequency:2e3,low:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10},mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},high:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16}})}dispose(){return super.dispose(),this._splitter.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.output.dispose(),this}},EQ3=class extends ToneAudioNode{constructor(){super(optionsFromArguments(EQ3.getDefaults(),arguments,["low","mid","high"])),this.name="EQ3",this.output=new Gain({context:this.context}),this._internalChannels=[];let e=optionsFromArguments(EQ3.getDefaults(),arguments,["low","mid","high"]);this.input=this._multibandSplit=new MultibandSplit({context:this.context,highFrequency:e.highFrequency,lowFrequency:e.lowFrequency}),this._lowGain=new Gain({context:this.context,gain:e.low,units:"decibels"}),this._midGain=new Gain({context:this.context,gain:e.mid,units:"decibels"}),this._highGain=new Gain({context:this.context,gain:e.high,units:"decibels"}),this.low=this._lowGain.gain,this.mid=this._midGain.gain,this.high=this._highGain.gain,this.Q=this._multibandSplit.Q,this.lowFrequency=this._multibandSplit.lowFrequency,this.highFrequency=this._multibandSplit.highFrequency,this._multibandSplit.low.chain(this._lowGain,this.output),this._multibandSplit.mid.chain(this._midGain,this.output),this._multibandSplit.high.chain(this._highGain,this.output),readOnly(this,["low","mid","high","lowFrequency","highFrequency"]),this._internalChannels=[this._multibandSplit]}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{high:0,highFrequency:2500,low:0,lowFrequency:400,mid:0})}dispose(){return super.dispose(),writable(this,["low","mid","high","lowFrequency","highFrequency"]),this._multibandSplit.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this._lowGain.dispose(),this._midGain.dispose(),this._highGain.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.Q.dispose(),this}},Convolver=class extends ToneAudioNode{constructor(){super(optionsFromArguments(Convolver.getDefaults(),arguments,["url","onload"])),this.name="Convolver",this._convolver=this.context.createConvolver();let e=optionsFromArguments(Convolver.getDefaults(),arguments,["url","onload"]);this._buffer=new ToneAudioBuffer(e.url,(t=>{this.buffer=t,e.onload()})),this.input=new Gain({context:this.context}),this.output=new Gain({context:this.context}),this._buffer.loaded&&(this.buffer=this._buffer),this.normalize=e.normalize,this.input.chain(this._convolver,this.output)}static getDefaults(){return Object.assign(ToneAudioNode.getDefaults(),{normalize:!0,onload:noOp})}load(e){return __awaiter2(this,void 0,void 0,(function*(){this.buffer=yield this._buffer.load(e)}))}get buffer(){return this._buffer.length?this._buffer:null}set buffer(e){e&&this._buffer.set(e),this._convolver.buffer&&(this.input.disconnect(),this._convolver.disconnect(),this._convolver=this.context.createConvolver(),this.input.chain(this._convolver,this.output));let t=this._buffer.get();this._convolver.buffer=t||null}get normalize(){return this._convolver.normalize}set normalize(e){this._convolver.normalize=e}dispose(){return super.dispose(),this._buffer.dispose(),this._convolver.disconnect(),this}};function now(){return getContext().now()}function immediate(){return getContext().immediate()}var Transport2=getContext().transport;function getTransport(){return getContext().transport}var Destination2=getContext().destination,Master=getContext().destination;function getDestination(){return getContext().destination}var Listener2=getContext().listener;function getListener(){return getContext().listener}var Draw2=getContext().draw;function getDraw(){return getContext().draw}var context3=getContext();function loaded(){return ToneAudioBuffer.loaded()}var Buffer4=ToneAudioBuffer,Buffers=ToneAudioBuffers,BufferSource=ToneBufferSource,import_howler=__toModule(require_howler()),_ServerManager=class extends PsychObject{constructor({psychoJS:e,autoLog:t=!1}={}){super(e),this._session={},this._resources=new Map,this._addAttribute("autoLog",t),this._addAttribute("status",_ServerManager.Status.READY)}getConfiguration(e){let t={origin:"ServerManager.getConfiguration",context:"when reading the configuration file: "+e};this._psychoJS.logger.debug("reading the configuration file: "+e);let r=this;return new Promise(((n,i)=>{jQuery.get(e,"json").done(((e,r)=>{n(Object.assign(t,{config:e}))})).fail(((e,n,s)=>{r.setStatus(_ServerManager.Status.ERROR);let o=getRequestError(e,n,s);console.error("error:",o),i(Object.assign(t,{error:o}))}))}))}openSession(){let e={origin:"ServerManager.openSession",context:"when opening a session for experiment: "+this._psychoJS.config.experiment.fullpath};this._psychoJS.logger.debug("opening a session for experiment: "+this._psychoJS.config.experiment.fullpath),this.setStatus(_ServerManager.Status.BUSY);let t={};this._psychoJS._serverMsg.has("__pilotToken")&&(t.pilotToken=this._psychoJS._serverMsg.get("__pilotToken"));let r=this;return new Promise(((n,i)=>{let s=this._psychoJS.config.pavlovia.URL+"/api/v2/experiments/"+encodeURIComponent(r._psychoJS.config.experiment.fullpath)+"/sessions";jQuery.post(s,t,null,"json").done(((t,s)=>{"token"in t||(r.setStatus(_ServerManager.Status.ERROR),i(Object.assign(e,{error:"unexpected answer from server: no token"}))),"experiment"in t||(r.setStatus(_ServerManager.Status.ERROR),i(Object.assign(e,{error:"unexpected answer from server: no experiment"}))),r._psychoJS.config.session={token:t.token,status:"OPEN"},r._psychoJS.config.experiment.status=t.experiment.status2,r._psychoJS.config.experiment.saveFormat=Symbol.for(t.experiment.saveFormat),r._psychoJS.config.experiment.saveIncompleteResults=t.experiment.saveIncompleteResults,r._psychoJS.config.experiment.license=t.experiment.license,r._psychoJS.config.experiment.runMode=t.experiment.runMode,"keys"in t.experiment?r._psychoJS.config.experiment.keys=t.experiment.keys:r._psychoJS.config.experiment.keys=[],r.setStatus(_ServerManager.Status.READY),n(Object.assign(e,{token:t.token,status:t.status}))})).fail(((t,n,s)=>{r.setStatus(_ServerManager.Status.ERROR);let o=getRequestError(t,n,s);console.error("error:",o),i(Object.assign(e,{error:o}))}))}))}async closeSession(e=!1,t=!1){let r={origin:"ServerManager.closeSession",context:"when closing the session for experiment: "+this._psychoJS.config.experiment.fullpath};this._psychoJS.logger.debug("closing the session for experiment: "+this._psychoJS.config.experiment.name),this.setStatus(_ServerManager.Status.BUSY);let n=this._psychoJS.config.pavlovia.URL+"/api/v2/experiments/"+encodeURIComponent(this._psychoJS.config.experiment.fullpath)+"/sessions/"+this._psychoJS.config.session.token;if(!t){let t=this;return new Promise(((i,s)=>{jQuery.ajax({url:n,type:"delete",data:{isCompleted:e},dataType:"json"}).done(((e,n)=>{t.setStatus(_ServerManager.Status.READY),t._psychoJS.config.session.status="CLOSED",i(Object.assign(r,{data:e}))})).fail(((e,n,i)=>{t.setStatus(_ServerManager.Status.ERROR);let o=getRequestError(e,n,i);console.error("error:",o),s(Object.assign(r,{error:o}))}))}))}{let t=new FormData;t.append("isCompleted",e),navigator.sendBeacon(n+"/delete",t),this._psychoJS.config.session.status="CLOSED"}}getResource(e,t=!1){let r={origin:"ServerManager.getResource",context:"when getting the value of resource: "+e},n=this._resources.get(e);if(void 0===n)throw Object.assign(r,{error:"unknown resource"});if(t&&n.status!==_ServerManager.ResourceStatus.DOWNLOADED)throw Object.assign(r,{error:e+" is not available for use (yet), its current status is: "+toString(n.status)});return n.data}getResourceStatus(e){let t={origin:"ServerManager.getResourceStatus",context:"when getting the status of resource: "+e},r=this._resources.get(e);if(void 0===r)throw Object.assign(t,{error:"unknown resource"});return r.status}setStatus(e){let t={origin:"ServerManager.setStatus",context:"when changing the status of the server manager to: "+toString(e)},r="symbol"==typeof e?Symbol.keyFor(e):null;if(!r)throw Object.assign(t,{error:"status must be a symbol"});if(!_ServerManager.Status.hasOwnProperty(r))throw Object.assign(t,{error:"unknown status"});return this._status=e,this.emit(_ServerManager.Event.STATUS,this._status),this._status}resetStatus(){return this.setStatus(_ServerManager.Status.READY)}async prepareResources(e=[]){let t={origin:"ServerManager.prepareResources",context:"when preparing resources for experiment: "+this._psychoJS.config.experiment.name};this._psychoJS.logger.debug("preparing resources for experiment: "+this._psychoJS.config.experiment.name);try{let t=new Set;if(null!==e){if(!Array.isArray(e))throw"resources should be an array of objects";let r=1===e.length&&e[0]===_ServerManager.ALL_RESOURCES;if(this._psychoJS.config.environment===ExperimentHandler.Environment.SERVER&&r){let e=await this._listResources();for(let r of e.resources)if(!this._resources.has(r)){let n=e.resourceDirectory+"/"+r;this._resources.set(r,{status:_ServerManager.ResourceStatus.REGISTERED,path:n,data:void 0}),this._psychoJS.logger.debug(`registered resource: name= ${r}, path= ${n}`),t.add(r)}}else{if(this._psychoJS.config.environment===ExperimentHandler.Environment.LOCAL&&r)throw"resources must be manually specified when the experiment is running locally: ALL_RESOURCES cannot be used";for(let{name:r,path:n,download:i}of e)this._resources.has(r)||((0===n.toLowerCase().indexOf("www.")||0===n.toLowerCase().indexOf("http:")||0===n.toLowerCase().indexOf("https:"))&&-1===n.indexOf("pavlovia.org")&&(n="https://pavlovia.org/api/v2/proxy/"+n),this._resources.set(r,{status:_ServerManager.ResourceStatus.REGISTERED,path:n,data:void 0}),this._psychoJS.logger.debug(`registered resource: name= ${r}, path= ${n}`),(void 0===i||i)&&t.add(r))}}return new Promise(((e,r)=>{let n=this.on(_ServerManager.Event.RESOURCE,(t=>{t.message===_ServerManager.Event.DOWNLOAD_COMPLETED&&(this.off(_ServerManager.Event.RESOURCE,n),e())}));this._downloadResources(t)}))}catch(e){throw console.error("error",e),Object.assign(t,{error:e})}}waitForResources(e=[]){this._waitForDownloadComponent={status:PsychoJS.Status.NOT_STARTED,clock:new Clock,resources:new Set};let t=this;return async()=>{let r=t._waitForDownloadComponent.clock.getTime();if(r>=0&&t._waitForDownloadComponent.status===PsychoJS.Status.NOT_STARTED){if(t._waitForDownloadComponent.tStart=r,t._waitForDownloadComponent.status=PsychoJS.Status.STARTED,0===e.length)for(let[t,{status:r,path:n,data:i}]of this._resources)e.push({name:t,path:n});let n=new Set;for(let{name:r,path:i}of e){(0===i.toLowerCase().indexOf("www.")||0===i.toLowerCase().indexOf("http:")||0===i.toLowerCase().indexOf("https:"))&&-1===i.indexOf("pavlovia.org")&&(i="https://devlovia.org/api/v2/proxy/"+i);let e=this._resources.get(r);void 0===e?(t._resources.set(r,{status:_ServerManager.ResourceStatus.REGISTERED,path:i,data:void 0}),t._waitForDownloadComponent.resources.add(r),n.add(r),t._psychoJS.logger.debug("registered resource:",r,i)):typeof e.status!==_ServerManager.ResourceStatus.DOWNLOADED&&t._waitForDownloadComponent.resources.add(r)}t._waitForDownloadComponent.status=PsychoJS.Status.STARTED,t._downloadResources(n)}if(t._waitForDownloadComponent.status===PsychoJS.Status.STARTED){for(let e of t._waitForDownloadComponent.resources)if(this._resources.get(e).status!==_ServerManager.ResourceStatus.DOWNLOADED)return Scheduler.Event.FLIP_REPEAT;return t._waitForDownloadComponent.status=PsychoJS.Status.FINISHED,Scheduler.Event.NEXT}}}uploadData(e,t,r=!1){let n={origin:"ServerManager.uploadData",context:"when uploading participant's results for experiment: "+this._psychoJS.config.experiment.fullpath};this._psychoJS.logger.debug("uploading data for experiment: "+this._psychoJS.config.experiment.fullpath),this.setStatus(_ServerManager.Status.BUSY);let i=this._psychoJS.config.pavlovia.URL+"/api/v2/experiments/"+encodeURIComponent(this._psychoJS.config.experiment.fullpath)+"/sessions/"+this._psychoJS.config.session.token+"/results";if(!r){let r=this;return new Promise(((s,o)=>{let a={key:e,value:t};jQuery.post(i,a,null,"json").done(((e,t)=>{r.setStatus(_ServerManager.Status.READY),s(Object.assign(n,{serverData:e}))})).fail(((e,t,i)=>{r.setStatus(_ServerManager.Status.ERROR);let s=getRequestError(e,t,i);console.error("error:",s),o(Object.assign(n,{error:s}))}))}))}{let r=new FormData;r.append("key",e),r.append("value",t),navigator.sendBeacon(i,r)}}uploadLog(e,t=!1){let r={origin:"ServerManager.uploadLog",context:"when uploading participant's log for experiment: "+this._psychoJS.config.experiment.fullpath};this._psychoJS.logger.debug("uploading server log for experiment: "+this._psychoJS.config.experiment.fullpath),this.setStatus(_ServerManager.Status.BUSY);let n=this.psychoJS.experiment.extraInfo,i={filename:("string"==typeof n.participant&&n.participant.length>0?n.participant:"PARTICIPANT")+"_"+(void 0!==n.expName?n.expName:this.psychoJS.config.experiment.name)+"_"+(void 0!==n.date?n.date:MonotonicClock.getDateStr())+".log",logs:e,compressed:t},s=this;return new Promise(((e,t)=>{let n=s._psychoJS.config.pavlovia.URL+"/api/v2/experiments/"+encodeURIComponent(s._psychoJS.config.experiment.fullpath)+"/sessions/"+s._psychoJS.config.session.token+"/logs";jQuery.post(n,i,null,"json").done(((t,n)=>{s.setStatus(_ServerManager.Status.READY),e(Object.assign(r,{serverData:t}))})).fail(((e,n,i)=>{s.setStatus(_ServerManager.Status.ERROR);let o=getRequestError(e,n,i);console.error("error:",o),t(Object.assign(r,{error:o}))}))}))}async uploadAudioVideo({mediaBlob:e,tag:t,waitForCompletion:r=!1,showDialog:n=!1,dialogMsg:i="Please wait a few moments while the data is uploading to the server"}){let s={origin:"ServerManager.uploadAudio",context:"when uploading media data for experiment: "+this._psychoJS.config.experiment.fullpath};try{if(this._psychoJS.getEnvironment()!==ExperimentHandler.Environment.SERVER||"RUNNING"!==this._psychoJS.config.experiment.status||this._psychoJS._serverMsg.has("__pilotToken"))throw"media recordings can only be uploaded to the server for experiments running on the server";this._psychoJS.logger.debug(`uploading media data for experiment: ${this._psychoJS.config.experiment.fullpath}`),this.setStatus(_ServerManager.Status.BUSY),n&&this.psychoJS.gui.dialog({warning:i,showOK:!1});let s=this.psychoJS.experiment.extraInfo,o=("string"==typeof s.participant&&s.participant.length>0?s.participant:"PARTICIPANT")+"_"+(void 0!==s.expName?s.expName:this.psychoJS.config.experiment.name)+"_"+(void 0!==s.date?s.date:MonotonicClock.getDateStr())+"_"+t,a=new FormData;a.append("media",e,o);let l=this._psychoJS.config.pavlovia.URL+"/api/v2/experiments/"+this._psychoJS.config.gitlab.projectId+"/sessions/"+this._psychoJS.config.session.token+"/media",h=await fetch(l,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",redirect:"follow",referrerPolicy:"no-referrer",body:a}),u=await h.json();if(this._psychoJS.logger.debug(`post media response: ${JSON.stringify(u)}`),!h.ok)throw u;if(r){if(!("uploadToken"in u))throw"incorrect server response: missing uploadToken";let e=u.uploadToken;for(;;){await new Promise((e=>{setTimeout(e,1e3)})),l=this._psychoJS.config.pavlovia.URL+"/api/v2/experiments/"+this._psychoJS.config.gitlab.projectId+"/sessions/"+this._psychoJS.config.session.token+"/media/"+e+"/status",h=await fetch(l,{method:"GET",mode:"cors",cache:"no-cache",credentials:"same-origin",redirect:"follow",referrerPolicy:"no-referrer"});let t=await h.json();if(this._psychoJS.logger.debug(`check upload status response: ${JSON.stringify(t)}`),"status"in t&&"COMPLETED"===t.status)break}}return n&&this.psychoJS.gui.closeDialog(),this.setStatus(_ServerManager.Status.READY),u}catch(e){throw this.setStatus(_ServerManager.Status.ERROR),console.error(e),__spreadProps(__spreadValues({},s),{error:e})}}_listResources(){let e={origin:"ServerManager._listResourcesSession",context:"when listing the resources for experiment: "+this._psychoJS.config.experiment.fullpath};this._psychoJS.logger.debug("listing the resources for experiment: "+this._psychoJS.config.experiment.fullpath),this.setStatus(_ServerManager.Status.BUSY);let t={token:this._psychoJS.config.session.token},r=this;return new Promise(((n,i)=>{let s=this._psychoJS.config.pavlovia.URL+"/api/v2/experiments/"+encodeURIComponent(this._psychoJS.config.experiment.fullpath)+"/resources";jQuery.get(s,t,null,"json").done(((t,s)=>{"resources"in t||(r.setStatus(_ServerManager.Status.ERROR),i(Object.assign(e,{error:"unexpected answer from server: no resources"}))),"resourceDirectory"in t||(r.setStatus(_ServerManager.Status.ERROR),i(Object.assign(e,{error:"unexpected answer from server: no resourceDirectory"}))),r.setStatus(_ServerManager.Status.READY),n(Object.assign(e,{resources:t.resources,resourceDirectory:t.resourceDirectory}))})).fail(((t,n,s)=>{r.setStatus(_ServerManager.Status.ERROR);let o=getRequestError(t,n,s);console.error("error:",o),i(Object.assign(e,{error:o}))}))}))}async _downloadResources(e){let t={origin:"ServerManager._downloadResources",context:"when downloading resources for experiment: "+this._psychoJS.config.experiment.name};this._psychoJS.logger.debug("downloading resources for experiment: "+this._psychoJS.config.experiment.name),this.setStatus(_ServerManager.Status.BUSY),this.emit(_ServerManager.Event.RESOURCE,{message:_ServerManager.Event.DOWNLOADING_RESOURCES,count:e.size}),this._nbLoadedResources=0;let r=[],n=new Set,i=[];for(let s of e){let e=s.toLowerCase().split("."),o=e.length>1?e.pop():void 0;void 0===o&&this.psychoJS.logger.warn(`"${s}" does not appear to have an extension, which may negatively impact its loading. We highly recommend you add an extension.`);let a=this._resources.get(s);if(void 0===a)throw Object.assign(t,{error:s+" has not been previously registered"});if(a.status!==_ServerManager.ResourceStatus.REGISTERED)throw Object.assign(t,{error:s+" is already downloaded or is currently already downloading"});let l=a.path.toLowerCase().split("."),h=l.length>1?l.pop():void 0;["csv","odp","xls","xlsx","json"].indexOf(o)>-1?r.push({id:s,src:a.path,type:createjs.Types.BINARY,crossOrigin:"Anonymous"}):["mp3","mpeg","opus","ogg","oga","wav","aac","caf","m4a","weba","dolby","flac"].indexOf(o)>-1?(n.add(s),"wav"===o&&this.psychoJS.logger.warn(`wav files are not supported by all browsers. We recommend you convert "${s}" to another format, e.g. mp3`)):["ttf","otf","woff","woff2"].indexOf(h)>-1?i.push(s):r.push({id:s,src:a.path,crossOrigin:"Anonymous"})}r.length>0?(this._setupPreloadQueue(e),this._preloadQueue.loadManifest(r)):this._nbLoadedResources===e.size&&(this.setStatus(_ServerManager.Status.READY),this.emit(_ServerManager.Event.RESOURCE,{message:_ServerManager.Event.DOWNLOAD_COMPLETED}));for(let r of i){let n=this._resources.get(r);n.status=_ServerManager.ResourceStatus.DOWNLOADING,this.emit(_ServerManager.Event.RESOURCE,{message:_ServerManager.Event.DOWNLOADING_RESOURCE,resource:r});let i=n.path.toLowerCase().split(".").pop();try{let t=await new FontFace(r,`url('${n.path}') format('${i}')`).load();document.fonts.add(t),++this._nbLoadedResources,n.status=_ServerManager.ResourceStatus.DOWNLOADED,this.emit(_ServerManager.Event.RESOURCE,{message:_ServerManager.Event.RESOURCE_DOWNLOADED,resource:r}),this._nbLoadedResources===e.size&&(this.setStatus(_ServerManager.Status.READY),this.emit(_ServerManager.Event.RESOURCE,{message:_ServerManager.Event.DOWNLOAD_COMPLETED}))}catch(e){throw console.error(e),this.setStatus(_ServerManager.Status.ERROR),n.status=_ServerManager.ResourceStatus.ERROR,Object.assign(t,{error:`unable to download resource: ${r}: ${e}`})}}let s=this;for(let r of n){let n=this._resources.get(r);n.status=_ServerManager.ResourceStatus.DOWNLOADING,this.emit(_ServerManager.Event.RESOURCE,{message:_ServerManager.Event.DOWNLOADING_RESOURCE,resource:r});let i=new import_howler.Howl({src:n.path,preload:!1,autoplay:!1});i.on("load",(t=>{++s._nbLoadedResources,n.data=i,n.status=_ServerManager.ResourceStatus.DOWNLOADED,s.emit(_ServerManager.Event.RESOURCE,{message:_ServerManager.Event.RESOURCE_DOWNLOADED,resource:r}),s._nbLoadedResources===e.size&&(s.setStatus(_ServerManager.Status.READY),s.emit(_ServerManager.Event.RESOURCE,{message:_ServerManager.Event.DOWNLOAD_COMPLETED}))})),i.on("loaderror",((e,n)=>{throw Object.assign(t,{error:"unable to download resource: "+r+" ("+toString(n)+")"})})),i.load()}}_setupPreloadQueue(e){this._preloadQueue=new createjs.LoadQueue(!0,"",!0);let t=this;this._preloadQueue.addEventListener("filestart",(e=>{t._resources.get(e.item.id).status=_ServerManager.ResourceStatus.DOWNLOADING,t.emit(_ServerManager.Event.RESOURCE,{message:_ServerManager.Event.DOWNLOADING_RESOURCE,resource:e.item.id})})),this._preloadQueue.addEventListener("fileload",(e=>{let r=t._resources.get(e.item.id);r.data=e.result,r.status=_ServerManager.ResourceStatus.DOWNLOADED,++t._nbLoadedResources,t.emit(_ServerManager.Event.RESOURCE,{message:_ServerManager.Event.RESOURCE_DOWNLOADED,resource:e.item.id})})),this._preloadQueue.addEventListener("complete",(r=>{t._preloadQueue.close(),t._nbLoadedResources===e.size&&(t.setStatus(_ServerManager.Status.READY),t.emit(_ServerManager.Event.RESOURCE,{message:_ServerManager.Event.DOWNLOAD_COMPLETED}))})),this._preloadQueue.addEventListener("error",(e=>{if(t.setStatus(_ServerManager.Status.ERROR),void 0!==e.item)throw t._resources.get(e.item.id).status=_ServerManager.ResourceStatus.ERROR,Object.assign(response,{error:"unable to download resource: "+e.item.id+" ("+e.title+")"});if(console.error(e),"FILE_LOAD_ERROR"===e.title&&void 0!==e.data){let t=e.data.id,r=e.data.src;throw Object.assign(response,{error:"unable to download resource: "+t+" ("+r+")"})}throw Object.assign(response,{error:"unspecified download error"})}))}},ServerManager=_ServerManager;__publicField(ServerManager,"ALL_RESOURCES",Symbol.for("ALL_RESOURCES")),ServerManager.Event={RESOURCE:Symbol.for("RESOURCE"),DOWNLOADING_RESOURCES:Symbol.for("DOWNLOADING_RESOURCES"),DOWNLOADING_RESOURCE:Symbol.for("DOWNLOADING_RESOURCE"),RESOURCE_DOWNLOADED:Symbol.for("RESOURCE_DOWNLOADED"),DOWNLOADS_COMPLETED:Symbol.for("DOWNLOAD_COMPLETED"),STATUS:Symbol.for("STATUS")},ServerManager.Status={READY:Symbol.for("READY"),BUSY:Symbol.for("BUSY"),ERROR:Symbol.for("ERROR")},ServerManager.ResourceStatus={REGISTERED:Symbol.for("REGISTERED"),DOWNLOADING:Symbol.for("DOWNLOADING"),DOWNLOADED:Symbol.for("DOWNLOADED"),ERROR:Symbol.for("ERROR")};var GUI=class{get dialogComponent(){return this._dialogComponent}constructor(e){this._psychoJS=e,e.serverManager.on(ServerManager.Event.RESOURCE,(e=>{this._onResourceEvents(e)})),this._dialogScalingFactor=0}DlgFromDict({logoUrl:e,text:t,dictionary:r,title:n,participantText:i="Participant",sessionText:s="Session",cancelText:o="Cancel",okText:a="OK"}){let l=getUrlParameters();this._progressMsg="&nbsp;",this._progressBarMax=0,this._allResourcesDownloaded=!1,this._requiredKeys=[],this._setRequiredKeys=new Map,this._dialogComponent={},this._dialogComponent.status=PsychoJS.Status.NOT_STARTED;let h=new Clock,u=this;return()=>{let c=h.getTime();if(c>=0&&u._dialogComponent.status===PsychoJS.Status.NOT_STARTED){u._dialogComponent.tStart=c,u._dialogComponent.status=PsychoJS.Status.STARTED,u._psychoJS.getEnvironment()===ExperimentHandler.Environment.SERVER&&void 0!==u._psychoJS.config.experiment.license&&"LICENSE"===u._psychoJS.config.experiment.runMode&&void 0!==u._psychoJS.config.experiment.license.institutionLogo&&(e=u._psychoJS.config.experiment.license.institutionLogo);let h=`<div id="expDialog" title="${n}">`;"string"==typeof e&&(h+='<img id="dialog-logo" class="logo" alt="logo" src="'+e+'">'),"string"==typeof t&&t.length>0&&(h+="<p>"+t+"</p>"),Object.keys(r).forEach(((e,t)=>{let n=r[e],o="form-input-"+t,a=!1,c=e.trim().toLowerCase();if(l.forEach(((e,t)=>{t.trim().toLowerCase()===c&&(a=!0)})),!a)if(h+='<label for="'+o+'">'+getItemName(e,i,s)+"</label>","*"===e.slice(-1)&&u._requiredKeys.push(o),Array.isArray(n)){h+='<select name="'+e+'" id="'+o+'" class="text ui-widget-content ui-corner-all">',"*"===e.slice(-1)&&(h+="<option disabled selected>...</option>");for(let e of n)h+="<option>"+e+"</option>";h+="</select>",jQuery("#"+o).selectmenu({classes:{}})}else h+='<input type="text" name="'+e+'" id="'+o,h+='" value="'+n+'" class="text ui-widget-content ui-corner-all">'})),h+='<hr><div id="progressMsg" class="progress">'+u._progressMsg+"</div>",h+='<div id="progressbar"></div></div>',document.getElementById("root").innerHTML=h,this._requiredKeys.forEach((e=>{let t=document.getElementById(e);t&&(t.oninput=e=>GUI._onKeyChange(u,e))})),u._dialogComponent.button="Cancel",jQuery("#expDialog").dialog({width:"500",autoOpen:!0,modal:!1,closeOnEscape:!1,resizable:!1,draggable:!1,buttons:[{id:"buttonCancel",text:o,click:function(){u._dialogComponent.button="Cancel",jQuery("#expDialog").dialog("close")}},{id:"buttonOk",text:a,click:function(){Object.keys(r).forEach(((e,t)=>{let n=document.getElementById("form-input-"+t);n&&(r[e]=n.value)})),u._dialogComponent.button="OK",jQuery("#expDialog").dialog("close"),start(),u._psychoJS.window.adjustScreenSize(),u._psychoJS.eventManager.clearEvents()}}],close:function(){jQuery(this).dialog("destroy").remove(),u._dialogComponent.status=PsychoJS.Status.FINISHED}}).prev(".ui-dialog-titlebar").css("background","green"),u._updateOkButtonStatus(),jQuery("#progressbar").progressbar({value:u._progressBarCurrentValue}),jQuery("#progressbar").progressbar("option","max",u._progressBarMax)}return u._dialogComponent.status===PsychoJS.Status.FINISHED?Scheduler.Event.NEXT:Scheduler.Event.FLIP_REPEAT}}dialog({message:e,warning:t,error:r,showOK:n=!0,onOK:i}={}){let s,o;if(this.closeDialog(),void 0!==r){this._psychoJS.logger.fatal(toString(r)),r||(r="Unspecified JavaScript error");let e=null,t="<ul>";for(;;){if("object"==typeof r&&"errorCode"in r&&(e=r.errorCode),"object"!=typeof r||!("context"in r)){r.length>=1e3&&(r=r.substring(1,1e3)),t+="<li><b>"+r+"</b></li>";break}t+="<li>"+r.context+"</li>",r=r.error}if(t+="</ul>",e){let t=this._userFriendlyError(e);s=t.htmlCode,o=t.titleColour}else s='<div id="msgDialog" title="Error">',s+='<p class="validateTips">Unfortunately we encountered the following error:</p>',s+=t,s+="<p>Try to run the experiment again. If the error persists, contact the experiment designer.</p>",s+="</div>",o="red"}else void 0!==e?(s='<div id="msgDialog" title="EasyEyes Threshold"><p class="validateTips">'+e+"</p></div>",o="green"):void 0!==t&&(s='<div id="msgDialog" title="Warning"><p class="validateTips">'+t+"</p></div>",o="orange");document.getElementById("root").innerHTML=s,jQuery("#msgDialog").dialog({dialogClass:"no-close",width:"500",autoOpen:!0,modal:!1,closeOnEscape:!1,resizable:!1,draggable:!1,buttons:n?[{id:"buttonOk",text:"Ok",click:function(){jQuery(this).dialog("destroy").remove(),void 0!==i&&i()}}]:[]}).prev(".ui-dialog-titlebar").css("background",o)}closeDialog(){let e=jQuery("#expDialog");e.length&&e.dialog("destroy").remove();let t=jQuery("#msgDialog");t.length&&t.dialog("destroy").remove()}_onResourceEvents(e){this._psychoJS.logger.debug("signal: "+toString(e)),e.message===ServerManager.Event.DOWNLOADING_RESOURCES?(this._progressBarMax=2*e.count,jQuery("#progressbar").progressbar("option","max",this._progressBarMax),this._progressBarCurrentValue=0):e.message===ServerManager.Event.DOWNLOAD_COMPLETED?(this._allResourcesDownloaded=!0,jQuery("#progressMsg").text("All resources downloaded."),this._updateOkButtonStatus()):e.message===ServerManager.Event.DOWNLOADING_RESOURCE||e.message===ServerManager.Event.RESOURCE_DOWNLOADED?(void 0===this._progressBarCurrentValue&&(this._progressBarCurrentValue=0),++this._progressBarCurrentValue,e.message===ServerManager.Event.RESOURCE_DOWNLOADED?jQuery("#progressMsg").text("Downloaded "+this._progressBarCurrentValue/2+" / "+this._progressBarMax/2):jQuery("#progressMsg").text("Downloading "+this._progressBarCurrentValue/2+" / "+this._progressBarMax/2),jQuery("#progressbar").progressbar("option","value",this._progressBarCurrentValue)):jQuery("#progressMsg").text(e.message)}_updateOkButtonStatus(e=!0){this._psychoJS.getEnvironment()===ExperimentHandler.Environment.LOCAL||this._allResourcesDownloaded&&this._setRequiredKeys&&this._setRequiredKeys.size>=this._requiredKeys.length?e?jQuery("#buttonOk").button("option","disabled",!1).focus():jQuery("#buttonOk").button("option","disabled",!1):jQuery("#buttonOk").button("option","disabled",!0),jQuery("#buttonOk").hide(0,(()=>{jQuery("#buttonOk").show()}))}static _onKeyChange(e,t){let r=t.target.value;void 0!==r&&r.length>0?e._setRequiredKeys.set(t.target,!0):e._setRequiredKeys.delete(t.target),e._updateOkButtonStatus(!1)}_userFriendlyError(e){switch(e){case 1:return{htmlCode:'<div id="msgDialog" title="Error"><p>Oops we encountered an internal server error.</p><p>Try to run the experiment again. If the error persists, contact the experiment designer.</p></div>',titleColour:"red"};case 2:return{htmlCode:'<div id="msgDialog" title="Error"><p>Oops we encountered a database error.</p><p>Try to run the experiment again. If the error persists, contact the experiment designer.</p></div>',titleColour:"red"};case 20:return{htmlCode:`<div id="msgDialog" title="Warning"><p><strong>${this._psychoJS.config.experiment.fullpath}</strong> does not have any status and cannot be run.</p><p>If you are the experiment designer, go to your <a href="https://pavlovia.org/${this._psychoJS.config.experiment.fullpath}">experiment page</a> and change the experiment status to either PILOTING or RUNNING.</p><p>Otherwise please contact the experiment designer to let him or her know that the status must be changed to RUNNING for participants to be able to run it.</p></div>`,titleColour:"orange"};case 21:return{htmlCode:`<div id="msgDialog" title="Warning"><p><strong>${this._psychoJS.config.experiment.fullpath}</strong> is currently inactive and cannot be run.</p><p>If you are the experiment designer, go to your <a href="https://pavlovia.org/${this._psychoJS.config.experiment.fullpath}">experiment page</a> and change the experiment status to either PILOTING or RUNNING.</p><p>Otherwise please contact the experiment designer to let him or her know that the status must be changed to RUNNING for participants to be able to run it.</p></div>`,titleColour:"orange"};case 22:return{htmlCode:`<div id="msgDialog" title="Warning"><p><strong>${this._psychoJS.config.experiment.fullpath}</strong> has been deleted and cannot be run.</p><p>If you are the experiment designer, either go to your <a href="https://pavlovia.org/${this._psychoJS.config.experiment.fullpath}">experiment page</a> and change the experiment status to either PILOTING or RUNNING, or generate a new experiment.</p><p>Otherwise please contact the experiment designer to let him or her know that the experiment has been deleted and cannot be run any longer.</p></div>`,titleColour:"orange"};case 23:return{htmlCode:`<div id="msgDialog" title="Warning"><p><strong>${this._psychoJS.config.experiment.fullpath}</strong> has been archived and cannot be run.</p><p>If you are the experiment designer, go to your <a href="https://pavlovia.org/${this._psychoJS.config.experiment.fullpath}">experiment page</a> and change the experiment status to either PILOTING or RUNNING.</p><p>Otherwise please contact the experiment designer to let him or her know that the experiment has been archived and cannot be run at the moment.</p></div>`,titleColour:"orange"};case 30:return{htmlCode:`<div id="msgDialog" title="Warning"><p><strong>${this._psychoJS.config.experiment.fullpath}</strong> is currently in PILOTING mode but the pilot token is missing from the URL.</p><p>If you are the experiment designer, you can pilot it by pressing the pilot button on your <a href="https://pavlovia.org/${this._psychoJS.config.experiment.fullpath}">experiment page</a>.</p><p>Otherwise please contact the experiment designer to let him or her know that the experiment status must be changed to RUNNING for participants to be able to run it.</p></div>`,titleColour:"orange"};case 31:return{htmlCode:`<div id="msgDialog" title="Warning"><p><strong>${this._psychoJS.config.experiment.fullpath}</strong> cannot be run because the pilot token in the URL is invalid, possibly because it has expired.</p><p>If you are the experiment designer, you can generate a new token by pressing the pilot button on your <a href="https://pavlovia.org/${this._psychoJS.config.experiment.fullpath}">experiment page</a>.</p><p>Otherwise please contact the experiment designer to let him or her know that the experiment status must be changed to RUNNING for participants to be able to run it.</p></div>`,titleColour:"orange"};case 50:return{htmlCode:`<div id="msgDialog" title="Warning"><p><strong>${this._psychoJS.config.experiment.fullpath}</strong> is covered by a license that has expired. </p><p>If you are the experiment designer, you can either contact the license manager to inquire about the expiration, or you can run your experiments using credits. You will find all relevant details about the license on your <a href="https://pavlovia.org/${this._psychoJS.config.experiment.fullpath}">experiment page</a>, where you will also be able to change its running mode to CREDIT.</p><p>Otherwise please contact the experiment designer to let him or her know that there is an issue with the experiment's license having expired.</p></div>`,titleColour:"orange"};case 51:return{htmlCode:`<div id="msgDialog" title="Warning"><p><strong>${this._psychoJS.config.experiment.fullpath}</strong> is covered by a license that requires one or more documents to be approved before the experiment can be run. </p><p>If you are the experiment designer, please contact the license manager and ask him or her which documents must be approved. You will find all relevant details about the license on your <a href="https://pavlovia.org/${this._psychoJS.config.experiment.fullpath}">experiment page</a>.</p><p>Otherwise please contact the experiment designer to let him or her know that there is an issue with the experiment's license requiring documents to be approved.</p></div>`,titleColour:"orange"};case 60:return{htmlCode:`<div id="msgDialog" title="Warning"><p><strong>${this._psychoJS.config.experiment.fullpath}</strong> does not have any assigned credit left and cannot be run.</p><p>If you are the experiment designer, you can assign more credits to it on your <a href="https://pavlovia.org/${this._psychoJS.config.experiment.fullpath}">experiment page</a>.</p><p>Otherwise please contact the experiment designer to let him or her know that the experiment requires more assigned credits to run.</p></div>`,titleColour:"orange"};default:return{htmlCode:`<div id="msgDialog" title="Error"><p>Unfortunately we encountered an unspecified error (error code: ${e}.</p><p>Try to run the experiment again. If the error persists, contact the experiment designer.</p></div>`,titleColour:"red"}}}};function upperFirst(e){return e[0].toUpperCase()+e.slice(1)}function getItemName(e,t,r){return"participant"===e?t:"session"===e?r:upperFirst(e)}GUI.dialogMaxSize=[500,600],GUI.dialogMargin=[50,50];var import_log4javascript=__toModule(require_log4javascript()),import_pako=__toModule(require_pako()),Logger=class{constructor(e,t){this._psychoJS=e,this.consoleLogger=import_log4javascript.default.getLogger("psychojs");let r=new import_log4javascript.default.BrowserConsoleAppender;r.setLayout(this._customConsoleLayout()),r.setThreshold(t),this.consoleLogger.addAppender(r),this.consoleLogger.setLevel(t),this._serverLogs=[],this._serverLevel=Logger.ServerLevel.WARNING,this._serverLevelValue=this._getValue(this._serverLevel),this._throttling={window:1,threshold:20,factor:10,minimumDuration:2,startOfThrottling:0,isThrottling:!1,index:0,designerWasWarned:!1}}setLevel(e){this._serverLevel=e,this._serverLevelValue=this._getValue(this._serverLevel)}exp(e,t,r){this.log(e,Logger.ServerLevel.EXP,t,r)}data(e,t,r){this.log(e,Logger.ServerLevel.DATA,t,r)}log(e,t,r,n){this._getValue(t)<this._serverLevelValue||(void 0===r&&(r=MonotonicClock.getReferenceTime()),this._serverLogs.push({msg:e,level:t,time:r,obj:toString(n)}))}_throttle(e){if(this._serverLogs.length>this._throttling.threshold)if(e-this._serverLogs[this._serverLogs.length-1-this._throttling.threshold].time<this._throttling.window){if(!this._throttling.isThrottling){let t=`<p>[time= ${e.toFixed(3)}] More than ${this._throttling.threshold} messages were logged in the past ${this._throttling.window}s.</p><p>We are now throttling: only 1 in ${this._throttling.factor} messages will be logged.</p><p>You may want to change your experiment's logging level. Please see <a href="https://www.psychopy.org/api/logging.html">psychopy.org/api/logging.html</a> for details.</p>`;this._psychoJS.logger.warn(t),!this._throttling.designerWasWarned&&(this._psychoJS.getEnvironment()===ExperimentHandler.Environment.LOCAL||"PILOTING"===this._psychoJS.config.experiment.status)&&(this._throttling.designerWasWarned=!0,this._psychoJS.gui.dialog({warning:t,showOK:!0})),this._throttling.isThrottling=!0,this._throttling.startOfThrottling=e,this._throttling.index=0}if(++this._throttling.index,this._throttling.index<this._throttling.factor)return!0;this._throttling.index=0}else this._throttling.isThrottling&&e-this._throttling.startOfThrottling>this._throttling.minimumDuration&&(this._psychoJS.logger.info(`[time= ${e.toFixed(3)}] Log messages are not throttled any longer.`),this._throttling.isThrottling=!1);return!1}async flush(){let e={origin:"Logger.flush",context:"when flushing participant's logs for experiment: "+this._psychoJS.config.experiment.fullpath};this._psychoJS.logger.info("[PsychoJS] Flush server logs.");let t="";for(let e of this._serverLogs){let r=toString(e.time)+"\t"+Symbol.keyFor(e.level)+"\t"+e.msg;"undefined"!==e.obj&&(r+="\t"+e.obj),r+="\n",t+=r}if(this._psychoJS.getEnvironment()!==ExperimentHandler.Environment.SERVER||"RUNNING"!==this._psychoJS.config.experiment.status||this._psychoJS._serverMsg.has("__pilotToken"))this._psychoJS.logger.debug("\n"+t);else{if(void 0===import_pako.default)return await this._psychoJS.serverManager.uploadLog(t,!1);try{let e=import_pako.default.deflate(t,{to:"string"}),r=btoa(e);return await this._psychoJS.serverManager.uploadLog(r,!0)}catch(t){throw console.error("log compression error:",t),Object.assign(e,{error:t})}}}_customConsoleLayout(){let e=detectBrowser(),t=new import_log4javascript.default.PatternLayout("%p %d{HH:mm:ss.SSS} %f{1} | %m");return t.setCustomField("location",(function(t,r){try{throw Error("fake exception")}catch(t){let r,n=t.stack.replace(/^.*?\n/,"").replace(/(?:\n@:0)?\s+$/m,"").replace(/^\(/gm,"{anon}(").split("\n");if("Firefox"===e){for(let e of n)if(e.indexOf("log4javascript.min.js")<=0){r=e;break}let e=r.split(":"),t=e[e.length-2],i=e[e.length-3].split("/").pop();return r.split("@")[0]+" "+i+":"+t}if("Safari"===e)return"unknown";if("Chrome"===e){r=n.pop();let e=r.split(" "),t=e.pop(),i=e.pop();e=t.split(":"),e.pop();let s=e.pop();return i+" "+e.pop().split("/").pop()+":"+s}return"unknown"}})),t}_getValue(e){let t=Symbol.keyFor(e);return t in Logger._ServerLevelValue?Logger._ServerLevelValue[t]:30}};Logger.ServerLevel={CRITICAL:Symbol.for("CRITICAL"),ERROR:Symbol.for("ERROR"),WARNING:Symbol.for("WARNING"),DATA:Symbol.for("DATA"),EXP:Symbol.for("EXP"),INFO:Symbol.for("INFO"),DEBUG:Symbol.for("DEBUG"),NOTSET:Symbol.for("NOTSET")},Logger._ServerLevelValue={CRITICAL:50,ERROR:40,WARNING:30,DATA:25,EXP:22,INFO:20,DEBUG:10,NOTSET:0};var Window=class extends PsychObject{get monitorFramePeriod(){return 1/this.getActualFrameRate()}constructor({psychoJS:e,name:t,fullscr:r=!1,color:n=new Color("black"),units:i="pix",waitBlanking:s=!1,autoLog:o=!0}={}){super(e,t),this._msgToBeLogged=[],this._drawList=[],this._addAttribute("fullscr",r),this._addAttribute("color",n),this._addAttribute("units",i),this._addAttribute("waitBlanking",s),this._addAttribute("autoLog",o),this._addAttribute("size",[]),this._setupPixi(),this._frameCount=0,this._flipCallbacks=[],this._windowAlreadyInFullScreen=!1;let a=this;document.addEventListener("fullscreenchange",(e=>{a._windowAlreadyInFullScreen=!!document.fullscreenElement,console.log("windowAlreadyInFullScreen:",a._windowAlreadyInFullScreen),a._needUpdate=!0;for(let e of a._drawList)e._needUpdate=!0})),this._autoLog&&this._psychoJS.experimentLogger.exp(`Created ${this.name} = ${this.toString()}`)}close(){!this._renderer||(document.body.contains(this._renderer.view)&&document.body.removeChild(this._renderer.view),void 0!==this._renderer.gl&&this._renderer.gl.getExtension("WEBGL_lose_context").loseContext(),this._renderer.destroy(),window.removeEventListener("resize",this._resizeCallback),window.removeEventListener("orientationchange",this._resizeCallback),this._renderer=null)}getActualFrameRate(){let e=this.psychoJS.scheduler._lastDelta;return 0===e?60:1e3/e}adjustScreenSize(){this.fullscr&&(this._psychoJS.logger.debug("Resizing Window: ",this._name,"to full screen."),"function"==typeof document.documentElement.requestFullscreen?document.documentElement.requestFullscreen().catch((()=>{this.psychoJS.logger.warn("Unable to go fullscreen.")})):"function"==typeof document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():"function"==typeof document.documentElement.webkitRequestFullscreen?document.documentElement.webkitRequestFullscreen():"function"==typeof document.documentElement.msRequestFullscreen?document.documentElement.msRequestFullscreen():this.psychoJS.logger.warn("Unable to go fullscreen."))}closeFullScreen(){this.fullscr&&(this._psychoJS.logger.debug("Resizing Window: ",this._name,"back from full screen."),"function"==typeof document.exitFullscreen?document.exitFullscreen().catch((()=>{this.psychoJS.logger.warn("Unable to close fullscreen.")})):"function"==typeof document.mozCancelFullScreen?document.mozCancelFullScreen():"function"==typeof document.webkitExitFullscreen?document.webkitExitFullscreen():"function"==typeof document.msExitFullscreen?document.msExitFullscreen():this.psychoJS.logger.warn("Unable to close fullscreen."))}logOnFlip({msg:e,level:t=Logger.ServerLevel.EXP,obj:r}={}){this._msgToBeLogged.push({msg:e,level:t,obj:r})}callOnFlip(e,...t){this._flipCallbacks.push({function:e,arguments:t})}render(){if(this._renderer){this._frameCount++,this._renderer.render(this._rootContainer),void 0!==this._renderer.gl&&(this._renderer.gl.readPixels(0,0,1,1,this._renderer.gl.RGBA,this._renderer.gl.UNSIGNED_BYTE,new Uint8Array(4)),this._waitBlanking&&this._renderer.gl.finish());for(let e of this._flipCallbacks)e.function(...e.arguments);this._flipCallbacks=[],this._writeLogOnFlip(),this._refresh()}}_updateIfNeeded(){this._needUpdate&&(this._renderer&&(this._renderer.backgroundColor=this._color.int),document.body.style.backgroundColor=this._color.hex,this._needUpdate=!1)}_refresh(){this._updateIfNeeded();for(let e of this._drawList)e._needUpdate&&void 0!==e._pixi&&(this._rootContainer.removeChild(e._pixi),e._updateIfNeeded(),this._rootContainer.addChild(e._pixi))}_fullRefresh(){this._needUpdate=!0;for(let e of this._drawList)e.refresh();this._refresh()}_setupPixi(){this._size[0]=window.innerWidth,this._size[1]=window.innerHeight,this._renderer=autoDetectRenderer({width:this._size[0],height:this._size[1],backgroundColor:this.color.int,resolution:window.devicePixelRatio}),this._renderer.view.style.transform="translatez(0)",this._renderer.view.style.position="absolute",document.body.appendChild(this._renderer.view),document.body.style.backgroundColor=this._color.hex,this._rootContainer=new Container,this._rootContainer.interactive=!0,Window._resizePixiRenderer(this),this.psychoJS.eventManager.addMouseListeners(this._renderer),this._resizeCallback=e=>{Window._resizePixiRenderer(this,e),this._fullRefresh()},window.addEventListener("resize",this._resizeCallback),window.addEventListener("orientationchange",this._resizeCallback)}static _resizePixiRenderer(e,t){e._psychoJS.logger.debug("resizing Window: ",e._name,"event:",JSON.stringify(t)),e._size[0]=window.innerWidth,e._size[1]=window.innerHeight,e._renderer.view.style.width=e._size[0]+"px",e._renderer.view.style.height=e._size[1]+"px",e._renderer.view.style.left="0px",e._renderer.view.style.top="0px",e._renderer.resize(e._size[0],e._size[1]),e._rootContainer.position.x=e._size[0]/2,e._rootContainer.position.y=e._size[1]/2,e._rootContainer.scale.y=-1}_writeLogOnFlip(){let e=MonotonicClock.getReferenceTime();for(let t of this._msgToBeLogged)this._psychoJS.experimentLogger.log(t.msg,t.level,e,t.obj);this._msgToBeLogged=[]}},PsychoJS=class{get status(){return this._status}set status(e){this._status=e}get config(){return this._config}get window(){return this._window}get serverManager(){return this._serverManager}get experiment(){return this._experiment}get scheduler(){return this._scheduler}get monotonicClock(){return this._monotonicClock}get logger(){return this._logger.consoleLogger}get experimentLogger(){return this._logger}get eventManager(){return this._eventManager}get gui(){return this._gui}get IP(){return this._IP}get serverMsg(){return this._serverMsg}get browser(){return this._browser}constructor({debug:e=!0,collectIP:t=!1,hosts:r=[],topLevelStatus:n=!0}={}){this._logger=new Logger(this,e?import_log4javascript2.default.Level.DEBUG:import_log4javascript2.default.Level.INFO),this._captureErrors(),this._browser=detectBrowser(),this.logger.info("[PsychoJS] Detected browser:",this._browser),this._monotonicClock=new MonotonicClock,this._eventManager=new EventManager(this),this._serverManager=new ServerManager({psychoJS:this});let i=new Set([...r,"https://pavlovia.org/run/","https://run.pavlovia.org/"]);this._hosts=Array.from(i),this._gui=new GUI(this),this._collectIP=t,this._scheduler=new Scheduler(this),this._window=void 0,this._cancellationUrl=void 0,this._completionUrl=void 0,this._status=PsychoJS.Status.NOT_CONFIGURED,n&&this._makeStatusTopLevel(),this.logger.info("[PsychoJS] Initialised."),this.logger.info("[PsychoJS] @version 2021.3.0"),jQuery("#root").addClass("is-ready")}getEnvironment(){if(void 0!==this._config)return this._config.environment}openWindow({name:e,fullscr:t,color:r,units:n,waitBlanking:i,autoLog:s}={}){if(this.logger.info("[PsychoJS] Open Window."),void 0!==this._window)throw{origin:"PsychoJS.openWindow",context:"when opening a Window",error:"A Window has already been opened."};this._window=new Window({psychoJS:this,name:e,fullscr:t,color:r,units:n,waitBlanking:i,autoLog:s})}setRedirectUrls(e,t){this._completionUrl=e,this._cancellationUrl=t}schedule(e,t){this.logger.debug("schedule task: ",e.toString().substring(0,50),"..."),this._scheduler.add(e,t)}scheduleCondition(e,t,r){this.logger.debug("schedule condition: ",e.toString().substring(0,50),"..."),this._scheduler.addConditional(e,t,r)}async start({configURL:e="config.json",expName:t="UNKNOWN",expInfo:r={},resources:n=[]}={}){this.logger.debug();let i={origin:"PsychoJS.start",context:"when starting the experiment"};try{if(await this._configure(e,t),this._collectIP?this._getParticipantIPInfo():this._IP={IP:"X",hostname:"X",city:"X",region:"X",country:"X",location:"X"},this._experiment=new ExperimentHandler({psychoJS:this,extraInfo:r}),this.getEnvironment()===ExperimentHandler.Environment.SERVER){await this._serverManager.openSession(),this.beforeunloadCallback=e=>{e.preventDefault(),e.returnValue=""},window.addEventListener("beforeunload",this.beforeunloadCallback);let e=this;window.addEventListener("unload",(t=>{"OPEN"===e._config.session.status&&(e._config.experiment.saveIncompleteResults&&e._experiment.save({sync:!0}),e._serverManager.closeSession(!1,!0)),void 0!==e._window&&e._window.close()}))}this._serverManager.prepareResources(n),this.logger.info("[PsychoJS] Start Experiment."),await this._scheduler.start()}catch(e){this._gui.dialog({error:Object.assign(i,{error:e})})}}waitForResources(e=[]){let t={origin:"PsychoJS.waitForResources",context:"while waiting for resources to be downloaded"};try{return this.serverManager.waitForResources(e)}catch(e){this._gui.dialog({error:Object.assign(t,{error:e})})}}importAttributes(e){if(this.logger.debug("import attributes from: ",toString(e)),void 0!==e)for(let t in e)window[t]=e[t]}async quit({message:e,isCompleted:t=!1}={}){this.logger.info("[PsychoJS] Quit."),this._experiment.experimentEnded=!0,this._status=PsychoJS.Status.FINISHED;try{this._scheduler.stop(),this.getEnvironment()===ExperimentHandler.Environment.SERVER&&window.removeEventListener("beforeunload",this.beforeunloadCallback),this.gui.dialog({warning:"Closing the session. Please wait a few moments.",showOK:!1}),(t||this._config.experiment.saveIncompleteResults)&&(this._serverMsg.has("__noOutput")||(await this._experiment.save(),await this._logger.flush())),this.getEnvironment()===ExperimentHandler.Environment.SERVER&&await this._serverManager.closeSession(t);let r="Thank you.<br/>";r+=void 0!==e?`${e}<br/><br/>`:"Goodbye!<br/><br/>",r+='Please leave your comment at <a href="https://forms.gle/WCcm4yPTus2KgieS8" target="_blank" rel="noopener noreferrer" >https://forms.gle/WCcm4yPTus2KgieS8</a> to help us improve it.';let n=this;this._gui.dialog({message:r,onOK:()=>{for(n._window.close();document.body.hasChildNodes();)document.body.removeChild(document.body.lastChild);this._window.closeFullScreen(),t&&void 0!==n._completionUrl?window.location=n._completionUrl:!t&&void 0!==n._cancellationUrl&&(window.location=n._cancellationUrl)}})}catch(e){console.error(e),this._gui.dialog({error:e})}}async _configure(e,t){let r={origin:"PsychoJS.configure",context:"when configuring PsychoJS for the experiment"};try{this.status=PsychoJS.Status.CONFIGURING;let r=window.location.href;if(this._hosts.some((e=>0===r.indexOf(e)))){let t=await this._serverManager.getConfiguration(e);if(this._config=t.config,"psychoJsManager"in this._config&&(delete this._config.psychoJsManager,this._config.pavlovia={URL:"https://pavlovia.org"}),!("experiment"in this._config))throw"missing experiment block in configuration";if(!("name"in this._config.experiment))throw"missing name in experiment block in configuration";if(!("fullpath"in this._config.experiment))throw"missing fullpath in experiment block in configuration";if(!("pavlovia"in this._config))throw"missing pavlovia block in configuration";if(!("URL"in this._config.pavlovia))throw"missing URL in pavlovia block in configuration";if(!("gitlab"in this._config))throw"missing gitlab block in configuration";if(!("projectId"in this._config.gitlab))throw"missing projectId in gitlab block in configuration";this._config.environment=ExperimentHandler.Environment.SERVER}else this._config={environment:ExperimentHandler.Environment.LOCAL,experiment:{name:t,saveFormat:ExperimentHandler.SaveFormat.CSV,saveIncompleteResults:!0,keys:[]}};this._serverMsg=new Map,getUrlParameters().forEach(((e,t)=>{0===t.indexOf("__")&&this._serverMsg.set(t,e)})),this.status=PsychoJS.Status.CONFIGURED,this.logger.debug("configuration:",toString(this._config))}catch(e){throw Object.assign(r,{error:e})}}async _getParticipantIPInfo(){let e={origin:"PsychoJS._getParticipantIPInfo",context:"when getting the IP information of the participant"};this.logger.debug("getting the IP information of the participant"),this._IP={};try{let e=await jQuery.get("http://www.geoplugin.net/json.gp"),t=JSON.parse(e);this._IP={IP:t.geoplugin_request,country:t.geoplugin_countryName,latitude:t.geoplugin_latitude,longitude:t.geoplugin_longitude},this.logger.debug("IP information of the participant: "+toString(this._IP))}catch(t){throw Object.assign(e,{error:t})}}_captureErrors(){this.logger.debug("capturing all errors and showing them in a pop up window");let e=this;window.onerror=function(t,r,n,i,s){return console.error(s),document.body.setAttribute("data-error",JSON.stringify({message:t,source:r,lineno:n,colno:i,error:s})),e._gui.dialog({error:s}),!0},window.onunhandledrejection=function(t){var r,n;return console.error(null==t?void 0:t.reason),void 0===(null==(r=null==t?void 0:t.reason)?void 0:r.stack)?document.body.setAttribute("data-error",JSON.stringify(null==t?void 0:t.reason)):document.body.setAttribute("data-error",JSON.stringify(null==(n=null==t?void 0:t.reason)?void 0:n.stack)),e._gui.dialog({error:null==t?void 0:t.reason}),!0}}_makeStatusTopLevel(){for(let e in PsychoJS.Status)window[e]=PsychoJS.Status[e]}};PsychoJS.Status={NOT_CONFIGURED:Symbol.for("NOT_CONFIGURED"),CONFIGURING:Symbol.for("CONFIGURING"),CONFIGURED:Symbol.for("CONFIGURED"),NOT_STARTED:Symbol.for("NOT_STARTED"),STARTED:Symbol.for("STARTED"),PAUSED:Symbol.for("PAUSED"),FINISHED:Symbol.for("FINISHED"),STOPPED:Symbol.for("FINISHED"),ERROR:Symbol.for("ERROR")};var EventManager=class{constructor(e){this._psychoJS=e;for(let e in EventManager._pygletMap)EventManager._reversePygletMap[EventManager._pygletMap[e]]=e;this._keyBuffer=[],this._addKeyListeners(),this._mouseInfo={pos:[0,0],wheelRel:[0,0],buttons:{pressed:[0,0,0],clocks:[new Clock,new Clock,new Clock],times:[0,0,0]},moveClock:new Clock}}getKeys({keyList:e=null,timeStamped:t=!1}={}){null!=e&&(e=EventManager.pyglet2w3c(e));let r=[],n=[];for(let i=0;i<this._keyBuffer.length;++i){let s=this._keyBuffer[i],o=null;if(null!=e){let t=e.indexOf(s.code);t<0&&(t=e.indexOf(EventManager._keycodeMap[s.keyCode])),t>=0&&(o=EventManager._reversePygletMap[e[t]])}else o=EventManager._reversePygletMap[s.code];null!=o?t?n.push([o,s.timestamp]):n.push(o):r.push(s)}return this._keyBuffer=r,n}getMouseInfo(){return this._mouseInfo}clearEvents(e){this.clearKeys()}clearKeys(){this._keyBuffer=[]}startMoveClock(){}stopMoveClock(){}resetMoveClock(){}addMouseListeners(e){let t=this;e.view.addEventListener("pointerdown",(e=>{e.preventDefault(),t._mouseInfo.buttons.pressed[e.button]=1,t._mouseInfo.buttons.times[e.button]=t._psychoJS._monotonicClock.getTime()-t._mouseInfo.buttons.clocks[e.button].getLastResetTime(),t._mouseInfo.pos=[e.offsetX,e.offsetY],this._psychoJS.experimentLogger.data("Mouse: "+e.button+" button down, pos=("+t._mouseInfo.pos[0]+","+t._mouseInfo.pos[1]+")")}),!1),e.view.addEventListener("touchstart",(e=>{e.preventDefault(),t._mouseInfo.buttons.pressed[0]=1,t._mouseInfo.buttons.times[0]=t._psychoJS._monotonicClock.getTime()-t._mouseInfo.buttons.clocks[0].getLastResetTime();let r=e.changedTouches;t._mouseInfo.pos=[r[0].pageX,r[0].pageY],this._psychoJS.experimentLogger.data("Mouse: "+e.button+" button down, pos=("+t._mouseInfo.pos[0]+","+t._mouseInfo.pos[1]+")")}),!1),e.view.addEventListener("pointerup",(e=>{e.preventDefault(),t._mouseInfo.buttons.pressed[e.button]=0,t._mouseInfo.buttons.times[e.button]=t._psychoJS._monotonicClock.getTime()-t._mouseInfo.buttons.clocks[e.button].getLastResetTime(),t._mouseInfo.pos=[e.offsetX,e.offsetY],this._psychoJS.experimentLogger.data("Mouse: "+e.button+" button up, pos=("+t._mouseInfo.pos[0]+","+t._mouseInfo.pos[1]+")")}),!1),e.view.addEventListener("pointerout",(e=>{e.preventDefault(),t._mouseInfo.buttons.pressed=[0,0,0],t._mouseInfo.buttons.times=[0,0,0],t._mouseInfo.pos=[e.offsetX,e.offsetY],this._psychoJS.experimentLogger.data("Mouse: out, pos=("+t._mouseInfo.pos[0]+","+t._mouseInfo.pos[1]+")")}),!1),e.view.addEventListener("touchend",(e=>{e.preventDefault(),t._mouseInfo.buttons.pressed[0]=0,t._mouseInfo.buttons.times[0]=t._psychoJS._monotonicClock.getTime()-t._mouseInfo.buttons.clocks[0].getLastResetTime();let r=e.changedTouches;t._mouseInfo.pos=[r[0].pageX,r[0].pageY],this._psychoJS.experimentLogger.data("Mouse: "+e.button+" button up, pos=("+t._mouseInfo.pos[0]+","+t._mouseInfo.pos[1]+")")}),!1),e.view.addEventListener("pointermove",(e=>{e.preventDefault(),t._mouseInfo.moveClock.reset(),t._mouseInfo.pos=[e.offsetX,e.offsetY]}),!1),e.view.addEventListener("touchmove",(e=>{e.preventDefault(),t._mouseInfo.moveClock.reset();let r=e.changedTouches;t._mouseInfo.pos=[r[0].pageX,r[0].pageY]}),!1),e.view.addEventListener("wheel",(e=>{t._mouseInfo.wheelRel[0]+=e.deltaX,t._mouseInfo.wheelRel[1]+=e.deltaY,this._psychoJS.experimentLogger.data("Mouse: wheel shift=("+e.deltaX+","+e.deltaY+"), pos=("+t._mouseInfo.pos[0]+","+t._mouseInfo.pos[1]+")")}),!1)}_addKeyListeners(){let e=this;window.addEventListener("keydown",(t=>{let r=MonotonicClock.getReferenceTime(),n=t.code;void 0===n&&(n=EventManager.keycode2w3c(t.keyCode)),e._keyBuffer.push({code:n,key:t.key,keyCode:t.keyCode,timestamp:r}),e._psychoJS.logger.trace("keydown: ",t.key),e._psychoJS.experimentLogger.data("Keydown: "+t.key),t.stopPropagation()}))}static pyglet2w3c(e){let t=[];for(let r=0;r<e.length;r++)void 0===EventManager._pygletMap[e[r]]?t.push(e[r]):t.push(EventManager._pygletMap[e[r]]);return t}static w3c2pyglet(e){return e in EventManager._reversePygletMap?EventManager._reversePygletMap[e]:"N/A"}static keycode2w3c(e){return EventManager._keycodeMap[e]}};EventManager._keycodeMap={49:"Digit1",50:"Digit2",51:"Digit3",52:"Digit4",53:"Digit5",54:"Digit6",55:"Digit7",56:"Digit8",57:"Digit9",48:"Digit0",65:"KeyA",66:"KeyB",67:"KeyC",68:"KeyD",69:"KeyE",70:"KeyF",71:"KeyG",72:"KeyH",73:"KeyI",74:"KeyJ",75:"KeyK",76:"KeyL",77:"KeyM",78:"KeyN",79:"KeyO",80:"KeyP",81:"KeyQ",82:"KeyR",83:"KeyS",84:"KeyT",85:"KeyU",86:"KeyV",87:"KeyW",88:"KeyX",89:"KeyY",90:"KeyZ",188:"Comma",190:"Period",186:"Semicolon",222:"Quote",219:"BracketLeft",221:"BracketRight",192:"Backquote",220:"Backslash",189:"Minus",187:"Equal",144:"NumLock",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9",107:"NumpadAdd",194:"NumpadComma",110:"NumpadDecimal",111:"NumpadDivide",12:"NumpadEqual",106:"NumpadMultiply",109:"NumpadSubtract",13:"Enter",16:"ShiftLeft",17:"ControlLeft",18:"AltLeft",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",27:"Escape",32:"Space"},EventManager._pygletMap={grave:"Backquote",backslash:"Backslash",backspace:"Backspace",bracketleft:"BracketLeft",bracketright:"BracketRight",comma:"Comma",0:"Digit0",1:"Digit1",2:"Digit2",3:"Digit3",4:"Digit4",5:"Digit5",6:"Digit6",7:"Digit7",8:"Digit8",9:"Digit9",equal:"Equal",a:"KeyA",b:"KeyB",c:"KeyC",d:"KeyD",e:"KeyE",f:"KeyF",g:"KeyG",h:"KeyH",i:"KeyI",j:"KeyJ",k:"KeyK",l:"KeyL",m:"KeyM",n:"KeyN",o:"KeyO",p:"KeyP",q:"KeyQ",r:"KeyR",s:"KeyS",t:"KeyT",u:"KeyU",v:"KeyV",w:"KeyW",x:"KeyX",y:"KeyY",z:"KeyZ",minus:"Minus",period:"Period",apostrophe:"Quote",semicolon:"Semicolon",slash:"Slash",escape:"Escape",loption:"AltLeft",roption:"AltRight",capslock:"CapsLock",lcontrol:"ControlLeft",rcontrol:"ControlRight",return:"Enter",lcommand:"MetaLeft",rcommand:"MetaRight",lshift:"ShiftLeft",rshift:"ShiftRight",space:"Space",tab:"Tab",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",num_0:"Numpad0",num_1:"Numpad1",num_2:"Numpad2",num_3:"Numpad3",num_4:"Numpad4",num_5:"Numpad5",num_6:"Numpad6",num_7:"Numpad7",num_8:"Numpad8",num_9:"Numpad9",num_decimal:"NumpadDecimal",num_enter:"NumpadEnter",num_add:"NumpadAdd",num_subtract:"NumpadSubtract",num_multiply:"NumpadMultiply",num_divide:"NumpadDivide",num_equal:"NumpadEqual",num_numlock:"NumpadNumlock"},EventManager._reversePygletMap={};var BuilderKeyResponse=class{constructor(e){this._psychoJS=e,this.status=PsychoJS.Status.NOT_STARTED,this.keys=[],this.corr=0,this.rt=[],this.clock=new Clock}},KeyPress=class{constructor(e,t,r){this.code=e,this.tDown=t,this.name=void 0!==r?r:EventManager.w3c2pyglet(e),this.duration=void 0,this.rt=void 0}},Keyboard=class extends PsychObject{constructor({psychoJS:e,bufferSize:t=1e4,waitForStart:r=!1,clock:n,autoLog:i=!1}={}){super(e),void 0===n&&(n=new Clock),this._addAttribute("bufferSize",t),this._addAttribute("waitForStart",r),this._addAttribute("clock",n),this._addAttribute("autoLog",i),this._addAttribute("status",r?PsychoJS.Status.NOT_STARTED:PsychoJS.Status.STARTED),this.clearEvents(),this._addKeyListeners()}start(){this._status=PsychoJS.Status.STARTED}stop(){this._status=PsychoJS.Status.STOPPED}getEvents(){if(0===this._bufferLength)return[];let e=[],t=this._bufferLength===this._bufferSize?this._bufferIndex:-1;do{t=(t+1)%this._bufferSize;let r=this._circularBuffer[t];r&&e.push(r)}while(t!==this._bufferIndex);return e}getKeys({keyList:e=[],waitRelease:t=!0,clear:r=!0}={}){if(0===this._bufferLength)return[];let n=[],i=this._bufferLength===this._bufferSize?this._bufferIndex:-1;do{i=(i+1)%this._bufferSize;let t=this._circularBuffer[i];if(t&&t.status===Keyboard.KeyStatus.KEY_UP&&(0===e.length||e.includes(t.pigletKey))){let e=t.keydownIndex;if(void 0!==e){let i=this._circularBuffer[e];if(i){let s=i.timestamp,o=new KeyPress(t.code,s,t.pigletKey);o.rt=s-this._clock.getLastResetTime(),o.duration=t.timestamp-i.timestamp,n.push(o),r&&(this._circularBuffer[e]=null)}}r&&(this._circularBuffer[i]=null)}}while(i!==this._bufferIndex);if(!t)for(let t of this._unmatchedKeydownMap.values()){let i=this._circularBuffer[t];if(i&&(0===e.length||e.includes(i.pigletKey))){let e=i.timestamp,s=new KeyPress(i.code,e,i.pigletKey);s.rt=e-this._clock.getLastResetTime(),n.push(s),r&&(this._unmatchedKeydownMap.delete(i.code),this._circularBuffer[t]=null)}}return r&&0===e.length&&this.clearEvents(),n}clearEvents(){this._circularBuffer=new Array(this._bufferSize),this._bufferLength=0,this._bufferIndex=-1,this._previousKeydownKey=void 0,this._unmatchedKeydownMap=new Map}static includes(e,t){return!!Array.isArray(e)&&void 0!==e.find((e=>e.name===t))}_addKeyListeners(){this._previousKeydownKey=void 0;let e=this;window.addEventListener("keydown",(t=>{if(t.repeat)return;let r=MonotonicClock.getReferenceTime();if(this._status!==PsychoJS.Status.STARTED)return;e._previousKeydownKey=t.key;let n=t.code;void 0===n&&(n=EventManager.keycode2w3c(t.keyCode));let i=EventManager.w3c2pyglet(n);e._bufferIndex=(e._bufferIndex+1)%e._bufferSize,e._bufferLength=Math.min(e._bufferLength+1,e._bufferSize),e._circularBuffer[e._bufferIndex]={code:n,key:t.key,pigletKey:i,status:Keyboard.KeyStatus.KEY_DOWN,timestamp:r},e._unmatchedKeydownMap.set(t.code,e._bufferIndex),e._psychoJS.logger.trace("keydown: ",t.key),t.stopPropagation()})),window.addEventListener("keyup",(t=>{let r=MonotonicClock.getReferenceTime();if(this._status!==PsychoJS.Status.STARTED)return;e._previousKeydownKey=void 0;let n=t.code;void 0===n&&(n=EventManager.keycode2w3c(t.keyCode));let i=EventManager.w3c2pyglet(n);e._bufferIndex=(e._bufferIndex+1)%e._bufferSize,e._bufferLength=Math.min(e._bufferLength+1,e._bufferSize),e._circularBuffer[e._bufferIndex]={code:n,key:t.key,pigletKey:i,status:Keyboard.KeyStatus.KEY_UP,timestamp:r};let s=e._unmatchedKeydownMap.get(t.code);void 0!==s&&(e._circularBuffer[e._bufferIndex].keydownIndex=s,e._unmatchedKeydownMap.delete(t.code)),e._psychoJS.logger.trace("keyup: ",t.key),t.stopPropagation()}))}};Keyboard.KeyStatus={KEY_DOWN:Symbol.for("KEY_DOWN"),KEY_UP:Symbol.for("KEY_UP")};var MinimalStim=class extends PsychObject{constructor({name:e,win:t,autoDraw:r,autoLog:n}={}){super(t._psychoJS,e),this._pixi=void 0,this._addAttribute("win",t,void 0),this._addAttribute("autoDraw",r,!1),this._addAttribute("autoLog",n,null!=t&&t.autoLog),this._needUpdate=!1,this.status=PsychoJS.Status.NOT_STARTED}setAutoDraw(e,t=!1){this._setAttribute("autoDraw",e,t),this._autoDraw?this.draw():this.hide()}draw(){this.win&&(this._win._drawList.indexOf(this)<0?(this._updateIfNeeded(),void 0===this._pixi?this.psychoJS.logger.warn("the Pixi.js representation of this stimulus is undefined."):(this.win._rootContainer.addChild(this._pixi),this.win._drawList.push(this))):this._needUpdate&&void 0!==this._pixi&&(this.win._rootContainer.removeChild(this._pixi),this._updateIfNeeded(),this.win._rootContainer.addChild(this._pixi))),this.status=PsychoJS.Status.STARTED}hide(){if(this._win){let e=this._win._drawList.indexOf(this);e>=0&&(this._win._drawList.splice(e,1),void 0!==this._pixi&&this._win._rootContainer.removeChild(this._pixi)),this.status=PsychoJS.Status.STOPPED}}contains(e,t){throw{origin:"MinimalStim.contains",context:`when determining whether stimulus: ${this._name} contains object: ${toString(e)}`,error:"this method is abstract and should not be called."}}release(e=!1){this._setAttribute("autoDraw",!1,e),this.status=PsychoJS.Status.STOPPED,void 0!==this._pixi&&(this._pixi.destroy(!0),this._pixi=void 0)}_updateIfNeeded(){throw{origin:"MinimalStim._updateIfNeeded",context:"when updating stimulus: "+this._name,error:"this method is abstract and should not be called."}}},Mouse=class extends PsychObject{constructor({name:e,win:t,autoLog:r=!0}={}){super(t._psychoJS,e),this._lastPos=void 0,this._prevPos=void 0,this._movedistance=0;let n=t.units;this._addAttribute("win",t),this._addAttribute("units",n),this._addAttribute("visible",1),this._addAttribute("autoLog",r),this.status=PsychoJS.Status.NOT_STARTED}getPos(){let e=this.psychoJS.eventManager.getMouseInfo().pos.slice();return e[0]=e[0]-this.win.size[0]/2,e[1]=this.win.size[1]/2-e[1],this._lastPos=to_win(e,"pix",this._win),this._lastPos}getRel(){if(void 0===this._lastPos)return this.getPos();{let e=this._lastPos,t=this.getPos();return[-e[0]+t[0],-e[1]+t[1]]}}getWheelRel(){let e=this.psychoJS.eventManager.getMouseInfo(),t=to_win(e.wheelRel.slice(),"pix",this._win);return e.wheelRel=[0,0],t}getPressed(e=!1){let t=this.psychoJS.eventManager.getMouseInfo().buttons.pressed.slice();return e?[t,this.psychoJS.eventManager.getMouseInfo().buttons.times.slice()]:t}isPressedIn(...e){let[{shape:t,buttons:r}={}]=e.filter((e=>!!e)),n=e=>t=>!(!t||!t[e]),i=n("contains"),s=(i(t)?t:e.find(i))||t,o=n("buttons"),{isInteger:a}=Number,l=a(r)?r:e.find((e=>o(e)||a(e))),{buttons:h=l||r}=l||{};if("function"==typeof s.contains){let e=this.psychoJS.eventManager.getMouseInfo(),{pressed:t}=e.buttons;return(a(h)?t[h]>0:t.some((e=>e>0)))&&s.contains(this)}return!1}mouseMoved(e,t=!1){return void 0===this._lastPos&&this.getPos(),this._prevPos=this._lastPos.slice(),this.getPos(),"boolean"==typeof t&&0==t?void 0===e?this._prevPos[0]!=this._lastPos[0]||this._prevPos[1]!=this._lastPos[1]:"number"==typeof e?(this._movedistance=Math.sqrt((this._prevPos[0]-this._lastPos[0])*(this._prevPos[0]-this._lastPos[0])+(this._prevPos[1]-this._lastPos[1])*(this._prevPos[1]-this._lastPos[1])),this._movedistance>e):this._prevPos[0]+e[0]-this._lastPos[0]>0||this._prevPos[1]+e[1]-this._lastPos[0]>0:"boolean"==typeof t&&1==t?(this.psychoJS.eventManager.getMouseInfo().moveClock.reset(),!1):"here"===t?(this._prevPos=this._lastPos.clone(),!1):t instanceof Array&&(this._prevPos=t.slice(),!!e&&("number"==typeof e?(this._movedistance=Math.sqrt((this._prevPos[0]-this._lastPos[0])*(this._prevPos[0]-this._lastPos[0])+(this._prevPos[1]-this._lastPos[1])*(this._prevPos[1]-this._lastPos[1])),this._movedistance>e):Math.abs(this._lastPos[0]-this._prevPos[0])>e[0]||Math.abs(this._lastPos[1]-this._prevPos[1])>e[1]))}mouseMoveTime(){return this.psychoJS.eventManager.getMouseInfo().moveClock.getTime()}clickReset(e=[0,1,2]){let t=this.psychoJS.eventManager.getMouseInfo();for(let r of e)t.buttons.clocks[r].reset(),t.buttons.times[r]=0}},WindowMixin=e=>class extends e{constructor(e){super(e)}_getLengthPix(e,t=!1){let r;if("pix"===this._units)r=e;else if(void 0===this._units||"norm"===this._units)r=e*this.win.size[1]/2;else{if("height"!==this._units)throw Object.assign({origin:"WindowMixin._getLengthPix",context:"when converting a length from stimulus unit to pixel units"},{error:"unable to deal with unit: "+this._units});r=e*Math.min(this.win.size[0],this.win.size[1])}return t?Math.round(r):r}_getLengthUnits(e){if("pix"===this._units)return e;if(void 0===this._units||"norm"===this._units)return e/(this.win.size[1]/2);if("height"===this._units)return e/Math.min(this.win.size[0],this.win.size[1]);throw Object.assign({origin:"WindowMixin._getLengthUnits",context:"when converting a length from pixel unit to stimulus units"},{error:"unable to deal with unit: "+this._units})}_getHorLengthPix(e){if("pix"===this._units)return e;if(void 0===this._units||"norm"===this._units)return e*this.win.size[0]/2;if("height"===this._units)return e*Math.min(this.win.size[0],this.win.size[1]);throw Object.assign({origin:"WindowMixin._getHorLengthPix",context:"when converting a length from stimulus units to pixel units"},{error:"unable to deal with unit: "+this._units})}_getVerLengthPix(e){if("pix"===this._units)return e;if(void 0===this._units||"norm"===this._units)return e*this.win.size[1]/2;if("height"===this._units)return e*Math.min(this.win.size[0],this.win.size[1]);throw Object.assign({origin:"WindowMixin._getVerLengthPix",context:"when converting a length from pixel unit to stimulus units"},{error:"unable to deal with unit: "+this._units})}},data_exports={};__export(data_exports,{ExperimentHandler:()=>ExperimentHandler,MultiStairHandler:()=>MultiStairHandler,QuestHandler:()=>QuestHandler,TrialHandler:()=>TrialHandler});var import_seedrandom=__toModule(require_seedrandom2()),XLSX2=__toModule(require_xlsx()),TrialHandler=class extends PsychObject{get experimentHandler(){return this._experimentHandler}set experimentHandler(e){this._experimentHandler=e}constructor({psychoJS:e,trialList:t=[void 0],nReps:r,method:n=TrialHandler.Method.RANDOM,extraInfo:i=[],seed:s,name:o,autoLog:a=!0}={}){super(e),this._addAttribute("trialList",t),this._addAttribute("nReps",r),this._addAttribute("method",n),this._addAttribute("extraInfo",i),this._addAttribute("name",o),this._addAttribute("autoLog",a),this._addAttribute("seed",s),this._prepareTrialList(),this.nStim=this.trialList.length,this.nTotal=this.nReps*this.nStim,this.nRemaining=this.nTotal,this.thisRepN=0,this.thisTrialN=-1,this.thisN=-1,this.thisIndex=0,this.ran=0,this.order=-1,this._snapshots=[],this._prepareSequence(),this._experimentHandler=null,this.thisTrial=null,this._finished=!1}next(){let e=this[Symbol.iterator](),{value:t}=e.next();return t}[Symbol.iterator](){return{next:()=>(this.thisTrialN++,this.thisN++,this.nRemaining--,this.nRemaining,this.thisTrialN===this.nStim&&(this.thisTrialN=0,this.thisRepN++),this.thisRepN>=this.nReps?(this.thisTrial=null,{done:!0}):(this.thisIndex=this._trialSequence[this.thisRepN][this.thisTrialN],this.thisTrial=this.trialList[this.thisIndex],this.ran=1,this.order=this.thisN,{value:this.thisTrial,done:!1}))}}forEach(e){let t=this[Symbol.iterator]();for(;;){let r=t.next();if(r.done)break;e(r.value)}}getSnapshot(){let e=this.thisIndex,t={handler:this,name:this.name,nStim:this.nStim,nTotal:this.nTotal,nRemaining:this.nRemaining,thisRepN:this.thisRepN,thisTrialN:this.thisTrialN,thisN:this.thisN,thisIndex:this.thisIndex,ran:this.ran,finished:this._finished,getCurrentTrial:()=>this.getTrial(e),getTrial:(e=0)=>this.getTrial(e),addData:(e,t)=>this.addData(e,t)},r=this.getCurrentTrial(),n=["handler","name","nStim","nRemaining","thisRepN","thisTrialN","thisN","thisIndex","ran","finished"],i=[];for(let e in r)e in n?this._psychoJS.logger.warn(`attempt to replace the value of protected TrialHandler variable: ${e}`):(t[e]=r[e],i.push(e));return t.trialAttributes=i,this._snapshots.push(t),t}setSeed(e,t){this._setAttribute("seed",e,t),this._randomNumberGenerator=void 0!==e?(0,import_seedrandom.default)(e):(0,import_seedrandom.default)()}static fromSnapshot(e){if(void 0===e)return;e.handler.nStim=e.nStim,e.handler.nTotal=e.nTotal,e.handler.nRemaining=e.nRemaining,e.handler.thisRepN=e.thisRepN,e.handler.thisTrialN=e.thisTrialN,e.handler.thisN=e.thisN,e.handler.thisIndex=e.thisIndex,e.handler.ran=e.ran,e.handler._finished=e._finished,e.handler.thisTrial=e.handler.getCurrentTrial();let t=e.name;"s"===t[t.length-1]&&(t=t.substr(0,t.length-1)),t=`this${t[0].toUpperCase()}${t.substr(1)}`;let r={};for(let t of e.trialAttributes)r[t]=e[t];window[t]=r}get finished(){return this._finished}set finished(e){this._finished=e,this._snapshots.forEach((t=>{t.finished=e}))}getTrialIndex(){return this.thisIndex}setTrialIndex(e){this.thisIndex=e}getAttributes(){return Array.isArray(this.trialList)&&0!==this.nStim&&this.trialList[0]?Object.keys(this.trialList[0]):[]}getCurrentTrial(){return this.trialList[this.thisIndex]}getTrial(e=0){if(!(e<0||e>this.nTotal))return this.trialList[e]}getFutureTrial(e=1){if(!(this.thisIndex+e<0||e>this.nRemaining))return this.trialList[this.thisIndex+e]}getEarlierTrial(e=-1){return getFutureTrial(-abs(e))}addData(e,t){this._experimentHandler&&this._experimentHandler.addData(e,t)}static importConditions(e,t,r=null){try{let n=t.split(".").pop();if(["csv","odp","xls","xlsx"].indexOf(n)>-1){let i=e.getResource(t,!0),s=new Uint8Array(i),o="csv"===n?"string":"array",a="string"===o?(new TextDecoder).decode(s):s,l=XLSX2.read(a,{type:o});if(0===l.SheetNames.length)throw"workbook should contain at least one worksheet";let h=l.SheetNames[0],u=l.Sheets[h],c=XLSX2.utils.sheet_to_json(u,{header:1,blankrows:!1}),d=c.shift(),f=null===r?c:selectFromArray(c,r),p=new Array(f.length-1);for(let e=0;e<f.length;++e){let t=f[e],r={};for(let e=0;e<d.length;++e){let n=t[e],i=turnSquareBracketsIntoArrays(n);if(Array.isArray(i)&&(n=i),"string"==typeof n){let e=Number.parseFloat(n);n=isNaN(e)||e.toString().length!==n.length?n.replace(/(\n)/g,"\n"):e}r[d[e]]=n}p[e]=r}return p}throw"extension: "+n+" currently not supported."}catch(e){throw{origin:"TrialHandler.importConditions",context:`when importing condition: ${t}`,error:e}}}_prepareTrialList(){if(void 0===this._trialList)this.trialList=[void 0];else if(Array.isArray(this._trialList))0===this._trialList.length&&(this.trialList=[void 0]);else{if("string"!=typeof this._trialList)throw Object.assign({origin:"TrialHandler._prepareTrialList",context:"when preparing the trial list"},{error:"unable to prepare trial list: unknown type: "+typeof this._trialList});this.trialList=TrialHandler.importConditions(this.psychoJS.serverManager,this._trialList)}}_prepareSequence(){let e=Array.from(this.trialList.keys());if(this._method===TrialHandler.Method.SEQUENTIAL)this._trialSequence=Array(this.nReps).fill(e);else if(this._method===TrialHandler.Method.RANDOM){this._trialSequence=[];for(let t=0;t<this.nReps;++t)this._trialSequence.push(shuffle(e.slice(),this._randomNumberGenerator))}else{if(this._method!==TrialHandler.Method.FULL_RANDOM)throw Object.assign({origin:"TrialHandler._prepareSequence",context:"when preparing a sequence of trials"},{error:"unknown method"});{let t=[];for(let r=0;r<this.nReps;++r)t.push.apply(t,e);shuffle(t,this._randomNumberGenerator),this._trialSequence=[];for(let e=0;e<this.nReps;e++)this._trialSequence.push(t.slice(e*this.nStim,(e+1)*this.nStim))}}return this._trialSequence}};TrialHandler.Method={SEQUENTIAL:Symbol.for("SEQUENTIAL"),RANDOM:Symbol.for("RANDOM"),FULL_RANDOM:Symbol.for("FULL_RANDOM"),FULLRANDOM:Symbol.for("FULL_RANDOM")};var QuestHandler=class extends TrialHandler{constructor({psychoJS:e,varName:t,startVal:r,startValSd:n,minVal:i,maxVal:s,pThreshold:o,nTrials:a,stopInterval:l,method:h,beta:u,delta:c,gamma:d,grain:f,name:p,autoLog:m}={}){super({psychoJS:e,name:p,autoLog:m,method:TrialHandler.Method.SEQUENTIAL,trialList:Array(a),nReps:1}),this._addAttribute("varName",t),this._addAttribute("startVal",r),this._addAttribute("minVal",i,Number.MIN_VALUE),this._addAttribute("maxVal",s,Number.MAX_VALUE),this._addAttribute("startValSd",n),this._addAttribute("pThreshold",o,.82),this._addAttribute("nTrials",a),this._addAttribute("stopInterval",l,Number.MIN_VALUE),this._addAttribute("beta",u,3.5),this._addAttribute("delta",c,.01),this._addAttribute("gamma",d,.5),this._addAttribute("grain",f,.01),this._addAttribute("method",h,QuestHandler.Method.QUANTILE),this._setupJsQuest(),this._estimateQuestValue()}setMethod(e,t){let r={quantile:QuestHandler.Method.QUANTILE,mean:QuestHandler.Method.MEAN,mode:QuestHandler.Method.MODE};r.hasOwnProperty(e)&&(e=r[e]),this._setAttribute("method",e,t)}addResponse(e,t){if(0!==e&&1!==e)throw{origin:"QuestHandler.addResponse",context:"when adding a trial response",error:`the response must be either 0 or 1, got: ${JSON.stringify(e)}`};this._jsQuest=void 0!==t?jsQUEST.QuestUpdate(this._jsQuest,t,e):jsQUEST.QuestUpdate(this._jsQuest,this._questValue,e),this._finished||this._estimateQuestValue()}simulate(e){let t=jsQUEST.QuestSimulate(this._jsQuest,this._questValue,e);return this._questValue=Math.max(this._minVal,Math.min(this._maxVal,this._questValue)),this._psychoJS.logger.debug(`simulated response: ${t}`),t}mean(){return jsQUEST.QuestMean(this._jsQuest)}sd(){return jsQUEST.QuestSd(this._jsQuest)}mode(){let[e,t]=jsQUEST.QuestMode(this._jsQuest);return e}quantile(e){return jsQUEST.QuestQuantile(this._jsQuest,e)}getQuestValue(){return this._questValue}confInterval(e=!1){let t=[jsQUEST.QuestQuantile(this._jsQuest,.05),jsQUEST.QuestQuantile(this._jsQuest,.95)];return e?Math.abs(t[0]-t[1]):t}_setupJsQuest(){this._jsQuest=jsQUEST.QuestCreate(this._startVal,this._startValSd,this._pThreshold,this._beta,this._delta,this._gamma,this._grain)}_estimateQuestValue(){if(this._method===QuestHandler.Method.QUANTILE)this._questValue=jsQUEST.QuestQuantile(this._jsQuest);else if(this._method===QuestHandler.Method.MEAN)this._questValue=jsQUEST.QuestMean(this._jsQuest);else{if(this._method!==QuestHandler.Method.MODE)throw{origin:"QuestHandler._estimateQuestValue",context:"when estimating the next value of the QUEST variable",error:`unknown method: ${this._method}, please use: mean, mode, or quantile`};{let[e,t]=jsQUEST.QuestMode(this._jsQuest);this._questValue=e}}if(this._psychoJS.logger.debug(`estimated value for QUEST variable ${this._varName}: ${this._questValue}`),this.thisN>0&&(0===this.nRemaining||this.confInterval(!0)<this._stopInterval)){this._finished=!0;for(let e=0;e<this._snapshots.length-1;++e)if(void 0===this._trialList[e+1]){this._snapshots[e].finished=!0;break}}else for(let e=0;e<this._trialList.length;++e)if(void 0===this._trialList[e]){this._trialList[e]={[this._varName]:this._questValue},void 0!==this._snapshots[e]&&(this._snapshots[e][this._varName]=this._questValue,this._snapshots[e].trialAttributes.push(this._varName));break}}};QuestHandler.Method={QUANTILE:Symbol.for("QUANTILE"),MEAN:Symbol.for("MEAN"),MODE:Symbol.for("MODE")};var import_seedrandom2=__toModule(require_seedrandom2()),MultiStairHandler=class extends TrialHandler{constructor({psychoJS:e,varName:t,stairType:r,conditions:n,method:i=TrialHandler.Method.RANDOM,nTrials:s=50,randomSeed:o,name:a,autoLog:l}={}){super({psychoJS:e,name:a,autoLog:l,seed:o,method:TrialHandler.Method.SEQUENTIAL,trialList:Array(s),nReps:1}),this._multiMethod=i,this._addAttribute("varName",t),this._addAttribute("stairType",r,MultiStairHandler.StaircaseType.SIMPLE),this._addAttribute("conditions",n,[void 0]),this._addAttribute("nTrials",s),this._randomNumberGenerator=void 0!==o?(0,import_seedrandom2.default)(o):(0,import_seedrandom2.default)(),this._prepareStaircases(),this._nextTrial()}addResponse(e,t){if(0!==e&&1!==e)throw{origin:"MultiStairHandler.addResponse",context:"when adding a trial response",error:`the response must be either 0 or 1, got: ${JSON.stringify(e)}`};this._finished||(this._currentStaircase.addResponse(e,t),this._nextTrial())}_validateConditions(){try{if(!Array.isArray(this._conditions)||0===this._conditions.length)throw"conditions should be a non empty array of objects";if(this._stairType===MultiStairHandler.StaircaseType.SIMPLE)throw"'simple' staircases are currently not supported";for(let e of this._conditions){if("object"!=typeof e)throw"one of the conditions is not an object";if(!("startVal"in e))throw"each condition should include a startVal field";if(!("label"in e))throw"each condition should include a label field";if(this._stairType===MultiStairHandler.StaircaseType.QUEST&&!("startValSd"in e))throw"QUEST conditions must include a startValSd field"}}catch(e){throw{origin:"MultiStairHandler._validateConditions",context:"when validating the conditions",error:e}}}_prepareStaircases(){try{this._validateConditions(),this._staircases=[];for(let e of this._conditions){let t;if(this._stairType===MultiStairHandler.StaircaseType.QUEST){let r=Object.assign({},e);r.psychoJS=this._psychoJS,r.varName=this._varName,r.name=e.label,r.autoLog=this._autoLog,void 0===e.nTrials&&(r.nTrials=this._nTrials),t=new QuestHandler(r)}this._stairType!==MultiStairHandler.StaircaseType.SIMPLE&&this._staircases.push(t)}this._currentPass=[],this._currentStaircase=null}catch(e){throw{origin:"MultiStairHandler._prepareStaircases",context:"when preparing the staircases",error:e}}}_nextTrial(){try{if(0===this._currentPass.length&&(this._currentPass=this._staircases.filter((e=>!e.finished)),this._multiMethod!==TrialHandler.Method.SEQUENTIAL))if(this._multiMethod===TrialHandler.Method.RANDOM)this._currentPass=shuffle(this._currentPass,this._randomNumberGenerator);else if(this._multiMethod===TrialHandler.Method.FULL_RANDOM&&this._currentPass.length>0){let e=Math.floor(this._randomNumberGenerator()*this._currentPass.length),t=this._currentPass[e];this._currentPass=[t]}if(this._currentStaircase=this._currentPass.shift(),void 0===this._currentStaircase){this._finished=!0;for(let e=0;e<this._snapshots.length-1;++e)if(void 0===this._trialList[e+1]){this._snapshots[e].finished=!0;break}return}let e=Number.MIN_VALUE;this._currentStaircase instanceof QuestHandler&&(e=this._currentStaircase.getQuestValue()),this._psychoJS.logger.debug(`selected staircase: ${this._currentStaircase.name}, estimated value for variable ${this._varName}: ${e}`);for(let t=0;t<this._trialList.length;++t)if(void 0===this._trialList[t]){this._trialList[t]={[this._varName]:e},void 0!==this._snapshots[t]&&(this._snapshots[t][this._varName]=e,this._snapshots[t].trialAttributes.push(this._varName));break}}catch(e){throw{origin:"MultiStairHandler._nextTrial",context:"when moving onto the next trial",error:e}}}};MultiStairHandler.StaircaseType={SIMPLE:Symbol.for("SIMPLE"),QUEST:Symbol.for("QUEST")},MultiStairHandler.StaircaseStatus={RUNNING:Symbol.for("RUNNING"),FINISHED:Symbol.for("FINISHED")};var visual_exports={};__export(visual_exports,{ButtonStim:()=>ButtonStim,Camera:()=>Camera,FaceDetector:()=>FaceDetector,Form:()=>Form,ImageStim:()=>ImageStim,MovieStim:()=>MovieStim,Polygon:()=>Polygon2,Rect:()=>Rect,ShapeStim:()=>ShapeStim,Slider:()=>Slider,TextBox:()=>TextBox,TextInput:()=>TextInput,TextStim:()=>TextStim,VisualStim:()=>VisualStim});var TextInput=class extends Container{constructor(e){super(),this._input_style=Object.assign({position:"absolute",background:"none",border:"none",outline:"none",text:"",transformOrigin:"0 0",lineHeight:"1"},e.input),e.box?this._box_generator="function"==typeof e.box?e.box:new DefaultBoxGenerator(e.box):this._box_generator=null,this._input_style.hasOwnProperty("multiline")?(this._multiline=!!this._input_style.multiline,delete this._input_style.multiline):this._multiline=!1,this._box_cache={},this._previous={},this._dom_added=!1,this._dom_visible=!0,this._placeholder="",this._placeholderColor=11119017,this._selection=[0,0],this._restrict_value="",this._createDOMInput(),this.substituteText=!this._multiline,this._setState("DEFAULT")}get substituteText(){return this._substituted}set substituteText(e){this._substituted!=e&&(this._substituted=e,e?(this._createSurrogate(),this._dom_visible=!1):(this._destroySurrogate(),this._dom_visible=!0),this.placeholder=this._placeholder,this._update())}get placeholder(){return this._placeholder}set placeholder(e){this._placeholder=e,this._substituted?(this._updateSurrogate(),this._dom_input.placeholder=""):this._dom_input.placeholder=e}get disabled(){return this._disabled}set disabled(e){this._disabled=e,this._dom_input.disabled=e,this._setState(e?"DISABLED":"DEFAULT")}get maxLength(){return this._max_length}set maxLength(e){this._max_length=e,this._dom_input.setAttribute("maxlength",e)}get restrict(){return this._restrict_regex}set restrict(e){e instanceof RegExp?("^"!==(e=e.toString().slice(1,-1)).charAt(0)&&(e="^"+e),"$"!==e.charAt(e.length-1)&&(e+="$"),e=new RegExp(e)):e=new RegExp("^["+e+"]*$"),this._restrict_regex=e}get text(){return this._dom_input.value}set text(e){this._dom_input.value=e,this._substituted&&this._updateSurrogate()}get htmlInput(){return this._dom_input}focus(e={preventScroll:!0}){this._substituted&&!this.dom_visible&&this._setDOMInputVisible(!0),this._dom_input.focus(e)}blur(){this._dom_input.blur()}select(){this.focus(),this._dom_input.select()}setInputStyle(e,t){this._input_style[e]=t,this._dom_input.style[e]=t,this._substituted&&("fontFamily"===e||"fontSize"===e)&&this._updateFontMetrics(),this._last_renderer&&this._update()}destroy(e){this._destroyBoxCache(),super.destroy(e)}_createDOMInput(){this._multiline?(this._dom_input=document.createElement("textarea"),this._dom_input.style.resize="none"):(this._dom_input=document.createElement("input"),this._dom_input.type="text");for(let e in this._input_style)this._dom_input.style[e]=this._input_style[e]}_addListeners(){this.on("added",this._onAdded.bind(this)),this.on("removed",this._onRemoved.bind(this)),this._dom_input.addEventListener("keydown",this._onInputKeyDown.bind(this)),this._dom_input.addEventListener("input",this._onInputInput.bind(this)),this._dom_input.addEventListener("keyup",this._onInputKeyUp.bind(this)),this._dom_input.addEventListener("focus",this._onFocused.bind(this)),this._dom_input.addEventListener("blur",this._onBlurred.bind(this))}_onInputKeyDown(e){this._selection=[this._dom_input.selectionStart,this._dom_input.selectionEnd],this.emit("keydown",e.keyCode)}_onInputInput(e){this._restrict_regex&&this._applyRestriction(),this._substituted&&this._updateSubstitution(),this.emit("input",this.text)}_onInputKeyUp(e){this.emit("keyup",e.keyCode)}_onFocused(){this._setState("FOCUSED"),this.emit("focus")}_onBlurred(){this._setState("DEFAULT"),this.emit("blur")}_onAdded(){document.body.appendChild(this._dom_input),this._dom_input.style.display="none",this._dom_added=!0}_onRemoved(){document.body.removeChild(this._dom_input),this._dom_added=!1}_setState(e){this.state=e,this._updateBox(),this._substituted&&this._updateSubstitution()}renderWebGL(e){super.renderWebGL(e),this._renderInternal(e)}renderCanvas(e){super.renderCanvas(e),this._renderInternal(e)}render(e){super.render(e),this._renderInternal(e)}_renderInternal(e){this._resolution=e.resolution,this._last_renderer=e,this._canvas_bounds=this._getCanvasBounds(),this._needsUpdate()&&this._update()}_update(){this._updateDOMInput(),this._substituted&&this._updateSurrogate(),this._updateBox()}_updateBox(){!this._box_generator||(this._needsNewBoxCache()&&this._buildBoxCache(),(this.state!=this._previous.state||this._box!=this._box_cache[this.state])&&(this._box&&this.removeChild(this._box),this._box=this._box_cache[this.state],this.addChildAt(this._box,0),this._previous.state=this.state))}_updateSubstitution(){"FOCUSED"===this.state?(this._dom_visible=!0,this._surrogate.visible=0===this.text.length):(this._dom_visible=!1,this._surrogate.visible=!0),this._updateDOMInput(),this._updateSurrogate()}_updateDOMInput(){!this._canvas_bounds||(this._dom_input.style.top=(this._canvas_bounds.top||0)+"px",this._dom_input.style.left=(this._canvas_bounds.left||0)+"px",this._dom_input.style.transform=this._pixiMatrixToCSS(this._getDOMRelativeWorldTransform()),this._dom_input.style.opacity=this.worldAlpha,this._setDOMInputVisible(this.worldVisible&&this._dom_visible),this._previous.canvas_bounds=this._canvas_bounds,this._previous.world_transform=this.worldTransform.clone(),this._previous.world_alpha=this.worldAlpha,this._previous.world_visible=this.worldVisible)}_applyRestriction(){this._restrict_regex.test(this.text)?this._restrict_value=this.text:(this.text=this._restrict_value,this._dom_input.setSelectionRange(this._selection[0],this._selection[1]))}_needsUpdate(){return!this._comparePixiMatrices(this.worldTransform,this._previous.world_transform)||!this._compareClientRects(this._canvas_bounds,this._previous.canvas_bounds)||this.worldAlpha!=this._previous.world_alpha||this.worldVisible!=this._previous.world_visible}_needsNewBoxCache(){let e=this._getDOMInputBounds();return!this._previous.input_bounds||e.width!=this._previous.input_bounds.width||e.height!=this._previous.input_bounds.height}_createSurrogate(){this._surrogate_hitbox=new Graphics,this._surrogate_hitbox.alpha=0,this._surrogate_hitbox.interactive=!0,this._surrogate_hitbox.cursor="text",this._surrogate_hitbox.on("pointerdown",this._onSurrogateFocus.bind(this)),this.addChild(this._surrogate_hitbox),this._surrogate_mask=new Graphics,this.addChild(this._surrogate_mask),this._surrogate=new Text("",{}),this.addChild(this._surrogate),this._surrogate.mask=this._surrogate_mask,this._updateFontMetrics(),this._updateSurrogate()}_updateSurrogate(){let e=this._deriveSurrogatePadding(),t=this._getDOMInputBounds();switch(this._surrogate.style=this._deriveSurrogateStyle(),this._surrogate.style.padding=Math.max.apply(Math,e),this._surrogate.y=this._multiline?e[0]:(t.height-this._surrogate.height)/2,this._surrogate.x=e[3],this._surrogate.text=this._deriveSurrogateText(),this._surrogate.style.align){case"left":this._surrogate.x=e[3];break;case"center":this._surrogate.x=.5*t.width-.5*this._surrogate.width;break;case"right":this._surrogate.x=t.width-e[1]-this._surrogate.width}this._updateSurrogateHitbox(t),this._updateSurrogateMask(t,e)}_updateSurrogateHitbox(e){this._surrogate_hitbox.clear(),this._surrogate_hitbox.beginFill(0),this._surrogate_hitbox.drawRect(0,0,e.width,e.height),this._surrogate_hitbox.endFill(),this._surrogate_hitbox.interactive=!this._disabled}_updateSurrogateMask(e,t){this._surrogate_mask.clear(),this._surrogate_mask.beginFill(0),this._surrogate_mask.drawRect(t[3],0,e.width-t[3]-t[1],e.height),this._surrogate_mask.endFill()}_destroySurrogate(){!this._surrogate||(this.removeChild(this._surrogate),this.removeChild(this._surrogate_hitbox),this._surrogate.destroy(),this._surrogate_hitbox.destroy(),this._surrogate=null,this._surrogate_hitbox=null)}_onSurrogateFocus(){this._setDOMInputVisible(!0),setTimeout(this._ensureFocus.bind(this),10)}_ensureFocus(){this._hasFocus()||this.focus()}_deriveSurrogateStyle(){let e=new TextStyle;for(let t in this._input_style)switch(t){case"color":e.fill=this._input_style.color;break;case"fontFamily":case"fontSize":case"fontWeight":case"fontVariant":case"fontStyle":e[t]=this._input_style[t];break;case"letterSpacing":e.letterSpacing=parseFloat(this._input_style.letterSpacing);break;case"textAlign":e.align=this._input_style.textAlign}return this._multiline&&(e.lineHeight=parseFloat(e.fontSize),e.wordWrap=!0,e.wordWrapWidth=this._getDOMInputBounds().width),0===this._dom_input.value.length&&(e.fill=this._placeholderColor),e}_deriveSurrogatePadding(){let e=this._input_style.textIndent?parseFloat(this._input_style.textIndent):0;if(this._input_style.padding&&this._input_style.padding.length>0){let t=this._input_style.padding.trim().split(" ");if(1==t.length){let r=parseFloat(t[0]);return[r,r,r,r+e]}if(2==t.length){let r=parseFloat(t[0]),n=parseFloat(t[1]);return[r,n,r,n+e]}if(4==t.length){let r=t.map((e=>parseFloat(e)));return r[3]+=e,r}}return[0,0,0,e]}_deriveSurrogateText(){return 0===this._dom_input.value.length?this._placeholder:"password"==this._dom_input.type?"".repeat(this._dom_input.value.length):this._dom_input.value}_updateFontMetrics(){let e=this._deriveSurrogateStyle().toFontString();this._font_metrics=TextMetrics.measureFont(e)}_buildBoxCache(){this._destroyBoxCache();let e=this._getDOMInputBounds();["DEFAULT","FOCUSED","DISABLED"].forEach((t=>{this._box_cache[t]=this._box_generator(e.width,e.height,t)})),this._previous.input_bounds=e}_destroyBoxCache(){this._box&&(this.removeChild(this._box),this._box=null);for(let e in this._box_cache)this._box_cache[e].destroy(),this._box_cache[e]=null,delete this._box_cache[e]}_hasFocus(){return document.activeElement===this._dom_input}_setDOMInputVisible(e){this._dom_input.style.display=e?"block":"none"}_getCanvasBounds(){let e=this._last_renderer.view.getBoundingClientRect(),t={top:e.top,left:e.left,width:e.width,height:e.height};return t.left+=window.scrollX,t.top+=window.scrollY,t}_getDOMInputBounds(){let e=!1;this._dom_added||(document.body.appendChild(this._dom_input),e=!0);let t=this._dom_input.style.transform,r=this._dom_input.style.display;this._dom_input.style.transform="",this._dom_input.style.display="block";let n=this._dom_input.getBoundingClientRect();return this._dom_input.style.transform=t,this._dom_input.style.display=r,e&&document.body.removeChild(this._dom_input),n}_getDOMRelativeWorldTransform(){let e=this._last_renderer.view.getBoundingClientRect(),t=this.worldTransform.clone();return t.scale(this._resolution,this._resolution),t.scale(e.width/this._last_renderer.width,e.height/this._last_renderer.height),t}_pixiMatrixToCSS(e){return"matrix("+[e.a,e.b,e.c,e.d,e.tx,e.ty].join(",")+")"}_comparePixiMatrices(e,t){return!(!e||!t)&&e.a==t.a&&e.b==t.b&&e.c==t.c&&e.d==t.d&&e.tx==t.tx&&e.ty==t.ty}_compareClientRects(e,t){return!(!e||!t)&&e.left==t.left&&e.top==t.top&&e.width==t.width&&e.height==t.height}};function DefaultBoxGenerator(e){if((e=e||{fill:13421772}).default)e.focused=e.focused||e.default,e.disabled=e.disabled||e.default;else{let t=e;(e={}).default=e.focused=e.disabled=t}return function(t,r,n){var i,s,o;let a=e[n.toLowerCase()],l=new Graphics;return a.fill&&l.beginFill(a.fill),a.stroke&&l.lineStyle(null!=(i=a.stroke.width)?i:1,null!=(s=a.stroke.color)?s:0,null!=(o=a.stroke.alpha)?o:1),a.rounded?l.drawRoundedRect(0,0,t,r,a.rounded):l.drawRect(0,0,t,r),l.endFill(),l.closePath(),l}}var VisualStim=class extends(mix(MinimalStim).with(WindowMixin)){constructor({name:e,win:t,units:r,ori:n,opacity:i,depth:s,pos:o,size:a,clipMask:l,autoDraw:h,autoLog:u}={}){super({win:t,name:e,autoDraw:h,autoLog:u}),this._addAttribute("units",r,null!=t?t.units:"height",this._onChange(!0,!0)),this._addAttribute("pos",o,[0,0]),this._addAttribute("size",a,void 0),this._addAttribute("ori",n,0),this._addAttribute("opacity",i,1,this._onChange(!0,!1)),this._addAttribute("depth",s,0,this._onChange(!1,!1)),this._addAttribute("clipMask",l,null,this._onChange(!1,!1)),this._addAttribute("boundingBox",Rectangle.EMPTY),this._needUpdate=!0,this._needPixiUpdate=!0}refresh(){this._onChange(!0,!0)()}setSize(e,t=!1){null!=e&&(e=toNumerical(e),Array.isArray(e)||(e=[e,e])),this._setAttribute("size",e,t)&&this._onChange(!0,!0)()}setOri(e,t=!1){if(this._setAttribute("ori",e,t)){let t=.017453292519943295*-e;this._rotationMatrix=[[Math.cos(t),-Math.sin(t)],[Math.sin(t),Math.cos(t)]],this._onChange(!0,!0)()}}setPos(e,t=!1){let r=this._pos;this._setAttribute("pos",toNumerical(e),t)&&(this._needUpdate=!0,this._boundingBox.x+=this._pos[0]-r[0],this._boundingBox.y+=this._pos[1]-r[1])}contains(e,t){let r=getPositionFromObject(e,t);if(void 0===r)throw{origin:"VisualStim.contains",context:"when determining whether VisualStim: "+this._name+" contains object: "+toString(e),error:"unable to determine the position of the object"};return this._getBoundingBox_px().contains(r[0],r[1])}_estimateBoundingBox(){throw{origin:"VisualStim._estimateBoundingBox",context:`when estimating the bounding box of visual stimulus: ${this._name}`,error:"this method is abstract and should not be called."}}_getBoundingBox_px(){if("pix"===this._units)return this._boundingBox.clone();if("norm"===this._units)return new Rectangle(this._boundingBox.x*this._win.size[0]/2,this._boundingBox.y*this._win.size[1]/2,this._boundingBox.width*this._win.size[0]/2,this._boundingBox.height*this._win.size[1]/2);if("height"===this._units){let e=Math.min(this._win.size[0],this._win.size[1]);return new Rectangle(this._boundingBox.x*e,this._boundingBox.y*e,this._boundingBox.width*e,this._boundingBox.height*e)}throw Object.assign(response,{error:`unknown units: ${this._units}`})}_onChange(e=!1,t=!1){return()=>{this._needUpdate=!0,e&&(this._needPixiUpdate=!0),t&&this._estimateBoundingBox()}}},TextBox=class extends(mix(VisualStim).with(ColorMixin)){constructor({name:e,win:t,pos:r,anchor:n,size:i,units:s,ori:o,opacity:a,depth:l,text:h,font:u,letterHeight:c,bold:d,italic:f,alignment:p,color:m,contrast:_,flipHoriz:g,flipVert:v,fillColor:y,borderColor:b,borderWidth:x,padding:S,editable:T,multiline:E,autofocus:A,clipMask:w,autoDraw:C,autoLog:O}={}){super({name:e,win:t,pos:r,size:i,units:s,ori:o,opacity:a,depth:l,clipMask:w,autoDraw:C,autoLog:O}),this._addAttribute("text",h,"",this._onChange(!0,!0)),this._addAttribute("placeholder",h,"",this._onChange(!0,!0)),this._addAttribute("anchor",n,"center",this._onChange(!1,!0)),this._addAttribute("flipHoriz",g,!1,this._onChange(!1,!1)),this._addAttribute("flipVert",v,!1,this._onChange(!1,!1)),this._addAttribute("font",u,"Arial",this._onChange(!0,!0)),this._addAttribute("letterHeight",c,this._getDefaultLetterHeight(),this._onChange(!0,!0)),this._addAttribute("bold",d,!1,this._onChange(!0,!0)),this._addAttribute("italic",f,!1,this._onChange(!0,!0)),this._addAttribute("alignment",p,"left",this._onChange(!0,!0)),this._addAttribute("color",m,"white",this._onChange(!0,!1)),this._addAttribute("fillColor",y,"lightgrey",this._onChange(!0,!1)),this._addAttribute("borderColor",b,this.fillColor,this._onChange(!0,!1)),this._addAttribute("contrast",_,1,this._onChange(!0,!1)),this._addAttribute("borderWidth",x,to_unit([1,0],"pix",t,this._units)[0],this._onChange(!0,!0)),this._addAttribute("padding",S,this._letterHeight/2,this._onChange(!0,!0)),this._addAttribute("multiline",E,!1,this._onChange(!0,!0)),this._addAttribute("editable",T,!1,this._onChange(!0,!0)),this._addAttribute("autofocus",A,!0,this._onChange(!0,!1)),this._estimateBoundingBox(),this._autoLog&&this._psychoJS.experimentLogger.exp(`Created ${this.name} = ${this.toString()}`)}reset(){this.editable||this.placeholder,this.setText(this.placeholder)}clear(){this.setText()}setText(e=""){void 0!==this._pixi&&(this._pixi.text=e),this._text=e}getText(){return void 0!==this._pixi?this._pixi.text:this._text}setSize(e,t){if((null==e||Array.isArray(e)&&e.every((e=>null==e)))&&void 0===(e=TextBox._defaultSizeMap.get(this._units)))throw{origin:"TextBox.setSize",context:"when setting the size of TextBox: "+this._name,error:"no default size for unit: "+this._units};this._setAttribute("size",e,t)&&(this._needUpdate=!0,this._needPixiUpdate=!0,this._estimateBoundingBox())}_getDefaultLetterHeight(){let e=TextBox._defaultLetterHeightMap.get(this._units);if(void 0===e)throw{origin:"TextBox._getDefaultLetterHeight",context:"when getting the default height of TextBox: "+this._name,error:"no default letter height for unit: "+this._units};return e}_getTextInputOptions(){let e=Math.round(this._getLengthPix(this._letterHeight)),t=Math.round(this._getLengthPix(this._padding)),r=Math.round(this._getLengthPix(this._size[0])),n=Math.round(this._getLengthPix(this._borderWidth)),i=Math.round(this._getLengthPix(this._size[1])),s=this._multiline;return{input:{fontFamily:this._font,fontSize:e+"px",color:new Color(this._color).hex,fontWeight:this._bold?"bold":"normal",fontStyle:this._italic?"italic":"normal",padding:t+"px",multiline:s,text:this._text,height:s?i-2*t+"px":void 0,width:r-2*t+"px"},box:{fill:new Color(this._fillColor).int,rounded:5,stroke:{color:new Color(this._borderColor).int,width:n}}}}_estimateBoundingBox(){let e=this._letterHeight+2*this._padding+2*this._borderWidth,t=this._getAnchor();this._boundingBox=new Rectangle(this._pos[0]-t[0]*this._size[0],this._pos[1]-t[1]*e,this._size[0],e)}_updateIfNeeded(){if(!this._needUpdate)return;if(this._needUpdate=!1,this._needPixiUpdate){this._needPixiUpdate=!1,void 0!==this._pixi&&this._pixi.destroy(!0);let e=void 0!==this._pixi?this._pixi.text:"";this._pixi=new TextInput(this._getTextInputOptions()),this instanceof ButtonStim||this._pixi._addListeners();let{_drawList:t=[]}=this.psychoJS.window,r=t.some((e=>e instanceof TextBox&&e._pixi&&e._pixi._hasFocus()));this._autofocus&&!r&&this._pixi._onSurrogateFocus(),this._multiline&&(this._pixi._multiline=this._multiline),this._editable?(this.text=e,this._pixi.placeholder=this._placeholder):this._pixi.text=this._text}this._pixi.disabled=!this._editable;let e=this._getAnchor();this._pixi.pivot.x=e[0]*this._pixi.width,this._pixi.pivot.y=e[1]*this._pixi.height,this._pixi.scale.x=this._flipHoriz?-1:1,this._pixi.scale.y=this._flipVert?1:-1,this._pixi.rotation=this._ori*Math.PI/180,[this._pixi.x,this._pixi.y]=to_px(this._pos,this._units,this._win),this._pixi.alpha=this._opacity,this._pixi.zIndex=this._depth,this._pixi.mask=this._clipMask}_getAnchor(){let e=[.5,.5];return this._anchor.indexOf("left")>-1?e[0]=0:this._anchor.indexOf("right")>-1&&(e[0]=1),this._anchor.indexOf("top")>-1?e[1]=0:this._anchor.indexOf("bottom")>-1&&(e[1]=1),e}};TextBox._defaultLetterHeightMap=new Map([["cm",1],["deg",1],["degs",1],["degFlatPos",1],["degFlat",1],["norm",.1],["height",.2],["pix",20],["pixels",20]]),TextBox._defaultSizeMap=new Map([["cm",[15,-1]],["deg",[15,-1]],["degs",[15,-1]],["degFlatPos",[15,-1]],["degFlat",[15,-1]],["norm",[1,-1]],["height",[1,-1]],["pix",[500,-1]],["pixels",[500,-1]]]);var ButtonStim=class extends TextBox{constructor({win:e,name:t,text:r,font:n,pos:i,size:s,padding:o,anchor:a="center",units:l,color:h,fillColor:u="darkgrey",borderColor:c,borderWidth:d=0,opacity:f,letterHeight:p,bold:m=!0,italic:_,autoDraw:g,autoLog:v}={}){super({win:e,name:t,text:r,font:n,pos:i,size:s,padding:o,anchor:a,units:l,color:h,fillColor:u,borderColor:c,borderWidth:d,opacity:f,letterHeight:p,bold:m,italic:_,alignment:"center",autoDraw:g,autoLog:v}),this.psychoJS.logger.debug("create a new Button with name: ",t),this.listener=new Mouse({name:t,win:e,autoLog:v}),this._addAttribute("wasClicked",!1),this._addAttribute("timesOn",[]),this._addAttribute("timesOff",[]),this._autoLog&&this._psychoJS.experimentLogger.exp(`Created ${this.name} = ${this.toString()}`)}get numClicks(){return this.timesOn.length}get isClicked(){return this.listener.isPressedIn(this,[1,0,0])}},Slider=class extends(mix(VisualStim).with(ColorMixin,WindowMixin)){constructor({name:e,win:t,pos:r,size:n,ori:i,units:s,color:o,markerColor:a,lineColor:l,contrast:h,opacity:u,style:c,ticks:d,labels:f,granularity:p,flip:m,readOnly:_,font:g,bold:v,italic:y,fontSize:b,compact:x,clipMask:S,autoDraw:T,autoLog:E,dependentStims:A}={}){super({name:e,win:t,units:s,ori:i,opacity:u,pos:r,size:n,clipMask:S,autoDraw:T,autoLog:E}),this._needMarkerUpdate=!1,this._skin={},Object.assign(this._skin,Slider.Skin);let w=(e=!1,t=!1,r=!1)=>{let n=this._onChange(e,t);return()=>{r&&this._sanitizeAttributes(),n()}};this._addAttribute("style",c,[Slider.Style.RATING],w(!0,!0,!0)),this._addAttribute("ticks",d,[1,2,3,4,5],w(!0,!0,!0)),this._addAttribute("labels",f,[],w(!0,!0,!0)),this._addAttribute("granularity",p,0,this._onChange(!1,!1)),this._addAttribute("readOnly",_,!1),this._addAttribute("compact",x,!1,this._onChange(!0,!0)),this._addAttribute("font",g,"Arial",this._onChange(!0,!0)),this._addAttribute("fontSize",b,"pix"===this._units?14:.03,this._onChange(!0,!0)),this._addAttribute("bold",v,!0,this._onChange(!0,!0)),this._addAttribute("italic",y,!1,this._onChange(!0,!0)),this._addAttribute("flip",m,!1,this._onChange(!0,!0)),this._addAttribute("color",o,"lightgray",this._onChange(!0,!1)),this._addAttribute("lineColor",l,"lightgray",this._onChange(!0,!1)),this._addAttribute("markerColor",a,"red",this._onChange(!0,!1)),this._addAttribute("contrast",h,1,this._onChange(!0,!1)),this._addAttribute("dependentStims",A,[],this._onChange(!1,!1)),this._addAttribute("rating",void 0),this._addAttribute("markerPos",void 0),this._addAttribute("history",[]),this._addAttribute("lineAspectRatio",.01),this._sanitizeAttributes(),this._estimateBoundingBox(),this._responseClock=new Clock,this._autoLog&&this._psychoJS.experimentLogger.exp(`Created ${this.name} = ${this.toString()}`)}refresh(){super.refresh(),this._needMarkerUpdate=!0}reset(){this.psychoJS.logger.debug("reset Slider: ",this._name),this._markerPos=void 0,this._history=[],this._rating=void 0,this._responseClock.reset(),this.status=PsychoJS.Status.NOT_STARTED,this._needPixiUpdate=!0,this._needUpdate=!0,void 0!==this._marker&&(this._marker.alpha=0)}isMarkerDragging(){return this._markerDragging}getRating(){let e=this._history.length;if(e>0)return this._history[e-1].rating}getRT(){let e=this._history.length;if(e>0)return this._history[e-1].responseTime}setReadOnly(e=!0,t=!1){this._setAttribute("readOnly",e,t)&&(e?this._opacity/=2:this._opacity*=2,this._needUpdate=!0)}setMarkerPos(e,t=!1){let r=this._markerPos;this._markerPos=this._granularise(e),r!==this._markerPos&&(this._needMarkerUpdate=!0,this._needUpdate=!0)}setRating(e,t=!1){e=this._granularise(e),this._markerPos=e,this._isCategorical&&(e=this._labels[Math.round(e)]),this._setAttribute("rating",e,t)}set borderColor(e){this.lineColor=e}setBorderColor(e){this.setLineColor(e)}get borderColor(){return this.lineColor}getBorderColor(){return this.getLineColor()}set fillColor(e){this.markerColor=e}setFillColor(e){this.setMarkerColor(e)}get fillColor(){return this.markerColor}getFillColor(){return this.getMarkerColor()}_estimateBoundingBox(){this._setupStyle(),this._tickSize_px=to_px(this._tickSize,this._units,this._win),this._fontSize_px=this._getLengthPix(this._fontSize),this._barSize_px=to_px(this._barSize,this._units,this._win,!0).map((e=>Math.max(1,e))),this._markerSize_px=to_px(this._markerSize,this._units,this._win,!0),to_px(this._pos,this._units,this._win);let e=to_px(this._size,this._units,this._win),t=this._ratingToPos(this._ticks);this._tickPositions_px=t.map((e=>to_px(e,this._units,this._win)));let r=[0,0,e[0],e[1]];this._labelPositions_px=new Array(this._labels.length);let n=this._getTextStyle(),i=null,s=0;for(let t=0;t<this._labels.length;++t){let o=Math.round(t/(this._labels.length-1)*(this._ticks.length-1));this._labelPositions_px[t]=this._tickPositions_px[o];let a=TextMetrics.measureText(this._labels[t].toString(),n);this._isHorizontal()?(this._flip?this._labelPositions_px[t][1]-=a.height+this._tickSize_px[1]:this._labelPositions_px[t][1]+=this._tickSize_px[1],-1===this._style.indexOf(Slider.Style.LABELS_45)&&(this._labelPositions_px[t][0]-=a.width/2,this._compact&&(this._labelPositions_px[t][0]=Math.min(e[0]/2-a.width,Math.max(-e[0]/2,this._labelPositions_px[t][0]))),i&&this._labelPositions_px[t-1][0]+i.width+10>=this._labelPositions_px[t][0]&&(0===s?(s=i.height,this._labelPositions_px[t][1]+=s):s=0),i=a)):(this._labelPositions_px[t][1]-=a.height/2,this._compact&&(this._labelPositions_px[t][1]=Math.min(e[1]/2-a.width,Math.max(-e[1]/2,this._labelPositions_px[t][1]))),this._flip?this._labelPositions_px[t][0]+=2*this._tickSize_px[0]:0===this._labelOri?this._labelPositions_px[t][0]-=a.width+2*this._tickSize_px[0]:this._labelPositions_px[t][0]-=this._tickSize_px[0]),r[0]=Math.min(r[0],this._labelPositions_px[t][0]),r[1]=Math.min(r[1],this._labelPositions_px[t][1]),r[2]=Math.max(r[2],this._labelPositions_px[t][0]+a.width),r[3]=Math.max(r[3],this._labelPositions_px[t][1]+a.height)}this._isHorizontal()&&(r[1]-=2*this._tickSize_px[1]);let o=this._getPosition_px();this._boundingBox=new Rectangle(this._getLengthUnits(o.x+r[0]),this._getLengthUnits(o.y+r[1]),this._getLengthUnits(r[2]-r[0]),this._getLengthUnits(r[3]-r[1]))}_sanitizeAttributes(){if(this._isSliderStyle=!1,this._frozenMarker=!1,this._style.forEach(((e,t)=>{"string"==typeof e&&(this._style[t]=Symbol.for(e.toUpperCase()))})),this._style.indexOf(Slider.Style.SLIDER)>-1){if(this._isSliderStyle=!0,this._ticks.length>2&&(this.psychoJS.logger.warn(`Slider "${this._name}" has style: SLIDER and more than two ticks. We cut the ticks to 2.`),this._ticks=this._ticks.slice(0,2)),this._ticks.length<2)throw{origin:"Slider._sanitizeAttributes",context:"when sanitizing the attributes of Slider: "+this._name,error:"less than 2 ticks were given for a slider of type: SLIDER"};0!==this._ticks[0]&&(this.psychoJS.logger.warn(`Slider "${this._name}" has style: SLIDER but the first tick is not 0. We changed it to 0.`),this._ticks[0]=0),this._ticks[1]<1&&(this.psychoJS.logger.warn(`Slider "${this._name}" has style: SLIDER but the second tick is less than 1. We changed it to 1.`),this._ticks[1]=1),1===this._ticks[1]&&(this._frozenMarker=!0)}this._isCategorical=0===this._ticks.length,this._isCategorical&&(this._ticks=[...Array(this._labels.length)].map(((e,t)=>t)),this._granularity=1)}recordRating(e,t,r=!1){void 0===t&&(t=this._responseClock.getTime()),this.setRating(e,r),this._history.push({rating:this._rating,responseTime:t}),this.psychoJS.logger.debug("record a new rating: ",this._rating,"with response time: ",t,"for Slider: ",this._name),this._needMarkerUpdate=!0,this._needUpdate=!0}_updateIfNeeded(){if(this._needUpdate){this._needUpdate=!1,this._estimateBoundingBox(),this._setupSlider(),this._updateMarker(),this._pixi.scale.x=1,this._pixi.scale.y=-1,this._pixi.rotation=this._ori*Math.PI/180,this._pixi.position=this._getPosition_px(),this._pixi.alpha=this._opacity;for(let e of this._dependentStims)e.draw()}}_getPosition_px(){let e=to_pixiPoint(this.pos,this.units,this.win,!0);return this._compact&&(this._style.indexOf(Slider.Style.RADIO)>-1||this._style.indexOf(Slider.Style.RATING)>-1)&&(this._isHorizontal()?e.y-=this._getLengthPix(this._tickSize[1])*(this._flip?-1:1):e.x+=this._getLengthPix(this._tickSize[0])*(this._flip?-1:1)),e}_updateMarker(){if(this._needMarkerUpdate&&(this._needMarkerUpdate=!1,void 0!==this._marker))if(void 0!==this._markerPos){let e=this._ratingToPos([this._markerPos]);this._marker.position=to_pixiPoint(e[0],this.units,this.win,!0),this._marker.alpha=1}else this._marker.alpha=0}_setupSlider(){if(!this._needPixiUpdate)return;this._needPixiUpdate=!1,this._setupStyle(),this._tickSize_px=to_px(this._tickSize,this._units,this._win),this._fontSize_px=this._getLengthPix(this._fontSize),this._barSize_px=to_px(this._barSize,this._units,this._win,!0).map((e=>Math.max(1,e))),this._markerSize_px=to_px(this._markerSize,this._units,this._win,!0);let e=this._ratingToPos(this._ticks);if(this._tickPositions_px=e.map((e=>to_px(e,this._units,this._win))),void 0!==this._pixi&&this._pixi.destroy(!0),this._pixi=new Container,this._pixi.interactive=!0,this._pixi.mask=this._clipMask,this._body=new Graphics,this._body.interactive=!0,this._pixi.addChild(this._body),this._tickType===Slider.Shape.DISC){let e=Math.max(this._tickSize_px[0],this._tickSize_px[1]);this._body.hitArea=new Rectangle(-this._barSize_px[0]/2-e,-this._barSize_px[1]/2-e,this._barSize_px[0]+2*e,this._barSize_px[1]+2*e)}else this._body.hitArea=new Rectangle(-this._barSize_px[0]/2-this._tickSize_px[0]/2,-this._barSize_px[1]/2-this._tickSize_px[1]/2,this._barSize_px[0]+this._tickSize_px[0],this._barSize_px[1]+this._tickSize_px[1]);this._setupBar(),this._setupTicks(),this._setupLabels(),this._setupMarker()}_setupBar(){this._barLineWidth_px>0&&(this._body.lineStyle(this._barLineWidth_px,this._barLineColor.int,1,.5),void 0!==this._barFillColor&&this._body.beginFill(this._barFillColor.int,1),this._body.drawRect(Math.round(-this._barSize_px[0]/2),Math.round(-this._barSize_px[1]/2),Math.round(this._barSize_px[0]),Math.round(this._barSize_px[1])),void 0!==this._barFillColor&&this._body.endFill())}_setupMarker(){this._marker=new Graphics,this._marker.alpha=0,this._marker.interactive=!0,this._pixi.addChild(this._marker);let e=Math.round(Math.max(...this._markerSize_px)/2);this._markerType===Slider.Shape.DISC?(this._marker.lineStyle(1,this._markerColor.int,1,.5),this._marker.beginFill(this._markerColor.int,1),this._marker.drawCircle(0,0,e),this._marker.endFill()):this._markerType===Slider.Shape.TRIANGLE?(this._marker.lineStyle(1,this._markerColor.int,1,.5),this._marker.beginFill(this._markerColor.int,1),this._marker.moveTo(0,0),this._isHorizontal()?this._flip?(this._marker.lineTo(e,e),this._marker.lineTo(-e,e)):(this._marker.lineTo(e,-e),this._marker.lineTo(-e,-e)):this._flip?(this._marker.lineTo(-e,e),this._marker.lineTo(-e,-e)):(this._marker.lineTo(e,e),this._marker.lineTo(e,-e)),this._marker.endFill()):this._markerType===Slider.Shape.BOX&&(this._marker.lineStyle(1,this.getContrastedColor(this._markerColor,.5).int,1,0),this._marker.beginFill(this._markerColor.int,1),this._marker.drawRect(Math.round(-this._markerSize_px[0]/2),Math.round(-this._markerSize_px[1]/2),this._markerSize_px[0],this._markerSize_px[1]),this._marker.endFill());let t=this;t._markerDragging=!1,this._marker.pointerdown=this._marker.mousedown=this._marker.touchstart=e=>{0===e.data.button&&(t._markerDragging=!0),e.stopPropagation()},this._marker.pointerup=this._marker.mouseup=this._marker.touchend=e=>{if(t._markerDragging){if(t._markerDragging=!1,!this._frozenMarker){let r=e.data.getLocalPosition(t._pixi),n=t._posToRating([r.x,r.y]);t.recordRating(n)}e.stopPropagation()}},this._marker.pointerupoutside=this._marker.mouseupoutside=this._marker.touchendoutside=e=>{if(t._markerDragging){if(t._markerDragging=!1,!this._frozenMarker){let r=e.data.getLocalPosition(t._pixi),n=t._posToRating([r.x,r.y]);t.recordRating(n)}e.stopPropagation()}},this._marker.pointermove=e=>{if(t._markerDragging){if(!this._frozenMarker){let r=e.data.getLocalPosition(t._pixi),n=t._posToRating([r.x,r.y]);t.setMarkerPos(n)}e.stopPropagation()}},this._pixi.pointerup=this._pixi.mouseup=this._pixi.touchend=e=>{if(!this._frozenMarker){let r=e.data.getLocalPosition(t._body),n=t._posToRating([r.x,r.y]);t.recordRating(n)}e.stopPropagation()},this._isSliderStyle&&(t._pointerIsOver=!1,this._pixi.pointerover=this._pixi.mouseover=e=>{t._pointerIsOver=!0,e.stopPropagation()},this._pixi.pointerout=this._pixi.mouseout=e=>{t._pointerIsOver=!1,e.stopPropagation()})}_setupTicks(){if(this._style.indexOf(Slider.Style.SLIDER)>-1)return;let e=Math.max(this._tickSize_px[0],this._tickSize_px[1]);this._body.lineStyle(2*this._barLineWidth_px,this._tickColor.int,1,.5);for(let t of this._tickPositions_px)this._tickType===Slider.Shape.LINE?(this._body.moveTo(t[0]-this._tickSize_px[0]/2,t[1]-this._tickSize_px[1]/2),this._body.lineTo(t[0]+this._tickSize_px[0]/2,t[1]+this._tickSize_px[1]/2)):this._tickType===Slider.Shape.DISC&&(this._body.beginFill(this._tickColor.int,1),this._body.drawCircle(t[0],t[1],e),this._body.endFill())}_getTextStyle(){return this._fontSize_px=this._getLengthPix(this._fontSize),new TextStyle({fontFamily:this._font,fontSize:Math.round(this._fontSize_px),fontWeight:this._bold?"bold":"normal",fontStyle:this._italic?"italic":"normal",fill:this.getContrastedColor(this._labelColor,this._contrast).hex,align:"center"})}_setupLabels(){let e=this._getTextStyle();for(let t=0;t<this._labels.length;++t){let r=new Text(this._labels[t],e);r.position.x=this._labelPositions_px[t][0],r.position.y=this._labelPositions_px[t][1],r.rotation=(this._ori+this._labelOri)*Math.PI/180,r.anchor=this._labelAnchor,r.alpha=1,this._pixi.addChild(r)}}_setupStyle(){let e=this._style.indexOf(Slider.Style.WHITE_ON_BLACK)>-1?this._skin.WHITE_ON_BLACK:this._skin.STANDARD;this._isHorizontal()?(this._barSize=[this._size[0],0],this._tickSize=[0,this._size[1]],this._labelAnchor=new Point(0,0)):(this._barSize=[0,this._size[1]],this._tickSize=[this._size[0],0],this._labelAnchor=new Point(0,0)),this._barLineWidth_px=1,this._barLineColor=e.BAR_LINE_COLOR?e.BAR_LINE_COLOR:new Color(this._lineColor),this._barFillColor=void 0,this._tickType=Slider.Shape.LINE,this._tickColor=e.TICK_COLOR?e.TICK_COLOR:new Color(this._lineColor),void 0===this.markerColor&&(this.markerColor=e.MARKER_COLOR),this.markerColor=new Color(this.markerColor),this._markerType=Slider.Shape.DISC,this._markerSize=this._skin.MARKER_SIZE?this._skin.MARKER_SIZE:this._tickSize,this._labelColor=e.LABEL_COLOR?e.LABEL_COLOR:new Color(this._color),this._labelOri=0,this._style.indexOf(Slider.Style.RATING),this._style.indexOf(Slider.Style.TRIANGLE_MARKER)>-1&&(this._markerType=Slider.Shape.TRIANGLE,this._skin.MARKER_SIZE||(this._markerSize=this._markerSize.map((e=>2*e)))),this._style.indexOf(Slider.Style.SLIDER)>-1&&(this._markerType=Slider.Shape.BOX,this._skin.MARKER_SIZE||(this._markerSize=this._isHorizontal()?[this._size[0]/(this._ticks[this._ticks.length-1]-this._ticks[0]),this._size[1]]:[this._size[0],this._size[1]/(this._ticks[this._ticks.length-1]-this._ticks[0])]),this._barSize=[this._size[0],this._size[1]],this._barFillColor=this.getContrastedColor(new Color(this.color),.5)),this._style.indexOf(Slider.Style.LABELS_45)>-1&&(this._labelOri=-45,this._flip?this._labelAnchor=new Point(0,.5):this._labelAnchor=new Point(1,0)),this._style.indexOf(Slider.Style.RADIO)>-1&&(this._barLineWidth_px=0,this._tickType=Slider.Shape.DISC,this._skin.MARKER_SIZE||(this._markerSize=this._markerSize.map((e=>.7*e))))}_ratingToPos(e){let t=this._ticks[this._ticks.length-1]-this._ticks[0];return this._isHorizontal()?this._compact&&this._style.indexOf(Slider.Style.RADIO)>-1?e.map((e=>[(e-this._ticks[0])/t*(this._size[0]-2*this._tickSize[1])-this._size[0]/2+this._tickSize[1],0])):this._style.indexOf(Slider.Style.SLIDER)>-1?e.map((e=>[((e-this._ticks[0])/t-.5)*(this._size[0]-this._markerSize[0]),0])):e.map((e=>[((e-this._ticks[0])/t-.5)*this._size[0],0])):this._compact&&this._style.indexOf(Slider.Style.RADIO)>-1?e.map((e=>[0,(e-this._ticks[0])/t*(this._size[1]-2*this._tickSize[0])-this._size[1]/2+this._tickSize[0]])):this._style.indexOf(Slider.Style.SLIDER)>-1?e.map((e=>[0,((e-this._ticks[0])/t-.5)*(this._size[1]-this._markerSize[1])])):e.map((e=>[0,(1-(e-this._ticks[0])/t-.5)*this._size[1]]))}_posToRating(e){let t=this._ticks[this._ticks.length-1]-this._ticks[0],r=to_px(this._size,this._units,this._win),n=to_px(this._markerSize,this._units,this._win);return this._isHorizontal()?this._style.indexOf(Slider.Style.SLIDER)>-1?(e[0]/(r[0]-n[0])+.5)*t+this._ticks[0]:(e[0]/r[0]+.5)*t+this._ticks[0]:this._style.indexOf(Slider.Style.SLIDER)>-1?r[1]!==n[1]?(e[1]/(r[1]-n[1])+.5)*t+this._ticks[0]:void 0:(1-(e[1]/r[1]+.5))*t+this._ticks[0]}_isHorizontal(){return this._size[0]>this._size[1]}_granularise(e){if(void 0!==e)return this._granularity>0&&(e=Math.round(e/this._granularity)*this._granularity),Math.min(Math.max(this._ticks[0],e),this._ticks[this._ticks.length-1])}};Slider.Shape={DISC:Symbol.for("DISC"),TRIANGLE:Symbol.for("TRIANGLE"),LINE:Symbol.for("LINE"),BOX:Symbol.for("BOX")},Slider.Style={RATING:Symbol.for("RATING"),TRIANGLE_MARKER:Symbol.for("TRIANGLE_MARKER"),SLIDER:Symbol.for("SLIDER"),WHITE_ON_BLACK:Symbol.for("WHITE_ON_BLACK"),LABELS_45:Symbol.for("LABELS_45"),RADIO:Symbol.for("RADIO")},Slider.Skin={MARKER_SIZE:null,STANDARD:{MARKER_COLOR:new Color("red"),BAR_LINE_COLOR:null,TICK_COLOR:null,LABEL_COLOR:null},WHITE_ON_BLACK:{MARKER_COLOR:new Color("white"),BAR_LINE_COLOR:new Color("black"),TICK_COLOR:new Color("black"),LABEL_COLOR:new Color("black")}};var TextStim=class extends(mix(VisualStim).with(ColorMixin)){constructor({name:e,win:t,text:r,font:n,pos:i,color:s,opacity:o,depth:a,contrast:l,units:h,ori:u,height:c,bold:d,italic:f,alignHoriz:p,alignVert:m,wrapWidth:_,flipHoriz:g,flipVert:v,clipMask:y,autoDraw:b,autoLog:x,isInstruction:S=!1}={}){super({name:e,win:t,units:h,ori:u,opacity:o,depth:a,pos:i,clipMask:y,autoDraw:b,autoLog:x});let T=(e=!1,t=!1,r=!1)=>{let n=this._onChange(e,t);return()=>{n(),r&&(this._textMetrics=void 0)}};this._isInstruction=S||!1,this._addAttribute("text",r,"Hello World",T(!0,!0,!0)),this._addAttribute("alignHoriz",p,"center",T(!0,!0,!0)),this._addAttribute("alignVert",m,"center",T(!0,!0,!0)),this._addAttribute("flipHoriz",g,!1,T(!0,!0,!0)),this._addAttribute("flipVert",v,!1,T(!0,!0,!0)),this._addAttribute("font",n,"Arial",this._onChange(!0,!0)),this._addAttribute("height",c,this._getDefaultLetterHeight(),T(!0,!0,!0)),this._addAttribute("wrapWidth",_,this._getDefaultWrapWidth(),T(!0,!0,!0)),this._addAttribute("bold",d,!1,T(!0,!0,!0)),this._addAttribute("italic",f,!1,T(!0,!0,!0)),this._addAttribute("color",s,"white"),this._addAttribute("contrast",l,1,this._onChange(!0,!1)),this._estimateBoundingBox(),this._autoLog&&this._psychoJS.experimentLogger.exp(`Created ${this.name} = ${this.toString()}`)}getTextMetrics(){if(void 0===this._textMetrics){this._textMetrics=TextMetrics.measureText(this._text,this._getTextStyle());let e=document.createElement("canvas");document.body.appendChild(e);let t=e.getContext("2d");t.font=this._getTextStyle().toFontString(),t.textBaseline="alphabetic",t.textAlign="left",this._textMetrics.boundingBox=t.measureText(this._text),document.body.removeChild(e)}return this._textMetrics}_getDefaultLetterHeight(){let e=TextStim._defaultLetterHeightMap.get(this._units);if(void 0===e)throw{origin:"TextStim._getDefaultLetterHeight",context:"when getting the default height of TextStim: "+this._name,error:"no default letter height for unit: "+this._units};return e}_getDefaultWrapWidth(){let e=TextStim._defaultWrapWidthMap.get(this._units);if(void 0===e)throw{origin:"TextStim._getDefaultWrapWidth",context:"when getting the default wrap width of TextStim: "+this._name,error:"no default wrap width for unit: "+this._units};return e}getBoundingBox(e=!1){if(e){let e=this.getTextMetrics(),t=this._pos[0]-e.boundingBox.actualBoundingBoxLeft,r=this._pos[1]+e.fontProperties.descent-e.boundingBox.actualBoundingBoxDescent,n=e.boundingBox.actualBoundingBoxRight+e.boundingBox.actualBoundingBoxLeft,i=e.boundingBox.actualBoundingBoxAscent+e.boundingBox.actualBoundingBoxDescent,s=this._getBoundingBox_px();switch(this._alignHoriz){case"left":case"right":break;default:t-=(s.width-n)/2}switch(this._alignVert){case"top":case"bottom":break;default:r-=(s.height-i)/2}let o=to_unit([t,r],"pix",this._win,this._units),a=to_unit([n,i],"pix",this._win,this._units);return new Rectangle(o[0],o[1],a[0],a[1])}return this._boundingBox.clone()}_estimateBoundingBox(){let e=this.getTextMetrics(),t=to_unit([e.width,e.height],"pix",this._win,this._units),r=this._getAnchor();this._boundingBox=new Rectangle(this._pos[0]-r[0]*t[0],this._pos[1]-t[1]-r[1]*t[1],t[0],t[1])}_getTextStyle(){return new TextStyle({fontFamily:this._font,fontSize:Math.round(this._getLengthPix(this._height)),fontWeight:this._bold?"bold":"normal",fontStyle:this._italic?"italic":"normal",fill:this.getContrastedColor(new Color(this._color),this._contrast).hex,align:this._alignHoriz,wordWrap:void 0!==this._wrapWidth,wordWrapWidth:void 0!==this._wrapWidth?this._getHorLengthPix(this._wrapWidth):0,breakWords:this._isInstruction})}setColor(e,t=!1){this._setAttribute("color",e,t)&&void 0!==this._pixi&&(this._pixi.style=this._getTextStyle(),this._needUpdate=!0)}_updateIfNeeded(){if(!this._needUpdate)return;this._needUpdate=!1,this._needPixiUpdate&&(this._needPixiUpdate=!1,void 0!==this._pixi&&this._pixi.destroy(!0),this._pixi=new Text(this._text,this._getTextStyle()));let e=this._getAnchor();[this._pixi.anchor.x,this._pixi.anchor.y]=e,this._pixi.scale.x=this._flipHoriz?-1:1,this._pixi.scale.y=this._flipVert?1:-1,this._pixi.rotation=this._ori*Math.PI/180,this._pixi.position=to_pixiPoint(this.pos,this.units,this.win),this._pixi.alpha=this._opacity,this._pixi.zIndex=this._depth,this._pixi.mask=this._clipMask,this._size=to_unit([Math.abs(this._pixi.width),Math.abs(this._pixi.height)],"pix",this._win,this._units),this._boundingBox=new Rectangle(this._pos[0]-e[0]*this._size[0],this._pos[1]-this._size[1]-e[1]*this._size[1],this._size[0],this._size[1])}_getAnchor(){let e=[];switch(this._alignHoriz){case"left":e.push(0);break;case"right":e.push(1);break;default:e.push(.5)}switch(this._alignVert){case"top":e.push(0);break;case"bottom":e.push(1);break;default:e.push(.5)}return e}};TextStim._defaultLetterHeightMap=new Map([["cm",1],["deg",1],["degs",1],["degFlatPos",1],["degFlat",1],["norm",.1],["height",.2],["pix",20],["pixels",20]]),TextStim._defaultWrapWidthMap=new Map([["cm",15],["deg",15],["degs",15],["degFlatPos",15],["degFlat",15],["norm",1],["height",1],["pix",500],["pixels",500]]);var Form=class extends(mix(VisualStim).with(ColorMixin)){constructor({name:e,win:t,pos:r,size:n,units:i,borderColor:s,fillColor:o,itemColor:a,markerColor:l,responseColor:h,color:u,contrast:c,opacity:d,depth:f,items:p,randomize:m,itemPadding:_,font:g,fontFamily:v,bold:y,italic:b,fontSize:x,clipMask:S,autoDraw:T,autoLog:E}={}){super({name:e,win:t,units:i,opacity:d,depth:f,pos:r,size:n,clipMask:S,autoDraw:T,autoLog:E}),this._addAttribute("itemPadding",_,to_unit([20,0],"pix",t,this._units)[0],this._onChange(!0,!1)),this._addAttribute("color",u,void 0,this._onChange(!0,!1)),this._addAttribute("borderColor",s,o,this._onChange(!0,!1)),this._addAttribute("fillColor",o,void 0,this._onChange(!0,!1)),this._addAttribute("itemColor",a,void 0,this._onChange(!0,!1)),this._addAttribute("markerColor",l,void 0,this._onChange(!0,!1)),this._addAttribute("responseColor",h,void 0,this._onChange(!0,!1)),this._addAttribute("contrast",c,1,this._onChange(!0,!1)),this._addAttribute("font",g,"Arial",this._onChange(!0,!0)),this._addAttribute("fontFamily",v,"Helvetica",this._onChange(!0,!0)),this._addAttribute("fontSize",x,"pix"===this._units?14:.03,this._onChange(!0,!0)),this._addAttribute("bold",y,!1,this._onChange(!0,!0)),this._addAttribute("italic",b,!1,this._onChange(!0,!0));let A=()=>{this._processItems(),this._setupStimuli(),this._onChange(!0,!0)()};this._addAttribute("items",p,[],A),this._addAttribute("randomize",m,!1,A),this._scrollbarWidth=.02,this._responseTextHeightRatio=.8,this._processItems(),this._setupStimuli(),this._autoLog&&this._psychoJS.experimentLogger.exp(`Created ${this.name} = ${this.toString()}`)}refresh(){super.refresh();for(let e=0;e<this._items.length;++e){this._visual.textStims[e].refresh();let t=this._visual.responseStims[e];t&&t.refresh()}}draw(){this._scrollbar.markerPos!==this._prevScrollbarMarkerPos&&(this._prevScrollbarMarkerPos=this._scrollbar.markerPos,this._needUpdate=!0),super.draw();for(let e=0;e<this._items.length;++e)if(this._visual.visibles[e]){this._visual.textStims[e].draw();let t=this._visual.responseStims[e];t&&t.draw()}this._scrollbar.draw()}hide(){if(super.hide(),void 0!==this._items){for(let e=0;e<this._items.length;++e)if(this._visual.visibles[e]){this._visual.textStims[e].hide();let t=this._visual.responseStims[e];t&&t.hide()}this._scrollbar.hide()}}reset(){this.psychoJS.logger.debug("reset Form: ",this._name);for(let e=0;e<this._items.length;++e){this._visual.textStims[e].reset();let t=this._visual.responseStims[e];t&&t.reset()}this._needUpdate=!0}getData(){let e=0;for(let t=0;t<this._items.length;++t){let r=this._items[t],n=this._visual.responseStims[t];n&&(r.type===Form.Types.CHOICE||r.type===Form.Types.RATING||r.type===Form.Types.SLIDER?(r.response=n.getRating(),r.rt=n.getRT(),void 0===r.response&&++e):r.type===Form.Types.FREE_TEXT&&(r.response=n.text,r.rt=void 0,0===r.response.length&&++e))}return this._items._complete=0===e,this._items.map((e=>Object.assign({},e)))}formComplete(){return this.getData(),this._items._complete}addDataToExp(e,t="rows"){let r=["cols","columns"].includes(t.toLowerCase()),n=(this.getData(),["itemCtrl","responseCtrl","itemColor","options","ticks","tickLabels","responseWidth","responseColor","layout"]);for(let t of this.getData()){let i=0;for(let s in t){if(!n.includes(s)){let n=r?`${this._name}[${i}]${s}`:`${this._name}${s}`;e.addData(n,t[s])}++i}r||e.nextEntry()}r&&e.nextEntry()}_processItems(){let e={origin:"Form._processItems",context:"when processing the form items"};try{this._autoLog&&this._psychoJS.experimentLogger.exp("Importing items..."),this._importItems(),this._sanitizeItems(),this._randomize&&shuffle(this._items)}catch(t){throw Object.assign(e,{error:t})}}_importItems(){let e={origin:"Form._importItems",context:"when importing the form items"};try{let e=typeof this._items;if("undefined"===e)this._items=[Form._defaultItems];else{if("string"!==e)throw`unable to import items of unknown type: ${e}`;this._items=TrialHandler.importConditions(this._psychoJS.serverManager,this._items)}Array.isArray(this._items)&&0===this._items.length&&(this._items=[Form._defaultItems])}catch(t){throw Object.assign(e,{error:t})}}_sanitizeItems(){let e={origin:"Form._sanitizeItems",context:"when sanitizing the form items"};try{for(let e of this._items)void 0!==e.questionText&&(e.itemText=e.questionText,delete e.questionText,e.itemWidth=e.questionWidth,delete e.questionWidth,("rating"===e.type||"slider"===e.type)&&(e.ticks=e.options,e.options=void 0));let e=Object.keys(Form._defaultItems),t=new Set;for(let r of this._items){let n=Object.keys(r);for(let i of e)n.includes(i)?void 0===r[i]&&(r[i]=Form._defaultItems[i]):(t.add(i),r[i]=Form._defaultItems[i])}t.size>0&&this._psychoJS.logger.warn(`Missing headers: ${Array.from(t).join(", ")}\nNote, headers are case sensitive and must match: ${Array.from(e).join(", ")}`);let r=Object.getOwnPropertyNames(Form.Types);for(let e of this._items){if(e.type=e.type.toUpperCase().replace(" ","_"),!r.includes(e.type))throw`${e.type} is not a valid type for item: ${e.itemText}`;if("RADIO"===e.type&&(e.type="CHOICE"),e.type=Symbol.for(e.type),e.type===Form.Types.CHOICE){if(e.options=e.options.split(","),e.options.length<2)throw`at least two choices should be provided for choice item: ${e.itemText}`}else(e.type===Form.Types.RATING||e.type===Form.Types.SLIDER)&&(e.ticks=e.ticks.split(",").map(((e,t)=>parseInt(t))),e.tickLabels=e.tickLabels.length>0?e.tickLabels.split(","):[])}let n=["HORIZ","VERT"];for(let e of this._items){if(e.layout=e.layout.toUpperCase(),!n.includes(e.layout))throw`${e.layout} is not a valid layout for item: ${e.itemText}`;e.layout="HORIZ"===e.layout?Form.Layout.HORIZONTAL:Form.Layout.VERTICAL}}catch(t){throw Object.assign(e,{error:t})}}_estimateBoundingBox(){this._boundingBox=new Rectangle(this._pos[0]-this._size[0]/2,this._pos[1]-this._size[1]/2,this._size[0],this._size[1])}_setupStimuli(){if(this._autoLog&&this._psychoJS.experimentLogger.exp(`Setting layout of Form: ${this.name}`),void 0!==this._visual){for(let e of this._visual.textStims)e.release();for(let e of this._visual.responseStims)e.release()}this._visual={rowHeights:[],textStims:[],responseStims:[],visibles:[],stimuliTotalHeight:0},this._stimuliClipMask=new Graphics;let e={win:this._win,name:"item text",font:this.font,units:this._units,alignHoriz:"left",alignVert:"top",height:this._fontSize,color:this.itemColor,ori:0,opacity:1,depth:this._depth+1,clipMask:this._stimuliClipMask},t={win:this._win,name:"choice response",units:this._units,flip:!1,fontFamily:this.fontFamily,font:this.font,bold:!1,italic:!1,fontSize:this._fontSize*this._responseTextHeightRatio,color:this.responseColor,markerColor:this.markerColor,opacity:1,depth:this._depth+1,clipMask:this._stimuliClipMask,granularity:1},r={win:this._win,name:"free text response",units:this._units,anchor:"left-top",flip:!1,opacity:1,depth:this._depth+1,font:this.font,letterHeight:this._fontSize*this._responseTextHeightRatio,bold:!1,italic:!1,alignment:"left",color:this.responseColor,fillColor:this.fillColor,contrast:1,borderColor:this.responseColor,borderWidth:.002,padding:.01,editable:!0,clipMask:this._stimuliClipMask},n=new TextStim(Object.assign(e,{text:"Ag",pos:[0,0]})),i=n.getTextMetrics(),s=this._getLengthUnits(i.height)/2;n.release(!1);let o=-this._itemPadding;for(let n of this._items){let i;this._visual.visibles.push(!1),i=n.type===Form.Types.HEADING||n.type===Form.Types.DESCRIPTION||n.type===Form.Types.CHOICE&&n.layout===Form.Layout.VERTICAL?this._size[0]-2*this._itemPadding-this._scrollbarWidth:this._size[0]-3*this._itemPadding-this._scrollbarWidth;let a=i*n.itemWidth,l=new TextStim(Object.assign(e,{text:n.itemText,wrapWidth:a}));l._relativePos=[this._itemPadding,o];let h=l.boundingBox.height;this._visual.textStims.push(l);let u,c,d=null,f=0,p=i*n.responseWidth;if(n.type===Form.Types.CHOICE||n.type===Form.Types.RATING||n.type===Form.Types.SLIDER){let e;n.layout===Form.Layout.HORIZONTAL?(e=[p,s],u=!0,c=!1):(e=[s,1.5*s*n.options.length],u=!1,c=!0);let r,i,l,m=1;n.type===Form.Types.CHOICE?(r=[Slider.Style.RATING,Slider.Style.RADIO],i=n.options,l=[]):n.type===Form.Types.SLIDER?(r=[Slider.Style.SLIDER],i=n.tickLabels,l=n.ticks,m=0):(r=[Slider.Style.RATING],i=n.tickLabels,l=n.ticks,m=1),d=new Slider(Object.assign({},t,{granularity:m,size:e,style:r,labels:i,ticks:l,compact:u,flip:c})),f=d.boundingBox.height,n.layout===Form.Layout.HORIZONTAL?d._relativePos=[2*this._itemPadding+a+p/2,o]:(d._relativePos=[2*this._itemPadding+a,o-f/2-h-this._itemPadding],f+=h+this._itemPadding)}else n.type===Form.Types.FREE_TEXT&&(d=new TextBox(Object.assign(r,{text:n.options,size:[p,-1]})),f=d.boundingBox.height,d._relativePos=[2*this._itemPadding+a,o]);this._visual.responseStims.push(d);let m=Math.max(h,f);this._visual.rowHeights.push(m),o-=m+this._itemPadding}this._visual.stimuliTotalHeight=o,this._scrollbar=new Slider({win:this._win,name:"scrollbar",units:this._units,color:this.itemColor,depth:this._depth+1,pos:[0,0],size:[this._scrollbarWidth,this._size[1]],style:[Slider.Style.SLIDER],ticks:[0,-this._visual.stimuliTotalHeight/this._size[1]],dependentStims:[this]}),this._prevScrollbarMarkerPos=0,this._scrollbar.setMarkerPos(this._prevScrollbarMarkerPos),this._estimateBoundingBox(),this._autoLog&&this._psychoJS.experimentLogger.exp(`Layout set for: ${this.name}`)}_updateIfNeeded(){!this._needUpdate||(this._needUpdate=!1,this._leftEdge=this._pos[0]-this._size[0]/2,this._rightEdge=this._pos[0]+this._size[0]/2,this._topEdge=this._pos[1]+this._size[1]/2,this._bottomEdge=this._pos[1]-this._size[1]/2,[this._leftEdge_px,this._topEdge_px]=to_px([this._leftEdge,this._topEdge],this.units,this.win,!0),[this._rightEdge_px,this._bottomEdge_px]=to_px([this._rightEdge,this._bottomEdge],this.units,this.win,!0),this._itemPadding_px=this._getLengthPix(this._itemPadding),this._scrollbarWidth_px=this._getLengthPix(this._scrollbarWidth,!0),this._size_px=to_px(this._size,this.units,this.win,!0),this._stimuliClipMask.clear(),this._stimuliClipMask.beginFill(16777215),this._stimuliClipMask.drawRect(this._win._rootContainer.position.x+this._leftEdge_px+2,this._win._rootContainer.position.y+this._bottomEdge_px+2,this._size_px[0]-4,this._size_px[1]-6),this._stimuliClipMask.endFill(),this._scrollbar.setPos([this._rightEdge-this._scrollbarWidth/2,this._pos[1]],!1),this._scrollbar.setOpacity(.5),this._scrollbarOffset=this._prevScrollbarMarkerPos*(this._visual.stimuliTotalHeight+this._size[1])/(-this._visual.stimuliTotalHeight/this._size[1]),this._updateVisibleStimuli(),this._updateDecorations())}_updateVisibleStimuli(){for(let e=0;e<this._items.length;++e){let t=this._visual.textStims[e],r=[this._leftEdge+t._relativePos[0],this._topEdge+t._relativePos[1]-this._scrollbarOffset];t.setPos(r);let n=this._visual.responseStims[e];if(n){let e=[this._leftEdge+n._relativePos[0],this._topEdge+n._relativePos[1]-this._scrollbarOffset];n.setPos(e)}r[1]>this._bottomEdge&&r[1]-this._visual.rowHeights[e]<=this._topEdge?this._visual.visibles[e]=!0:(this._visual.visibles[e]&&(t.hide(),n&&n.hide()),this._visual.visibles[e]=!1)}}_updateDecorations(){void 0!==this._pixi&&this._pixi.destroy(!0),this._pixi=new Graphics,this._pixi.scale.x=1,this._pixi.scale.y=1,this._pixi.rotation=0,this._pixi.position=to_pixiPoint(this.pos,this.units,this.win),this._pixi.alpha=this._opacity,this._pixi.zIndex=this._depth,this._pixi.mask=this._clipMask,this._pixi.lineStyle(1,new Color(this.borderColor).int,this._opacity,.5),this._pixi.beginFill(new Color(this.fillColor).int),this._pixi.drawRect(this._leftEdge_px,this._bottomEdge_px,this._size_px[0],this._size_px[1]),this._pixi.endFill(),this._decorations=new Graphics,this._pixi.addChild(this._decorations),this._decorations.mask=this._stimuliClipMask,this._decorations.lineStyle(1,new Color("gray").int,this._opacity,.5),this._decorations.alpha=.5;for(let e=0;e<this._items.length;++e)if(this._visual.visibles[e]){let t=this._items[e];if(t.type===Form.Types.HEADING||t.type===Form.Types.DESCRIPTION){let t=this._visual.textStims[e],r=to_px([this._leftEdge+t._relativePos[0],this._topEdge+t._relativePos[1]-this._scrollbarOffset],this._units,this._win);this._decorations.beginFill(new Color("darkgray").int),this._decorations.drawRect(r[0]-this._itemPadding_px/2,r[1]+this._itemPadding_px/2,this._size_px[0]-this._itemPadding_px-this._scrollbarWidth_px,-this._getLengthPix(this._visual.rowHeights[e])-this._itemPadding_px),this._decorations.endFill()}}}};Form.Types={HEADING:Symbol.for("HEADING"),DESCRIPTION:Symbol.for("DESCRIPTION"),RATING:Symbol.for("RATING"),SLIDER:Symbol.for("SLIDER"),FREE_TEXT:Symbol.for("FREE_TEXT"),CHOICE:Symbol.for("CHOICE"),RADIO:Symbol.for("RADIO")},Form.Layout={HORIZONTAL:Symbol.for("HORIZONTAL"),VERTICAL:Symbol.for("VERTICAL")},Form._defaultItems={itemText:"Default question",type:"rating",options:"Yes, No",tickLabels:"",itemWidth:.7,itemColor:"white",responseWidth:.3,responseColor:"white",index:0,layout:"horiz"};var ImageStim=class extends(mix(VisualStim).with(ColorMixin)){constructor({name:e,win:t,image:r,mask:n,pos:i,units:s,ori:o,size:a,color:l,opacity:h,contrast:u,texRes:c,depth:d,interpolate:f,flipHoriz:p,flipVert:m,autoDraw:_,autoLog:g}={}){super({name:e,win:t,units:s,ori:o,opacity:h,depth:d,pos:i,size:a,autoDraw:_,autoLog:g}),this._addAttribute("image",r),this._addAttribute("mask",n),this._addAttribute("color",l,"white",this._onChange(!0,!1)),this._addAttribute("contrast",u,1,this._onChange(!0,!1)),this._addAttribute("texRes",c,128,this._onChange(!0,!1)),this._addAttribute("interpolate",f,!1,this._onChange(!0,!1)),this._addAttribute("flipHoriz",p,!1,this._onChange(!1,!1)),this._addAttribute("flipVert",m,!1,this._onChange(!1,!1)),this._estimateBoundingBox(),this._autoLog&&this._psychoJS.experimentLogger.exp(`Created ${this.name} = ${this.toString()}`)}setImage(e,t=!1){let r={origin:"ImageStim.setImage",context:"when setting the image of ImageStim: "+this._name};try{if(void 0===e)this.psychoJS.logger.warn("setting the image of ImageStim: "+this._name+" with argument: undefined."),this.psychoJS.logger.debug("set the image of ImageStim: "+this._name+" as: undefined");else{if("string"==typeof e&&(e=this.psychoJS.serverManager.getResource(e)),!(e instanceof HTMLImageElement))throw"the argument: "+e.toString()+' is not an image" }';this.psychoJS.logger.debug("set the image of ImageStim: "+this._name+" as: src= "+e.src+", size= "+e.width+"x"+e.height)}let r=this.getImage(),n=!r||r.src!==e.src;this._setAttribute("image",e,t),n&&this._onChange(!0,!0)()}catch(e){throw Object.assign(r,{error:e})}}setMask(e,t=!1){let r={origin:"ImageStim.setMask",context:"when setting the mask of ImageStim: "+this._name};try{if(void 0===e)this.psychoJS.logger.warn("setting the mask of ImageStim: "+this._name+" with argument: undefined."),this.psychoJS.logger.debug("set the mask of ImageStim: "+this._name+" as: undefined");else{if("string"==typeof e&&(e=this.psychoJS.serverManager.getResource(e)),!(e instanceof HTMLImageElement))throw"the argument: "+e.toString()+' is not an image" }';this.psychoJS.logger.debug("set the mask of ImageStim: "+this._name+" as: src= "+e.src+", size= "+e.width+"x"+e.height)}this._setAttribute("mask",e,t),this._onChange(!0,!1)()}catch(e){throw Object.assign(r,{error:e})}}_estimateBoundingBox(){let e=this._getDisplaySize();void 0!==e&&(this._boundingBox=new Rectangle(this._pos[0]-e[0]/2,this._pos[1]-e[1]/2,e[0],e[1]))}_updateIfNeeded(){if(!this._needUpdate)return;if(this._needUpdate=!1,this._needPixiUpdate){if(this._needPixiUpdate=!1,void 0!==this._pixi&&this._pixi.destroy(!0),this._pixi=void 0,void 0===this._image)return;let e=new BaseTexture(this._image);if(this._texture=new Texture(e),this._pixi=Sprite.from(this._texture),void 0!==this._mask&&(this._pixi.mask=Sprite.from(this._mask),this._pixi.mask.anchor.x=.5,this._pixi.mask.anchor.y=.5,this._pixi.addChild(this._pixi.mask)),0===this._texture.width)return this._needUpdate=!0,void(this._needPixiUpdate=!0)}this._pixi.zIndex=this._depth,this._pixi.alpha=this.opacity;let e=to_px(this._getDisplaySize(),this.units,this.win),t=e[0]/this._texture.width,r=e[1]/this._texture.height;this._pixi.scale.x=this.flipHoriz?-t:t,this._pixi.scale.y=this.flipVert?r:-r,this._pixi.position=to_pixiPoint(this.pos,this.units,this.win),this._pixi.rotation=this.ori*Math.PI/180,this._pixi.anchor.x=.5,this._pixi.anchor.y=.5,this._estimateBoundingBox()}_getDisplaySize(){let e=this.size;return void 0===e&&void 0!==this._texture&&this._texture.width>0&&(e=to_unit([this._texture.width,this._texture.height],"pix",this.win,this.units)),e}},Camera=class extends PsychObject{constructor({win:e,name:t,format:r,showDialog:n,dialogMsg:i="Please wait a few moments while the camera initialises",clock:s,autoLog:o}={}){super(e._psychoJS),this._addAttribute("win",e,void 0),this._addAttribute("name",t,"camera"),this._addAttribute("format",r,"video/webm;codecs=vp9",this._onChange),this._addAttribute("clock",s,new Clock),this._addAttribute("autoLog",o,!1),this._addAttribute("status",PsychoJS.Status.NOT_STARTED),n&&this.psychoJS.gui.dialog({warning:i,showOK:!1}),this._prepareRecording().then((()=>{n&&this.psychoJS.gui.closeDialog()})),this._autoLog&&this._psychoJS.experimentLogger.exp(`Created ${this.name} = ${this.toString()}`)}isReady(){return null!==this._recorder}getStream(){return this._stream}getVideo(){let e=document.createElement("video");return this._videos.push(e),e.width=this._streamSettings.width,e.height=this._streamSettings.height,e.autoplay=!0,e.onclick=e=>(e.preventDefault(),!1),e.srcObject=this._stream,e}start(){if(this._status===PsychoJS.Status.PAUSED)return this.resume({clear:!0});if(this._status!==PsychoJS.Status.STARTED){this._psychoJS.logger.debug("request to start video recording");try{if(!this._recorder)throw"the recorder has not been created yet, possibly because the participant has not given the authorisation to record video";this._recorder.start();let e=this;return new Promise(((t,r)=>{e._startCallback=t,e._errorCallback=r}))}catch(e){throw this._psychoJS.logger.error("unable to start the video recording: "+JSON.stringify(e)),this._status=PsychoJS.Status.ERROR,{origin:"Camera.start",context:"when starting the video recording for camera: "+this._name,error:e}}}}stop({filename:e}={}){if(this._status===PsychoJS.Status.STARTED||this._status===PsychoJS.Status.PAUSED){this._psychoJS.logger.debug("request to stop video recording");for(let e of this._videos)e.pause();this._stopOptions={filename:e},this._recorder.stop();let t=this;return new Promise(((e,r)=>{t._stopCallback=e,t._errorCallback=r}))}}pause(){if(this._status===PsychoJS.Status.STARTED){this._psychoJS.logger.debug("request to pause video recording");try{if(!this._recorder)throw"the recorder has not been created yet, possibly because the participant has not given the authorisation to record video";this._recorder.pause();let e=this;return new Promise(((t,r)=>{e._pauseCallback=t,e._errorCallback=r}))}catch(e){throw self._psychoJS.logger.error("unable to pause the video recording: "+JSON.stringify(e)),this._status=PsychoJS.Status.ERROR,{origin:"Camera.pause",context:"when pausing the video recording for camera: "+this._name,error:e}}}}resume({clear:e=!1}={}){if(this._status===PsychoJS.Status.PAUSED){this._psychoJS.logger.debug("request to resume video recording");try{if(!this._recorder)throw"the recorder has not been created yet, possibly because the participant has not given the authorisation to record video";e&&(this._audioBuffer=[],this._videoBuffer.length=0),this._recorder.resume();let t=this;return new Promise(((e,r)=>{t._resumeCallback=e,t._errorCallback=r}))}catch(e){throw self._psychoJS.logger.error("unable to resume the video recording: "+JSON.stringify(e)),this._status=PsychoJS.Status.ERROR,{origin:"Camera.resume",context:"when resuming the video recording for camera: "+this._name,error:e}}}}flush(){if(this._status===PsychoJS.Status.STARTED||this._status===PsychoJS.Status.PAUSED){this._psychoJS.logger.debug("request to flush video recording"),this._recorder.requestData();let e=this;return new Promise(((t,r)=>{e._dataAvailableCallback=t,e._errorCallback=r}))}}download(e="video.webm"){let t=new Blob(this._videoBuffer),r=document.createElement("a");r.href=window.URL.createObjectURL(t),r.download=e,document.body.appendChild(r),r.click(),document.body.removeChild(r)}async upload({tag:e,waitForCompletion:t=!1,showDialog:r=!1,dialogMsg:n=""}={}){if(void 0===e&&(e=this._name),e+=extensionFromMimeType(this._format),this._psychoJS.getEnvironment()!==ExperimentHandler.Environment.SERVER||"RUNNING"!==this._psychoJS.config.experiment.status||this._psychoJS._serverMsg.has("__pilotToken"))return this.download(e);let i=new Blob(this._videoBuffer);return this._psychoJS.serverManager.uploadAudioVideo({mediaBlob:i,tag:e,waitForCompletion:t,showDialog:r,dialogMsg:n})}async getRecording({tag:e,flush:t=!1}={}){void 0===e&&(e=this._name)}_onChange(){this._status===PsychoJS.Status.STARTED&&this.stop(),this._prepareRecording(),this.start()}async _prepareRecording(){let e;this._videoBuffer=[],this._recorder=null,this._videos=[],this._stream=await navigator.mediaDevices.getUserMedia({video:!0}),this._streamSettings=this._stream.getVideoTracks()[0].getSettings(),this._psychoJS.logger.debug(`camera stream settings: ${JSON.stringify(this._streamSettings)}`),"string"==typeof this._format&&MediaRecorder.isTypeSupported(this._format)?e={type:this._format}:this._psychoJS.logger.warn(`The specified video format, ${this._format}, is not supported by this browser, using the default format instead`),this._recorder=new MediaRecorder(this._stream,e);let t=this;this._recorder.onstart=()=>{t._videoBuffer=[],t._videoBuffer.length=0,t._clock.reset(),t._status=PsychoJS.Status.STARTED,t._psychoJS.logger.debug("video recording started"),t._startCallback&&t._startCallback(t._psychoJS.monotonicClock.getTime())},this._recorder.onpause=()=>{t._status=PsychoJS.Status.PAUSED,t._psychoJS.logger.debug("video recording paused"),t._pauseCallback&&t._pauseCallback(t._psychoJS.monotonicClock.getTime())},this._recorder.onresume=()=>{t._status=PsychoJS.Status.STARTED,t._psychoJS.logger.debug("video recording resumed"),t._resumeCallback&&t._resumeCallback(t._psychoJS.monotonicClock.getTime())},this._recorder.ondataavailable=e=>{let r=e.data;t._videoBuffer.push(r),t._psychoJS.logger.debug("video data added to the buffer"),t._dataAvailableCallback&&t._dataAvailableCallback(t._psychoJS.monotonicClock.getTime())},this._recorder.onstop=()=>{t._psychoJS.logger.debug("video recording stopped"),t._status=PsychoJS.Status.NOT_STARTED,t._stopCallback&&t._stopCallback(t._psychoJS.monotonicClock.getTime()),"string"==typeof t._stopOptions.filename&&t.download(t._stopOptions.filename)},this._recorder.onerror=e=>{t._psychoJS.logger.error("video recording error: "+JSON.stringify(e)),t._status=PsychoJS.Status.ERROR}}},MovieStim=class extends VisualStim{constructor({name:e,win:t,movie:r,pos:n,units:i,ori:s,size:o,color:a,opacity:l,contrast:h,interpolate:u,flipHoriz:c,flipVert:d,loop:f,volume:p,noAudio:m,autoPlay:_,autoDraw:g,autoLog:v}={}){super({name:e,win:t,units:i,ori:s,opacity:l,pos:n,size:o,autoDraw:g,autoLog:v}),this.psychoJS.logger.debug("create a new MovieStim with name: ",e),this._addAttribute("movie",r),this._addAttribute("volume",p,1,this._onChange(!1,!1)),this._addAttribute("noAudio",m,!1,this._onChange(!1,!1)),this._addAttribute("autoPlay",_,!0,this._onChange(!1,!1)),this._addAttribute("flipHoriz",c,!1,this._onChange(!1,!1)),this._addAttribute("flipVert",d,!1,this._onChange(!1,!1)),this._addAttribute("interpolate",u,!1,this._onChange(!0,!1)),this._addAttribute("color",a,"white",this._onChange(!0,!1)),this._addAttribute("contrast",h,1,this._onChange(!0,!1)),this._addAttribute("loop",f,!1,this._onChange(!1,!1)),this._estimateBoundingBox();let y=document.createElement("video");this._hasFastSeek="function"==typeof y.fastSeek,this._autoLog&&this._psychoJS.experimentLogger.exp(`Created ${this.name} = ${this.toString()}`)}setMovie(e,t=!1){let r={origin:"MovieStim.setMovie",context:"when setting the movie of MovieStim: "+this._name};try{if(void 0===e)this.psychoJS.logger.warn(`setting the movie of MovieStim: ${this._name} with argument: undefined.`),this.psychoJS.logger.debug(`set the movie of MovieStim: ${this._name} as: undefined`);else{if("string"==typeof e?e=this.psychoJS.serverManager.getResource(e):e instanceof Camera&&(e=e.getVideo()),!(e instanceof HTMLVideoElement))throw e.toString()+" is not a video";this.psychoJS.logger.debug(`set the movie of MovieStim: ${this._name} as: src= ${e.src}, size= ${e.videoWidth}x${e.videoHeight}, duration= ${e.duration}s`),e.onended||(e.onended=()=>{this.status=PsychoJS.Status.FINISHED})}this._setAttribute("movie",e,t),this._needUpdate=!0,this._needPixiUpdate=!0}catch(e){throw Object.assign(r,{error:e})}}reset(e=!1){this.status=PsychoJS.Status.NOT_STARTED,this._movie.pause(),this.seek(0,e)}play(e=!1){this.status=PsychoJS.Status.STARTED;let t=this._movie.play();void 0!==t&&t.catch((e=>{throw{origin:"MovieStim.play",context:`when attempting to play MovieStim: ${this._name}`,error:e}}))}pause(e=!1){this.status=PsychoJS.Status.STOPPED,this._movie.pause()}stop(e=!1){this.status=PsychoJS.Status.STOPPED,this._movie.pause(),this.seek(0,e)}seek(e,t=!1){if(e<0||e>this._movie.duration)throw{origin:"MovieStim.seek",context:`when seeking to timepoint: ${e} of MovieStim: ${this._name}`,error:`the timepoint does not belong to [0, ${this._movie.duration}`};if(this._hasFastSeek)this._movie.fastSeek(e);else try{this._movie.currentTime=e}catch(t){throw{origin:"MovieStim.seek",context:`when seeking to timepoint: ${e} of MovieStim: ${this._name}`,error:t}}}_estimateBoundingBox(){let e=this._getDisplaySize();void 0!==e&&(this._boundingBox=new Rectangle(this._pos[0]-e[0]/2,this._pos[1]-e[1]/2,e[0],e[1]))}_updateIfNeeded(){if(!this._needUpdate)return;if(this._needUpdate=!1,this._needPixiUpdate){if(this._needPixiUpdate=!1,void 0!==this._pixi&&this._pixi.destroy({children:!0,texture:!0,baseTexture:!1}),this._pixi=void 0,void 0===this._movie)return;if(this._texture=Texture.from(this._movie,{resourceOptions:{autoPlay:this.autoPlay}}),this._pixi=new Sprite(this._texture),0===this._texture.width)return this._needUpdate=!0,void(this._needPixiUpdate=!0)}this._movie.muted=this._noAudio,this._movie.volume=this._volume,this._movie.loop=this._loop,this._pixi.alpha=this.opacity;let e=to_px(this._getDisplaySize(),this.units,this.win),t=e[0]/this._texture.width,r=e[1]/this._texture.height;this._pixi.scale.x=this.flipHoriz?-t:t,this._pixi.scale.y=this.flipVert?r:-r,this._pixi.position=to_pixiPoint(this.pos,this.units,this.win),this._pixi.rotation=this.ori*Math.PI/180,this._pixi.anchor.x=.5,this._pixi.anchor.y=.5,this._estimateBoundingBox()}_getDisplaySize(){let e=this.size;return void 0===e&&void 0!==this._texture&&this._texture.width>0&&(e=to_unit([this._texture.width,this._texture.height],"pix",this.win,this.units)),e}},ShapeStim=class extends(mix(VisualStim).with(ColorMixin,WindowMixin)){constructor({name:e,win:t,lineWidth:r,lineColor:n,fillColor:i,opacity:s,vertices:o,closeShape:a,pos:l,size:h,ori:u,units:c,contrast:d,depth:f,interpolate:p,autoDraw:m,autoLog:_}={}){super({name:e,win:t,units:c,ori:u,opacity:s,pos:l,depth:f,size:h,autoDraw:m,autoLog:_}),this._pixiPolygon_px=void 0,this._vertices_px=void 0,null==h&&(this.size=[1,1]),this._addAttribute("vertices",o,[[-.5,0],[0,.5],[.5,0]]),this._addAttribute("closeShape",a,!0,this._onChange(!0,!1)),this._addAttribute("interpolate",p,!0,this._onChange(!0,!1)),this._addAttribute("lineWidth",r,1.5,this._onChange(!0,!0)),this._addAttribute("lineColor",n,"white",this._onChange(!0,!1)),this._addAttribute("fillColor",i,void 0,this._onChange(!0,!1)),this._addAttribute("contrast",d,1,this._onChange(!0,!1))}setVertices(e,t=!1){let r={origin:"ShapeStim.setVertices",context:"when setting the vertices of ShapeStim: "+this._name};this._psychoJS.logger.debug("set the vertices of ShapeStim:",this.name);try{if("string"==typeof e){if(!(e in ShapeStim.KnownShapes))throw`unknown shape: ${e}`;e=ShapeStim.KnownShapes[e]}this._setAttribute("vertices",e,t),this._onChange(!0,!0)()}catch(e){throw Object.assign(r,{error:e})}}contains(e,t){let r=getPositionFromObject(e,t);if(void 0===r)throw{origin:"VisualStim.contains",context:"when determining whether VisualStim: "+this._name+" contains object: "+toString(e),error:"unable to determine the position of the object"};let n=to_px(this.pos,this.units,this.win);return this._getVertices_px(),IsPointInsidePolygon(r,this._vertices_px.map((e=>[e[0]+n[0],e[1]+n[1]])))}_estimateBoundingBox(){this._getVertices_px();let e=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(let t of this._vertices_px)e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1]);this._boundingBox=new Rectangle(this._pos[0]+this._getLengthUnits(e[0]),this._pos[1]+this._getLengthUnits(e[1]),this._getLengthUnits(e[2]-e[0]),this._getLengthUnits(e[3]-e[1]))}_updateIfNeeded(){if(this._needUpdate){if(this._needUpdate=!1,this._needPixiUpdate){if(this._needPixiUpdate=!1,void 0!==this._pixi&&this._pixi.destroy(!0),this._pixi=void 0,this._getPixiPolygon(),this._pixi=new Graphics,this._pixi.lineStyle(this._lineWidth,this._lineColor.int,this._opacity,.5),void 0!==this._fillColor&&null!==this._fillColor){let e=this.getContrastedColor(new Color(this._fillColor),this._contrast);this._pixi.beginFill(e.int,this._opacity)}this._pixi.drawPolygon(this._pixiPolygon_px),void 0!==this._fillColor&&null!==this._fillColor&&this._pixi.endFill()}this._pixi.position=to_pixiPoint(this.pos,this.units,this.win),this._pixi.rotation=this.ori*Math.PI/180}}_getPixiPolygon(){this._getVertices_px();let e=[];for(let t of this._vertices_px)e.push.apply(e,t);if(e.length>=6&&this._closeShape){let t=e.length;(e[0]!==e[t-2]||e[1]!==e[t-1])&&(e.push(e[0]),e.push(e[1]))}return this._pixiPolygon_px=new Polygon(e),this._pixiPolygon_px.closeStroke=this._closeShape,this._pixiPolygon_px}_getVertices_px(){let e=[1,1];return"_flipHoriz"in this&&this._flipHoriz&&(e[0]=-1),"_flipVert"in this&&this._flipVert&&(e[1]=-1),this._vertices_px=this._vertices.map((t=>to_px([t[0]*this._size[0]*e[0],t[1]*this._size[1]*e[1]],this._units,this._win))),this._vertices_px}};ShapeStim.KnownShapes={cross:[[-.1,.5],[.1,.5],[.1,.1],[.5,.1],[.5,-.1],[.1,-.1],[.1,-.5],[-.1,-.5],[-.1,-.1],[-.5,-.1],[-.5,.1],[-.1,.1]],star7:[[0,.5],[.09,.18],[.39,.31],[.19,.04],[.49,-.11],[.16,-.12],[.22,-.45],[0,-.2],[-.22,-.45],[-.16,-.12],[-.49,-.11],[-.19,.04],[-.39,.31],[-.09,.18]]};var Polygon2=class extends ShapeStim{constructor({name:e,win:t,lineWidth:r,lineColor:n,fillColor:i,opacity:s,edges:o,radius:a,pos:l,size:h,ori:u,units:c,contrast:d,depth:f,interpolate:p,autoDraw:m,autoLog:_}={}){super({name:e,win:t,lineWidth:r,lineColor:n,fillColor:i,opacity:s,pos:l,ori:u,size:h,units:c,contrast:d,depth:f,interpolate:p,autoDraw:m,autoLog:_}),this._psychoJS.logger.debug("create a new Polygon with name: ",e),this._addAttribute("edges",o,3),this._addAttribute("radius",a,.5),this._updateVertices(),this._autoLog&&this._psychoJS.experimentLogger.exp(`Created ${this.name} = ${this.toString()}`)}setRadius(e,t=!1){this._setAttribute("radius",e,t)&&this._updateVertices()}setEdges(e,t=!1){this._setAttribute("edges",Math.round(e),t)&&this._updateVertices()}_updateVertices(){this._psychoJS.logger.debug("update the vertices of Polygon: ",this.name);let e=2*Math.PI/this._edges,t=[];for(let r=0;r<this._edges;++r)t.push([Math.sin(r*e)*this._radius,Math.cos(r*e)*this._radius]);this.setVertices(t)}},Rect=class extends ShapeStim{constructor({name:e,win:t,lineWidth:r,lineColor:n,fillColor:i,opacity:s,width:o,height:a,pos:l,size:h,ori:u,units:c,contrast:d,depth:f,interpolate:p,autoDraw:m,autoLog:_}={}){super({name:e,win:t,lineWidth:r,lineColor:n,fillColor:i,opacity:s,pos:l,ori:u,size:h,units:c,contrast:d,depth:f,interpolate:p,autoDraw:m,autoLog:_}),this._psychoJS.logger.debug("create a new Rect with name: ",e),this._addAttribute("width",o,.5),this._addAttribute("height",a,.5),this._updateVertices(),this._autoLog&&this._psychoJS.experimentLogger.exp(`Created ${this.name} = ${this.toString()}`)}setWidth(e,t=!1){this._psychoJS.logger.debug("set the width of Rect: ",this.name,"to: ",e),this._setAttribute("width",e,t)&&this._updateVertices()}setHeight(e,t=!1){this._psychoJS.logger.debug("set the height of Rect: ",this.name,"to: ",e),this._setAttribute("height",e,t)&&this._updateVertices()}_updateVertices(){this._psychoJS.logger.debug("update the vertices of Rect: ",this.name);let e=this._width/2,t=this._height/2;this.setVertices([[-e,-t],[e,-t],[e,t],[-e,t]])}},FaceDetector=class extends VisualStim{constructor({name:e,win:t,input:r,modelDir:n,faceApiUrl:i,units:s,ori:o,opacity:a,pos:l,size:h,autoDraw:u,autoLog:c}={}){super({name:e,win:t,units:s,ori:o,opacity:a,pos:l,size:h,autoDraw:u,autoLog:c}),this._addAttribute("input",r,void 0),this._addAttribute("faceApiUrl",i,"face-api.js"),this._addAttribute("modelDir",n,"models"),this._addAttribute("autoLog",c,!1),this._addAttribute("status",PsychoJS.Status.NOT_STARTED),this._initFaceApi(),this._autoLog&&this._psychoJS.experimentLogger.exp(`Created ${this.name} = ${this.toString()}`)}isReady(){return this._modelsLoaded}setInput(e,t=!1){let r={origin:"FaceDetector.setInput",context:"when setting the video of FaceDetector: "+this._name};try{if(void 0===e)this.psychoJS.logger.warn("setting the movie of MovieStim: "+this._name+" with argument: undefined."),this.psychoJS.logger.debug("set the movie of MovieStim: "+this._name+" as: undefined");else{if("string"==typeof e||e instanceof Camera&&(e=e.getVideo()),!(e instanceof HTMLVideoElement))throw e.toString()+" is not a video";this.psychoJS.logger.debug(`set the video of FaceDetector: ${this._name} as: src= ${e.src}, size= ${e.videoWidth}x${e.videoHeight}, duration= ${e.duration}s`),e.onended||(e.onended=()=>{this.status=PsychoJS.Status.FINISHED})}this._setAttribute("input",e,t),this._needUpdate=!0,this._needPixiUpdate=!0}catch(e){throw Object.assign(r,{error:e})}}start(e,t,r=!1){this.status=PsychoJS.Status.STARTED,void 0!==this._detectionId&&(clearInterval(this._detectionId),this._detectionId=void 0),this._detectionId=setInterval((async()=>{this._detections=await faceapi.detectAllFaces(this._input,new faceapi.TinyFaceDetectorOptions).withFaceLandmarks().withFaceExpressions(),this._needUpdate=!0,this._needPixiUpdate=!0,t(this._detections)}),e)}stop(e=!1){this.status=PsychoJS.Status.NOT_STARTED,void 0!==this._detectionId&&(clearInterval(this._detectionId),this._detectionId=void 0)}async _initFaceApi(){this._modelsLoaded=!1,await faceapi.nets.tinyFaceDetector.loadFromUri(this._modelDir),await faceapi.nets.faceLandmark68Net.loadFromUri(this._modelDir),await faceapi.nets.faceRecognitionNet.loadFromUri(this._modelDir),await faceapi.nets.faceExpressionNet.loadFromUri(this._modelDir),this._modelsLoaded=!0}_updateIfNeeded(){if(this._needUpdate){if(this._needUpdate=!1,this._needPixiUpdate){this._needPixiUpdate=!1,void 0!==this._pixi&&this._pixi.destroy(!0),this._pixi=new Container,this._pixi.interactive=!0,this._body=new Graphics,this._body.interactive=!0,this._pixi.addChild(this._body);let e=to_px(this.size,this.units,this.win);if(void 0!==this._detections)for(let t of this._detections){let r=t.landmarks,n=t.alignedRect.imageWidth,i=t.alignedRect.imageHeight;for(let t of r.positions)this._body.beginFill(new Color("red").int,this._opacity),this._body.drawCircle(t._x/n*e[0]-e[0]/2,t._y/i*e[1]-e[1]/2,2),this._body.endFill()}}this._pixi.scale.x=1,this._pixi.scale.y=-1,this._pixi.rotation=this.ori*Math.PI/180,this._pixi.position=to_pixiPoint(this.pos,this.units,this.win),this._pixi.alpha=this._opacity}}_estimateBoundingBox(){}},sound_exports={};__export(sound_exports,{AudioClip:()=>AudioClip,AudioClipPlayer:()=>AudioClipPlayer,Microphone:()=>Microphone,Sound:()=>Sound2,SoundPlayer:()=>SoundPlayer,TonePlayer:()=>TonePlayer,TrackPlayer:()=>TrackPlayer});var AudioClip=class extends PsychObject{constructor({psychoJS:e,name:t,sampleRateHz:r,format:n,data:i,autoLog:s}={}){super(e),this._addAttribute("name",t,"audioclip"),this._addAttribute("format",n),this._addAttribute("sampleRateHz",r),this._addAttribute("data",i),this._addAttribute("autoLog",!1,s),this._addAttribute("status",AudioClip.Status.CREATED),this._addAttribute("volume",1),this._autoLog&&this._psychoJS.experimentLogger.exp(`Created ${this.name} = ${this.toString()}`),this._decodeAudio()}setVolume(e){this._volume=e}async startPlayback(){this._psychoJS.logger.debug("request to play the audio clip"),await this._decodeAudio(),this._source=this._audioContext.createBufferSource(),this._source.buffer=this._audioBuffer,this._gainNode=this._audioContext.createGain(),this._source.connect(this._gainNode),this._gainNode.connect(this._audioContext.destination),this._gainNode.gain.value=this._volume,this._source.start()}async stopPlayback(e=17){this._source.stop()}async getDuration(){return await this._decodeAudio(),this._audioBuffer.duration}upload(){this._psychoJS.logger.debug("request to upload the audio clip to pavlovia.org");let e=this._name+extensionFromMimeType(this._format);return this._psychoJS.getEnvironment()!==ExperimentHandler.Environment.SERVER||"RUNNING"!==this._psychoJS.config.experiment.status||this._psychoJS._serverMsg.has("__pilotToken")?this.download(e):this._psychoJS.serverManager.uploadAudioVideo({mediaBlob:this._data,tag:e})}download(e="audio.webm"){let t=document.createElement("a");t.href=window.URL.createObjectURL(this._data),t.download=e,document.body.appendChild(t),t.click(),document.body.removeChild(t)}async transcribe({engine:e,languageCode:t}={}){let r={origin:"AudioClip.transcribe",context:`when transcribing audio clip: ${this._name}`};this._psychoJS.logger.debug(r);let n,i=`sound.AudioClip.Engine.${Symbol.keyFor(e)}`;for(let e of this._psychoJS.config.experiment.keys)e.name===i&&(n=e.value);if(void 0===n)throw __spreadProps(__spreadValues({},r),{error:`missing key for engine: ${i}`});if(await this._decodeAudio(),e===AudioClip.Engine.GOOGLE)return this._GoogleTranscribe(n,t);throw __spreadProps(__spreadValues({},r),{error:`unsupported speech-to-text engine: ${e}`})}_GoogleTranscribe(e,t){return new Promise((async(r,n)=>{let i=new ArrayBuffer(2*this._audioData.length),s=new Uint16Array(i);for(let e=0;e<this._audioData.length;++e)s[e]=this._audioData[e]<0?32768*this._audioData[e]:32767*this._audioData[e];let o=this._base64ArrayBuffer(new Uint8Array(i)),a={config:{encoding:"LINEAR16",sampleRateHertz:this._sampleRateHz,languageCode:t},audio:{content:o}},l=`https://speech.googleapis.com/v1/speech:recognize?key=${e}`,h=await(await fetch(l,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).json();this._psychoJS.logger.debug("speech.googleapis.com response:",JSON.stringify(h)),"results"in h&&h.results.length>0?r(h.results[0].alternatives[0]):r({transcript:"",confidence:-1})}))}_decodeAudio(){if(this._psychoJS.logger.debug("request to decode the data of the audio clip"),this._status===AudioClip.Status.READY)return;if(this._status===AudioClip.Status.DECODING){let e=this;return new Promise(function(t,r){e._decodingCallbacks.push(t)}.bind(this))}this._status=AudioClip.Status.DECODING,this._audioData=null,this._source=null,this._gainNode=null,this._decodingCallbacks=[],this._audioContext=new(window.AudioContext||window.webkitAudioContext)({sampleRate:this._sampleRateHz});let e=new window.FileReader;e.onloadend=async()=>{try{this._audioBuffer=await this._audioContext.decodeAudioData(e.result),this._audioData=this._audioBuffer.getChannelData(0),this._status=AudioClip.Status.READY;for(let e of this._decodingCallbacks)e()}catch(e){console.error(e)}},e.onerror=e=>{},e.readAsArrayBuffer(this._data)}_base64ArrayBuffer(e){let t,r,n,i,s,o="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=new Uint8Array(e),h=l.byteLength,u=h%3,c=h-u;for(let e=0;e<c;e+=3)s=l[e]<<16|l[e+1]<<8|l[e+2],t=(16515072&s)>>18,r=(258048&s)>>12,n=(4032&s)>>6,i=63&s,o+=a[t]+a[r]+a[n]+a[i];return 1===u?(s=l[c],t=(252&s)>>2,r=(3&s)<<4,o+=`${a[t]}${a[r]}==`):2===u&&(s=l[c]<<8|l[c+1],t=(64512&s)>>10,r=(1008&s)>>4,n=(15&s)<<2,o+=`${a[t]}${a[r]}${a[n]}=`),o}};AudioClip.Engine={GOOGLE:Symbol.for("GOOGLE")},AudioClip.Status={CREATED:Symbol.for("CREATED"),DECODING:Symbol.for("DECODING"),READY:Symbol.for("READY")};var SoundPlayer=class extends PsychObject{constructor(e){super(e)}static accept(e){throw{origin:"SoundPlayer.accept",context:"when evaluating whether this player can play a given sound",error:"this method is abstract and should not be called."}}play(e){throw{origin:"SoundPlayer.play",context:"when starting the playback of a sound",error:"this method is abstract and should not be called."}}stop(){throw{origin:"SoundPlayer.stop",context:"when stopping the playback of a sound",error:"this method is abstract and should not be called."}}getDuration(){throw{origin:"SoundPlayer.getDuration",context:"when getting the duration of the sound",error:"this method is abstract and should not be called."}}setDuration(e){throw{origin:"SoundPlayer.setDuration",context:"when setting the duration of the sound",error:"this method is abstract and should not be called."}}setLoops(e){throw{origin:"SoundPlayer.setLoops",context:"when setting the number of loops",error:"this method is abstract and should not be called."}}setVolume(e,t=!1){throw{origin:"SoundPlayer.setVolume",context:"when setting the volume of the sound",error:"this method is abstract and should not be called."}}},AudioClipPlayer=class extends SoundPlayer{constructor({psychoJS:e,audioClip:t,startTime:r=0,stopTime:n=-1,stereo:i=!0,volume:s=0,loops:o=0}={}){super(e),this._addAttribute("audioClip",t),this._addAttribute("startTime",r),this._addAttribute("stopTime",n),this._addAttribute("stereo",i),this._addAttribute("loops",o),this._addAttribute("volume",s),this._currentLoopIndex=-1}static accept(e){if(e.value instanceof AudioClip)return new AudioClipPlayer({psychoJS:e.psychoJS,audioClip:e.value,startTime:e.startTime,stopTime:e.stopTime,stereo:e.stereo,loops:e.loops,volume:e.volume})}getDuration(){return this._audioClip.getDuration()}setDuration(e){throw{origin:"AudioClipPlayer.setDuration",context:"when setting the duration of the playback for audio clip player: "+this._name,error:"not implemented yet"}}setVolume(e,t=!1){this._volume=e,this._audioClip.setVolume(t?0:e)}setLoops(e){this._loops=e,this._currentLoopIndex=-1}play(e,t=17){void 0!==e&&this.setLoops(e),this._audioClip.startPlayback()}stop(e=17){this._audioClip.stopPlayback(e)}},TonePlayer=class extends SoundPlayer{constructor({psychoJS:e,note:t="C4",duration_s:r=.5,volume:n=1,loops:i=0,soundLibrary:s=TonePlayer.SoundLibrary.TONE_JS,autoLog:o=!0,wave:a="square",envelope:l={attack:.001,decay:.001,sustain:1,release:.001}}={}){super(e),this._addAttribute("note",t),this._addAttribute("duration_s",r),this._addAttribute("volume",n),this._addAttribute("loops",i),this._addAttribute("soundLibrary",s),this._addAttribute("autoLog",o),this._addAttribute("wave",a),this._addAttribute("envelope",l),this._initSoundLibrary(a,l),this._toneLoop=null,this._autoLog&&this._psychoJS.experimentLogger.exp(`Created ${this.name} = ${this.toString()}`)}static accept(e){if(isNumeric(e.value))return new TonePlayer({psychoJS:e.psychoJS,note:e.value,duration_s:e.secs,volume:e.volume,loops:e.loops,wave:e.wave,envelope:e.envelope});if("string"==typeof e.value){let t=new Map;for(let e of["A","B","C","D","E","F","G"])t.set(e,e),t.set(e+"fl",e+"b"),t.set(e+"sh",e+"#");let r=t.get(e.value);if(void 0!==r)return new TonePlayer({psychoJS:e.psychoJS,note:r+e.octave,duration_s:e.secs,volume:e.volume,loops:e.loops,wave:e.wave,envelope:e.envelope})}}getDuration(){return this.duration_s}setDuration(e){this.duration_s=e}setLoops(e){this._loops=e}setVolume(e,t=!1){this._volume=e,this._soundLibrary===TonePlayer.SoundLibrary.TONE_JS&&void 0!==this._volumeNode&&(this._volumeNode.mute=t,this._volumeNode.volume.value=66*e-60)}play(e){void 0!==e&&(this._loops=e);let t,r=-1===this._duration_s?1e6:this._duration_s,n=this;t=this._soundLibrary===TonePlayer.SoundLibrary.TONE_JS?()=>{n._synth.triggerAttackRelease(n._note,r,context3.currentTime)}:()=>{n._webAudioOscillator=n._audioContext.createOscillator(),n._webAudioOscillator.type="sine",n._webAudioOscillator.frequency.value=440,n._webAudioOscillator.connect(n._audioContext.destination);let e=n._audioContext.currentTime;n._webAudioOscillator.start(e),n._webAudioOscillator.stop(e+r)},0===this.loops?t():-1===this.loops?this._toneId=Transport2.scheduleRepeat(t,this.duration_s,now(),1/0):this._toneId=Transport2.scheduleRepeat(t,this.duration_s,now(),this.duration_s*(this._loops+1))}stop(){if(this._soundLibrary===TonePlayer.SoundLibrary.TONE_JS)this._synth.triggerRelease(),this._toneId&&Transport2.clear(this._toneId);else{let e=this._audioContext.currentTime;this._webAudioOscillator.stop(e)}}_initSoundLibrary(e,t){let r={origin:"TonePlayer._initSoundLibrary",context:"when initialising the sound library"};if(this._soundLibrary===TonePlayer.SoundLibrary.TONE_JS){if(void 0===esm_exports)throw Object.assign(r,{error:"Tone.js is not available. A different sound library must be selected. Please contact the experiment designer."});void 0!==esm_exports&&"started"!==Transport2.state&&(this.psychoJS.logger.info("[PsychoJS] start Tone Transport"),Transport2.start(now()),context3.lookAhead=0),this._synthOtions={oscillator:{type:e},envelope:t},this._synth=new Synth(this._synthOtions),this._volumeNode=new Volume(66*this._volume-60),this._synth.connect(this._volumeNode),"function"==typeof this._volumeNode.toDestination?this._volumeNode.toDestination():this._volumeNode.toMaster()}else if(void 0===this._audioContext){let e=window.AudioContext||window.webkitAudioContext;if(void 0===e)throw Object.assign(r,{error:`AudioContext is not available on your browser, ${this._psychoJS.browser}, please contact the experiment designer.`});this._audioContext=new e}}};TonePlayer.SoundLibrary={AUDIO_CONTEXT:Symbol.for("AUDIO_CONTEXT"),TONE_JS:Symbol.for("TONE_JS")};var TrackPlayer=class extends SoundPlayer{constructor({psychoJS:e,howl:t,startTime:r=0,stopTime:n=-1,stereo:i=!0,volume:s=0,loops:o=0}={}){super(e),this._addAttribute("howl",t),this._addAttribute("startTime",r),this._addAttribute("stopTime",n),this._addAttribute("stereo",i),this._addAttribute("loops",o),this._addAttribute("volume",s),this._currentLoopIndex=-1}static accept(e){if("string"==typeof e.value){let t=e.psychoJS.serverManager.getResource(e.value);if(void 0!==t)return new TrackPlayer({psychoJS:e.psychoJS,howl:t,startTime:e.startTime,stopTime:e.stopTime,stereo:e.stereo,loops:e.loops,volume:e.volume})}}getDuration(){return this._howl.duration()}setDuration(e){void 0!==this._howl&&(this._howl._duration=e)}setVolume(e,t=!1){this._volume=e,this._howl.volume(e),this._howl.mute(t)}setLoops(e){this._loops=e,this._currentLoopIndex=-1,0===e?this._howl.loop(!1):this._howl.loop(!0)}play(e,t=17){if(void 0!==e&&this.setLoops(e),e>0){let e=this;this._howl.on("end",(r=>{++this._currentLoopIndex,e._currentLoopIndex>e._loops?e.stop():(e._howl.seek(e._startTime),e._id=e._howl.play(),e._howl.fade(0,e._volume,t,e._id))}))}this._howl.seek(this._startTime),this._id=this._howl.play(),this._howl.fade(0,this._volume,t,this._id)}stop(e=17){this._howl.once("fade",(e=>{this._howl.stop(e),this._howl.off("end")})),this._howl.fade(this._howl.volume(),0,e,this._id)}},Sound2=class extends PsychObject{constructor({name:e,win:t,value:r="C",octave:n=4,secs:i=.5,startTime:s=0,stopTime:o=-1,stereo:a=!0,volume:l=1,loops:h=0,autoLog:u=!0}={}){super(t._psychoJS,e),this._player=void 0,this._addAttribute("win",t),this._addAttribute("value",r),this._addAttribute("octave",n),this._addAttribute("secs",i),this._addAttribute("startTime",s),this._addAttribute("stopTime",o),this._addAttribute("stereo",a),this._addAttribute("volume",l),this._addAttribute("loops",h),this._addAttribute("autoLog",u),this._getPlayer(),this.status=PsychoJS.Status.NOT_STARTED}play(e,t=!0){this.status=PsychoJS.Status.STARTED,this._player.play(e)}stop({log:e=!0}={}){this._player.stop(),this.status=PsychoJS.Status.STOPPED}getDuration(){return this._player.getDuration()}setVolume(e,t=!1,r=!0){this._setAttribute("volume",e,r),void 0!==this._player&&this._player.setVolume(e,t)}setSound(e,t=!0){if(e instanceof Sound2)return this._setAttribute("value",e.value,t),void 0!==this._player&&(this._player=this._player.constructor.accept(this)),this;throw{origin:"Sound.setSound",context:"when replacing the current sound",error:"invalid input, need an instance of the Sound class."}}setLoops(e=0,t=!0){this._setAttribute("loops",e,t),void 0!==this._player&&this._player.setLoops(e)}setSecs(e=.5,t=!0){this._setAttribute("secs",e,t),void 0!==this._player&&this._player.setDuration(e)}_getPlayer(){let e=[e=>TonePlayer.accept(e),e=>TrackPlayer.accept(e),e=>AudioClipPlayer.accept(e)];for(let t of e)if(this._player=t(this),void 0!==this._player)return this._player;throw{origin:"SoundPlayer._getPlayer",context:"when finding a player for the sound",error:"could not find an appropriate player."}}},Microphone=class extends PsychObject{constructor({win:e,name:t,format:r,sampleRateHz:n,clock:i,autoLog:s}={}){super(e._psychoJS),this._addAttribute("win",e,void 0),this._addAttribute("name",t,"microphone"),this._addAttribute("format",r,"audio/webm;codecs=opus",this._onChange),this._addAttribute("sampleRateHz",n,48e3,this._onChange),this._addAttribute("clock",i,new Clock),this._addAttribute("autoLog",s,s),this._addAttribute("status",PsychoJS.Status.NOT_STARTED),this._prepareRecording(),this._autoLog&&this._psychoJS.experimentLogger.exp(`Created ${this.name} = ${this.toString()}`)}start(){if(this._status===PsychoJS.Status.PAUSED)return this.resume({clear:!0});if(this._status!==PsychoJS.Status.STARTED){this._psychoJS.logger.debug("request to start audio recording");try{if(!this._recorder)throw"the recorder has not been created yet, possibly because the participant has not given the authorisation to record audio";this._recorder.start();let e=this;return new Promise(((t,r)=>{e._startCallback=t,e._errorCallback=r}))}catch(e){throw this._psychoJS.logger.error("unable to start the audio recording: "+JSON.stringify(e)),this._status=PsychoJS.Status.ERROR,{origin:"Microphone.start",context:"when starting the audio recording for microphone: "+this._name,error:e}}}}stop({filename:e}={}){if(this._status===PsychoJS.Status.STARTED||this._status===PsychoJS.Status.PAUSED){this._psychoJS.logger.debug("request to stop audio recording"),this._stopOptions={filename:e},this._recorder.stop();let t=this;return new Promise(((e,r)=>{t._stopCallback=e,t._errorCallback=r}))}}pause(){if(this._status===PsychoJS.Status.STARTED){this._psychoJS.logger.debug("request to pause audio recording");try{if(!this._recorder)throw"the recorder has not been created yet, possibly because the participant has not given the authorisation to record audio";this._recorder.pause();let e=this;return new Promise(((t,r)=>{e._pauseCallback=t,e._errorCallback=r}))}catch(e){throw self._psychoJS.logger.error("unable to pause the audio recording: "+JSON.stringify(e)),this._status=PsychoJS.Status.ERROR,{origin:"Microphone.pause",context:"when pausing the audio recording for microphone: "+this._name,error:e}}}}resume({clear:e=!1}={}){if(this._status===PsychoJS.Status.PAUSED){this._psychoJS.logger.debug("request to resume audio recording");try{if(!this._recorder)throw"the recorder has not been created yet, possibly because the participant has not given the authorisation to record audio";e&&(this._audioBuffer=[],this._audioBuffer.length=0),this._recorder.resume();let t=this;return new Promise(((e,r)=>{t._resumeCallback=e,t._errorCallback=r}))}catch(e){throw self._psychoJS.logger.error("unable to resume the audio recording: "+JSON.stringify(e)),this._status=PsychoJS.Status.ERROR,{origin:"Microphone.resume",context:"when resuming the audio recording for microphone: "+this._name,error:e}}}}flush(){if(this._status===PsychoJS.Status.STARTED||this._status===PsychoJS.Status.PAUSED){this._psychoJS.logger.debug("request to flush audio recording"),this._recorder.requestData();let e=this;return new Promise(((t,r)=>{e._dataAvailableCallback=t,e._errorCallback=r}))}}download(e="audio.webm"){let t=new Blob(this._audioBuffer),r=document.createElement("a");r.href=window.URL.createObjectURL(t),r.download=e,document.body.appendChild(r),r.click(),document.body.removeChild(r)}async upload({tag:e}={}){if(void 0===e&&(e=this._name),e+=extensionFromMimeType(this._format),this._psychoJS.getEnvironment()!==ExperimentHandler.Environment.SERVER||"RUNNING"!==this._psychoJS.config.experiment.status||this._psychoJS._serverMsg.has("__pilotToken"))return this.download(e);let t=new Blob(this._audioBuffer);return this._psychoJS.serverManager.uploadAudioVideo({mediaBlob:t,tag:e})}async getRecording({tag:e,flush:t=!1}={}){return void 0===e&&(e=this._name),new AudioClip({psychoJS:this._psychoJS,name:e,format:this._format,sampleRateHz:this._sampleRateHz,data:new Blob(this._audioBuffer)})}_onChange(){this._status===PsychoJS.Status.STARTED&&this.stop(),this._prepareRecording(),this.start()}async _prepareRecording(){this._audioBuffer=[],this._recorder=null;let e,t=await navigator.mediaDevices.getUserMedia({audio:{advanced:[{channelCount:1,sampleRate:this._sampleRateHz}]}});"string"==typeof this._format&&MediaRecorder.isTypeSupported(this._format)?e={type:this._format}:this._psychoJS.logger.warn(`The specified audio format, ${this._format}, is not supported by this browser, using the default format instead`),this._recorder=new MediaRecorder(t,e);let r=this;this._recorder.onstart=()=>{r._audioBuffer=[],r._audioBuffer.length=0,r._clock.reset(),r._status=PsychoJS.Status.STARTED,r._psychoJS.logger.debug("audio recording started"),r._startCallback&&r._startCallback(r._psychoJS.monotonicClock.getTime())},this._recorder.onpause=()=>{r._status=PsychoJS.Status.PAUSED,r._psychoJS.logger.debug("audio recording paused"),r._pauseCallback&&r._pauseCallback(r._psychoJS.monotonicClock.getTime())},this._recorder.onresume=()=>{r._status=PsychoJS.Status.STARTED,r._psychoJS.logger.debug("audio recording resumed"),r._resumeCallback&&r._resumeCallback(r._psychoJS.monotonicClock.getTime())},this._recorder.ondataavailable=e=>{let t=e.data;r._audioBuffer.push(t),r._psychoJS.logger.debug("audio data added to the buffer"),r._dataAvailableCallback&&r._dataAvailableCallback(r._psychoJS.monotonicClock.getTime())},this._recorder.onstop=()=>{r._psychoJS.logger.debug("audio recording stopped"),r._status=PsychoJS.Status.NOT_STARTED,r._stopCallback&&r._stopCallback(r._psychoJS.monotonicClock.getTime()),"string"==typeof r._stopOptions.filename&&r.download(r._stopOptions.filename)},this._recorder.onerror=e=>{r._psychoJS.logger.error("audio recording error: "+JSON.stringify(e)),r._status=PsychoJS.Status.ERROR}}}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](r,r.exports,__webpack_require__),r.exports}__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};(()=>{var e=__webpack_require__(453),t=__webpack_require__(407);const r=e=>{if(!e.length)return[];const t=[...e];for(var r,n=t.length;0!=n;)r=Math.floor(Math.random()*n),n--,[t[n],t[r]]=[t[r],t[n]];return t},n=()=>{document.body.classList.add("hide-cursor")},i=(e,t)=>{if(Math.abs(e)>90)throw new Error("To large of an angle (ie > 90 deg) specified for this method of transfering between angles and pixels.");const r=Math.abs(e)*(Math.PI/180);return t.pixPerCm*t.viewingDistanceCm*Math.tan(r)},s=(e,t)=>{if(0==e.length)return;const r=[];return e.forEach((e=>{e[0]=e[0]-t.nearPointXYDeg.x,e[1]=e[1]-t.nearPointXYDeg.y;const n=Math.sqrt(e[0]**2+e[1]**2),s=i(n,t);let o=[];o=n>0?[e[0]*s/n,e[1]*s/n]:[0,0],o[0]=o[0]+t.nearPointXYPix.x,o[1]=o[1]+t.nearPointXYPix.x,r.push(o)})),r},o=(e,t,r=[])=>{for(const[n,i]of Object.entries(t))r.includes(n)||e.addData(n,i)},a={EE_languageNameEnglish:{"en-US":"English",de:"German",pl:"Polish",fr:"French",es:"Spanish",pt:"Portuguese",it:"Italian",ro:"Romanian",ru:"Russian",he:"Hebrew",hy:"Armenian",ar:"Arabic",ur:"Urdu",hi:"Hindi",bn:"Bangla",id:"Indonesian","zh-CN":"Chinese (Simplified)","zh-HK":"Chinese (Traditional)",ja:"Japanese",ko:"Korean",fi:"Finnish",ta:"Tamil",ml:"Malayalam",te:"Telugu",kn:"Kannada"},EE_languageNameNative:{"en-US":"English",de:"Deutsch",pl:"Polskie",fr:"franais",es:"Espaol",pt:"portugus",it:"italiano",ro:"Romn",ru:"",he:"",hy:"",ar:"",ur:"",hi:"",bn:"",id:"Bahasa Indonesia","zh-CN":"","zh-HK":"",ja:"",ko:"",fi:"Suomalainen",ta:"",ml:"",te:"",kn:""},EE_languageDirection:{"en-US":"LTR",de:"LTR",pl:"LTR",fr:"LTR",es:"LTR",pt:"LTR",it:"LTR",ro:"LTR",ru:"LTR",he:"RTL",hy:"LTR",ar:"RTL",ur:"RTL",hi:"LTR",bn:"LTR",id:"LTR","zh-CN":"LTR","zh-HK":"LTR",ja:"LTR",ko:"LTR",fi:"LTR",ta:"LTR",ml:"LTR",te:"LTR",kn:"LTR"},EE_languageFont:{"en-US":"Noto Serif",de:"Noto Serif",pl:"Noto Serif",fr:"Noto Serif",es:"Noto Serif",pt:"Noto Serif",it:"Noto Serif",ro:"Noto Serif",ru:"Noto Serif",he:"Noto Serif Hebrew",hy:"Noto Serif Armenian",ar:"Noto Kufi Arabic",ur:"Noto Nastaliq Urdu",hi:"Noto Serif Devanagari ",bn:"Noto Serif Bengali",id:"Noto Serif","zh-CN":"Noto Serif SC","zh-HK":"Noto Serif TC",ja:"Noto Serif JP",ko:"Noto Serif KR",fi:"Noto Serif",ta:"Noto Serif Tamil",ml:"Noto Serif Malayalam",te:"Noto Serif Telugu",kn:"Noto Serif Kannada"},EE_phraseSource:{"en-US":"Denis Pelli & Peiling Jiang 2021.10.10; 2021.10.14",de:"Google Translate from English 2021.10.10",pl:"Google Translate from English 2021.10.10",fr:"Google Translate from English 2021.10.10; Denis Pelli 2021.10.7",es:"Google Translate from English 2021.10.10; Denis Pelli 2021.10.15",pt:"Google Translate from English",it:"Google Translate from English; Marialuisa Martelli 2021.10.12",ro:"Google Translate from English",ru:"Google Translate from English",he:"Google Translate from English",hy:"Google Translate from English",ar:"Google Translate from English; Marianne Azar 2021.10.7",ur:"Google Translate from English",hi:"Google Translate from English; Mrugank Dake and Ajay Subramanian 2021.10.14",bn:"Google Translate from English",id:"Google Translate from English","zh-CN":"Google Translate from English; Elizabeth Zhou 2021.10.13","zh-HK":"Google Translate from Simplified Chinese 2021.10.13",ja:"Google Translate from English",ko:"Google Translate from English",fi:"Google Translate from English",ta:"Google Translate from English",ml:"Google Translate from English",te:"Google Translate from English",kn:"Google Translate from English"},T_thresholdTitle:{"en-US":"Welcome to EasyEyes Threshold.",de:"Willkommen bei Easyeyes-Schwellenwert.",pl:"Witamy w progu Easyeyes.",fr:"Bienvenue dans le seuil EasyEyes.",es:"Bienvenido a EasyEyes Threshold.",pt:"Bem-vindo ao limiar de easyeyes.",it:"Benvenuto in EasyEyes Threshold.",ro:"Bine ai venit la Pragul EasyEyes.",ru:"    Easheyes.",he:"   easyyes.",hy:"  EasyEyes :",ar:"   EasyEyes Threshold.",ur:"Easyeyes threshold   .",hi:"EasyEyes     \n",bn:"Esseyes  ",id:"Selamat datang di ambang EasyEyes.","zh-CN":" EasyEyes Threshold","zh-HK":" EasyEyes Threshold",ja:"EasyEyes",ko:"EasyEyes     .",fi:"Tervetuloa EasyEyes kynnysarvoon.",ta:"Easyeyes  .",ml:"  .",te:"Elegeyes  .",kn:"Easyeyes  ."},T_participant:{"en-US":"Participant",de:"Teilnehmer",pl:"Uczestnik",fr:"Participant",es:"Partcipante",pt:"Participante",it:"Partecipante",ro:"Participant",ru:"",he:"",hy:"",ar:"",ur:"",hi:"  ",bn:"",id:"Peserta","zh-CN":"","zh-HK":"",ja:"",ko:"",fi:"Osallistuja",ta:"",ml:"",te:"",kn:""},T_session:{"en-US":"Session",de:"Sitzung",pl:"Sesja",fr:"Session",es:"Sesin",pt:"Sesso",it:"Sessione",ro:"Sesiune",ru:"",he:"",hy:"",ar:"",ur:"",hi:"",bn:"",id:"Sidang","zh-CN":"","zh-HK":"",ja:"",ko:"",fi:"Istunto",ta:"",ml:"",te:"",kn:""},T_ok:{"en-US":"OK",de:"OK",pl:"OK",fr:"OK",es:"OK",pt:"OK",it:"OK",ro:"OK",ru:"Ok",he:"",hy:"",ar:"",ur:" ",hi:" ",bn:" ",id:"oke","zh-CN":"","zh-HK":"",ja:"",ko:"",fi:"Ok",ta:"",ml:"",te:"",kn:""},T_cancel:{"en-US":"Cancel",de:"Abbrechen",pl:"Anulowa",fr:"Annuler",es:"Cancelar",pt:"Cancelar",it:"Annulla",ro:"Anulare",ru:"",he:"",hy:"",ar:"",ur:"",hi:" ",bn:" ",id:"Membatalkan","zh-CN":"","zh-HK":"",ja:"",ko:"",fi:"Peruuttaa",ta:"",ml:"",te:" ",kn:""},T_beep:{"en-US":"Beep",de:"Piepton",pl:"Brzczyk",fr:"Bip",es:"Bip",pt:"Bip",it:"Segnale acustico",ro:"Bip",ru:"",he:"",hy:"",ar:"Beep",ur:"",hi:"",bn:"",id:"Bip","zh-CN":"","zh-HK":"",ja:"",ko:"  ",fi:"Piippaus",ta:"",ml:"",te:"",kn:" "},T_counterTrialBlock:{"en-US":"Trial xx1 of xx2. Block xx3 of xx4.",de:"Testversion xx1 von xx2. Block xx3 von xx4.",pl:"Prba xx1 z xx2. Blok xx3 z xx4.",fr:"Essai xx1 de xx2. Bloc xx3 de xx4.",es:"Prueba xx1 de xx2. Bloque xx3 de xx4.",pt:"Teste xx1 de xx2. Bloco xx3 de xx4.",it:"Prova xx1 di xx2. Blocco xx3 di xx4.",ro:"Test xx1 din xx2. Blocai xx3 din xx4.",ru:" xx1  xx2.  xx3  xx4.",he:" xx1  xx2.  xx3  xx4.",hy:" xx1-  xx2.  xx3-  xx4- :",ar:" xx1  xx2.  xx3  xx4.",ur:"xx2   xx1 xx4  xx3  ",hi:"xx2  xx1  xx4  xx3 ",bn:"xx2   xx1 xx4  xx3  ",id:"Percobaan xx1 dari xx2. Blok xx3 dari xx4.","zh-CN":"xx1xx2 xx3xx4","zh-HK":"xx1xx2xx3xx4",ja:"xx2xx1 xx4xx3",ko:"xx2 xx1 . xx4 xx3 .",fi:"xx2: n kokeilu XX1. Lohko XX3 XX4.",ta:"xx2  XX1. XX4  XX3  .",ml:"xx2   XX1. XX4-  xx3 .",te:"xx2   XX1. XX4  XX3   .",kn:"xx2   xx1. XX4   XX3."},T_counterCm:{"en-US":" At xxx cm.",de:" Bei xxx cm.",pl:" Na xxx cm.",fr:"  xxx cm.",es:" A xxx cm.",pt:" Em xxx cm.",it:" A xxx cm.",ro:" La xxx cm.",ru:"   .",he:'  xxx ".',hy:" xxx  -:",ar:"  xxx ..",ur:" xxx   ",hi:" xxx . ",bn:" xxx ",id:" Pada xxx cm.","zh-CN":" xxx ","zh-HK":" xxx ",ja:"xxx cm",ko:" xxx cm .",fi:" Xxx cm.",ta:" xxx ..",ml:" xxx .",te:" xxx ..",kn:" xxx  ."},T_thresholdSoundCheck:{"en-US":"Hello xxx. Please make sure this computer's sound is working by clicking the Beep button. By the way, you'll hear a beep like that every time you get a trial right.",de:"Hallo xxx. Bitte vergewissern Sie sich, dass der Sound dieses Computers funktioniert, indem Sie auf die Schaltflche Piepton klicken. brigens, Sie werden jedes Mal einen solchen Piepton hren, wenn Sie eine Testversionen richtig machen.",pl:"Witam xxx. Upewnij si, e dwik tego komputera dziaa, klikajc przycisk Beep. Nawiasem mwic, usyszysz taki sygna dwikowy za kadym razem, gdy uzyskasz prawidow wersj prbn.",fr:"Bonjour xxx. Veuillez vous assurer que le son de cet ordinateur est activ en cliquant sur le bouton Bip. Au fait, vous entendrez un bip comme celui-ci  chaque fois que vous russirez un essai.",es:"Hola xxx. Asegrese de que el sonido de esta computadora funciona haciendo clic en el botn Bip. Despues, oir un pitido como ese cada vez que realice una prueba correctamente.",pt:"Hello xxx. Certifique-se de que o som do computador esteja funcionando clicando no boto Beep. A propsito, voc ouvir um bipe assim toda vez que acertar um teste.",it:"Ciao xxx. Assicurati che il suono di questo computer funzioni facendo clic sul pulsante BEEP. A proposito, sentirai un segnale acustico come ogni volta che ottieni un processo di prova.",ro:"Buna xxx. Asigurai-v c sunetul acestui computer este activat fcnd clic pe butonul Bip. Vei auzi un astfel de semnal sonor de fiecare dat cnd obinei un test corect.",ru:" . ,      ,    .  ,        ,    .",he:" xxx.            . ,         .",hy:" xxx: ,         Beep :  ,  ,     ,    :",ar:" xxx.            (Beep).             .",ur:" xxx.                                       ",hi:" xxx                  ,      ,        ",bn:" xxx             ,             ",id:"Halo xxx. Pastikan suara komputer ini berfungsi dengan mengklik tombol Bip. Omong-omong, Anda akan mendengar bunyi bip seperti itu setiap kali Anda melakukan percobaan dengan benar.","zh-CN":"xxx","zh-HK":"xxx",ja:"xxx",ko:" xxx.        .  ,         .",fi:"Hei xxx. Varmista, ett tmn tietokoneen ni toimii klikkaamalla Beep-painiketta. Muuten kuulet piippauksen, joka aina kun saat oikeudenkynnin oikein.",ta:" xxx. Beep          . ,          .",ml:" xxx.         .         .",te:" xxx.             .  ,           .",kn:" xxx.            . ,          ."},T_thresholdBeginBlock:{"en-US":"You are about to begin a block of xxx trials. Each trial will present three letters, like this: Z R N. Please report just the middle letter, ",de:"Sie sind dabei, einen Block von xxx-Testversionen zu beginnen. Jeder Versuch enthlt drei Buchstaben, wie z. B.: Z R N. Bitte melden Sie nur den mittleren Buchstaben,",pl:"Za chwil rozpoczniesz blok xxx prb. Kada prba bdzie przedstawia trzy litery, takie jak: Z R N. Prosz poda tylko rodkow liter,",fr:"Vous tes sur le point de commencer un bloc d'essais xxx. Chaque essai prsentera trois lettres, comme ceci : Z R N. Veuillez ne signaler que la lettre du milieu,",es:"Est a punto de comenzar un bloque de xxx pruebas. Cada ensayo presentar tres letras, asi: Z R N. Por favor, informe solo la letra del medio,",pt:"Voc est prestes a iniciar um bloco de testes xxx. Cada julgamento apresentar trs letras, assim: Z R N. Por favor, relate apenas a letra do meio,",it:"Stai per iniziare un blocco di xxx prove. Ogni prova presenter tre lettere, in questo modo: Z R N. Devi riportare solo la lettera centrale,",ro:"Eti pe cale s ncepi un bloc de probe xxx. Fiecare proces va prezenta trei scrisori, ca aceasta: Z R N. V rugm s raportai doar litera de mijloc,",ru:"      .       , : Z R N. ,    ,",he:"      xxx.     , : Z R N.      ,",hy:"    xxx  :     , . Z R N.      ,",ar:"       xxx.         : Z R N.       ",ur:" xxx                  : Z R N.         \n",hi:" xxx              , : Z R N.       ,",bn:" xxx            , :   ",id:"Anda akan memulai satu blok percobaan xxx. Setiap sidang akan menampilkan tiga huruf, seperti ini: Z R N. Tolong laporkan huruf tengah saja,","zh-CN":"xxxZ R N","zh-HK":"xxxZ R N",ja:"xxx3ZRN",ko:"xxx    .       . Z R N.   .",fi:"Aiot aloittaa xxx-kokeiden lohkon. Jokainen oikeudenkynti esitelln kolme kirjainta, kuten tm: z r N. Ilmoita vain keskimminen kirjain,",ta:" xxx     .     ,  : Z R N.    ,",ml:" xxx     .     :  R N.    ,",te:" xxx    .      : z r N.    ,",kn:" xxx    .     ,  : z r n.      ,"},T_guessingGame:{"en-US":"Sometimes the letter will be easy to identify. Sometimes nearly impossible. You can't get much more than half right, so relax. Think of it as a guessing game, and just get as many as you can. (Quit anytime by pressing ESCAPE.)",de:"Manchmal ist der Buchstabe leicht zu identifizieren. Manchmal fast unmglich. Sie knnen nicht viel mehr als die Hlfte richtig machen, also entspannen Sie sich. Betrachten Sie es als Ratespiel und holen Sie sich so viele wie mglich. (Beenden Sie jederzeit mit ESCAPE.)",pl:"Czasami list bdzie atwy do zidentyfikowania. Czasami prawie niemoliwe. Nie moesz uzyska wicej ni poowy racji, wic zrelaksuj si. Pomyl o tym jako o grze w zgadywanie i po prostu zdobd jak najwicej. (Zakocz w dowolnym momencie, naciskajc ESCAPE.)",fr:"Parfois, la lettre sera facile  identifier. Parfois presque impossible. Vous ne pouvez pas avoir plus qu' moiti raison, alors dtendez-vous. Considrez-le comme un jeu de devinettes et obtenez-en autant que vous le pouvez. (Quittez  tout moment en appuyant sur CHAP.)",es:"A veces, la letra ser fcil de identificar. A veces casi imposible. No puede acertar mucho ms de la mitad, as que reljese. Tome esto como un juego de adivinanzas y obtenga tantos como pueda. (Puede terminar en cualquier momento presionando ESCAPE).",pt:"s vezes, a carta ser fcil de identificar. s vezes quase impossvel. Voc no consegue acertar muito mais do que a metade, ento relaxe. Pense nisso como um jogo de adivinhao e pegue o mximo que puder. (Saia a qualquer momento pressionando ESCAPE.)",it:"A volte la lettera sar facile da identificare. A volte quasi impossibile. Non puoi riconoscerne molto pi della met, quindi rilassati. Pensalo come un gioco di ipotesi e prova a riconoscerne il pi possibile. (Puoi uscire in qualsiasi momento premendo ESCAPE.)",ro:"Uneori scrisoarea va fi uor de identificat. Uneori aproape imposibil. Nu poi avea mult mai mult de jumtate dreptate, deci relaxeaz-te. Gndii-v la el ca la un joc de ghicit i obinei ct mai multe posibil. (Renunai oricnd apsnd ESCAPE.)",ru:"    .   .     ,  ,   .              . (   ,  ESCAPE.)",he:"     .    .        ,  .      ,     . (       ESCAPE.)",hy:"    :    :       ,   :        ,   : (      ESCAPE):",ar:"        .       .            .            . (          ESCAPE.)",ur:"             nearly                             (   ESCAPE   )",hi:"-      -          ,             ,                 \n",bn:"                 ,          ,       (ESCAPE     )",id:"Terkadang surat itu akan mudah dikenali. Terkadang hampir mustahil. Anda tidak bisa mendapatkan lebih dari setengah benar, jadi santai. Anggap saja sebagai permainan tebak-tebakan, dan dapatkan sebanyak mungkin. (Berhenti kapan saja dengan menekan ESCAPE.)","zh-CN":"Esc","zh-HK":" Esc",ja:" ESCAPE",ko:"    .   .       .       . ( ESCAPE  .)",fi:"Joskus kirjain on helppo tunnistaa. Joskus lhes mahdotonta. Et voi saada paljon yli puolet oikealle, niin rentoudu. Ajattele sit arvauspelin, ja vain saat niin paljon kuin voit. (Lopeta milloin tahansa painamalla paeta.)",ta:"     .    .       ,  .      ,      . (     .)",ml:"   .   .    ,  .   ess   ,   . (    .)",te:"    .   .     ,  .    ,      . (  .)",kn:"   .  .     ,  .   ,      . (     .)"},T_middleLetterDemo:{"en-US":"On each trial, while you look at the crosshair, three random letters will appear briefly in the corner of your eye. Lets try it now. While you look at the crosshair, without moving your eyes, try to identify the middle letter.",de:"Bei jeder Studie werden drei zufllige Buchstaben in der Ecke Ihres Auges drei zufllige Buchstaben in der Ecke angezeigt. Lass es uns jetzt ausprobieren. Whrend Sie den Fadenkreuz ansehen, ohne Ihre Augen zu bewegen, versuchen Sie, den mittleren Brief zu identifizieren.",pl:"Na kadym procesie, podczas gdy patrzysz na Crosshair, trzy losowe litery pojawi si krtko w rogu oka. Sprbujmy teraz. Podczas gdy patrzysz na Crosshair, bez przenoszenia oczu, sprbuj zidentyfikowa rodkow liter.",fr:" chaque essai, pendant que vous regardez le rticule, trois lettres alatoires apparatront brivement dans le coin de votre il. Essayons-le maintenant. Pendant que vous regardez le crosshair, sans bouger vos yeux, essayez d'identifier la lettre moyenne.",es:"En cada prueba, mientras mira la cruz, tres letras al azar aparecern brevemente en la esquina de su ojo. Vamos a intentarlo ahora. Mientras mira la cruz, sin mover los ojos, intente identificar la letra central.",pt:"Em cada julgamento, enquanto voc olha para a cruz, trs cartas aleatrias aparecero brevemente no canto do seu olho. Vamos tentar agora. Enquanto voc olha para a cruz, sem mover os olhos, tente identificar a carta do meio.",it:"Su ogni prova, mentre guardi il crosshair, tre lettere casuali appariranno brevemente nell'angolo del tuo occhio. Proviamo ora. Mentre guardi il crosshair, senza spostare gli occhi, prova a identificare la lettera centrale.",ro:"La fiecare proces, n timp ce v uitai la crosioarea, trei litere aleatoare vor aprea pe scurt n colul ochiului. S ncercm acum. n timp ce v uitai la Crosshair, fr s v micai ochii, ncercai s identificai scrisoarea de mijloc.",ru:"  ,     ,         .    .     ,   ,    .",he:"  ,     ,        .     .     crosshair,    ,     .",hy:"  ,     ,        :  :     ,    ,    :",ar:"       Crosshair         .    .     crosshair       .",ur:"     crosshair                   .   .                        .",hi:"  ,      ,                             ,         ",bn:" ,    ,                  ,  ,      ",id:"Pada setiap percobaan, saat Anda melihat crossma, tiga huruf acak akan muncul sebentar di sudut mata Anda. Mari kita coba sekarang. Saat Anda melihat crossma, tanpa memindahkan mata Anda, cobalah untuk mengidentifikasi huruf tengah.","zh-CN":"","zh-HK":"",ja:"3",ko:"            .    .          .",fi:"Jokaisesta oikeudenkynnist, kun tarkastelet CrossHairia, nkyy kolme satunnaista kirjainta lyhyesti silmsi nurkassa. Yritetn nyt. Kun katsot ristikkit, siirtmtt silmsi, yrit tunnistaa keskimminen kirjain.",ta:" ,  Crosshair   ,        .    .   ,  crosshair   ,     .",ml:" ,   ,        .   .          .",te:" ,    ,        .   .    ,   ,    .",kn:" ,   ,        .   .      ,    ."},T_middleLetterBrief:{"en-US":"Its an R. This display is static, so it would be easy to move your eye to the letter and identify it. In a real trial the letters will be brief, so you won't have time to move your eyes.",de:"Es ist ein R. Dieses Display ist statisch, so dass es leicht wre, Ihr Auge auf den Buchstaben zu bewegen und ihn zu identifizieren. In einem echten Test werden die Buchstaben kurz, also haben Sie keine Zeit, um Ihre Augen zu bewegen.",pl:"To jest R. Ten wywietlacz jest statyczny, wic atwo byoby przenie swoje oko do listu i zidentyfikowa go. W prawdziwym procesie litery bd krtkie, wic nie bdziesz mia czasu, aby przenie oczy.",fr:"C'est un R. Cet affichage est statique, il serait donc facile de dplacer votre attention sur la lettre et de l'identifier. Dans un vritable essai, les lettres seront brimes, vous n'aurez donc pas le temps de vous dplacer les yeux.",es:"Es una R. Esta pantalla es esttica, por lo que sera fcil mover sus ojos a la letra y identificarla. En un ensayo real, las letras sern breves, por lo que no tendr tiempo para mover los ojos.",pt:" um R. Esta tela  esttica, ento seria fcil mover o olho para a carta e identific-lo. Em um teste real, as letras sero breves, ento voc no ter tempo para mover os olhos.",it:" un R. Questo display  statico, quindi sarebbe facile muovere gli occhi alla lettera e identificarlo. In un vero processo le lettere saranno brevi, quindi non avrai il tempo di muovere gli occhi.",ro:"Este un R. Acest afiaj este static, deci ar fi uor s v micai ochiul la liter i s-l identificai. ntr-o ncercare real, literele vor fi scurte, deci nu vei avea timp s v micai ochii.",ru:" R.   ,           .      ,          .",he:" R.    ,           .     ,        .",hy:" R.    ,          :      ,         :",ar:" R.            .             .",ur:"   .                     .                     .",hi:"       ,                     ,            ",bn:"  R.   ,                   ,       ",id:"Ini adalah R. Tampilan ini statis, jadi akan mudah untuk memindahkan mata Anda ke huruf dan mengidentifikasinya. Dalam percobaan nyata, surat-surat itu akan singkat, jadi Anda tidak akan punya waktu untuk memindahkan mata Anda.","zh-CN":" R","zh-HK":" R",ja:"R",ko:" R.         .         .",fi:"Se on R. Tm nytt on staattinen, joten silmsi olisi helppo siirt kirjeeseen ja tunnistaa se. Todellisessa kokeessa kirjaimet ovat lyhyit, joten sinulla ei ole aikaa siirt silmsi.",ta:"  .   ,       .      ,      .",ml:"  R.    ,       .     ,      .",te:"  R.   ,           .     ,       .",kn:" .   ,         .    ,      ."},T_pressingKey:{"en-US":"by pressing it in the keyboard.",de:"indem Sie es in der Tastatur drcken.",pl:"naciskajc go na klawiaturze.",fr:"en appuyant dessus sur le clavier.",es:"presionndolo en el teclado.",pt:"pressionando-o no teclado.",it:"premendolo nella tastiera.",ro:"apsnd-o n tastatur.",ru:"   .",he:"    .",hy:"   :",ar:"    .",ur:"     ",hi:"   ",bn:"  ",id:"dengan menekannya di keyboard.","zh-CN":"","zh-HK":"",ja:"",ko:" .",fi:"Painamalla sit nppimistss.",ta:"  .",ml:" .",te:"   .",kn:"   ."},T_clickingLetter:{"en-US":"by clicking it in the displayed list of letters.",de:"indem Sie es in der angezeigten Buchstabenliste anklicken.",pl:"klikajc go na wywietlonej licie liter.",fr:"en cliquant dessus dans la liste de lettres affiche.",es:"haciendo clic en l en la lista de letras que se muestra.",pt:"clicando nele na lista de letras exibida.",it:"facendo clic su di essa nell'elenco di lettere visualizzate.",ro:"fcnd clic pe acesta n lista de litere afiat.",ru:"      .",he:"      .",hy:"    :",ar:"     .",ur:"          ",hi:"       ",bn:"     ",id:"dengan mengkliknya di daftar huruf yang ditampilkan.","zh-CN":"","zh-HK":"",ja:"",ko:"   ",fi:"Napsauttamalla sit nytetyll kirjaimilla.",ta:"      .",ml:"   .",te:"      .",kn:"      ."},T_pressingKeyOrClickingLetter:{"en-US":"by pressing it in the keyboard or clicking it in the displayed list of letters.",de:"indem Sie es in der Tastatur drcken oder in der angezeigten Buchstabenliste anklicken.",pl:"naciskajc go na klawiaturze lub klikajc na wywietlonej licie liter.",fr:"en appuyant dessus dans le clavier ou en cliquant dessus dans la liste de lettres affiche.",es:"presionndolo en el teclado o haciendo clic en l en la lista de letras que se muestra.",pt:"pressionando-o no teclado ou clicando-o na lista de letras exibida.",it:"premendolo sulla tastiera o facendo clic su di esse nell'elenco di lettere visualizzate.",ro:"apsnd-o n tastatur sau fcnd clic pe ea n lista de litere afiat.",ru:"         .",he:"          .",hy:"         :",ar:"             .",ur:"               ",hi:"            ",bn:"        ",id:"dengan menekannya di keyboard atau mengkliknya di daftar huruf yang ditampilkan.","zh-CN":"","zh-HK":"",ja:"",ko:"     ",fi:"Painamalla sit nppimistss tai napsauttamalla sit nytetyll kirjaimilla.",ta:"           .",ml:"       .",te:"          .",kn:"           ."},T_continueHitReturn:{"en-US":"To continue, please hit RETURN.",de:"Um fortzufahren, drcken Sie bitte RETURN.",pl:"Aby kontynuowa, nacinij POWRT.",fr:"Pour continuer, veuillez appuyer sur RETOUR.",es:"Para continuar, presione RETORNO.",pt:"Para continuar, clique em RETURN.",it:"Per continuare, premi INVIO.",ro:"Pentru a continua, apsai RETURN.",ru:" ,  .",he:" ,   RETURN.",hy:"   RETURN:",ar:"       RETURN.",ur:"         ",hi:"   ,   ",bn:" ,    ",id:"Untuk melanjutkan, tekan RETURN.","zh-CN":"","zh-HK":"",ja:"RETURN",ko:" RETURN .",fi:"Jatka, paina paluuta.",ta:",  .",ml:",  .",te:",   .",kn:",    ."},T_continueClickAnywhere:{"en-US":"To continue, click anywhere.",de:"Um fortzufahren, klicken Sie auf eine beliebige Stelle.",pl:"Aby kontynuowa, kliknij w dowolnym miejscu.",fr:"Pour continuer, cliquez n'importe o.",es:"Para continuar, haga clic en cualquier lugar.",pt:"Para continuar, clique em qualquer lugar.",it:"Per continuare, fai clic in un punto qualsiasi.",ro:"Pentru a continua, facei clic oriunde.",ru:" ,    .",he:" ,    .",hy:"    :",ar:"     .",ur:"        ",hi:"   ,    ",bn:" ,     ",id:"Untuk melanjutkan, klik di mana saja.","zh-CN":"","zh-HK":"",ja:"",ko:"   .",fi:"Jatka, napsauta miss tahansa.",ta:",   .",ml:",  .",te:",   .",kn:",   ."},T_continueHitReturnOrClickAnywhere:{"en-US":"To continue, please hit RETURN or click anywhere.",de:"Um fortzufahren, drcken Sie bitte RETURN oder klicken Sie auf eine beliebige Stelle.",pl:"Aby kontynuowa, nacinij RETURN lub kliknij w dowolnym miejscu.",fr:"Pour continuer, appuyez sur RETOUR ou cliquez n'importe o.",es:"Para continuar, presione RETORNO o haga clic en cualquier lugar.",pt:"Para continuar, clique em RETURN ou clique em qualquer lugar.",it:"Per continuare, premi INVIO o fai clic ovunque.",ro:"Pentru a continua, apsai RETURN sau facei clic oriunde.",ru:" ,       .",he:" ,   RETURN    .",hy:"   RETURN    :",ar:"     RETURN     .",ur:"             ",hi:"   ,        ",bn:" ,          ",id:"Untuk melanjutkan, silakan tekan RETURN atau klik di mana saja.","zh-CN":"","zh-HK":"",ja:"",ko:" RETURN    .",fi:"Jatka, paina paluuta tai napsauta miss tahansa.",ta:",      .",ml:",      .",te:",      .",kn:",        ."},T_readyPressSpace:{"en-US":"Ready? While looking directly at the crosshair, please press the SPACE bar.",de:"Bereit? Whrend Sie direkt auf das Fadenkreuz schauen, drcken Sie bitte die Leertaste.",pl:"Gotowy? Patrzc bezporednio na celownik, nacinij spacj.",fr:"Prt? Tout en regardant directement le rticule, veuillez appuyer sur la barre ESPACE.",es:"Listo? Mientras mira directamente a la cruz, presione la barra espaciadora.",pt:"Preparar? Enquanto olha diretamente para a cruz, pressione a barra de ESPAO.",it:"Pronto? Mentre guardi direttamente il mirino, premi la barra spaziatrice.",ro:"Gata? n timp ce v uitai direct la cruce, v rugm s apsai bara SPACE.",ru:"?    ,  .",he:"?     ,    .",hy:"    ,    SPACE :",ar:"            .",ur:"              ",hi:"?     ,  SPACE  ",bn:"?     ,     ",id:"Siap? Sambil melihat langsung ke arah crosshair, silakan tekan bilah SPACE.","zh-CN":"","zh-HK":"",ja:"",ko:" ?     .",fi:"Valmis? Kun etsit suoraan crossheairia, paina vlilynti.",ta:"? Crosshair   ,   .",ml:"?   ,    .",te:" ?   ,    .",kn:"?   ,     ."},T_readyClickCrosshair:{"en-US":"Ready? While looking directly at the crosshair, please click on the crosshair.",de:"Bereit? Whrend Sie direkt auf das Fadenkreuz schauen, klicken Sie bitte auf das Fadenkreuz.",pl:"Gotowy? Patrzc bezporednio na celownik, kliknij celownik.",fr:"Prt? Tout en regardant directement le rticule, veuillez cliquer sur le rticule.",es:"Listo? Mientras mira directamente a la cruz, haga clic en la cruz.",pt:"Preparar? Enquanto olha diretamente para a mira, clique na mira.",it:"Pronto? Guardando direttamente il mirino, fare clic sul mirino.",ro:"Gata? n timp ce v uitai direct la cruce, v rugm s facei clic pe cruce.",ru:"?    ,   .",he:"?     ,    .",hy:"     ,     :",ar:"            .",ur:"                ",hi:"?     ,     ",bn:"?     ,     ",id:"Siap? Sambil melihat langsung ke crosshair, silahkan klik crosshair.","zh-CN":"","zh-HK":"",ja:"",ko:" ?     .",fi:"Valmis? Kun etsit suoraan crossheairia, klikkaa crosshair.",ta:"? Crosshair   , Crosshair   .",ml:"?   ,  .",te:" ?   ,    .",kn:"?   ,     ."},T_readyPressSpaceOrClickCrosshair:{"en-US":"Ready? While looking directly at the crosshair, please press the SPACE bar or click on the crosshair.",de:"Bereit? Whrend Sie direkt auf das Fadenkreuz schauen, drcken Sie bitte die Leertaste oder klicken Sie auf das Fadenkreuz.",pl:"Gotowy? Patrzc bezporednio na celownik, nacinij spacj lub kliknij celownik.",fr:"Prt? Tout en regardant directement le rticule, veuillez appuyer sur la barre ESPACE ou cliquer sur le rticule.",es:"Listo? Mientras mira directamente a la cruz, presione la barra espaciadora o haga clic en la cruz.",pt:"Preparar? Enquanto olha diretamente para a mira, pressione a barra de ESPAO ou clique na mira.",it:"Pronto? Guardando direttamente il mirino, fare clic sul mirino.",ro:"Gata? n timp ce privii direct crucea, v rugm s apsai bara SPACE sau s facei clic pe cruce.",ru:"?    ,      .",he:"?     ,        .",hy:"     ,    SPACE     :",ar:"                 .",ur:"                    ",hi:"?     ,  SPACE       ",bn:"?     ,         ",id:"Siap? Sambil melihat langsung ke crosshair, silahkan tekan SPACE bar atau klik crosshair.","zh-CN":"","zh-HK":"",ja:"",ko:" ?       .",fi:"Valmis? Kun etsit suoraan crossheairia, paina vlilynti tai napsauta CrossHair.",ta:"? Crosshair    ,      crosshair   .",ml:"?   ,       .",te:" ?   ,         .",kn:"?   ,        ."},T_identifyPressIt:{"en-US":"Please identify the middle letter, by pressing it in the keyboard.",de:"Bitte identifizieren Sie den mittleren Buchstaben, indem Sie ihn in der Tastatur drcken.",pl:"Prosz zidentyfikowa rodkow liter, naciskajc j na klawiaturze.",fr:"Veuillez identifier la lettre du milieu en appuyant dessus sur le clavier.",es:"Identifique la letra del medio presionndola en el teclado.",pt:"Identifique a letra do meio, pressionando-a no teclado.",it:"Si prega di identificare la lettera centrale premendo il tasto  corrispondente sulla tastiera.",ro:"V rugm s identificai litera de mijloc, apsnd-o n tastatur.",ru:"  ,    .",he:"        .",hy:"     `   :",ar:"        .",ur:"           ",hi:"       ",bn:"       ",id:"Silakan mengidentifikasi huruf tengah, dengan menekannya di keyboard.","zh-CN":"","zh-HK":"",ja:"",ko:"    .",fi:"Tunnista keskimminen kirjain painamalla sit nppimistss.",ta:"  ,    .",ml:"    .",te:"   ,   .",kn:"       ."},T_identifyClickIt:{"en-US":"Please identify the middle letter, by clicking it below.",de:"Bitte identifizieren Sie den mittleren Buchstaben, indem Sie unten darauf klicken.",pl:"Wska rodkow liter, klikajc j poniej.",fr:"Veuillez identifier la lettre du milieu en cliquant dessus ci-dessous.",es:"Identifique la letra del medio haciendo clic en ella abajo.",pt:"Identifique a letra do meio, clicando abaixo.",it:"Si prega di identificare la lettera centrale, facendo clic sull'alternativa in basso.",ro:"V rugm s identificai litera de mijloc, fcnd clic pe ea mai jos.",ru:"  ,    .",he:"        .",hy:"        :",ar:"      .",ur:"           ",hi:"       ",bn:"        ",id:"Harap mengidentifikasi huruf tengah, dengan mengkliknya di bawah ini.","zh-CN":"","zh-HK":"",ja:"",ko:"    .",fi:"Tunnista keskimminen kirjain napsauttamalla sit alla.",ta:"     .",ml:"    .",te:"   ,     .",kn:"        ."},T_identifyPressItOrClickIt:{"en-US":"Please identify the middle letter, by pressing it in the keyboard or clicking it below.",de:"Bitte identifizieren Sie den mittleren Buchstaben, indem Sie ihn in der Tastatur drcken oder unten darauf klicken.",pl:"Okrel rodkow liter, naciskajc j na klawiaturze lub klikajc poniej.",fr:"Veuillez identifier la lettre du milieu, en appuyant dessus dans le clavier ou en cliquant dessus ci-dessous.",es:"Identifique la letra del medio presionndola en el teclado o haciendo clic en ella abajo.",pt:"Identifique a letra do meio, pressionando-a no teclado ou clicando abaixo.",it:"Si prega di identificare la lettera centrale, premendola sulla tastiera o facendo clic su di essa in basso.",ro:"V rugm s identificai litera de mijloc, apsnd-o n tastatur sau fcnd clic pe ea mai jos.",ru:"  ,         .",he:"   ,         .",hy:"     `      :",ar:"            .",ur:"                ",hi:"           ",bn:"     ,       ",id:"Harap mengidentifikasi huruf tengah, dengan menekannya di keyboard atau mengkliknya di bawah.","zh-CN":"","zh-HK":"",ja:"",ko:"      .",fi:"Tunnista keskimminen kirjain painamalla sit nppimistss tai napsauttamalla sit alla.",ta:"    ,        .",ml:"        .",te:"   ,        .",kn:"  ,        ."}},l=(e,...t)=>{if(1===t.length)return e.replace("xxx",t[0]);for(let r in t)e=e.replace(`xx${Number(r)+1}`,t[r]);return e},h=(e,t=2,r=0)=>{let n=l(a.T_thresholdBeginBlock[e],r);switch(t){case 0:n+=`${a.T_pressingKey[e]}\n\n`;break;case 1:n+=`${a.T_clickingLetter[e]}\n\n`;break;default:n+=`${a.T_pressingKeyOrClickingLetter[e]}\n\n`}return n},u={spacing:(e,t=2)=>{switch(t){case 0:return a.T_readyPressSpace[e];case 1:return a.T_readyClickCrosshair[e];default:return a.T_readyPressSpaceOrClickCrosshair[e]}}},c={spacing:(e,t=2)=>{switch(t){case 0:return a.T_identifyPressIt[e];case 1:return a.T_identifyClickIt[e];default:return a.T_identifyPressItOrClickIt[e]}}},d=e=>{document.body.removeChild(e)},{TonePlayer:f}=e.eq,p={attack:.001,decay:.001,sustain:1,release:.001};function m(){document.querySelectorAll(".alphabet-holder").forEach((e=>{document.body.removeChild(e)}))}function _(e,t,r,n,i,s,o,h){let u="";return t&&(u=l(a.T_counterTrialBlock[e],n,i,s,o)),r&&(u+=l(a.T_counterCm[e],h)),u}const g=(e,t,r,n,s)=>{const o=n.getBoundingBox(!0).width,a=Math.round(e._size[0]/2-o),l=((e,t,r)=>{const n=Math.pow(10,e);return i(n,{pixPerCm:t,viewingDistanceCm:r})})(t,s.pixPerCm,s.viewingDistanceCm),h=3*l>a,u=h?a:Math.round(3*l),c=t;return h?(console.log("PROPOSED SPACING IS TOO LARGE"),((e,t,r)=>{const n=(i=e,s={pixPerCm:t,viewingDistanceCm:r},Math.atan(Math.abs(i)/s.pixPerCm/s.viewingDistanceCm)/(Math.PI/180));var i,s;Math.log10(n)})(u/3,s.pixPerCm,s.viewingDistanceCm)):console.log("PROPOSED SPACING IS NOT TOO LARGE"),r.setHeight(10),[u/(r.getBoundingBox(!0).width/10),c]},v=(e,t,r,n,i)=>{const s=.05;return y(s,t,r,n,i)?(console.error("Unpresentable stimuli, even at level="+String(s)),new Promise((e=>e(s)))):y(e,t,r,n,i)?v(e-s,t,r,n,i):new Promise((t=>t(e)))},y=(e,t,r,n,i)=>{const s=S(e,t,r,n,i),o=x(s,r),a=b(s,{width:screen.width,height:screen.height});return o||a},b=(e,t)=>e.some((e=>Math.abs(e[0])>t.width/2||Math.abs(e[1])>t.height/2)),x=(e,t)=>{const r=Math.min(e[0][0],e[1][0]),n=Math.max(e[0][0],e[1][0]),i=Math.min(e[0][1],e[1][1]),s=Math.max(e[0][1],e[1][1]),o=t[0]>=r&&t[0]<=n,a=t[1]>=i&&t[1]<=s;return o&&a},S=(e,t,r,n,s)=>{const o=Math.pow(10,e),a=Math.abs(i(o,{pixPerCm:s.pixPerCm,viewingDistanceCm:s.viewingDistanceCm})),l=E(t,r,n,a);try{const e=T(a,s.spacingOverSizeRatio,s.minimumHeight,s.fontFamily,s.window),r=[];return l.forEach(((n,i)=>{const s=[];t[0]<0?s.push(n[0]-(0===i?-1:1)*(e.width/2)):s.push(n[0]+(0===i?-1:1)*(e.width/2)),t[1]<0?s.push(n[1]-(0===i?-1:1)*(e.height/2)):s.push(n[1]+(0===i?-1:1)*(e.height/2)),r.push(s)})),r}catch(e){return console.error("Error estimating flankers extent.",e),e}},T=(t,r,n,i,s)=>{const o=Math.max(t/r,n);try{return new e.Hg.TextStim({win:s,name:"testTextStim",text:"H",font:i,units:"pix",pos:[0,0],height:o,wrapWidth:void 0,ori:0,color:new e.D5.Color("black"),opacity:1,depth:-7,autoDraw:!1,autoLog:!1})._boundingBox}catch(e){return console.error("Error estimating bounding box of flanker. Likely due to too large a `proposedLevel` value being tested.",e),e}},E=(e,t,r,n)=>{switch(r){case"radial":return((e,t,r)=>{const n=[t[0]-e[0],t[1]-e[1]],i=Math.sqrt(n.map((e=>e**2)).reduce(((e,t)=>e+t))),s=n.map((e=>e/i));return[e.map(((e,t)=>e+r*s[t])),e.map(((e,t)=>e-r*s[t]))]})(e,t,n);case"tangential":return((e,t,r)=>{const n=[t[0]-e[0],t[1]-e[1]],i=[n[1],-n[0]],s=Math.sqrt(i.map((e=>e**2)).reduce(((e,t)=>e+t))),o=i.map((e=>e/s));return[e.map(((e,t)=>e+r*o[t])),e.map(((e,t)=>e-r*o[t]))]})(e,t,n);default:console.error("Unknown flankerOrientation specified, ",r)}},{PsychoJS:A}=e.vE,{TrialHandler:w,MultiStairHandler:C}=e.aT,{Scheduler:O}=e.D5;var R;let D;window.jsQUEST=t;const I=RemoteCalibrator;I.init();let M="Threshold",N={participant:"",session:"001"};const P={};Papa.parse("conditions/blockCount.csv",{download:!0,complete:function(e){const t=Number(e.data[e.data.length-1][0])+1;F(t,(()=>{I.panel([{name:"screenSize"},{name:"trackDistance",options:{nearPoint:!1,showVideo:!1}}],"#rc-panel",{},(()=>{I.removePanel(),document.body.removeChild(document.querySelector("#rc-panel")),X(t)}))}))}});const k={},F=(e,t)=>{0!==e?Papa.parse(`conditions/block_${e}.csv`,{download:!0,header:!0,skipEmptyLines:!0,dynamicTyping:!0,complete:function(r){k[e]=r.data,Object.values(r.data).forEach((e=>{let t=e.targetFont,r="fonts/"+t+".woff2";fetch(r).then((e=>{e.ok&&(P[t]=r)}))})),F(e-1,t)}}):t()};var L,B={initialVal:0,fontSize:20,x:window.innerWidth/2,y:-window.innerHeight/2,fontName:"Arial",alignHoriz:"right",alignVert:"bottom"},U="",G=0,j=0,V=0,z=0,H=0;const X=t=>{const y=[];for(let e=1;e<=t;e++)y.push({name:`conditions/block_${e}.csv`,path:`conditions/block_${e}.csv`});for(let e in P)y.push({name:e,path:P[e]});const b=new A({debug:false}),x=(e=>new f({psychoJS:e,note:2e3,duration_s:.05,volume:.6,loops:0,wave:"sine",envelope:p}))(b),S=((e=>{new f({psychoJS:e,note:500,duration_s:.5,volume:.5,loops:0,wave:"sine",envelope:p})})(b),(e=>new f({psychoJS:e,note:200,duration_s:.6,volume:.7,loops:0,wave:"sine",envelope:p}))(b));b.openWindow({fullscr:!0,color:new e.D5.Color([.9,.9,.9]),units:"height",waitBlanking:!0}),b.schedule(b.gui.DlgFromDict({dictionary:N,title:a.T_thresholdTitle[I.language.value],participantText:a.T_participant[I.language.value],sessionText:a.T_session[I.language.value],cancelText:a.T_cancel[I.language.value],okText:a.T_ok[I.language.value]}));const T=new O(b),F=new O(b);b.scheduleCondition((function(){return"OK"===b.gui.dialogComponent.button}),T,F),T.add((async function(){return N.date=e.D5.MonotonicClock.getDateStr(),N.expName=M,N.psychopyVersion="2021.3.1",N.OS=I.systemFamily.value,N.frameRate=b.window.getActualFrameRate(),e.D5.addInfoFromUrl(N),O.Event.NEXT})),T.add((async function(){return new e.D5.Clock,new e.Hg.TextStim({win:b.window,name:"consent_form_content",text:"I agree to participate in this study (indicate by clicking one option).",font:"Open Sans",units:void 0,pos:[0,-.35],height:.03,wrapWidth:void 0,ori:0,color:new e.D5.Color("black"),opacity:void 0,depth:0}),new e.Hg.ButtonStim({win:b.window,name:"consent_button_yes",text:"Yes.",pos:[0,-.41],letterHeight:.02,size:null}).clock=new e.D5.Clock,new e.Hg.ButtonStim({win:b.window,name:"consent_button_no",text:"No. (You will leave the study without receiving payment.)",pos:[0,-.46],letterHeight:.02,size:[5,2]}).clock=new e.D5.Clock,W=new e.D5.Clock,q=new e.D5.Clock,Y=new e.D5.Clock,J=0,K="conditions/block_1.csv",$=new e.D5.Clock,ee=new e.vE.Keyboard({psychoJS:b,clock:new e.D5.Clock,waitForStart:!0}),te=new e.Hg.TextStim({win:b.window,name:"fixation",text:"+",font:"Open Sans",units:"pix",pos:[0,0],height:1,wrapWidth:void 0,ori:0,color:new e.D5.Color("black"),opacity:void 0,depth:-6}),re=new e.Hg.TextStim({win:b.window,name:"flanker1",text:"",font:"Arial",units:"pix",pos:[0,0],height:1,wrapWidth:void 0,ori:0,color:new e.D5.Color("black"),opacity:1,depth:-7}),ne=new e.Hg.TextStim({win:b.window,name:"target",text:"",font:"Arial",units:"pix",pos:[0,0],height:1,wrapWidth:void 0,ori:0,color:new e.D5.Color("black"),opacity:1,depth:-8}),ie=new e.Hg.TextStim({win:b.window,name:"flanker2",text:"",font:"Arial",units:"pix",pos:[0,0],height:1,wrapWidth:void 0,ori:0,color:new e.D5.Color("black"),opacity:1,depth:-9}),se=new e.Hg.TextStim({win:b.window,name:"showAlphabet",text:"",font:"Arial",units:"pix",pos:[0,0],height:1,wrapWidth:window.innerWidth,ori:0,color:new e.D5.Color("black"),opacity:1,depth:-5}),L=new e.Hg.TextStim({win:b.window,name:"totalTrial",text:"",font:B.fontName,units:"pix",pos:[B.x,B.y],alignHoriz:B.alignHoriz,alignVert:B.alignVert,height:1,wrapWidth:window.innerWidth,ori:0,color:new e.D5.Color("black"),opacity:1,depth:-20,isInstruction:!1}),Q=new e.Hg.TextStim({win:b.window,name:"instructions",text:"",font:"Arial",units:"pix",pos:[.4*-window.innerWidth,.4*window.innerHeight],height:32,wrapWidth:.8*window.innerWidth,ori:0,color:new e.D5.Color("black"),opacity:1,depth:-12,alignHoriz:"left",alignVert:"top",isInstruction:!0}),Z=new e.Hg.TextStim({win:b.window,name:"instructions2",text:"",font:"Arial",units:"pix",pos:[.4*-window.innerWidth,.4*-window.innerHeight],height:32,wrapWidth:.8*window.innerWidth,ori:0,color:new e.D5.Color("black"),opacity:1,depth:-12,alignHoriz:"left",alignVert:"bottom",isInstruction:!0}),new e.D5.Clock,oe=new e.D5.CountdownTimer,"RTL"===I.languageDirection.value&&Object.assign(document.querySelector("canvas").style,{direction:"rtl"}),O.Event.NEXT})),T.add((async function(){w.fromSnapshot(void 0),ae=0,W.reset(),le=-1,ce=!0,he=[];for(const e of he)"status"in e&&(e.status=A.Status.NOT_STARTED);return O.Event.NEXT})),T.add((async function(){if(ae=W.getTime(),le+=1,b.experiment.experimentEnded||b.eventManager.getKeys({keyList:["escape"]}).length>0)return nt("The [Escape] key was pressed. Goodbye!",!1);if(!ce)return O.Event.NEXT;ce=!1;for(const e of he)if("status"in e&&e.status!==A.Status.FINISHED){ce=!0;break}return ce?O.Event.FLIP_REPEAT:O.Event.NEXT})),T.add((async function(){for(const e of he)"function"==typeof e.setAutoDraw&&e.setAutoDraw(!1);return oe.reset(),O.Event.NEXT}));const X=new O(b);var W,q,Y,J,K,$,Q,Z,ee,te,re,ne,ie,se,oe,ae,le,he,ue,ce,de,fe,pe,me,_e,ge;function ve(e){ae=0,Y.reset(),le=-1,ce=!0,Q.setWrapWidth(.8*window.innerWidth),Q.setPos([.4*-window.innerWidth,.4*window.innerHeight]),Q.setText(e),Q.setAutoDraw(!0)}function ye(e){"threshold-beep-button"!==e.target.id&&(ue=!0)}async function be(){return ae=Y.getTime(),le+=1,b.experiment.experimentEnded||b.eventManager.getKeys({keyList:["escape"]}).length>0?(document.removeEventListener("click",ye),document.removeEventListener("touchend",ye),d(de),nt("The [Escape] key was pressed. Goodbye!",!1)):ce?(ce=!0,b.eventManager.getKeys({keyList:["return"]}).length>0&&(ce=!1),ce&&!ue?O.Event.FLIP_REPEAT:O.Event.NEXT):O.Event.NEXT}function xe(t,r){return async function(){me=w.importConditions(b.serverManager,K),_e=new e.aT.MultiStairHandler({stairType:C.StaircaseType.QUEST,psychoJS:b,name:"trials",varName:"trialsVal",nTrials:R*me.length,conditions:me,method:w.Method.FULLRANDOM}),U=_(I.language.value,Be,Ue,j,V,z,H,Ne),L.setText(U),L.setAutoDraw(!0),b.experiment.addLoop(_e),pe=_e;for(const e of _e){const e=_e.getSnapshot();t.add(rt(e)),t.add(Ce(e)),t.add((async function(){return ae=Y.getTime(),le+=1,b.experiment.experimentEnded||b.eventManager.getKeys({keyList:["escape"]}).length>0?nt("The [Escape] key was pressed. Goodbye!",!1):ce?(ce=!0,b.eventManager.getKeys({keyList:["space"]}).length>0&&(ce=!1),ce&&!ue?O.Event.FLIP_REPEAT:O.Event.NEXT):O.Event.NEXT})),t.add((async function(){return document.removeEventListener("click",we),document.removeEventListener("touchend",we),Q.setAutoDraw(!1),oe.reset(),O.Event.NEXT})),t.add(et(e)),t.add((async function(){ae=$.getTime(),le+=1;const e=.5;if(ae>=e&&ee.status===A.Status.NOT_STARTED&&(ee.tStart=ae,ee.frameNStart=le,ze.onsetTime=performance.now(),b.window.callOnFlip((function(){ee.clock.reset()})),b.window.callOnFlip((function(){ee.start()})),b.window.callOnFlip((function(){ee.clearEvents()}))),ee.status===A.Status.STARTED){let e=ee.getKeys({keyList:Le,waitRelease:!1});($e=$e.concat(e)).length>0&&(ee.keys=$e[$e.length-1].name,ee.rt=$e[$e.length-1].rt,ee.keys==D?(x.play(),ee.corr=1):ee.corr=0,ce=!1)}if(ze.current&&(ee.keys=ze.current,ee.rt=(ze.clickTime-ze.onsetTime)/1e3,ze.current==D?(x.play(),ee.corr=1):ee.corr=0,ze.current=null,m(),ce=!1),ae>=0&&L.status===A.Status.NOT_STARTED&&(L.tStart=ae,L.frameNStart=le,L.setAutoDraw(!0)),ae>=0&&te.status===A.Status.NOT_STARTED&&Ve&&(te.tStart=ae,te.frameNStart=le,te.setAutoDraw(!0)),ae>=e&&re.status===A.Status.NOT_STARTED&&(re.tStart=ae,re.frameNStart=le,"typographic"===qe?re.setAutoDraw(!1):re.setAutoDraw(!0)),Ze=e+He-.75*b.window.monitorFramePeriod,re.status===A.Status.STARTED&&ae>=Ze&&re.setAutoDraw(!1),ae>=e&&ne.status===A.Status.NOT_STARTED&&(ne.tStart=ae,ne.frameNStart=le,ne.setAutoDraw(!0)),Ze=e+He-.75*b.window.monitorFramePeriod,ne.status===A.Status.STARTED&&ae>=Ze&&(ne.setAutoDraw(!1),setTimeout((()=>{S.play()}),17),setTimeout((()=>{document.body.classList.remove("hide-cursor")}),500)),ae>=e&&ie.status===A.Status.NOT_STARTED&&(ie.tStart=ae,ie.frameNStart=le,"typographic"===qe?ie.setAutoDraw(!1):ie.setAutoDraw(!0)),Ze=e+He-.75*b.window.monitorFramePeriod,ie.status===A.Status.STARTED&&ae>=Ze&&ie.setAutoDraw(!1),b.experiment.experimentEnded||b.eventManager.getKeys({keyList:["escape"]}).length>0)return nt("The [Escape] key was pressed. Goodbye!",!1);if(ae>=e+He&&se.status===A.Status.NOT_STARTED&&(se.tStart=ae,se.frameNStart=le,se.setAutoDraw(!0),function(e,t,r,n){const i=document.createElement("div");i.id="alphabet-holder",i.className="alphabet-holder",i.style.fontFamily=t,i.style.marginTop="40%";for(let t of e){let e=document.createElement("span");e.className="alphabet",e.innerText=t,e.onclick=()=>{n.clickTime=performance.now(),n.current=t.toLowerCase()},i.appendChild(e)}document.body.appendChild(i)}(Fe,ke,0,ze),Q.tSTart=ae,Q.frameNStart=le,Q.setAutoDraw(!0)),!ce)return m(),O.Event.NEXT;ce=!1;for(const e of Qe)if("status"in e&&e.status!==A.Status.FINISHED){ce=!0;break}return ce?O.Event.FLIP_REPEAT:O.Event.NEXT})),t.add((async function(){for(const e of Qe)"function"==typeof e.setAutoDraw&&e.setAutoDraw(!1);return void 0===ee.keys&&console.error("[key_resp.keys] No response error."),pe instanceof C&&pe.addResponse(ee.corr,Oe),b.experiment.addData("key_resp.keys",ee.keys),b.experiment.addData("key_resp.corr",ee.corr),void 0!==ee.keys&&(b.experiment.addData("key_resp.rt",ee.rt),oe.reset()),ee.stop(),oe.reset(),b.experiment.addData("staircaseName",pe._currentStaircase._name),b.experiment.addData("questMeanAtEndOfTrial",pe._currentStaircase.mean()),b.experiment.addData("questSDAtEndOfTrial",pe._currentStaircase.sd()),b.experiment.addData("questQuantileOfQuantileOrderAtEndOfTrial",pe._currentStaircase.quantile(pe._currentStaircase._jsQuest.quantileOrder)),O.Event.NEXT})),t.add(tt(t,e))}return O.Event.NEXT}}async function Se(){return b.experiment.addData("staircaseName",pe._currentStaircase._name),b.experiment.addData("questMeanAtEndOfTrialsLoop",pe._currentStaircase.mean()),b.experiment.addData("questSDAtEndOfTrialsLoop",pe._currentStaircase.sd()),b.experiment.addData("questQuantileOfQuantileOrderAtEndOfTrialsLoop",pe._currentStaircase.quantile(pe._currentStaircase._jsQuest.quantileOrder)),b.experiment.removeLoop(_e),O.Event.NEXT}function Te(e){return async function(){w.fromSnapshot(e),z=e.block+1,H=e.nTotal,ae=0,q.reset(),le=-1,ce=!0,K=`conditions/block_${J+=1}.csv`;const t=[],r=k[J];for(let e in r){let n=parseInt(e);Object.keys(r[n]).length>1&&t.push(parseInt(r[n].conditionTrials))}if(G=t.reduce(((e,t)=>e+t),0),!t.every((e=>e===t[0])))throw"Number of trials for each condition within one block has to be equal. (Will be updated soon.)";R=t[0],ge=[];for(const e of ge)"status"in e&&(e.status=A.Status.NOT_STARTED);return O.Event.NEXT}}function Ee(e){return async function(){return w.fromSnapshot(e),ve((0===e.block?((e,t=null)=>l(a.T_thresholdSoundCheck[e],null===t?"":` ${t}`)+"\n\n")(I.language.value,N.participant):"")+h(I.language.value,2,G)+((e,t=2)=>{let r=a.T_guessingGame[e]+" ";switch(t){case 0:return r+a.T_continueHitReturn[e];case 1:return r+a.T_continueClickAnywhere[e];default:return r+a.T_continueHitReturnOrClickAnywhere[e]}})(I.language.value,2)),ue=!1,setTimeout((()=>{document.addEventListener("click",ye),document.addEventListener("touchend",ye)}),1e3),de=((e,t)=>{const r=document.createElement("button");return r.innerText=a.T_beep[e],r.onclick=e=>{e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation(),t.play(),r.blur()},r.className="threshold-beep-button",r.id="threshold-beep-button",document.body.appendChild(r),r})(I.language.value,x),b.eventManager.clearKeys(),O.Event.NEXT}}function Ae(e){return async function(){var t;return w.fromSnapshot(e),ve((t=I.language.value,a.T_middleLetterDemo[t])),Z.setText(((e,t=2)=>{let r=a.T_middleLetterBrief[e];switch(t){case 0:return r+a.T_continueHitReturn[e];case 1:return r+a.T_continueClickAnywhere[e];default:return r+a.T_continueHitReturnOrClickAnywhere[e]}})(I.language.value,2)),Z.setWrapWidth(.8*window.innerWidth),Z.setPos([.4*-window.innerWidth,.4*-window.innerHeight]),Z.setAutoDraw(!0),ue=!1,setTimeout((()=>{document.addEventListener("click",ye),document.addEventListener("touchend",ye)}),1e3),ne.setPos([200,0]),ne.setText("R"),ne.setHeight(50),re.setPos([100,0]),re.setText("H"),re.setHeight(50),ie.setPos([300,0]),ie.setText("C"),ie.setHeight(50),te.setHeight(je),te.setPos([0,0]),te.setAutoDraw(!0),ne.setAutoDraw(!0),re.setAutoDraw(!0),ie.setAutoDraw(!0),b.eventManager.clearKeys(),O.Event.NEXT}}T.add(function(e,t){return async function(){w.fromSnapshot(undefined),fe=new w({psychoJS:b,nReps:1,method:w.Method.SEQUENTIAL,extraInfo:N,originPath:void 0,trialList:"conditions/blockCount.csv",seed:void 0,name:"blocks"}),b.experiment.addLoop(fe),pe=fe;for(const t of fe){const t=fe.getSnapshot();e.add(rt(t)),e.add(Te(t)),e.add((async function(){if(ae=q.getTime(),le+=1,b.experiment.experimentEnded||b.eventManager.getKeys({keyList:["escape"]}).length>0)return nt("The [Escape] key was pressed. Goodbye!",!1);if(!ce)return O.Event.NEXT;ce=!1;for(const e of ge)if("status"in e&&e.status!==A.Status.FINISHED){ce=!0;break}return ce?O.Event.FLIP_REPEAT:O.Event.NEXT})),e.add((async function(){for(const e of ge)"function"==typeof e.setAutoDraw&&e.setAutoDraw(!1);return oe.reset(),O.Event.NEXT})),e.add(Ee(t)),e.add(be),e.add((async function(){return Q.setAutoDraw(!1),oe.reset(),document.removeEventListener("click",ye),document.removeEventListener("touchend",ye),d(de),O.Event.NEXT})),e.add(Ae(t)),e.add(be),e.add((async function(){return Q.setAutoDraw(!1),Z.setAutoDraw(!1),oe.reset(),document.removeEventListener("click",ye),document.removeEventListener("touchend",ye),ne.setAutoDraw(!1),re.setAutoDraw(!1),ie.setAutoDraw(!1),O.Event.NEXT}));const r=new O(b);e.add(xe(r)),e.add(r),e.add(Se),e.add(tt(e,t))}return O.Event.NEXT}}(X)),T.add(X),T.add((async function(){return b.experiment.removeLoop(fe),O.Event.NEXT})),T.add(nt,"",!0),F.add(nt,"",!1),N.participant=I.id.value,b.start({expName:M,expInfo:N,resources:[{name:"conditions/blockCount.csv",path:"conditions/blockCount.csv"},...y]}),b.experimentLogger.setLevel(e.vE.Logger.ServerLevel.EXP);const we=e=>{let t,r;if(e.clientX)t=e.clientX,r=e.clientY;else{const n=e.changedTouches[0];if(!n.clientX)return void(ue=!1);t=n.clientX,r=n.clientY}Math.hypot(t-(window.innerWidth>>1),r-(window.innerHeight>>1))<je?(n(),setTimeout((()=>{ue=!0}),17)):ue=!1};function Ce(e){return async function(){return w.fromSnapshot(e),j=e.thisN+1,V=e.nTotal,U=_(I.language.value,Be,Ue,j,V,z,H,Ne),L.setText(U),L.setFont(B.fontName),L.setHeight(B.fontSize),L.setPos([window.innerWidth/2,-window.innerHeight/2]),L.setAutoDraw(!0),ve(u.spacing(I.language.value,2)),te.setHeight(je),te.setPos(Ge),te.tStart=ae,te.frameNStart=le,te.setAutoDraw(!0),ue=!1,document.addEventListener("click",we),document.addEventListener("touchend",we),b.eventManager.clearKeys(),O.Event.NEXT}}var Oe,Re,De,Ie,Me,Ne,Pe,ke,Fe,Le,Be,Ue,Ge=[0,0],je=45,Ve=!0;const ze={current:null,onsetTime:0,clickTime:0};var He,Xe,We,qe,Ye,Je,Ke,$e,Qe,Ze;function et(e){return async function(){let t;w.fromSnapshot(e),n();const a=[];for(let r of e.handler.getConditions())r.label===_e._currentStaircase._name&&(t=r,o(b.experiment,t,a));let l=pe._currentStaircase.getQuestValue();b.experiment.addData("levelProposedByQUEST",l),l=Math.min(l,1.75),b.experiment.addData("levelRoughlyLimited",l),b.experiment.addData("conditionName",t.label),b.experiment.addData("flankerOrientation",t.spacingDirection),b.experiment.addData("targetFont",t.targetFont),ae=0,$.reset(),le=-1,ce=!0,Re=I.screenWidthCm?I.screenWidthCm.value:30,De=I.displayWidthPx.value,Ie=De/Re,I.screenWidthCm||console.warn("[Screen Width] Using arbitrary screen width. Enable RC."),Me=t.viewingDistanceDesiredCm,Ne=I.viewingDistanceCm?I.viewingDistanceCm.value:Me,I.viewingDistanceCm||console.warn("[Viewing Distance] Using arbitrary viewing distance. Enable RC."),Ge=[0,0],t.block,Pe=t.spacingDirection,ke=t.targetFont,Fe=String(t.targetAlphabet).split(""),Le=String(t.targetAlphabet).toLowerCase().split(""),t.showAlphabetWhere,Ue="FALSE"!==t.showViewingDistanceBool,Be="FALSE"!==t.showCounterBool,R=t.conditionTrials,He=t.targetDurationSec,je=45,Ve="True"===t.markTheFixationBool,Xe=t.targetMinimumPix,We=t.spacingOverSizeRatio,qe=t.spacingRelationToSize||"ratio",Ye=t.targetEccentricityXDeg,b.experiment.addData("targetEccentricityXDeg",Ye),Je=t.targetEccentricityYDeg,b.experiment.addData("targetEccentricityYDeg",Je),Ke=[Ye,Je],t.trackGazeYes,t.trackHeadYes,t.wirelessKeyboardNeededYes;const h=r(r(Fe));var u,d,f,p,m,y,x,S=h[0],T=h[1],C=h[2];D=T.toLowerCase();const M={pixPerCm:Ie,viewingDistanceCm:Ne,nearPointXYDeg:{x:0,y:0},nearPointXYPix:{x:0,y:0},spacingOverSizeRatio:We,minimumHeight:Xe,fontFamily:ke,window:b.window,spacingRelationToSize:qe},[N]=s([Ke],M);if(te.setPos(Ge),te.setHeight(je),[f]=s([Ke],M),f=f.map((e=>Math.round(e))),b.experiment.addData("targetLocationPix",f),ne.setPos(f),ne.setFont(ke),b.experiment.addData("spacingRelationToSize",qe),"ratio"===qe){Oe=await v(l,N,Ge,Pe,M),b.experiment.addData("levelUsed",Oe),y=Math.pow(10,Oe),b.experiment.addData("spacingDeg",y),x=Math.abs(i(y,{pixPerCm:Ie,viewingDistanceCm:Ne})),b.experiment.addData("spacingPix",x),[u,p]=E(Ke,Ge,Pe,y),b.experiment.addData("flankerLocationsDeg",[u,p]),[d,m]=s([u,p],M),d=d.map((e=>Math.round(e))),m=m.map((e=>Math.round(e))),b.experiment.addData("flankerLocationsPix",[d,m]);const e=Math.round(Math.max(x/We,Xe));b.experiment.addData("heightPix",e),ne.setText(T),ne.setHeight(e),re.setPos(d),re.setText(S),re.setFont(ke),re.setHeight(e),ie.setPos(m),ie.setText(C),ie.setFont(ke),ie.setHeight(e)}else if("typographic"===qe){re.setAutoDraw(!1),ie.setAutoDraw(!1);const e=S+T+C;ne.setText(e);const[t,r]=g(b.window,l,ne,te,M);Oe=r,b.experiment.addData("levelUsed",Oe),ne.setHeight(t),b.experiment.addData("heightPix",t)}else"none"==qe?console.error('spacingRelationToSize value "none" not yet supported. Please use "ratio" or "typographic" for the time being.'):console.error(`spacingRelationToSize value ${qe} not recognized. Please use "none", "ratio", or "typographic"`);ee.keys=void 0,ee.rt=void 0,$e=[],se.setPos([0,0]),se.setText(""),Q.setText(c.spacing(I.language.value,2)),U=_(I.language.value,Be,Ue,j,V,z,H,Ne),L.setText(U),L.setFont(B.fontName),L.setHeight(B.fontSize),L.setPos([window.innerWidth/2,-window.innerHeight/2]),(Qe=[]).push(ee),Qe.push(te),Qe.push(re),Qe.push(ne),Qe.push(ie),Qe.push(se),Qe.push(L);for(const e of Qe)"status"in e&&(e.status=A.Status.NOT_STARTED);return O.Event.NEXT}}function tt(e,t){return async function(){if(void 0!==t){if(t.finished)b.experiment.isEntryEmpty()&&b.experiment.nextEntry(t),e.stop();else{const e=t.getCurrentTrial();void 0!==e&&"isTrials"in e&&!e.isTrials||b.experiment.nextEntry(t)}return O.Event.NEXT}}}function rt(e){return async function(){return b.importAttributes(e.getCurrentTrial()),O.Event.NEXT}}async function nt(e,t){return b.experiment.isEntryEmpty()&&b.experiment.nextEntry(),b.window.close(),b.quit({message:e,isCompleted:t}),O.Event.QUIT}}})()})();
//# sourceMappingURL=threshold.min.js.map